function t(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s}const e="undefined"!=typeof window&&null!=window.customElements&&void 0!==window.customElements.polyfillWrapFlushCallback,n=(t,e,n=null)=>{for(;e!==n;){const n=e.nextSibling;t.removeChild(e),e=n}},i=`{{lit-${String(Math.random()).slice(2)}}}`,o=`\x3c!--${i}--\x3e`,r=new RegExp(`${i}|${o}`);class s{constructor(t,e){this.parts=[],this.element=e;const n=[],o=[],s=document.createTreeWalker(e.content,133,null,!1);let l=0,u=-1,h=0;const{strings:p,values:{length:g}}=t;for(;h<g;){const t=s.nextNode();if(null!==t){if(u++,1===t.nodeType){if(t.hasAttributes()){const e=t.attributes,{length:n}=e;let i=0;for(let t=0;t<n;t++)a(e[t].name,"$lit$")&&i++;for(;i-- >0;){const e=p[h],n=d.exec(e)[2],i=n.toLowerCase()+"$lit$",o=t.getAttribute(i);t.removeAttribute(i);const s=o.split(r);this.parts.push({type:"attribute",index:u,name:n,strings:s}),h+=s.length-1}}"TEMPLATE"===t.tagName&&(o.push(t),s.currentNode=t.content)}else if(3===t.nodeType){const e=t.data;if(e.indexOf(i)>=0){const i=t.parentNode,o=e.split(r),s=o.length-1;for(let e=0;e<s;e++){let n,r=o[e];if(""===r)n=c();else{const t=d.exec(r);null!==t&&a(t[2],"$lit$")&&(r=r.slice(0,t.index)+t[1]+t[2].slice(0,-"$lit$".length)+t[3]),n=document.createTextNode(r)}i.insertBefore(n,t),this.parts.push({type:"node",index:++u})}""===o[s]?(i.insertBefore(c(),t),n.push(t)):t.data=o[s],h+=s}}else if(8===t.nodeType)if(t.data===i){const e=t.parentNode;null!==t.previousSibling&&u!==l||(u++,e.insertBefore(c(),t)),l=u,this.parts.push({type:"node",index:u}),null===t.nextSibling?t.data="":(n.push(t),u--),h++}else{let e=-1;for(;-1!==(e=t.data.indexOf(i,e+1));)this.parts.push({type:"node",index:-1}),h++}}else s.currentNode=o.pop()}for(const t of n)t.parentNode.removeChild(t)}}const a=(t,e)=>{const n=t.length-e.length;return n>=0&&t.slice(n)===e},l=t=>-1!==t.index,c=()=>document.createComment(""),d=/([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;function u(t,e){const{element:{content:n},parts:i}=t,o=document.createTreeWalker(n,133,null,!1);let r=p(i),s=i[r],a=-1,l=0;const c=[];let d=null;for(;o.nextNode();){a++;const t=o.currentNode;for(t.previousSibling===d&&(d=null),e.has(t)&&(c.push(t),null===d&&(d=t)),null!==d&&l++;void 0!==s&&s.index===a;)s.index=null!==d?-1:s.index-l,r=p(i,r),s=i[r]}c.forEach((t=>t.parentNode.removeChild(t)))}const h=t=>{let e=11===t.nodeType?0:1;const n=document.createTreeWalker(t,133,null,!1);for(;n.nextNode();)e++;return e},p=(t,e=-1)=>{for(let n=e+1;n<t.length;n++){const e=t[n];if(l(e))return n}return-1};const g=new WeakMap,f=t=>(...e)=>{const n=t(...e);return g.set(n,!0),n},m=t=>"function"==typeof t&&g.has(t),_={},v={};class y{constructor(t,e,n){this.__parts=[],this.template=t,this.processor=e,this.options=n}update(t){let e=0;for(const n of this.__parts)void 0!==n&&n.setValue(t[e]),e++;for(const t of this.__parts)void 0!==t&&t.commit()}_clone(){const t=e?this.template.element.content.cloneNode(!0):document.importNode(this.template.element.content,!0),n=[],i=this.template.parts,o=document.createTreeWalker(t,133,null,!1);let r,s=0,a=0,c=o.nextNode();for(;s<i.length;)if(r=i[s],l(r)){for(;a<r.index;)a++,"TEMPLATE"===c.nodeName&&(n.push(c),o.currentNode=c.content),null===(c=o.nextNode())&&(o.currentNode=n.pop(),c=o.nextNode());if("node"===r.type){const t=this.processor.handleTextExpression(this.options);t.insertAfterNode(c.previousSibling),this.__parts.push(t)}else this.__parts.push(...this.processor.handleAttributeExpressions(c,r.name,r.strings,this.options));s++}else this.__parts.push(void 0),s++;return e&&(document.adoptNode(t),customElements.upgrade(t)),t}}const b=window.trustedTypes&&trustedTypes.createPolicy("lit-html",{createHTML:t=>t}),E=` ${i} `;class T{constructor(t,e,n,i){this.strings=t,this.values=e,this.type=n,this.processor=i}getHTML(){const t=this.strings.length-1;let e="",n=!1;for(let r=0;r<t;r++){const t=this.strings[r],s=t.lastIndexOf("\x3c!--");n=(s>-1||n)&&-1===t.indexOf("--\x3e",s+1);const a=d.exec(t);e+=null===a?t+(n?E:o):t.substr(0,a.index)+a[1]+a[2]+"$lit$"+a[3]+i}return e+=this.strings[t],e}getTemplateElement(){const t=document.createElement("template");let e=this.getHTML();return void 0!==b&&(e=b.createHTML(e)),t.innerHTML=e,t}}const R=t=>null===t||!("object"==typeof t||"function"==typeof t),C=t=>Array.isArray(t)||!(!t||!t[Symbol.iterator]);class x{constructor(t,e,n){this.dirty=!0,this.element=t,this.name=e,this.strings=n,this.parts=[];for(let t=0;t<n.length-1;t++)this.parts[t]=this._createPart()}_createPart(){return new S(this)}_getValue(){const t=this.strings,e=t.length-1,n=this.parts;if(1===e&&""===t[0]&&""===t[1]){const t=n[0].value;if("symbol"==typeof t)return String(t);if("string"==typeof t||!C(t))return t}let i="";for(let o=0;o<e;o++){i+=t[o];const e=n[o];if(void 0!==e){const t=e.value;if(R(t)||!C(t))i+="string"==typeof t?t:String(t);else for(const e of t)i+="string"==typeof e?e:String(e)}}return i+=t[e],i}commit(){this.dirty&&(this.dirty=!1,this.element.setAttribute(this.name,this._getValue()))}}class S{constructor(t){this.value=void 0,this.committer=t}setValue(t){t===_||R(t)&&t===this.value||(this.value=t,m(t)||(this.committer.dirty=!0))}commit(){for(;m(this.value);){const t=this.value;this.value=_,t(this)}this.value!==_&&this.committer.commit()}}class I{constructor(t){this.value=void 0,this.__pendingValue=void 0,this.options=t}appendInto(t){this.startNode=t.appendChild(c()),this.endNode=t.appendChild(c())}insertAfterNode(t){this.startNode=t,this.endNode=t.nextSibling}appendIntoPart(t){t.__insert(this.startNode=c()),t.__insert(this.endNode=c())}insertAfterPart(t){t.__insert(this.startNode=c()),this.endNode=t.endNode,t.endNode=this.startNode}setValue(t){this.__pendingValue=t}commit(){if(null===this.startNode.parentNode)return;for(;m(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=_,t(this)}const t=this.__pendingValue;t!==_&&(R(t)?t!==this.value&&this.__commitText(t):t instanceof T?this.__commitTemplateResult(t):t instanceof Node?this.__commitNode(t):C(t)?this.__commitIterable(t):t===v?(this.value=v,this.clear()):this.__commitText(t))}__insert(t){this.endNode.parentNode.insertBefore(t,this.endNode)}__commitNode(t){this.value!==t&&(this.clear(),this.__insert(t),this.value=t)}__commitText(t){const e=this.startNode.nextSibling,n="string"==typeof(t=null==t?"":t)?t:String(t);e===this.endNode.previousSibling&&3===e.nodeType?e.data=n:this.__commitNode(document.createTextNode(n)),this.value=t}__commitTemplateResult(t){const e=this.options.templateFactory(t);if(this.value instanceof y&&this.value.template===e)this.value.update(t.values);else{const n=new y(e,t.processor,this.options),i=n._clone();n.update(t.values),this.__commitNode(i),this.value=n}}__commitIterable(t){Array.isArray(this.value)||(this.value=[],this.clear());const e=this.value;let n,i=0;for(const o of t)n=e[i],void 0===n&&(n=new I(this.options),e.push(n),0===i?n.appendIntoPart(this):n.insertAfterPart(e[i-1])),n.setValue(o),n.commit(),i++;i<e.length&&(e.length=i,this.clear(n&&n.endNode))}clear(t=this.startNode){n(this.startNode.parentNode,t.nextSibling,this.endNode)}}class O{constructor(t,e,n){if(this.value=void 0,this.__pendingValue=void 0,2!==n.length||""!==n[0]||""!==n[1])throw new Error("Boolean attributes can only contain a single expression");this.element=t,this.name=e,this.strings=n}setValue(t){this.__pendingValue=t}commit(){for(;m(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=_,t(this)}if(this.__pendingValue===_)return;const t=!!this.__pendingValue;this.value!==t&&(t?this.element.setAttribute(this.name,""):this.element.removeAttribute(this.name),this.value=t),this.__pendingValue=_}}class k extends x{constructor(t,e,n){super(t,e,n),this.single=2===n.length&&""===n[0]&&""===n[1]}_createPart(){return new w(this)}_getValue(){return this.single?this.parts[0].value:super._getValue()}commit(){this.dirty&&(this.dirty=!1,this.element[this.name]=this._getValue())}}class w extends S{}let A=!1;(()=>{try{const t={get capture(){return A=!0,!1}};window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(t){}})();class D{constructor(t,e,n){this.value=void 0,this.__pendingValue=void 0,this.element=t,this.eventName=e,this.eventContext=n,this.__boundHandleEvent=t=>this.handleEvent(t)}setValue(t){this.__pendingValue=t}commit(){for(;m(this.__pendingValue);){const t=this.__pendingValue;this.__pendingValue=_,t(this)}if(this.__pendingValue===_)return;const t=this.__pendingValue,e=this.value,n=null==t||null!=e&&(t.capture!==e.capture||t.once!==e.once||t.passive!==e.passive),i=null!=t&&(null==e||n);n&&this.element.removeEventListener(this.eventName,this.__boundHandleEvent,this.__options),i&&(this.__options=N(t),this.element.addEventListener(this.eventName,this.__boundHandleEvent,this.__options)),this.value=t,this.__pendingValue=_}handleEvent(t){"function"==typeof this.value?this.value.call(this.eventContext||this.element,t):this.value.handleEvent(t)}}const N=t=>t&&(A?{capture:t.capture,passive:t.passive,once:t.once}:t.capture);function L(t){let e=P.get(t.type);void 0===e&&(e={stringsArray:new WeakMap,keyString:new Map},P.set(t.type,e));let n=e.stringsArray.get(t.strings);if(void 0!==n)return n;const o=t.strings.join(i);return n=e.keyString.get(o),void 0===n&&(n=new s(t,t.getTemplateElement()),e.keyString.set(o,n)),e.stringsArray.set(t.strings,n),n}const P=new Map,M=new WeakMap;const B=new class{handleAttributeExpressions(t,e,n,i){const o=e[0];if("."===o){return new k(t,e.slice(1),n).parts}if("@"===o)return[new D(t,e.slice(1),i.eventContext)];if("?"===o)return[new O(t,e.slice(1),n)];return new x(t,e,n).parts}handleTextExpression(t){return new I(t)}};"undefined"!=typeof window&&(window.litHtmlVersions||(window.litHtmlVersions=[])).push("1.3.0");const F=(t,...e)=>new T(t,e,"html",B),H=(t,e)=>`${t}--${e}`;let U=!0;void 0===window.ShadyCSS?U=!1:void 0===window.ShadyCSS.prepareTemplateDom&&(console.warn("Incompatible ShadyCSS version detected. Please update to at least @webcomponents/webcomponentsjs@2.0.2 and @webcomponents/shadycss@1.3.1."),U=!1);const V=t=>e=>{const n=H(e.type,t);let o=P.get(n);void 0===o&&(o={stringsArray:new WeakMap,keyString:new Map},P.set(n,o));let r=o.stringsArray.get(e.strings);if(void 0!==r)return r;const a=e.strings.join(i);if(r=o.keyString.get(a),void 0===r){const n=e.getTemplateElement();U&&window.ShadyCSS.prepareTemplateDom(n,t),r=new s(e,n),o.keyString.set(a,r)}return o.stringsArray.set(e.strings,r),r},G=["html","svg"],W=new Set,z=(t,e,n)=>{W.add(t);const i=n?n.element:document.createElement("template"),o=e.querySelectorAll("style"),{length:r}=o;if(0===r)return void window.ShadyCSS.prepareTemplateStyles(i,t);const s=document.createElement("style");for(let t=0;t<r;t++){const e=o[t];e.parentNode.removeChild(e),s.textContent+=e.textContent}(t=>{G.forEach((e=>{const n=P.get(H(e,t));void 0!==n&&n.keyString.forEach((t=>{const{element:{content:e}}=t,n=new Set;Array.from(e.querySelectorAll("style")).forEach((t=>{n.add(t)})),u(t,n)}))}))})(t);const a=i.content;n?function(t,e,n=null){const{element:{content:i},parts:o}=t;if(null==n)return void i.appendChild(e);const r=document.createTreeWalker(i,133,null,!1);let s=p(o),a=0,l=-1;for(;r.nextNode();)for(l++,r.currentNode===n&&(a=h(e),n.parentNode.insertBefore(e,n));-1!==s&&o[s].index===l;){if(a>0){for(;-1!==s;)o[s].index+=a,s=p(o,s);return}s=p(o,s)}}(n,s,a.firstChild):a.insertBefore(s,a.firstChild),window.ShadyCSS.prepareTemplateStyles(i,t);const l=a.querySelector("style");if(window.ShadyCSS.nativeShadow&&null!==l)e.insertBefore(l.cloneNode(!0),e.firstChild);else if(n){a.insertBefore(s,a.firstChild);const t=new Set;t.add(s),u(n,t)}};window.JSCompiler_renameProperty=(t,e)=>t;const X={toAttribute(t,e){switch(e){case Boolean:return t?"":null;case Object:case Array:return null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){switch(e){case Boolean:return null!==t;case Number:return null===t?null:Number(t);case Object:case Array:return JSON.parse(t)}return t}},j=(t,e)=>e!==t&&(e==e||t==t),Y={attribute:!0,type:String,converter:X,reflect:!1,hasChanged:j};class K extends HTMLElement{constructor(){super(),this.initialize()}static get observedAttributes(){this.finalize();const t=[];return this._classProperties.forEach(((e,n)=>{const i=this._attributeNameForProperty(n,e);void 0!==i&&(this._attributeToPropertyMap.set(i,n),t.push(i))})),t}static _ensureClassProperties(){if(!this.hasOwnProperty(JSCompiler_renameProperty("_classProperties",this))){this._classProperties=new Map;const t=Object.getPrototypeOf(this)._classProperties;void 0!==t&&t.forEach(((t,e)=>this._classProperties.set(e,t)))}}static createProperty(t,e=Y){if(this._ensureClassProperties(),this._classProperties.set(t,e),e.noAccessor||this.prototype.hasOwnProperty(t))return;const n="symbol"==typeof t?Symbol():`__${t}`,i=this.getPropertyDescriptor(t,n,e);void 0!==i&&Object.defineProperty(this.prototype,t,i)}static getPropertyDescriptor(t,e,n){return{get(){return this[e]},set(i){const o=this[t];this[e]=i,this.requestUpdateInternal(t,o,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this._classProperties&&this._classProperties.get(t)||Y}static finalize(){const t=Object.getPrototypeOf(this);if(t.hasOwnProperty("finalized")||t.finalize(),this.finalized=!0,this._ensureClassProperties(),this._attributeToPropertyMap=new Map,this.hasOwnProperty(JSCompiler_renameProperty("properties",this))){const t=this.properties,e=[...Object.getOwnPropertyNames(t),..."function"==typeof Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t):[]];for(const n of e)this.createProperty(n,t[n])}}static _attributeNameForProperty(t,e){const n=e.attribute;return!1===n?void 0:"string"==typeof n?n:"string"==typeof t?t.toLowerCase():void 0}static _valueHasChanged(t,e,n=j){return n(t,e)}static _propertyValueFromAttribute(t,e){const n=e.type,i=e.converter||X,o="function"==typeof i?i:i.fromAttribute;return o?o(t,n):t}static _propertyValueToAttribute(t,e){if(void 0===e.reflect)return;const n=e.type,i=e.converter;return(i&&i.toAttribute||X.toAttribute)(t,n)}initialize(){this._updateState=0,this._updatePromise=new Promise((t=>this._enableUpdatingResolver=t)),this._changedProperties=new Map,this._saveInstanceProperties(),this.requestUpdateInternal()}_saveInstanceProperties(){this.constructor._classProperties.forEach(((t,e)=>{if(this.hasOwnProperty(e)){const t=this[e];delete this[e],this._instanceProperties||(this._instanceProperties=new Map),this._instanceProperties.set(e,t)}}))}_applyInstanceProperties(){this._instanceProperties.forEach(((t,e)=>this[e]=t)),this._instanceProperties=void 0}connectedCallback(){this.enableUpdating()}enableUpdating(){void 0!==this._enableUpdatingResolver&&(this._enableUpdatingResolver(),this._enableUpdatingResolver=void 0)}disconnectedCallback(){}attributeChangedCallback(t,e,n){e!==n&&this._attributeToProperty(t,n)}_propertyToAttribute(t,e,n=Y){const i=this.constructor,o=i._attributeNameForProperty(t,n);if(void 0!==o){const t=i._propertyValueToAttribute(e,n);if(void 0===t)return;this._updateState=8|this._updateState,null==t?this.removeAttribute(o):this.setAttribute(o,t),this._updateState=-9&this._updateState}}_attributeToProperty(t,e){if(8&this._updateState)return;const n=this.constructor,i=n._attributeToPropertyMap.get(t);if(void 0!==i){const t=n.getPropertyOptions(i);this._updateState=16|this._updateState,this[i]=n._propertyValueFromAttribute(e,t),this._updateState=-17&this._updateState}}requestUpdateInternal(t,e,n){let i=!0;if(void 0!==t){const o=this.constructor;n=n||o.getPropertyOptions(t),o._valueHasChanged(this[t],e,n.hasChanged)?(this._changedProperties.has(t)||this._changedProperties.set(t,e),!0!==n.reflect||16&this._updateState||(void 0===this._reflectingProperties&&(this._reflectingProperties=new Map),this._reflectingProperties.set(t,n))):i=!1}!this._hasRequestedUpdate&&i&&(this._updatePromise=this._enqueueUpdate())}requestUpdate(t,e){return this.requestUpdateInternal(t,e),this.updateComplete}async _enqueueUpdate(){this._updateState=4|this._updateState;try{await this._updatePromise}catch(t){}const t=this.performUpdate();return null!=t&&await t,!this._hasRequestedUpdate}get _hasRequestedUpdate(){return 4&this._updateState}get hasUpdated(){return 1&this._updateState}performUpdate(){if(!this._hasRequestedUpdate)return;this._instanceProperties&&this._applyInstanceProperties();let t=!1;const e=this._changedProperties;try{t=this.shouldUpdate(e),t?this.update(e):this._markUpdated()}catch(e){throw t=!1,this._markUpdated(),e}t&&(1&this._updateState||(this._updateState=1|this._updateState,this.firstUpdated(e)),this.updated(e))}_markUpdated(){this._changedProperties=new Map,this._updateState=-5&this._updateState}get updateComplete(){return this._getUpdateComplete()}_getUpdateComplete(){return this._updatePromise}shouldUpdate(t){return!0}update(t){void 0!==this._reflectingProperties&&this._reflectingProperties.size>0&&(this._reflectingProperties.forEach(((t,e)=>this._propertyToAttribute(e,this[e],t))),this._reflectingProperties=void 0),this._markUpdated()}updated(t){}firstUpdated(t){}}K.finalized=!0;const $=(t,e)=>"method"===e.kind&&e.descriptor&&!("value"in e.descriptor)?Object.assign(Object.assign({},e),{finisher(n){n.createProperty(e.key,t)}}):{kind:"field",key:Symbol(),placement:"own",descriptor:{},initializer(){"function"==typeof e.initializer&&(this[e.key]=e.initializer.call(this))},finisher(n){n.createProperty(e.key,t)}};function J(t){return(e,n)=>void 0!==n?((t,e,n)=>{e.constructor.createProperty(n,t)})(t,e,n):$(t,e)}function q(t){return J({attribute:!1,hasChanged:null==t?void 0:t.hasChanged})}function Z(t,e){return(n,i)=>{const o={get(){return this.renderRoot.querySelector(t)},enumerable:!0,configurable:!0};if(e){const e="symbol"==typeof i?Symbol():`__${i}`;o.get=function(){return void 0===this[e]&&(this[e]=this.renderRoot.querySelector(t)),this[e]}}return void 0!==i?tt(o,n,i):et(o,n)}}function Q(t){return(e,n)=>{const i={async get(){return await this.updateComplete,this.renderRoot.querySelector(t)},enumerable:!0,configurable:!0};return void 0!==n?tt(i,e,n):et(i,e)}}const tt=(t,e,n)=>{Object.defineProperty(e,n,t)},et=(t,e)=>({kind:"method",placement:"prototype",key:e.key,descriptor:t});function nt(t){return(e,n)=>void 0!==n?((t,e,n)=>{Object.assign(e[n],t)})(t,e,n):((t,e)=>Object.assign(Object.assign({},e),{finisher(n){Object.assign(n.prototype[e.key],t)}}))(t,e)}const it=window.ShadowRoot&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,ot=Symbol();class rt{constructor(t,e){if(e!==ot)throw new Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t}get styleSheet(){return void 0===this._styleSheet&&(it?(this._styleSheet=new CSSStyleSheet,this._styleSheet.replaceSync(this.cssText)):this._styleSheet=null),this._styleSheet}toString(){return this.cssText}}const st=(t,...e)=>{const n=e.reduce(((e,n,i)=>e+(t=>{if(t instanceof rt)return t.cssText;if("number"==typeof t)return t;throw new Error(`Value passed to 'css' function must be a 'css' function result: ${t}. Use 'unsafeCSS' to pass non-literal values, but\n            take care to ensure page security.`)})(n)+t[i+1]),t[0]);return new rt(n,ot)};(window.litElementVersions||(window.litElementVersions=[])).push("2.4.0");const at={};class lt extends K{static getStyles(){return this.styles}static _getUniqueStyles(){if(this.hasOwnProperty(JSCompiler_renameProperty("_styles",this)))return;const t=this.getStyles();if(Array.isArray(t)){const e=(t,n)=>t.reduceRight(((t,n)=>Array.isArray(n)?e(n,t):(t.add(n),t)),n),n=e(t,new Set),i=[];n.forEach((t=>i.unshift(t))),this._styles=i}else this._styles=void 0===t?[]:[t];this._styles=this._styles.map((t=>{if(t instanceof CSSStyleSheet&&!it){const e=Array.prototype.slice.call(t.cssRules).reduce(((t,e)=>t+e.cssText),"");return new rt(String(e),ot)}return t}))}initialize(){super.initialize(),this.constructor._getUniqueStyles(),this.renderRoot=this.createRenderRoot(),window.ShadowRoot&&this.renderRoot instanceof window.ShadowRoot&&this.adoptStyles()}createRenderRoot(){return this.attachShadow({mode:"open"})}adoptStyles(){const t=this.constructor._styles;0!==t.length&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow?it?this.renderRoot.adoptedStyleSheets=t.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet)):this._needsShimAdoptedStyleSheets=!0:window.ShadyCSS.ScopingShim.prepareAdoptedCssText(t.map((t=>t.cssText)),this.localName))}connectedCallback(){super.connectedCallback(),this.hasUpdated&&void 0!==window.ShadyCSS&&window.ShadyCSS.styleElement(this)}update(t){const e=this.render();super.update(t),e!==at&&this.constructor.render(e,this.renderRoot,{scopeName:this.localName,eventContext:this}),this._needsShimAdoptedStyleSheets&&(this._needsShimAdoptedStyleSheets=!1,this.constructor._styles.forEach((t=>{const e=document.createElement("style");e.textContent=t.cssText,this.renderRoot.appendChild(e)})))}render(){return at}}function ct(t,e){return(t.matches||t.webkitMatchesSelector||t.msMatchesSelector).call(t,e)}lt.finalized=!0,lt.render=(t,e,i)=>{if(!i||"object"!=typeof i||!i.scopeName)throw new Error("The `scopeName` option is required.");const o=i.scopeName,r=M.has(e),s=U&&11===e.nodeType&&!!e.host,a=s&&!W.has(o),l=a?document.createDocumentFragment():e;if(((t,e,i)=>{let o=M.get(e);void 0===o&&(n(e,e.firstChild),M.set(e,o=new I(Object.assign({templateFactory:L},i))),o.appendInto(e)),o.setValue(t),o.commit()})(t,l,Object.assign({templateFactory:V(o)},i)),a){const t=M.get(l);M.delete(l);const i=t.value instanceof y?t.value.template:void 0;z(o,l,i),n(e,e.firstChild),e.appendChild(l),M.set(e,t)}!r&&s&&window.ShadyCSS.styleElement(e.host)};const dt=t=>t.nodeType===Node.ELEMENT_NODE;function ut(t,e){for(const n of t.assignedNodes({flatten:!0}))if(dt(n)){const t=n;if(ct(t,e))return t}return null}function ht(t){return{addClass:e=>{t.classList.add(e)},removeClass:e=>{t.classList.remove(e)},hasClass:e=>t.classList.contains(e)}}const pt=()=>{},gt={get passive(){return!1}};document.addEventListener("x",pt,gt),document.removeEventListener("x",pt);const ft=(t=window.document)=>{let e=t.activeElement;const n=[];if(!e)return n;for(;e&&(n.push(e),e.shadowRoot);)e=e.shadowRoot.activeElement;return n},mt=t=>{const e=ft();if(!e.length)return!1;const n=e[e.length-1],i=new Event("check-if-focused",{bubbles:!0,composed:!0});let o=[];const r=t=>{o=t.composedPath()};return document.body.addEventListener("check-if-focused",r),n.dispatchEvent(i),document.body.removeEventListener("check-if-focused",r),-1!==o.indexOf(t)};class _t extends lt{click(){if(this.mdcRoot)return this.mdcRoot.focus(),void this.mdcRoot.click();super.click()}createFoundation(){void 0!==this.mdcFoundation&&this.mdcFoundation.destroy(),this.mdcFoundationClass&&(this.mdcFoundation=new this.mdcFoundationClass(this.createAdapter()),this.mdcFoundation.init())}firstUpdated(){this.createFoundation()}}const vt=t=>(e,n)=>{if(e.constructor._observers){if(!e.constructor.hasOwnProperty("_observers")){const t=e.constructor._observers;e.constructor._observers=new Map,t.forEach(((t,n)=>e.constructor._observers.set(n,t)))}}else{e.constructor._observers=new Map;const t=e.updated;e.updated=function(e){t.call(this,e),e.forEach(((t,e)=>{const n=this.constructor._observers.get(e);void 0!==n&&n.call(this,this[e],t)}))}}e.constructor._observers.set(n,t)};var yt=function(t,e){return(yt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var bt=function(){return(bt=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Et=function(){function t(t){void 0===t&&(t={}),this.adapter=t}return Object.defineProperty(t,"cssClasses",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{}},enumerable:!0,configurable:!0}),t.prototype.init=function(){},t.prototype.destroy=function(){},t}(),Tt={CLOSING:"mdc-snackbar--closing",OPEN:"mdc-snackbar--open",OPENING:"mdc-snackbar--opening"},Rt={ACTION_SELECTOR:".mdc-snackbar__action",ARIA_LIVE_LABEL_TEXT_ATTR:"data-mdc-snackbar-label-text",CLOSED_EVENT:"MDCSnackbar:closed",CLOSING_EVENT:"MDCSnackbar:closing",DISMISS_SELECTOR:".mdc-snackbar__dismiss",LABEL_SELECTOR:".mdc-snackbar__label",OPENED_EVENT:"MDCSnackbar:opened",OPENING_EVENT:"MDCSnackbar:opening",REASON_ACTION:"action",REASON_DISMISS:"dismiss",SURFACE_SELECTOR:".mdc-snackbar__surface"},Ct={DEFAULT_AUTO_DISMISS_TIMEOUT_MS:5e3,INDETERMINATE:-1,MAX_AUTO_DISMISS_TIMEOUT_MS:1e4,MIN_AUTO_DISMISS_TIMEOUT_MS:4e3,SNACKBAR_ANIMATION_CLOSE_TIME_MS:75,SNACKBAR_ANIMATION_OPEN_TIME_MS:150,ARIA_LIVE_DELAY_MS:1e3},xt=Tt.OPENING,St=Tt.OPEN,It=Tt.CLOSING,Ot=Rt.REASON_ACTION,kt=Rt.REASON_DISMISS,wt=function(t){function e(n){var i=t.call(this,bt(bt({},e.defaultAdapter),n))||this;return i.isOpen_=!1,i.animationFrame_=0,i.animationTimer_=0,i.autoDismissTimer_=0,i.autoDismissTimeoutMs_=Ct.DEFAULT_AUTO_DISMISS_TIMEOUT_MS,i.closeOnEscape_=!0,i}return function(t,e){function n(){this.constructor=t}yt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return Tt},enumerable:!0,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return Rt},enumerable:!0,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return Ct},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},announce:function(){},notifyClosed:function(){},notifyClosing:function(){},notifyOpened:function(){},notifyOpening:function(){},removeClass:function(){}}},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.clearAutoDismissTimer_(),cancelAnimationFrame(this.animationFrame_),this.animationFrame_=0,clearTimeout(this.animationTimer_),this.animationTimer_=0,this.adapter.removeClass(xt),this.adapter.removeClass(St),this.adapter.removeClass(It)},e.prototype.open=function(){var t=this;this.clearAutoDismissTimer_(),this.isOpen_=!0,this.adapter.notifyOpening(),this.adapter.removeClass(It),this.adapter.addClass(xt),this.adapter.announce(),this.runNextAnimationFrame_((function(){t.adapter.addClass(St),t.animationTimer_=setTimeout((function(){var e=t.getTimeoutMs();t.handleAnimationTimerEnd_(),t.adapter.notifyOpened(),e!==Ct.INDETERMINATE&&(t.autoDismissTimer_=setTimeout((function(){t.close(kt)}),e))}),Ct.SNACKBAR_ANIMATION_OPEN_TIME_MS)}))},e.prototype.close=function(t){var e=this;void 0===t&&(t=""),this.isOpen_&&(cancelAnimationFrame(this.animationFrame_),this.animationFrame_=0,this.clearAutoDismissTimer_(),this.isOpen_=!1,this.adapter.notifyClosing(t),this.adapter.addClass(Tt.CLOSING),this.adapter.removeClass(Tt.OPEN),this.adapter.removeClass(Tt.OPENING),clearTimeout(this.animationTimer_),this.animationTimer_=setTimeout((function(){e.handleAnimationTimerEnd_(),e.adapter.notifyClosed(t)}),Ct.SNACKBAR_ANIMATION_CLOSE_TIME_MS))},e.prototype.isOpen=function(){return this.isOpen_},e.prototype.getTimeoutMs=function(){return this.autoDismissTimeoutMs_},e.prototype.setTimeoutMs=function(t){var e=Ct.MIN_AUTO_DISMISS_TIMEOUT_MS,n=Ct.MAX_AUTO_DISMISS_TIMEOUT_MS;if(!(t===Ct.INDETERMINATE||t<=n&&t>=e))throw new Error("\n        timeoutMs must be an integer in the range "+e+"â€“"+n+"\n        (or "+Ct.INDETERMINATE+" to disable), but got '"+t+"'");this.autoDismissTimeoutMs_=t},e.prototype.getCloseOnEscape=function(){return this.closeOnEscape_},e.prototype.setCloseOnEscape=function(t){this.closeOnEscape_=t},e.prototype.handleKeyDown=function(t){("Escape"===t.key||27===t.keyCode)&&this.getCloseOnEscape()&&this.close(kt)},e.prototype.handleActionButtonClick=function(t){this.close(Ot)},e.prototype.handleActionIconClick=function(t){this.close(kt)},e.prototype.clearAutoDismissTimer_=function(){clearTimeout(this.autoDismissTimer_),this.autoDismissTimer_=0},e.prototype.handleAnimationTimerEnd_=function(){this.animationTimer_=0,this.adapter.removeClass(Tt.OPENING),this.adapter.removeClass(Tt.CLOSING)},e.prototype.runNextAnimationFrame_=function(t){var e=this;cancelAnimationFrame(this.animationFrame_),this.animationFrame_=requestAnimationFrame((function(){e.animationFrame_=0,clearTimeout(e.animationTimer_),e.animationTimer_=setTimeout(t,0)}))},e}(Et);class At{constructor(t){this.classes=new Set,this.changed=!1,this.element=t;const e=(t.getAttribute("class")||"").split(/\s+/);for(const t of e)this.classes.add(t)}add(t){this.classes.add(t),this.changed=!0}remove(t){this.classes.delete(t),this.changed=!0}commit(){if(this.changed){let t="";this.classes.forEach((e=>t+=e+" ")),this.element.setAttribute("class",t)}}}const Dt=new WeakMap,Nt=f((t=>e=>{if(!(e instanceof S)||e instanceof w||"class"!==e.committer.name||e.committer.parts.length>1)throw new Error("The `classMap` directive must be used in the `class` attribute and must be the only part in the attribute.");const{committer:n}=e,{element:i}=n;let o=Dt.get(e);void 0===o&&(i.setAttribute("class",n.strings.join(" ")),Dt.set(e,o=new Set));const r=i.classList||new At(i);o.forEach((e=>{e in t||(r.remove(e),o.delete(e))}));for(const e in t){const n=t[e];n!=o.has(e)&&(n?(r.add(e),o.add(e)):(r.remove(e),o.delete(e)))}"function"==typeof r.commit&&r.commit()}));let Lt,Pt,Mt=t=>t;const{ARIA_LIVE_LABEL_TEXT_ATTR:Bt}=wt.strings,{ARIA_LIVE_DELAY_MS:Ft}=wt.numbers,Ht=new WeakMap,Ut=f(((t,e)=>n=>{if(!e)return;let i=Ht.get(n);if(void 0===i){const e=document.createElement("div");return e.setAttribute("class","mdc-snackbar__label"),e.setAttribute("role","status"),e.setAttribute("aria-live","polite"),e.textContent=t,n.endNode.parentNode.insertBefore(e,n.endNode),i={labelEl:e,timerId:null},void Ht.set(n,i)}const o=i,r=o.labelEl;r.setAttribute("aria-live","off"),r.textContent="",r.innerHTML='<span style="display: inline-block; width: 0; height: 1px;">&nbsp;</span>',r.setAttribute(Bt,t),null!==o.timerId&&clearTimeout(o.timerId),o.timerId=window.setTimeout((()=>{o.timerId=null,r.setAttribute("aria-live","polite"),r.removeAttribute(Bt),r.textContent=t}),Ft)})),{OPENING_EVENT:Vt,OPENED_EVENT:Gt,CLOSING_EVENT:Wt,CLOSED_EVENT:zt}=wt.strings;class Xt extends _t{constructor(){super(...arguments),this.mdcFoundationClass=wt,this.open=!1,this.timeoutMs=5e3,this.closeOnEscape=!1,this.labelText="",this.stacked=!1,this.leading=!1,this.reason=""}render(){const t={"mdc-snackbar--stacked":this.stacked,"mdc-snackbar--leading":this.leading};return F(Lt||(Lt=Mt` <div class="mdc-snackbar ${0}" @keydown="${0}"> <div class="mdc-snackbar__surface"> ${0} <div class="mdc-snackbar__actions"> <slot name="action" @click="${0}"></slot> <slot name="dismiss" @click="${0}"></slot> </div> </div> </div>`),Nt(t),this._handleKeydown,Ut(this.labelText,this.open),this._handleActionClick,this._handleDismissClick)}createAdapter(){return Object.assign(Object.assign({},ht(this.mdcRoot)),{announce:()=>{},notifyClosed:t=>{this.dispatchEvent(new CustomEvent(zt,{bubbles:!0,cancelable:!0,detail:{reason:t}}))},notifyClosing:t=>{this.open=!1,this.dispatchEvent(new CustomEvent(Wt,{bubbles:!0,cancelable:!0,detail:{reason:t}}))},notifyOpened:()=>{this.dispatchEvent(new CustomEvent(Gt,{bubbles:!0,cancelable:!0}))},notifyOpening:()=>{this.open=!0,this.dispatchEvent(new CustomEvent(Vt,{bubbles:!0,cancelable:!0}))}})}show(){this.open=!0}close(t=""){this.reason=t,this.open=!1}firstUpdated(){super.firstUpdated(),this.open&&this.mdcFoundation.open()}_handleKeydown(t){this.mdcFoundation.handleKeyDown(t)}_handleActionClick(t){this.mdcFoundation.handleActionButtonClick(t)}_handleDismissClick(t){this.mdcFoundation.handleActionIconClick(t)}}t([Z(".mdc-snackbar")],Xt.prototype,"mdcRoot",void 0),t([Z(".mdc-snackbar__label")],Xt.prototype,"labelElement",void 0),t([J({type:Boolean,reflect:!0}),vt((function(t){this.mdcFoundation&&(t?this.mdcFoundation.open():(this.mdcFoundation.close(this.reason),this.reason=""))}))],Xt.prototype,"open",void 0),t([vt((function(t){this.mdcFoundation.setTimeoutMs(t)})),J({type:Number})],Xt.prototype,"timeoutMs",void 0),t([vt((function(t){this.mdcFoundation.setCloseOnEscape(t)})),J({type:Boolean})],Xt.prototype,"closeOnEscape",void 0),t([J({type:String})],Xt.prototype,"labelText",void 0),t([J({type:Boolean})],Xt.prototype,"stacked",void 0),t([J({type:Boolean})],Xt.prototype,"leading",void 0);const jt=st(Pt||(Pt=Mt`.mdc-snackbar{z-index:8;margin:8px;display:none;position:fixed;right:0;bottom:0;left:0;align-items:center;justify-content:center;box-sizing:border-box;pointer-events:none;-webkit-tap-highlight-color:transparent}.mdc-snackbar__surface{background-color:#333}.mdc-snackbar__label{color:rgba(255,255,255,.87)}.mdc-snackbar__surface{min-width:344px}@media(max-width:480px),(max-width:344px){.mdc-snackbar__surface{min-width:100%}}.mdc-snackbar__surface{max-width:672px}.mdc-snackbar__surface{box-shadow:0 3px 5px -1px rgba(0,0,0,.2),0 6px 10px 0 rgba(0,0,0,.14),0 1px 18px 0 rgba(0,0,0,.12)}.mdc-snackbar__surface{border-radius:4px;border-radius:var(--mdc-shape-small,4px)}.mdc-snackbar--closing,.mdc-snackbar--open,.mdc-snackbar--opening{display:flex}.mdc-snackbar--open .mdc-snackbar__actions,.mdc-snackbar--open .mdc-snackbar__label{visibility:visible}.mdc-snackbar--leading{justify-content:flex-start}.mdc-snackbar--stacked .mdc-snackbar__label{padding-left:16px;padding-right:8px;padding-bottom:12px}.mdc-snackbar--stacked .mdc-snackbar__label[dir=rtl],[dir=rtl] .mdc-snackbar--stacked .mdc-snackbar__label{padding-left:8px;padding-right:16px}.mdc-snackbar--stacked .mdc-snackbar__surface{flex-direction:column;align-items:flex-start}.mdc-snackbar--stacked .mdc-snackbar__actions{align-self:flex-end;margin-bottom:8px}.mdc-snackbar__surface{padding-left:0;padding-right:8px;display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;transform:scale(.8);opacity:0}.mdc-snackbar__surface[dir=rtl],[dir=rtl] .mdc-snackbar__surface{padding-left:8px;padding-right:0}.mdc-snackbar--open .mdc-snackbar__surface{transform:scale(1);opacity:1;pointer-events:auto;transition:opacity 150ms 0s cubic-bezier(0,0,.2,1),transform 150ms 0s cubic-bezier(0,0,.2,1)}.mdc-snackbar--closing .mdc-snackbar__surface{transform:scale(1);transition:opacity 75ms 0s cubic-bezier(.4,0,1,1)}.mdc-snackbar__label{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto,sans-serif;font-family:var(--mdc-typography-body2-font-family,var(--mdc-typography-font-family,Roboto,sans-serif));font-size:.875rem;font-size:var(--mdc-typography-body2-font-size,.875rem);line-height:1.25rem;line-height:var(--mdc-typography-body2-line-height,1.25rem);font-weight:400;font-weight:var(--mdc-typography-body2-font-weight,400);letter-spacing:.0178571429em;letter-spacing:var(--mdc-typography-body2-letter-spacing,.0178571429em);text-decoration:inherit;text-decoration:var(--mdc-typography-body2-text-decoration,inherit);text-transform:inherit;text-transform:var(--mdc-typography-body2-text-transform,inherit);padding-left:16px;padding-right:8px;width:100%;flex-grow:1;box-sizing:border-box;margin:0;visibility:hidden;padding-top:14px;padding-bottom:14px}.mdc-snackbar__label[dir=rtl],[dir=rtl] .mdc-snackbar__label{padding-left:8px;padding-right:16px}.mdc-snackbar__label::before{display:inline;content:attr(data-mdc-snackbar-label-text)}.mdc-snackbar__actions{display:flex;flex-shrink:0;align-items:center;box-sizing:border-box;visibility:hidden}.mdc-snackbar__action:not(:disabled){color:#bb86fc}.mdc-snackbar__action::after,.mdc-snackbar__action::before{background-color:#bb86fc;background-color:var(--mdc-ripple-color,#bb86fc)}.mdc-snackbar__action.mdc-ripple-surface--hover::before,.mdc-snackbar__action:hover::before{opacity:.08;opacity:var(--mdc-ripple-hover-opacity,.08)}.mdc-snackbar__action.mdc-ripple-upgraded--background-focused::before,.mdc-snackbar__action:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:.24;opacity:var(--mdc-ripple-focus-opacity,.24)}.mdc-snackbar__action:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mdc-snackbar__action:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:.24;opacity:var(--mdc-ripple-press-opacity,.24)}.mdc-snackbar__action.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.24)}.mdc-snackbar__dismiss{color:rgba(255,255,255,.87)}.mdc-snackbar__dismiss::after,.mdc-snackbar__dismiss::before{background-color:rgba(255,255,255,.87);background-color:var(--mdc-ripple-color,rgba(255,255,255,.87))}.mdc-snackbar__dismiss.mdc-ripple-surface--hover::before,.mdc-snackbar__dismiss:hover::before{opacity:.08;opacity:var(--mdc-ripple-hover-opacity,.08)}.mdc-snackbar__dismiss.mdc-ripple-upgraded--background-focused::before,.mdc-snackbar__dismiss:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:.24;opacity:var(--mdc-ripple-focus-opacity,.24)}.mdc-snackbar__dismiss:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mdc-snackbar__dismiss:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:.24;opacity:var(--mdc-ripple-press-opacity,.24)}.mdc-snackbar__dismiss.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.24)}.mdc-snackbar__dismiss.mdc-snackbar__dismiss{width:36px;height:36px;padding:9px;font-size:18px}.mdc-snackbar__dismiss.mdc-snackbar__dismiss img,.mdc-snackbar__dismiss.mdc-snackbar__dismiss svg{width:18px;height:18px}.mdc-snackbar__action+.mdc-snackbar__dismiss{margin-left:8px;margin-right:0}.mdc-snackbar__action+.mdc-snackbar__dismiss[dir=rtl],[dir=rtl] .mdc-snackbar__action+.mdc-snackbar__dismiss{margin-left:0;margin-right:8px}slot[name=action]::slotted(mwc-button){--mdc-theme-primary:var(--mdc-snackbar-action-color, #bb86fc)}slot[name=dismiss]::slotted(mwc-icon-button){--mdc-icon-size:18px;--mdc-icon-button-size:36px;color:rgba(255,255,255,.87);margin-left:8px;margin-right:0}[dir=rtl] slot[name=dismiss]::slotted(mwc-icon-button),slot[name=dismiss]::slotted(mwc-icon-button)[dir=rtl]{margin-left:0;margin-right:8px}`));class Yt extends Xt{}Yt.styles=jt;const Kt=new WeakMap,$t=f((t=>e=>{const n=Kt.get(e);if(void 0===t&&e instanceof S){if(void 0!==n||!Kt.has(e)){const t=e.committer.name;e.committer.element.removeAttribute(t)}}else t!==n&&e.setValue(t);Kt.set(e,t)})),Jt=new WeakMap,qt=f((t=>e=>{if(!(e instanceof S)||e instanceof w||"style"!==e.committer.name||e.committer.parts.length>1)throw new Error("The `styleMap` directive must be used in the style attribute and must be the only part in the attribute.");const{committer:n}=e,{style:i}=n.element;let o=Jt.get(e);void 0===o&&(i.cssText=n.strings.join(" "),Jt.set(e,o=new Set)),o.forEach((e=>{e in t||(o.delete(e),-1===e.indexOf("-")?i[e]=null:i.removeProperty(e))}));for(const e in t)o.add(e),-1===e.indexOf("-")?i[e]=t[e]:i.setProperty(e,t[e])}));let Zt,Qt,te,ee,ne=t=>t;class ie extends lt{constructor(){super(...arguments),this.indeterminate=!1,this.progress=0,this.density=0,this.closed=!1,this.ariaLabel=""}open(){this.closed=!1}close(){this.closed=!0}render(){const t={"mdc-circular-progress--closed":this.closed,"mdc-circular-progress--indeterminate":this.indeterminate},e=48+4*this.density,n={width:`${e}px`,height:`${e}px`};return F(Zt||(Zt=ne` <div class="mdc-circular-progress ${0}" style="${0}" role="progressbar" aria-label="${0}" aria-valuemin="0" aria-valuemax="1" aria-valuenow="${0}"> ${0} ${0} </div>`),Nt(t),qt(n),this.ariaLabel,$t(this.indeterminate?void 0:this.progress),this.renderDeterminateContainer(),this.renderIndeterminateContainer())}renderDeterminateContainer(){const t=48+4*this.density,e=t/2,n=this.density>=-3?18+11*this.density/6:12.5+5*(this.density+3)/4,i=6.2831852*n,o=(1-this.progress)*i,r=this.density>=-3?4+this.density*(1/3):3+(this.density+3)*(1/6);return F(Qt||(Qt=ne` <div class="mdc-circular-progress__determinate-container"> <svg class="mdc-circular-progress__determinate-circle-graphic" viewBox="0 0 ${0} ${0}"> <circle class="mdc-circular-progress__determinate-track" cx="${0}" cy="${0}" r="${0}" stroke-width="${0}"></circle> <circle class="mdc-circular-progress__determinate-circle" cx="${0}" cy="${0}" r="${0}" stroke-dasharray="${0}" stroke-dashoffset="${0}" stroke-width="${0}"></circle> </svg> </div>`),t,t,e,e,n,r,e,e,n,6.2831852*n,o,r)}renderIndeterminateContainer(){return F(te||(te=ne` <div class="mdc-circular-progress__indeterminate-container"> <div class="mdc-circular-progress__spinner-layer"> ${0} </div> </div>`),this.renderIndeterminateSpinnerLayer())}renderIndeterminateSpinnerLayer(){const t=48+4*this.density,e=t/2,n=this.density>=-3?18+11*this.density/6:12.5+5*(this.density+3)/4,i=6.2831852*n,o=.5*i,r=this.density>=-3?4+this.density*(1/3):3+(this.density+3)*(1/6);return F(ee||(ee=ne` <div class="mdc-circular-progress__circle-clipper mdc-circular-progress__circle-left"> <svg class="mdc-circular-progress__indeterminate-circle-graphic" viewBox="0 0 ${0} ${0}"> <circle cx="${0}" cy="${0}" r="${0}" stroke-dasharray="${0}" stroke-dashoffset="${0}" stroke-width="${0}"></circle> </svg> </div> <div class="mdc-circular-progress__gap-patch"> <svg class="mdc-circular-progress__indeterminate-circle-graphic" viewBox="0 0 ${0} ${0}"> <circle cx="${0}" cy="${0}" r="${0}" stroke-dasharray="${0}" stroke-dashoffset="${0}" stroke-width="${0}"></circle> </svg> </div> <div class="mdc-circular-progress__circle-clipper mdc-circular-progress__circle-right"> <svg class="mdc-circular-progress__indeterminate-circle-graphic" viewBox="0 0 ${0} ${0}"> <circle cx="${0}" cy="${0}" r="${0}" stroke-dasharray="${0}" stroke-dashoffset="${0}" stroke-width="${0}"></circle> </svg> </div>`),t,t,e,e,n,i,o,r,t,t,e,e,n,i,o,.8*r,t,t,e,e,n,i,o,r)}update(t){super.update(t),t.has("progress")&&(this.progress>1&&(this.progress=1),this.progress<0&&(this.progress=0))}}t([J({type:Boolean,reflect:!0})],ie.prototype,"indeterminate",void 0),t([J({type:Number,reflect:!0})],ie.prototype,"progress",void 0),t([J({type:Number,reflect:!0})],ie.prototype,"density",void 0),t([J({type:Boolean,reflect:!0})],ie.prototype,"closed",void 0),t([J({type:String})],ie.prototype,"ariaLabel",void 0);let oe;const re=st(oe||(oe=(t=>t)`.mdc-circular-progress__determinate-circle,.mdc-circular-progress__indeterminate-circle-graphic{stroke:#6200ee;stroke:var(--mdc-theme-primary,#6200ee)}.mdc-circular-progress__determinate-track{stroke:transparent}@keyframes mdc-circular-progress-container-rotate{to{transform:rotate(360deg)}}@keyframes mdc-circular-progress-spinner-layer-rotate{12.5%{transform:rotate(135deg)}25%{transform:rotate(270deg)}37.5%{transform:rotate(405deg)}50%{transform:rotate(540deg)}62.5%{transform:rotate(675deg)}75%{transform:rotate(810deg)}87.5%{transform:rotate(945deg)}100%{transform:rotate(1080deg)}}@keyframes mdc-circular-progress-color-1-fade-in-out{from{opacity:.99}25%{opacity:.99}26%{opacity:0}89%{opacity:0}90%{opacity:.99}to{opacity:.99}}@keyframes mdc-circular-progress-color-2-fade-in-out{from{opacity:0}15%{opacity:0}25%{opacity:.99}50%{opacity:.99}51%{opacity:0}to{opacity:0}}@keyframes mdc-circular-progress-color-3-fade-in-out{from{opacity:0}40%{opacity:0}50%{opacity:.99}75%{opacity:.99}76%{opacity:0}to{opacity:0}}@keyframes mdc-circular-progress-color-4-fade-in-out{from{opacity:0}65%{opacity:0}75%{opacity:.99}90%{opacity:.99}to{opacity:0}}@keyframes mdc-circular-progress-left-spin{from{transform:rotate(265deg)}50%{transform:rotate(130deg)}to{transform:rotate(265deg)}}@keyframes mdc-circular-progress-right-spin{from{transform:rotate(-265deg)}50%{transform:rotate(-130deg)}to{transform:rotate(-265deg)}}.mdc-circular-progress{display:inline-flex;position:relative;direction:ltr;transition:opacity 250ms 0s cubic-bezier(.4,0,.6,1)}.mdc-circular-progress__determinate-container,.mdc-circular-progress__indeterminate-circle-graphic,.mdc-circular-progress__indeterminate-container,.mdc-circular-progress__spinner-layer{position:absolute;width:100%;height:100%}.mdc-circular-progress__determinate-container{transform:rotate(-90deg)}.mdc-circular-progress__indeterminate-container{font-size:0;letter-spacing:0;white-space:nowrap;opacity:0}.mdc-circular-progress__determinate-circle-graphic,.mdc-circular-progress__indeterminate-circle-graphic{fill:transparent}.mdc-circular-progress__determinate-circle{transition:stroke-dashoffset .5s 0s cubic-bezier(0,0,.2,1)}.mdc-circular-progress__gap-patch{position:absolute;top:0;left:47.5%;box-sizing:border-box;width:5%;height:100%;overflow:hidden}.mdc-circular-progress__gap-patch .mdc-circular-progress__indeterminate-circle-graphic{left:-900%;width:2000%;transform:rotate(180deg)}.mdc-circular-progress__circle-clipper{display:inline-flex;position:relative;width:50%;height:100%;overflow:hidden}.mdc-circular-progress__circle-clipper .mdc-circular-progress__indeterminate-circle-graphic{width:200%}.mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{left:-100%}.mdc-circular-progress--indeterminate .mdc-circular-progress__determinate-container{opacity:0}.mdc-circular-progress--indeterminate .mdc-circular-progress__indeterminate-container{opacity:1}.mdc-circular-progress--indeterminate .mdc-circular-progress__indeterminate-container{animation:mdc-circular-progress-container-rotate 1.568s linear infinite}.mdc-circular-progress--indeterminate .mdc-circular-progress__spinner-layer{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(.4,0,.2,1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-1{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(.4,0,.2,1) infinite both,mdc-circular-progress-color-1-fade-in-out 5332ms cubic-bezier(.4,0,.2,1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-2{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(.4,0,.2,1) infinite both,mdc-circular-progress-color-2-fade-in-out 5332ms cubic-bezier(.4,0,.2,1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-3{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(.4,0,.2,1) infinite both,mdc-circular-progress-color-3-fade-in-out 5332ms cubic-bezier(.4,0,.2,1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__color-4{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(.4,0,.2,1) infinite both,mdc-circular-progress-color-4-fade-in-out 5332ms cubic-bezier(.4,0,.2,1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-left .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-left-spin 1333ms cubic-bezier(.4,0,.2,1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-right-spin 1333ms cubic-bezier(.4,0,.2,1) infinite both}.mdc-circular-progress--closed{opacity:0}:host{display:inline-flex}.mdc-circular-progress__determinate-track{stroke:transparent;stroke:var(--mdc-circular-progress-track-color,transparent)}`));class se extends ie{}se.styles=re;class ae{constructor(t){this.startPress=e=>{t().then((t=>{t&&t.startPress(e)}))},this.endPress=()=>{t().then((t=>{t&&t.endPress()}))},this.startFocus=()=>{t().then((t=>{t&&t.startFocus()}))},this.endFocus=()=>{t().then((t=>{t&&t.endFocus()}))},this.startHover=()=>{t().then((t=>{t&&t.startHover()}))},this.endHover=()=>{t().then((t=>{t&&t.endHover()}))}}}let le;const ce=st(le||(le=(t=>t)`.material-icons{font-family:var(--mdc-icon-font, "Material Icons");font-weight:400;font-style:normal;font-size:var(--mdc-icon-size,24px);line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;font-feature-settings:"liga"}.mdc-icon-button{display:inline-block;position:relative;box-sizing:border-box;border:none;outline:0;background-color:transparent;fill:currentColor;color:inherit;font-size:24px;text-decoration:none;cursor:pointer;user-select:none;width:48px;height:48px;padding:12px}.mdc-icon-button img,.mdc-icon-button svg{width:24px;height:24px}.mdc-icon-button:disabled{color:rgba(0,0,0,.38);color:var(--mdc-theme-text-disabled-on-light,rgba(0,0,0,.38))}.mdc-icon-button:disabled{cursor:default;pointer-events:none}.mdc-icon-button__icon{display:inline-block}.mdc-icon-button__icon.mdc-icon-button__icon--on{display:none}.mdc-icon-button--on .mdc-icon-button__icon{display:none}.mdc-icon-button--on .mdc-icon-button__icon.mdc-icon-button__icon--on{display:inline-block}:host{display:inline-block;outline:0;--mdc-ripple-color:currentcolor;-webkit-tap-highlight-color:transparent}:host([disabled]){pointer-events:none}.mdc-icon-button,:host{vertical-align:top}.mdc-icon-button{width:var(--mdc-icon-button-size,48px);height:var(--mdc-icon-button-size,48px);padding:calc((var(--mdc-icon-button-size,48px) - var(--mdc-icon-size,24px))/ 2)}.mdc-icon-button>i{position:absolute;top:0;padding-top:inherit}.mdc-icon-button ::slotted(*),.mdc-icon-button i,.mdc-icon-button img,.mdc-icon-button svg{display:block;width:var(--mdc-icon-size,24px);height:var(--mdc-icon-size,24px)}`)),de=new WeakMap;function ue(t){return e=>{if(function(t,e){let n=e;for(;n;){if(de.get(n)===t)return!0;n=Object.getPrototypeOf(n)}return!1}(t,e))return e;const n=t(e);return de.set(n,t),n}}class he{constructor(t){this._parent=t,this._cache=new Map}has(t){return!!(this._cache.has(t)||this._parent&&this._parent._cache.has(t))}set(t,e){return this._cache.set(t,e),this}get(t){return this._cache.get(t)||this._parent&&this._parent._cache.get(t)}}let pe=Math.round(1e5*Math.random());const ge=new RegExp("[a-z](-|\\.|[0-9]|[a-z])*-(-|\\.|[0-9]|[a-z])*"),fe=(t,e)=>{const n=`${t}-${pe+=1}`;return((t,e)=>!!e.get(t))(n,e)?fe(t,e):n};function me(t,e=customElements){if(n=t,null===ge.exec(n))throw new Error("tagName is invalid");var n;return fe(t,e)}const _e=new WeakMap,ve=(t,e)=>_e.set(e,t),ye=(t,e,n=customElements)=>{ve(t,e),n.define(t,class extends e{})},be=(t,e,n)=>{const i=customElements;if(!(t=>Object.prototype.isPrototypeOf.call(HTMLElement,t))(e))return((t,e,n)=>{const i=me(t,e);if(!n)throw new Error("Lazy scoped elements requires the use of tags cache");return n.set(t,i),i})(t,i,n);if(e===customElements.get(t))return ve(t,e),t;const o=me(t,i);return ye(o,e,i),o};function Ee(t,e,n){return(t=>_e.get(t))(e)||n&&n.get(t)||be(t,e,n)}const Te="-|\\.|[0-9]|[a-z]",Re=new RegExp(`<\\/?([a-z](${Te})*-(${Te})*)`,"g"),Ce=new he,xe=(t,e,n,i)=>{const o=t.map((t=>{let n=t;const o=(t=>{const e=[];let n;for(;null!==(n=Re.exec(t));)e.push(n);return e})(t);for(let t=o.length-1;t>=0;t-=1){const r=o[t],[s,a]=r,l=Ee(a,e[a],i),c=r.index+s.length-a.length,d=c+a.length,u=0===s.indexOf("</");n=n.slice(0,c)+(u?l:`${l} data-tag-name="${a}"`)+n.slice(d)}return n}));return n.set(t,o),o};let Se=!0;const{ShadyCSS:Ie}=window;(void 0===Ie||void 0===Ie.prepareTemplateDom)&&(Se=!1);const Oe=new WeakMap,ke=new WeakMap,we=t=>(ke.has(t)||ke.set(t,new he(ke.get(t.constructor))),ke.get(t)),Ae=(t,e,n,i)=>t.map((t=>t instanceof T?De(t,e,n,i):Array.isArray(t)?Ae(t,e,n,i):t)),De=(t,e,n,i)=>new T(function(t,e,n=Ce,i){return n.get(t)||xe(t,e,n,i)}(t.strings,e,n,i),Ae(t.values,e,n,i),t.type,t.processor),Ne=(t,e,n,o)=>r=>{const a=De(r,e,n,o);return(t=>e=>{const n=((t,e)=>`${t}--${e}`)(e.type,t);let o=P.get(n);void 0===o&&(o={stringsArray:new WeakMap,keyString:new Map},P.set(n,o));let r=o.stringsArray.get(e.strings);if(void 0!==r)return r;const a=e.strings.join(i);if(r=o.keyString.get(a),void 0===r){const n=e.getTemplateElement();Se&&Ie.prepareTemplateDom(n,t),r=new s(e,n),o.keyString.set(a,r)}return o.stringsArray.set(e.strings,r),r})(t)(a)},Le=ue((t=>class extends t{static get scopedElements(){return{}}static render(t,e,n){if(!n||"object"!=typeof n||!n.scopeName)throw new Error("The `scopeName` option is required.");const{scopeName:i,eventContext:o}=n,r=(s=o,Oe.has(s)||Oe.set(s,new he(Oe.get(s.constructor))),Oe.get(s));var s;const a=we(o),{scopedElements:l}=this;return super.render(t,e,{...n,templateFactory:Ne(i,l,r,a)})}defineScopedElement(t,e){return function(t,e,n){const i=n.get(t);i?void 0===customElements.get(i)&&ye(i,e,customElements):n.set(t,Ee(t,e,n))}(t,e,we(this))}static getScopedTagName(t){const e=this.scopedElements[t];return e?Ee(t,e,we(this)):we(this).get(t)}getScopedTagName(t){const e=this.constructor.scopedElements[t];return e?Ee(t,e,we(this)):we(this).get(t)}}));var Pe=function(t,e){return(Pe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var Me=function(){return(Me=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Be={BG_FOCUSED:"mdc-ripple-upgraded--background-focused",FG_ACTIVATION:"mdc-ripple-upgraded--foreground-activation",FG_DEACTIVATION:"mdc-ripple-upgraded--foreground-deactivation",ROOT:"mdc-ripple-upgraded",UNBOUNDED:"mdc-ripple-upgraded--unbounded"},Fe={VAR_FG_SCALE:"--mdc-ripple-fg-scale",VAR_FG_SIZE:"--mdc-ripple-fg-size",VAR_FG_TRANSLATE_END:"--mdc-ripple-fg-translate-end",VAR_FG_TRANSLATE_START:"--mdc-ripple-fg-translate-start",VAR_LEFT:"--mdc-ripple-left",VAR_TOP:"--mdc-ripple-top"},He={DEACTIVATION_TIMEOUT_MS:225,FG_DEACTIVATION_MS:150,INITIAL_ORIGIN_SCALE:.6,PADDING:10,TAP_DELAY_MS:300};var Ue=["touchstart","pointerdown","mousedown","keydown"],Ve=["touchend","pointerup","mouseup","contextmenu"],Ge=[],We=function(t){function e(n){var i=t.call(this,Me(Me({},e.defaultAdapter),n))||this;return i.activationAnimationHasEnded_=!1,i.activationTimer_=0,i.fgDeactivationRemovalTimer_=0,i.fgScale_="0",i.frame_={width:0,height:0},i.initialSize_=0,i.layoutFrame_=0,i.maxRadius_=0,i.unboundedCoords_={left:0,top:0},i.activationState_=i.defaultActivationState_(),i.activationTimerCallback_=function(){i.activationAnimationHasEnded_=!0,i.runDeactivationUXLogicIfReady_()},i.activateHandler_=function(t){return i.activate_(t)},i.deactivateHandler_=function(){return i.deactivate_()},i.focusHandler_=function(){return i.handleFocus()},i.blurHandler_=function(){return i.handleBlur()},i.resizeHandler_=function(){return i.layout()},i}return function(t,e){function n(){this.constructor=t}Pe(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return Be},enumerable:!0,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return Fe},enumerable:!0,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return He},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},browserSupportsCssVars:function(){return!0},computeBoundingRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},containsEventTarget:function(){return!0},deregisterDocumentInteractionHandler:function(){},deregisterInteractionHandler:function(){},deregisterResizeHandler:function(){},getWindowPageOffset:function(){return{x:0,y:0}},isSurfaceActive:function(){return!0},isSurfaceDisabled:function(){return!0},isUnbounded:function(){return!0},registerDocumentInteractionHandler:function(){},registerInteractionHandler:function(){},registerResizeHandler:function(){},removeClass:function(){},updateCssVariable:function(){}}},enumerable:!0,configurable:!0}),e.prototype.init=function(){var t=this,n=this.supportsPressRipple_();if(this.registerRootHandlers_(n),n){var i=e.cssClasses,o=i.ROOT,r=i.UNBOUNDED;requestAnimationFrame((function(){t.adapter.addClass(o),t.adapter.isUnbounded()&&(t.adapter.addClass(r),t.layoutInternal_())}))}},e.prototype.destroy=function(){var t=this;if(this.supportsPressRipple_()){this.activationTimer_&&(clearTimeout(this.activationTimer_),this.activationTimer_=0,this.adapter.removeClass(e.cssClasses.FG_ACTIVATION)),this.fgDeactivationRemovalTimer_&&(clearTimeout(this.fgDeactivationRemovalTimer_),this.fgDeactivationRemovalTimer_=0,this.adapter.removeClass(e.cssClasses.FG_DEACTIVATION));var n=e.cssClasses,i=n.ROOT,o=n.UNBOUNDED;requestAnimationFrame((function(){t.adapter.removeClass(i),t.adapter.removeClass(o),t.removeCssVars_()}))}this.deregisterRootHandlers_(),this.deregisterDeactivationHandlers_()},e.prototype.activate=function(t){this.activate_(t)},e.prototype.deactivate=function(){this.deactivate_()},e.prototype.layout=function(){var t=this;this.layoutFrame_&&cancelAnimationFrame(this.layoutFrame_),this.layoutFrame_=requestAnimationFrame((function(){t.layoutInternal_(),t.layoutFrame_=0}))},e.prototype.setUnbounded=function(t){var n=e.cssClasses.UNBOUNDED;t?this.adapter.addClass(n):this.adapter.removeClass(n)},e.prototype.handleFocus=function(){var t=this;requestAnimationFrame((function(){return t.adapter.addClass(e.cssClasses.BG_FOCUSED)}))},e.prototype.handleBlur=function(){var t=this;requestAnimationFrame((function(){return t.adapter.removeClass(e.cssClasses.BG_FOCUSED)}))},e.prototype.supportsPressRipple_=function(){return this.adapter.browserSupportsCssVars()},e.prototype.defaultActivationState_=function(){return{activationEvent:void 0,hasDeactivationUXRun:!1,isActivated:!1,isProgrammatic:!1,wasActivatedByPointer:!1,wasElementMadeActive:!1}},e.prototype.registerRootHandlers_=function(t){var e=this;t&&(Ue.forEach((function(t){e.adapter.registerInteractionHandler(t,e.activateHandler_)})),this.adapter.isUnbounded()&&this.adapter.registerResizeHandler(this.resizeHandler_)),this.adapter.registerInteractionHandler("focus",this.focusHandler_),this.adapter.registerInteractionHandler("blur",this.blurHandler_)},e.prototype.registerDeactivationHandlers_=function(t){var e=this;"keydown"===t.type?this.adapter.registerInteractionHandler("keyup",this.deactivateHandler_):Ve.forEach((function(t){e.adapter.registerDocumentInteractionHandler(t,e.deactivateHandler_)}))},e.prototype.deregisterRootHandlers_=function(){var t=this;Ue.forEach((function(e){t.adapter.deregisterInteractionHandler(e,t.activateHandler_)})),this.adapter.deregisterInteractionHandler("focus",this.focusHandler_),this.adapter.deregisterInteractionHandler("blur",this.blurHandler_),this.adapter.isUnbounded()&&this.adapter.deregisterResizeHandler(this.resizeHandler_)},e.prototype.deregisterDeactivationHandlers_=function(){var t=this;this.adapter.deregisterInteractionHandler("keyup",this.deactivateHandler_),Ve.forEach((function(e){t.adapter.deregisterDocumentInteractionHandler(e,t.deactivateHandler_)}))},e.prototype.removeCssVars_=function(){var t=this,n=e.strings;Object.keys(n).forEach((function(e){0===e.indexOf("VAR_")&&t.adapter.updateCssVariable(n[e],null)}))},e.prototype.activate_=function(t){var e=this;if(!this.adapter.isSurfaceDisabled()){var n=this.activationState_;if(!n.isActivated){var i=this.previousActivationEvent_;if(!(i&&void 0!==t&&i.type!==t.type))n.isActivated=!0,n.isProgrammatic=void 0===t,n.activationEvent=t,n.wasActivatedByPointer=!n.isProgrammatic&&(void 0!==t&&("mousedown"===t.type||"touchstart"===t.type||"pointerdown"===t.type)),void 0!==t&&Ge.length>0&&Ge.some((function(t){return e.adapter.containsEventTarget(t)}))?this.resetActivationState_():(void 0!==t&&(Ge.push(t.target),this.registerDeactivationHandlers_(t)),n.wasElementMadeActive=this.checkElementMadeActive_(t),n.wasElementMadeActive&&this.animateActivation_(),requestAnimationFrame((function(){Ge=[],n.wasElementMadeActive||void 0===t||" "!==t.key&&32!==t.keyCode||(n.wasElementMadeActive=e.checkElementMadeActive_(t),n.wasElementMadeActive&&e.animateActivation_()),n.wasElementMadeActive||(e.activationState_=e.defaultActivationState_())})))}}},e.prototype.checkElementMadeActive_=function(t){return void 0===t||"keydown"!==t.type||this.adapter.isSurfaceActive()},e.prototype.animateActivation_=function(){var t=this,n=e.strings,i=n.VAR_FG_TRANSLATE_START,o=n.VAR_FG_TRANSLATE_END,r=e.cssClasses,s=r.FG_DEACTIVATION,a=r.FG_ACTIVATION,l=e.numbers.DEACTIVATION_TIMEOUT_MS;this.layoutInternal_();var c="",d="";if(!this.adapter.isUnbounded()){var u=this.getFgTranslationCoordinates_(),h=u.startPoint,p=u.endPoint;c=h.x+"px, "+h.y+"px",d=p.x+"px, "+p.y+"px"}this.adapter.updateCssVariable(i,c),this.adapter.updateCssVariable(o,d),clearTimeout(this.activationTimer_),clearTimeout(this.fgDeactivationRemovalTimer_),this.rmBoundedActivationClasses_(),this.adapter.removeClass(s),this.adapter.computeBoundingRect(),this.adapter.addClass(a),this.activationTimer_=setTimeout((function(){return t.activationTimerCallback_()}),l)},e.prototype.getFgTranslationCoordinates_=function(){var t,e=this.activationState_,n=e.activationEvent;return{startPoint:t={x:(t=e.wasActivatedByPointer?function(t,e,n){if(!t)return{x:0,y:0};var i,o,r=e.x,s=e.y,a=r+n.left,l=s+n.top;if("touchstart"===t.type){var c=t;i=c.changedTouches[0].pageX-a,o=c.changedTouches[0].pageY-l}else{var d=t;i=d.pageX-a,o=d.pageY-l}return{x:i,y:o}}(n,this.adapter.getWindowPageOffset(),this.adapter.computeBoundingRect()):{x:this.frame_.width/2,y:this.frame_.height/2}).x-this.initialSize_/2,y:t.y-this.initialSize_/2},endPoint:{x:this.frame_.width/2-this.initialSize_/2,y:this.frame_.height/2-this.initialSize_/2}}},e.prototype.runDeactivationUXLogicIfReady_=function(){var t=this,n=e.cssClasses.FG_DEACTIVATION,i=this.activationState_,o=i.hasDeactivationUXRun,r=i.isActivated;(o||!r)&&this.activationAnimationHasEnded_&&(this.rmBoundedActivationClasses_(),this.adapter.addClass(n),this.fgDeactivationRemovalTimer_=setTimeout((function(){t.adapter.removeClass(n)}),He.FG_DEACTIVATION_MS))},e.prototype.rmBoundedActivationClasses_=function(){var t=e.cssClasses.FG_ACTIVATION;this.adapter.removeClass(t),this.activationAnimationHasEnded_=!1,this.adapter.computeBoundingRect()},e.prototype.resetActivationState_=function(){var t=this;this.previousActivationEvent_=this.activationState_.activationEvent,this.activationState_=this.defaultActivationState_(),setTimeout((function(){return t.previousActivationEvent_=void 0}),e.numbers.TAP_DELAY_MS)},e.prototype.deactivate_=function(){var t=this,e=this.activationState_;if(e.isActivated){var n=Me({},e);e.isProgrammatic?(requestAnimationFrame((function(){return t.animateDeactivation_(n)})),this.resetActivationState_()):(this.deregisterDeactivationHandlers_(),requestAnimationFrame((function(){t.activationState_.hasDeactivationUXRun=!0,t.animateDeactivation_(n),t.resetActivationState_()})))}},e.prototype.animateDeactivation_=function(t){var e=t.wasActivatedByPointer,n=t.wasElementMadeActive;(e||n)&&this.runDeactivationUXLogicIfReady_()},e.prototype.layoutInternal_=function(){var t=this;this.frame_=this.adapter.computeBoundingRect();var n=Math.max(this.frame_.height,this.frame_.width);this.maxRadius_=this.adapter.isUnbounded()?n:Math.sqrt(Math.pow(t.frame_.width,2)+Math.pow(t.frame_.height,2))+e.numbers.PADDING;var i=Math.floor(n*e.numbers.INITIAL_ORIGIN_SCALE);this.adapter.isUnbounded()&&i%2!=0?this.initialSize_=i-1:this.initialSize_=i,this.fgScale_=""+this.maxRadius_/this.initialSize_,this.updateLayoutCssVars_()},e.prototype.updateLayoutCssVars_=function(){var t=e.strings,n=t.VAR_FG_SIZE,i=t.VAR_LEFT,o=t.VAR_TOP,r=t.VAR_FG_SCALE;this.adapter.updateCssVariable(n,this.initialSize_+"px"),this.adapter.updateCssVariable(r,this.fgScale_),this.adapter.isUnbounded()&&(this.unboundedCoords_={left:Math.round(this.frame_.width/2-this.initialSize_/2),top:Math.round(this.frame_.height/2-this.initialSize_/2)},this.adapter.updateCssVariable(i,this.unboundedCoords_.left+"px"),this.adapter.updateCssVariable(o,this.unboundedCoords_.top+"px"))},e}(Et);let ze,Xe,je=t=>t;class Ye extends _t{constructor(){super(...arguments),this.primary=!1,this.accent=!1,this.unbounded=!1,this.disabled=!1,this.activated=!1,this.selected=!1,this.hovering=!1,this.bgFocused=!1,this.fgActivation=!1,this.fgDeactivation=!1,this.fgScale="",this.fgSize="",this.translateStart="",this.translateEnd="",this.leftPos="",this.topPos="",this.mdcFoundationClass=We}get isActive(){return(this.parentElement||this).matches(":active")}createAdapter(){return{browserSupportsCssVars:()=>!0,isUnbounded:()=>this.unbounded,isSurfaceActive:()=>this.isActive,isSurfaceDisabled:()=>this.disabled,addClass:t=>{switch(t){case"mdc-ripple-upgraded--background-focused":this.bgFocused=!0;break;case"mdc-ripple-upgraded--foreground-activation":this.fgActivation=!0;break;case"mdc-ripple-upgraded--foreground-deactivation":this.fgDeactivation=!0}},removeClass:t=>{switch(t){case"mdc-ripple-upgraded--background-focused":this.bgFocused=!1;break;case"mdc-ripple-upgraded--foreground-activation":this.fgActivation=!1;break;case"mdc-ripple-upgraded--foreground-deactivation":this.fgDeactivation=!1}},containsEventTarget:()=>!0,registerInteractionHandler:()=>{},deregisterInteractionHandler:()=>{},registerDocumentInteractionHandler:()=>{},deregisterDocumentInteractionHandler:()=>{},registerResizeHandler:()=>{},deregisterResizeHandler:()=>{},updateCssVariable:(t,e)=>{switch(t){case"--mdc-ripple-fg-scale":this.fgScale=e;break;case"--mdc-ripple-fg-size":this.fgSize=e;break;case"--mdc-ripple-fg-translate-end":this.translateEnd=e;break;case"--mdc-ripple-fg-translate-start":this.translateStart=e;break;case"--mdc-ripple-left":this.leftPos=e;break;case"--mdc-ripple-top":this.topPos=e}},computeBoundingRect:()=>(this.parentElement||this).getBoundingClientRect(),getWindowPageOffset:()=>({x:window.pageXOffset,y:window.pageYOffset})}}startPress(t){this.waitForFoundation((()=>{this.mdcFoundation.activate(t)}))}endPress(){this.waitForFoundation((()=>{this.mdcFoundation.deactivate()}))}startFocus(){this.waitForFoundation((()=>{this.mdcFoundation.handleFocus()}))}endFocus(){this.waitForFoundation((()=>{this.mdcFoundation.handleBlur()}))}startHover(){this.hovering=!0}endHover(){this.hovering=!1}waitForFoundation(t){this.mdcFoundation?t():this.updateComplete.then(t)}render(){const t=this.activated&&(this.primary||!this.accent),e=this.selected&&(this.primary||!this.accent),n={"mdc-ripple-surface--accent":this.accent,"mdc-ripple-surface--primary--activated":t,"mdc-ripple-surface--accent--activated":this.accent&&this.activated,"mdc-ripple-surface--primary--selected":e,"mdc-ripple-surface--accent--selected":this.accent&&this.selected,"mdc-ripple-surface--disabled":this.disabled,"mdc-ripple-surface--hover":this.hovering,"mdc-ripple-surface--primary":this.primary,"mdc-ripple-surface--selected":this.selected,"mdc-ripple-upgraded--background-focused":this.bgFocused,"mdc-ripple-upgraded--foreground-activation":this.fgActivation,"mdc-ripple-upgraded--foreground-deactivation":this.fgDeactivation,"mdc-ripple-upgraded--unbounded":this.unbounded};return F(ze||(ze=je` <div class="mdc-ripple-surface mdc-ripple-upgraded ${0}" style="${0}"></div>`),Nt(n),qt({"--mdc-ripple-fg-scale":this.fgScale,"--mdc-ripple-fg-size":this.fgSize,"--mdc-ripple-fg-translate-end":this.translateEnd,"--mdc-ripple-fg-translate-start":this.translateStart,"--mdc-ripple-left":this.leftPos,"--mdc-ripple-top":this.topPos}))}}t([Z(".mdc-ripple-surface")],Ye.prototype,"mdcRoot",void 0),t([J({type:Boolean})],Ye.prototype,"primary",void 0),t([J({type:Boolean})],Ye.prototype,"accent",void 0),t([J({type:Boolean})],Ye.prototype,"unbounded",void 0),t([J({type:Boolean})],Ye.prototype,"disabled",void 0),t([J({type:Boolean})],Ye.prototype,"activated",void 0),t([J({type:Boolean})],Ye.prototype,"selected",void 0),t([q()],Ye.prototype,"hovering",void 0),t([q()],Ye.prototype,"bgFocused",void 0),t([q()],Ye.prototype,"fgActivation",void 0),t([q()],Ye.prototype,"fgDeactivation",void 0),t([q()],Ye.prototype,"fgScale",void 0),t([q()],Ye.prototype,"fgSize",void 0),t([q()],Ye.prototype,"translateStart",void 0),t([q()],Ye.prototype,"translateEnd",void 0),t([q()],Ye.prototype,"leftPos",void 0),t([q()],Ye.prototype,"topPos",void 0);const Ke=st(Xe||(Xe=je`.mdc-ripple-surface{--mdc-ripple-fg-size:0;--mdc-ripple-left:0;--mdc-ripple-top:0;--mdc-ripple-fg-scale:1;--mdc-ripple-fg-translate-end:0;--mdc-ripple-fg-translate-start:0;-webkit-tap-highlight-color:transparent;will-change:transform,opacity;position:relative;outline:0;overflow:hidden}.mdc-ripple-surface::after,.mdc-ripple-surface::before{position:absolute;border-radius:50%;opacity:0;pointer-events:none;content:""}.mdc-ripple-surface::before{transition:opacity 15ms linear,background-color 15ms linear;z-index:1;z-index:var(--mdc-ripple-z-index,1)}.mdc-ripple-surface::after{z-index:0;z-index:var(--mdc-ripple-z-index,0)}.mdc-ripple-surface.mdc-ripple-upgraded::before{transform:scale(var(--mdc-ripple-fg-scale,1))}.mdc-ripple-surface.mdc-ripple-upgraded::after{top:0;left:0;transform:scale(0);transform-origin:center center}.mdc-ripple-surface.mdc-ripple-upgraded--unbounded::after{top:var(--mdc-ripple-top,0);left:var(--mdc-ripple-left,0)}.mdc-ripple-surface.mdc-ripple-upgraded--foreground-activation::after{animation:mdc-ripple-fg-radius-in 225ms forwards,mdc-ripple-fg-opacity-in 75ms forwards}.mdc-ripple-surface.mdc-ripple-upgraded--foreground-deactivation::after{animation:mdc-ripple-fg-opacity-out 150ms;transform:translate(var(--mdc-ripple-fg-translate-end,0)) scale(var(--mdc-ripple-fg-scale,1))}.mdc-ripple-surface::after,.mdc-ripple-surface::before{background-color:#000;background-color:var(--mdc-ripple-color,#000)}.mdc-ripple-surface.mdc-ripple-surface--hover::before,.mdc-ripple-surface:hover::before{opacity:.04;opacity:var(--mdc-ripple-hover-opacity,.04)}.mdc-ripple-surface.mdc-ripple-upgraded--background-focused::before,.mdc-ripple-surface:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:.12;opacity:var(--mdc-ripple-focus-opacity,.12)}.mdc-ripple-surface:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mdc-ripple-surface:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:.12;opacity:var(--mdc-ripple-press-opacity,.12)}.mdc-ripple-surface.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.12)}.mdc-ripple-surface::after,.mdc-ripple-surface::before{top:calc(50% - 100%);left:calc(50% - 100%);width:200%;height:200%}.mdc-ripple-surface.mdc-ripple-upgraded::after{width:var(--mdc-ripple-fg-size,100%);height:var(--mdc-ripple-fg-size,100%)}.mdc-ripple-surface[data-mdc-ripple-is-unbounded],.mdc-ripple-upgraded--unbounded{overflow:visible}.mdc-ripple-surface[data-mdc-ripple-is-unbounded]::after,.mdc-ripple-surface[data-mdc-ripple-is-unbounded]::before,.mdc-ripple-upgraded--unbounded::after,.mdc-ripple-upgraded--unbounded::before{top:calc(50% - 50%);left:calc(50% - 50%);width:100%;height:100%}.mdc-ripple-surface[data-mdc-ripple-is-unbounded].mdc-ripple-upgraded::after,.mdc-ripple-surface[data-mdc-ripple-is-unbounded].mdc-ripple-upgraded::before,.mdc-ripple-upgraded--unbounded.mdc-ripple-upgraded::after,.mdc-ripple-upgraded--unbounded.mdc-ripple-upgraded::before{top:var(--mdc-ripple-top,calc(50% - 50%));left:var(--mdc-ripple-left,calc(50% - 50%));width:var(--mdc-ripple-fg-size,100%);height:var(--mdc-ripple-fg-size,100%)}.mdc-ripple-surface[data-mdc-ripple-is-unbounded].mdc-ripple-upgraded::after,.mdc-ripple-upgraded--unbounded.mdc-ripple-upgraded::after{width:var(--mdc-ripple-fg-size,100%);height:var(--mdc-ripple-fg-size,100%)}@keyframes mdc-ripple-fg-radius-in{from{animation-timing-function:cubic-bezier(.4,0,.2,1);transform:translate(var(--mdc-ripple-fg-translate-start,0)) scale(1)}to{transform:translate(var(--mdc-ripple-fg-translate-end,0)) scale(var(--mdc-ripple-fg-scale,1))}}@keyframes mdc-ripple-fg-opacity-in{from{animation-timing-function:linear;opacity:0}to{opacity:var(--mdc-ripple-fg-opacity,0)}}@keyframes mdc-ripple-fg-opacity-out{from{animation-timing-function:linear;opacity:var(--mdc-ripple-fg-opacity,0)}to{opacity:0}}:host{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;display:block}:host .mdc-ripple-surface{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;will-change:unset}.mdc-ripple-surface--primary::after,.mdc-ripple-surface--primary::before{background-color:#6200ee;background-color:var(--mdc-ripple-color,var(--mdc-theme-primary,#6200ee))}.mdc-ripple-surface--primary.mdc-ripple-surface--hover::before,.mdc-ripple-surface--primary:hover::before{opacity:.04;opacity:var(--mdc-ripple-hover-opacity,.04)}.mdc-ripple-surface--primary.mdc-ripple-upgraded--background-focused::before,.mdc-ripple-surface--primary:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:.12;opacity:var(--mdc-ripple-focus-opacity,.12)}.mdc-ripple-surface--primary:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mdc-ripple-surface--primary:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:.12;opacity:var(--mdc-ripple-press-opacity,.12)}.mdc-ripple-surface--primary.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.12)}.mdc-ripple-surface--primary--activated::before{opacity:.12;opacity:var(--mdc-ripple-activated-opacity,.12)}.mdc-ripple-surface--primary--activated::after,.mdc-ripple-surface--primary--activated::before{background-color:#6200ee;background-color:var(--mdc-ripple-color,var(--mdc-theme-primary,#6200ee))}.mdc-ripple-surface--primary--activated.mdc-ripple-surface--hover::before,.mdc-ripple-surface--primary--activated:hover::before{opacity:.16;opacity:var(--mdc-ripple-hover-opacity,.16)}.mdc-ripple-surface--primary--activated.mdc-ripple-upgraded--background-focused::before,.mdc-ripple-surface--primary--activated:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:.24;opacity:var(--mdc-ripple-focus-opacity,.24)}.mdc-ripple-surface--primary--activated:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mdc-ripple-surface--primary--activated:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:.24;opacity:var(--mdc-ripple-press-opacity,.24)}.mdc-ripple-surface--primary--activated.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.24)}.mdc-ripple-surface--primary--selected::before{opacity:.08;opacity:var(--mdc-ripple-selected-opacity,.08)}.mdc-ripple-surface--primary--selected::after,.mdc-ripple-surface--primary--selected::before{background-color:#6200ee;background-color:var(--mdc-ripple-color,var(--mdc-theme-primary,#6200ee))}.mdc-ripple-surface--primary--selected.mdc-ripple-surface--hover::before,.mdc-ripple-surface--primary--selected:hover::before{opacity:.12;opacity:var(--mdc-ripple-hover-opacity,.12)}.mdc-ripple-surface--primary--selected.mdc-ripple-upgraded--background-focused::before,.mdc-ripple-surface--primary--selected:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:.2;opacity:var(--mdc-ripple-focus-opacity,.2)}.mdc-ripple-surface--primary--selected:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mdc-ripple-surface--primary--selected:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:.2;opacity:var(--mdc-ripple-press-opacity,.2)}.mdc-ripple-surface--primary--selected.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.2)}.mdc-ripple-surface--accent::after,.mdc-ripple-surface--accent::before{background-color:#018786;background-color:var(--mdc-ripple-color,var(--mdc-theme-secondary,#018786))}.mdc-ripple-surface--accent.mdc-ripple-surface--hover::before,.mdc-ripple-surface--accent:hover::before{opacity:.04;opacity:var(--mdc-ripple-hover-opacity,.04)}.mdc-ripple-surface--accent.mdc-ripple-upgraded--background-focused::before,.mdc-ripple-surface--accent:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:.12;opacity:var(--mdc-ripple-focus-opacity,.12)}.mdc-ripple-surface--accent:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mdc-ripple-surface--accent:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:.12;opacity:var(--mdc-ripple-press-opacity,.12)}.mdc-ripple-surface--accent.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.12)}.mdc-ripple-surface--accent--activated::before{opacity:.12;opacity:var(--mdc-ripple-activated-opacity,.12)}.mdc-ripple-surface--accent--activated::after,.mdc-ripple-surface--accent--activated::before{background-color:#018786;background-color:var(--mdc-ripple-color,var(--mdc-theme-secondary,#018786))}.mdc-ripple-surface--accent--activated.mdc-ripple-surface--hover::before,.mdc-ripple-surface--accent--activated:hover::before{opacity:.16;opacity:var(--mdc-ripple-hover-opacity,.16)}.mdc-ripple-surface--accent--activated.mdc-ripple-upgraded--background-focused::before,.mdc-ripple-surface--accent--activated:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:.24;opacity:var(--mdc-ripple-focus-opacity,.24)}.mdc-ripple-surface--accent--activated:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mdc-ripple-surface--accent--activated:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:.24;opacity:var(--mdc-ripple-press-opacity,.24)}.mdc-ripple-surface--accent--activated.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.24)}.mdc-ripple-surface--accent--selected::before{opacity:.08;opacity:var(--mdc-ripple-selected-opacity,.08)}.mdc-ripple-surface--accent--selected::after,.mdc-ripple-surface--accent--selected::before{background-color:#018786;background-color:var(--mdc-ripple-color,var(--mdc-theme-secondary,#018786))}.mdc-ripple-surface--accent--selected.mdc-ripple-surface--hover::before,.mdc-ripple-surface--accent--selected:hover::before{opacity:.12;opacity:var(--mdc-ripple-hover-opacity,.12)}.mdc-ripple-surface--accent--selected.mdc-ripple-upgraded--background-focused::before,.mdc-ripple-surface--accent--selected:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:.2;opacity:var(--mdc-ripple-focus-opacity,.2)}.mdc-ripple-surface--accent--selected:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mdc-ripple-surface--accent--selected:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:.2;opacity:var(--mdc-ripple-press-opacity,.2)}.mdc-ripple-surface--accent--selected.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.2)}.mdc-ripple-surface--disabled{opacity:0}`));class $e extends(Le(Ye)){}$e.styles=Ke;let Je,qe,Ze,Qe=t=>t;class tn extends lt{constructor(){super(...arguments),this.disabled=!1,this.icon="",this.label="",this.shouldRenderRipple=!1,this.rippleHandlers=new ae((()=>(this.shouldRenderRipple=!0,this.ripple)))}renderRipple(){return this.shouldRenderRipple?F(Je||(Je=Qe` <mwc-ripple .disabled="${0}" unbounded> </mwc-ripple>`),this.disabled):""}focus(){const t=this.buttonElement;t&&(this.rippleHandlers.startFocus(),t.focus())}blur(){const t=this.buttonElement;t&&(this.rippleHandlers.endFocus(),t.blur())}render(){return F(qe||(qe=Qe`<button class="mdc-icon-button" aria-label="${0}" ?disabled="${0}" @focus="${0}" @blur="${0}" @mousedown="${0}" @mouseenter="${0}" @mouseleave="${0}" @touchstart="${0}" @touchend="${0}" @touchcancel="${0}"> ${0} <i class="material-icons">${0}</i> <span class="default-slot-container"> <slot></slot> </span> </button>`),this.label||this.icon,this.disabled,this.handleRippleFocus,this.handleRippleBlur,this.handleRippleMouseDown,this.handleRippleMouseEnter,this.handleRippleMouseLeave,this.handleRippleTouchStart,this.handleRippleDeactivate,this.handleRippleDeactivate,this.renderRipple(),this.icon)}handleRippleMouseDown(t){const e=()=>{window.removeEventListener("mouseup",e),this.handleRippleDeactivate()};window.addEventListener("mouseup",e),this.rippleHandlers.startPress(t)}handleRippleTouchStart(t){this.rippleHandlers.startPress(t)}handleRippleDeactivate(){this.rippleHandlers.endPress()}handleRippleMouseEnter(){this.rippleHandlers.startHover()}handleRippleMouseLeave(){this.rippleHandlers.endHover()}handleRippleFocus(){this.rippleHandlers.startFocus()}handleRippleBlur(){this.rippleHandlers.endFocus()}}t([J({type:Boolean,reflect:!0})],tn.prototype,"disabled",void 0),t([J({type:String})],tn.prototype,"icon",void 0),t([J({type:String})],tn.prototype,"label",void 0),t([Z("button")],tn.prototype,"buttonElement",void 0),t([Q("mwc-ripple")],tn.prototype,"ripple",void 0),t([q()],tn.prototype,"shouldRenderRipple",void 0),t([nt({passive:!0})],tn.prototype,"handleRippleMouseDown",null),t([nt({passive:!0})],tn.prototype,"handleRippleTouchStart",null);class en extends(Le(tn)){static get scopedElements(){return{"mwc-ripple":$e}}renderRipple(){return this.shouldRenderRipple?F(Ze||(Ze=Qe` <mwc-ripple class="ripple" .disabled="${0}" unbounded> </mwc-ripple>`),this.disabled):""}}en.styles=ce,t([Q(".ripple")],en.prototype,"ripple",void 0);const nn=ue((t=>class extends t{connectedCallback(){super.connectedCallback&&super.connectedCallback(),this._injectedContexts=new Map;for(const t of this.constructor.inject)this._injectContext(t)}_injectContext(t){const e=new CustomEvent("context.connectEvent",{bubbles:!0,cancelable:!0,composed:!0,detail:{key:t,connected:!1,callback:(e,n)=>{this._contextValueChanged(t,e,n)}}});this.dispatchEvent(e),e.detail.connected&&this._injectedContexts.set(t,{unsubscribe:e.detail.unsubscribe})}_contextValueChanged(t,e,n){e!==n&&(this[t]=e)}disconnectedCallback(){for(const t of this._injectedContexts.values())t.unsubscribe();super.disconnectedCallback&&super.disconnectedCallback()}})),on=ue((t=>class extends t{connectedCallback(){super.connectedCallback&&super.connectedCallback(),this._providedContexts=new Map;for(const t of this.constructor.provide)this._provideContext(t)}_provideContext(t){const e=e=>{const{detail:n}=e;if(n.key===t){e.stopPropagation();const i=this._providedContexts.get(t);i.callbacks.add(n.callback),n.connected=!0,n.unsubscribe=()=>{i.callbacks.delete(n.callback)},n.callback(this[t])}};this.addEventListener("context.connectEvent",e),this._providedContexts.set(t,{listener:e,callbacks:new Set})}_updateContextValue(t,e,n){if(this._providedContexts.has(t)){const i=this._providedContexts.get(t);for(const t of i.callbacks)t(e,n)}}shouldUpdate(t){const e=super.shouldUpdate(t);for(const[e,n]of t.entries())this.constructor.provide.includes(e)&&this._updateContextValue(e,this[e],n);return e}disconnectedCallback(){for(const t of this._providedContexts.values())this.removeEventListener("context.connectEvent",t.listener);super.disconnectedCallback&&super.disconnectedCallback()}}));var rn,sn,an,ln,cn;function dn(t){const e=[];return e.push({type:sn.RegisterAgentActivity,header:t.signed_header}),e.push({type:sn.StoreElement,header:t.signed_header,maybe_entry:t.entry}),t.signed_header.header.content.type==rn.Update?(e.push({type:sn.RegisterUpdatedContent,header:t.signed_header}),e.push({type:sn.RegisterUpdatedElement,header:t.signed_header}),e.push({type:sn.StoreEntry,header:t.signed_header,entry:t.entry})):t.signed_header.header.content.type==rn.Create?e.push({type:sn.StoreEntry,header:t.signed_header,entry:t.entry}):t.signed_header.header.content.type==rn.Delete?(e.push({type:sn.RegisterDeletedBy,header:t.signed_header}),e.push({type:sn.RegisterDeletedEntryHeader,header:t.signed_header})):t.signed_header.header.content.type==rn.DeleteLink?e.push({type:sn.RegisterRemoveLink,header:t.signed_header}):t.signed_header.header.content.type==rn.CreateLink&&e.push({type:sn.RegisterAddLink,header:t.signed_header}),e}!function(t){t.Dna="Dna",t.AgentValidationPkg="AgentValidationPkg",t.InitZomesComplete="InitZomesComplete",t.CreateLink="CreateLink",t.DeleteLink="DeleteLink",t.OpenChain="OpenChain",t.CloseChain="CloseChain",t.Create="Create",t.Update="Update",t.Delete="Delete"}(rn||(rn={})),function(t){t.StoreElement="StoreElement",t.StoreEntry="StoreEntry",t.RegisterAgentActivity="RegisterAgentActivity",t.RegisterUpdatedContent="RegisterUpdatedContent",t.RegisterUpdatedElement="RegisterUpdatedElement",t.RegisterDeletedBy="RegisterDeletedBy",t.RegisterDeletedEntryHeader="RegisterDeletedEntryHeader",t.RegisterAddLink="RegisterAddLink",t.RegisterRemoveLink="RegisterRemoveLink"}(sn||(sn={})),sn.RegisterAgentActivity,sn.StoreEntry,sn.StoreElement,sn.RegisterUpdatedContent,sn.RegisterUpdatedElement,sn.RegisterDeletedEntryHeader,sn.RegisterDeletedBy,sn.RegisterAddLink,sn.RegisterRemoveLink,function(t){t[t.Entry=0]="Entry",t[t.Element=1]="Element"}(an||(an={})),function(t){t[t.Empty=0]="Empty",t[t.Valid=1]="Valid",t[t.Forked=2]="Forked",t[t.Invalid=3]="Invalid"}(ln||(ln={})),function(t){t[t.Live=0]="Live",t[t.Dead=1]="Dead",t[t.Pending=2]="Pending",t[t.Rejected=3]="Rejected",t[t.Abandoned=4]="Abandoned",t[t.Conflict=5]="Conflict",t[t.Withdrawn=6]="Withdrawn",t[t.Purged=7]="Purged"}(cn||(cn={}));const un="function"==typeof btoa,hn="function"==typeof Buffer,pn=("function"==typeof TextDecoder&&new TextDecoder,"function"==typeof TextEncoder&&new TextEncoder,[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="]),gn=((t=>{let e={};pn.forEach(((t,n)=>e[t]=n))})(),String.fromCharCode.bind(String)),fn=("function"==typeof Uint8Array.from&&Uint8Array.from.bind(Uint8Array),t=>t.replace(/[+\/]/g,(t=>"+"==t?"-":"_")).replace(/=+$/m,"")),mn=t=>{let e,n,i,o,r="";const s=t.length%3;for(let s=0;s<t.length;){if((n=t.charCodeAt(s++))>255||(i=t.charCodeAt(s++))>255||(o=t.charCodeAt(s++))>255)throw new TypeError("invalid character found");e=n<<16|i<<8|o,r+=pn[e>>18&63]+pn[e>>12&63]+pn[e>>6&63]+pn[63&e]}return s?r.slice(0,s-3)+"===".substring(s):r},_n=un?t=>btoa(t):hn?t=>Buffer.from(t,"binary").toString("base64"):mn,vn=hn?t=>Buffer.from(t).toString("base64"):t=>{let e=[];for(let n=0,i=t.length;n<i;n+=4096)e.push(gn.apply(null,t.subarray(n,n+4096)));return _n(e.join(""))},yn=(t,e=!1)=>e?fn(vn(t)):vn(t),bn=yn;function En(t){return 1e3*t[0]+Math.floor(t[1]/1e3)}function Tn(){return t=Date.now(),[Math.floor(t/1e3),t%1e3*1e3];var t}var Rn="object"==typeof global&&global&&global.Object===Object&&global,Cn="object"==typeof self&&self&&self.Object===Object&&self,xn=Rn||Cn||Function("return this")(),Sn=xn.Symbol,In=Object.prototype,On=In.hasOwnProperty,kn=In.toString,wn=Sn?Sn.toStringTag:void 0;var An=Object.prototype.toString;var Dn=Sn?Sn.toStringTag:void 0;function Nn(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":Dn&&Dn in Object(t)?function(t){var e=On.call(t,wn),n=t[wn];try{t[wn]=void 0;var i=!0}catch(t){}var o=kn.call(t);return i&&(e?t[wn]=n:delete t[wn]),o}(t):function(t){return An.call(t)}(t)}function Ln(t){return null!=t&&"object"==typeof t}var Pn=Array.isArray;function Mn(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Bn(t){if(!Mn(t))return!1;var e=Nn(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}var Fn,Hn=xn["__core-js_shared__"],Un=(Fn=/[^.]+$/.exec(Hn&&Hn.keys&&Hn.keys.IE_PROTO||""))?"Symbol(src)_1."+Fn:"";var Vn=Function.prototype.toString;function Gn(t){if(null!=t){try{return Vn.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var Wn=/^\[object .+?Constructor\]$/,zn=Function.prototype,Xn=Object.prototype,jn=zn.toString,Yn=Xn.hasOwnProperty,Kn=RegExp("^"+jn.call(Yn).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function $n(t){return!(!Mn(t)||(e=t,Un&&Un in e))&&(Bn(t)?Kn:Wn).test(Gn(t));var e}function Jn(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return $n(n)?n:void 0}var qn=Jn(xn,"WeakMap"),Zn=Object.create,Qn=function(){function t(){}return function(e){if(!Mn(e))return{};if(Zn)return Zn(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();var ti=function(){try{var t=Jn(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();function ei(t){return t!=t}function ni(t,e){return!!(null==t?0:t.length)&&function(t,e,n){return e==e?function(t,e,n){for(var i=n-1,o=t.length;++i<o;)if(t[i]===e)return i;return-1}(t,e,n):function(t,e,n,i){for(var o=t.length,r=n+(i?1:-1);i?r--:++r<o;)if(e(t[r],r,t))return r;return-1}(t,ei,n)}(t,e,0)>-1}var ii=/^(?:0|[1-9]\d*)$/;function oi(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&ii.test(t))&&t>-1&&t%1==0&&t<e}function ri(t,e,n){"__proto__"==e&&ti?ti(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function si(t,e){return t===e||t!=t&&e!=e}var ai=Object.prototype.hasOwnProperty;function li(t,e,n){var i=t[e];ai.call(t,e)&&si(i,n)&&(void 0!==n||e in t)||ri(t,e,n)}function ci(t,e,n,i){var o=!n;n||(n={});for(var r=-1,s=e.length;++r<s;){var a=e[r],l=i?i(n[a],t[a],a,n,t):void 0;void 0===l&&(l=t[a]),o?ri(n,a,l):li(n,a,l)}return n}function di(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}function ui(t){return null!=t&&di(t.length)&&!Bn(t)}var hi=Object.prototype;function pi(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||hi)}function gi(t){return Ln(t)&&"[object Arguments]"==Nn(t)}var fi=Object.prototype,mi=fi.hasOwnProperty,_i=fi.propertyIsEnumerable,vi=gi(function(){return arguments}())?gi:function(t){return Ln(t)&&mi.call(t,"callee")&&!_i.call(t,"callee")};var yi="object"==typeof exports&&exports&&!exports.nodeType&&exports,bi=yi&&"object"==typeof module&&module&&!module.nodeType&&module,Ei=bi&&bi.exports===yi?xn.Buffer:void 0,Ti=(Ei?Ei.isBuffer:void 0)||function(){return!1},Ri={};function Ci(t){return function(e){return t(e)}}Ri["[object Float32Array]"]=Ri["[object Float64Array]"]=Ri["[object Int8Array]"]=Ri["[object Int16Array]"]=Ri["[object Int32Array]"]=Ri["[object Uint8Array]"]=Ri["[object Uint8ClampedArray]"]=Ri["[object Uint16Array]"]=Ri["[object Uint32Array]"]=!0,Ri["[object Arguments]"]=Ri["[object Array]"]=Ri["[object ArrayBuffer]"]=Ri["[object Boolean]"]=Ri["[object DataView]"]=Ri["[object Date]"]=Ri["[object Error]"]=Ri["[object Function]"]=Ri["[object Map]"]=Ri["[object Number]"]=Ri["[object Object]"]=Ri["[object RegExp]"]=Ri["[object Set]"]=Ri["[object String]"]=Ri["[object WeakMap]"]=!1;var xi="object"==typeof exports&&exports&&!exports.nodeType&&exports,Si=xi&&"object"==typeof module&&module&&!module.nodeType&&module,Ii=Si&&Si.exports===xi&&Rn.process,Oi=function(){try{var t=Si&&Si.require&&Si.require("util").types;return t||Ii&&Ii.binding&&Ii.binding("util")}catch(t){}}(),ki=Oi&&Oi.isTypedArray,wi=ki?Ci(ki):function(t){return Ln(t)&&di(t.length)&&!!Ri[Nn(t)]},Ai=Object.prototype.hasOwnProperty;function Di(t,e){var n=Pn(t),i=!n&&vi(t),o=!n&&!i&&Ti(t),r=!n&&!i&&!o&&wi(t),s=n||i||o||r,a=s?function(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}(t.length,String):[],l=a.length;for(var c in t)!e&&!Ai.call(t,c)||s&&("length"==c||o&&("offset"==c||"parent"==c)||r&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||oi(c,l))||a.push(c);return a}function Ni(t,e){return function(n){return t(e(n))}}var Li=Ni(Object.keys,Object),Pi=Object.prototype.hasOwnProperty;function Mi(t){return ui(t)?Di(t):function(t){if(!pi(t))return Li(t);var e=[];for(var n in Object(t))Pi.call(t,n)&&"constructor"!=n&&e.push(n);return e}(t)}var Bi=Object.prototype.hasOwnProperty;function Fi(t){if(!Mn(t))return function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}(t);var e=pi(t),n=[];for(var i in t)("constructor"!=i||!e&&Bi.call(t,i))&&n.push(i);return n}function Hi(t){return ui(t)?Di(t,!0):Fi(t)}var Ui=Jn(Object,"create");var Vi=Object.prototype.hasOwnProperty;var Gi=Object.prototype.hasOwnProperty;function Wi(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function zi(t,e){for(var n=t.length;n--;)if(si(t[n][0],e))return n;return-1}Wi.prototype.clear=function(){this.__data__=Ui?Ui(null):{},this.size=0},Wi.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Wi.prototype.get=function(t){var e=this.__data__;if(Ui){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return Vi.call(e,t)?e[t]:void 0},Wi.prototype.has=function(t){var e=this.__data__;return Ui?void 0!==e[t]:Gi.call(e,t)},Wi.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Ui&&void 0===e?"__lodash_hash_undefined__":e,this};var Xi=Array.prototype.splice;function ji(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}ji.prototype.clear=function(){this.__data__=[],this.size=0},ji.prototype.delete=function(t){var e=this.__data__,n=zi(e,t);return!(n<0)&&(n==e.length-1?e.pop():Xi.call(e,n,1),--this.size,!0)},ji.prototype.get=function(t){var e=this.__data__,n=zi(e,t);return n<0?void 0:e[n][1]},ji.prototype.has=function(t){return zi(this.__data__,t)>-1},ji.prototype.set=function(t,e){var n=this.__data__,i=zi(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this};var Yi=Jn(xn,"Map");function Ki(t,e){var n,i,o=t.__data__;return("string"==(i=typeof(n=e))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?o["string"==typeof e?"string":"hash"]:o.map}function $i(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function Ji(t,e){for(var n=-1,i=e.length,o=t.length;++n<i;)t[o+n]=e[n];return t}$i.prototype.clear=function(){this.size=0,this.__data__={hash:new Wi,map:new(Yi||ji),string:new Wi}},$i.prototype.delete=function(t){var e=Ki(this,t).delete(t);return this.size-=e?1:0,e},$i.prototype.get=function(t){return Ki(this,t).get(t)},$i.prototype.has=function(t){return Ki(this,t).has(t)},$i.prototype.set=function(t,e){var n=Ki(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this};var qi=Ni(Object.getPrototypeOf,Object);function Zi(t){var e=this.__data__=new ji(t);this.size=e.size}Zi.prototype.clear=function(){this.__data__=new ji,this.size=0},Zi.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},Zi.prototype.get=function(t){return this.__data__.get(t)},Zi.prototype.has=function(t){return this.__data__.has(t)},Zi.prototype.set=function(t,e){var n=this.__data__;if(n instanceof ji){var i=n.__data__;if(!Yi||i.length<199)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new $i(i)}return n.set(t,e),this.size=n.size,this};var Qi="object"==typeof exports&&exports&&!exports.nodeType&&exports,to=Qi&&"object"==typeof module&&module&&!module.nodeType&&module,eo=to&&to.exports===Qi?xn.Buffer:void 0,no=eo?eo.allocUnsafe:void 0;function io(){return[]}var oo=Object.prototype.propertyIsEnumerable,ro=Object.getOwnPropertySymbols,so=ro?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var n=-1,i=null==t?0:t.length,o=0,r=[];++n<i;){var s=t[n];e(s,n,t)&&(r[o++]=s)}return r}(ro(t),(function(e){return oo.call(t,e)})))}:io;var ao=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)Ji(e,so(t)),t=qi(t);return e}:io;function lo(t,e,n){var i=e(t);return Pn(t)?i:Ji(i,n(t))}function co(t){return lo(t,Mi,so)}function uo(t){return lo(t,Hi,ao)}var ho=Jn(xn,"DataView"),po=Jn(xn,"Promise"),go=Jn(xn,"Set"),fo=Gn(ho),mo=Gn(Yi),_o=Gn(po),vo=Gn(go),yo=Gn(qn),bo=Nn;(ho&&"[object DataView]"!=bo(new ho(new ArrayBuffer(1)))||Yi&&"[object Map]"!=bo(new Yi)||po&&"[object Promise]"!=bo(po.resolve())||go&&"[object Set]"!=bo(new go)||qn&&"[object WeakMap]"!=bo(new qn))&&(bo=function(t){var e=Nn(t),n="[object Object]"==e?t.constructor:void 0,i=n?Gn(n):"";if(i)switch(i){case fo:return"[object DataView]";case mo:return"[object Map]";case _o:return"[object Promise]";case vo:return"[object Set]";case yo:return"[object WeakMap]"}return e});var Eo=bo,To=Object.prototype.hasOwnProperty;var Ro=xn.Uint8Array;function Co(t){var e=new t.constructor(t.byteLength);return new Ro(e).set(new Ro(t)),e}var xo=/\w*$/;var So=Sn?Sn.prototype:void 0,Io=So?So.valueOf:void 0;function Oo(t,e,n){var i,o,r,s=t.constructor;switch(e){case"[object ArrayBuffer]":return Co(t);case"[object Boolean]":case"[object Date]":return new s(+t);case"[object DataView]":return function(t,e){var n=e?Co(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function(t,e){var n=e?Co(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}(t,n);case"[object Map]":return new s;case"[object Number]":case"[object String]":return new s(t);case"[object RegExp]":return(r=new(o=t).constructor(o.source,xo.exec(o))).lastIndex=o.lastIndex,r;case"[object Set]":return new s;case"[object Symbol]":return i=t,Io?Object(Io.call(i)):{}}}var ko=Oi&&Oi.isMap,wo=ko?Ci(ko):function(t){return Ln(t)&&"[object Map]"==Eo(t)};var Ao=Oi&&Oi.isSet,Do=Ao?Ci(Ao):function(t){return Ln(t)&&"[object Set]"==Eo(t)},No={};function Lo(t,e,n,i,o,r){var s,a=1&e,l=2&e,c=4&e;if(n&&(s=o?n(t,i,o,r):n(t)),void 0!==s)return s;if(!Mn(t))return t;var d=Pn(t);if(d){if(s=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&To.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(t),!a)return function(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e}(t,s)}else{var u=Eo(t),h="[object Function]"==u||"[object GeneratorFunction]"==u;if(Ti(t))return function(t,e){if(e)return t.slice();var n=t.length,i=no?no(n):new t.constructor(n);return t.copy(i),i}(t,a);if("[object Object]"==u||"[object Arguments]"==u||h&&!o){if(s=l||h?{}:function(t){return"function"!=typeof t.constructor||pi(t)?{}:Qn(qi(t))}(t),!a)return l?function(t,e){return ci(t,ao(t),e)}(t,function(t,e){return t&&ci(e,Hi(e),t)}(s,t)):function(t,e){return ci(t,so(t),e)}(t,function(t,e){return t&&ci(e,Mi(e),t)}(s,t))}else{if(!No[u])return o?t:{};s=Oo(t,u,a)}}r||(r=new Zi);var p=r.get(t);if(p)return p;r.set(t,s),Do(t)?t.forEach((function(i){s.add(Lo(i,e,n,i,t,r))})):wo(t)&&t.forEach((function(i,o){s.set(o,Lo(i,e,n,o,t,r))}));var g=d?void 0:(c?l?uo:co:l?Hi:Mi)(t);return function(t,e){for(var n=-1,i=null==t?0:t.length;++n<i&&!1!==e(t[n],n,t););}(g||t,(function(i,o){g&&(i=t[o=i]),li(s,o,Lo(i,e,n,o,t,r))})),s}No["[object Arguments]"]=No["[object Array]"]=No["[object ArrayBuffer]"]=No["[object DataView]"]=No["[object Boolean]"]=No["[object Date]"]=No["[object Float32Array]"]=No["[object Float64Array]"]=No["[object Int8Array]"]=No["[object Int16Array]"]=No["[object Int32Array]"]=No["[object Map]"]=No["[object Number]"]=No["[object Object]"]=No["[object RegExp]"]=No["[object Set]"]=No["[object String]"]=No["[object Symbol]"]=No["[object Uint8Array]"]=No["[object Uint8ClampedArray]"]=No["[object Uint16Array]"]=No["[object Uint32Array]"]=!0,No["[object Error]"]=No["[object Function]"]=No["[object WeakMap]"]=!1;function Po(t){return Lo(t,5)}function Mo(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new $i;++e<n;)this.add(t[e])}function Bo(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}function Fo(t,e){return t.has(e)}Mo.prototype.add=Mo.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Mo.prototype.has=function(t){return this.__data__.has(t)};function Ho(t,e,n,i,o,r){var s=1&n,a=t.length,l=e.length;if(a!=l&&!(s&&l>a))return!1;var c=r.get(t),d=r.get(e);if(c&&d)return c==e&&d==t;var u=-1,h=!0,p=2&n?new Mo:void 0;for(r.set(t,e),r.set(e,t);++u<a;){var g=t[u],f=e[u];if(i)var m=s?i(f,g,u,e,t,r):i(g,f,u,t,e,r);if(void 0!==m){if(m)continue;h=!1;break}if(p){if(!Bo(e,(function(t,e){if(!Fo(p,e)&&(g===t||o(g,t,n,i,r)))return p.push(e)}))){h=!1;break}}else if(g!==f&&!o(g,f,n,i,r)){h=!1;break}}return r.delete(t),r.delete(e),h}function Uo(t){var e=-1,n=Array(t.size);return t.forEach((function(t,i){n[++e]=[i,t]})),n}function Vo(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}var Go=Sn?Sn.prototype:void 0,Wo=Go?Go.valueOf:void 0;var zo=Object.prototype.hasOwnProperty;var Xo=Object.prototype.hasOwnProperty;function jo(t,e,n,i,o,r){var s=Pn(t),a=Pn(e),l=s?"[object Array]":Eo(t),c=a?"[object Array]":Eo(e),d="[object Object]"==(l="[object Arguments]"==l?"[object Object]":l),u="[object Object]"==(c="[object Arguments]"==c?"[object Object]":c),h=l==c;if(h&&Ti(t)){if(!Ti(e))return!1;s=!0,d=!1}if(h&&!d)return r||(r=new Zi),s||wi(t)?Ho(t,e,n,i,o,r):function(t,e,n,i,o,r,s){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!r(new Ro(t),new Ro(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return si(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var a=Uo;case"[object Set]":var l=1&i;if(a||(a=Vo),t.size!=e.size&&!l)return!1;var c=s.get(t);if(c)return c==e;i|=2,s.set(t,e);var d=Ho(a(t),a(e),i,o,r,s);return s.delete(t),d;case"[object Symbol]":if(Wo)return Wo.call(t)==Wo.call(e)}return!1}(t,e,l,n,i,o,r);if(!(1&n)){var p=d&&Xo.call(t,"__wrapped__"),g=u&&Xo.call(e,"__wrapped__");if(p||g){var f=p?t.value():t,m=g?e.value():e;return r||(r=new Zi),o(f,m,n,i,r)}}return!!h&&(r||(r=new Zi),function(t,e,n,i,o,r){var s=1&n,a=co(t),l=a.length;if(l!=co(e).length&&!s)return!1;for(var c=l;c--;){var d=a[c];if(!(s?d in e:zo.call(e,d)))return!1}var u=r.get(t),h=r.get(e);if(u&&h)return u==e&&h==t;var p=!0;r.set(t,e),r.set(e,t);for(var g=s;++c<l;){var f=t[d=a[c]],m=e[d];if(i)var _=s?i(m,f,d,e,t,r):i(f,m,d,t,e,r);if(!(void 0===_?f===m||o(f,m,n,i,r):_)){p=!1;break}g||(g="constructor"==d)}if(p&&!g){var v=t.constructor,y=e.constructor;v==y||!("constructor"in t)||!("constructor"in e)||"function"==typeof v&&v instanceof v&&"function"==typeof y&&y instanceof y||(p=!1)}return r.delete(t),r.delete(e),p}(t,e,n,i,o,r))}function Yo(t,e,n,i,o){return t===e||(null==t||null==e||!Ln(t)&&!Ln(e)?t!=t&&e!=e:jo(t,e,n,i,Yo,o))}function Ko(t,e,n){for(var i=-1,o=null==t?0:t.length;++i<o;)if(n(e,t[i]))return!0;return!1}function $o(t,e){return Yo(t,e)}var Jo=go&&1/Vo(new go([,-0]))[1]==1/0?function(t){return new go(t)}:function(){};function qo(t){return t&&t.length?function(t,e,n){var i=-1,o=ni,r=t.length,s=!0,a=[],l=a;if(n)s=!1,o=Ko;else if(r>=200){var c=e?null:Jo(t);if(c)return Vo(c);s=!1,o=Fo,l=new Mo}else l=e?[]:a;t:for(;++i<r;){var d=t[i],u=e?e(d):d;if(d=n||0!==d?d:0,s&&u==u){for(var h=l.length;h--;)if(l[h]===u)continue t;e&&l.push(u),a.push(d)}else o(l,u,n)||(l!==a&&l.push(u),a.push(d))}return a}(t):[]}function Zo(t){return(4294967296+t).toString(16).substring(1)}var Qo={normalizeInput:function(t){var e;if(t instanceof Uint8Array)e=t;else if(t instanceof Buffer)e=new Uint8Array(t);else{if("string"!=typeof t)throw new Error("Input must be an string, Buffer or Uint8Array");e=new Uint8Array(Buffer.from(t,"utf8"))}return e},toHex:function(t){return Array.prototype.map.call(t,(function(t){return(t<16?"0":"")+t.toString(16)})).join("")},debugPrint:function(t,e,n){for(var i="\n"+t+" = ",o=0;o<e.length;o+=2){if(32===n)i+=Zo(e[o]).toUpperCase(),i+=" ",i+=Zo(e[o+1]).toUpperCase();else{if(64!==n)throw new Error("Invalid size "+n);i+=Zo(e[o+1]).toUpperCase(),i+=Zo(e[o]).toUpperCase()}o%6==4?i+="\n"+new Array(t.length+4).join(" "):o<e.length-2&&(i+=" ")}console.log(i)},testSpeed:function(t,e,n){for(var i=(new Date).getTime(),o=new Uint8Array(e),r=0;r<e;r++)o[r]=r%256;var s=(new Date).getTime();for(console.log("Generated random input in "+(s-i)+"ms"),i=s,r=0;r<n;r++){var a=t(o),l=(new Date).getTime(),c=l-i;i=l,console.log("Hashed in "+c+"ms: "+a.substring(0,20)+"..."),console.log(Math.round(e/(1<<20)/(c/1e3)*100)/100+" MB PER SECOND")}}};function tr(t,e,n){var i=t[e]+t[n],o=t[e+1]+t[n+1];i>=4294967296&&o++,t[e]=i,t[e+1]=o}function er(t,e,n,i){var o=t[e]+n;n<0&&(o+=4294967296);var r=t[e+1]+i;o>=4294967296&&r++,t[e]=o,t[e+1]=r}function nr(t,e){return t[e]^t[e+1]<<8^t[e+2]<<16^t[e+3]<<24}function ir(t,e,n,i,o,r){var s=ar[o],a=ar[o+1],l=ar[r],c=ar[r+1];tr(sr,t,e),er(sr,t,s,a);var d=sr[i]^sr[t],u=sr[i+1]^sr[t+1];sr[i]=u,sr[i+1]=d,tr(sr,n,i),d=sr[e]^sr[n],u=sr[e+1]^sr[n+1],sr[e]=d>>>24^u<<8,sr[e+1]=u>>>24^d<<8,tr(sr,t,e),er(sr,t,l,c),d=sr[i]^sr[t],u=sr[i+1]^sr[t+1],sr[i]=d>>>16^u<<16,sr[i+1]=u>>>16^d<<16,tr(sr,n,i),d=sr[e]^sr[n],u=sr[e+1]^sr[n+1],sr[e]=u>>>31^d<<1,sr[e+1]=d>>>31^u<<1}var or=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),rr=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3].map((function(t){return 2*t}))),sr=new Uint32Array(32),ar=new Uint32Array(32);function lr(t,e){var n=0;for(n=0;n<16;n++)sr[n]=t.h[n],sr[n+16]=or[n];for(sr[24]=sr[24]^t.t,sr[25]=sr[25]^t.t/4294967296,e&&(sr[28]=~sr[28],sr[29]=~sr[29]),n=0;n<32;n++)ar[n]=nr(t.b,4*n);for(n=0;n<12;n++)ir(0,8,16,24,rr[16*n+0],rr[16*n+1]),ir(2,10,18,26,rr[16*n+2],rr[16*n+3]),ir(4,12,20,28,rr[16*n+4],rr[16*n+5]),ir(6,14,22,30,rr[16*n+6],rr[16*n+7]),ir(0,10,20,30,rr[16*n+8],rr[16*n+9]),ir(2,12,22,24,rr[16*n+10],rr[16*n+11]),ir(4,14,16,26,rr[16*n+12],rr[16*n+13]),ir(6,8,18,28,rr[16*n+14],rr[16*n+15]);for(n=0;n<16;n++)t.h[n]=t.h[n]^sr[n]^sr[n+16]}function cr(t,e){if(0===t||t>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(e&&e.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");for(var n={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:t},i=0;i<16;i++)n.h[i]=or[i];var o=e?e.length:0;return n.h[0]^=16842752^o<<8^t,e&&(dr(n,e),n.c=128),n}function dr(t,e){for(var n=0;n<e.length;n++)128===t.c&&(t.t+=t.c,lr(t,!1),t.c=0),t.b[t.c++]=e[n]}function ur(t){for(t.t+=t.c;t.c<128;)t.b[t.c++]=0;lr(t,!0);for(var e=new Uint8Array(t.outlen),n=0;n<t.outlen;n++)e[n]=t.h[n>>2]>>8*(3&n);return e}function hr(t,e,n){n=n||64,t=Qo.normalizeInput(t);var i=cr(n,e);return dr(i,t),ur(i)}var pr={blake2b:hr,blake2bHex:function(t,e,n){var i=hr(t,e,n);return Qo.toHex(i)},blake2bInit:cr,blake2bUpdate:dr,blake2bFinal:ur};function gr(t,e){return t[e]^t[e+1]<<8^t[e+2]<<16^t[e+3]<<24}function fr(t,e,n,i,o,r){yr[t]=yr[t]+yr[e]+o,yr[i]=mr(yr[i]^yr[t],16),yr[n]=yr[n]+yr[i],yr[e]=mr(yr[e]^yr[n],12),yr[t]=yr[t]+yr[e]+r,yr[i]=mr(yr[i]^yr[t],8),yr[n]=yr[n]+yr[i],yr[e]=mr(yr[e]^yr[n],7)}function mr(t,e){return t>>>e^t<<32-e}var _r=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),vr=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),yr=new Uint32Array(16),br=new Uint32Array(16);function Er(t,e){var n=0;for(n=0;n<8;n++)yr[n]=t.h[n],yr[n+8]=_r[n];for(yr[12]^=t.t,yr[13]^=t.t/4294967296,e&&(yr[14]=~yr[14]),n=0;n<16;n++)br[n]=gr(t.b,4*n);for(n=0;n<10;n++)fr(0,4,8,12,br[vr[16*n+0]],br[vr[16*n+1]]),fr(1,5,9,13,br[vr[16*n+2]],br[vr[16*n+3]]),fr(2,6,10,14,br[vr[16*n+4]],br[vr[16*n+5]]),fr(3,7,11,15,br[vr[16*n+6]],br[vr[16*n+7]]),fr(0,5,10,15,br[vr[16*n+8]],br[vr[16*n+9]]),fr(1,6,11,12,br[vr[16*n+10]],br[vr[16*n+11]]),fr(2,7,8,13,br[vr[16*n+12]],br[vr[16*n+13]]),fr(3,4,9,14,br[vr[16*n+14]],br[vr[16*n+15]]);for(n=0;n<8;n++)t.h[n]^=yr[n]^yr[n+8]}function Tr(t,e){if(!(t>0&&t<=32))throw new Error("Incorrect output length, should be in [1, 32]");var n=e?e.length:0;if(e&&!(n>0&&n<=32))throw new Error("Incorrect key length, should be in [1, 32]");var i={h:new Uint32Array(_r),b:new Uint32Array(64),c:0,t:0,outlen:t};return i.h[0]^=16842752^n<<8^t,n>0&&(Rr(i,e),i.c=64),i}function Rr(t,e){for(var n=0;n<e.length;n++)64===t.c&&(t.t+=t.c,Er(t,!1),t.c=0),t.b[t.c++]=e[n]}function Cr(t){for(t.t+=t.c;t.c<64;)t.b[t.c++]=0;Er(t,!0);for(var e=new Uint8Array(t.outlen),n=0;n<t.outlen;n++)e[n]=t.h[n>>2]>>8*(3&n)&255;return e}function xr(t,e,n){n=n||32,t=Qo.normalizeInput(t);var i=Tr(n,e);return Rr(i,t),Cr(i)}var Sr,Ir={blake2s:xr,blake2sHex:function(t,e,n){var i=xr(t,e,n);return Qo.toHex(i)},blake2sInit:Tr,blake2sUpdate:Rr,blake2sFinal:Cr},Or={blake2b:pr.blake2b,blake2bHex:pr.blake2bHex,blake2bInit:pr.blake2bInit,blake2bUpdate:pr.blake2bUpdate,blake2bFinal:pr.blake2bFinal,blake2s:Ir.blake2s,blake2sHex:Ir.blake2sHex,blake2sInit:Ir.blake2sInit,blake2sUpdate:Ir.blake2sUpdate,blake2sFinal:Ir.blake2sFinal};!function(t){t[t.AGENT=0]="AGENT",t[t.ENTRY=1]="ENTRY",t[t.DHTOP=2]="DHTOP",t[t.HEADER=3]="HEADER",t[t.DNA=4]="DNA"}(Sr||(Sr={}));function kr(t){for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),i=0,o=t.length;i<o;i++)n[i]=t.charCodeAt(i);return e}const wr={};function Ar(t,e){const n="string"==typeof t?t:JSON.stringify(t);if(wr[n])return wr[n];const i=new Uint8Array(kr(n)),o=function(t){return`u${bn(t,!0)}`}(Or.blake2b(i,null,32)),r=`u${function(t){switch(t){case Sr.AGENT:return"hCAk";case Sr.ENTRY:return"hCEk";case Sr.DHTOP:return"hCQk";case Sr.HEADER:return"hCkk";case Sr.DNA:return"hC0k"}}(e)}${o.slice(1)}`;return wr[n]=r,r}const Dr={};function Nr(t){if(Dr[t])return Dr[t];const e=new Uint8Array(kr(t.slice(5))),n=Or.blake2b(e,null,16),i=[n[0],n[1],n[2],n[3]];for(let t=4;t<16;t+=4)i[0]^=n[t],i[1]^=n[t+1],i[2]^=n[t+2],i[3]^=n[t+3];const o=Pr(new DataView(new Uint8Array(i).buffer,0).getUint32(0,!1));return Dr[t]=o,o}function Lr(t,e){return function(t,e){const n=Pr(t-e),i=Pr(e-t);return Math.min(n,i)}(Nr(t),Nr(e))+1}function Pr(t){return t<0?4294967296+t:t>4294967295?t-4294967295:t}function Mr(t){const e=t.slice(1,5);if("hCAk"===e)return Sr.AGENT;if("hC0k"===e)return Sr.DNA;if("hCQk"===e)return Sr.DHTOP;if("hCkk"===e)return Sr.HEADER;if("hCEk"===e)return Sr.ENTRY;throw new Error("Could not get hash type")}var Br,Fr,Hr;function Ur(t,e){const n={};for(const i of Object.keys(t.validationLimbo)){const o=t.validationLimbo[i];o.status===e&&(n[i]=o)}return n}function Vr(t,e){const n=t.metadata.system_meta[e];return n?n.map((e=>{const n=(i=e).NewEntry?i.NewEntry:i.Update?i.Update:i.Delete?i.Delete:i.Activity?i.Activity:void 0;var i;if(n)return t.CAS[n]})).filter((t=>!!t)):[]}function Gr(t,e){const n=t.CAS[e],i=Vr(t,e),o=function(t,e){const n=t.metadata.misc_meta[e];return n?n.EntryStatus:void 0}(t,e),r={},s={},a={};for(const t of i){const n=t.header.content;n.original_entry_address&&n.original_entry_address===e?s[t.header.hash]=t:n.entry_hash&&n.entry_hash===e?r[t.header.hash]=t:n.deletes_entry_address===e&&(a[t.header.hash]=t)}return{entry:n,headers:i,entry_dht_status:o,updates:Object.values(s),deletes:Object.values(a),rejected_headers:[]}}function Wr(t){return qo(Object.values(t.integratedDHTOps).filter((t=>t.op.type===sn.StoreEntry)).map((t=>t.op.header)).map((t=>t.header.content.entry_hash)))}function zr(t,e){const n=Xr(t,e),i=[],o=[];for(const e of n){const n=t.CAS[e.link_add_hash];n&&i.push(n);const r=jr(t,e.link_add_hash);for(const e of r){const n=t.CAS[e];o.push(n)}}return{link_adds:i,link_removes:o}}function Xr(t,e){return t.metadata.link_meta.filter((({key:t,value:n})=>$o(t.base,e))).map((({key:t,value:e})=>e))}function jr(t,e){const n=t.metadata.system_meta[e];if(!n)return[];const i=[];for(const t of n)t.DeleteLink&&i.push(t.DeleteLink);return i}function Yr(t){const e={};for(const n of t)for(const t of n.link_adds)e[t.header.hash]=t.header.content;for(const n of t)for(const t of n.link_removes){const n=t.header.content.link_add_address;e[n]&&(e[n]=void 0)}const n=[];for(const t of Object.values(e))t&&n.push({base:t.base_address,target:t.target_address,tag:t.tag});return n}!function(t){t[t.Latest=0]="Latest",t[t.Contents=1]="Contents"}(Br||(Br={})),function(t){t[t.Valid=0]="Valid",t[t.Rejected=1]="Rejected",t[t.Abandoned=2]="Abandoned"}(Fr||(Fr={})),function(t){t[t.Pending=0]="Pending",t[t.AwaitingSysDeps=1]="AwaitingSysDeps",t[t.SysValidated=2]="SysValidated",t[t.AwaitingAppDeps=3]="AwaitingAppDeps"}(Hr||(Hr={}));class Kr{constructor(t,e){this.state=t,this.p2p=e}async handle_get_entry(t,e){const n=this.state.CAS[t];if(!n)return;const i=Vr(this.state,t),o=Gr(this.state,t),r=i.find((t=>t.header.content.entry_type));let s;return r&&(s=r.header.content.entry_type),{entry:n,entry_type:s,deletes:o.deletes,updates:o.updates,live_headers:o.headers}}async handle_get_element(t,e){if("StoreElement"!==this.state.metadata.misc_meta[t])return;const n=this.state.CAS[t];let i,o=Fr.Valid;if(n){if(n.header.content.entry_hash){const t=n.header.content.entry_hash;i=this.state.CAS[t]}}else o=Fr.Rejected;const r=function(t,e){const n=t.metadata.system_meta[e];return n?{updates:n.filter((t=>t.Update)).map((e=>t.CAS[e.Update])),deletes:n.filter((t=>t.Delete)).map((e=>t.CAS[e.Delete]))}:{updates:[],deletes:[]}}(this.state,t);return{deletes:r.deletes,updates:r.updates,signed_header:n,validation_status:o,maybe_entry:i}}async handle_get_links(t,e){return zr(this.state,t)}}class $r{constructor(t,e){this.state=t,this.p2p=e}async dht_get(t,e){new Kr(this.state,this.p2p);if(this.state.CAS[t]&&e.strategy===Br.Contents){const e=Mr(t);if(e===Sr.ENTRY){return{entry:this.state.CAS[t],signed_header:Object.values(this.state.CAS).find((e=>e.header&&e.header.content.entry_hash===t))}}if(e===Sr.HEADER){const e=this.state.CAS[t];return{entry:this.state.CAS[e.header.content.entry_hash],signed_header:e}}}const n=await this.p2p.get(t,e);return n.signed_header?{entry:n.maybe_entry,signed_header:n.signed_header}:{signed_header:n.live_headers[0],entry:n.entry}}async dht_get_details(t,e){if(Mr(t)===Sr.ENTRY){const n=await this.getEntryDetails(t,e);if(!n)return;return{type:an.Entry,content:n}}if(Mr(t)===Sr.HEADER){const n=await this.getHeaderDetails(t,e);if(!n)return;return{type:an.Element,content:n}}}async dht_get_links(t,e){return Yr(await this.p2p.get_links(t,e))}async getEntryDetails(t,e){const n=await this.p2p.get(t,e);if(!n)return;if(void 0===n.live_headers)throw new Error("Unreachable");const i=n,o=[...i.deletes,...i.updates,...i.live_headers],{rejected_headers:r,entry_dht_status:s}=function(t){const e={},n=[];for(const n of t)n.header.content.type===rn.Create&&(e[n.header.hash]=n);for(const i of t)i.header.content.type!==rn.Update&&i.header.content.type!==rn.Delete||(e[i.header.hash]&&n.push(e[i.header.hash]),e[i.header.hash]=void 0);return{entry_dht_status:Object.values(e).some((t=>void 0!==t))?cn.Live:cn.Dead,rejected_headers:n}}(o);return{entry:i.entry,headers:i.live_headers,deletes:i.deletes,updates:i.updates,rejected_headers:r,entry_dht_status:s}}async getHeaderDetails(t,e){const n=await this.p2p.get(t,e);if(!n)return;if(void 0===n.validation_status)throw new Error("Unreachable");const i=n;return{element:{entry:i.maybe_entry,signed_header:i.signed_header},deletes:i.deletes,updates:i.updates,validation_status:i.validation_status}}}const Jr=(t,e)=>n=>{n.validationLimbo[t]=e},qr=t=>e=>{delete e.validationLimbo[t]},Zr=(t,e)=>n=>{n.integrationLimbo[t]=e},Qr=t=>async e=>{const n=t.header.header.hash;e.CAS[n]=t.header;const i=function(t){return t.type===sn.StoreEntry?t.entry:t.type===sn.StoreElement?t.maybe_entry:void 0}(t);i&&(e.CAS[t.header.header.content.entry_hash]=i)},ts=t=>e=>{const n=t.header.header.hash;if(t.type===sn.StoreElement)e.metadata.misc_meta[n]="StoreElement";else if(t.type===sn.StoreEntry){const i=t.header.header.content.entry_hash;t.header.header.content.type===rn.Update&&(ns(n,t.header)(e),ns(i,t.header)(e)),ns(i,t.header)(e),es(i)(e)}else if(t.type===sn.RegisterAgentActivity)e.metadata.misc_meta[n]={ChainItem:t.header.header.content.timestamp},e.metadata.misc_meta[t.header.header.content.author]={ChainStatus:ln.Valid};else if(t.type===sn.RegisterUpdatedContent||t.type===sn.RegisterUpdatedElement)ns(t.header.header.content.original_header_address,t.header)(e),ns(t.header.header.content.original_entry_address,t.header)(e),es(t.header.header.content.original_entry_address)(e);else if(t.type===sn.RegisterDeletedBy||t.type===sn.RegisterDeletedEntryHeader)ns(t.header.header.content.deletes_address,t.header)(e),ns(t.header.header.content.deletes_entry_address,t.header)(e),es(t.header.header.content.deletes_entry_address)(e);else if(t.type===sn.RegisterAddLink){const i={base:t.header.header.content.base_address,header_hash:n,tag:t.header.header.content.tag,zome_id:t.header.header.content.zome_id},o={link_add_hash:n,tag:t.header.header.content.tag,target:t.header.header.content.target_address,timestamp:t.header.header.content.timestamp,zome_id:t.header.header.content.zome_id};e.metadata.link_meta.push({key:i,value:o})}else if(t.type===sn.RegisterRemoveLink){const i={DeleteLink:n};is(t.header.header.content.link_add_address,i)(e)}};const es=t=>e=>{const n=Vr(e,t).some((t=>function(t,e){const n=t.metadata.system_meta[e];if(n)return!n.find((t=>t.Delete));return!0}(e,t.header.hash)));e.metadata.misc_meta[t]={EntryStatus:n?cn.Live:cn.Dead}},ns=(t,e)=>n=>{let i;const o=e.header.content.type;o===rn.Create?i={NewEntry:e.header.hash}:o===rn.Update?i={Update:e.header.hash}:o===rn.Delete&&(i={Delete:e.header.hash}),i&&is(t,i)(n)},is=(t,e)=>n=>{n.metadata.system_meta[t]||(n.metadata.system_meta[t]=[]),n.metadata.system_meta[t].push(e)},os=(t,e)=>n=>{n.integratedDHTOps[t]=e};function rs(t){return t.sourceChain.map((e=>t.CAS[e]))}function ss(t){return"Agent"===t.entry_type?t.content:Ar(t.content,Sr.ENTRY)}function as(t){if(t.App)return t.App}function ls(t,e){const n=as(e);if(n){return t.getSimulatedDna().zomes[n.zome_id].entry_defs[n.id].id}return e}function cs(t){switch(t.type){case sn.StoreElement:return t.header.header.hash;case sn.StoreEntry:return t.header.header.content.entry_hash;case sn.RegisterUpdatedContent:return t.header.header.content.original_entry_address;case sn.RegisterAgentActivity:return t.header.header.content.author;case sn.RegisterAddLink:case sn.RegisterRemoveLink:return t.header.header.content.base_address;case sn.RegisterDeletedBy:return t.header.header.content.deletes_address;case sn.RegisterDeletedEntryHeader:return t.header.header.content.deletes_entry_address;default:return}}const ds=t=>e=>{const n=t.signed_header.header.hash;if(e.CAS[n]=t.signed_header,t.entry){const n=ss(t.entry);e.CAS[n]=t.entry}e.sourceChain.unshift(n)};function us(t){return t.sourceChain[0]}function hs(t){return function(t,e){const n=t.sourceChain[e];return t.CAS[n]}(t,0).header.content.author}function ps(t,e){const n=t.CAS[e];let i;return n.header.content.type!=rn.Create&&n.header.content.type!=rn.Update||(i=t.CAS[n.header.content.entry_hash]),{signed_header:n,entry:i}}function gs(t){const e=hs(t);return[function(t){const e=t.sourceChain[t.sourceChain.length-1];return t.CAS[e].header.content.hash}(t),e]}function fs(t){const e=t.header.content;return!(!e.entry_hash||"CapGrant"!==e.entry_type)}function ms(t){return{header:{content:t,hash:Ar(t,Sr.HEADER)},signature:Uint8Array.from([])}}function _s(t,e,n){const i=ss(e);return{...vs(t),entry_hash:i,entry_type:n,type:rn.Create}}function vs(t){return{author:hs(t),header_seq:t.sourceChain.length,prev_header:us(t),timestamp:Tn()}}var ys;function bs(t){switch(t){case ys.GENESIS:return 0;case ys.CALL_ZOME:return 1;default:return 10}}!function(t){t.CALL_ZOME="Call Zome Function",t.SYS_VALIDATION="System Validation",t.PUBLISH_DHT_OPS="Publish DHT Ops",t.PRODUCE_DHT_OPS="Produce DHT Ops",t.APP_VALIDATION="App Validation",t.INTEGRATE_DHT_OPS="Integrate DHT Ops",t.GENESIS="Genesis",t.INCOMING_DHT_OPS="Incoming DHT Ops"}(ys||(ys={}));function Es(){return{type:ys.INTEGRATE_DHT_OPS,details:void 0,task:t=>(async t=>{const e=function(t){const e=t.integrationLimbo;return t.integrationLimbo={},e}(t.state);for(const n of Object.keys(e)){const i=e[n],o=i.op;await Qr(o)(t.state),ts(o)(t.state);const r={op:o,validation_status:i.validation_status,when_integrated:Date.now()};os(n,r)(t.state)}return{result:void 0,triggers:[]}})(t)}}function Ts(){return{type:ys.APP_VALIDATION,details:void 0,task:t=>(async t=>{const e=Ur(t.state,Hr.SysValidated);for(const n of Object.keys(e)){qr(n)(t.state);const i={op:e[n].op,validation_status:Fr.Valid};Zr(n,i)(t.state)}return{result:void 0,triggers:[Es()]}})(t)}}const Rs=async t=>{const e=function(t){const e={};for(const n of Object.keys(t.authoredDHTOps)){const i=t.authoredDHTOps[n];void 0===i.last_publish_time&&(e[n]=i.op)}return e}(t.state),n={};for(const t of Object.keys(e)){const i=e[t],o=cs(i);n[o]||(n[o]={}),n[o][t]=i}const i=Object.entries(n).map((async([e,n])=>{await t.p2p.publish(e,n);for(const e of Object.keys(n))t.state.authoredDHTOps[e].last_publish_time=Date.now()}));return await Promise.all(i),{result:void 0,triggers:[]}};const Cs=async t=>{const e=function(t){const e=Object.values(t.authoredDHTOps).map((t=>t.op.header.header.hash));return t.sourceChain.filter((t=>!e.includes(t)))}(t.state);for(const n of e){const e=dn(ps(t.state,n));for(const n of e){const e=Ar(n,Sr.DHTOP),i={op:n,last_publish_time:void 0,receipt_count:0};t.state.authoredDHTOps[e]=i}}return{result:void 0,triggers:[{type:ys.PUBLISH_DHT_OPS,details:void 0,task:t=>Rs(t)}]}};function xs(){return{type:ys.PRODUCE_DHT_OPS,details:void 0,task:t=>Cs(t)}}const Ss=(t,e,n,i,o)=>async r=>{if(!function(t,e,n,i,o){if(i===gs(t)[1])return!0;const r={},s=rs(t);for(const t of s)fs(t)&&(r[t.header.hash]=t);for(const t of s){const e=t.header.content;e.original_header_address&&r[e.original_header_address]&&delete r[e.original_header_address],e.deletes_address&&r[e.deletes_address]&&delete r[e.deletes_address]}return!!Object.values(r).map((e=>t.CAS[e.header.content.entry_hash].content)).find((t=>function(t,e,n,i,o){return!!t.functions.find((t=>t.fn_name===n&&t.zome===e))&&("Unrestricted"===t.access||(t.access.Assigned?t.access.Assigned.assignees.includes(i):t.access.Transferable.secret===o))}(t,e,n,i,o)))}(r.state,t,e,i,o))throw new Error("Unauthorized Zome Call");const s=us(r.state),a=r.dna.zomes.findIndex((e=>e.name===t));if(a<0)throw new Error(`There is no zome with the name ${t} in this DNA`);if(!r.dna.zomes[a].zome_functions[e])throw new Error(`There isn't a function with the name ${e} in this zome with the name ${t}`);if(!r.zomeFnContext)throw new Error("Internal error: no zome function context was provided");const l=await r.dna.zomes[a].zome_functions[e].call(r.zomeFnContext)(n);let c=[];return us(r.state)!=s&&c.push(xs()),{result:Po(l),triggers:c}};const Is=(t,e,n)=>async i=>{const o=function(t,e){return{author:e,hash:t,timestamp:Tn(),type:rn.Dna}}(e,t);ds({signed_header:ms(o),entry:void 0})(i.state);const r=function(t,e){return{...vs(t),membrane_proof:e,type:rn.AgentValidationPkg}}(i.state,n);ds({signed_header:ms(r),entry:void 0})(i.state);const s={content:t,entry_type:"Agent"},a=_s(i.state,s,"Agent");return ds({signed_header:ms(a),entry:s})(i.state),{result:void 0,triggers:[xs()]}};function Os(){return{type:ys.SYS_VALIDATION,details:void 0,task:t=>(async t=>{const e=Ur(t.state,Hr.Pending);for(const n of Object.keys(e)){const i=e[n];i.status=Hr.SysValidated,Jr(n,i)(t.state)}return{result:void 0,triggers:[Ts()]}})(t)}}function ks(t,e,n){return{type:ys.INCOMING_DHT_OPS,details:{from_agent:t,dht_hash:e,ops:n},task:i=>((t,e,n)=>async i=>{for(const o of Object.keys(e))if(!i.state.integratedDHTOps[o]&&!i.state.integrationLimbo[o]&&!i.state.validationLimbo[o]){const r=e[o],s={basis:t,from_agent:n,last_try:void 0,num_tries:0,op:r,status:Hr.Pending,time_added:Date.now()};Jr(o,s)(i.state)}return{result:void 0,triggers:[Os()]}})(e,n,t)(i)}}class ws{constructor(){this._beforeMiddlewares=[],this._successMiddlewares=[],this._errorMiddlewares=[]}async execute(t,e){for(const t of this._beforeMiddlewares)await t(e);try{const n=await t();for(const t of this._successMiddlewares)await t(e,n);return n}catch(t){for(const n of this._errorMiddlewares)await n(e,t);throw t}}before(t){return this._addListener(t,this._beforeMiddlewares)}success(t){return this._addListener(t,this._successMiddlewares)}error(t){return this._addListener(t,this._errorMiddlewares)}_addListener(t,e){return e.unshift(t),{unsubscribe:()=>{const n=e.findIndex((e=>e===t));e.splice(n,1)}}}}function As(t,e,n){const i={signed_header:ms(_s(t.state,e,n)),entry:e};return ds(i)(t.state),i.signed_header.header.hash}const Ds=(t,e)=>async n=>{const i={entry_type:"App",content:n.content},o=t.dna.zomes[e].entry_defs.findIndex((t=>t.id===n.entry_def_id));if(o<0)throw new Error(`Given entry def id ${n.entry_def_id} does not exist in this zome`);const r={App:{id:o,zome_id:e,visibility:t.dna.zomes[e].entry_defs[o].visibility}};return As(t,i,r)},Ns=t=>async e=>{if(e.access.Assigned.assignees.find((t=>!!t&&"string"!=typeof t)))throw new Error("Tried to assign a capability to an invalid agent");return As(t,{entry_type:"CapGrant",content:e},"CapGrant")},Ls=(t,e)=>async n=>{const i={signed_header:ms(function(t,e,n,i,o){return{...vs(t),base_address:n,target_address:i,tag:o,zome_id:e,type:rn.CreateLink}}(t.state,e,n.base,n.target,n.tag)),entry:void 0};return ds(i)(t.state),i.signed_header.header.hash};async function Ps(t,e){const n=await t.cascade.dht_get(e,{strategy:Br.Contents});if(!n)throw new Error("Could not find element to be deleted");const i=n.signed_header.header.content.entry_hash;var o,r,s;const a={signed_header:ms((o=t.state,r=e,s=i,{...vs(o),type:rn.Delete,deletes_address:r,deletes_entry_address:s})),entry:void 0};return ds(a)(t.state),a.signed_header.header.hash}const Ms=t=>async e=>Ps(t,e),Bs=t=>async e=>{const n=await t.cascade.dht_get(e,{strategy:Br.Contents});if(!n)throw new Error("Could not find element to be deleted");const i=n.signed_header.header.content.base_address;if(!i)throw new Error("Header for the given hash is not a CreateLink header");var o,r,s;const a={signed_header:ms((o=t.state,r=i,s=e,{...vs(o),type:rn.DeleteLink,base_address:r,link_add_address:s})),entry:void 0};return ds(a)(t.state),a.signed_header.header.hash};async function Fs(t,e,n,i){const o=await t.cascade.dht_get(e,{strategy:Br.Contents});if(!o)throw new Error("Could not find element to be deleted");const r=o.signed_header.header.content.entry_hash,s={signed_header:ms(function(t,e,n,i,o){const r=ss(e);return{...vs(t),entry_hash:r,entry_type:n,original_entry_address:i,original_header_address:o,type:rn.Update}}(t.state,n,i,r,e)),entry:n};return ds(s)(t.state),s.signed_header.header.hash}const Hs=(t,e)=>async(n,i)=>{const o={entry_type:"App",content:i.content},r=t.dna.zomes[e].entry_defs.findIndex((t=>t.id===i.entry_def_id));if(r<0)throw new Error(`Given entry def id ${i.entry_def_id} does not exist in this zome`);const s={App:{id:r,zome_id:e,visibility:t.dna.zomes[e].entry_defs[r].visibility}};return Fs(t,n,o,s)},Us=t=>async()=>{const e=gs(t.state)[1];return{agent_initial_pubkey:e,agent_latest_pubkey:e}},Vs=t=>async e=>t.p2p.call_remote(e.agent,e.zome,e.fn_name,e.cap_secret,e.payload),Gs=t=>async(e,n)=>{if(!e)throw new Error("Cannot get with undefined hash");return n=n||{strategy:Br.Contents},t.cascade.dht_get(e,n)},Ws=t=>async(e,n)=>{if(!e)throw new Error("Cannot get with undefined hash");return n=n||{strategy:Br.Contents},t.cascade.dht_get_details(e,n)},zs=t=>async(e,n)=>{if(!e)throw new Error("Cannot get with undefined hash");return n=n||{strategy:Br.Contents},t.cascade.dht_get_links(e,n)},Xs=t=>async e=>rs(t.state).map((e=>{let n;return e.header.content.entry_hash&&(n=t.state.CAS[e.header.content.entry_hash]),{signed_header:e,entry:n}}));const js={ensure:async function t(e,n){await n.create_entry({content:e,entry_def_id:"path"});const i=e.split(".");if(i.length>1){i.splice(i.length-1,1);const o=i.join(".");await t(o,n);const r=await n.hash_entry({content:e}),s=await n.hash_entry({content:o});await n.create_link({base:s,target:r,tag:e})}}};class Ys{constructor(t,e,n){this._state=t,this.conductor=e,this.p2p=n,this._pendingWorkflows={},this.workflowExecutor=new ws,setTimeout((()=>{this.p2p.join(this)}))}get cellId(){return[this._state.dnaHash,this._state.agentPubKey]}get agentPubKey(){return this.cellId[1]}get dnaHash(){return this.cellId[0]}getState(){return Po(this._state)}getSimulatedDna(){return this.conductor.registeredDnas[this.dnaHash]}getCascade(){return new $r(this._state,this.p2p)}static async create(t,e,n){const i={dnaHash:e[0],agentPubKey:e[1],CAS:{},integrationLimbo:{},metadata:{link_meta:[],misc_meta:{},system_meta:{}},validationLimbo:{},integratedDHTOps:{},authoredDHTOps:{},sourceChain:[]},o=t.network.createP2pCell(e),r=new Ys(i,t,o);return await r._runWorkflow(function(t,e){return{type:ys.GENESIS,details:{cellId:t,membrane_proof:e},task:n=>Is(t[1],t[0],e)(n)}}(e,n)),r}callZomeFn(t){return this._runWorkflow((e=t.zome,n=t.fnName,i=t.payload,o=t.provenance,{type:ys.CALL_ZOME,details:{fnName:n,payload:i,zome:e},task:t=>Ss(e,n,i,o,"")(t)}));var e,n,i,o}async handle_new_neighbor(t){this.p2p.addNeighbor(t)}handle_publish(t,e,n){return this._runWorkflow(ks(t,e,n))}async handle_get(t,e){const n=new Kr(this._state,this.p2p),i=Mr(t);return i===Sr.ENTRY||i===Sr.AGENT?n.handle_get_entry(t,e):i===Sr.HEADER?n.handle_get_element(t,e):void 0}async handle_get_links(t,e){return new Kr(this._state,this.p2p).handle_get_links(t,e)}async handle_call_remote(t,e,n,i,o){return this.callZomeFn({zome:e,cap:i,fnName:n,payload:o,provenance:t})}triggerWorkflow(t){this._pendingWorkflows[t.type]=t,setTimeout((()=>this._runPendingWorkflows()),20)}async _runPendingWorkflows(){const t=this._pendingWorkflows;this._pendingWorkflows={};const e=Object.values(t).map((t=>this._runWorkflow(t)));await Promise.all(e)}async _runWorkflow(t){let e;if(t.type===ys.CALL_ZOME){const n=t.details.zome,i=this.getSimulatedDna().zomes.findIndex((t=>t.name===n));i>=0&&(e=i)}const n=await this.workflowExecutor.execute((()=>t.task(this.buildWorkspace(e))),t);return n.triggers.forEach((t=>this.triggerWorkflow(t))),n.result}buildWorkspace(t){let e;if(void 0!==t){const r={cascade:this.getCascade(),state:this._state,dna:this.getSimulatedDna(),p2p:this.p2p};e={create_entry:Ds(n=r,i=t),delete_entry:(o=n,async t=>Ps(o,t)),update_entry:Hs(n,i),hash_entry:async t=>ss({entry_type:"App",content:t.content}),get:Gs(n),get_details:Ws(n),create_link:Ls(n,i),delete_link:Bs(n),get_links:zs(n),create_cap_grant:Ns(n),delete_cap_grant:Ms(n),call_remote:Vs(n),agent_info:Us(n),query:Xs(n),path:js}}var n,i,o;return{state:this._state,p2p:this.p2p,dna:this.getSimulatedDna(),zomeFnContext:e}}}var Ks;!function(t){t.CALL_REMOTE="Call Remote",t.ADD_NEIGHBOR="Add Neighbor",t.PUBLISH_REQUEST="Publish Request",t.GET_REQUEST="Get Request"}(Ks||(Ks={}));class $s{constructor(t,e,n){this.cellId=e,this.network=n,this.networkRequestsExecutor=new ws,this.neighbors=t.neighbors,this.farKnownPeers=t.farKnownPeers,this.redundancyFactor=t.redundancyFactor,this.neighborNumber=t.neighborNumber}getState(){return{neighbors:this.neighbors,farKnownPeers:this.farKnownPeers,redundancyFactor:this.redundancyFactor,neighborNumber:this.neighborNumber}}async join(t){this.network.bootstrapService.announceCell(this.cellId,t),await this.syncNeighbors()}async leave(){}async publish(t,e){await this.network.kitsune.rpc_multi(this.cellId[0],this.cellId[1],t,this.redundancyFactor,(n=>this._executeNetworkRequest(n,Ks.PUBLISH_REQUEST,{dhtOps:e},(n=>n.handle_publish(this.cellId[1],t,e)))))}async get(t,e){return(await this.network.kitsune.rpc_multi(this.cellId[0],this.cellId[1],t,1,(n=>this._executeNetworkRequest(n,Ks.GET_REQUEST,{hash:t,options:e},(n=>n.handle_get(t,e)))))).find((t=>!!t))}async get_links(t,e){return this.network.kitsune.rpc_multi(this.cellId[0],this.cellId[1],t,1,(n=>this._executeNetworkRequest(n,Ks.GET_REQUEST,{hash:t,options:e},(n=>n.handle_get_links(t,e)))))}async call_remote(t,e,n,i,o){return this.network.kitsune.rpc_single(this.cellId[0],this.cellId[1],t,(t=>this._executeNetworkRequest(t,Ks.CALL_REMOTE,{},(t=>t.handle_call_remote(this.cellId[1],e,n,i,o)))))}getNeighbors(){return this.neighbors}addNeighbor(t){t===this.cellId[1]||this.neighbors.includes(t)||this.syncNeighbors()}async syncNeighbors(){const t=this.cellId[0],e=this.cellId[1];this.farKnownPeers=this.network.bootstrapService.getFarKnownPeers(t,e).map((t=>t.agentPubKey));const n=this.network.bootstrapService.getNeighborhood(t,e,this.neighborNumber).filter((t=>t.agentPubKey!=e)),i=n.filter((t=>!this.neighbors.includes(t.agentPubKey)));this.neighbors=n.map((t=>t.agentPubKey));const o=i.map((t=>this._executeNetworkRequest(t,Ks.ADD_NEIGHBOR,{},(t=>t.handle_new_neighbor(e)))));await Promise.all(o),this.neighbors.length<this.neighborNumber&&setTimeout((()=>this.syncNeighbors()),400)}_executeNetworkRequest(t,e,n,i){const o={fromAgent:this.cellId[1],toAgent:t.agentPubKey,dnaHash:this.cellId[0],type:e,details:n};return this.networkRequestsExecutor.execute((()=>i(t)),o)}}class Js{constructor(t){this.network=t,this.discover=new qs(t)}async rpc_single(t,e,n,i){return i(await this.discover.peer_discover(t,e,n))}async rpc_multi(t,e,n,i,o){return this.discover.message_neighborhood(t,e,n,i,o)}}class qs{constructor(t){this.network=t}async peer_discover(t,e,n){return this.network.bootstrapService.cells[t][n]}async message_neighborhood(t,e,n,i,o){const r=(await this.search_for_agents(t,n,i)).map((t=>o(t)));return Promise.all(r)}async search_for_agents(t,e,n){return this.network.bootstrapService.getNeighborhood(t,e,n)}}class Zs{constructor(t,e,n){this.conductor=e,this.bootstrapService=n,this.p2pCells={};for(const[e,n]of Object.entries(t.p2pCellsState)){this.p2pCells[e]||this.p2pCells[e];for(const[t,i]of Object.entries(n))this.p2pCells[e][t]=new $s(i,[e,t],this)}this.kitsune=new Js(this)}getState(){const t={};for(const[e,n]of Object.entries(this.p2pCells)){t[e]||(t[e]={});for(const[i,o]of Object.entries(n))t[e][i]=o.getState()}return{p2pCellsState:t}}getAllP2pCells(){const t=Object.values(this.p2pCells).map((t=>Object.values(t)));return[].concat(...t)}createP2pCell(t){const e=t[0],n=new $s({neighbors:[],farKnownPeers:[],redundancyFactor:3,neighborNumber:5},t,this);return this.p2pCells[e]||(this.p2pCells[e]={}),this.p2pCells[e][t[1]]=n,n}sendRequest(t,e,n,i){const o=this.conductor.cells[t]&&this.conductor.cells[t][n];return i(o||this.bootstrapService.cells[t][n])}}class Qs{constructor(t,e){this.network=new Zs(t.networkState,this,e),this.registeredDnas=t.registeredDnas,this.registeredTemplates=t.registeredTemplates,this.cells={};for(const[e,n]of Object.entries(t.cellsState)){this.cells[e]||(this.cells[e]={});for(const[t,i]of Object.entries(n))this.cells[e][t]=new Ys(i,this,this.network.createP2pCell(gs(i)))}}static async create(t){return new Qs({cellsState:{},networkState:{p2pCellsState:{}},registeredDnas:{},registeredTemplates:{}},t)}getState(){const t={};for(const[e,n]of Object.entries(this.cells))for(const[i,o]of Object.entries(n))t[e][i]=o.getState();return{networkState:this.network.getState(),cellsState:t,registeredDnas:this.registeredDnas,registeredTemplates:this.registeredTemplates}}getAllCells(){const t=Object.values(this.cells).map((t=>Object.values(t)));return[].concat(...t)}getCells(t){const e=this.cells[t];return e?Object.values(e):[]}getCell(t,e){return this.cells[t]?this.cells[t][e]:void 0}async registerDna(t){const e=Ar(t,Sr.DNA);return this.registeredTemplates[e]=t,e}async installApp(t,e,n,i){const o=Ar(`${Math.random().toString()}/${Date.now()}`,Sr.AGENT),r=this.registeredTemplates[t];if(!r)throw new Error("The given dna is not registered on this conductor");const s={...r,properties:n,uuid:i},a=Ar(s,Sr.DNA);this.registeredDnas[a]=s;const l=[a,o],c=await Ys.create(this,l,e);return this.cells[c.dnaHash]||(this.cells[c.dnaHash]={}),this.cells[c.dnaHash][c.agentPubKey]=c,c}callZomeFn(t){const e=t.cellId[0],n=t.cellId[1],i=this.cells[e][n];if(!i)throw new Error(`No cells existst with cellId ${e}:${n}`);return i.callZomeFn({zome:t.zome,cap:t.cap,fnName:t.fnName,payload:t.payload,provenance:n})}}const ta={name:"demo_entries",entry_defs:[{id:"demo_entry",visibility:"Public"},{id:"path",visibility:"Public"}],zome_functions:{create_entry:{call:({hash_entry:t,create_entry:e})=>async({content:n})=>(await e({content:n,entry_def_id:"demo_entry"}),t({content:n})),arguments:[{name:"content",type:"any"}]},get:{call:({get:t})=>({hash:e})=>t(e,{strategy:Br.Latest}),arguments:[{name:"hash",type:"AnyDhtHash"}]},get_details:{call:({get_details:t})=>({hash:e})=>t(e,{strategy:Br.Latest}),arguments:[{name:"hash",type:"AnyDhtHash"}]},update_entry:{call:({update_entry:t})=>({original_header_address:e,new_content:n})=>t(e,{content:n,entry_def_id:"demo_entry"}),arguments:[{name:"original_header_address",type:"HeaderHash"},{name:"new_content",type:"String"}]},delete_entry:{call:({delete_entry:t})=>({deletes_address:e})=>t(e),arguments:[{name:"deletes_address",type:"HeaderHash"}]}}},ea={name:"demo_links",entry_defs:[],zome_functions:{create_link:{call:({create_link:t})=>({base:e,target:n,tag:i})=>t({base:e,target:n,tag:i}),arguments:[{name:"base",type:"EntryHash"},{name:"target",type:"EntryHash"},{name:"tag",type:"any"}]},get_links:{call:({get_links:t})=>({base:e})=>t(e),arguments:[{name:"base",type:"EntryHash"}]},delete_link:{call:({delete_link:t})=>({add_link_header:e})=>t(e),arguments:[{name:"add_link_header",type:"HeaderHash"}]}}};function na(){return{zomes:[ta,ea]}}const ia=t=>new Promise((e=>setTimeout((()=>e()),t)));class oa{constructor(){this.cells={}}announceCell(t,e){const n=t[0],i=t[1];this.cells[n]||(this.cells[n]={}),this.cells[n][i]=e}getNeighborhood(t,e,n){return function(t,e,n){return t.sort(((t,n)=>Lr(t,e)-Lr(n,e))).slice(0,n)}(Object.keys(this.cells[t]),e,n).map((e=>this.cells[t][e]))}getFarKnownPeers(t,e){return function(t,e){const n=t.sort(((t,n)=>Pr(Nr(t)-Nr(e))-Pr(Nr(n)-Nr(e)))),i=Math.floor(.35*n.length),o=Math.floor(n.length/2),r=Math.floor(.65*n.length);return qo([n[i],n[o],n[r]].filter((t=>!!t)))}(Object.keys(this.cells[t]).filter((t=>t!==e)),e).map((e=>this.cells[t][e]))}}async function ra(t,e,n){const i=0===e.length?new oa:e[0].network.bootstrapService,o=[];for(let e=0;e<t;e++){const t=Qs.create(i);o.push(t)}const r=await Promise.all(o),s=[...e,...r];return await Promise.all(s.map((async t=>{const e=await t.registerDna(n);await t.installApp(e,null,null,"")}))),s}var sa=function(t,e){return(sa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var aa=function(){return(aa=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},la={NOTCH_ELEMENT_SELECTOR:".mdc-notched-outline__notch"},ca={NOTCH_ELEMENT_PADDING:8},da={NO_LABEL:"mdc-notched-outline--no-label",OUTLINE_NOTCHED:"mdc-notched-outline--notched",OUTLINE_UPGRADED:"mdc-notched-outline--upgraded"},ua=function(t){function e(n){return t.call(this,aa(aa({},e.defaultAdapter),n))||this}return function(t,e){function n(){this.constructor=t}sa(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),Object.defineProperty(e,"strings",{get:function(){return la},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cssClasses",{get:function(){return da},enumerable:!0,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return ca},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},setNotchWidthProperty:function(){},removeNotchWidthProperty:function(){}}},enumerable:!0,configurable:!0}),e.prototype.notch=function(t){var n=e.cssClasses.OUTLINE_NOTCHED;t>0&&(t+=ca.NOTCH_ELEMENT_PADDING),this.adapter.setNotchWidthProperty(t),this.adapter.addClass(n)},e.prototype.closeNotch=function(){var t=e.cssClasses.OUTLINE_NOTCHED;this.adapter.removeClass(t),this.adapter.removeNotchWidthProperty()},e}(Et);let ha,pa,ga=t=>t;class fa extends _t{constructor(){super(...arguments),this.mdcFoundationClass=ua,this.width=0,this.open=!1,this.lastOpen=this.open}createAdapter(){return{addClass:t=>this.mdcRoot.classList.add(t),removeClass:t=>this.mdcRoot.classList.remove(t),setNotchWidthProperty:t=>this.notchElement.style.setProperty("width",`${t}px`),removeNotchWidthProperty:()=>this.notchElement.style.removeProperty("width")}}openOrClose(t,e){this.mdcFoundation&&(t&&void 0!==e?this.mdcFoundation.notch(e):this.mdcFoundation.closeNotch())}render(){this.openOrClose(this.open,this.width);const t=Nt({"mdc-notched-outline--notched":this.open});return F(ha||(ha=ga` <span class="mdc-notched-outline ${0}"> <span class="mdc-notched-outline__leading"></span> <span class="mdc-notched-outline__notch"> <slot></slot> </span> <span class="mdc-notched-outline__trailing"></span> </span>`),t)}}t([Z(".mdc-notched-outline")],fa.prototype,"mdcRoot",void 0),t([J({type:Number})],fa.prototype,"width",void 0),t([J({type:Boolean,reflect:!0})],fa.prototype,"open",void 0),t([Z(".mdc-notched-outline__notch")],fa.prototype,"notchElement",void 0);const ma=st(pa||(pa=ga`.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}.mdc-notched-outline[dir=rtl],[dir=rtl] .mdc-notched-outline{text-align:right}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{box-sizing:border-box;height:100%;border-top:1px solid;border-bottom:1px solid;pointer-events:none}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;width:12px}.mdc-notched-outline__leading[dir=rtl],[dir=rtl] .mdc-notched-outline__leading{border-left:none;border-right:1px solid}.mdc-notched-outline__trailing{border-left:none;border-right:1px solid;flex-grow:1}.mdc-notched-outline__trailing[dir=rtl],[dir=rtl] .mdc-notched-outline__trailing{border-left:1px solid;border-right:none}.mdc-notched-outline__notch{flex:0 0 auto;width:auto;max-width:calc(100% - 12px * 2)}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(100% / .75)}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}.mdc-notched-outline--notched .mdc-notched-outline__notch[dir=rtl],[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}:host{display:block;position:absolute;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}:host[dir=rtl],[dir=rtl] :host{text-align:right}::slotted(.mdc-floating-label){display:inline-block;position:relative;top:17px;bottom:auto;max-width:100%}::slotted(.mdc-floating-label--float-above){text-overflow:clip}.mdc-notched-outline--upgraded ::slotted(.mdc-floating-label--float-above){max-width:calc(100% / .75)}.mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small,4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small,4px)}.mdc-notched-outline .mdc-notched-outline__leading[dir=rtl],[dir=rtl] .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small,4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small,4px);border-bottom-left-radius:0}@supports(top:max(0%)){.mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-shape-small,4px))}}@supports(top:max(0%)){.mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px,var(--mdc-shape-small,4px)) * 2)}}.mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small,4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small,4px);border-bottom-left-radius:0}.mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl],[dir=rtl] .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small,4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small,4px)}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{border-color:var(--mdc-notched-outline-border-color,var(--mdc-theme-primary,#6200ee));border-width:1px;border-width:var(--mdc-notched-outline-stroke-width,1px)}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0;padding-top:var(--mdc-notched-outline-notch-offset,0)}`));var _a=function(t,e){return(_a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var va=function(){return(va=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},ya={LABEL_FLOAT_ABOVE:"mdc-floating-label--float-above",LABEL_REQUIRED:"mdc-floating-label--required",LABEL_SHAKE:"mdc-floating-label--shake",ROOT:"mdc-floating-label"},ba=function(t){function e(n){var i=t.call(this,va(va({},e.defaultAdapter),n))||this;return i.shakeAnimationEndHandler_=function(){return i.handleShakeAnimationEnd_()},i}return function(t,e){function n(){this.constructor=t}_a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return ya},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},getWidth:function(){return 0},registerInteractionHandler:function(){},deregisterInteractionHandler:function(){}}},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.adapter.registerInteractionHandler("animationend",this.shakeAnimationEndHandler_)},e.prototype.destroy=function(){this.adapter.deregisterInteractionHandler("animationend",this.shakeAnimationEndHandler_)},e.prototype.getWidth=function(){return this.adapter.getWidth()},e.prototype.shake=function(t){var n=e.cssClasses.LABEL_SHAKE;t?this.adapter.addClass(n):this.adapter.removeClass(n)},e.prototype.float=function(t){var n=e.cssClasses,i=n.LABEL_FLOAT_ABOVE,o=n.LABEL_SHAKE;t?this.adapter.addClass(i):(this.adapter.removeClass(i),this.adapter.removeClass(o))},e.prototype.setRequired=function(t){var n=e.cssClasses.LABEL_REQUIRED;t?this.adapter.addClass(n):this.adapter.removeClass(n)},e.prototype.handleShakeAnimationEnd_=function(){var t=e.cssClasses.LABEL_SHAKE;this.adapter.removeClass(t)},e}(Et),Ea=function(t,e){return(Ea=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var Ta=function(){return(Ta=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Ra={LINE_RIPPLE_ACTIVE:"mdc-line-ripple--active",LINE_RIPPLE_DEACTIVATING:"mdc-line-ripple--deactivating"},Ca=function(t){function e(n){var i=t.call(this,Ta(Ta({},e.defaultAdapter),n))||this;return i.transitionEndHandler_=function(t){return i.handleTransitionEnd(t)},i}return function(t,e){function n(){this.constructor=t}Ea(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return Ra},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},setStyle:function(){},registerEventHandler:function(){},deregisterEventHandler:function(){}}},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.adapter.registerEventHandler("transitionend",this.transitionEndHandler_)},e.prototype.destroy=function(){this.adapter.deregisterEventHandler("transitionend",this.transitionEndHandler_)},e.prototype.activate=function(){this.adapter.removeClass(Ra.LINE_RIPPLE_DEACTIVATING),this.adapter.addClass(Ra.LINE_RIPPLE_ACTIVE)},e.prototype.setRippleCenter=function(t){this.adapter.setStyle("transform-origin",t+"px center")},e.prototype.deactivate=function(){this.adapter.addClass(Ra.LINE_RIPPLE_DEACTIVATING)},e.prototype.handleTransitionEnd=function(t){var e=this.adapter.hasClass(Ra.LINE_RIPPLE_DEACTIVATING);"opacity"===t.propertyName&&e&&(this.adapter.removeClass(Ra.LINE_RIPPLE_ACTIVE),this.adapter.removeClass(Ra.LINE_RIPPLE_DEACTIVATING))},e}(Et);let xa=class extends fa{};xa.styles=ma,xa=t([],xa);const Sa=new WeakMap,Ia=f((t=>e=>{if(!Sa.get(e)){const n=e.committer.element;n.classList.add("mdc-floating-label");const i=(t=>({addClass:e=>t.classList.add(e),removeClass:e=>t.classList.remove(e),getWidth:()=>t.scrollWidth,registerInteractionHandler:(e,n)=>{t.addEventListener(e,n)},deregisterInteractionHandler:(e,n)=>{t.removeEventListener(e,n)}}))(n),o=new ba(i);o.init(),e.setValue(o),Sa.set(e,{label:t,foundation:o})}})),Oa=new WeakMap,ka=f((()=>t=>{if(!Oa.get(t)){const e=t.committer.element;e.classList.add("mdc-line-ripple");const n=(t=>({addClass:e=>t.classList.add(e),removeClass:e=>t.classList.remove(e),hasClass:e=>t.classList.contains(e),setStyle:(e,n)=>t.style.setProperty(e,n),registerEventHandler:(e,n)=>{t.addEventListener(e,n)},deregisterEventHandler:(e,n)=>{t.removeEventListener(e,n)}}))(e),i=new Ca(n);i.init(),t.setValue(i),Oa.set(t,i)}}));class wa extends _t{createRenderRoot(){return this.attachShadow({mode:"open",delegatesFocus:!0})}click(){this.formElement&&(this.formElement.focus(),this.formElement.click())}setAriaLabel(t){this.formElement&&this.formElement.setAttribute("aria-label",t)}firstUpdated(){super.firstUpdated(),this.mdcRoot.addEventListener("change",(t=>{this.dispatchEvent(new Event("change",t))}))}}var Aa=function(t,e){return(Aa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var Da=function(){return(Da=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Na={ARIA_CONTROLS:"aria-controls",ARIA_DESCRIBEDBY:"aria-describedby",INPUT_SELECTOR:".mdc-text-field__input",LABEL_SELECTOR:".mdc-floating-label",LEADING_ICON_SELECTOR:".mdc-text-field__icon--leading",LINE_RIPPLE_SELECTOR:".mdc-line-ripple",OUTLINE_SELECTOR:".mdc-notched-outline",PREFIX_SELECTOR:".mdc-text-field__affix--prefix",SUFFIX_SELECTOR:".mdc-text-field__affix--suffix",TRAILING_ICON_SELECTOR:".mdc-text-field__icon--trailing"},La={DISABLED:"mdc-text-field--disabled",FOCUSED:"mdc-text-field--focused",HELPER_LINE:"mdc-text-field-helper-line",INVALID:"mdc-text-field--invalid",LABEL_FLOATING:"mdc-text-field--label-floating",NO_LABEL:"mdc-text-field--no-label",OUTLINED:"mdc-text-field--outlined",ROOT:"mdc-text-field",TEXTAREA:"mdc-text-field--textarea",WITH_LEADING_ICON:"mdc-text-field--with-leading-icon",WITH_TRAILING_ICON:"mdc-text-field--with-trailing-icon"},Pa={LABEL_SCALE:.75},Ma=["pattern","min","max","required","step","minlength","maxlength"],Ba=["color","date","datetime-local","month","range","time","week"],Fa=["mousedown","touchstart"],Ha=["click","keydown"],Ua=function(t){function e(n,i){void 0===i&&(i={});var o=t.call(this,Da(Da({},e.defaultAdapter),n))||this;return o.isFocused_=!1,o.receivedUserInput_=!1,o.isValid_=!0,o.useNativeValidation_=!0,o.validateOnValueChange_=!0,o.helperText_=i.helperText,o.characterCounter_=i.characterCounter,o.leadingIcon_=i.leadingIcon,o.trailingIcon_=i.trailingIcon,o.inputFocusHandler_=function(){return o.activateFocus()},o.inputBlurHandler_=function(){return o.deactivateFocus()},o.inputInputHandler_=function(){return o.handleInput()},o.setPointerXOffset_=function(t){return o.setTransformOrigin(t)},o.textFieldInteractionHandler_=function(){return o.handleTextFieldInteraction()},o.validationAttributeChangeHandler_=function(t){return o.handleValidationAttributeChange(t)},o}return function(t,e){function n(){this.constructor=t}Aa(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return La},enumerable:!0,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return Na},enumerable:!0,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return Pa},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldAlwaysFloat_",{get:function(){var t=this.getNativeInput_().type;return Ba.indexOf(t)>=0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldFloat",{get:function(){return this.shouldAlwaysFloat_||this.isFocused_||!!this.getValue()||this.isBadInput_()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldShake",{get:function(){return!this.isFocused_&&!this.isValid()&&!!this.getValue()},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!0},setInputAttr:function(){},removeInputAttr:function(){},registerTextFieldInteractionHandler:function(){},deregisterTextFieldInteractionHandler:function(){},registerInputInteractionHandler:function(){},deregisterInputInteractionHandler:function(){},registerValidationAttributeChangeHandler:function(){return new MutationObserver((function(){}))},deregisterValidationAttributeChangeHandler:function(){},getNativeInput:function(){return null},isFocused:function(){return!1},activateLineRipple:function(){},deactivateLineRipple:function(){},setLineRippleTransformOrigin:function(){},shakeLabel:function(){},floatLabel:function(){},setLabelRequired:function(){},hasLabel:function(){return!1},getLabelWidth:function(){return 0},hasOutline:function(){return!1},notchOutline:function(){},closeOutline:function(){}}},enumerable:!0,configurable:!0}),e.prototype.init=function(){var t=this;this.adapter.hasLabel()&&this.getNativeInput_().required&&this.adapter.setLabelRequired(!0),this.adapter.isFocused()?this.inputFocusHandler_():this.adapter.hasLabel()&&this.shouldFloat&&(this.notchOutline(!0),this.adapter.floatLabel(!0),this.styleFloating_(!0)),this.adapter.registerInputInteractionHandler("focus",this.inputFocusHandler_),this.adapter.registerInputInteractionHandler("blur",this.inputBlurHandler_),this.adapter.registerInputInteractionHandler("input",this.inputInputHandler_),Fa.forEach((function(e){t.adapter.registerInputInteractionHandler(e,t.setPointerXOffset_)})),Ha.forEach((function(e){t.adapter.registerTextFieldInteractionHandler(e,t.textFieldInteractionHandler_)})),this.validationObserver_=this.adapter.registerValidationAttributeChangeHandler(this.validationAttributeChangeHandler_),this.setCharacterCounter_(this.getValue().length)},e.prototype.destroy=function(){var t=this;this.adapter.deregisterInputInteractionHandler("focus",this.inputFocusHandler_),this.adapter.deregisterInputInteractionHandler("blur",this.inputBlurHandler_),this.adapter.deregisterInputInteractionHandler("input",this.inputInputHandler_),Fa.forEach((function(e){t.adapter.deregisterInputInteractionHandler(e,t.setPointerXOffset_)})),Ha.forEach((function(e){t.adapter.deregisterTextFieldInteractionHandler(e,t.textFieldInteractionHandler_)})),this.adapter.deregisterValidationAttributeChangeHandler(this.validationObserver_)},e.prototype.handleTextFieldInteraction=function(){var t=this.adapter.getNativeInput();t&&t.disabled||(this.receivedUserInput_=!0)},e.prototype.handleValidationAttributeChange=function(t){var e=this;t.some((function(t){return Ma.indexOf(t)>-1&&(e.styleValidity_(!0),e.adapter.setLabelRequired(e.getNativeInput_().required),!0)})),t.indexOf("maxlength")>-1&&this.setCharacterCounter_(this.getValue().length)},e.prototype.notchOutline=function(t){if(this.adapter.hasOutline()&&this.adapter.hasLabel())if(t){var e=this.adapter.getLabelWidth()*Pa.LABEL_SCALE;this.adapter.notchOutline(e)}else this.adapter.closeOutline()},e.prototype.activateFocus=function(){this.isFocused_=!0,this.styleFocused_(this.isFocused_),this.adapter.activateLineRipple(),this.adapter.hasLabel()&&(this.notchOutline(this.shouldFloat),this.adapter.floatLabel(this.shouldFloat),this.styleFloating_(this.shouldFloat),this.adapter.shakeLabel(this.shouldShake)),!this.helperText_||!this.helperText_.isPersistent()&&this.helperText_.isValidation()&&this.isValid_||this.helperText_.showToScreenReader()},e.prototype.setTransformOrigin=function(t){if(!this.isDisabled()&&!this.adapter.hasOutline()){var e=t.touches,n=e?e[0]:t,i=n.target.getBoundingClientRect(),o=n.clientX-i.left;this.adapter.setLineRippleTransformOrigin(o)}},e.prototype.handleInput=function(){this.autoCompleteFocus(),this.setCharacterCounter_(this.getValue().length)},e.prototype.autoCompleteFocus=function(){this.receivedUserInput_||this.activateFocus()},e.prototype.deactivateFocus=function(){this.isFocused_=!1,this.adapter.deactivateLineRipple();var t=this.isValid();this.styleValidity_(t),this.styleFocused_(this.isFocused_),this.adapter.hasLabel()&&(this.notchOutline(this.shouldFloat),this.adapter.floatLabel(this.shouldFloat),this.styleFloating_(this.shouldFloat),this.adapter.shakeLabel(this.shouldShake)),this.shouldFloat||(this.receivedUserInput_=!1)},e.prototype.getValue=function(){return this.getNativeInput_().value},e.prototype.setValue=function(t){if(this.getValue()!==t&&(this.getNativeInput_().value=t),this.setCharacterCounter_(t.length),this.validateOnValueChange_){var e=this.isValid();this.styleValidity_(e)}this.adapter.hasLabel()&&(this.notchOutline(this.shouldFloat),this.adapter.floatLabel(this.shouldFloat),this.styleFloating_(this.shouldFloat),this.validateOnValueChange_&&this.adapter.shakeLabel(this.shouldShake))},e.prototype.isValid=function(){return this.useNativeValidation_?this.isNativeInputValid_():this.isValid_},e.prototype.setValid=function(t){this.isValid_=t,this.styleValidity_(t);var e=!t&&!this.isFocused_&&!!this.getValue();this.adapter.hasLabel()&&this.adapter.shakeLabel(e)},e.prototype.setValidateOnValueChange=function(t){this.validateOnValueChange_=t},e.prototype.getValidateOnValueChange=function(){return this.validateOnValueChange_},e.prototype.setUseNativeValidation=function(t){this.useNativeValidation_=t},e.prototype.isDisabled=function(){return this.getNativeInput_().disabled},e.prototype.setDisabled=function(t){this.getNativeInput_().disabled=t,this.styleDisabled_(t)},e.prototype.setHelperTextContent=function(t){this.helperText_&&this.helperText_.setContent(t)},e.prototype.setLeadingIconAriaLabel=function(t){this.leadingIcon_&&this.leadingIcon_.setAriaLabel(t)},e.prototype.setLeadingIconContent=function(t){this.leadingIcon_&&this.leadingIcon_.setContent(t)},e.prototype.setTrailingIconAriaLabel=function(t){this.trailingIcon_&&this.trailingIcon_.setAriaLabel(t)},e.prototype.setTrailingIconContent=function(t){this.trailingIcon_&&this.trailingIcon_.setContent(t)},e.prototype.setCharacterCounter_=function(t){if(this.characterCounter_){var e=this.getNativeInput_().maxLength;if(-1===e)throw new Error("MDCTextFieldFoundation: Expected maxlength html property on text input or textarea.");this.characterCounter_.setCounterValue(t,e)}},e.prototype.isBadInput_=function(){return this.getNativeInput_().validity.badInput||!1},e.prototype.isNativeInputValid_=function(){return this.getNativeInput_().validity.valid},e.prototype.styleValidity_=function(t){var n=e.cssClasses.INVALID;if(t?this.adapter.removeClass(n):this.adapter.addClass(n),this.helperText_){if(this.helperText_.setValidity(t),!this.helperText_.isValidation())return;var i=this.helperText_.isVisible(),o=this.helperText_.getId();i&&o?this.adapter.setInputAttr(Na.ARIA_DESCRIBEDBY,o):this.adapter.removeInputAttr(Na.ARIA_DESCRIBEDBY)}},e.prototype.styleFocused_=function(t){var n=e.cssClasses.FOCUSED;t?this.adapter.addClass(n):this.adapter.removeClass(n)},e.prototype.styleDisabled_=function(t){var n=e.cssClasses,i=n.DISABLED,o=n.INVALID;t?(this.adapter.addClass(i),this.adapter.removeClass(o)):this.adapter.removeClass(i),this.leadingIcon_&&this.leadingIcon_.setDisabled(t),this.trailingIcon_&&this.trailingIcon_.setDisabled(t)},e.prototype.styleFloating_=function(t){var n=e.cssClasses.LABEL_FLOATING;t?this.adapter.addClass(n):this.adapter.removeClass(n)},e.prototype.getNativeInput_=function(){return(this.adapter?this.adapter.getNativeInput():null)||{disabled:!1,maxLength:-1,required:!1,type:"input",validity:{badInput:!1,valid:!0},value:""}},e}(Et);const Va=f((t=>e=>{let n;if(e instanceof D||e instanceof I)throw new Error("The `live` directive is not allowed on text or event bindings");if(e instanceof O)Ga(e.strings),n=e.element.hasAttribute(e.name),e.value=n;else{const{element:i,name:o,strings:r}=e.committer;if(Ga(r),e instanceof w){if(n=i[o],n===t)return}else e instanceof S&&(n=i.getAttribute(o));if(n===String(t))return}e.setValue(t)})),Ga=t=>{if(2!==t.length||""!==t[0]||""!==t[1])throw new Error("`live` bindings can only contain a single expression")};let Wa,za,Xa,ja,Ya,Ka,$a,Ja,qa,Za,Qa=t=>t;const tl=["touchstart","touchmove","scroll","mousewheel"],el=(t={})=>{const e={};for(const n in t)e[n]=t[n];return Object.assign({badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valid:!0,valueMissing:!1},e)};class nl extends wa{constructor(){super(...arguments),this.mdcFoundationClass=Ua,this.value="",this.type="text",this.placeholder="",this.label="",this.icon="",this.iconTrailing="",this.disabled=!1,this.required=!1,this.minLength=-1,this.maxLength=-1,this.outlined=!1,this.helper="",this.validateOnInitialRender=!1,this.validationMessage="",this.autoValidate=!1,this.pattern="",this.min="",this.max="",this.step=null,this.size=null,this.helperPersistent=!1,this.charCounter=!1,this.endAligned=!1,this.prefix="",this.suffix="",this.name="",this.readOnly=!1,this.autocapitalize="",this.outlineOpen=!1,this.outlineWidth=0,this.isUiValid=!0,this.focused=!1,this._validity=el(),this._outlineUpdateComplete=null,this.validityTransform=null}get validity(){return this._checkValidity(this.value),this._validity}get willValidate(){return this.formElement.willValidate}get selectionStart(){return this.formElement.selectionStart}get selectionEnd(){return this.formElement.selectionEnd}focus(){const t=new CustomEvent("focus");this.formElement.dispatchEvent(t),this.formElement.focus()}blur(){const t=new CustomEvent("blur");this.formElement.dispatchEvent(t),this.formElement.blur()}select(){this.formElement.select()}setSelectionRange(t,e,n){this.formElement.setSelectionRange(t,e,n)}update(t){t.has("autoValidate")&&this.mdcFoundation&&this.mdcFoundation.setValidateOnValueChange(this.autoValidate),t.has("value")&&"string"!=typeof this.value&&(this.value=`${this.value}`),super.update(t)}render(){const t=this.charCounter&&-1!==this.maxLength,e=!!this.helper||!!this.validationMessage||t,n={"mdc-text-field--disabled":this.disabled,"mdc-text-field--no-label":!this.label,"mdc-text-field--filled":!this.outlined,"mdc-text-field--outlined":this.outlined,"mdc-text-field--with-leading-icon":this.icon,"mdc-text-field--with-trailing-icon":this.iconTrailing,"mdc-text-field--end-aligned":this.endAligned};return F(Wa||(Wa=Qa` <label class="mdc-text-field ${0}"> ${0} ${0} ${0} ${0} ${0} ${0} ${0} ${0} </label> ${0} `),Nt(n),this.renderRipple(),this.outlined?this.renderOutline():this.renderLabel(),this.renderLeadingIcon(),this.renderPrefix(),this.renderInput(e),this.renderSuffix(),this.renderTrailingIcon(),this.renderLineRipple(),this.renderHelperText(e,t))}updated(t){t.has("value")&&void 0!==t.get("value")&&(this.mdcFoundation.setValue(this.value),this.autoValidate&&this.reportValidity())}renderRipple(){return this.outlined?"":F(za||(za=Qa` <span class="mdc-text-field__ripple"></span> `))}renderOutline(){return this.outlined?F(Xa||(Xa=Qa` <mwc-notched-outline .width="${0}" .open="${0}" class="mdc-notched-outline"> ${0} </mwc-notched-outline>`),this.outlineWidth,this.outlineOpen,this.renderLabel()):""}renderLabel(){return this.label?F(ja||(ja=Qa` <span .floatingLabelFoundation="${0}" id="label">${0}</span> `),Ia(this.label),this.label):""}renderLeadingIcon(){return this.icon?this.renderIcon(this.icon):""}renderTrailingIcon(){return this.iconTrailing?this.renderIcon(this.iconTrailing,!0):""}renderIcon(t,e=!1){return F(Ya||(Ya=Qa`<i class="material-icons mdc-text-field__icon ${0}">${0}</i>`),Nt({"mdc-text-field__icon--leading":!e,"mdc-text-field__icon--trailing":e}),t)}renderPrefix(){return this.prefix?this.renderAffix(this.prefix):""}renderSuffix(){return this.suffix?this.renderAffix(this.suffix,!0):""}renderAffix(t,e=!1){return F(Ka||(Ka=Qa`<span class="mdc-text-field__affix ${0}"> ${0}</span>`),Nt({"mdc-text-field__affix--prefix":!e,"mdc-text-field__affix--suffix":e}),t)}renderInput(t){const e=-1===this.minLength?void 0:this.minLength,n=-1===this.maxLength?void 0:this.maxLength,i=this.autocapitalize?this.autocapitalize:void 0,o=this.validationMessage&&!this.isUiValid,r=t?"helper-text":void 0,s=this.focused||this.helperPersistent||o?"helper-text":void 0,a=o?"helper-text":void 0;return F($a||($a=Qa` <input aria-labelledby="label" aria-controls="${0}" aria-describedby="${0}" aria-errortext="${0}" class="mdc-text-field__input" type="${0}" .value="${0}" ?disabled="${0}" placeholder="${0}" ?required="${0}" ?readonly="${0}" minlength="${0}" maxlength="${0}" pattern="${0}" min="${0}" max="${0}" step="${0}" size="${0}" name="${0}" inputmode="${0}" autocapitalize="${0}" @input="${0}" @focus="${0}" @blur="${0}">`),$t(r),$t(s),$t(a),this.type,Va(this.value),this.disabled,this.placeholder,this.required,this.readOnly,$t(e),$t(n),$t(this.pattern?this.pattern:void 0),$t(""===this.min?void 0:this.min),$t(""===this.max?void 0:this.max),$t(null===this.step?void 0:this.step),$t(null===this.size?void 0:this.size),$t(""===this.name?void 0:this.name),$t(this.inputMode),$t(i),this.handleInputChange,this.onInputFocus,this.onInputBlur)}renderLineRipple(){return this.outlined?"":F(Ja||(Ja=Qa` <span .lineRippleFoundation="${0}"></span> `),ka())}renderHelperText(t,e){const n=this.validationMessage&&!this.isUiValid,i={"mdc-text-field-helper-text--persistent":this.helperPersistent,"mdc-text-field-helper-text--validation-msg":n},o=this.focused||this.helperPersistent||n?void 0:"true",r=n?this.validationMessage:this.helper;return t?F(qa||(qa=Qa` <div class="mdc-text-field-helper-line"> <div id="helper-text" aria-hidden="${0}" class="mdc-text-field-helper-text ${0}">${0}</div> ${0} </div>`),$t(o),Nt(i),r,this.renderCharCounter(e)):""}renderCharCounter(t){const e=Math.min(this.value.length,this.maxLength);return t?F(Za||(Za=Qa` <span class="mdc-text-field-character-counter">${0} / ${0}</span>`),e,this.maxLength):""}onInputFocus(){this.focused=!0}onInputBlur(){this.focused=!1,this.reportValidity()}checkValidity(){const t=this._checkValidity(this.value);if(!t){const t=new Event("invalid",{bubbles:!1,cancelable:!0});this.dispatchEvent(t)}return t}reportValidity(){const t=this.checkValidity();return this.mdcFoundation.setValid(t),this.isUiValid=t,t}_checkValidity(t){const e=this.formElement.validity;let n=el(e);if(this.validityTransform){const e=this.validityTransform(t,n);n=Object.assign(Object.assign({},n),e),this.mdcFoundation.setUseNativeValidation(!1)}else this.mdcFoundation.setUseNativeValidation(!0);return this._validity=n,this._validity.valid}setCustomValidity(t){this.validationMessage=t,this.formElement.setCustomValidity(t)}handleInputChange(){this.value=this.formElement.value}createFoundation(){void 0!==this.mdcFoundation&&this.mdcFoundation.destroy(),this.mdcFoundation=new this.mdcFoundationClass(this.createAdapter()),this.mdcFoundation.init()}createAdapter(){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},this.getRootAdapterMethods()),this.getInputAdapterMethods()),this.getLabelAdapterMethods()),this.getLineRippleAdapterMethods()),this.getOutlineAdapterMethods())}getRootAdapterMethods(){return Object.assign({registerTextFieldInteractionHandler:(t,e)=>this.addEventListener(t,e),deregisterTextFieldInteractionHandler:(t,e)=>this.removeEventListener(t,e),registerValidationAttributeChangeHandler:t=>{const e=new MutationObserver((e=>{t((t=>t.map((t=>t.attributeName)).filter((t=>t)))(e))}));return e.observe(this.formElement,{attributes:!0}),e},deregisterValidationAttributeChangeHandler:t=>t.disconnect()},ht(this.mdcRoot))}getInputAdapterMethods(){return{getNativeInput:()=>this.formElement,setInputAttr:()=>{},removeInputAttr:()=>{},isFocused:()=>!!this.shadowRoot&&this.shadowRoot.activeElement===this.formElement,registerInputInteractionHandler:(t,e)=>this.formElement.addEventListener(t,e,{passive:t in tl}),deregisterInputInteractionHandler:(t,e)=>this.formElement.removeEventListener(t,e)}}getLabelAdapterMethods(){return{floatLabel:t=>this.labelElement&&this.labelElement.floatingLabelFoundation.float(t),getLabelWidth:()=>this.labelElement?this.labelElement.floatingLabelFoundation.getWidth():0,hasLabel:()=>Boolean(this.labelElement),shakeLabel:t=>this.labelElement&&this.labelElement.floatingLabelFoundation.shake(t),setLabelRequired:t=>{this.labelElement&&this.labelElement.floatingLabelFoundation.setRequired(t)}}}getLineRippleAdapterMethods(){return{activateLineRipple:()=>{this.lineRippleElement&&this.lineRippleElement.lineRippleFoundation.activate()},deactivateLineRipple:()=>{this.lineRippleElement&&this.lineRippleElement.lineRippleFoundation.deactivate()},setLineRippleTransformOrigin:t=>{this.lineRippleElement&&this.lineRippleElement.lineRippleFoundation.setRippleCenter(t)}}}async _getUpdateComplete(){await super._getUpdateComplete(),await this._outlineUpdateComplete}async firstUpdated(){const t=this.outlineElement;t&&(this._outlineUpdateComplete=t.updateComplete,await this._outlineUpdateComplete),super.firstUpdated(),this.mdcFoundation.setValidateOnValueChange(this.autoValidate),this.validateOnInitialRender&&this.reportValidity()}getOutlineAdapterMethods(){return{closeOutline:()=>this.outlineElement&&(this.outlineOpen=!1),hasOutline:()=>Boolean(this.outlineElement),notchOutline:t=>{this.outlineElement&&!this.outlineOpen&&(this.outlineWidth=t,this.outlineOpen=!0)}}}async layout(){await this.updateComplete;const t=this.labelElement;if(!t)return void(this.outlineOpen=!1);const e=!!this.label&&!!this.value;if(t.floatingLabelFoundation.float(e),!this.outlined)return;this.outlineOpen=e,await this.updateComplete;const n=t.floatingLabelFoundation.getWidth();this.outlineOpen&&(this.outlineWidth=n)}}t([Z(".mdc-text-field")],nl.prototype,"mdcRoot",void 0),t([Z("input")],nl.prototype,"formElement",void 0),t([Z(".mdc-floating-label")],nl.prototype,"labelElement",void 0),t([Z(".mdc-line-ripple")],nl.prototype,"lineRippleElement",void 0),t([Z("mwc-notched-outline")],nl.prototype,"outlineElement",void 0),t([Z(".mdc-notched-outline__notch")],nl.prototype,"notchElement",void 0),t([J({type:String})],nl.prototype,"value",void 0),t([J({type:String})],nl.prototype,"type",void 0),t([J({type:String})],nl.prototype,"placeholder",void 0),t([J({type:String}),vt((function(t,e){void 0!==e&&this.label!==e&&this.layout()}))],nl.prototype,"label",void 0),t([J({type:String})],nl.prototype,"icon",void 0),t([J({type:String})],nl.prototype,"iconTrailing",void 0),t([J({type:Boolean,reflect:!0})],nl.prototype,"disabled",void 0),t([J({type:Boolean})],nl.prototype,"required",void 0),t([J({type:Number})],nl.prototype,"minLength",void 0),t([J({type:Number})],nl.prototype,"maxLength",void 0),t([J({type:Boolean,reflect:!0}),vt((function(t,e){void 0!==e&&this.outlined!==e&&this.layout()}))],nl.prototype,"outlined",void 0),t([J({type:String})],nl.prototype,"helper",void 0),t([J({type:Boolean})],nl.prototype,"validateOnInitialRender",void 0),t([J({type:String})],nl.prototype,"validationMessage",void 0),t([J({type:Boolean})],nl.prototype,"autoValidate",void 0),t([J({type:String})],nl.prototype,"pattern",void 0),t([J({type:String})],nl.prototype,"min",void 0),t([J({type:String})],nl.prototype,"max",void 0),t([J({type:Number})],nl.prototype,"step",void 0),t([J({type:Number})],nl.prototype,"size",void 0),t([J({type:Boolean})],nl.prototype,"helperPersistent",void 0),t([J({type:Boolean})],nl.prototype,"charCounter",void 0),t([J({type:Boolean})],nl.prototype,"endAligned",void 0),t([J({type:String})],nl.prototype,"prefix",void 0),t([J({type:String})],nl.prototype,"suffix",void 0),t([J({type:String})],nl.prototype,"name",void 0),t([J({type:String})],nl.prototype,"inputMode",void 0),t([J({type:Boolean})],nl.prototype,"readOnly",void 0),t([J({type:String})],nl.prototype,"autocapitalize",void 0),t([J({type:Boolean})],nl.prototype,"outlineOpen",void 0),t([J({type:Number})],nl.prototype,"outlineWidth",void 0),t([J({type:Boolean})],nl.prototype,"isUiValid",void 0),t([q()],nl.prototype,"focused",void 0),t([nt({passive:!0})],nl.prototype,"handleInputChange",null);class il extends fa{}il.styles=ma;let ol;const rl=st(ol||(ol=(t=>t)`.mdc-floating-label{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto,sans-serif;font-family:var(--mdc-typography-subtitle1-font-family,var(--mdc-typography-font-family,Roboto,sans-serif));font-size:1rem;font-size:var(--mdc-typography-subtitle1-font-size,1rem);font-weight:400;font-weight:var(--mdc-typography-subtitle1-font-weight,400);letter-spacing:.009375em;letter-spacing:var(--mdc-typography-subtitle1-letter-spacing,.009375em);text-decoration:inherit;text-decoration:var(--mdc-typography-subtitle1-text-decoration,inherit);text-transform:inherit;text-transform:var(--mdc-typography-subtitle1-text-transform,inherit);position:absolute;left:0;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform;transition:transform 150ms cubic-bezier(.4,0,.2,1),color 150ms cubic-bezier(.4,0,.2,1)}.mdc-floating-label[dir=rtl],[dir=rtl] .mdc-floating-label{right:0;left:auto;transform-origin:right top;text-align:right}.mdc-floating-label--float-above{cursor:auto}.mdc-floating-label--required::after{margin-left:1px;margin-right:0;content:"*"}.mdc-floating-label--required[dir=rtl]::after,[dir=rtl] .mdc-floating-label--required::after{margin-left:0;margin-right:1px}.mdc-floating-label--float-above{transform:translateY(-106%) scale(.75)}.mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-standard 250ms 1}@keyframes mdc-floating-label-shake-float-above-standard{0%{transform:translateX(calc(0 - 0)) translateY(-106%) scale(.75)}33%{animation-timing-function:cubic-bezier(.5,0,.701732,.495819);transform:translateX(calc(4% - 0)) translateY(-106%) scale(.75)}66%{animation-timing-function:cubic-bezier(.302435,.381352,.55,.956352);transform:translateX(calc(-4% - 0)) translateY(-106%) scale(.75)}100%{transform:translateX(calc(0 - 0)) translateY(-106%) scale(.75)}}.mdc-line-ripple::after,.mdc-line-ripple::before{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{border-bottom-width:1px;z-index:1}.mdc-line-ripple::after{transform:scaleX(0);border-bottom-width:2px;opacity:0;z-index:2}.mdc-line-ripple::after{transition:transform 180ms cubic-bezier(.4,0,.2,1),opacity 180ms cubic-bezier(.4,0,.2,1)}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}.mdc-notched-outline[dir=rtl],[dir=rtl] .mdc-notched-outline{text-align:right}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{box-sizing:border-box;height:100%;border-top:1px solid;border-bottom:1px solid;pointer-events:none}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;width:12px}.mdc-notched-outline__leading[dir=rtl],[dir=rtl] .mdc-notched-outline__leading{border-left:none;border-right:1px solid}.mdc-notched-outline__trailing{border-left:none;border-right:1px solid;flex-grow:1}.mdc-notched-outline__trailing[dir=rtl],[dir=rtl] .mdc-notched-outline__trailing{border-left:1px solid;border-right:none}.mdc-notched-outline__notch{flex:0 0 auto;width:auto;max-width:calc(100% - 12px * 2)}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(100% / .75)}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}.mdc-notched-outline--notched .mdc-notched-outline__notch[dir=rtl],[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}@keyframes mdc-ripple-fg-radius-in{from{animation-timing-function:cubic-bezier(.4,0,.2,1);transform:translate(var(--mdc-ripple-fg-translate-start,0)) scale(1)}to{transform:translate(var(--mdc-ripple-fg-translate-end,0)) scale(var(--mdc-ripple-fg-scale,1))}}@keyframes mdc-ripple-fg-opacity-in{from{animation-timing-function:linear;opacity:0}to{opacity:var(--mdc-ripple-fg-opacity,0)}}@keyframes mdc-ripple-fg-opacity-out{from{animation-timing-function:linear;opacity:var(--mdc-ripple-fg-opacity,0)}to{opacity:0}}.mdc-text-field--filled{--mdc-ripple-fg-size:0;--mdc-ripple-left:0;--mdc-ripple-top:0;--mdc-ripple-fg-scale:1;--mdc-ripple-fg-translate-end:0;--mdc-ripple-fg-translate-start:0;-webkit-tap-highlight-color:transparent;will-change:transform,opacity}.mdc-text-field--filled .mdc-text-field__ripple::after,.mdc-text-field--filled .mdc-text-field__ripple::before{position:absolute;border-radius:50%;opacity:0;pointer-events:none;content:""}.mdc-text-field--filled .mdc-text-field__ripple::before{transition:opacity 15ms linear,background-color 15ms linear;z-index:1;z-index:var(--mdc-ripple-z-index,1)}.mdc-text-field--filled .mdc-text-field__ripple::after{z-index:0;z-index:var(--mdc-ripple-z-index,0)}.mdc-text-field--filled.mdc-ripple-upgraded .mdc-text-field__ripple::before{transform:scale(var(--mdc-ripple-fg-scale,1))}.mdc-text-field--filled.mdc-ripple-upgraded .mdc-text-field__ripple::after{top:0;left:0;transform:scale(0);transform-origin:center center}.mdc-text-field--filled.mdc-ripple-upgraded--unbounded .mdc-text-field__ripple::after{top:var(--mdc-ripple-top,0);left:var(--mdc-ripple-left,0)}.mdc-text-field--filled.mdc-ripple-upgraded--foreground-activation .mdc-text-field__ripple::after{animation:mdc-ripple-fg-radius-in 225ms forwards,mdc-ripple-fg-opacity-in 75ms forwards}.mdc-text-field--filled.mdc-ripple-upgraded--foreground-deactivation .mdc-text-field__ripple::after{animation:mdc-ripple-fg-opacity-out 150ms;transform:translate(var(--mdc-ripple-fg-translate-end,0)) scale(var(--mdc-ripple-fg-scale,1))}.mdc-text-field--filled .mdc-text-field__ripple::after,.mdc-text-field--filled .mdc-text-field__ripple::before{top:calc(50% - 100%);left:calc(50% - 100%);width:200%;height:200%}.mdc-text-field--filled.mdc-ripple-upgraded .mdc-text-field__ripple::after{width:var(--mdc-ripple-fg-size,100%);height:var(--mdc-ripple-fg-size,100%)}.mdc-text-field__ripple{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none}.mdc-text-field{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small,4px);border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small,4px);border-bottom-right-radius:0;border-bottom-left-radius:0;display:inline-flex;align-items:baseline;padding:0 16px;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-floating-label{color:rgba(0,0,0,.6)}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__input{color:rgba(0,0,0,.87)}@media all{.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:rgba(0,0,0,.54)}}@media all{.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:rgba(0,0,0,.54)}}.mdc-text-field .mdc-text-field__input{caret-color:#6200ee;caret-color:var(--mdc-theme-primary,#6200ee)}.mdc-text-field:not(.mdc-text-field--disabled)+.mdc-text-field-helper-line .mdc-text-field-helper-text{color:rgba(0,0,0,.6)}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field-character-counter,.mdc-text-field:not(.mdc-text-field--disabled)+.mdc-text-field-helper-line .mdc-text-field-character-counter{color:rgba(0,0,0,.6)}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__icon--leading{color:rgba(0,0,0,.54)}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__icon--trailing{color:rgba(0,0,0,.54)}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__affix--prefix{color:rgba(0,0,0,.6)}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-text-field__affix--suffix{color:rgba(0,0,0,.6)}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-text-field__input{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto,sans-serif;font-family:var(--mdc-typography-subtitle1-font-family,var(--mdc-typography-font-family,Roboto,sans-serif));font-size:1rem;font-size:var(--mdc-typography-subtitle1-font-size,1rem);font-weight:400;font-weight:var(--mdc-typography-subtitle1-font-weight,400);letter-spacing:.009375em;letter-spacing:var(--mdc-typography-subtitle1-letter-spacing,.009375em);text-decoration:inherit;text-decoration:var(--mdc-typography-subtitle1-text-decoration,inherit);text-transform:inherit;text-transform:var(--mdc-typography-subtitle1-text-transform,inherit);height:28px;transition:opacity 150ms cubic-bezier(.4,0,.2,1);width:100%;min-width:0;border:none;border-radius:0;background:0 0;appearance:none;padding:0}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input::-webkit-calendar-picker-indicator{display:none}.mdc-text-field__input:focus{outline:0}.mdc-text-field__input:invalid{box-shadow:none}@media all{.mdc-text-field__input::placeholder{transition:opacity 67ms cubic-bezier(.4,0,.2,1);opacity:0}}@media all{.mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms cubic-bezier(.4,0,.2,1);opacity:0}}@media all{.mdc-text-field--focused .mdc-text-field__input::placeholder,.mdc-text-field--no-label .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}}@media all{.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}}.mdc-text-field__affix{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto,sans-serif;font-family:var(--mdc-typography-subtitle1-font-family,var(--mdc-typography-font-family,Roboto,sans-serif));font-size:1rem;font-size:var(--mdc-typography-subtitle1-font-size,1rem);font-weight:400;font-weight:var(--mdc-typography-subtitle1-font-weight,400);letter-spacing:.009375em;letter-spacing:var(--mdc-typography-subtitle1-letter-spacing,.009375em);text-decoration:inherit;text-decoration:var(--mdc-typography-subtitle1-text-decoration,inherit);text-transform:inherit;text-transform:var(--mdc-typography-subtitle1-text-transform,inherit);height:28px;transition:opacity 150ms cubic-bezier(.4,0,.2,1);opacity:0;white-space:nowrap}.mdc-text-field--label-floating .mdc-text-field__affix,.mdc-text-field--no-label .mdc-text-field__affix{opacity:1}@supports(-webkit-hyphens:none){.mdc-text-field--outlined .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}.mdc-text-field__affix--prefix[dir=rtl],[dir=rtl] .mdc-text-field__affix--prefix{padding-left:2px;padding-right:0}.mdc-text-field--end-aligned .mdc-text-field__affix--prefix{padding-left:0;padding-right:12px}.mdc-text-field--end-aligned .mdc-text-field__affix--prefix[dir=rtl],[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--prefix{padding-left:12px;padding-right:0}.mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}.mdc-text-field__affix--suffix[dir=rtl],[dir=rtl] .mdc-text-field__affix--suffix{padding-left:0;padding-right:12px}.mdc-text-field--end-aligned .mdc-text-field__affix--suffix{padding-left:2px;padding-right:0}.mdc-text-field--end-aligned .mdc-text-field__affix--suffix[dir=rtl],[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__affix--suffix{padding-left:0;padding-right:2px}.mdc-text-field--filled{height:56px}.mdc-text-field--filled .mdc-text-field__ripple::after,.mdc-text-field--filled .mdc-text-field__ripple::before{background-color:rgba(0,0,0,.87);background-color:var(--mdc-ripple-color,rgba(0,0,0,.87))}.mdc-text-field--filled.mdc-ripple-surface--hover .mdc-text-field__ripple::before,.mdc-text-field--filled:hover .mdc-text-field__ripple::before{opacity:.04;opacity:var(--mdc-ripple-hover-opacity,.04)}.mdc-text-field--filled.mdc-ripple-upgraded--background-focused .mdc-text-field__ripple::before,.mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms;opacity:.12;opacity:var(--mdc-ripple-focus-opacity,.12)}.mdc-text-field--filled::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}.mdc-text-field--filled:not(.mdc-text-field--disabled){background-color:#f5f5f5}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:rgba(0,0,0,.42)}.mdc-text-field--filled:not(.mdc-text-field--disabled):hover .mdc-line-ripple::before{border-bottom-color:rgba(0,0,0,.87)}.mdc-text-field--filled .mdc-line-ripple::after{border-bottom-color:#6200ee;border-bottom-color:var(--mdc-theme-primary,#6200ee)}.mdc-text-field--filled .mdc-floating-label{left:16px;right:initial}.mdc-text-field--filled .mdc-floating-label[dir=rtl],[dir=rtl] .mdc-text-field--filled .mdc-floating-label{left:initial;right:16px}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(.75)}.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled.mdc-text-field--no-label::before{display:none}@supports(-webkit-hyphens:none){.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__affix{align-items:center;align-self:center;display:inline-flex;height:100%}}.mdc-text-field--outlined{height:56px;overflow:visible}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1)}.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(.75)}.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined{0%{transform:translateX(calc(0 - 0)) translateY(-34.75px) scale(.75)}33%{animation-timing-function:cubic-bezier(.5,0,.701732,.495819);transform:translateX(calc(4% - 0)) translateY(-34.75px) scale(.75)}66%{animation-timing-function:cubic-bezier(.302435,.381352,.55,.956352);transform:translateX(calc(-4% - 0)) translateY(-34.75px) scale(.75)}100%{transform:translateX(calc(0 - 0)) translateY(-34.75px) scale(.75)}}.mdc-text-field--outlined .mdc-text-field__input{height:100%}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:rgba(0,0,0,.38)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:rgba(0,0,0,.87)}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:#6200ee;border-color:var(--mdc-theme-primary,#6200ee)}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small,4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small,4px)}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl],[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small,4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small,4px);border-bottom-left-radius:0}@supports(top:max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-shape-small,4px))}}@supports(top:max(0%)){.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px,var(--mdc-shape-small,4px)) * 2)}}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small,4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small,4px);border-bottom-left-radius:0}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl],[dir=rtl] .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small,4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small,4px)}@supports(top:max(0%)){.mdc-text-field--outlined{padding-left:max(16px,calc(var(--mdc-shape-small,4px) + 4px))}}@supports(top:max(0%)){.mdc-text-field--outlined{padding-right:max(16px,var(--mdc-shape-small,4px))}}@supports(top:max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-left:max(16px,calc(var(--mdc-shape-small,4px) + 4px))}}@supports(top:max(0%)){.mdc-text-field--outlined+.mdc-text-field-helper-line{padding-right:max(16px,var(--mdc-shape-small,4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:0}@supports(top:max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:max(16px,var(--mdc-shape-small,4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl],[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-right:0}@supports(top:max(0%)){.mdc-text-field--outlined.mdc-text-field--with-leading-icon[dir=rtl],[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-leading-icon{padding-left:max(16px,var(--mdc-shape-small,4px))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:0}@supports(top:max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:max(16px,calc(var(--mdc-shape-small,4px) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl],[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-left:0}@supports(top:max(0%)){.mdc-text-field--outlined.mdc-text-field--with-trailing-icon[dir=rtl],[dir=rtl] .mdc-text-field--outlined.mdc-text-field--with-trailing-icon{padding-right:max(16px,calc(var(--mdc-shape-small,4px) + 4px))}}.mdc-text-field--outlined.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--outlined .mdc-text-field__ripple::after,.mdc-text-field--outlined .mdc-text-field__ripple::before{content:none}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:initial}.mdc-text-field--outlined .mdc-floating-label[dir=rtl],[dir=rtl] .mdc-text-field--outlined .mdc-floating-label{left:initial;right:4px}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none!important;background-color:transparent}.mdc-text-field--outlined .mdc-notched-outline{z-index:1}.mdc-text-field--textarea{flex-direction:column;align-items:center;width:auto;height:auto;padding:0;transition:none}.mdc-text-field--textarea .mdc-floating-label{top:19px}.mdc-text-field--textarea .mdc-floating-label:not(.mdc-floating-label--float-above){transform:none}.mdc-text-field--textarea .mdc-text-field__input{flex-grow:1;height:auto;min-height:1.5rem;overflow-x:hidden;overflow-y:auto;box-sizing:border-box;resize:none;padding:0 16px;line-height:1.5rem}.mdc-text-field--textarea.mdc-text-field--filled::before{display:none}.mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-10.25px) scale(.75)}.mdc-text-field--textarea.mdc-text-field--filled .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-filled 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-filled{0%{transform:translateX(calc(0 - 0)) translateY(-10.25px) scale(.75)}33%{animation-timing-function:cubic-bezier(.5,0,.701732,.495819);transform:translateX(calc(4% - 0)) translateY(-10.25px) scale(.75)}66%{animation-timing-function:cubic-bezier(.302435,.381352,.55,.956352);transform:translateX(calc(-4% - 0)) translateY(-10.25px) scale(.75)}100%{transform:translateX(calc(0 - 0)) translateY(-10.25px) scale(.75)}}.mdc-text-field--textarea.mdc-text-field--filled .mdc-text-field__input{margin-top:23px;margin-bottom:9px}.mdc-text-field--textarea.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-27.25px) scale(1)}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-24.75px) scale(.75)}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--textarea.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-textarea-outlined 250ms 1}@keyframes mdc-floating-label-shake-float-above-textarea-outlined{0%{transform:translateX(calc(0 - 0)) translateY(-24.75px) scale(.75)}33%{animation-timing-function:cubic-bezier(.5,0,.701732,.495819);transform:translateX(calc(4% - 0)) translateY(-24.75px) scale(.75)}66%{animation-timing-function:cubic-bezier(.302435,.381352,.55,.956352);transform:translateX(calc(-4% - 0)) translateY(-24.75px) scale(.75)}100%{transform:translateX(calc(0 - 0)) translateY(-24.75px) scale(.75)}}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-text-field__input{margin-top:16px;margin-bottom:16px}.mdc-text-field--textarea.mdc-text-field--outlined .mdc-floating-label{top:18px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field__input{margin-bottom:2px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter{align-self:flex-end;padding:0 16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::after{display:inline-block;width:0;height:16px;content:"";vertical-align:-16px}.mdc-text-field--textarea.mdc-text-field--with-internal-counter .mdc-text-field-character-counter::before{display:none}.mdc-text-field__resizer{align-self:stretch;display:inline-flex;flex-direction:column;flex-grow:1;max-height:100%;max-width:100%;min-height:56px;min-width:fit-content;min-width:-moz-available;min-width:-webkit-fill-available;overflow:hidden;resize:both}.mdc-text-field--filled .mdc-text-field__resizer{transform:translateY(-1px)}.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field-character-counter,.mdc-text-field--filled .mdc-text-field__resizer .mdc-text-field__input{transform:translateY(1px)}.mdc-text-field--outlined .mdc-text-field__resizer{transform:translateX(-1px) translateY(-1px)}.mdc-text-field--outlined .mdc-text-field__resizer[dir=rtl],[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer{transform:translateX(1px) translateY(-1px)}.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter,.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input{transform:translateX(1px) translateY(1px)}.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter[dir=rtl],.mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input[dir=rtl],[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field-character-counter,[dir=rtl] .mdc-text-field--outlined .mdc-text-field__resizer .mdc-text-field__input{transform:translateX(-1px) translateY(1px)}.mdc-text-field--with-leading-icon{padding-left:0;padding-right:16px}.mdc-text-field--with-leading-icon[dir=rtl],[dir=rtl] .mdc-text-field--with-leading-icon{padding-left:16px;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 48px);left:48px;right:initial}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label[dir=rtl],[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label{left:initial;right:48px}.mdc-text-field--with-leading-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / .75 - 64px / .75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label{left:36px;right:initial}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label[dir=rtl],[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label{left:initial;right:36px}.mdc-text-field--with-leading-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) translateX(-32px) scale(1)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above[dir=rtl],[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) translateX(32px) scale(1)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--float-above{font-size:.75rem}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) translateX(-32px) scale(.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl],.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl],[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above,[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) translateX(32px) scale(.75)}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--with-leading-icon.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon{0%{transform:translateX(calc(0 - 32px)) translateY(-34.75px) scale(.75)}33%{animation-timing-function:cubic-bezier(.5,0,.701732,.495819);transform:translateX(calc(4% - 32px)) translateY(-34.75px) scale(.75)}66%{animation-timing-function:cubic-bezier(.302435,.381352,.55,.956352);transform:translateX(calc(-4% - 32px)) translateY(-34.75px) scale(.75)}100%{transform:translateX(calc(0 - 32px)) translateY(-34.75px) scale(.75)}}.mdc-text-field--with-leading-icon.mdc-text-field--outlined[dir=rtl] .mdc-floating-label--shake,[dir=rtl] .mdc-text-field--with-leading-icon.mdc-text-field--outlined .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-text-field-outlined-leading-icon 250ms 1}@keyframes mdc-floating-label-shake-float-above-text-field-outlined-leading-icon-rtl{0%{transform:translateX(calc(0 - -32px)) translateY(-34.75px) scale(.75)}33%{animation-timing-function:cubic-bezier(.5,0,.701732,.495819);transform:translateX(calc(4% - -32px)) translateY(-34.75px) scale(.75)}66%{animation-timing-function:cubic-bezier(.302435,.381352,.55,.956352);transform:translateX(calc(-4% - -32px)) translateY(-34.75px) scale(.75)}100%{transform:translateX(calc(0 - -32px)) translateY(-34.75px) scale(.75)}}.mdc-text-field--with-trailing-icon{padding-left:16px;padding-right:0}.mdc-text-field--with-trailing-icon[dir=rtl],[dir=rtl] .mdc-text-field--with-trailing-icon{padding-left:0;padding-right:16px}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 64px)}.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / .75 - 64px / .75)}.mdc-text-field--with-trailing-icon.mdc-text-field--outlined :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon{padding-left:0;padding-right:0}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label{max-width:calc(100% - 96px)}.mdc-text-field--with-leading-icon.mdc-text-field--with-trailing-icon.mdc-text-field--filled .mdc-floating-label--float-above{max-width:calc(100% / .75 - 96px / .75)}.mdc-text-field-helper-line{display:flex;justify-content:space-between;box-sizing:border-box}.mdc-text-field+.mdc-text-field-helper-line{padding-right:16px;padding-left:16px}.mdc-form-field>.mdc-text-field+label{align-self:flex-start}.mdc-text-field--focused:not(.mdc-text-field--disabled) .mdc-floating-label{color:rgba(98,0,238,.87)}.mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--focused .mdc-notched-outline__trailing{border-width:2px}.mdc-text-field--focused+.mdc-text-field-helper-line .mdc-text-field-helper-text:not(.mdc-text-field-helper-text--validation-msg){opacity:1}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-text-field--focused.mdc-text-field--outlined.mdc-text-field--textarea .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:0}.mdc-text-field--invalid:not(.mdc-text-field--disabled):hover .mdc-line-ripple::before{border-bottom-color:#b00020;border-bottom-color:var(--mdc-theme-error,#b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:#b00020;border-bottom-color:var(--mdc-theme-error,#b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-floating-label{color:#b00020;color:var(--mdc-theme-error,#b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-helper-text--validation-msg{color:#b00020;color:var(--mdc-theme-error,#b00020)}.mdc-text-field--invalid .mdc-text-field__input{caret-color:#b00020;caret-color:var(--mdc-theme-error,#b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__icon--trailing{color:#b00020;color:var(--mdc-theme-error,#b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:#b00020;border-bottom-color:var(--mdc-theme-error,#b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__leading,.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__notch,.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-notched-outline__trailing{border-color:#b00020;border-color:var(--mdc-theme-error,#b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-text-field--invalid:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:#b00020;border-color:var(--mdc-theme-error,#b00020)}.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__leading,.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__notch,.mdc-text-field--invalid:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline__trailing{border-color:#b00020;border-color:var(--mdc-theme-error,#b00020)}.mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-helper-text--validation-msg{opacity:1}.mdc-text-field--disabled{pointer-events:none}.mdc-text-field--disabled .mdc-text-field__input{color:rgba(0,0,0,.38)}@media all{.mdc-text-field--disabled .mdc-text-field__input::placeholder{color:rgba(0,0,0,.38)}}@media all{.mdc-text-field--disabled .mdc-text-field__input:-ms-input-placeholder{color:rgba(0,0,0,.38)}}.mdc-text-field--disabled .mdc-floating-label{color:rgba(0,0,0,.38)}.mdc-text-field--disabled+.mdc-text-field-helper-line .mdc-text-field-helper-text{color:rgba(0,0,0,.38)}.mdc-text-field--disabled .mdc-text-field-character-counter,.mdc-text-field--disabled+.mdc-text-field-helper-line .mdc-text-field-character-counter{color:rgba(0,0,0,.38)}.mdc-text-field--disabled .mdc-text-field__icon--leading{color:rgba(0,0,0,.3)}.mdc-text-field--disabled .mdc-text-field__icon--trailing{color:rgba(0,0,0,.3)}.mdc-text-field--disabled .mdc-text-field__affix--prefix{color:rgba(0,0,0,.38)}.mdc-text-field--disabled .mdc-text-field__affix--suffix{color:rgba(0,0,0,.38)}.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:rgba(0,0,0,.06)}.mdc-text-field--disabled .mdc-notched-outline__leading,.mdc-text-field--disabled .mdc-notched-outline__notch,.mdc-text-field--disabled .mdc-notched-outline__trailing{border-color:rgba(0,0,0,.06)}@media screen and (-ms-high-contrast:active){.mdc-text-field--disabled .mdc-text-field__input::placeholder{color:GrayText}}@media screen and (-ms-high-contrast:active){.mdc-text-field--disabled .mdc-text-field__input:-ms-input-placeholder{color:GrayText}}@media screen and (-ms-high-contrast:active){.mdc-text-field--disabled .mdc-floating-label{color:GrayText}}@media screen and (-ms-high-contrast:active){.mdc-text-field--disabled+.mdc-text-field-helper-line .mdc-text-field-helper-text{color:GrayText}}@media screen and (-ms-high-contrast:active){.mdc-text-field--disabled .mdc-text-field-character-counter,.mdc-text-field--disabled+.mdc-text-field-helper-line .mdc-text-field-character-counter{color:GrayText}}@media screen and (-ms-high-contrast:active){.mdc-text-field--disabled .mdc-text-field__icon--leading{color:GrayText}}@media screen and (-ms-high-contrast:active){.mdc-text-field--disabled .mdc-text-field__icon--trailing{color:GrayText}}@media screen and (-ms-high-contrast:active){.mdc-text-field--disabled .mdc-text-field__affix--prefix{color:GrayText}}@media screen and (-ms-high-contrast:active){.mdc-text-field--disabled .mdc-text-field__affix--suffix{color:GrayText}}@media screen and (-ms-high-contrast:active){.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:GrayText}}@media screen and (-ms-high-contrast:active){.mdc-text-field--disabled .mdc-notched-outline__leading,.mdc-text-field--disabled .mdc-notched-outline__notch,.mdc-text-field--disabled .mdc-notched-outline__trailing{border-color:GrayText}}.mdc-text-field--disabled .mdc-floating-label{cursor:default}.mdc-text-field--disabled.mdc-text-field--filled{background-color:#fafafa}.mdc-text-field--disabled.mdc-text-field--filled .mdc-text-field__ripple{display:none}.mdc-text-field--disabled .mdc-text-field__input{pointer-events:auto}.mdc-text-field--end-aligned .mdc-text-field__input{text-align:right}.mdc-text-field--end-aligned .mdc-text-field__input[dir=rtl],[dir=rtl] .mdc-text-field--end-aligned .mdc-text-field__input{text-align:left}.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix,.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input{direction:ltr}.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix{padding-left:0;padding-right:2px}.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix{padding-left:12px;padding-right:0}.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--leading,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--leading{order:1}.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--suffix,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--suffix{order:2}.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__input,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__input{order:3}.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__affix--prefix,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__affix--prefix{order:4}.mdc-text-field--ltr-text[dir=rtl] .mdc-text-field__icon--trailing,[dir=rtl] .mdc-text-field--ltr-text .mdc-text-field__icon--trailing{order:5}.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__input,[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__input{text-align:right}.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--prefix,[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--prefix{padding-right:12px}.mdc-text-field--ltr-text.mdc-text-field--end-aligned[dir=rtl] .mdc-text-field__affix--suffix,[dir=rtl] .mdc-text-field--ltr-text.mdc-text-field--end-aligned .mdc-text-field__affix--suffix{padding-left:2px}.mdc-text-field-helper-text{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto,sans-serif;font-family:var(--mdc-typography-caption-font-family,var(--mdc-typography-font-family,Roboto,sans-serif));font-size:.75rem;font-size:var(--mdc-typography-caption-font-size,.75rem);line-height:1.25rem;line-height:var(--mdc-typography-caption-line-height,1.25rem);font-weight:400;font-weight:var(--mdc-typography-caption-font-weight,400);letter-spacing:.0333333333em;letter-spacing:var(--mdc-typography-caption-letter-spacing,.0333333333em);text-decoration:inherit;text-decoration:var(--mdc-typography-caption-text-decoration,inherit);text-transform:inherit;text-transform:var(--mdc-typography-caption-text-transform,inherit);display:block;margin-top:0;line-height:normal;margin:0;opacity:0;will-change:opacity;transition:opacity 150ms cubic-bezier(.4,0,.2,1)}.mdc-text-field-helper-text::before{display:inline-block;width:0;height:16px;content:"";vertical-align:0}.mdc-text-field-helper-text--persistent{transition:none;opacity:1;will-change:initial}.mdc-text-field-character-counter{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto,sans-serif;font-family:var(--mdc-typography-caption-font-family,var(--mdc-typography-font-family,Roboto,sans-serif));font-size:.75rem;font-size:var(--mdc-typography-caption-font-size,.75rem);line-height:1.25rem;line-height:var(--mdc-typography-caption-line-height,1.25rem);font-weight:400;font-weight:var(--mdc-typography-caption-font-weight,400);letter-spacing:.0333333333em;letter-spacing:var(--mdc-typography-caption-letter-spacing,.0333333333em);text-decoration:inherit;text-decoration:var(--mdc-typography-caption-text-decoration,inherit);text-transform:inherit;text-transform:var(--mdc-typography-caption-text-transform,inherit);display:block;margin-top:0;line-height:normal;margin-left:auto;margin-right:0;padding-left:16px;padding-right:0;white-space:nowrap}.mdc-text-field-character-counter::before{display:inline-block;width:0;height:16px;content:"";vertical-align:0}.mdc-text-field-character-counter[dir=rtl],[dir=rtl] .mdc-text-field-character-counter{margin-left:0;margin-right:auto}.mdc-text-field-character-counter[dir=rtl],[dir=rtl] .mdc-text-field-character-counter{padding-left:0;padding-right:16px}.mdc-text-field__icon{align-self:center;cursor:pointer}.mdc-text-field__icon:not([tabindex]),.mdc-text-field__icon[tabindex="-1"]{cursor:default;pointer-events:none}.mdc-text-field__icon svg{display:block}.mdc-text-field__icon--leading{margin-left:16px;margin-right:8px}.mdc-text-field__icon--leading[dir=rtl],[dir=rtl] .mdc-text-field__icon--leading{margin-left:8px;margin-right:16px}.mdc-text-field__icon--trailing{padding:12px;margin-left:0;margin-right:0}.mdc-text-field__icon--trailing[dir=rtl],[dir=rtl] .mdc-text-field__icon--trailing{margin-left:0;margin-right:0}.material-icons{font-family:var(--mdc-icon-font, "Material Icons");font-weight:400;font-style:normal;font-size:var(--mdc-icon-size,24px);line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;font-feature-settings:"liga"}:host{display:inline-flex;flex-direction:column;outline:0}.mdc-text-field{width:100%}.mdc-text-field:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:rgba(0,0,0,.42);border-bottom-color:var(--mdc-text-field-idle-line-color,rgba(0,0,0,.42))}.mdc-text-field:not(.mdc-text-field--disabled):hover .mdc-line-ripple::before{border-bottom-color:rgba(0,0,0,.87);border-bottom-color:var(--mdc-text-field-hover-line-color,rgba(0,0,0,.87))}.mdc-text-field.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:rgba(0,0,0,.06);border-bottom-color:var(--mdc-text-field-disabled-line-color,rgba(0,0,0,.06))}.mdc-text-field.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:#b00020;border-bottom-color:var(--mdc-theme-error,#b00020)}mwc-notched-outline{--mdc-notched-outline-border-color:var(--mdc-text-field-outlined-idle-border-color, rgba(0, 0, 0, 0.38))}:host(:not([disabled]):hover) :not(.mdc-text-field--invalid):not(.mdc-text-field--focused) mwc-notched-outline{--mdc-notched-outline-border-color:var(--mdc-text-field-outlined-hover-border-color, rgba(0, 0, 0, 0.87))}:host(:not([disabled])) .mdc-text-field:not(.mdc-text-field--outlined){background-color:var(--mdc-text-field-fill-color,#f5f5f5)}:host(:not([disabled])) .mdc-text-field.mdc-text-field--invalid mwc-notched-outline{--mdc-notched-outline-border-color:var(--mdc-text-field-error-color, var(--mdc-theme-error, #b00020))}:host(:not([disabled])) .mdc-text-field.mdc-text-field--invalid .mdc-text-field__icon,:host(:not([disabled])) .mdc-text-field.mdc-text-field--invalid+.mdc-text-field-helper-line .mdc-text-field-character-counter{color:var(--mdc-text-field-error-color,var(--mdc-theme-error,#b00020))}:host(:not([disabled])) .mdc-text-field:not(.mdc-text-field--invalid):not(.mdc-text-field--focused) .mdc-floating-label,:host(:not([disabled])) .mdc-text-field:not(.mdc-text-field--invalid):not(.mdc-text-field--focused) .mdc-floating-label::after{color:var(--mdc-text-field-label-ink-color,rgba(0,0,0,.6))}:host(:not([disabled])) .mdc-text-field.mdc-text-field--focused mwc-notched-outline{--mdc-notched-outline-stroke-width:2px}:host(:not([disabled])) .mdc-text-field.mdc-text-field--focused:not(.mdc-text-field--invalid) mwc-notched-outline{--mdc-notched-outline-border-color:var(--mdc-text-field-focused-label-color, var(--mdc-theme-primary, rgba(98, 0, 238, 0.87)))}:host(:not([disabled])) .mdc-text-field.mdc-text-field--focused:not(.mdc-text-field--invalid) .mdc-floating-label{color:#6200ee;color:var(--mdc-theme-primary,#6200ee)}:host(:not([disabled])) .mdc-text-field .mdc-text-field__input{color:var(--mdc-text-field-ink-color,rgba(0,0,0,.87))}:host(:not([disabled])) .mdc-text-field .mdc-text-field__input::placeholder{color:var(--mdc-text-field-label-ink-color,rgba(0,0,0,.6))}:host(:not([disabled])) .mdc-text-field-helper-line .mdc-text-field-helper-text:not(.mdc-text-field-helper-text--validation-msg),:host(:not([disabled])) .mdc-text-field-helper-line:not(.mdc-text-field--invalid) .mdc-text-field-character-counter{color:var(--mdc-text-field-label-ink-color,rgba(0,0,0,.6))}:host([disabled]) .mdc-text-field:not(.mdc-text-field--outlined){background-color:var(--mdc-text-field-disabled-fill-color,#fafafa)}:host([disabled]) .mdc-text-field.mdc-text-field--outlined mwc-notched-outline{--mdc-notched-outline-border-color:var(--mdc-text-field-outlined-disabled-border-color, rgba(0, 0, 0, 0.06))}:host([disabled]) .mdc-text-field:not(.mdc-text-field--invalid):not(.mdc-text-field--focused) .mdc-floating-label,:host([disabled]) .mdc-text-field:not(.mdc-text-field--invalid):not(.mdc-text-field--focused) .mdc-floating-label::after{color:var(--mdc-text-field-disabled-ink-color,rgba(0,0,0,.38))}:host([disabled]) .mdc-text-field .mdc-text-field__input,:host([disabled]) .mdc-text-field .mdc-text-field__input::placeholder{color:var(--mdc-text-field-disabled-ink-color,rgba(0,0,0,.38))}:host([disabled]) .mdc-text-field-helper-line .mdc-text-field-character-counter,:host([disabled]) .mdc-text-field-helper-line .mdc-text-field-helper-text{color:var(--mdc-text-field-disabled-ink-color,rgba(0,0,0,.38))}`));class sl extends(Le(nl)){static get scopedElements(){return{"mwc-notched-outline":il}}}sl.styles=rl,t([Z(".mdc-notched-outline")],sl.prototype,"outlineElement",void 0);let al,ll,cl=t=>t;const dl=st(al||(al=cl`:host{font-family:var(--mdc-icon-font, "Material Icons");font-weight:400;font-style:normal;font-size:var(--mdc-icon-size,24px);line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;font-feature-settings:"liga"}`));class ul extends(Le(lt)){render(){return F(ll||(ll=cl`<slot></slot>`))}}ul.styles=dl;let hl,pl,gl,fl,ml,_l=t=>t;class vl extends lt{constructor(){super(...arguments),this.raised=!1,this.unelevated=!1,this.outlined=!1,this.dense=!1,this.disabled=!1,this.trailingIcon=!1,this.fullwidth=!1,this.icon="",this.label="",this.expandContent=!1,this.shouldRenderRipple=!1,this.rippleHandlers=new ae((()=>(this.shouldRenderRipple=!0,this.ripple)))}renderOverlay(){return F(hl||(hl=_l``))}renderRipple(){const t=this.raised||this.unelevated;return this.shouldRenderRipple?F(pl||(pl=_l`<mwc-ripple class="ripple" .primary="${0}" .disabled="${0}"></mwc-ripple>`),!t,this.disabled):""}createRenderRoot(){return this.attachShadow({mode:"open",delegatesFocus:!0})}focus(){const t=this.buttonElement;t&&(this.rippleHandlers.startFocus(),t.focus())}blur(){const t=this.buttonElement;t&&(this.rippleHandlers.endFocus(),t.blur())}getRenderClasses(){return Nt({"mdc-button--raised":this.raised,"mdc-button--unelevated":this.unelevated,"mdc-button--outlined":this.outlined,"mdc-button--dense":this.dense})}render(){return F(gl||(gl=_l` <button id="button" class="mdc-button ${0}" ?disabled="${0}" aria-label="${0}" @focus="${0}" @blur="${0}" @mousedown="${0}" @mouseenter="${0}" @mouseleave="${0}" @touchstart="${0}" @touchend="${0}" @touchcancel="${0}"> ${0} ${0} <span class="leading-icon"> <slot name="icon"> ${0} </slot> </span> <span class="mdc-button__label">${0}</span> <span class="slot-container ${0}"> <slot></slot> </span> <span class="trailing-icon"> <slot name="trailingIcon"> ${0} </slot> </span> </button>`),this.getRenderClasses(),this.disabled,this.label||this.icon,this.handleRippleFocus,this.handleRippleBlur,this.handleRippleActivate,this.handleRippleMouseEnter,this.handleRippleMouseLeave,this.handleRippleActivate,this.handleRippleDeactivate,this.handleRippleDeactivate,this.renderOverlay(),this.renderRipple(),this.icon&&!this.trailingIcon?this.renderIcon():"",this.label,Nt({flex:this.expandContent}),this.icon&&this.trailingIcon?this.renderIcon():"")}renderIcon(){return F(fl||(fl=_l` <mwc-icon class="mdc-button__icon"> ${0} </mwc-icon>`),this.icon)}handleRippleActivate(t){const e=()=>{window.removeEventListener("mouseup",e),this.handleRippleDeactivate()};window.addEventListener("mouseup",e),this.rippleHandlers.startPress(t)}handleRippleDeactivate(){this.rippleHandlers.endPress()}handleRippleMouseEnter(){this.rippleHandlers.startHover()}handleRippleMouseLeave(){this.rippleHandlers.endHover()}handleRippleFocus(){this.rippleHandlers.startFocus()}handleRippleBlur(){this.rippleHandlers.endFocus()}}t([J({type:Boolean,reflect:!0})],vl.prototype,"raised",void 0),t([J({type:Boolean,reflect:!0})],vl.prototype,"unelevated",void 0),t([J({type:Boolean,reflect:!0})],vl.prototype,"outlined",void 0),t([J({type:Boolean})],vl.prototype,"dense",void 0),t([J({type:Boolean,reflect:!0})],vl.prototype,"disabled",void 0),t([J({type:Boolean,attribute:"trailingicon"})],vl.prototype,"trailingIcon",void 0),t([J({type:Boolean,reflect:!0})],vl.prototype,"fullwidth",void 0),t([J({type:String})],vl.prototype,"icon",void 0),t([J({type:String})],vl.prototype,"label",void 0),t([J({type:Boolean})],vl.prototype,"expandContent",void 0),t([Z("#button")],vl.prototype,"buttonElement",void 0),t([Q("mwc-ripple")],vl.prototype,"ripple",void 0),t([q()],vl.prototype,"shouldRenderRipple",void 0),t([nt({passive:!0})],vl.prototype,"handleRippleActivate",null);const yl=st(ml||(ml=_l`.mdc-touch-target-wrapper{display:inline}.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:0;opacity:var(--mdc-elevation-overlay-opacity,0);transition:opacity 280ms cubic-bezier(.4,0,.2,1);background-color:#fff;background-color:var(--mdc-elevation-overlay-color,#fff)}.mdc-button{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto,sans-serif;font-family:var(--mdc-typography-button-font-family,var(--mdc-typography-font-family,Roboto,sans-serif));font-size:.875rem;font-size:var(--mdc-typography-button-font-size,.875rem);line-height:2.25rem;line-height:var(--mdc-typography-button-line-height,2.25rem);font-weight:500;font-weight:var(--mdc-typography-button-font-weight,500);letter-spacing:.0892857143em;letter-spacing:var(--mdc-typography-button-letter-spacing,.0892857143em);text-decoration:none;text-decoration:var(--mdc-typography-button-text-decoration,none);text-transform:uppercase;text-transform:var(--mdc-typography-button-text-transform,uppercase);padding:0 8px 0 8px;position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:0;line-height:inherit;user-select:none;-webkit-appearance:none;overflow:visible;vertical-align:middle;border-radius:4px;border-radius:var(--mdc-shape-small,4px);height:36px}.mdc-button .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:0}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button .mdc-button__ripple{border-radius:4px;border-radius:var(--mdc-shape-small,4px)}.mdc-button:not(:disabled){background-color:transparent}.mdc-button:disabled{background-color:transparent}.mdc-button .mdc-button__icon{margin-left:0;margin-right:8px;display:inline-block;width:18px;height:18px;font-size:18px;vertical-align:top}.mdc-button .mdc-button__icon[dir=rtl],[dir=rtl] .mdc-button .mdc-button__icon{margin-left:8px;margin-right:0}.mdc-button .mdc-button__touch{position:absolute;top:50%;right:0;height:48px;left:0;transform:translateY(-50%)}.mdc-button:not(:disabled){color:#6200ee;color:var(--mdc-theme-primary,#6200ee)}.mdc-button:disabled{color:rgba(0,0,0,.38)}.mdc-button__label+.mdc-button__icon{margin-left:8px;margin-right:0}.mdc-button__label+.mdc-button__icon[dir=rtl],[dir=rtl] .mdc-button__label+.mdc-button__icon{margin-left:0;margin-right:8px}svg.mdc-button__icon{fill:currentColor}.mdc-button--outlined .mdc-button__icon,.mdc-button--raised .mdc-button__icon,.mdc-button--unelevated .mdc-button__icon{margin-left:-4px;margin-right:8px}.mdc-button--outlined .mdc-button__icon[dir=rtl],.mdc-button--raised .mdc-button__icon[dir=rtl],.mdc-button--unelevated .mdc-button__icon[dir=rtl],[dir=rtl] .mdc-button--outlined .mdc-button__icon,[dir=rtl] .mdc-button--raised .mdc-button__icon,[dir=rtl] .mdc-button--unelevated .mdc-button__icon{margin-left:8px;margin-right:-4px}.mdc-button--outlined .mdc-button__label+.mdc-button__icon,.mdc-button--raised .mdc-button__label+.mdc-button__icon,.mdc-button--unelevated .mdc-button__label+.mdc-button__icon{margin-left:8px;margin-right:-4px}.mdc-button--outlined .mdc-button__label+.mdc-button__icon[dir=rtl],.mdc-button--raised .mdc-button__label+.mdc-button__icon[dir=rtl],.mdc-button--unelevated .mdc-button__label+.mdc-button__icon[dir=rtl],[dir=rtl] .mdc-button--outlined .mdc-button__label+.mdc-button__icon,[dir=rtl] .mdc-button--raised .mdc-button__label+.mdc-button__icon,[dir=rtl] .mdc-button--unelevated .mdc-button__label+.mdc-button__icon{margin-left:-4px;margin-right:8px}.mdc-button--raised,.mdc-button--unelevated{padding:0 16px 0 16px}.mdc-button--raised:not(:disabled),.mdc-button--unelevated:not(:disabled){background-color:#6200ee;background-color:var(--mdc-theme-primary,#6200ee)}.mdc-button--raised:not(:disabled),.mdc-button--unelevated:not(:disabled){color:#fff;color:var(--mdc-theme-on-primary,#fff)}.mdc-button--raised:disabled,.mdc-button--unelevated:disabled{background-color:rgba(0,0,0,.12)}.mdc-button--raised:disabled,.mdc-button--unelevated:disabled{color:rgba(0,0,0,.38)}.mdc-button--raised{box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);transition:box-shadow 280ms cubic-bezier(.4,0,.2,1)}.mdc-button--raised:focus,.mdc-button--raised:hover{box-shadow:0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12)}.mdc-button--raised:active{box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.mdc-button--raised:disabled{box-shadow:0 0 0 0 rgba(0,0,0,.2),0 0 0 0 rgba(0,0,0,.14),0 0 0 0 rgba(0,0,0,.12)}.mdc-button--outlined{padding:0 15px 0 15px;border-width:1px;border-style:solid}.mdc-button--outlined .mdc-button__ripple{top:-1px;left:-1px;border:1px solid transparent}.mdc-button--outlined .mdc-button__touch{left:-1px;width:calc(100% + 2 * 1px)}.mdc-button--outlined:not(:disabled){border-color:rgba(0,0,0,.12)}.mdc-button--outlined:disabled{border-color:rgba(0,0,0,.12)}.mdc-button--touch{margin-top:6px;margin-bottom:6px}:host{display:inline-flex;outline:0;-webkit-tap-highlight-color:transparent;vertical-align:top}:host([fullwidth]){width:100%}:host([raised]),:host([unelevated]){--mdc-ripple-color:#fff;--mdc-ripple-focus-opacity:0.24;--mdc-ripple-hover-opacity:0.08;--mdc-ripple-press-opacity:0.24}.leading-icon .mdc-button__icon,.leading-icon ::slotted(*),.trailing-icon .mdc-button__icon,.trailing-icon ::slotted(*){margin-left:0;margin-right:8px;display:inline-block;width:18px;height:18px;font-size:18px;vertical-align:top}.leading-icon .mdc-button__icon[dir=rtl],.leading-icon ::slotted(*)[dir=rtl],.trailing-icon .mdc-button__icon[dir=rtl],.trailing-icon ::slotted(*)[dir=rtl],[dir=rtl] .leading-icon .mdc-button__icon,[dir=rtl] .leading-icon ::slotted(*),[dir=rtl] .trailing-icon .mdc-button__icon,[dir=rtl] .trailing-icon ::slotted(*){margin-left:8px;margin-right:0}.trailing-icon .mdc-button__icon,.trailing-icon ::slotted(*){margin-left:8px;margin-right:0}.trailing-icon .mdc-button__icon[dir=rtl],.trailing-icon ::slotted(*)[dir=rtl],[dir=rtl] .trailing-icon .mdc-button__icon,[dir=rtl] .trailing-icon ::slotted(*){margin-left:0;margin-right:8px}.slot-container{display:inline-flex;align-items:center;justify-content:center}.slot-container.flex{flex:auto}.mdc-button{flex:auto;overflow:hidden;padding-left:8px;padding-left:var(--mdc-button-horizontal-padding,8px);padding-right:8px;padding-right:var(--mdc-button-horizontal-padding,8px)}.mdc-button--raised{box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);box-shadow:var(--mdc-button-raised-box-shadow,0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12))}.mdc-button--raised:focus{box-shadow:0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12);box-shadow:var(--mdc-button-raised-box-shadow-focus,var(--mdc-button-raised-box-shadow-hover,0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12)))}.mdc-button--raised:hover{box-shadow:0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12);box-shadow:var(--mdc-button-raised-box-shadow-hover,0 2px 4px -1px rgba(0,0,0,.2),0 4px 5px 0 rgba(0,0,0,.14),0 1px 10px 0 rgba(0,0,0,.12))}.mdc-button--raised:active{box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12);box-shadow:var(--mdc-button-raised-box-shadow-active,0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12))}.mdc-button--raised:disabled{box-shadow:0 0 0 0 rgba(0,0,0,.2),0 0 0 0 rgba(0,0,0,.14),0 0 0 0 rgba(0,0,0,.12);box-shadow:var(--mdc-button-raised-box-shadow-disabled,0 0 0 0 rgba(0,0,0,.2),0 0 0 0 rgba(0,0,0,.14),0 0 0 0 rgba(0,0,0,.12))}.mdc-button--raised,.mdc-button--unelevated{padding-left:16px;padding-left:var(--mdc-button-horizontal-padding,16px);padding-right:16px;padding-right:var(--mdc-button-horizontal-padding,16px)}.mdc-button--outlined{border-width:1px;border-width:var(--mdc-button-outline-width,1px);padding-left:calc(16px - 1px);padding-left:calc(var(--mdc-button-horizontal-padding,16px) - var(--mdc-button-outline-width,1px));padding-right:calc(16px - 1px);padding-right:calc(var(--mdc-button-horizontal-padding,16px) - var(--mdc-button-outline-width,1px))}.mdc-button--outlined:not(:disabled){border-color:rgba(0,0,0,.12);border-color:var(--mdc-button-outline-color,rgba(0,0,0,.12))}.mdc-button--outlined .ripple{top:calc(-1 * 1px);top:calc(-1 * var(--mdc-button-outline-width,1px));left:calc(-1 * 1px);left:calc(-1 * var(--mdc-button-outline-width,1px));right:initial;border-width:1px;border-width:var(--mdc-button-outline-width,1px);border-style:solid;border-color:transparent}.mdc-button--outlined .ripple[dir=rtl],[dir=rtl] .mdc-button--outlined .ripple{left:initial;right:calc(-1 * 1px);right:calc(-1 * var(--mdc-button-outline-width,1px))}.mdc-button--dense{height:28px;margin-top:0;margin-bottom:0}.mdc-button--dense .mdc-button__touch{display:none}:host([disabled]){pointer-events:none}:host([disabled]) .mdc-button{color:rgba(0,0,0,.38);color:var(--mdc-button-disabled-ink-color,rgba(0,0,0,.38))}:host([disabled]) .mdc-button--raised,:host([disabled]) .mdc-button--unelevated{background-color:rgba(0,0,0,.12);background-color:var(--mdc-button-disabled-fill-color,rgba(0,0,0,.12))}:host([disabled]) .mdc-button--outlined{border-color:rgba(0,0,0,.12);border-color:var(--mdc-button-disabled-outline-color,rgba(0,0,0,.12))}`));class bl extends(Le(vl)){static get scopedElements(){return{"mwc-icon":ul,"mwc-ripple":$e}}}bl.styles=yl,t([Q(".ripple")],bl.prototype,"ripple",void 0);var El=function(t,e){return(El=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var Tl=function(){return(Tl=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Rl={ACTIVE:"mdc-tab--active"},Cl={ARIA_SELECTED:"aria-selected",CONTENT_SELECTOR:".mdc-tab__content",INTERACTED_EVENT:"MDCTab:interacted",RIPPLE_SELECTOR:".mdc-tab__ripple",TABINDEX:"tabIndex",TAB_INDICATOR_SELECTOR:".mdc-tab-indicator"},xl=function(t){function e(n){var i=t.call(this,Tl(Tl({},e.defaultAdapter),n))||this;return i.focusOnActivate_=!0,i}return function(t,e){function n(){this.constructor=t}El(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return Rl},enumerable:!0,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return Cl},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},setAttr:function(){},activateIndicator:function(){},deactivateIndicator:function(){},notifyInteracted:function(){},getOffsetLeft:function(){return 0},getOffsetWidth:function(){return 0},getContentOffsetLeft:function(){return 0},getContentOffsetWidth:function(){return 0},focus:function(){}}},enumerable:!0,configurable:!0}),e.prototype.handleClick=function(){this.adapter.notifyInteracted()},e.prototype.isActive=function(){return this.adapter.hasClass(Rl.ACTIVE)},e.prototype.setFocusOnActivate=function(t){this.focusOnActivate_=t},e.prototype.activate=function(t){this.adapter.addClass(Rl.ACTIVE),this.adapter.setAttr(Cl.ARIA_SELECTED,"true"),this.adapter.setAttr(Cl.TABINDEX,"0"),this.adapter.activateIndicator(t),this.focusOnActivate_&&this.adapter.focus()},e.prototype.deactivate=function(){this.isActive()&&(this.adapter.removeClass(Rl.ACTIVE),this.adapter.setAttr(Cl.ARIA_SELECTED,"false"),this.adapter.setAttr(Cl.TABINDEX,"-1"),this.adapter.deactivateIndicator())},e.prototype.computeDimensions=function(){var t=this.adapter.getOffsetWidth(),e=this.adapter.getOffsetLeft(),n=this.adapter.getContentOffsetWidth(),i=this.adapter.getContentOffsetLeft();return{contentLeft:e+i,contentRight:e+i+n,rootLeft:e,rootRight:e+t}},e}(Et),Sl=function(t,e){return(Sl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function Il(t,e){function n(){this.constructor=t}Sl(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Ol=function(){return(Ol=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},kl={ACTIVE:"mdc-tab-indicator--active",FADE:"mdc-tab-indicator--fade",NO_TRANSITION:"mdc-tab-indicator--no-transition"},wl={CONTENT_SELECTOR:".mdc-tab-indicator__content"},Al=function(t){function e(n){return t.call(this,Ol(Ol({},e.defaultAdapter),n))||this}return Il(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return kl},enumerable:!0,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return wl},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},computeContentClientRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},setContentStyleProperty:function(){}}},enumerable:!0,configurable:!0}),e.prototype.computeContentClientRect=function(){return this.adapter.computeContentClientRect()},e}(Et),Dl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Il(e,t),e.prototype.activate=function(){this.adapter.addClass(Al.cssClasses.ACTIVE)},e.prototype.deactivate=function(){this.adapter.removeClass(Al.cssClasses.ACTIVE)},e}(Al),Nl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Il(e,t),e.prototype.activate=function(t){if(t){var e=this.computeContentClientRect(),n=t.width/e.width,i=t.left-e.left;this.adapter.addClass(Al.cssClasses.NO_TRANSITION),this.adapter.setContentStyleProperty("transform","translateX("+i+"px) scaleX("+n+")"),this.computeContentClientRect(),this.adapter.removeClass(Al.cssClasses.NO_TRANSITION),this.adapter.addClass(Al.cssClasses.ACTIVE),this.adapter.setContentStyleProperty("transform","")}else this.adapter.addClass(Al.cssClasses.ACTIVE)},e.prototype.deactivate=function(){this.adapter.removeClass(Al.cssClasses.ACTIVE)},e}(Al);let Ll,Pl,Ml=t=>t;class Bl extends _t{constructor(){super(...arguments),this.icon="",this.fade=!1}get mdcFoundationClass(){return this.fade?Dl:Nl}render(){const t={"mdc-tab-indicator__content--icon":this.icon,"material-icons":this.icon,"mdc-tab-indicator__content--underline":!this.icon};return F(Ll||(Ll=Ml` <span class="mdc-tab-indicator ${0}"> <span class="mdc-tab-indicator__content ${0}">${0}</span> </span> `),Nt({"mdc-tab-indicator--fade":this.fade}),Nt(t),this.icon)}updated(t){t.has("fade")&&this.createFoundation()}createAdapter(){return Object.assign(Object.assign({},ht(this.mdcRoot)),{computeContentClientRect:()=>this.contentElement.getBoundingClientRect(),setContentStyleProperty:(t,e)=>this.contentElement.style.setProperty(t,e)})}computeContentClientRect(){return this.mdcFoundation.computeContentClientRect()}activate(t){this.mdcFoundation.activate(t)}deactivate(){this.mdcFoundation.deactivate()}}t([Z(".mdc-tab-indicator")],Bl.prototype,"mdcRoot",void 0),t([Z(".mdc-tab-indicator__content")],Bl.prototype,"contentElement",void 0),t([J()],Bl.prototype,"icon",void 0),t([J({type:Boolean})],Bl.prototype,"fade",void 0);const Fl=st(Pl||(Pl=Ml`.material-icons{font-family:var(--mdc-icon-font, "Material Icons");font-weight:400;font-style:normal;font-size:var(--mdc-icon-size,24px);line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;font-feature-settings:"liga"}.mdc-tab-indicator{display:flex;position:absolute;top:0;left:0;justify-content:center;width:100%;height:100%;pointer-events:none;z-index:1}.mdc-tab-indicator .mdc-tab-indicator__content--underline{border-color:#6200ee;border-color:var(--mdc-theme-primary,#6200ee)}.mdc-tab-indicator .mdc-tab-indicator__content--icon{color:#018786;color:var(--mdc-theme-secondary,#018786)}.mdc-tab-indicator .mdc-tab-indicator__content--underline{border-top-width:2px}.mdc-tab-indicator .mdc-tab-indicator__content--icon{height:34px;font-size:34px}.mdc-tab-indicator__content{transform-origin:left;opacity:0}.mdc-tab-indicator__content--underline{align-self:flex-end;box-sizing:border-box;width:100%;border-top-style:solid}.mdc-tab-indicator__content--icon{align-self:center;margin:0 auto}.mdc-tab-indicator--active .mdc-tab-indicator__content{opacity:1}.mdc-tab-indicator .mdc-tab-indicator__content{transition:250ms transform cubic-bezier(.4,0,.2,1)}.mdc-tab-indicator--no-transition .mdc-tab-indicator__content{transition:none}.mdc-tab-indicator--fade .mdc-tab-indicator__content{transition:150ms opacity linear}.mdc-tab-indicator--active.mdc-tab-indicator--fade .mdc-tab-indicator__content{transition-delay:.1s}`));class Hl extends Bl{}Hl.styles=Fl;let Ul,Vl,Gl,Wl,zl,Xl,jl,Yl,Kl,$l,Jl=t=>t,ql=0;class Zl extends _t{constructor(){super(...arguments),this.mdcFoundationClass=xl,this.label="",this.icon="",this.hasImageIcon=!1,this.isFadingIndicator=!1,this.minWidth=!1,this.isMinWidthIndicator=!1,this.indicatorIcon="",this.stacked=!1,this.focusOnActivate=!0,this._active=!1,this.initFocus=!1,this.shouldRenderRipple=!1,this.rippleElement=null,this.rippleHandlers=new ae((()=>(this.shouldRenderRipple=!0,this.ripple.then((t=>this.rippleElement=t)),this.ripple)))}get active(){return this._active}createRenderRoot(){return this.attachShadow({mode:"open",delegatesFocus:!0})}connectedCallback(){this.dir=document.dir,super.connectedCallback()}firstUpdated(){super.firstUpdated(),this.id=this.id||"mdc-tab-"+ ++ql}render(){const t={"mdc-tab--min-width":this.minWidth,"mdc-tab--stacked":this.stacked};let e=F(Ul||(Ul=Jl``));(this.hasImageIcon||this.icon)&&(e=F(Vl||(Vl=Jl` <span class="mdc-tab__icon material-icons"><slot name="icon">${0}</slot></span>`),this.icon));let n=F(Gl||(Gl=Jl``));return this.label&&(n=F(Wl||(Wl=Jl` <span class="mdc-tab__text-label">${0}</span>`),this.label)),F(zl||(zl=Jl` <button @click="${0}" class="mdc-tab ${0}" role="tab" aria-selected="false" tabindex="-1" @focus="${0}" @blur="${0}" @mousedown="${0}" @mouseenter="${0}" @mouseleave="${0}" @touchstart="${0}" @touchend="${0}" @touchcancel="${0}"> <span class="mdc-tab__content"> ${0} ${0} ${0} </span> ${0} ${0} </button>`),this.handleClick,Nt(t),this.focus,this.handleBlur,this.handleRippleMouseDown,this.handleRippleMouseEnter,this.handleRippleMouseLeave,this.handleRippleTouchStart,this.handleRippleDeactivate,this.handleRippleDeactivate,e,n,this.isMinWidthIndicator?this.renderIndicator():"",this.isMinWidthIndicator?"":this.renderIndicator(),this.renderRipple())}renderIndicator(){return F(Xl||(Xl=Jl`<mwc-tab-indicator .icon="${0}" .fade="${0}"></mwc-tab-indicator>`),this.indicatorIcon,this.isFadingIndicator)}renderRipple(){return this.shouldRenderRipple?F(jl||(jl=Jl` <mwc-ripple primary></mwc-ripple> `)):""}createAdapter(){return Object.assign(Object.assign({},ht(this.mdcRoot)),{setAttr:(t,e)=>this.mdcRoot.setAttribute(t,e),activateIndicator:async t=>{await this.tabIndicator.updateComplete,this.tabIndicator.activate(t)},deactivateIndicator:async()=>{await this.tabIndicator.updateComplete,this.tabIndicator.deactivate()},notifyInteracted:()=>this.dispatchEvent(new CustomEvent(xl.strings.INTERACTED_EVENT,{detail:{tabId:this.id},bubbles:!0,composed:!0,cancelable:!0})),getOffsetLeft:()=>this.offsetLeft,getOffsetWidth:()=>this.mdcRoot.offsetWidth,getContentOffsetLeft:()=>this._contentElement.offsetLeft,getContentOffsetWidth:()=>this._contentElement.offsetWidth,focus:()=>{this.initFocus?this.initFocus=!1:this.mdcRoot.focus()}})}activate(t){t||(this.initFocus=!0),this.mdcFoundation?(this.mdcFoundation.activate(t),this.setActive(this.mdcFoundation.isActive())):this.updateComplete.then((()=>{this.mdcFoundation.activate(t),this.setActive(this.mdcFoundation.isActive())}))}deactivate(){this.mdcFoundation.deactivate(),this.setActive(this.mdcFoundation.isActive())}setActive(t){const e=this.active;e!==t&&(this._active=t,this.requestUpdate("active",e))}computeDimensions(){return this.mdcFoundation.computeDimensions()}computeIndicatorClientRect(){return this.tabIndicator.computeContentClientRect()}focus(){this.mdcRoot.focus(),this.handleFocus()}handleClick(){this.handleFocus(),this.mdcFoundation.handleClick()}handleFocus(){this.handleRippleFocus()}handleBlur(){this.handleRippleBlur()}handleRippleMouseDown(t){const e=()=>{window.removeEventListener("mouseup",e),this.handleRippleDeactivate()};window.addEventListener("mouseup",e),this.rippleHandlers.startPress(t)}handleRippleTouchStart(t){this.rippleHandlers.startPress(t)}handleRippleDeactivate(){this.rippleHandlers.endPress()}handleRippleMouseEnter(){this.rippleHandlers.startHover()}handleRippleMouseLeave(){this.rippleHandlers.endHover()}handleRippleFocus(){this.rippleHandlers.startFocus()}handleRippleBlur(){this.rippleHandlers.endFocus()}get isRippleActive(){var t;return(null===(t=this.rippleElement)||void 0===t?void 0:t.isActive)||!1}}t([Z(".mdc-tab")],Zl.prototype,"mdcRoot",void 0),t([Z("mwc-tab-indicator")],Zl.prototype,"tabIndicator",void 0),t([J()],Zl.prototype,"label",void 0),t([J()],Zl.prototype,"icon",void 0),t([J({type:Boolean})],Zl.prototype,"hasImageIcon",void 0),t([J({type:Boolean})],Zl.prototype,"isFadingIndicator",void 0),t([J({type:Boolean})],Zl.prototype,"minWidth",void 0),t([J({type:Boolean})],Zl.prototype,"isMinWidthIndicator",void 0),t([J({type:Boolean,reflect:!0,attribute:"active"})],Zl.prototype,"active",null),t([J()],Zl.prototype,"indicatorIcon",void 0),t([J({type:Boolean})],Zl.prototype,"stacked",void 0),t([vt((async function(t){await this.updateComplete,this.mdcFoundation.setFocusOnActivate(t)})),J({type:Boolean})],Zl.prototype,"focusOnActivate",void 0),t([Z(".mdc-tab__content")],Zl.prototype,"_contentElement",void 0),t([q()],Zl.prototype,"shouldRenderRipple",void 0),t([Q("mwc-ripple")],Zl.prototype,"ripple",void 0),t([nt({passive:!0})],Zl.prototype,"handleRippleTouchStart",null);const Ql=st(Yl||(Yl=Jl`.material-icons{font-family:var(--mdc-icon-font, "Material Icons");font-weight:400;font-style:normal;font-size:var(--mdc-icon-size,24px);line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;font-feature-settings:"liga"}.mdc-tab{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto,sans-serif;font-family:var(--mdc-typography-button-font-family,var(--mdc-typography-font-family,Roboto,sans-serif));font-size:.875rem;font-size:var(--mdc-typography-button-font-size,.875rem);line-height:2.25rem;line-height:var(--mdc-typography-button-line-height,2.25rem);font-weight:500;font-weight:var(--mdc-typography-button-font-weight,500);letter-spacing:.0892857143em;letter-spacing:var(--mdc-typography-button-letter-spacing,.0892857143em);text-decoration:none;text-decoration:var(--mdc-typography-button-text-decoration,none);text-transform:uppercase;text-transform:var(--mdc-typography-button-text-transform,uppercase);padding-right:24px;padding-left:24px;min-width:90px;position:relative;display:flex;flex:1 0 auto;justify-content:center;box-sizing:border-box;margin:0;padding-top:0;padding-bottom:0;border:none;outline:0;background:0 0;text-align:center;white-space:nowrap;cursor:pointer;-webkit-appearance:none;z-index:1}.mdc-tab .mdc-tab__text-label{color:rgba(0,0,0,.6)}.mdc-tab .mdc-tab__icon{color:rgba(0,0,0,.54);fill:currentColor}.mdc-tab::-moz-focus-inner{padding:0;border:0}.mdc-tab--min-width{flex:0 1 auto}.mdc-tab__content{position:relative;display:flex;align-items:center;justify-content:center;height:inherit;pointer-events:none}.mdc-tab__text-label{transition:150ms color linear;display:inline-block;line-height:1;z-index:2}.mdc-tab__icon{transition:150ms color linear;width:24px;height:24px;font-size:24px;z-index:2}.mdc-tab--stacked .mdc-tab__content{flex-direction:column;align-items:center;justify-content:center}.mdc-tab--stacked .mdc-tab__text-label{padding-top:6px;padding-bottom:4px}.mdc-tab--active .mdc-tab__text-label{color:#6200ee;color:var(--mdc-theme-primary,#6200ee)}.mdc-tab--active .mdc-tab__icon{color:#6200ee;color:var(--mdc-theme-primary,#6200ee);fill:currentColor}.mdc-tab--active .mdc-tab__icon,.mdc-tab--active .mdc-tab__text-label{transition-delay:.1s}.mdc-tab:not(.mdc-tab--stacked) .mdc-tab__icon+.mdc-tab__text-label{padding-left:8px;padding-right:0}.mdc-tab:not(.mdc-tab--stacked) .mdc-tab__icon+.mdc-tab__text-label[dir=rtl],[dir=rtl] .mdc-tab:not(.mdc-tab--stacked) .mdc-tab__icon+.mdc-tab__text-label{padding-left:0;padding-right:8px}@keyframes mdc-ripple-fg-radius-in{from{animation-timing-function:cubic-bezier(.4,0,.2,1);transform:translate(var(--mdc-ripple-fg-translate-start,0)) scale(1)}to{transform:translate(var(--mdc-ripple-fg-translate-end,0)) scale(var(--mdc-ripple-fg-scale,1))}}@keyframes mdc-ripple-fg-opacity-in{from{animation-timing-function:linear;opacity:0}to{opacity:var(--mdc-ripple-fg-opacity,0)}}@keyframes mdc-ripple-fg-opacity-out{from{animation-timing-function:linear;opacity:var(--mdc-ripple-fg-opacity,0)}to{opacity:0}}.mdc-tab__ripple{--mdc-ripple-fg-size:0;--mdc-ripple-left:0;--mdc-ripple-top:0;--mdc-ripple-fg-scale:1;--mdc-ripple-fg-translate-end:0;--mdc-ripple-fg-translate-start:0;-webkit-tap-highlight-color:transparent;will-change:transform,opacity;position:absolute;top:0;left:0;width:100%;height:100%;overflow:hidden}.mdc-tab__ripple::after,.mdc-tab__ripple::before{position:absolute;border-radius:50%;opacity:0;pointer-events:none;content:""}.mdc-tab__ripple::before{transition:opacity 15ms linear,background-color 15ms linear;z-index:1;z-index:var(--mdc-ripple-z-index,1)}.mdc-tab__ripple::after{z-index:0;z-index:var(--mdc-ripple-z-index,0)}.mdc-tab__ripple.mdc-ripple-upgraded::before{transform:scale(var(--mdc-ripple-fg-scale,1))}.mdc-tab__ripple.mdc-ripple-upgraded::after{top:0;left:0;transform:scale(0);transform-origin:center center}.mdc-tab__ripple.mdc-ripple-upgraded--unbounded::after{top:var(--mdc-ripple-top,0);left:var(--mdc-ripple-left,0)}.mdc-tab__ripple.mdc-ripple-upgraded--foreground-activation::after{animation:mdc-ripple-fg-radius-in 225ms forwards,mdc-ripple-fg-opacity-in 75ms forwards}.mdc-tab__ripple.mdc-ripple-upgraded--foreground-deactivation::after{animation:mdc-ripple-fg-opacity-out 150ms;transform:translate(var(--mdc-ripple-fg-translate-end,0)) scale(var(--mdc-ripple-fg-scale,1))}.mdc-tab__ripple::after,.mdc-tab__ripple::before{top:calc(50% - 100%);left:calc(50% - 100%);width:200%;height:200%}.mdc-tab__ripple.mdc-ripple-upgraded::after{width:var(--mdc-ripple-fg-size,100%);height:var(--mdc-ripple-fg-size,100%)}.mdc-tab__ripple::after,.mdc-tab__ripple::before{background-color:#6200ee;background-color:var(--mdc-ripple-color,var(--mdc-theme-primary,#6200ee))}.mdc-tab__ripple.mdc-ripple-surface--hover::before,.mdc-tab__ripple:hover::before{opacity:.04;opacity:var(--mdc-ripple-hover-opacity,.04)}.mdc-tab__ripple.mdc-ripple-upgraded--background-focused::before,.mdc-tab__ripple:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:.12;opacity:var(--mdc-ripple-focus-opacity,.12)}.mdc-tab__ripple:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mdc-tab__ripple:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:.12;opacity:var(--mdc-ripple-press-opacity,.12)}.mdc-tab__ripple.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.12)}:host{outline:0;flex:1 0 auto;display:flex;justify-content:center;-webkit-tap-highlight-color:transparent}.mdc-tab{height:var(--mdc-tab-height,48px);margin-left:0;margin-right:0;padding-right:var(--mdc-tab-horizontal-padding,24px);padding-left:var(--mdc-tab-horizontal-padding,24px)}.mdc-tab--stacked{height:var(--mdc-tab-stacked-height,72px)}.mdc-tab::-moz-focus-inner{border:0}.mdc-tab:not(.mdc-tab--stacked) .mdc-tab__icon+.mdc-tab__text-label{padding-left:8px;padding-right:0}.mdc-tab:not(.mdc-tab--stacked) .mdc-tab__icon+.mdc-tab__text-label[dir=rtl],[dir=rtl] .mdc-tab:not(.mdc-tab--stacked) .mdc-tab__icon+.mdc-tab__text-label{padding-left:0;padding-right:8px}.mdc-tab:not(.mdc-tab--active) .mdc-tab__text-label{color:var(--mdc-tab-text-label-color-default,rgba(0,0,0,.6))}.mdc-tab:not(.mdc-tab--active) .mdc-tab__icon{color:var(--mdc-tab-color-default,rgba(0,0,0,.54))}`));class tc extends(Le(Zl)){static get scopedElements(){return{"mwc-tab-indicator":Hl,"mwc-ripple":$e}}renderRipple(){return this.shouldRenderRipple?F(Kl||(Kl=Jl` <mwc-ripple primary class="ripple"></mwc-ripple> `)):""}renderIndicator(){return F($l||($l=Jl`<mwc-tab-indicator class="indicator" .icon="${0}" .fade="${0}"></mwc-tab-indicator>`),this.indicatorIcon,this.isFadingIndicator)}}tc.styles=Ql,t([Q(".ripple")],tc.prototype,"ripple",void 0),t([Z(".indicator")],tc.prototype,"tabIndicator",void 0);var ec=function(t,e){return(ec=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var nc=function(){return(nc=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},ic={ARROW_LEFT_KEY:"ArrowLeft",ARROW_RIGHT_KEY:"ArrowRight",END_KEY:"End",ENTER_KEY:"Enter",HOME_KEY:"Home",SPACE_KEY:"Space",TAB_ACTIVATED_EVENT:"MDCTabBar:activated",TAB_SCROLLER_SELECTOR:".mdc-tab-scroller",TAB_SELECTOR:".mdc-tab"},oc={ARROW_LEFT_KEYCODE:37,ARROW_RIGHT_KEYCODE:39,END_KEYCODE:35,ENTER_KEYCODE:13,EXTRA_SCROLL_AMOUNT:20,HOME_KEYCODE:36,SPACE_KEYCODE:32},rc=new Set;rc.add(ic.ARROW_LEFT_KEY),rc.add(ic.ARROW_RIGHT_KEY),rc.add(ic.END_KEY),rc.add(ic.HOME_KEY),rc.add(ic.ENTER_KEY),rc.add(ic.SPACE_KEY);var sc=new Map;sc.set(oc.ARROW_LEFT_KEYCODE,ic.ARROW_LEFT_KEY),sc.set(oc.ARROW_RIGHT_KEYCODE,ic.ARROW_RIGHT_KEY),sc.set(oc.END_KEYCODE,ic.END_KEY),sc.set(oc.HOME_KEYCODE,ic.HOME_KEY),sc.set(oc.ENTER_KEYCODE,ic.ENTER_KEY),sc.set(oc.SPACE_KEYCODE,ic.SPACE_KEY);var ac=function(t){function e(n){var i=t.call(this,nc(nc({},e.defaultAdapter),n))||this;return i.useAutomaticActivation_=!1,i}return function(t,e){function n(){this.constructor=t}ec(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),Object.defineProperty(e,"strings",{get:function(){return ic},enumerable:!0,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return oc},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{scrollTo:function(){},incrementScroll:function(){},getScrollPosition:function(){return 0},getScrollContentWidth:function(){return 0},getOffsetWidth:function(){return 0},isRTL:function(){return!1},setActiveTab:function(){},activateTabAtIndex:function(){},deactivateTabAtIndex:function(){},focusTabAtIndex:function(){},getTabIndicatorClientRectAtIndex:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},getTabDimensionsAtIndex:function(){return{rootLeft:0,rootRight:0,contentLeft:0,contentRight:0}},getPreviousActiveTabIndex:function(){return-1},getFocusedTabIndex:function(){return-1},getIndexOfTabById:function(){return-1},getTabListLength:function(){return 0},notifyTabActivated:function(){}}},enumerable:!0,configurable:!0}),e.prototype.setUseAutomaticActivation=function(t){this.useAutomaticActivation_=t},e.prototype.activateTab=function(t){var e,n=this.adapter.getPreviousActiveTabIndex();this.indexIsInRange_(t)&&t!==n&&(-1!==n&&(this.adapter.deactivateTabAtIndex(n),e=this.adapter.getTabIndicatorClientRectAtIndex(n)),this.adapter.activateTabAtIndex(t,e),this.scrollIntoView(t),this.adapter.notifyTabActivated(t))},e.prototype.handleKeyDown=function(t){var e=this.getKeyFromEvent_(t);if(void 0!==e)if(this.isActivationKey_(e)||t.preventDefault(),this.useAutomaticActivation_){if(this.isActivationKey_(e))return;var n=this.determineTargetFromKey_(this.adapter.getPreviousActiveTabIndex(),e);this.adapter.setActiveTab(n),this.scrollIntoView(n)}else{var i=this.adapter.getFocusedTabIndex();if(this.isActivationKey_(e))this.adapter.setActiveTab(i);else{n=this.determineTargetFromKey_(i,e);this.adapter.focusTabAtIndex(n),this.scrollIntoView(n)}}},e.prototype.handleTabInteraction=function(t){this.adapter.setActiveTab(this.adapter.getIndexOfTabById(t.detail.tabId))},e.prototype.scrollIntoView=function(t){if(this.indexIsInRange_(t))return 0===t?this.adapter.scrollTo(0):t===this.adapter.getTabListLength()-1?this.adapter.scrollTo(this.adapter.getScrollContentWidth()):this.isRTL_()?this.scrollIntoViewRTL_(t):void this.scrollIntoView_(t)},e.prototype.determineTargetFromKey_=function(t,e){var n=this.isRTL_(),i=this.adapter.getTabListLength()-1,o=t;return e===ic.END_KEY?o=i:e===ic.ARROW_LEFT_KEY&&!n||e===ic.ARROW_RIGHT_KEY&&n?o-=1:e===ic.ARROW_RIGHT_KEY&&!n||e===ic.ARROW_LEFT_KEY&&n?o+=1:o=0,o<0?o=i:o>i&&(o=0),o},e.prototype.calculateScrollIncrement_=function(t,e,n,i){var o=this.adapter.getTabDimensionsAtIndex(e),r=o.contentLeft-n-i,s=o.contentRight-n-oc.EXTRA_SCROLL_AMOUNT,a=r+oc.EXTRA_SCROLL_AMOUNT;return e<t?Math.min(s,0):Math.max(a,0)},e.prototype.calculateScrollIncrementRTL_=function(t,e,n,i,o){var r=this.adapter.getTabDimensionsAtIndex(e),s=o-r.contentLeft-n,a=o-r.contentRight-n-i+oc.EXTRA_SCROLL_AMOUNT,l=s-oc.EXTRA_SCROLL_AMOUNT;return e>t?Math.max(a,0):Math.min(l,0)},e.prototype.findAdjacentTabIndexClosestToEdge_=function(t,e,n,i){var o=e.rootLeft-n,r=e.rootRight-n-i,s=o+r;return o<0||s<0?t-1:r>0||s>0?t+1:-1},e.prototype.findAdjacentTabIndexClosestToEdgeRTL_=function(t,e,n,i,o){var r=o-e.rootLeft-i-n,s=o-e.rootRight-n,a=r+s;return r>0||a>0?t+1:s<0||a<0?t-1:-1},e.prototype.getKeyFromEvent_=function(t){return rc.has(t.key)?t.key:sc.get(t.keyCode)},e.prototype.isActivationKey_=function(t){return t===ic.SPACE_KEY||t===ic.ENTER_KEY},e.prototype.indexIsInRange_=function(t){return t>=0&&t<this.adapter.getTabListLength()},e.prototype.isRTL_=function(){return this.adapter.isRTL()},e.prototype.scrollIntoView_=function(t){var e=this.adapter.getScrollPosition(),n=this.adapter.getOffsetWidth(),i=this.adapter.getTabDimensionsAtIndex(t),o=this.findAdjacentTabIndexClosestToEdge_(t,i,e,n);if(this.indexIsInRange_(o)){var r=this.calculateScrollIncrement_(t,o,e,n);this.adapter.incrementScroll(r)}},e.prototype.scrollIntoViewRTL_=function(t){var e=this.adapter.getScrollPosition(),n=this.adapter.getOffsetWidth(),i=this.adapter.getTabDimensionsAtIndex(t),o=this.adapter.getScrollContentWidth(),r=this.findAdjacentTabIndexClosestToEdgeRTL_(t,i,e,n,o);if(this.indexIsInRange_(r)){var s=this.calculateScrollIncrementRTL_(t,r,e,n,o);this.adapter.incrementScroll(s)}},e}(Et),lc=function(t,e){return(lc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function cc(t,e){function n(){this.constructor=t}lc(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var dc=function(){return(dc=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};var uc={ANIMATING:"mdc-tab-scroller--animating",SCROLL_AREA_SCROLL:"mdc-tab-scroller__scroll-area--scroll",SCROLL_TEST:"mdc-tab-scroller__test"},hc={AREA_SELECTOR:".mdc-tab-scroller__scroll-area",CONTENT_SELECTOR:".mdc-tab-scroller__scroll-content"},pc=function(t){this.adapter=t},gc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return cc(e,t),e.prototype.getScrollPositionRTL=function(){var t=this.adapter.getScrollAreaScrollLeft(),e=this.calculateScrollEdges_().right;return Math.round(e-t)},e.prototype.scrollToRTL=function(t){var e=this.calculateScrollEdges_(),n=this.adapter.getScrollAreaScrollLeft(),i=this.clampScrollValue_(e.right-t);return{finalScrollPosition:i,scrollDelta:i-n}},e.prototype.incrementScrollRTL=function(t){var e=this.adapter.getScrollAreaScrollLeft(),n=this.clampScrollValue_(e-t);return{finalScrollPosition:n,scrollDelta:n-e}},e.prototype.getAnimatingScrollPosition=function(t){return t},e.prototype.calculateScrollEdges_=function(){return{left:0,right:this.adapter.getScrollContentOffsetWidth()-this.adapter.getScrollAreaOffsetWidth()}},e.prototype.clampScrollValue_=function(t){var e=this.calculateScrollEdges_();return Math.min(Math.max(e.left,t),e.right)},e}(pc),fc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return cc(e,t),e.prototype.getScrollPositionRTL=function(t){var e=this.adapter.getScrollAreaScrollLeft();return Math.round(t-e)},e.prototype.scrollToRTL=function(t){var e=this.adapter.getScrollAreaScrollLeft(),n=this.clampScrollValue_(-t);return{finalScrollPosition:n,scrollDelta:n-e}},e.prototype.incrementScrollRTL=function(t){var e=this.adapter.getScrollAreaScrollLeft(),n=this.clampScrollValue_(e-t);return{finalScrollPosition:n,scrollDelta:n-e}},e.prototype.getAnimatingScrollPosition=function(t,e){return t-e},e.prototype.calculateScrollEdges_=function(){var t=this.adapter.getScrollContentOffsetWidth();return{left:this.adapter.getScrollAreaOffsetWidth()-t,right:0}},e.prototype.clampScrollValue_=function(t){var e=this.calculateScrollEdges_();return Math.max(Math.min(e.right,t),e.left)},e}(pc),mc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return cc(e,t),e.prototype.getScrollPositionRTL=function(t){var e=this.adapter.getScrollAreaScrollLeft();return Math.round(e-t)},e.prototype.scrollToRTL=function(t){var e=this.adapter.getScrollAreaScrollLeft(),n=this.clampScrollValue_(t);return{finalScrollPosition:n,scrollDelta:e-n}},e.prototype.incrementScrollRTL=function(t){var e=this.adapter.getScrollAreaScrollLeft(),n=this.clampScrollValue_(e+t);return{finalScrollPosition:n,scrollDelta:e-n}},e.prototype.getAnimatingScrollPosition=function(t,e){return t+e},e.prototype.calculateScrollEdges_=function(){return{left:this.adapter.getScrollContentOffsetWidth()-this.adapter.getScrollAreaOffsetWidth(),right:0}},e.prototype.clampScrollValue_=function(t){var e=this.calculateScrollEdges_();return Math.min(Math.max(e.right,t),e.left)},e}(pc),_c=function(t){function e(n){var i=t.call(this,dc(dc({},e.defaultAdapter),n))||this;return i.isAnimating_=!1,i}return cc(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return uc},enumerable:!0,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return hc},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{eventTargetMatchesSelector:function(){return!1},addClass:function(){},removeClass:function(){},addScrollAreaClass:function(){},setScrollAreaStyleProperty:function(){},setScrollContentStyleProperty:function(){},getScrollContentStyleValue:function(){return""},setScrollAreaScrollLeft:function(){},getScrollAreaScrollLeft:function(){return 0},getScrollContentOffsetWidth:function(){return 0},getScrollAreaOffsetWidth:function(){return 0},computeScrollAreaClientRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},computeScrollContentClientRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},computeHorizontalScrollbarHeight:function(){return 0}}},enumerable:!0,configurable:!0}),e.prototype.init=function(){var t=this.adapter.computeHorizontalScrollbarHeight();this.adapter.setScrollAreaStyleProperty("margin-bottom",-t+"px"),this.adapter.addScrollAreaClass(e.cssClasses.SCROLL_AREA_SCROLL)},e.prototype.getScrollPosition=function(){if(this.isRTL_())return this.computeCurrentScrollPositionRTL_();var t=this.calculateCurrentTranslateX_();return this.adapter.getScrollAreaScrollLeft()-t},e.prototype.handleInteraction=function(){this.isAnimating_&&this.stopScrollAnimation_()},e.prototype.handleTransitionEnd=function(t){var n=t.target;this.isAnimating_&&this.adapter.eventTargetMatchesSelector(n,e.strings.CONTENT_SELECTOR)&&(this.isAnimating_=!1,this.adapter.removeClass(e.cssClasses.ANIMATING))},e.prototype.incrementScroll=function(t){0!==t&&this.animate_(this.getIncrementScrollOperation_(t))},e.prototype.incrementScrollImmediate=function(t){if(0!==t){var e=this.getIncrementScrollOperation_(t);0!==e.scrollDelta&&(this.stopScrollAnimation_(),this.adapter.setScrollAreaScrollLeft(e.finalScrollPosition))}},e.prototype.scrollTo=function(t){if(this.isRTL_())return this.scrollToRTL_(t);this.scrollTo_(t)},e.prototype.getRTLScroller=function(){return this.rtlScrollerInstance_||(this.rtlScrollerInstance_=this.rtlScrollerFactory_()),this.rtlScrollerInstance_},e.prototype.calculateCurrentTranslateX_=function(){var t=this.adapter.getScrollContentStyleValue("transform");if("none"===t)return 0;var e=/\((.+?)\)/.exec(t);if(!e)return 0;var n=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,o,r=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return s}(e[1].split(","),6);n[0],n[1],n[2],n[3];var i=n[4];return n[5],parseFloat(i)},e.prototype.clampScrollValue_=function(t){var e=this.calculateScrollEdges_();return Math.min(Math.max(e.left,t),e.right)},e.prototype.computeCurrentScrollPositionRTL_=function(){var t=this.calculateCurrentTranslateX_();return this.getRTLScroller().getScrollPositionRTL(t)},e.prototype.calculateScrollEdges_=function(){return{left:0,right:this.adapter.getScrollContentOffsetWidth()-this.adapter.getScrollAreaOffsetWidth()}},e.prototype.scrollTo_=function(t){var e=this.getScrollPosition(),n=this.clampScrollValue_(t),i=n-e;this.animate_({finalScrollPosition:n,scrollDelta:i})},e.prototype.scrollToRTL_=function(t){var e=this.getRTLScroller().scrollToRTL(t);this.animate_(e)},e.prototype.getIncrementScrollOperation_=function(t){if(this.isRTL_())return this.getRTLScroller().incrementScrollRTL(t);var e=this.getScrollPosition(),n=t+e,i=this.clampScrollValue_(n);return{finalScrollPosition:i,scrollDelta:i-e}},e.prototype.animate_=function(t){var n=this;0!==t.scrollDelta&&(this.stopScrollAnimation_(),this.adapter.setScrollAreaScrollLeft(t.finalScrollPosition),this.adapter.setScrollContentStyleProperty("transform","translateX("+t.scrollDelta+"px)"),this.adapter.computeScrollAreaClientRect(),requestAnimationFrame((function(){n.adapter.addClass(e.cssClasses.ANIMATING),n.adapter.setScrollContentStyleProperty("transform","none")})),this.isAnimating_=!0)},e.prototype.stopScrollAnimation_=function(){this.isAnimating_=!1;var t=this.getAnimatingScrollPosition_();this.adapter.removeClass(e.cssClasses.ANIMATING),this.adapter.setScrollContentStyleProperty("transform","translateX(0px)"),this.adapter.setScrollAreaScrollLeft(t)},e.prototype.getAnimatingScrollPosition_=function(){var t=this.calculateCurrentTranslateX_(),e=this.adapter.getScrollAreaScrollLeft();return this.isRTL_()?this.getRTLScroller().getAnimatingScrollPosition(e,t):e-t},e.prototype.rtlScrollerFactory_=function(){var t=this.adapter.getScrollAreaScrollLeft();this.adapter.setScrollAreaScrollLeft(t-1);var e=this.adapter.getScrollAreaScrollLeft();if(e<0)return this.adapter.setScrollAreaScrollLeft(t),new fc(this.adapter);var n=this.adapter.computeScrollAreaClientRect(),i=this.adapter.computeScrollContentClientRect(),o=Math.round(i.right-n.right);return this.adapter.setScrollAreaScrollLeft(t),o===e?new mc(this.adapter):new gc(this.adapter)},e.prototype.isRTL_=function(){return"rtl"===this.adapter.getScrollContentStyleValue("direction")},e}(Et);let vc,yc,bc=t=>t;class Ec extends _t{constructor(){super(...arguments),this.mdcFoundationClass=_c,this._scrollbarHeight=-1}_handleInteraction(){this.mdcFoundation.handleInteraction()}_handleTransitionEnd(t){this.mdcFoundation.handleTransitionEnd(t)}render(){return F(vc||(vc=bc` <div class="mdc-tab-scroller"> <div class="mdc-tab-scroller__scroll-area" @wheel="${0}" @touchstart="${0}" @pointerdown="${0}" @mousedown="${0}" @keydown="${0}" @transitionend="${0}"> <div class="mdc-tab-scroller__scroll-content"><slot></slot></div> </div> </div> `),this._handleInteraction,this._handleInteraction,this._handleInteraction,this._handleInteraction,this._handleInteraction,this._handleTransitionEnd)}createAdapter(){return Object.assign(Object.assign({},ht(this.mdcRoot)),{eventTargetMatchesSelector:(t,e)=>ct(t,e),addScrollAreaClass:t=>this.scrollAreaElement.classList.add(t),setScrollAreaStyleProperty:(t,e)=>this.scrollAreaElement.style.setProperty(t,e),setScrollContentStyleProperty:(t,e)=>this.scrollContentElement.style.setProperty(t,e),getScrollContentStyleValue:t=>window.getComputedStyle(this.scrollContentElement).getPropertyValue(t),setScrollAreaScrollLeft:t=>this.scrollAreaElement.scrollLeft=t,getScrollAreaScrollLeft:()=>this.scrollAreaElement.scrollLeft,getScrollContentOffsetWidth:()=>this.scrollContentElement.offsetWidth,getScrollAreaOffsetWidth:()=>this.scrollAreaElement.offsetWidth,computeScrollAreaClientRect:()=>this.scrollAreaElement.getBoundingClientRect(),computeScrollContentClientRect:()=>this.scrollContentElement.getBoundingClientRect(),computeHorizontalScrollbarHeight:()=>(-1===this._scrollbarHeight&&(this.scrollAreaElement.style.overflowX="scroll",this._scrollbarHeight=this.scrollAreaElement.offsetHeight-this.scrollAreaElement.clientHeight,this.scrollAreaElement.style.overflowX=""),this._scrollbarHeight)})}getScrollPosition(){return this.mdcFoundation.getScrollPosition()}getScrollContentWidth(){return this.scrollContentElement.offsetWidth}incrementScrollPosition(t){this.mdcFoundation.incrementScroll(t)}scrollToPosition(t){this.mdcFoundation.scrollTo(t)}}t([Z(".mdc-tab-scroller")],Ec.prototype,"mdcRoot",void 0),t([Z(".mdc-tab-scroller__scroll-area")],Ec.prototype,"scrollAreaElement",void 0),t([Z(".mdc-tab-scroller__scroll-content")],Ec.prototype,"scrollContentElement",void 0),t([nt({passive:!0})],Ec.prototype,"_handleInteraction",null);const Tc=st(yc||(yc=bc`.mdc-tab-scroller{overflow-y:hidden}.mdc-tab-scroller.mdc-tab-scroller--animating .mdc-tab-scroller__scroll-content{transition:250ms transform cubic-bezier(.4,0,.2,1)}.mdc-tab-scroller__test{position:absolute;top:-9999px;width:100px;height:100px;overflow-x:scroll}.mdc-tab-scroller__scroll-area{-webkit-overflow-scrolling:touch;display:flex;overflow-x:hidden}.mdc-tab-scroller__scroll-area::-webkit-scrollbar,.mdc-tab-scroller__test::-webkit-scrollbar{display:none}.mdc-tab-scroller__scroll-area--scroll{overflow-x:scroll}.mdc-tab-scroller__scroll-content{position:relative;display:flex;flex:1 0 auto;transform:none;will-change:transform}.mdc-tab-scroller--align-start .mdc-tab-scroller__scroll-content{justify-content:flex-start}.mdc-tab-scroller--align-end .mdc-tab-scroller__scroll-content{justify-content:flex-end}.mdc-tab-scroller--align-center .mdc-tab-scroller__scroll-content{justify-content:center}.mdc-tab-scroller--animating .mdc-tab-scroller__scroll-area{-webkit-overflow-scrolling:auto}:host{display:flex}.mdc-tab-scroller{flex:1}`));class Rc extends Ec{}Rc.styles=Tc;let Cc,xc,Sc=t=>t,Ic=class extends Zl{};Ic.styles=Ql,Ic=t([],Ic);class Oc extends _t{constructor(){super(...arguments),this.mdcFoundationClass=ac,this.activeIndex=0,this._previousActiveIndex=-1}_handleTabInteraction(t){this.mdcFoundation.handleTabInteraction(t)}_handleKeydown(t){this.mdcFoundation.handleKeyDown(t)}render(){return F(Cc||(Cc=Sc` <div class="mdc-tab-bar" role="tablist" @MDCTab:interacted="${0}" @keydown="${0}"> <mwc-tab-scroller><slot></slot></mwc-tab-scroller> </div> `),this._handleTabInteraction,this._handleKeydown)}_getTabs(){return this.tabsSlot.assignedNodes({flatten:!0}).filter((t=>t instanceof tc))}_getTab(t){return this._getTabs()[t]}createAdapter(){return{scrollTo:t=>this.getScrollerElement().scrollToPosition(t),incrementScroll:t=>this.getScrollerElement().incrementScrollPosition(t),getScrollPosition:()=>this.getScrollerElement().getScrollPosition(),getScrollContentWidth:()=>this.getScrollerElement().getScrollContentWidth(),getOffsetWidth:()=>this.mdcRoot.offsetWidth,isRTL:()=>"rtl"===window.getComputedStyle(this.mdcRoot).getPropertyValue("direction"),setActiveTab:t=>this.mdcFoundation.activateTab(t),activateTabAtIndex:(t,e)=>{const n=this._getTab(t);void 0!==n&&n.activate(e),this._previousActiveIndex=t},deactivateTabAtIndex:t=>{const e=this._getTab(t);void 0!==e&&e.deactivate()},focusTabAtIndex:t=>{const e=this._getTab(t);void 0!==e&&e.focus()},getTabIndicatorClientRectAtIndex:t=>{const e=this._getTab(t);return void 0!==e?e.computeIndicatorClientRect():new DOMRect},getTabDimensionsAtIndex:t=>{const e=this._getTab(t);return void 0!==e?e.computeDimensions():{rootLeft:0,rootRight:0,contentLeft:0,contentRight:0}},getPreviousActiveTabIndex:()=>this._previousActiveIndex,getFocusedTabIndex:()=>{const t=this._getTabs(),e=this.getRootNode().activeElement;return t.indexOf(e)},getIndexOfTabById:t=>{const e=this._getTabs();for(let n=0;n<e.length;n++)if(e[n].id===t)return n;return-1},getTabListLength:()=>this._getTabs().length,notifyTabActivated:t=>{this.activeIndex=t,this.dispatchEvent(new CustomEvent(ac.strings.TAB_ACTIVATED_EVENT,{detail:{index:t},bubbles:!0,cancelable:!0}))}}}firstUpdated(){}_getUpdateComplete(){return super._getUpdateComplete().then((()=>this.getScrollerElement().updateComplete)).then((()=>{void 0===this.mdcFoundation&&this.createFoundation()}))}scrollIndexIntoView(t){this.mdcFoundation.scrollIntoView(t)}}t([Z(".mdc-tab-bar")],Oc.prototype,"mdcRoot",void 0),t([Z("mwc-tab-scroller")],Oc.prototype,"scrollerElement",void 0),t([Z("slot")],Oc.prototype,"tabsSlot",void 0),t([vt((async function(){await this.updateComplete,this.activeIndex!==this._previousActiveIndex&&this.mdcFoundation.activateTab(this.activeIndex)})),J({type:Number})],Oc.prototype,"activeIndex",void 0);const kc=st(xc||(xc=Sc`.mdc-tab-bar{width:100%}.mdc-tab{height:48px}.mdc-tab--stacked{height:72px}:host{display:block}.mdc-tab-bar{flex:1}mwc-tab{--mdc-tab-height:48px;--mdc-tab-stacked-height:72px}`));class wc extends(Le(Oc)){static get scopedElements(){return{"mwc-tab":tc,"mwc-tab-scroller":Rc}}getScrollerElement(){const t=this.getScopedTagName("mwc-tab-scroller");return this.shadowRoot.querySelector(t)}}wc.styles=kc;let Ac,Dc,Nc,Lc,Pc=t=>t;function Mc(t,e){return(t.matches||t.webkitMatchesSelector||t.msMatchesSelector).call(t,e)}function Bc(t,e){const n=[];for(const i of t.assignedNodes({flatten:!0}))if(i.nodeType===Node.ELEMENT_NODE){const t=i;Mc(t,e)&&n.push(t)}return n}var Fc=function(t,e){return(Fc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var Hc,Uc,Vc=function(){return(Vc=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Gc=function(){function t(t){void 0===t&&(t={}),this.adapter_=t}return Object.defineProperty(t,"cssClasses",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{}},enumerable:!0,configurable:!0}),t.prototype.init=function(){},t.prototype.destroy=function(){},t}(),Wc={BG_FOCUSED:"mdc-ripple-upgraded--background-focused",FG_ACTIVATION:"mdc-ripple-upgraded--foreground-activation",FG_DEACTIVATION:"mdc-ripple-upgraded--foreground-deactivation",ROOT:"mdc-ripple-upgraded",UNBOUNDED:"mdc-ripple-upgraded--unbounded"},zc={VAR_FG_SCALE:"--mdc-ripple-fg-scale",VAR_FG_SIZE:"--mdc-ripple-fg-size",VAR_FG_TRANSLATE_END:"--mdc-ripple-fg-translate-end",VAR_FG_TRANSLATE_START:"--mdc-ripple-fg-translate-start",VAR_LEFT:"--mdc-ripple-left",VAR_TOP:"--mdc-ripple-top"},Xc={DEACTIVATION_TIMEOUT_MS:225,FG_DEACTIVATION_MS:150,INITIAL_ORIGIN_SCALE:.6,PADDING:10,TAP_DELAY_MS:300};function jc(t,e){if(void 0===t&&(t=window),void 0===e&&(e=!1),void 0===Uc||e){var n=!1;try{t.document.addEventListener("test",(function(){}),{get passive(){return n=!0}})}catch(t){}Uc=n}return!!Uc&&{passive:!0}}var Yc=["touchstart","pointerdown","mousedown","keydown"],Kc=["touchend","pointerup","mouseup","contextmenu"],$c=[],Jc=function(t){function e(n){var i=t.call(this,Vc({},e.defaultAdapter,n))||this;return i.activationAnimationHasEnded_=!1,i.activationTimer_=0,i.fgDeactivationRemovalTimer_=0,i.fgScale_="0",i.frame_={width:0,height:0},i.initialSize_=0,i.layoutFrame_=0,i.maxRadius_=0,i.unboundedCoords_={left:0,top:0},i.activationState_=i.defaultActivationState_(),i.activationTimerCallback_=function(){i.activationAnimationHasEnded_=!0,i.runDeactivationUXLogicIfReady_()},i.activateHandler_=function(t){return i.activate_(t)},i.deactivateHandler_=function(){return i.deactivate_()},i.focusHandler_=function(){return i.handleFocus()},i.blurHandler_=function(){return i.handleBlur()},i.resizeHandler_=function(){return i.layout()},i}return function(t,e){function n(){this.constructor=t}Fc(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return Wc},enumerable:!0,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return zc},enumerable:!0,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return Xc},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},browserSupportsCssVars:function(){return!0},computeBoundingRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},containsEventTarget:function(){return!0},deregisterDocumentInteractionHandler:function(){},deregisterInteractionHandler:function(){},deregisterResizeHandler:function(){},getWindowPageOffset:function(){return{x:0,y:0}},isSurfaceActive:function(){return!0},isSurfaceDisabled:function(){return!0},isUnbounded:function(){return!0},registerDocumentInteractionHandler:function(){},registerInteractionHandler:function(){},registerResizeHandler:function(){},removeClass:function(){},updateCssVariable:function(){}}},enumerable:!0,configurable:!0}),e.prototype.init=function(){var t=this,n=this.supportsPressRipple_();if(this.registerRootHandlers_(n),n){var i=e.cssClasses,o=i.ROOT,r=i.UNBOUNDED;requestAnimationFrame((function(){t.adapter_.addClass(o),t.adapter_.isUnbounded()&&(t.adapter_.addClass(r),t.layoutInternal_())}))}},e.prototype.destroy=function(){var t=this;if(this.supportsPressRipple_()){this.activationTimer_&&(clearTimeout(this.activationTimer_),this.activationTimer_=0,this.adapter_.removeClass(e.cssClasses.FG_ACTIVATION)),this.fgDeactivationRemovalTimer_&&(clearTimeout(this.fgDeactivationRemovalTimer_),this.fgDeactivationRemovalTimer_=0,this.adapter_.removeClass(e.cssClasses.FG_DEACTIVATION));var n=e.cssClasses,i=n.ROOT,o=n.UNBOUNDED;requestAnimationFrame((function(){t.adapter_.removeClass(i),t.adapter_.removeClass(o),t.removeCssVars_()}))}this.deregisterRootHandlers_(),this.deregisterDeactivationHandlers_()},e.prototype.activate=function(t){this.activate_(t)},e.prototype.deactivate=function(){this.deactivate_()},e.prototype.layout=function(){var t=this;this.layoutFrame_&&cancelAnimationFrame(this.layoutFrame_),this.layoutFrame_=requestAnimationFrame((function(){t.layoutInternal_(),t.layoutFrame_=0}))},e.prototype.setUnbounded=function(t){var n=e.cssClasses.UNBOUNDED;t?this.adapter_.addClass(n):this.adapter_.removeClass(n)},e.prototype.handleFocus=function(){var t=this;requestAnimationFrame((function(){return t.adapter_.addClass(e.cssClasses.BG_FOCUSED)}))},e.prototype.handleBlur=function(){var t=this;requestAnimationFrame((function(){return t.adapter_.removeClass(e.cssClasses.BG_FOCUSED)}))},e.prototype.supportsPressRipple_=function(){return this.adapter_.browserSupportsCssVars()},e.prototype.defaultActivationState_=function(){return{activationEvent:void 0,hasDeactivationUXRun:!1,isActivated:!1,isProgrammatic:!1,wasActivatedByPointer:!1,wasElementMadeActive:!1}},e.prototype.registerRootHandlers_=function(t){var e=this;t&&(Yc.forEach((function(t){e.adapter_.registerInteractionHandler(t,e.activateHandler_)})),this.adapter_.isUnbounded()&&this.adapter_.registerResizeHandler(this.resizeHandler_)),this.adapter_.registerInteractionHandler("focus",this.focusHandler_),this.adapter_.registerInteractionHandler("blur",this.blurHandler_)},e.prototype.registerDeactivationHandlers_=function(t){var e=this;"keydown"===t.type?this.adapter_.registerInteractionHandler("keyup",this.deactivateHandler_):Kc.forEach((function(t){e.adapter_.registerDocumentInteractionHandler(t,e.deactivateHandler_)}))},e.prototype.deregisterRootHandlers_=function(){var t=this;Yc.forEach((function(e){t.adapter_.deregisterInteractionHandler(e,t.activateHandler_)})),this.adapter_.deregisterInteractionHandler("focus",this.focusHandler_),this.adapter_.deregisterInteractionHandler("blur",this.blurHandler_),this.adapter_.isUnbounded()&&this.adapter_.deregisterResizeHandler(this.resizeHandler_)},e.prototype.deregisterDeactivationHandlers_=function(){var t=this;this.adapter_.deregisterInteractionHandler("keyup",this.deactivateHandler_),Kc.forEach((function(e){t.adapter_.deregisterDocumentInteractionHandler(e,t.deactivateHandler_)}))},e.prototype.removeCssVars_=function(){var t=this,n=e.strings;Object.keys(n).forEach((function(e){0===e.indexOf("VAR_")&&t.adapter_.updateCssVariable(n[e],null)}))},e.prototype.activate_=function(t){var e=this;if(!this.adapter_.isSurfaceDisabled()){var n=this.activationState_;if(!n.isActivated){var i=this.previousActivationEvent_;if(!(i&&void 0!==t&&i.type!==t.type))n.isActivated=!0,n.isProgrammatic=void 0===t,n.activationEvent=t,n.wasActivatedByPointer=!n.isProgrammatic&&(void 0!==t&&("mousedown"===t.type||"touchstart"===t.type||"pointerdown"===t.type)),void 0!==t&&$c.length>0&&$c.some((function(t){return e.adapter_.containsEventTarget(t)}))?this.resetActivationState_():(void 0!==t&&($c.push(t.target),this.registerDeactivationHandlers_(t)),n.wasElementMadeActive=this.checkElementMadeActive_(t),n.wasElementMadeActive&&this.animateActivation_(),requestAnimationFrame((function(){$c=[],n.wasElementMadeActive||void 0===t||" "!==t.key&&32!==t.keyCode||(n.wasElementMadeActive=e.checkElementMadeActive_(t),n.wasElementMadeActive&&e.animateActivation_()),n.wasElementMadeActive||(e.activationState_=e.defaultActivationState_())})))}}},e.prototype.checkElementMadeActive_=function(t){return void 0===t||"keydown"!==t.type||this.adapter_.isSurfaceActive()},e.prototype.animateActivation_=function(){var t=this,n=e.strings,i=n.VAR_FG_TRANSLATE_START,o=n.VAR_FG_TRANSLATE_END,r=e.cssClasses,s=r.FG_DEACTIVATION,a=r.FG_ACTIVATION,l=e.numbers.DEACTIVATION_TIMEOUT_MS;this.layoutInternal_();var c="",d="";if(!this.adapter_.isUnbounded()){var u=this.getFgTranslationCoordinates_(),h=u.startPoint,p=u.endPoint;c=h.x+"px, "+h.y+"px",d=p.x+"px, "+p.y+"px"}this.adapter_.updateCssVariable(i,c),this.adapter_.updateCssVariable(o,d),clearTimeout(this.activationTimer_),clearTimeout(this.fgDeactivationRemovalTimer_),this.rmBoundedActivationClasses_(),this.adapter_.removeClass(s),this.adapter_.computeBoundingRect(),this.adapter_.addClass(a),this.activationTimer_=setTimeout((function(){return t.activationTimerCallback_()}),l)},e.prototype.getFgTranslationCoordinates_=function(){var t,e=this.activationState_,n=e.activationEvent;return{startPoint:t={x:(t=e.wasActivatedByPointer?function(t,e,n){if(!t)return{x:0,y:0};var i,o,r=e.x,s=e.y,a=r+n.left,l=s+n.top;if("touchstart"===t.type){var c=t;i=c.changedTouches[0].pageX-a,o=c.changedTouches[0].pageY-l}else{var d=t;i=d.pageX-a,o=d.pageY-l}return{x:i,y:o}}(n,this.adapter_.getWindowPageOffset(),this.adapter_.computeBoundingRect()):{x:this.frame_.width/2,y:this.frame_.height/2}).x-this.initialSize_/2,y:t.y-this.initialSize_/2},endPoint:{x:this.frame_.width/2-this.initialSize_/2,y:this.frame_.height/2-this.initialSize_/2}}},e.prototype.runDeactivationUXLogicIfReady_=function(){var t=this,n=e.cssClasses.FG_DEACTIVATION,i=this.activationState_,o=i.hasDeactivationUXRun,r=i.isActivated;(o||!r)&&this.activationAnimationHasEnded_&&(this.rmBoundedActivationClasses_(),this.adapter_.addClass(n),this.fgDeactivationRemovalTimer_=setTimeout((function(){t.adapter_.removeClass(n)}),Xc.FG_DEACTIVATION_MS))},e.prototype.rmBoundedActivationClasses_=function(){var t=e.cssClasses.FG_ACTIVATION;this.adapter_.removeClass(t),this.activationAnimationHasEnded_=!1,this.adapter_.computeBoundingRect()},e.prototype.resetActivationState_=function(){var t=this;this.previousActivationEvent_=this.activationState_.activationEvent,this.activationState_=this.defaultActivationState_(),setTimeout((function(){return t.previousActivationEvent_=void 0}),e.numbers.TAP_DELAY_MS)},e.prototype.deactivate_=function(){var t=this,e=this.activationState_;if(e.isActivated){var n=Vc({},e);e.isProgrammatic?(requestAnimationFrame((function(){return t.animateDeactivation_(n)})),this.resetActivationState_()):(this.deregisterDeactivationHandlers_(),requestAnimationFrame((function(){t.activationState_.hasDeactivationUXRun=!0,t.animateDeactivation_(n),t.resetActivationState_()})))}},e.prototype.animateDeactivation_=function(t){var e=t.wasActivatedByPointer,n=t.wasElementMadeActive;(e||n)&&this.runDeactivationUXLogicIfReady_()},e.prototype.layoutInternal_=function(){var t=this;this.frame_=this.adapter_.computeBoundingRect();var n=Math.max(this.frame_.height,this.frame_.width);this.maxRadius_=this.adapter_.isUnbounded()?n:Math.sqrt(Math.pow(t.frame_.width,2)+Math.pow(t.frame_.height,2))+e.numbers.PADDING,this.initialSize_=Math.floor(n*e.numbers.INITIAL_ORIGIN_SCALE),this.fgScale_=""+this.maxRadius_/this.initialSize_,this.updateLayoutCssVars_()},e.prototype.updateLayoutCssVars_=function(){var t=e.strings,n=t.VAR_FG_SIZE,i=t.VAR_LEFT,o=t.VAR_TOP,r=t.VAR_FG_SCALE;this.adapter_.updateCssVariable(n,this.initialSize_+"px"),this.adapter_.updateCssVariable(r,this.fgScale_),this.adapter_.isUnbounded()&&(this.unboundedCoords_={left:Math.round(this.frame_.width/2-this.initialSize_/2),top:Math.round(this.frame_.height/2-this.initialSize_/2)},this.adapter_.updateCssVariable(i,this.unboundedCoords_.left+"px"),this.adapter_.updateCssVariable(o,this.unboundedCoords_.top+"px"))},e}(Gc);const qc=st(Ac||(Ac=Pc`@keyframes mdc-ripple-fg-radius-in{from{animation-timing-function:cubic-bezier(.4,0,.2,1);transform:translate(var(--mdc-ripple-fg-translate-start,0)) scale(1)}to{transform:translate(var(--mdc-ripple-fg-translate-end,0)) scale(var(--mdc-ripple-fg-scale,1))}}@keyframes mdc-ripple-fg-opacity-in{from{animation-timing-function:linear;opacity:0}to{opacity:var(--mdc-ripple-fg-opacity,0)}}@keyframes mdc-ripple-fg-opacity-out{from{animation-timing-function:linear;opacity:var(--mdc-ripple-fg-opacity,0)}to{opacity:0}}`)),Zc=function(t,e){void 0===e&&(e=!1);var n=t.CSS,i=Hc;if("boolean"==typeof Hc&&!e)return Hc;if(!(n&&"function"==typeof n.supports))return!1;var o=n.supports("--css-vars","yes"),r=n.supports("(--css-vars: yes)")&&n.supports("color","#00000000");return i=!(!o&&!r)&&!function(t){var e=t.document,n=e.createElement("div");n.className="mdc-ripple-surface--test-edge-var-bug",e.body.appendChild(n);var i=t.getComputedStyle(n),o=null!==i&&"solid"===i.borderTopStyle;return n.parentNode&&n.parentNode.removeChild(n),o}(t),e||(Hc=i),i}(window),Qc=navigator.userAgent.match(/Safari/);let td=!1;const ed=t=>{Qc&&!td&&(()=>{td=!0;const t=new I({templateFactory:L});t.appendInto(document.head),t.setValue(qc),t.commit()})();const e=t.surfaceNode,n=t.interactionNode||e;n.getRootNode()!==e.getRootNode()&&""===n.style.position&&(n.style.position="relative");const i=Object.assign({browserSupportsCssVars:()=>Zc,isUnbounded:()=>void 0===t.unbounded||t.unbounded,isSurfaceActive:()=>Mc(n,":active"),isSurfaceDisabled:()=>Boolean(t.disabled),addClass:t=>e.classList.add(t),removeClass:t=>e.classList.remove(t),containsEventTarget:t=>n.contains(t),registerInteractionHandler:(t,e)=>n.addEventListener(t,e,jc()),deregisterInteractionHandler:(t,e)=>n.removeEventListener(t,e,jc()),registerDocumentInteractionHandler:(t,e)=>document.documentElement.addEventListener(t,e,jc()),deregisterDocumentInteractionHandler:(t,e)=>document.documentElement.removeEventListener(t,e,jc()),registerResizeHandler:t=>window.addEventListener("resize",t),deregisterResizeHandler:t=>window.removeEventListener("resize",t),updateCssVariable:(t,n)=>e.style.setProperty(t,n),computeBoundingRect:()=>e.getBoundingClientRect(),getWindowPageOffset:()=>({x:window.pageXOffset,y:window.pageYOffset})},t.adapter),o=new Jc(i);return o.init(),o},nd=new WeakMap,id=f(((t={})=>e=>{const n=e.committer.element,i=t.interactionNode||n;let o=e.value;const r=nd.get(o);void 0!==r&&r!==i&&(o.destroy(),o=_),o===_?(o=ed(Object.assign({},t,{surfaceNode:n})),nd.set(o,i),e.setValue(o)):(void 0!==t.unbounded&&o.setUnbounded(t.unbounded),void 0!==t.disabled&&o.setUnbounded(t.disabled)),!0===t.active?o.activate():!1===t.active&&o.deactivate()})),od=st(Dc||(Dc=Pc`.mdc-card{border-radius:4px;background-color:#fff;background-color:var(--mdc-theme-surface,#fff);box-shadow:0 2px 1px -1px rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 1px 3px 0 rgba(0,0,0,.12);display:flex;flex-direction:column;box-sizing:border-box}.mdc-card--outlined{box-shadow:0 0 0 0 rgba(0,0,0,.2),0 0 0 0 rgba(0,0,0,.14),0 0 0 0 rgba(0,0,0,.12);border-width:1px;border-style:solid;border-color:#e0e0e0}.mdc-card__media{position:relative;box-sizing:border-box;background-repeat:no-repeat;background-position:center;background-size:cover}.mdc-card__media::before{display:block;content:""}.mdc-card__media:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__media:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mdc-card__media--square::before{margin-top:100%}.mdc-card__media--16-9::before{margin-top:56.25%}.mdc-card__media-content{position:absolute;top:0;right:0;bottom:0;left:0;box-sizing:border-box}.mdc-card__primary-action{display:flex;flex-direction:column;box-sizing:border-box;position:relative;outline:0;color:inherit;text-decoration:none;cursor:pointer;overflow:hidden}.mdc-card__primary-action:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__primary-action:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mdc-card__actions{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;min-height:52px;padding:8px}.mdc-card__actions--full-bleed{padding:0}.mdc-card__action-buttons,.mdc-card__action-icons{display:flex;flex-direction:row;align-items:center;box-sizing:border-box}.mdc-card__action-icons{color:rgba(0,0,0,.6);flex-grow:1;justify-content:flex-end}.mdc-card__action-buttons+.mdc-card__action-icons{margin-left:16px;margin-right:0}.mdc-card__action-buttons+.mdc-card__action-icons[dir=rtl],[dir=rtl] .mdc-card__action-buttons+.mdc-card__action-icons{margin-left:0;margin-right:16px}.mdc-card__action{display:inline-flex;flex-direction:row;align-items:center;box-sizing:border-box;justify-content:center;cursor:pointer;user-select:none}.mdc-card__action:focus{outline:0}.mdc-card__action--button{margin-left:0;margin-right:8px;padding:0 8px}.mdc-card__action--button[dir=rtl],[dir=rtl] .mdc-card__action--button{margin-left:8px;margin-right:0}.mdc-card__action--button:last-child{margin-left:0;margin-right:0}.mdc-card__action--button:last-child[dir=rtl],[dir=rtl] .mdc-card__action--button:last-child{margin-left:0;margin-right:0}.mdc-card__actions--full-bleed .mdc-card__action--button{justify-content:space-between;width:100%;height:auto;max-height:none;margin:0;padding:8px 16px;text-align:left}.mdc-card__actions--full-bleed .mdc-card__action--button[dir=rtl],[dir=rtl] .mdc-card__actions--full-bleed .mdc-card__action--button{text-align:right}.mdc-card__action--icon{margin:-6px 0;padding:12px}.mdc-card__action--icon:not(:disabled){color:rgba(0,0,0,.6)}@keyframes mdc-ripple-fg-radius-in{from{animation-timing-function:cubic-bezier(.4,0,.2,1);transform:translate(var(--mdc-ripple-fg-translate-start,0)) scale(1)}to{transform:translate(var(--mdc-ripple-fg-translate-end,0)) scale(var(--mdc-ripple-fg-scale,1))}}@keyframes mdc-ripple-fg-opacity-in{from{animation-timing-function:linear;opacity:0}to{opacity:var(--mdc-ripple-fg-opacity,0)}}@keyframes mdc-ripple-fg-opacity-out{from{animation-timing-function:linear;opacity:var(--mdc-ripple-fg-opacity,0)}to{opacity:0}}.mdc-ripple-surface--test-edge-var-bug{--mdc-ripple-surface-test-edge-var:1px solid #000;visibility:hidden}.mdc-ripple-surface--test-edge-var-bug::before{border:var(--mdc-ripple-surface-test-edge-var)}.mdc-card__primary-action{--mdc-ripple-fg-size:0;--mdc-ripple-left:0;--mdc-ripple-top:0;--mdc-ripple-fg-scale:1;--mdc-ripple-fg-translate-end:0;--mdc-ripple-fg-translate-start:0;-webkit-tap-highlight-color:transparent}.mdc-card__primary-action::after,.mdc-card__primary-action::before{position:absolute;border-radius:50%;opacity:0;pointer-events:none;content:""}.mdc-card__primary-action::before{transition:opacity 15ms linear,background-color 15ms linear;z-index:1}.mdc-card__primary-action.mdc-ripple-upgraded::before{transform:scale(var(--mdc-ripple-fg-scale,1))}.mdc-card__primary-action.mdc-ripple-upgraded::after{top:0;left:0;transform:scale(0);transform-origin:center center}.mdc-card__primary-action.mdc-ripple-upgraded--unbounded::after{top:var(--mdc-ripple-top,0);left:var(--mdc-ripple-left,0)}.mdc-card__primary-action.mdc-ripple-upgraded--foreground-activation::after{animation:mdc-ripple-fg-radius-in 225ms forwards,mdc-ripple-fg-opacity-in 75ms forwards}.mdc-card__primary-action.mdc-ripple-upgraded--foreground-deactivation::after{animation:mdc-ripple-fg-opacity-out 150ms;transform:translate(var(--mdc-ripple-fg-translate-end,0)) scale(var(--mdc-ripple-fg-scale,1))}.mdc-card__primary-action::after,.mdc-card__primary-action::before{top:calc(50% - 100%);left:calc(50% - 100%);width:200%;height:200%}.mdc-card__primary-action.mdc-ripple-upgraded::after{width:var(--mdc-ripple-fg-size,100%);height:var(--mdc-ripple-fg-size,100%)}.mdc-card__primary-action::after,.mdc-card__primary-action::before{background-color:#000}.mdc-card__primary-action:hover::before{opacity:.04}.mdc-card__primary-action.mdc-ripple-upgraded--background-focused::before,.mdc-card__primary-action:not(.mdc-ripple-upgraded):focus::before{transition-duration:75ms;opacity:.12}.mdc-card__primary-action:not(.mdc-ripple-upgraded)::after{transition:opacity 150ms linear}.mdc-card__primary-action:not(.mdc-ripple-upgraded):active::after{transition-duration:75ms;opacity:.12}.mdc-card__primary-action.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:0.12}:host{display:inline-block;width:344px}.mdc-card{height:100%}.mdc-card__primary-action{flex-grow:1}.mdc-card__primary-action--empty{display:none}.mdc-card__actions--empty{display:none}.mdc-card__actions ::slotted(*){display:inline-flex;flex-direction:row;align-items:center;box-sizing:border-box;justify-content:center;cursor:pointer;user-select:none}.mdc-card__actions ::slotted(*):focus{outline:0}.mdc-card__actions ::slotted(mwc-button){margin-left:0;margin-right:8px}.mdc-card__actions ::slotted(mwc-button)[dir=rtl],[dir=rtl] .mdc-card__actions ::slotted(mwc-button){margin-left:8px;margin-right:0}.mdc-card__actions ::slotted(mwc-button):last-child{margin-left:0;margin-right:0}.mdc-card__actions ::slotted(mwc-button):last-child[dir=rtl],[dir=rtl] .mdc-card__actions ::slotted(mwc-button):last-child{margin-left:0;margin-right:0}.mdc-card__actions ::slotted(mwc-icon-button){margin:-6px 0}.mdc-card__actions ::slotted(mwc-icon-button:not(:disabled)){color:rgba(0,0,0,.6)}`)),rd=document.createElement("link");rd.rel="stylesheet",rd.href="https://fonts.googleapis.com/icon?family=Material+Icons",document.head.appendChild(rd);var sd=function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s};let ad=class extends lt{constructor(){super(...arguments),this.outlined=!1,this.aspectRatio=""}get headerEls(){return this.slotHeaderEl&&Bc(this.slotHeaderEl,"*")}get mediaEls(){return this.slotMediaEl&&Bc(this.slotMediaEl,"*")}get contentEls(){return this.slotContentEl&&Bc(this.slotContentEl,"*")}get actionButtons(){return this.slotActionButtonsEl&&Bc(this.slotActionButtonsEl,"mwc-button")}get actionIcons(){return this.slotActionIconsEl&&Bc(this.slotActionIconsEl,"mwc-icon-button")}render(){const t={"mdc-card":!0,"mdc-card--outlined":this.outlined},e={"mdc-card__media":!0,[`mdc-card__media--${this.aspectRatio}`]:""!==this.aspectRatio};return F(Nc||(Nc=Pc` <div class="${0}"> <div class="mdc-card__primary-action" tabindex="0" .ripple="${0}"> <slot name="header"></slot> <div class="${0}"> <div class="mdc-card__media-content"> <slot name="media"></slot> </div> </div> <slot name="content"></slot> </div> <slot></slot> <div class="mdc-card__actions"> <div class="mdc-card__action-buttons"> <slot name="action-buttons"></slot> </div> <div class="mdc-card__action-icons"> <slot name="action-icons"></slot> </div> </div> </div> `),Nt(t),id({unbounded:!1}),Nt(e))}updated(t){super.updated(t);const e=this.headerEls.length>0,n=this.mediaEls.length>0,i=this.contentEls.length>0,o=e||n||i,r=this.actionButtons.length>0,s=this.actionIcons.length>0,a=r||s;this.primaryActionEl.classList.toggle("mdc-card__primary-action--empty",!o),this.actionButtonsEl.classList.toggle("mdc-card__action-buttons--empty",!r),this.actionIconsEl.classList.toggle("mdc-card__action-icons--empty",!s),this.actionsEl.classList.toggle("mdc-card__actions--empty",!a)}};ad.styles=od,sd([Z(".mdc-card__primary-action")],ad.prototype,"primaryActionEl",void 0),sd([Z(".mdc-card__actions")],ad.prototype,"actionsEl",void 0),sd([Z(".mdc-card__action-buttons")],ad.prototype,"actionButtonsEl",void 0),sd([Z(".mdc-card__action-icons")],ad.prototype,"actionIconsEl",void 0),sd([Z('slot[name="header"]')],ad.prototype,"slotHeaderEl",void 0),sd([Z('slot[name="media"]')],ad.prototype,"slotMediaEl",void 0),sd([Z('slot[name="content"]')],ad.prototype,"slotContentEl",void 0),sd([Z('slot[name="action-buttons"]')],ad.prototype,"slotActionButtonsEl",void 0),sd([Z('slot[name="action-icons"]')],ad.prototype,"slotActionIconsEl",void 0),sd([J({type:Boolean})],ad.prototype,"outlined",void 0),sd([J({type:String})],ad.prototype,"aspectRatio",void 0);class ld extends(Le(ad)){}ld.styles=[od,st(Lc||(Lc=Pc`:host{width:auto}`))];let cd,dd,ud,hd,pd,gd,fd,md,_d,vd,yd,bd=t=>t;class Ed extends lt{constructor(){super(...arguments),this.value="",this.group=null,this.tabindex=-1,this.disabled=!1,this.twoline=!1,this.activated=!1,this.graphic=null,this.multipleGraphics=!1,this.hasMeta=!1,this.noninteractive=!1,this.selected=!1,this.shouldRenderRipple=!1,this._managingList=null,this.boundOnClick=this.onClick.bind(this),this._firstChanged=!0,this._skipPropRequest=!1,this.rippleHandlers=new ae((()=>(this.shouldRenderRipple=!0,this.ripple))),this.listeners=[{target:this,eventNames:["click"],cb:()=>{this.onClick()}},{target:this,eventNames:["mouseenter"],cb:this.rippleHandlers.startHover},{target:this,eventNames:["mouseleave"],cb:this.rippleHandlers.endHover},{target:this,eventNames:["focus"],cb:this.rippleHandlers.startFocus},{target:this,eventNames:["blur"],cb:this.rippleHandlers.endFocus},{target:this,eventNames:["mousedown","touchstart"],cb:t=>{const e=t.type;this.onDown("mousedown"===e?"mouseup":"touchend",t)}}]}get text(){const t=this.textContent;return t?t.trim():""}render(){const t=this.renderText(),e=this.graphic?this.renderGraphic():F(cd||(cd=bd``)),n=this.hasMeta?this.renderMeta():F(dd||(dd=bd``));return F(ud||(ud=bd` ${0} ${0} ${0} ${0}`),this.renderRipple(),e,t,n)}renderRipple(){return this.shouldRenderRipple?F(hd||(hd=bd` <mwc-ripple .activated="${0}"> </mwc-ripple>`),this.activated):this.activated?F(pd||(pd=bd`<div class="fake-activated-ripple"></div>`)):""}renderGraphic(){const t={multi:this.multipleGraphics};return F(gd||(gd=bd` <span class="mdc-list-item__graphic material-icons ${0}"> <slot name="graphic"></slot> </span>`),Nt(t))}renderMeta(){return F(fd||(fd=bd` <span class="mdc-list-item__meta material-icons"> <slot name="meta"></slot> </span>`))}renderText(){const t=this.twoline?this.renderTwoline():this.renderSingleLine();return F(md||(md=bd` <span class="mdc-list-item__text"> ${0} </span>`),t)}renderSingleLine(){return F(_d||(_d=bd`<slot></slot>`))}renderTwoline(){return F(vd||(vd=bd` <span class="mdc-list-item__primary-text"> <slot></slot> </span> <span class="mdc-list-item__secondary-text"> <slot name="secondary"></slot> </span> `))}onClick(){this.fireRequestSelected(!this.selected,"interaction")}onDown(t,e){const n=()=>{window.removeEventListener(t,n),this.rippleHandlers.endPress()};window.addEventListener(t,n),this.rippleHandlers.startPress(e)}fireRequestSelected(t,e){if(this.noninteractive)return;const n=new CustomEvent("request-selected",{bubbles:!0,composed:!0,detail:{source:e,selected:t}});this.dispatchEvent(n)}connectedCallback(){super.connectedCallback(),this.noninteractive||this.setAttribute("mwc-list-item","");for(const t of this.listeners)for(const e of t.eventNames)t.target.addEventListener(e,t.cb,{passive:!0})}disconnectedCallback(){super.disconnectedCallback();for(const t of this.listeners)for(const e of t.eventNames)t.target.removeEventListener(e,t.cb);this._managingList&&(this._managingList.debouncedLayout?this._managingList.debouncedLayout(!0):this._managingList.layout(!0))}firstUpdated(){const t=new Event("list-item-rendered",{bubbles:!0,composed:!0});this.dispatchEvent(t)}}t([Z("slot")],Ed.prototype,"slotElement",void 0),t([Q("mwc-ripple")],Ed.prototype,"ripple",void 0),t([J({type:String})],Ed.prototype,"value",void 0),t([J({type:String,reflect:!0})],Ed.prototype,"group",void 0),t([J({type:Number,reflect:!0})],Ed.prototype,"tabindex",void 0),t([J({type:Boolean,reflect:!0}),vt((function(t){t?this.setAttribute("aria-disabled","true"):this.setAttribute("aria-disabled","false")}))],Ed.prototype,"disabled",void 0),t([J({type:Boolean,reflect:!0})],Ed.prototype,"twoline",void 0),t([J({type:Boolean,reflect:!0})],Ed.prototype,"activated",void 0),t([J({type:String,reflect:!0})],Ed.prototype,"graphic",void 0),t([J({type:Boolean})],Ed.prototype,"multipleGraphics",void 0),t([J({type:Boolean})],Ed.prototype,"hasMeta",void 0),t([J({type:Boolean,reflect:!0}),vt((function(t){t?(this.removeAttribute("aria-checked"),this.removeAttribute("mwc-list-item"),this.selected=!1,this.activated=!1,this.tabIndex=-1):this.setAttribute("mwc-list-item","")}))],Ed.prototype,"noninteractive",void 0),t([J({type:Boolean,reflect:!0}),vt((function(t){const e=this.getAttribute("role"),n="gridcell"===e||"option"===e||"row"===e||"tab"===e;n&&t?this.setAttribute("aria-selected","true"):n&&this.setAttribute("aria-selected","false"),this._firstChanged?this._firstChanged=!1:this._skipPropRequest||this.fireRequestSelected(t,"property")}))],Ed.prototype,"selected",void 0),t([q()],Ed.prototype,"shouldRenderRipple",void 0),t([q()],Ed.prototype,"_managingList",void 0);const Td=st(yd||(yd=bd`:host{cursor:pointer;user-select:none;-webkit-tap-highlight-color:transparent;height:48px;display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;padding:0;padding-left:var(--mdc-list-side-padding,16px);padding-right:var(--mdc-list-side-padding,16px);outline:0;height:48px;color:rgba(0,0,0,.87);color:var(--mdc-theme-text-primary-on-background,rgba(0,0,0,.87))}:host:focus{outline:0}:host([activated]){color:#6200ee;color:var(--mdc-theme-primary,#6200ee);--mdc-ripple-color:var(--mdc-theme-primary, #6200ee)}:host([activated]) .mdc-list-item__graphic{color:#6200ee;color:var(--mdc-theme-primary,#6200ee)}:host([activated]) .fake-activated-ripple::before{position:absolute;display:block;top:0;bottom:0;left:0;right:0;width:100%;height:100%;pointer-events:none;z-index:1;content:"";opacity:.12;opacity:var(--mdc-ripple-activated-opacity,.12);background-color:#6200ee;background-color:var(--mdc-ripple-color,var(--mdc-theme-primary,#6200ee))}.mdc-list-item__graphic{flex-shrink:0;align-items:center;justify-content:center;fill:currentColor;display:inline-flex}.mdc-list-item__graphic ::slotted(*){flex-shrink:0;align-items:center;justify-content:center;fill:currentColor;width:100%;height:100%;text-align:center}.mdc-list-item__meta{width:var(--mdc-list-item-meta-size,24px);height:var(--mdc-list-item-meta-size,24px);margin-left:auto;margin-right:0;color:rgba(0,0,0,.38);color:var(--mdc-theme-text-hint-on-background,rgba(0,0,0,.38))}.mdc-list-item__meta.multi{width:auto}.mdc-list-item__meta ::slotted(*){width:var(--mdc-list-item-meta-size,24px);line-height:var(--mdc-list-item-meta-size,24px)}.mdc-list-item__meta ::slotted(.material-icons),.mdc-list-item__meta ::slotted(mwc-icon){line-height:var(--mdc-list-item-meta-size,24px)!important}.mdc-list-item__meta ::slotted(:not(.material-icons):not(mwc-icon)){-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto,sans-serif;font-family:var(--mdc-typography-caption-font-family,var(--mdc-typography-font-family,Roboto,sans-serif));font-size:.75rem;font-size:var(--mdc-typography-caption-font-size,.75rem);line-height:1.25rem;line-height:var(--mdc-typography-caption-line-height,1.25rem);font-weight:400;font-weight:var(--mdc-typography-caption-font-weight,400);letter-spacing:.0333333333em;letter-spacing:var(--mdc-typography-caption-letter-spacing,.0333333333em);text-decoration:inherit;text-decoration:var(--mdc-typography-caption-text-decoration,inherit);text-transform:inherit;text-transform:var(--mdc-typography-caption-text-transform,inherit)}:host[dir=rtl] .mdc-list-item__meta,[dir=rtl] :host .mdc-list-item__meta{margin-left:0;margin-right:auto}.mdc-list-item__meta ::slotted(*){width:100%;height:100%}.mdc-list-item__text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.mdc-list-item__text ::slotted([for]),.mdc-list-item__text[for]{pointer-events:none}.mdc-list-item__primary-text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block;margin-top:0;line-height:normal;margin-bottom:-20px;display:block}.mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item__secondary-text{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto,sans-serif;font-family:var(--mdc-typography-body2-font-family,var(--mdc-typography-font-family,Roboto,sans-serif));font-size:.875rem;font-size:var(--mdc-typography-body2-font-size,.875rem);line-height:1.25rem;line-height:var(--mdc-typography-body2-line-height,1.25rem);font-weight:400;font-weight:var(--mdc-typography-body2-font-weight,400);letter-spacing:.0178571429em;letter-spacing:var(--mdc-typography-body2-letter-spacing,.0178571429em);text-decoration:inherit;text-decoration:var(--mdc-typography-body2-text-decoration,inherit);text-transform:inherit;text-transform:var(--mdc-typography-body2-text-transform,inherit);text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block;margin-top:0;line-height:normal;display:block}.mdc-list-item__secondary-text::before{display:inline-block;width:0;height:20px;content:"";vertical-align:0}.mdc-list--dense .mdc-list-item__secondary-text{font-size:inherit}* ::slotted(a),a{color:inherit;text-decoration:none}:host([twoline]){height:72px}:host([twoline]) .mdc-list-item__text{align-self:flex-start}:host([disabled]),:host([noninteractive]){cursor:default;pointer-events:none}:host([disabled]) .mdc-list-item__text ::slotted(*){opacity:.38}:host([disabled]) .mdc-list-item__primary-text ::slotted(*),:host([disabled]) .mdc-list-item__secondary-text ::slotted(*),:host([disabled]) .mdc-list-item__text ::slotted(*){color:#000;color:var(--mdc-theme-on-surface,#000)}.mdc-list-item__secondary-text ::slotted(*){color:rgba(0,0,0,.54);color:var(--mdc-theme-text-secondary-on-background,rgba(0,0,0,.54))}.mdc-list-item__graphic ::slotted(*){background-color:transparent;color:rgba(0,0,0,.38);color:var(--mdc-theme-text-icon-on-background,rgba(0,0,0,.38))}.mdc-list-group__subheader ::slotted(*){color:rgba(0,0,0,.87);color:var(--mdc-theme-text-primary-on-background,rgba(0,0,0,.87))}:host([graphic=avatar]) .mdc-list-item__graphic{width:var(--mdc-list-item-graphic-size,40px);height:var(--mdc-list-item-graphic-size,40px)}:host([graphic=avatar]) .mdc-list-item__graphic.multi{width:auto}:host([graphic=avatar]) .mdc-list-item__graphic ::slotted(*){width:var(--mdc-list-item-graphic-size,40px);line-height:var(--mdc-list-item-graphic-size,40px)}:host([graphic=avatar]) .mdc-list-item__graphic ::slotted(.material-icons),:host([graphic=avatar]) .mdc-list-item__graphic ::slotted(mwc-icon){line-height:var(--mdc-list-item-graphic-size,40px)!important}:host([graphic=avatar]) .mdc-list-item__graphic ::slotted(*){border-radius:50%}:host([graphic=avatar],[graphic=medium],[graphic=large],[graphic=control]) .mdc-list-item__graphic{margin-left:0;margin-right:var(--mdc-list-item-graphic-margin,16px)}:host[dir=rtl] :host([graphic=avatar],[graphic=medium],[graphic=large],[graphic=control]) .mdc-list-item__graphic,[dir=rtl] :host :host([graphic=avatar],[graphic=medium],[graphic=large],[graphic=control]) .mdc-list-item__graphic{margin-left:var(--mdc-list-item-graphic-margin,16px);margin-right:0}:host([graphic=icon]) .mdc-list-item__graphic{width:var(--mdc-list-item-graphic-size,24px);height:var(--mdc-list-item-graphic-size,24px);margin-left:0;margin-right:var(--mdc-list-item-graphic-margin,32px)}:host([graphic=icon]) .mdc-list-item__graphic.multi{width:auto}:host([graphic=icon]) .mdc-list-item__graphic ::slotted(*){width:var(--mdc-list-item-graphic-size,24px);line-height:var(--mdc-list-item-graphic-size,24px)}:host([graphic=icon]) .mdc-list-item__graphic ::slotted(.material-icons),:host([graphic=icon]) .mdc-list-item__graphic ::slotted(mwc-icon){line-height:var(--mdc-list-item-graphic-size,24px)!important}:host[dir=rtl] :host([graphic=icon]) .mdc-list-item__graphic,[dir=rtl] :host :host([graphic=icon]) .mdc-list-item__graphic{margin-left:var(--mdc-list-item-graphic-margin,32px);margin-right:0}:host([graphic=avatar]:not([twoLine])),:host([graphic=icon]:not([twoLine])){height:56px}:host([graphic=large]:not([twoLine])),:host([graphic=medium]:not([twoLine])){height:72px}:host([graphic=large]) .mdc-list-item__graphic,:host([graphic=medium]) .mdc-list-item__graphic{width:var(--mdc-list-item-graphic-size,56px);height:var(--mdc-list-item-graphic-size,56px)}:host([graphic=large]) .mdc-list-item__graphic.multi,:host([graphic=medium]) .mdc-list-item__graphic.multi{width:auto}:host([graphic=large]) .mdc-list-item__graphic ::slotted(*),:host([graphic=medium]) .mdc-list-item__graphic ::slotted(*){width:var(--mdc-list-item-graphic-size,56px);line-height:var(--mdc-list-item-graphic-size,56px)}:host([graphic=large]) .mdc-list-item__graphic ::slotted(.material-icons),:host([graphic=large]) .mdc-list-item__graphic ::slotted(mwc-icon),:host([graphic=medium]) .mdc-list-item__graphic ::slotted(.material-icons),:host([graphic=medium]) .mdc-list-item__graphic ::slotted(mwc-icon){line-height:var(--mdc-list-item-graphic-size,56px)!important}:host([graphic=large]){padding-left:0}`));class Rd extends(Le(Ed)){static get scopedElements(){return{"mwc-ripple":$e}}}Rd.styles=Td;var Cd="Unknown",xd="Backspace",Sd="Enter",Id="Spacebar",Od="PageUp",kd="PageDown",wd="End",Ad="Home",Dd="ArrowLeft",Nd="ArrowUp",Ld="ArrowRight",Pd="ArrowDown",Md="Delete",Bd="Escape",Fd=new Set;Fd.add(xd),Fd.add(Sd),Fd.add(Id),Fd.add(Od),Fd.add(kd),Fd.add(wd),Fd.add(Ad),Fd.add(Dd),Fd.add(Nd),Fd.add(Ld),Fd.add(Pd),Fd.add(Md),Fd.add(Bd);var Hd=8,Ud=13,Vd=32,Gd=33,Wd=34,zd=35,Xd=36,jd=37,Yd=38,Kd=39,$d=40,Jd=46,qd=27,Zd=new Map;Zd.set(Hd,xd),Zd.set(Ud,Sd),Zd.set(Vd,Id),Zd.set(Gd,Od),Zd.set(Wd,kd),Zd.set(zd,wd),Zd.set(Xd,Ad),Zd.set(jd,Dd),Zd.set(Yd,Nd),Zd.set(Kd,Ld),Zd.set($d,Pd),Zd.set(Jd,Md),Zd.set(qd,Bd);var Qd=new Set;function tu(t){var e=t.key;if(Fd.has(e))return e;var n=Zd.get(t.keyCode);return n||Cd}Qd.add(Od),Qd.add(kd),Qd.add(wd),Qd.add(Ad),Qd.add(Dd),Qd.add(Nd),Qd.add(Ld),Qd.add(Pd);var eu="mdc-list-item",nu="mdc-list-item--disabled",iu={ACTION_EVENT:"MDCList:action",ARIA_CHECKED:"aria-checked",ARIA_CHECKED_CHECKBOX_SELECTOR:'[role="checkbox"][aria-checked="true"]',ARIA_CHECKED_RADIO_SELECTOR:'[role="radio"][aria-checked="true"]',ARIA_CURRENT:"aria-current",ARIA_DISABLED:"aria-disabled",ARIA_ORIENTATION:"aria-orientation",ARIA_ORIENTATION_HORIZONTAL:"horizontal",ARIA_ROLE_CHECKBOX_SELECTOR:'[role="checkbox"]',ARIA_SELECTED:"aria-selected",CHECKBOX_RADIO_SELECTOR:'input[type="checkbox"], input[type="radio"]',CHECKBOX_SELECTOR:'input[type="checkbox"]',CHILD_ELEMENTS_TO_TOGGLE_TABINDEX:"\n    ."+eu+" button:not(:disabled),\n    ."+eu+" a\n  ",FOCUSABLE_CHILD_ELEMENTS:"\n    ."+eu+" button:not(:disabled),\n    ."+eu+" a,\n    ."+eu+' input[type="radio"]:not(:disabled),\n    .'+eu+' input[type="checkbox"]:not(:disabled)\n  ',RADIO_SELECTOR:'input[type="radio"]'},ou={UNSET_INDEX:-1,TYPEAHEAD_BUFFER_CLEAR_TIMEOUT_MS:300};let ru,su,au,lu=t=>t;const cu=["input","button","textarea","select"];function du(t){return t instanceof Set}const uu=t=>{const e=t===ou.UNSET_INDEX?new Set:t;return du(e)?new Set(e):new Set([e])};class hu extends Et{constructor(t){super(Object.assign(Object.assign({},hu.defaultAdapter),t)),this.isMulti_=!1,this.wrapFocus_=!1,this.isVertical_=!0,this.selectedIndex_=ou.UNSET_INDEX,this.focusedItemIndex_=ou.UNSET_INDEX,this.useActivatedClass_=!1,this.ariaCurrentAttrValue_=null}static get strings(){return iu}static get numbers(){return ou}static get defaultAdapter(){return{focusItemAtIndex:()=>{},getFocusedElementIndex:()=>0,getListItemCount:()=>0,isFocusInsideList:()=>!1,isRootFocused:()=>!1,notifyAction:()=>{},notifySelected:()=>{},getSelectedStateForElementIndex:()=>!1,setDisabledStateForElementIndex:()=>{},getDisabledStateForElementIndex:()=>!1,setSelectedStateForElementIndex:()=>{},setActivatedStateForElementIndex:()=>{},setTabIndexForElementIndex:()=>{},setAttributeForElementIndex:()=>{},getAttributeForElementIndex:()=>null}}setWrapFocus(t){this.wrapFocus_=t}setMulti(t){this.isMulti_=t;const e=this.selectedIndex_;if(t){if(!du(e)){const t=e===ou.UNSET_INDEX;this.selectedIndex_=t?new Set:new Set([e])}}else if(du(e))if(e.size){const t=Array.from(e).sort();this.selectedIndex_=t[0]}else this.selectedIndex_=ou.UNSET_INDEX}setVerticalOrientation(t){this.isVertical_=t}setUseActivatedClass(t){this.useActivatedClass_=t}getSelectedIndex(){return this.selectedIndex_}setSelectedIndex(t){this.isIndexValid_(t)&&(this.isMulti_?this.setMultiSelectionAtIndex_(uu(t)):this.setSingleSelectionAtIndex_(t))}handleFocusIn(t,e){e>=0&&this.adapter.setTabIndexForElementIndex(e,0)}handleFocusOut(t,e){e>=0&&this.adapter.setTabIndexForElementIndex(e,-1),setTimeout((()=>{this.adapter.isFocusInsideList()||this.setTabindexToFirstSelectedItem_()}),0)}handleKeydown(t,e,n){const i="ArrowLeft"===tu(t),o="ArrowUp"===tu(t),r="ArrowRight"===tu(t),s="ArrowDown"===tu(t),a="Home"===tu(t),l="End"===tu(t),c="Enter"===tu(t),d="Spacebar"===tu(t);if(this.adapter.isRootFocused())return void(o||l?(t.preventDefault(),this.focusLastElement()):(s||a)&&(t.preventDefault(),this.focusFirstElement()));let u,h=this.adapter.getFocusedElementIndex();if(!(-1===h&&(h=n,h<0))){if(this.isVertical_&&s||!this.isVertical_&&r)this.preventDefaultEvent(t),u=this.focusNextElement(h);else if(this.isVertical_&&o||!this.isVertical_&&i)this.preventDefaultEvent(t),u=this.focusPrevElement(h);else if(a)this.preventDefaultEvent(t),u=this.focusFirstElement();else if(l)this.preventDefaultEvent(t),u=this.focusLastElement();else if((c||d)&&e){const e=t.target;if(e&&"A"===e.tagName&&c)return;this.preventDefaultEvent(t),this.setSelectedIndexOnAction_(h,!0)}this.focusedItemIndex_=h,void 0!==u&&(this.setTabindexAtIndex_(u),this.focusedItemIndex_=u)}}handleSingleSelection(t,e,n){t!==ou.UNSET_INDEX&&(this.setSelectedIndexOnAction_(t,e,n),this.setTabindexAtIndex_(t),this.focusedItemIndex_=t)}focusNextElement(t){let e=t+1;if(e>=this.adapter.getListItemCount()){if(!this.wrapFocus_)return t;e=0}return this.adapter.focusItemAtIndex(e),e}focusPrevElement(t){let e=t-1;if(e<0){if(!this.wrapFocus_)return t;e=this.adapter.getListItemCount()-1}return this.adapter.focusItemAtIndex(e),e}focusFirstElement(){return this.adapter.focusItemAtIndex(0),0}focusLastElement(){const t=this.adapter.getListItemCount()-1;return this.adapter.focusItemAtIndex(t),t}setEnabled(t,e){this.isIndexValid_(t)&&this.adapter.setDisabledStateForElementIndex(t,!e)}preventDefaultEvent(t){const e=`${t.target.tagName}`.toLowerCase();-1===cu.indexOf(e)&&t.preventDefault()}setSingleSelectionAtIndex_(t,e=!0){this.selectedIndex_!==t&&(this.selectedIndex_!==ou.UNSET_INDEX&&(this.adapter.setSelectedStateForElementIndex(this.selectedIndex_,!1),this.useActivatedClass_&&this.adapter.setActivatedStateForElementIndex(this.selectedIndex_,!1)),e&&this.adapter.setSelectedStateForElementIndex(t,!0),this.useActivatedClass_&&this.adapter.setActivatedStateForElementIndex(t,!0),this.setAriaForSingleSelectionAtIndex_(t),this.selectedIndex_=t,this.adapter.notifySelected(t))}setMultiSelectionAtIndex_(t,e=!0){const n=((t,e)=>{const n=Array.from(t),i=Array.from(e),o={added:[],removed:[]},r=n.sort(),s=i.sort();let a=0,l=0;for(;a<r.length||l<s.length;){const t=r[a],e=s[l];t!==e?void 0!==t&&(void 0===e||t<e)?(o.removed.push(t),a++):void 0!==e&&(void 0===t||e<t)&&(o.added.push(e),l++):(a++,l++)}return o})(uu(this.selectedIndex_),t);if(n.removed.length||n.added.length){for(const t of n.removed)e&&this.adapter.setSelectedStateForElementIndex(t,!1),this.useActivatedClass_&&this.adapter.setActivatedStateForElementIndex(t,!1);for(const t of n.added)e&&this.adapter.setSelectedStateForElementIndex(t,!0),this.useActivatedClass_&&this.adapter.setActivatedStateForElementIndex(t,!0);this.selectedIndex_=t,this.adapter.notifySelected(t,n)}}setAriaForSingleSelectionAtIndex_(t){this.selectedIndex_===ou.UNSET_INDEX&&(this.ariaCurrentAttrValue_=this.adapter.getAttributeForElementIndex(t,iu.ARIA_CURRENT));const e=null!==this.ariaCurrentAttrValue_,n=e?iu.ARIA_CURRENT:iu.ARIA_SELECTED;this.selectedIndex_!==ou.UNSET_INDEX&&this.adapter.setAttributeForElementIndex(this.selectedIndex_,n,"false");const i=e?this.ariaCurrentAttrValue_:"true";this.adapter.setAttributeForElementIndex(t,n,i)}setTabindexAtIndex_(t){this.focusedItemIndex_===ou.UNSET_INDEX&&0!==t?this.adapter.setTabIndexForElementIndex(0,-1):this.focusedItemIndex_>=0&&this.focusedItemIndex_!==t&&this.adapter.setTabIndexForElementIndex(this.focusedItemIndex_,-1),this.adapter.setTabIndexForElementIndex(t,0)}setTabindexToFirstSelectedItem_(){let t=0;"number"==typeof this.selectedIndex_&&this.selectedIndex_!==ou.UNSET_INDEX?t=this.selectedIndex_:du(this.selectedIndex_)&&this.selectedIndex_.size>0&&(t=Math.min(...this.selectedIndex_)),this.setTabindexAtIndex_(t)}isIndexValid_(t){if(t instanceof Set){if(!this.isMulti_)throw new Error("MDCListFoundation: Array of index is only supported for checkbox based list");if(0===t.size)return!0;{let e=!1;for(const n of t)if(e=this.isIndexInRange_(n),e)break;return e}}if("number"==typeof t){if(this.isMulti_)throw new Error("MDCListFoundation: Expected array of index for checkbox based list but got number: "+t);return t===ou.UNSET_INDEX||this.isIndexInRange_(t)}return!1}isIndexInRange_(t){const e=this.adapter.getListItemCount();return t>=0&&t<e}setSelectedIndexOnAction_(t,e,n){if(this.adapter.getDisabledStateForElementIndex(t))return;let i=t;if(this.isMulti_&&(i=new Set([t])),this.isIndexValid_(i)){if(this.isMulti_)this.toggleMultiAtIndex(t,n,e);else if(e||n)this.setSingleSelectionAtIndex_(t,e);else{this.selectedIndex_===t&&this.setSingleSelectionAtIndex_(ou.UNSET_INDEX)}e&&this.adapter.notifyAction(t)}}toggleMultiAtIndex(t,e,n=!0){let i=!1;i=void 0===e?!this.adapter.getSelectedStateForElementIndex(t):e;const o=uu(this.selectedIndex_);i?o.add(t):o.delete(t),this.setMultiSelectionAtIndex_(o,n)}}const pu=t=>t.hasAttribute("mwc-list-item");function gu(){const t=this.itemsReadyResolver;this.itemsReady=new Promise((t=>this.itemsReadyResolver=t)),t()}class fu extends _t{constructor(){super(),this.mdcAdapter=null,this.mdcFoundationClass=hu,this.activatable=!1,this.multi=!1,this.wrapFocus=!1,this.itemRoles=null,this.innerRole=null,this.innerAriaLabel=null,this.rootTabbable=!1,this.previousTabindex=null,this.noninteractive=!1,this.itemsReadyResolver=()=>{},this.itemsReady=Promise.resolve([]),this.items_=[];const t=function(t,e=50){let n;return function(i=!0){clearTimeout(n),n=setTimeout((()=>{t(i)}),e)}}(this.layout.bind(this));this.debouncedLayout=(e=!0)=>{gu.call(this),t(e)}}async _getUpdateComplete(){await super._getUpdateComplete(),await this.itemsReady}get assignedElements(){const t=this.slotElement;return t?t.assignedNodes({flatten:!0}).filter(dt):[]}get items(){return this.items_}updateItems(){const t=this.assignedElements,e=[];for(const n of t)pu(n)&&(e.push(n),n._managingList=this),n.hasAttribute("divider")&&!n.hasAttribute("role")&&n.setAttribute("role","separator");this.items_=e;const n=new Set;if(this.items_.forEach(((t,e)=>{this.itemRoles?t.setAttribute("role",this.itemRoles):t.removeAttribute("role"),t.selected&&n.add(e)})),this.multi)this.select(n);else{const t=n.size?n.entries().next().value[1]:-1;this.select(t)}const i=new Event("items-updated",{bubbles:!0,composed:!0});this.dispatchEvent(i)}get selected(){const t=this.index;if(!du(t))return-1===t?null:this.items[t];const e=[];for(const n of t)e.push(this.items[n]);return e}get index(){return this.mdcFoundation?this.mdcFoundation.getSelectedIndex():-1}render(){const t=null===this.innerRole?void 0:this.innerRole,e=null===this.innerAriaLabel?void 0:this.innerAriaLabel,n=this.rootTabbable?"0":"-1";return F(ru||(ru=lu` <ul tabindex="${0}" role="${0}" aria-label="${0}" class="mdc-list" @keydown="${0}" @focusin="${0}" @focusout="${0}" @request-selected="${0}" @list-item-rendered="${0}"> <slot></slot> ${0} </ul> `),n,$t(t),$t(e),this.onKeydown,this.onFocusIn,this.onFocusOut,this.onRequestSelected,this.onListItemConnected,this.renderPlaceholder())}renderPlaceholder(){return void 0!==this.emptyMessage&&0===this.assignedElements.length?F(su||(su=lu` <mwc-list-item noninteractive>${0}</mwc-list-item> `),this.emptyMessage):null}firstUpdated(){super.firstUpdated(),this.items.length||(this.mdcFoundation.setMulti(this.multi),this.layout())}onFocusIn(t){if(this.mdcFoundation&&this.mdcRoot){const e=this.getIndexOfTarget(t);this.mdcFoundation.handleFocusIn(t,e)}}onFocusOut(t){if(this.mdcFoundation&&this.mdcRoot){const e=this.getIndexOfTarget(t);this.mdcFoundation.handleFocusOut(t,e)}}onKeydown(t){if(this.mdcFoundation&&this.mdcRoot){const e=this.getIndexOfTarget(t),n=t.target,i=pu(n);this.mdcFoundation.handleKeydown(t,i,e)}}onRequestSelected(t){if(this.mdcFoundation){let e=this.getIndexOfTarget(t);if(-1===e&&(this.layout(),e=this.getIndexOfTarget(t),-1===e))return;if(this.items[e].disabled)return;const n=t.detail.selected,i=t.detail.source;this.mdcFoundation.handleSingleSelection(e,"interaction"===i,n),t.stopPropagation()}}getIndexOfTarget(t){const e=this.items,n=t.composedPath();for(const t of n){let n=-1;if(dt(t)&&pu(t)&&(n=e.indexOf(t)),-1!==n)return n}return-1}createAdapter(){return this.mdcAdapter={getListItemCount:()=>this.mdcRoot?this.items.length:0,getFocusedElementIndex:this.getFocusedItemIndex,getAttributeForElementIndex:(t,e)=>{if(!this.mdcRoot)return"";const n=this.items[t];return n?n.getAttribute(e):""},setAttributeForElementIndex:(t,e,n)=>{if(!this.mdcRoot)return;const i=this.items[t];i&&i.setAttribute(e,n)},focusItemAtIndex:t=>{const e=this.items[t];e&&e.focus()},setTabIndexForElementIndex:(t,e)=>{const n=this.items[t];n&&(n.tabindex=e)},notifyAction:t=>{const e={bubbles:!0,composed:!0};e.detail={index:t};const n=new CustomEvent("action",e);this.dispatchEvent(n)},notifySelected:(t,e)=>{const n={bubbles:!0,composed:!0};n.detail={index:t,diff:e};const i=new CustomEvent("selected",n);this.dispatchEvent(i)},isFocusInsideList:()=>mt(this),isRootFocused:()=>{const t=this.mdcRoot;return t.getRootNode().activeElement===t},setDisabledStateForElementIndex:(t,e)=>{const n=this.items[t];n&&(n.disabled=e)},getDisabledStateForElementIndex:t=>{const e=this.items[t];return!!e&&e.disabled},setSelectedStateForElementIndex:(t,e)=>{const n=this.items[t];n&&(n.selected=e)},getSelectedStateForElementIndex:t=>{const e=this.items[t];return!!e&&e.selected},setActivatedStateForElementIndex:(t,e)=>{const n=this.items[t];n&&(n.activated=e)}},this.mdcAdapter}selectUi(t,e=!1){const n=this.items[t];n&&(n.selected=!0,n.activated=e)}deselectUi(t){const e=this.items[t];e&&(e.selected=!1,e.activated=!1)}select(t){this.mdcFoundation&&this.mdcFoundation.setSelectedIndex(t)}toggle(t,e){this.multi&&this.mdcFoundation.toggleMultiAtIndex(t,e)}onListItemConnected(t){const e=t.target;this.layout(-1===this.items.indexOf(e))}layout(t=!0){t&&this.updateItems();const e=this.items[0];for(const t of this.items)t.tabindex=-1;e&&(this.noninteractive?this.previousTabindex||(this.previousTabindex=e):e.tabindex=0),this.itemsReadyResolver()}getFocusedItemIndex(){if(!this.mdcRoot)return-1;if(!this.items.length)return-1;const t=ft();if(!t.length)return-1;for(let e=t.length-1;e>=0;e--){const n=t[e];if(pu(n))return this.items.indexOf(n)}return-1}focusItemAtIndex(t){for(const t of this.items)if(0===t.tabindex){t.tabindex=-1;break}this.items[t].tabindex=0,this.items[t].focus()}focus(){const t=this.mdcRoot;t&&t.focus()}blur(){const t=this.mdcRoot;t&&t.blur()}}t([J({type:String})],fu.prototype,"emptyMessage",void 0),t([Z(".mdc-list")],fu.prototype,"mdcRoot",void 0),t([Z("slot")],fu.prototype,"slotElement",void 0),t([J({type:Boolean}),vt((function(t){this.mdcFoundation&&this.mdcFoundation.setUseActivatedClass(t)}))],fu.prototype,"activatable",void 0),t([J({type:Boolean}),vt((function(t,e){this.mdcFoundation&&this.mdcFoundation.setMulti(t),void 0!==e&&this.layout()}))],fu.prototype,"multi",void 0),t([J({type:Boolean}),vt((function(t){this.mdcFoundation&&this.mdcFoundation.setWrapFocus(t)}))],fu.prototype,"wrapFocus",void 0),t([J({type:String}),vt((function(t,e){void 0!==e&&this.updateItems()}))],fu.prototype,"itemRoles",void 0),t([J({type:String})],fu.prototype,"innerRole",void 0),t([J({type:String})],fu.prototype,"innerAriaLabel",void 0),t([J({type:Boolean})],fu.prototype,"rootTabbable",void 0),t([J({type:Boolean,reflect:!0}),vt((function(t){const e=this.slotElement;if(t&&e){const t=ut(e,'[tabindex="0"]');this.previousTabindex=t,t&&t.setAttribute("tabindex","-1")}else!t&&this.previousTabindex&&(this.previousTabindex.setAttribute("tabindex","0"),this.previousTabindex=null)}))],fu.prototype,"noninteractive",void 0);const mu=st(au||(au=lu`@keyframes mdc-ripple-fg-radius-in{from{animation-timing-function:cubic-bezier(.4,0,.2,1);transform:translate(var(--mdc-ripple-fg-translate-start,0)) scale(1)}to{transform:translate(var(--mdc-ripple-fg-translate-end,0)) scale(var(--mdc-ripple-fg-scale,1))}}@keyframes mdc-ripple-fg-opacity-in{from{animation-timing-function:linear;opacity:0}to{opacity:var(--mdc-ripple-fg-opacity,0)}}@keyframes mdc-ripple-fg-opacity-out{from{animation-timing-function:linear;opacity:var(--mdc-ripple-fg-opacity,0)}to{opacity:0}}:host{display:block}.mdc-list{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto,sans-serif;font-family:var(--mdc-typography-subtitle1-font-family,var(--mdc-typography-font-family,Roboto,sans-serif));font-size:1rem;font-size:var(--mdc-typography-subtitle1-font-size,1rem);line-height:1.75rem;line-height:var(--mdc-typography-subtitle1-line-height,1.75rem);font-weight:400;font-weight:var(--mdc-typography-subtitle1-font-weight,400);letter-spacing:.009375em;letter-spacing:var(--mdc-typography-subtitle1-letter-spacing,.009375em);text-decoration:inherit;text-decoration:var(--mdc-typography-subtitle1-text-decoration,inherit);text-transform:inherit;text-transform:var(--mdc-typography-subtitle1-text-transform,inherit);line-height:1.5rem;margin:0;padding:8px 0;list-style-type:none;color:rgba(0,0,0,.87);color:var(--mdc-theme-text-primary-on-background,rgba(0,0,0,.87));padding:var(--mdc-list-vertical-padding,8px) 0}.mdc-list:focus{outline:0}.mdc-list-item{height:48px}.mdc-list--dense{padding-top:4px;padding-bottom:4px;font-size:.812rem}.mdc-list ::slotted([divider]){height:0;margin:0;border:none;border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgba(0,0,0,.12)}.mdc-list ::slotted([divider][padded]){margin:0 var(--mdc-list-side-padding,16px)}.mdc-list ::slotted([divider][inset]){margin-left:var(--mdc-list-inset-margin,72px);margin-right:0;width:calc(100% - var(--mdc-list-inset-margin,72px))}.mdc-list-group[dir=rtl] .mdc-list ::slotted([divider][inset]),[dir=rtl] .mdc-list-group .mdc-list ::slotted([divider][inset]){margin-left:0;margin-right:var(--mdc-list-inset-margin,72px)}.mdc-list ::slotted([divider][inset][padded]){width:calc(100% - var(--mdc-list-inset-margin,72px) - var(--mdc-list-side-padding,16px))}.mdc-list--dense ::slotted([mwc-list-item]){height:40px}.mdc-list--dense ::slotted([mwc-list]){--mdc-list-item-graphic-size:20px}.mdc-list--avatar-list.mdc-list--dense ::slotted([mwc-list-item]),.mdc-list--two-line.mdc-list--dense ::slotted([mwc-list-item]){height:60px}.mdc-list--avatar-list.mdc-list--dense ::slotted([mwc-list]){--mdc-list-item-graphic-size:36px}:host([noninteractive]){pointer-events:none;cursor:default}.mdc-list--dense ::slotted(.mdc-list-item__primary-text){display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list--dense ::slotted(.mdc-list-item__primary-text)::before{display:inline-block;width:0;height:24px;content:"";vertical-align:0}.mdc-list--dense ::slotted(.mdc-list-item__primary-text)::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}`));class _u extends(Le(fu)){static get scopedElements(){return{"mwc-list-item":Rd}}}_u.styles=mu,(()=>{var t,e,n;const i=Symbol(),o=Symbol(),r=Symbol(),s=Symbol(),a=Symbol(),l=Symbol(),c=Symbol(),d=Symbol(),u=Symbol(),h=Symbol(),p=Symbol(),g=Symbol(),f=Symbol();class m{constructor(){this[t]=[],this[e]=[],this[n]=new Set}destructor(){this[u](this[r]);const t=this;t[i]=null,t[r]=null,t[o]=null}get top(){const t=this[i];return t[t.length-1]||null}push(t){t&&t!==this.top&&(this.remove(t),this[l](t),this[i].push(t))}remove(t){const e=this[i].indexOf(t);return-1!==e&&(this[i].splice(e,1),e===this[i].length&&this[l](this.top),!0)}pop(){const t=this.top;return t&&this.remove(t),t}has(t){return-1!==this[i].indexOf(t)}[(t=i,e=r,n=o,l)](t){const e=this[o],n=this[r];if(!t)return this[u](n),e.clear(),void(this[r]=[]);const i=this[h](t);if(i[i.length-1].parentNode!==document.body)throw Error("Non-connected element cannot be a blocking element");this[r]=i;const s=this[p](t);if(!n.length)return void this[d](i,s,e);let a=n.length-1,l=i.length-1;for(;a>0&&l>0&&n[a]===i[l];)a--,l--;n[a]!==i[l]&&this[c](n[a],i[l]),a>0&&this[u](n.slice(0,a)),l>0&&this[d](i.slice(0,l),s,null)}[c](t,e){const n=t[s];this[g](t)&&!t.inert&&(t.inert=!0,n.add(t)),n.has(e)&&(e.inert=!1,n.delete(e)),e[a]=t[a],e[s]=n,t[a]=void 0,t[s]=void 0}[u](t){for(const e of t){e[a].disconnect(),e[a]=void 0;const t=e[s];for(const e of t)e.inert=!1;e[s]=void 0}}[d](t,e,n){for(const i of t){const t=i.parentNode,o=t.children,r=new Set;for(let t=0;t<o.length;t++){const s=o[t];s===i||!this[g](s)||e&&e.has(s)||(n&&s.inert?n.add(s):(s.inert=!0,r.add(s)))}i[s]=r;const l=new MutationObserver(this[f].bind(this));i[a]=l;let c=t;const d=c;d.__shady&&d.host&&(c=d.host),l.observe(c,{childList:!0})}}[f](t){const e=this[r],n=this[o];for(const i of t){const t=i.target.host||i.target,o=t===document.body?e.length:e.indexOf(t),r=e[o-1],a=r[s];for(let t=0;t<i.removedNodes.length;t++){const e=i.removedNodes[t];if(e===r)return console.info("Detected removal of the top Blocking Element."),void this.pop();a.has(e)&&(e.inert=!1,a.delete(e))}for(let t=0;t<i.addedNodes.length;t++){const e=i.addedNodes[t];this[g](e)&&(n&&e.inert?n.add(e):(e.inert=!0,a.add(e)))}}}[g](t){return!1===/^(style|template|script)$/.test(t.localName)}[h](t){const e=[];let n=t;for(;n&&n!==document.body;)if(n.nodeType===Node.ELEMENT_NODE&&e.push(n),n.assignedSlot){for(;n=n.assignedSlot;)e.push(n);n=e.pop()}else n=n.parentNode||n.host;return e}[p](t){const e=t.shadowRoot;if(!e)return null;const n=new Set;let i,o,r;const s=e.querySelectorAll("slot");if(s.length&&s[0].assignedNodes)for(i=0;i<s.length;i++)for(r=s[i].assignedNodes({flatten:!0}),o=0;o<r.length;o++)r[o].nodeType===Node.ELEMENT_NODE&&n.add(r[o]);return n}}document.$blockingElements=new m})();var vu=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();function yu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}!function(){if("undefined"!=typeof window){var t=Array.prototype.slice,e=Element.prototype.matches||Element.prototype.msMatchesSelector,n=["a[href]","area[href]","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])","details","summary","iframe","object","embed","[contenteditable]"].join(","),i=function(){function i(t,e){yu(this,i),this._inertManager=e,this._rootElement=t,this._managedNodes=new Set,this._rootElement.hasAttribute("aria-hidden")?this._savedAriaHidden=this._rootElement.getAttribute("aria-hidden"):this._savedAriaHidden=null,this._rootElement.setAttribute("aria-hidden","true"),this._makeSubtreeUnfocusable(this._rootElement),this._observer=new MutationObserver(this._onMutation.bind(this)),this._observer.observe(this._rootElement,{attributes:!0,childList:!0,subtree:!0})}return vu(i,[{key:"destructor",value:function(){this._observer.disconnect(),this._rootElement&&(null!==this._savedAriaHidden?this._rootElement.setAttribute("aria-hidden",this._savedAriaHidden):this._rootElement.removeAttribute("aria-hidden")),this._managedNodes.forEach((function(t){this._unmanageNode(t.node)}),this),this._observer=null,this._rootElement=null,this._managedNodes=null,this._inertManager=null}},{key:"_makeSubtreeUnfocusable",value:function(t){var e=this;a(t,(function(t){return e._visitNode(t)}));var n=document.activeElement;if(!document.body.contains(t)){for(var i=t,o=void 0;i;){if(i.nodeType===Node.DOCUMENT_FRAGMENT_NODE){o=i;break}i=i.parentNode}o&&(n=o.activeElement)}t.contains(n)&&(n.blur(),n===document.activeElement&&document.body.focus())}},{key:"_visitNode",value:function(t){if(t.nodeType===Node.ELEMENT_NODE){var i=t;i!==this._rootElement&&i.hasAttribute("inert")&&this._adoptInertRoot(i),(e.call(i,n)||i.hasAttribute("tabindex"))&&this._manageNode(i)}}},{key:"_manageNode",value:function(t){var e=this._inertManager.register(t,this);this._managedNodes.add(e)}},{key:"_unmanageNode",value:function(t){var e=this._inertManager.deregister(t,this);e&&this._managedNodes.delete(e)}},{key:"_unmanageSubtree",value:function(t){var e=this;a(t,(function(t){return e._unmanageNode(t)}))}},{key:"_adoptInertRoot",value:function(t){var e=this._inertManager.getInertRoot(t);e||(this._inertManager.setInert(t,!0),e=this._inertManager.getInertRoot(t)),e.managedNodes.forEach((function(t){this._manageNode(t.node)}),this)}},{key:"_onMutation",value:function(e,n){e.forEach((function(e){var n=e.target;if("childList"===e.type)t.call(e.addedNodes).forEach((function(t){this._makeSubtreeUnfocusable(t)}),this),t.call(e.removedNodes).forEach((function(t){this._unmanageSubtree(t)}),this);else if("attributes"===e.type)if("tabindex"===e.attributeName)this._manageNode(n);else if(n!==this._rootElement&&"inert"===e.attributeName&&n.hasAttribute("inert")){this._adoptInertRoot(n);var i=this._inertManager.getInertRoot(n);this._managedNodes.forEach((function(t){n.contains(t.node)&&i._manageNode(t.node)}))}}),this)}},{key:"managedNodes",get:function(){return new Set(this._managedNodes)}},{key:"hasSavedAriaHidden",get:function(){return null!==this._savedAriaHidden}},{key:"savedAriaHidden",set:function(t){this._savedAriaHidden=t},get:function(){return this._savedAriaHidden}}]),i}(),o=function(){function t(e,n){yu(this,t),this._node=e,this._overrodeFocusMethod=!1,this._inertRoots=new Set([n]),this._savedTabIndex=null,this._destroyed=!1,this.ensureUntabbable()}return vu(t,[{key:"destructor",value:function(){if(this._throwIfDestroyed(),this._node&&this._node.nodeType===Node.ELEMENT_NODE){var t=this._node;null!==this._savedTabIndex?t.setAttribute("tabindex",this._savedTabIndex):t.removeAttribute("tabindex"),this._overrodeFocusMethod&&delete t.focus}this._node=null,this._inertRoots=null,this._destroyed=!0}},{key:"_throwIfDestroyed",value:function(){if(this.destroyed)throw new Error("Trying to access destroyed InertNode")}},{key:"ensureUntabbable",value:function(){if(this.node.nodeType===Node.ELEMENT_NODE){var t=this.node;if(e.call(t,n)){if(-1===t.tabIndex&&this.hasSavedTabIndex)return;t.hasAttribute("tabindex")&&(this._savedTabIndex=t.tabIndex),t.setAttribute("tabindex","-1"),t.nodeType===Node.ELEMENT_NODE&&(t.focus=function(){},this._overrodeFocusMethod=!0)}else t.hasAttribute("tabindex")&&(this._savedTabIndex=t.tabIndex,t.removeAttribute("tabindex"))}}},{key:"addInertRoot",value:function(t){this._throwIfDestroyed(),this._inertRoots.add(t)}},{key:"removeInertRoot",value:function(t){this._throwIfDestroyed(),this._inertRoots.delete(t),0===this._inertRoots.size&&this.destructor()}},{key:"destroyed",get:function(){return this._destroyed}},{key:"hasSavedTabIndex",get:function(){return null!==this._savedTabIndex}},{key:"node",get:function(){return this._throwIfDestroyed(),this._node}},{key:"savedTabIndex",set:function(t){this._throwIfDestroyed(),this._savedTabIndex=t},get:function(){return this._throwIfDestroyed(),this._savedTabIndex}}]),t}(),r=function(){function n(t){if(yu(this,n),!t)throw new Error("Missing required argument; InertManager needs to wrap a document.");this._document=t,this._managedNodes=new Map,this._inertRoots=new Map,this._observer=new MutationObserver(this._watchForInert.bind(this)),l(t.head||t.body||t.documentElement),"loading"===t.readyState?t.addEventListener("DOMContentLoaded",this._onDocumentLoaded.bind(this)):this._onDocumentLoaded()}return vu(n,[{key:"setInert",value:function(t,e){if(e){if(this._inertRoots.has(t))return;var n=new i(t,this);if(t.setAttribute("inert",""),this._inertRoots.set(t,n),!this._document.body.contains(t))for(var o=t.parentNode;o;)11===o.nodeType&&l(o),o=o.parentNode}else{if(!this._inertRoots.has(t))return;this._inertRoots.get(t).destructor(),this._inertRoots.delete(t),t.removeAttribute("inert")}}},{key:"getInertRoot",value:function(t){return this._inertRoots.get(t)}},{key:"register",value:function(t,e){var n=this._managedNodes.get(t);return void 0!==n?n.addInertRoot(e):n=new o(t,e),this._managedNodes.set(t,n),n}},{key:"deregister",value:function(t,e){var n=this._managedNodes.get(t);return n?(n.removeInertRoot(e),n.destroyed&&this._managedNodes.delete(t),n):null}},{key:"_onDocumentLoaded",value:function(){t.call(this._document.querySelectorAll("[inert]")).forEach((function(t){this.setInert(t,!0)}),this),this._observer.observe(this._document.body||this._document.documentElement,{attributes:!0,subtree:!0,childList:!0})}},{key:"_watchForInert",value:function(n,i){var o=this;n.forEach((function(n){switch(n.type){case"childList":t.call(n.addedNodes).forEach((function(n){if(n.nodeType===Node.ELEMENT_NODE){var i=t.call(n.querySelectorAll("[inert]"));e.call(n,"[inert]")&&i.unshift(n),i.forEach((function(t){this.setInert(t,!0)}),o)}}),o);break;case"attributes":if("inert"!==n.attributeName)return;var i=n.target,r=i.hasAttribute("inert");o.setInert(i,r)}}),this)}}]),n}();if(!Element.prototype.hasOwnProperty("inert")){var s=new r(document);Object.defineProperty(Element.prototype,"inert",{enumerable:!0,get:function(){return this.hasAttribute("inert")},set:function(t){s.setInert(this,t)}})}}function a(t,e,n){if(t.nodeType==Node.ELEMENT_NODE){var i=t;e&&e(i);var o=i.shadowRoot;if(o)return void a(o,e);if("content"==i.localName){for(var r=i,s=r.getDistributedNodes?r.getDistributedNodes():[],l=0;l<s.length;l++)a(s[l],e);return}if("slot"==i.localName){for(var c=i,d=c.assignedNodes?c.assignedNodes({flatten:!0}):[],u=0;u<d.length;u++)a(d[u],e);return}}for(var h=t.firstChild;null!=h;)a(h,e),h=h.nextSibling}function l(t){if(!t.querySelector("style#inert-style, link#inert-style")){var e=document.createElement("style");e.setAttribute("id","inert-style"),e.textContent="\n[inert] {\n  pointer-events: none;\n  cursor: default;\n}\n\n[inert], [inert] * {\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n}\n",t.appendChild(e)}}}();var bu={ANIMATE:"mdc-drawer--animate",CLOSING:"mdc-drawer--closing",DISMISSIBLE:"mdc-drawer--dismissible",MODAL:"mdc-drawer--modal",OPEN:"mdc-drawer--open",OPENING:"mdc-drawer--opening",ROOT:"mdc-drawer"},Eu={APP_CONTENT_SELECTOR:".mdc-drawer-app-content",CLOSE_EVENT:"MDCDrawer:closed",OPEN_EVENT:"MDCDrawer:opened",SCRIM_SELECTOR:".mdc-drawer-scrim"},Tu=function(t,e){return(Tu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function Ru(t,e){function n(){this.constructor=t}Tu(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Cu=function(){return(Cu=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},xu=function(t){function e(n){var i=t.call(this,Cu(Cu({},e.defaultAdapter),n))||this;return i.animationFrame_=0,i.animationTimer_=0,i}return Ru(e,t),Object.defineProperty(e,"strings",{get:function(){return Eu},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cssClasses",{get:function(){return bu},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},elementHasClass:function(){return!1},notifyClose:function(){},notifyOpen:function(){},saveFocus:function(){},restoreFocus:function(){},focusActiveNavigationItem:function(){},trapFocus:function(){},releaseFocus:function(){}}},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.animationFrame_&&cancelAnimationFrame(this.animationFrame_),this.animationTimer_&&clearTimeout(this.animationTimer_)},e.prototype.open=function(){var t=this;this.isOpen()||this.isOpening()||this.isClosing()||(this.adapter.addClass(bu.OPEN),this.adapter.addClass(bu.ANIMATE),this.runNextAnimationFrame_((function(){t.adapter.addClass(bu.OPENING)})),this.adapter.saveFocus())},e.prototype.close=function(){!this.isOpen()||this.isOpening()||this.isClosing()||this.adapter.addClass(bu.CLOSING)},e.prototype.isOpen=function(){return this.adapter.hasClass(bu.OPEN)},e.prototype.isOpening=function(){return this.adapter.hasClass(bu.OPENING)||this.adapter.hasClass(bu.ANIMATE)},e.prototype.isClosing=function(){return this.adapter.hasClass(bu.CLOSING)},e.prototype.handleKeydown=function(t){var e=t.keyCode;("Escape"===t.key||27===e)&&this.close()},e.prototype.handleTransitionEnd=function(t){var e=bu.OPENING,n=bu.CLOSING,i=bu.OPEN,o=bu.ANIMATE,r=bu.ROOT;this.isElement_(t.target)&&this.adapter.elementHasClass(t.target,r)&&(this.isClosing()?(this.adapter.removeClass(i),this.closed_(),this.adapter.restoreFocus(),this.adapter.notifyClose()):(this.adapter.focusActiveNavigationItem(),this.opened_(),this.adapter.notifyOpen()),this.adapter.removeClass(o),this.adapter.removeClass(e),this.adapter.removeClass(n))},e.prototype.opened_=function(){},e.prototype.closed_=function(){},e.prototype.runNextAnimationFrame_=function(t){var e=this;cancelAnimationFrame(this.animationFrame_),this.animationFrame_=requestAnimationFrame((function(){e.animationFrame_=0,clearTimeout(e.animationTimer_),e.animationTimer_=setTimeout(t,0)}))},e.prototype.isElement_=function(t){return Boolean(t.classList)},e}(Et),Su=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ru(e,t),e.prototype.handleScrimClick=function(){this.close()},e.prototype.opened_=function(){this.adapter.trapFocus()},e.prototype.closed_=function(){this.adapter.releaseFocus()},e}(xu);let Iu,Ou,ku,wu,Au=t=>t;const Du=document.$blockingElements;class Nu extends _t{constructor(){super(...arguments),this._previousFocus=null,this.open=!1,this.hasHeader=!1,this.type=""}get mdcFoundationClass(){return"modal"===this.type?Su:xu}createAdapter(){return Object.assign(Object.assign({},ht(this.mdcRoot)),{elementHasClass:(t,e)=>t.classList.contains(e),saveFocus:()=>{this._previousFocus=this.getRootNode().activeElement},restoreFocus:()=>{this._previousFocus&&this._previousFocus.focus&&this._previousFocus.focus()},notifyClose:()=>{this.open=!1,this.dispatchEvent(new Event(Eu.CLOSE_EVENT,{bubbles:!0,cancelable:!0}))},notifyOpen:()=>{this.open=!0,this.dispatchEvent(new Event(Eu.OPEN_EVENT,{bubbles:!0,cancelable:!0}))},focusActiveNavigationItem:()=>{},trapFocus:()=>{Du.push(this),this.appContent.inert=!0},releaseFocus:()=>{Du.remove(this),this.appContent.inert=!1}})}_handleScrimClick(){this.mdcFoundation instanceof Su&&this.mdcFoundation.handleScrimClick()}render(){const t="dismissible"===this.type||"modal"===this.type,e="modal"===this.type,n=this.hasHeader?F(Iu||(Iu=Au` <div class="mdc-drawer__header"> <h3 class="mdc-drawer__title"><slot name="title"></slot></h3> <h6 class="mdc-drawer__subtitle"><slot name="subtitle"></slot></h6> <slot name="header"></slot> </div> `)):"";return F(Ou||(Ou=Au` <aside class="mdc-drawer ${0}"> ${0} <div class="mdc-drawer__content"><slot></slot></div> </aside> ${0} <div class="mdc-drawer-app-content"> <slot name="appContent"></slot> </div> `),Nt({"mdc-drawer--dismissible":t,"mdc-drawer--modal":e}),n,e?F(ku||(ku=Au`<div class="mdc-drawer-scrim" @click="${0}"></div>`),this._handleScrimClick):"")}firstUpdated(){this.mdcRoot.addEventListener("keydown",(t=>this.mdcFoundation.handleKeydown(t))),this.mdcRoot.addEventListener("transitionend",(t=>this.mdcFoundation.handleTransitionEnd(t)))}updated(t){t.has("type")&&this.createFoundation()}}t([Z(".mdc-drawer")],Nu.prototype,"mdcRoot",void 0),t([Z(".mdc-drawer-app-content")],Nu.prototype,"appContent",void 0),t([vt((function(t){""!==this.type&&(t?this.mdcFoundation.open():this.mdcFoundation.close())})),J({type:Boolean,reflect:!0})],Nu.prototype,"open",void 0),t([J({type:Boolean})],Nu.prototype,"hasHeader",void 0),t([J({reflect:!0})],Nu.prototype,"type",void 0);const Lu=st(wu||(wu=Au`.mdc-drawer{border-color:rgba(0,0,0,.12);background-color:#fff;background-color:var(--mdc-theme-surface,#fff);border-top-left-radius:0;border-top-right-radius:0;border-top-right-radius:var(--mdc-shape-large,0);border-bottom-right-radius:0;border-bottom-right-radius:var(--mdc-shape-large,0);border-bottom-left-radius:0;z-index:6;width:256px;display:flex;flex-direction:column;flex-shrink:0;box-sizing:border-box;height:100%;border-right-width:1px;border-right-style:solid;overflow:hidden;transition-property:transform;transition-timing-function:cubic-bezier(.4,0,.2,1)}.mdc-drawer .mdc-drawer__title{color:rgba(0,0,0,.87)}.mdc-drawer .mdc-list-group__subheader{color:rgba(0,0,0,.6)}.mdc-drawer .mdc-drawer__subtitle{color:rgba(0,0,0,.6)}.mdc-drawer .mdc-list-item__graphic{color:rgba(0,0,0,.6)}.mdc-drawer .mdc-list-item{color:rgba(0,0,0,.87)}.mdc-drawer .mdc-list-item--activated .mdc-list-item__graphic{color:#6200ee}.mdc-drawer .mdc-list-item--activated{color:rgba(98,0,238,.87)}.mdc-drawer[dir=rtl],[dir=rtl] .mdc-drawer{border-top-left-radius:0;border-top-left-radius:var(--mdc-shape-large,0);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:0;border-bottom-left-radius:var(--mdc-shape-large,0)}.mdc-drawer .mdc-list-item{border-radius:4px;border-radius:var(--mdc-shape-small,4px)}.mdc-drawer.mdc-drawer--open:not(.mdc-drawer--closing)+.mdc-drawer-app-content{margin-left:256px;margin-right:0}.mdc-drawer.mdc-drawer--open:not(.mdc-drawer--closing)+.mdc-drawer-app-content[dir=rtl],[dir=rtl] .mdc-drawer.mdc-drawer--open:not(.mdc-drawer--closing)+.mdc-drawer-app-content{margin-left:0;margin-right:256px}.mdc-drawer[dir=rtl],[dir=rtl] .mdc-drawer{border-right-width:0;border-left-width:1px;border-right-style:none;border-left-style:solid}.mdc-drawer .mdc-list-item{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto,sans-serif;font-family:var(--mdc-typography-subtitle2-font-family,var(--mdc-typography-font-family,Roboto,sans-serif));font-size:.875rem;font-size:var(--mdc-typography-subtitle2-font-size,.875rem);line-height:1.375rem;line-height:var(--mdc-typography-subtitle2-line-height,1.375rem);font-weight:500;font-weight:var(--mdc-typography-subtitle2-font-weight,500);letter-spacing:.0071428571em;letter-spacing:var(--mdc-typography-subtitle2-letter-spacing,.0071428571em);text-decoration:inherit;text-decoration:var(--mdc-typography-subtitle2-text-decoration,inherit);text-transform:inherit;text-transform:var(--mdc-typography-subtitle2-text-transform,inherit);height:calc(48px - 2 * 4px);margin:8px 8px;padding:0 8px}.mdc-drawer .mdc-list-item:nth-child(1){margin-top:2px}.mdc-drawer .mdc-list-item:nth-last-child(1){margin-bottom:0}.mdc-drawer .mdc-list-group__subheader{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto,sans-serif;font-family:var(--mdc-typography-body2-font-family,var(--mdc-typography-font-family,Roboto,sans-serif));font-size:.875rem;font-size:var(--mdc-typography-body2-font-size,.875rem);line-height:1.25rem;line-height:var(--mdc-typography-body2-line-height,1.25rem);font-weight:400;font-weight:var(--mdc-typography-body2-font-weight,400);letter-spacing:.0178571429em;letter-spacing:var(--mdc-typography-body2-letter-spacing,.0178571429em);text-decoration:inherit;text-decoration:var(--mdc-typography-body2-text-decoration,inherit);text-transform:inherit;text-transform:var(--mdc-typography-body2-text-transform,inherit);display:block;margin-top:0;line-height:normal;margin:0;padding:0 16px}.mdc-drawer .mdc-list-group__subheader::before{display:inline-block;width:0;height:24px;content:"";vertical-align:0}.mdc-drawer .mdc-list-divider{margin:3px 0 4px}.mdc-drawer .mdc-list-item__graphic,.mdc-drawer .mdc-list-item__text{pointer-events:none}.mdc-drawer--animate{transform:translateX(-100%)}.mdc-drawer--animate[dir=rtl],[dir=rtl] .mdc-drawer--animate{transform:translateX(100%)}.mdc-drawer--opening{transform:translateX(0);transition-duration:250ms}.mdc-drawer--opening[dir=rtl],[dir=rtl] .mdc-drawer--opening{transform:translateX(0)}.mdc-drawer--closing{transform:translateX(-100%);transition-duration:.2s}.mdc-drawer--closing[dir=rtl],[dir=rtl] .mdc-drawer--closing{transform:translateX(100%)}.mdc-drawer__header{flex-shrink:0;box-sizing:border-box;min-height:64px;padding:0 16px 4px}.mdc-drawer__title{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto,sans-serif;font-family:var(--mdc-typography-headline6-font-family,var(--mdc-typography-font-family,Roboto,sans-serif));font-size:1.25rem;font-size:var(--mdc-typography-headline6-font-size,1.25rem);line-height:2rem;line-height:var(--mdc-typography-headline6-line-height,2rem);font-weight:500;font-weight:var(--mdc-typography-headline6-font-weight,500);letter-spacing:.0125em;letter-spacing:var(--mdc-typography-headline6-letter-spacing,.0125em);text-decoration:inherit;text-decoration:var(--mdc-typography-headline6-text-decoration,inherit);text-transform:inherit;text-transform:var(--mdc-typography-headline6-text-transform,inherit);display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-drawer__title::before{display:inline-block;width:0;height:36px;content:"";vertical-align:0}.mdc-drawer__title::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-drawer__subtitle{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto,sans-serif;font-family:var(--mdc-typography-body2-font-family,var(--mdc-typography-font-family,Roboto,sans-serif));font-size:.875rem;font-size:var(--mdc-typography-body2-font-size,.875rem);line-height:1.25rem;line-height:var(--mdc-typography-body2-line-height,1.25rem);font-weight:400;font-weight:var(--mdc-typography-body2-font-weight,400);letter-spacing:.0178571429em;letter-spacing:var(--mdc-typography-body2-letter-spacing,.0178571429em);text-decoration:inherit;text-decoration:var(--mdc-typography-body2-text-decoration,inherit);text-transform:inherit;text-transform:var(--mdc-typography-body2-text-transform,inherit);display:block;margin-top:0;line-height:normal;margin-bottom:0}.mdc-drawer__subtitle::before{display:inline-block;width:0;height:20px;content:"";vertical-align:0}.mdc-drawer__content{height:100%;overflow-y:auto;-webkit-overflow-scrolling:touch}.mdc-drawer--dismissible{left:0;right:initial;display:none;position:absolute}.mdc-drawer--dismissible[dir=rtl],[dir=rtl] .mdc-drawer--dismissible{left:initial;right:0}.mdc-drawer--dismissible.mdc-drawer--open{display:flex}.mdc-drawer-app-content{margin-left:0;margin-right:0;position:relative}.mdc-drawer-app-content[dir=rtl],[dir=rtl] .mdc-drawer-app-content{margin-left:0;margin-right:0}.mdc-drawer--modal{box-shadow:0 8px 10px -5px rgba(0,0,0,.2),0 16px 24px 2px rgba(0,0,0,.14),0 6px 30px 5px rgba(0,0,0,.12);left:0;right:initial;display:none;position:fixed}.mdc-drawer--modal+.mdc-drawer-scrim{background-color:rgba(0,0,0,.32)}.mdc-drawer--modal[dir=rtl],[dir=rtl] .mdc-drawer--modal{left:initial;right:0}.mdc-drawer--modal.mdc-drawer--open{display:flex}.mdc-drawer-scrim{display:none;position:fixed;top:0;left:0;width:100%;height:100%;z-index:5;transition-property:opacity;transition-timing-function:cubic-bezier(.4,0,.2,1)}.mdc-drawer--open+.mdc-drawer-scrim{display:block}.mdc-drawer--animate+.mdc-drawer-scrim{opacity:0}.mdc-drawer--opening+.mdc-drawer-scrim{transition-duration:250ms;opacity:1}.mdc-drawer--closing+.mdc-drawer-scrim{transition-duration:.2s;opacity:0}.mdc-drawer-app-content{overflow:auto;flex:1}:host{display:flex;height:100%}.mdc-drawer{width:256px;width:var(--mdc-drawer-width,256px)}.mdc-drawer.mdc-drawer--open:not(.mdc-drawer--closing)+.mdc-drawer-app-content{margin-left:256px;margin-left:var(--mdc-drawer-width,256px);margin-right:0}.mdc-drawer.mdc-drawer--open:not(.mdc-drawer--closing)+.mdc-drawer-app-content[dir=rtl],[dir=rtl] .mdc-drawer.mdc-drawer--open:not(.mdc-drawer--closing)+.mdc-drawer-app-content{margin-left:0;margin-right:256px;margin-right:var(--mdc-drawer-width,256px)}`));class Pu extends Nu{}Pu.styles=Lu;var Mu={CLOSING:"mdc-dialog--closing",OPEN:"mdc-dialog--open",OPENING:"mdc-dialog--opening",SCROLLABLE:"mdc-dialog--scrollable",SCROLL_LOCK:"mdc-dialog-scroll-lock",STACKED:"mdc-dialog--stacked"},Bu={ACTION_ATTRIBUTE:"data-mdc-dialog-action",BUTTON_DEFAULT_ATTRIBUTE:"data-mdc-dialog-button-default",BUTTON_SELECTOR:".mdc-dialog__button",CLOSED_EVENT:"MDCDialog:closed",CLOSE_ACTION:"close",CLOSING_EVENT:"MDCDialog:closing",CONTAINER_SELECTOR:".mdc-dialog__container",CONTENT_SELECTOR:".mdc-dialog__content",DESTROY_ACTION:"destroy",INITIAL_FOCUS_ATTRIBUTE:"data-mdc-dialog-initial-focus",OPENED_EVENT:"MDCDialog:opened",OPENING_EVENT:"MDCDialog:opening",SCRIM_SELECTOR:".mdc-dialog__scrim",SUPPRESS_DEFAULT_PRESS_SELECTOR:["textarea",".mdc-menu .mdc-list-item"].join(", "),SURFACE_SELECTOR:".mdc-dialog__surface"},Fu={DIALOG_ANIMATION_CLOSE_TIME_MS:75,DIALOG_ANIMATION_OPEN_TIME_MS:150},Hu=function(t,e){return(Hu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var Uu=function(){return(Uu=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Vu=function(t){function e(n){var i=t.call(this,Uu(Uu({},e.defaultAdapter),n))||this;return i.isOpen_=!1,i.animationFrame_=0,i.animationTimer_=0,i.layoutFrame_=0,i.escapeKeyAction_=Bu.CLOSE_ACTION,i.scrimClickAction_=Bu.CLOSE_ACTION,i.autoStackButtons_=!0,i.areButtonsStacked_=!1,i.suppressDefaultPressSelector=Bu.SUPPRESS_DEFAULT_PRESS_SELECTOR,i}return function(t,e){function n(){this.constructor=t}Hu(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return Mu},enumerable:!0,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return Bu},enumerable:!0,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return Fu},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addBodyClass:function(){},addClass:function(){},areButtonsStacked:function(){return!1},clickDefaultButton:function(){},eventTargetMatches:function(){return!1},getActionFromEvent:function(){return""},getInitialFocusEl:function(){return null},hasClass:function(){return!1},isContentScrollable:function(){return!1},notifyClosed:function(){},notifyClosing:function(){},notifyOpened:function(){},notifyOpening:function(){},releaseFocus:function(){},removeBodyClass:function(){},removeClass:function(){},reverseButtons:function(){},trapFocus:function(){}}},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.adapter.hasClass(Mu.STACKED)&&this.setAutoStackButtons(!1)},e.prototype.destroy=function(){this.isOpen_&&this.close(Bu.DESTROY_ACTION),this.animationTimer_&&(clearTimeout(this.animationTimer_),this.handleAnimationTimerEnd_()),this.layoutFrame_&&(cancelAnimationFrame(this.layoutFrame_),this.layoutFrame_=0)},e.prototype.open=function(){var t=this;this.isOpen_=!0,this.adapter.notifyOpening(),this.adapter.addClass(Mu.OPENING),this.runNextAnimationFrame_((function(){t.adapter.addClass(Mu.OPEN),t.adapter.addBodyClass(Mu.SCROLL_LOCK),t.layout(),t.animationTimer_=setTimeout((function(){t.handleAnimationTimerEnd_(),t.adapter.trapFocus(t.adapter.getInitialFocusEl()),t.adapter.notifyOpened()}),Fu.DIALOG_ANIMATION_OPEN_TIME_MS)}))},e.prototype.close=function(t){var e=this;void 0===t&&(t=""),this.isOpen_&&(this.isOpen_=!1,this.adapter.notifyClosing(t),this.adapter.addClass(Mu.CLOSING),this.adapter.removeClass(Mu.OPEN),this.adapter.removeBodyClass(Mu.SCROLL_LOCK),cancelAnimationFrame(this.animationFrame_),this.animationFrame_=0,clearTimeout(this.animationTimer_),this.animationTimer_=setTimeout((function(){e.adapter.releaseFocus(),e.handleAnimationTimerEnd_(),e.adapter.notifyClosed(t)}),Fu.DIALOG_ANIMATION_CLOSE_TIME_MS))},e.prototype.isOpen=function(){return this.isOpen_},e.prototype.getEscapeKeyAction=function(){return this.escapeKeyAction_},e.prototype.setEscapeKeyAction=function(t){this.escapeKeyAction_=t},e.prototype.getScrimClickAction=function(){return this.scrimClickAction_},e.prototype.setScrimClickAction=function(t){this.scrimClickAction_=t},e.prototype.getAutoStackButtons=function(){return this.autoStackButtons_},e.prototype.setAutoStackButtons=function(t){this.autoStackButtons_=t},e.prototype.getSuppressDefaultPressSelector=function(){return this.suppressDefaultPressSelector},e.prototype.setSuppressDefaultPressSelector=function(t){this.suppressDefaultPressSelector=t},e.prototype.layout=function(){var t=this;this.layoutFrame_&&cancelAnimationFrame(this.layoutFrame_),this.layoutFrame_=requestAnimationFrame((function(){t.layoutInternal_(),t.layoutFrame_=0}))},e.prototype.handleClick=function(t){if(this.adapter.eventTargetMatches(t.target,Bu.SCRIM_SELECTOR)&&""!==this.scrimClickAction_)this.close(this.scrimClickAction_);else{var e=this.adapter.getActionFromEvent(t);e&&this.close(e)}},e.prototype.handleKeydown=function(t){var e="Enter"===t.key||13===t.keyCode;if(e&&!this.adapter.getActionFromEvent(t)){var n=t.composedPath?t.composedPath()[0]:t.target,i=!this.adapter.eventTargetMatches(n,this.suppressDefaultPressSelector);e&&i&&this.adapter.clickDefaultButton()}},e.prototype.handleDocumentKeydown=function(t){("Escape"===t.key||27===t.keyCode)&&""!==this.escapeKeyAction_&&this.close(this.escapeKeyAction_)},e.prototype.layoutInternal_=function(){this.autoStackButtons_&&this.detectStackedButtons_(),this.detectScrollableContent_()},e.prototype.handleAnimationTimerEnd_=function(){this.animationTimer_=0,this.adapter.removeClass(Mu.OPENING),this.adapter.removeClass(Mu.CLOSING)},e.prototype.runNextAnimationFrame_=function(t){var e=this;cancelAnimationFrame(this.animationFrame_),this.animationFrame_=requestAnimationFrame((function(){e.animationFrame_=0,clearTimeout(e.animationTimer_),e.animationTimer_=setTimeout(t,0)}))},e.prototype.detectStackedButtons_=function(){this.adapter.removeClass(Mu.STACKED);var t=this.adapter.areButtonsStacked();t&&this.adapter.addClass(Mu.STACKED),t!==this.areButtonsStacked_&&(this.adapter.reverseButtons(),this.areButtonsStacked_=t)},e.prototype.detectScrollableContent_=function(){this.adapter.removeClass(Mu.SCROLLABLE),this.adapter.isContentScrollable()&&this.adapter.addClass(Mu.SCROLLABLE)},e}(Et);function Gu(t){return void 0===t&&(t=window),!!function(t){void 0===t&&(t=window);var e=!1;try{var n={get passive(){return e=!0,!1}},i=function(){};t.document.addEventListener("test",i,n),t.document.removeEventListener("test",i,n)}catch(t){e=!1}return e}(t)&&{passive:!0}}let Wu,zu,Xu,ju,Yu=t=>t;const Ku=document.$blockingElements;class $u extends _t{constructor(){super(...arguments),this.hideActions=!1,this.stacked=!1,this.heading="",this.scrimClickAction="close",this.escapeKeyAction="close",this.open=!1,this.defaultAction="close",this.actionAttribute="dialogAction",this.initialFocusAttribute="dialogInitialFocus",this.mdcFoundationClass=Vu,this.boundLayout=null,this.boundHandleClick=null,this.boundHandleKeydown=null,this.boundHandleDocumentKeydown=null}get primaryButton(){let t=this.primarySlot.assignedNodes();t=t.filter((t=>t instanceof HTMLElement));const e=t[0];return e||null}emitNotification(t,e){const n=new CustomEvent(t,{detail:e?{action:e}:{}});this.dispatchEvent(n)}getInitialFocusEl(){const t=`[${this.initialFocusAttribute}]`,e=this.querySelector(t);if(e)return e;const n=this.primarySlot.assignedNodes({flatten:!0}),i=this.searchNodeTreesForAttribute(n,this.initialFocusAttribute);if(i)return i;const o=this.secondarySlot.assignedNodes({flatten:!0}),r=this.searchNodeTreesForAttribute(o,this.initialFocusAttribute);if(r)return r;const s=this.contentSlot.assignedNodes({flatten:!0});return this.searchNodeTreesForAttribute(s,this.initialFocusAttribute)}searchNodeTreesForAttribute(t,e){for(const n of t)if(n instanceof HTMLElement){if(n.hasAttribute(e))return n;{const t=n.querySelector(`[${e}]`);if(t)return t}}return null}createAdapter(){return Object.assign(Object.assign({},ht(this.mdcRoot)),{addBodyClass:()=>document.body.style.overflow="hidden",removeBodyClass:()=>document.body.style.overflow="",areButtonsStacked:()=>this.stacked,clickDefaultButton:()=>{const t=this.primaryButton;t&&t.click()},eventTargetMatches:(t,e)=>!!t&&ct(t,e),getActionFromEvent:t=>{if(!t.target)return"";const e=function(t,e){if(t.closest)return t.closest(e);for(var n=t;n;){if(ct(n,e))return n;n=n.parentElement}return null}(t.target,`[${this.actionAttribute}]`);return e&&e.getAttribute(this.actionAttribute)},getInitialFocusEl:()=>this.getInitialFocusEl(),isContentScrollable:()=>{const t=this.contentElement;return!!t&&t.scrollHeight>t.offsetHeight},notifyClosed:t=>this.emitNotification("closed",t),notifyClosing:t=>{this.closingDueToDisconnect||(this.open=!1),this.emitNotification("closing",t)},notifyOpened:()=>this.emitNotification("opened"),notifyOpening:()=>{this.open=!0,this.emitNotification("opening")},reverseButtons:()=>{},releaseFocus:()=>{Ku.remove(this)},trapFocus:t=>{Ku.push(this),t&&t.focus()}})}render(){const t={[Mu.STACKED]:this.stacked};let e=F(Wu||(Wu=Yu``));this.heading&&(e=this.renderHeading());const n={"mdc-dialog__actions":!this.hideActions};return F(zu||(zu=Yu` <div class="mdc-dialog ${0}" role="alertdialog" aria-modal="true" aria-labelledby="title" aria-describedby="content"> <div class="mdc-dialog__container"> <div class="mdc-dialog__surface"> ${0} <div id="content" class="mdc-dialog__content"> <slot id="contentSlot"></slot> </div> <footer id="actions" class="${0}"> <span> <slot name="secondaryAction"></slot> </span> <span> <slot name="primaryAction"></slot> </span> </footer> </div> </div> <div class="mdc-dialog__scrim"></div> </div>`),Nt(t),e,Nt(n))}renderHeading(){return F(Xu||(Xu=Yu` <h2 id="title" class="mdc-dialog__title">${0}</h2>`),this.heading)}firstUpdated(){super.firstUpdated(),this.mdcFoundation.setAutoStackButtons(!0)}connectedCallback(){super.connectedCallback(),this.open&&this.mdcFoundation&&!this.mdcFoundation.isOpen()&&(this.setEventListeners(),this.mdcFoundation.open())}disconnectedCallback(){super.disconnectedCallback(),this.open&&this.mdcFoundation&&(this.removeEventListeners(),this.closingDueToDisconnect=!0,this.mdcFoundation.close(this.currentAction||this.defaultAction),this.closingDueToDisconnect=!1,this.currentAction=void 0,Ku.remove(this))}forceLayout(){this.mdcFoundation.layout()}focus(){const t=this.getInitialFocusEl();t&&t.focus()}blur(){if(!this.shadowRoot)return;const t=this.shadowRoot.activeElement;if(t)t instanceof HTMLElement&&t.blur();else{const t=this.getRootNode(),e=t instanceof Document?t.activeElement:null;e instanceof HTMLElement&&e.blur()}}setEventListeners(){this.boundHandleClick=this.mdcFoundation.handleClick.bind(this.mdcFoundation),this.boundLayout=()=>{this.open&&this.mdcFoundation.layout.bind(this.mdcFoundation)},this.boundHandleKeydown=this.mdcFoundation.handleKeydown.bind(this.mdcFoundation),this.boundHandleDocumentKeydown=this.mdcFoundation.handleDocumentKeydown.bind(this.mdcFoundation),this.mdcRoot.addEventListener("click",this.boundHandleClick),window.addEventListener("resize",this.boundLayout,Gu()),window.addEventListener("orientationchange",this.boundLayout,Gu()),this.mdcRoot.addEventListener("keydown",this.boundHandleKeydown,Gu()),document.addEventListener("keydown",this.boundHandleDocumentKeydown,Gu())}removeEventListeners(){this.boundHandleClick&&this.mdcRoot.removeEventListener("click",this.boundHandleClick),this.boundLayout&&(window.removeEventListener("resize",this.boundLayout),window.removeEventListener("orientationchange",this.boundLayout)),this.boundHandleKeydown&&this.mdcRoot.removeEventListener("keydown",this.boundHandleKeydown),this.boundHandleDocumentKeydown&&this.mdcRoot.removeEventListener("keydown",this.boundHandleDocumentKeydown)}close(){this.open=!1}show(){this.open=!0}}t([Z(".mdc-dialog")],$u.prototype,"mdcRoot",void 0),t([Z('slot[name="primaryAction"]')],$u.prototype,"primarySlot",void 0),t([Z('slot[name="secondaryAction"]')],$u.prototype,"secondarySlot",void 0),t([Z("#contentSlot")],$u.prototype,"contentSlot",void 0),t([Z(".mdc-dialog__content")],$u.prototype,"contentElement",void 0),t([Z(".mdc-container")],$u.prototype,"conatinerElement",void 0),t([J({type:Boolean})],$u.prototype,"hideActions",void 0),t([J({type:Boolean}),vt((function(){this.forceLayout()}))],$u.prototype,"stacked",void 0),t([J({type:String})],$u.prototype,"heading",void 0),t([J({type:String}),vt((function(t){this.mdcFoundation.setScrimClickAction(t)}))],$u.prototype,"scrimClickAction",void 0),t([J({type:String}),vt((function(t){this.mdcFoundation.setEscapeKeyAction(t)}))],$u.prototype,"escapeKeyAction",void 0),t([J({type:Boolean,reflect:!0}),vt((function(t){this.mdcFoundation&&this.isConnected&&(t?(this.setEventListeners(),this.mdcFoundation.open()):(this.removeEventListeners(),this.mdcFoundation.close(this.currentAction||this.defaultAction),this.currentAction=void 0))}))],$u.prototype,"open",void 0),t([J()],$u.prototype,"defaultAction",void 0),t([J()],$u.prototype,"actionAttribute",void 0),t([J()],$u.prototype,"initialFocusAttribute",void 0);const Ju=st(ju||(ju=Yu`.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:0;opacity:var(--mdc-elevation-overlay-opacity,0);transition:opacity 280ms cubic-bezier(.4,0,.2,1);background-color:#fff;background-color:var(--mdc-elevation-overlay-color,#fff)}.mdc-dialog,.mdc-dialog__scrim{position:fixed;top:0;left:0;align-items:center;justify-content:center;box-sizing:border-box;width:100%;height:100%}.mdc-dialog{display:none;z-index:7}.mdc-dialog .mdc-dialog__surface{background-color:#fff;background-color:var(--mdc-theme-surface,#fff)}.mdc-dialog .mdc-dialog__scrim{background-color:rgba(0,0,0,.32)}.mdc-dialog .mdc-dialog__title{color:rgba(0,0,0,.87)}.mdc-dialog .mdc-dialog__content{color:rgba(0,0,0,.6)}.mdc-dialog.mdc-dialog--scrollable .mdc-dialog__actions,.mdc-dialog.mdc-dialog--scrollable .mdc-dialog__title{border-color:rgba(0,0,0,.12)}.mdc-dialog .mdc-dialog__content{padding:20px 24px 20px 24px}.mdc-dialog .mdc-dialog__surface{min-width:280px}@media(max-width:592px){.mdc-dialog .mdc-dialog__surface{max-width:calc(100vw - 32px)}}@media(min-width:592px){.mdc-dialog .mdc-dialog__surface{max-width:560px}}.mdc-dialog .mdc-dialog__surface{max-height:calc(100% - 32px)}.mdc-dialog .mdc-dialog__surface{border-radius:4px;border-radius:var(--mdc-shape-medium,4px)}.mdc-dialog__scrim{opacity:0;z-index:-1}.mdc-dialog__container{display:flex;flex-direction:row;align-items:center;justify-content:space-around;box-sizing:border-box;height:100%;transform:scale(.8);opacity:0;pointer-events:none}.mdc-dialog__surface{position:relative;box-shadow:0 11px 15px -7px rgba(0,0,0,.2),0 24px 38px 3px rgba(0,0,0,.14),0 9px 46px 8px rgba(0,0,0,.12);display:flex;flex-direction:column;flex-grow:0;flex-shrink:0;box-sizing:border-box;max-width:100%;max-height:100%;pointer-events:auto;overflow-y:auto}.mdc-dialog__surface .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}.mdc-dialog[dir=rtl] .mdc-dialog__surface,[dir=rtl] .mdc-dialog .mdc-dialog__surface{text-align:right}.mdc-dialog__title{display:block;margin-top:0;line-height:normal;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto,sans-serif;font-family:var(--mdc-typography-headline6-font-family,var(--mdc-typography-font-family,Roboto,sans-serif));font-size:1.25rem;font-size:var(--mdc-typography-headline6-font-size,1.25rem);line-height:2rem;line-height:var(--mdc-typography-headline6-line-height,2rem);font-weight:500;font-weight:var(--mdc-typography-headline6-font-weight,500);letter-spacing:.0125em;letter-spacing:var(--mdc-typography-headline6-letter-spacing,.0125em);text-decoration:inherit;text-decoration:var(--mdc-typography-headline6-text-decoration,inherit);text-transform:inherit;text-transform:var(--mdc-typography-headline6-text-transform,inherit);position:relative;flex-shrink:0;box-sizing:border-box;margin:0;padding:0 24px 9px;border-bottom:1px solid transparent}.mdc-dialog__title::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}.mdc-dialog[dir=rtl] .mdc-dialog__title,[dir=rtl] .mdc-dialog .mdc-dialog__title{text-align:right}.mdc-dialog--scrollable .mdc-dialog__title{padding-bottom:15px}.mdc-dialog__content{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto,sans-serif;font-family:var(--mdc-typography-body1-font-family,var(--mdc-typography-font-family,Roboto,sans-serif));font-size:1rem;font-size:var(--mdc-typography-body1-font-size,1rem);line-height:1.5rem;line-height:var(--mdc-typography-body1-line-height,1.5rem);font-weight:400;font-weight:var(--mdc-typography-body1-font-weight,400);letter-spacing:.03125em;letter-spacing:var(--mdc-typography-body1-letter-spacing,.03125em);text-decoration:inherit;text-decoration:var(--mdc-typography-body1-text-decoration,inherit);text-transform:inherit;text-transform:var(--mdc-typography-body1-text-transform,inherit);flex-grow:1;box-sizing:border-box;margin:0;overflow:auto;-webkit-overflow-scrolling:touch}.mdc-dialog__content>:first-child{margin-top:0}.mdc-dialog__content>:last-child{margin-bottom:0}.mdc-dialog__title+.mdc-dialog__content{padding-top:0}.mdc-dialog--scrollable .mdc-dialog__title+.mdc-dialog__content{padding-top:8px;padding-bottom:8px}.mdc-dialog__content .mdc-list:first-child:last-child{padding:6px 0 0}.mdc-dialog--scrollable .mdc-dialog__content .mdc-list:first-child:last-child{padding:0}.mdc-dialog__actions{display:flex;position:relative;flex-shrink:0;flex-wrap:wrap;align-items:center;justify-content:flex-end;box-sizing:border-box;min-height:52px;margin:0;padding:8px;border-top:1px solid transparent}.mdc-dialog--stacked .mdc-dialog__actions{flex-direction:column;align-items:flex-end}.mdc-dialog__button{margin-left:8px;margin-right:0;max-width:100%;text-align:right}.mdc-dialog__button[dir=rtl],[dir=rtl] .mdc-dialog__button{margin-left:0;margin-right:8px}.mdc-dialog__button:first-child{margin-left:0;margin-right:0}.mdc-dialog__button:first-child[dir=rtl],[dir=rtl] .mdc-dialog__button:first-child{margin-left:0;margin-right:0}.mdc-dialog[dir=rtl] .mdc-dialog__button,[dir=rtl] .mdc-dialog .mdc-dialog__button{text-align:left}.mdc-dialog--stacked .mdc-dialog__button:not(:first-child){margin-top:12px}.mdc-dialog--closing,.mdc-dialog--open,.mdc-dialog--opening{display:flex}.mdc-dialog--opening .mdc-dialog__scrim{transition:opacity 150ms linear}.mdc-dialog--opening .mdc-dialog__container{transition:opacity 75ms linear,transform 150ms 0s cubic-bezier(0,0,.2,1)}.mdc-dialog--closing .mdc-dialog__container,.mdc-dialog--closing .mdc-dialog__scrim{transition:opacity 75ms linear}.mdc-dialog--closing .mdc-dialog__container{transform:none}.mdc-dialog--open .mdc-dialog__scrim{opacity:1}.mdc-dialog--open .mdc-dialog__container{transform:none;opacity:1}.mdc-dialog-scroll-lock{overflow:hidden}#actions:not(.mdc-dialog__actions){display:none}.mdc-dialog__surface{box-shadow:var(--mdc-dialog-box-shadow,0 11px 15px -7px rgba(0,0,0,.2),0 24px 38px 3px rgba(0,0,0,.14),0 9px 46px 8px rgba(0,0,0,.12))}@media(min-width:560px){.mdc-dialog .mdc-dialog__surface{max-width:560px;max-width:var(--mdc-dialog-max-width,560px)}}.mdc-dialog .mdc-dialog__scrim{background-color:rgba(0,0,0,.32);background-color:var(--mdc-dialog-scrim-color,rgba(0,0,0,.32))}.mdc-dialog .mdc-dialog__title{color:rgba(0,0,0,.87);color:var(--mdc-dialog-heading-ink-color,rgba(0,0,0,.87))}.mdc-dialog .mdc-dialog__content{color:rgba(0,0,0,.6);color:var(--mdc-dialog-content-ink-color,rgba(0,0,0,.6))}.mdc-dialog.mdc-dialog--scrollable .mdc-dialog__actions,.mdc-dialog.mdc-dialog--scrollable .mdc-dialog__title{border-color:rgba(0,0,0,.12);border-color:var(--mdc-dialog-scroll-divider-color,rgba(0,0,0,.12))}.mdc-dialog .mdc-dialog__surface{min-width:280px;min-width:var(--mdc-dialog-min-width,280px)}.mdc-dialog .mdc-dialog__surface{max-height:var(--mdc-dialog-max-height,calc(100% - 32px))}#actions ::slotted(*){margin-left:8px;margin-right:0;max-width:100%;text-align:right}#actions ::slotted(*)[dir=rtl],[dir=rtl] #actions ::slotted(*){margin-left:0;margin-right:8px}.mdc-dialog[dir=rtl] #actions ::slotted(*),[dir=rtl] .mdc-dialog #actions ::slotted(*){text-align:left}.mdc-dialog--stacked #actions{flex-direction:column-reverse}.mdc-dialog--stacked #actions :not(:last-child) ::slotted(*){flex-basis:1e-9px;margin-top:12px}`));class qu extends $u{}qu.styles=Ju;var Zu,Qu,th={ANCHOR:"mdc-menu-surface--anchor",ANIMATING_CLOSED:"mdc-menu-surface--animating-closed",ANIMATING_OPEN:"mdc-menu-surface--animating-open",FIXED:"mdc-menu-surface--fixed",IS_OPEN_BELOW:"mdc-menu-surface--is-open-below",OPEN:"mdc-menu-surface--open",ROOT:"mdc-menu-surface"},eh={CLOSED_EVENT:"MDCMenuSurface:closed",OPENED_EVENT:"MDCMenuSurface:opened",FOCUSABLE_ELEMENTS:["button:not(:disabled)",'[href]:not([aria-disabled="true"])',"input:not(:disabled)","select:not(:disabled)","textarea:not(:disabled)",'[tabindex]:not([tabindex="-1"]):not([aria-disabled="true"])'].join(", ")},nh={TRANSITION_OPEN_DURATION:120,TRANSITION_CLOSE_DURATION:75,MARGIN_TO_EDGE:32,ANCHOR_TO_MENU_SURFACE_WIDTH_RATIO:.67};!function(t){t[t.BOTTOM=1]="BOTTOM",t[t.CENTER=2]="CENTER",t[t.RIGHT=4]="RIGHT",t[t.FLIP_RTL=8]="FLIP_RTL"}(Zu||(Zu={})),function(t){t[t.TOP_LEFT=0]="TOP_LEFT",t[t.TOP_RIGHT=4]="TOP_RIGHT",t[t.BOTTOM_LEFT=1]="BOTTOM_LEFT",t[t.BOTTOM_RIGHT=5]="BOTTOM_RIGHT",t[t.TOP_START=8]="TOP_START",t[t.TOP_END=12]="TOP_END",t[t.BOTTOM_START=9]="BOTTOM_START",t[t.BOTTOM_END=13]="BOTTOM_END"}(Qu||(Qu={}));var ih=function(t,e){return(ih=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var oh=function(){return(oh=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};var rh=function(t){function e(n){var i=t.call(this,oh(oh({},e.defaultAdapter),n))||this;return i.isSurfaceOpen=!1,i.isQuickOpen=!1,i.isHoistedElement=!1,i.isFixedPosition=!1,i.openAnimationEndTimerId=0,i.closeAnimationEndTimerId=0,i.animationRequestId=0,i.anchorCorner=Qu.TOP_START,i.originCorner=Qu.TOP_START,i.anchorMargin={top:0,right:0,bottom:0,left:0},i.position={x:0,y:0},i}return function(t,e){function n(){this.constructor=t}ih(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return th},enumerable:!0,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return eh},enumerable:!0,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return nh},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Corner",{get:function(){return Qu},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},hasAnchor:function(){return!1},isElementInContainer:function(){return!1},isFocused:function(){return!1},isRtl:function(){return!1},getInnerDimensions:function(){return{height:0,width:0}},getAnchorDimensions:function(){return null},getWindowDimensions:function(){return{height:0,width:0}},getBodyDimensions:function(){return{height:0,width:0}},getWindowScroll:function(){return{x:0,y:0}},setPosition:function(){},setMaxHeight:function(){},setTransformOrigin:function(){},saveFocus:function(){},restoreFocus:function(){},notifyClose:function(){},notifyOpen:function(){}}},enumerable:!0,configurable:!0}),e.prototype.init=function(){var t=e.cssClasses,n=t.ROOT,i=t.OPEN;if(!this.adapter.hasClass(n))throw new Error(n+" class required in root element.");this.adapter.hasClass(i)&&(this.isSurfaceOpen=!0)},e.prototype.destroy=function(){clearTimeout(this.openAnimationEndTimerId),clearTimeout(this.closeAnimationEndTimerId),cancelAnimationFrame(this.animationRequestId)},e.prototype.setAnchorCorner=function(t){this.anchorCorner=t},e.prototype.flipCornerHorizontally=function(){this.originCorner=this.originCorner^Zu.RIGHT},e.prototype.setAnchorMargin=function(t){this.anchorMargin.top=t.top||0,this.anchorMargin.right=t.right||0,this.anchorMargin.bottom=t.bottom||0,this.anchorMargin.left=t.left||0},e.prototype.setIsHoisted=function(t){this.isHoistedElement=t},e.prototype.setFixedPosition=function(t){this.isFixedPosition=t},e.prototype.setAbsolutePosition=function(t,e){this.position.x=this.isFinite(t)?t:0,this.position.y=this.isFinite(e)?e:0},e.prototype.setQuickOpen=function(t){this.isQuickOpen=t},e.prototype.isOpen=function(){return this.isSurfaceOpen},e.prototype.open=function(){var t=this;this.isSurfaceOpen||(this.adapter.saveFocus(),this.isQuickOpen?(this.isSurfaceOpen=!0,this.adapter.addClass(e.cssClasses.OPEN),this.dimensions=this.adapter.getInnerDimensions(),this.autoposition(),this.adapter.notifyOpen()):(this.adapter.addClass(e.cssClasses.ANIMATING_OPEN),this.animationRequestId=requestAnimationFrame((function(){t.adapter.addClass(e.cssClasses.OPEN),t.dimensions=t.adapter.getInnerDimensions(),t.autoposition(),t.openAnimationEndTimerId=setTimeout((function(){t.openAnimationEndTimerId=0,t.adapter.removeClass(e.cssClasses.ANIMATING_OPEN),t.adapter.notifyOpen()}),nh.TRANSITION_OPEN_DURATION)})),this.isSurfaceOpen=!0))},e.prototype.close=function(t){var n=this;void 0===t&&(t=!1),this.isSurfaceOpen&&(this.isQuickOpen?(this.isSurfaceOpen=!1,t||this.maybeRestoreFocus(),this.adapter.removeClass(e.cssClasses.OPEN),this.adapter.removeClass(e.cssClasses.IS_OPEN_BELOW),this.adapter.notifyClose()):(this.adapter.addClass(e.cssClasses.ANIMATING_CLOSED),requestAnimationFrame((function(){n.adapter.removeClass(e.cssClasses.OPEN),n.adapter.removeClass(e.cssClasses.IS_OPEN_BELOW),n.closeAnimationEndTimerId=setTimeout((function(){n.closeAnimationEndTimerId=0,n.adapter.removeClass(e.cssClasses.ANIMATING_CLOSED),n.adapter.notifyClose()}),nh.TRANSITION_CLOSE_DURATION)})),this.isSurfaceOpen=!1,t||this.maybeRestoreFocus()))},e.prototype.handleBodyClick=function(t){var e=t.target;this.adapter.isElementInContainer(e)||this.close()},e.prototype.handleKeydown=function(t){var e=t.keyCode;("Escape"===t.key||27===e)&&this.close()},e.prototype.autoposition=function(){var t;this.measurements=this.getAutoLayoutmeasurements();var n=this.getoriginCorner(),i=this.getMenuSurfaceMaxHeight(n),o=this.hasBit(n,Zu.BOTTOM)?"bottom":"top",r=this.hasBit(n,Zu.RIGHT)?"right":"left",s=this.getHorizontalOriginOffset(n),a=this.getVerticalOriginOffset(n),l=this.measurements,c=l.anchorSize,d=l.surfaceSize,u=((t={})[r]=s,t[o]=a,t);c.width/d.width>nh.ANCHOR_TO_MENU_SURFACE_WIDTH_RATIO&&(r="center"),(this.isHoistedElement||this.isFixedPosition)&&this.adjustPositionForHoistedElement(u),this.adapter.setTransformOrigin(r+" "+o),this.adapter.setPosition(u),this.adapter.setMaxHeight(i?i+"px":""),this.hasBit(n,Zu.BOTTOM)||this.adapter.addClass(e.cssClasses.IS_OPEN_BELOW)},e.prototype.getAutoLayoutmeasurements=function(){var t=this.adapter.getAnchorDimensions(),e=this.adapter.getBodyDimensions(),n=this.adapter.getWindowDimensions(),i=this.adapter.getWindowScroll();return t||(t={top:this.position.y,right:this.position.x,bottom:this.position.y,left:this.position.x,width:0,height:0}),{anchorSize:t,bodySize:e,surfaceSize:this.dimensions,viewportDistance:{top:t.top,right:n.width-t.right,bottom:n.height-t.bottom,left:t.left},viewportSize:n,windowScroll:i}},e.prototype.getoriginCorner=function(){var t,n,i=this.originCorner,o=this.measurements,r=o.viewportDistance,s=o.anchorSize,a=o.surfaceSize,l=e.numbers.MARGIN_TO_EDGE;this.hasBit(this.anchorCorner,Zu.BOTTOM)?(t=r.top-l+s.height+this.anchorMargin.bottom,n=r.bottom-l-this.anchorMargin.bottom):(t=r.top-l+this.anchorMargin.top,n=r.bottom-l+s.height-this.anchorMargin.top),!(n-a.height>0)&&t>=n&&(i=this.setBit(i,Zu.BOTTOM));var c,d,u=this.adapter.isRtl(),h=this.hasBit(this.anchorCorner,Zu.FLIP_RTL),p=this.hasBit(this.anchorCorner,Zu.RIGHT)||this.hasBit(i,Zu.RIGHT),g=!1;(g=u&&h?!p:p)?(c=r.left+s.width+this.anchorMargin.right,d=r.right-this.anchorMargin.right):(c=r.left+this.anchorMargin.left,d=r.right+s.width-this.anchorMargin.left);var f=c-a.width>0,m=d-a.width>0,_=this.hasBit(i,Zu.FLIP_RTL)&&this.hasBit(i,Zu.RIGHT);return m&&_&&u||!f&&_?i=this.unsetBit(i,Zu.RIGHT):(f&&g&&u||f&&!g&&p||!m&&c>=d)&&(i=this.setBit(i,Zu.RIGHT)),i},e.prototype.getMenuSurfaceMaxHeight=function(t){var n=this.measurements.viewportDistance,i=0,o=this.hasBit(t,Zu.BOTTOM),r=this.hasBit(this.anchorCorner,Zu.BOTTOM),s=e.numbers.MARGIN_TO_EDGE;return o?(i=n.top+this.anchorMargin.top-s,r||(i+=this.measurements.anchorSize.height)):(i=n.bottom-this.anchorMargin.bottom+this.measurements.anchorSize.height-s,r&&(i-=this.measurements.anchorSize.height)),i},e.prototype.getHorizontalOriginOffset=function(t){var e=this.measurements.anchorSize,n=this.hasBit(t,Zu.RIGHT),i=this.hasBit(this.anchorCorner,Zu.RIGHT);if(n){var o=i?e.width-this.anchorMargin.left:this.anchorMargin.right;return this.isHoistedElement||this.isFixedPosition?o-(this.measurements.viewportSize.width-this.measurements.bodySize.width):o}return i?e.width-this.anchorMargin.right:this.anchorMargin.left},e.prototype.getVerticalOriginOffset=function(t){var e=this.measurements.anchorSize,n=this.hasBit(t,Zu.BOTTOM),i=this.hasBit(this.anchorCorner,Zu.BOTTOM);return n?i?e.height-this.anchorMargin.top:-this.anchorMargin.bottom:i?e.height+this.anchorMargin.bottom:this.anchorMargin.top},e.prototype.adjustPositionForHoistedElement=function(t){var e,n,i=this.measurements,o=i.windowScroll,r=i.viewportDistance,s=Object.keys(t);try{for(var a=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(s),l=a.next();!l.done;l=a.next()){var c=l.value,d=t[c]||0;d+=r[c],this.isFixedPosition||("top"===c?d+=o.y:"bottom"===c?d-=o.y:"left"===c?d+=o.x:d-=o.x),t[c]=d}}catch(t){e={error:t}}finally{try{l&&!l.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}},e.prototype.maybeRestoreFocus=function(){var t=this.adapter.isFocused(),e=document.activeElement&&this.adapter.isElementInContainer(document.activeElement);(t||e)&&this.adapter.restoreFocus()},e.prototype.hasBit=function(t,e){return Boolean(t&e)},e.prototype.setBit=function(t,e){return t|e},e.prototype.unsetBit=function(t,e){return t^e},e.prototype.isFinite=function(t){return"number"==typeof t&&isFinite(t)},e}(Et);let sh,ah,lh=t=>t;const ch={TOP_LEFT:Qu.TOP_LEFT,TOP_RIGHT:Qu.TOP_RIGHT,BOTTOM_LEFT:Qu.BOTTOM_LEFT,BOTTOM_RIGHT:Qu.BOTTOM_RIGHT,TOP_START:Qu.TOP_START,TOP_END:Qu.TOP_END,BOTTOM_START:Qu.BOTTOM_START,BOTTOM_END:Qu.BOTTOM_END};class dh extends _t{constructor(){super(...arguments),this.mdcFoundationClass=rh,this.absolute=!1,this.fullwidth=!1,this.fixed=!1,this.x=null,this.y=null,this.quick=!1,this.open=!1,this.bitwiseCorner=Qu.TOP_START,this.previousMenuCorner=null,this.menuCorner="START",this.corner="TOP_START",this.styleTop="",this.styleLeft="",this.styleRight="",this.styleBottom="",this.styleMaxHeight="",this.styleTransformOrigin="",this.anchor=null,this.previouslyFocused=null,this.previousAnchor=null,this.onBodyClickBound=()=>{}}render(){const t={"mdc-menu-surface--fixed":this.fixed,"mdc-menu-surface--fullwidth":this.fullwidth},e={top:this.styleTop,left:this.styleLeft,right:this.styleRight,bottom:this.styleBottom,"max-height":this.styleMaxHeight,"transform-origin":this.styleTransformOrigin};return F(sh||(sh=lh` <div class="mdc-menu-surface ${0}" style="${0}" @keydown="${0}" @opened="${0}" @closed="${0}"> <slot></slot> </div>`),Nt(t),qt(e),this.onKeydown,this.registerBodyClick,this.deregisterBodyClick)}createAdapter(){return Object.assign(Object.assign({},ht(this.mdcRoot)),{hasAnchor:()=>!!this.anchor,notifyClose:()=>{const t=new CustomEvent("closed",{bubbles:!0,composed:!0});this.open=!1,this.mdcRoot.dispatchEvent(t)},notifyOpen:()=>{const t=new CustomEvent("opened",{bubbles:!0,composed:!0});this.open=!0,this.mdcRoot.dispatchEvent(t)},isElementInContainer:()=>!1,isRtl:()=>!!this.mdcRoot&&"rtl"===getComputedStyle(this.mdcRoot).direction,setTransformOrigin:t=>{this.mdcRoot&&(this.styleTransformOrigin=t)},isFocused:()=>mt(this),saveFocus:()=>{const t=ft(),e=t.length;e||(this.previouslyFocused=null),this.previouslyFocused=t[e-1]},restoreFocus:()=>{this.previouslyFocused&&"focus"in this.previouslyFocused&&this.previouslyFocused.focus()},getInnerDimensions:()=>{const t=this.mdcRoot;return t?{width:t.offsetWidth,height:t.offsetHeight}:{width:0,height:0}},getAnchorDimensions:()=>{const t=this.anchor;return t?t.getBoundingClientRect():null},getBodyDimensions:()=>({width:document.body.clientWidth,height:document.body.clientHeight}),getWindowDimensions:()=>({width:window.innerWidth,height:window.innerHeight}),getWindowScroll:()=>({x:window.pageXOffset,y:window.pageYOffset}),setPosition:t=>{this.mdcRoot&&(this.styleLeft="left"in t?`${t.left}px`:"",this.styleRight="right"in t?`${t.right}px`:"",this.styleTop="top"in t?`${t.top}px`:"",this.styleBottom="bottom"in t?`${t.bottom}px`:"")},setMaxHeight:async t=>{this.mdcRoot&&(this.styleMaxHeight=t,await this.updateComplete,this.styleMaxHeight=`var(--mdc-menu-max-height, ${t})`)}})}onKeydown(t){this.mdcFoundation&&this.mdcFoundation.handleKeydown(t)}onBodyClick(t){-1===t.composedPath().indexOf(this)&&this.close()}registerBodyClick(){this.onBodyClickBound=this.onBodyClick.bind(this),document.body.addEventListener("click",this.onBodyClickBound,{passive:!0,capture:!0})}deregisterBodyClick(){document.body.removeEventListener("click",this.onBodyClickBound,{capture:!0})}close(){this.open=!1}show(){this.open=!0}}t([Z(".mdc-menu-surface")],dh.prototype,"mdcRoot",void 0),t([Z("slot")],dh.prototype,"slotElement",void 0),t([J({type:Boolean}),vt((function(t){this.mdcFoundation&&!this.fixed&&this.mdcFoundation.setIsHoisted(t)}))],dh.prototype,"absolute",void 0),t([J({type:Boolean})],dh.prototype,"fullwidth",void 0),t([J({type:Boolean}),vt((function(t){this.mdcFoundation&&!this.absolute&&this.mdcFoundation.setIsHoisted(t)}))],dh.prototype,"fixed",void 0),t([J({type:Number}),vt((function(t){this.mdcFoundation&&null!==this.y&&null!==t&&(this.mdcFoundation.setAbsolutePosition(t,this.y),this.mdcFoundation.setAnchorMargin({left:t,top:this.y,right:-t,bottom:this.y}))}))],dh.prototype,"x",void 0),t([J({type:Number}),vt((function(t){this.mdcFoundation&&null!==this.x&&null!==t&&(this.mdcFoundation.setAbsolutePosition(this.x,t),this.mdcFoundation.setAnchorMargin({left:this.x,top:t,right:-this.x,bottom:t}))}))],dh.prototype,"y",void 0),t([J({type:Boolean}),vt((function(t){this.mdcFoundation&&this.mdcFoundation.setQuickOpen(t)}))],dh.prototype,"quick",void 0),t([J({type:Boolean,reflect:!0}),vt((function(t,e){this.mdcFoundation&&(t?this.mdcFoundation.open():void 0!==e&&this.mdcFoundation.close())}))],dh.prototype,"open",void 0),t([q(),vt((function(t){this.mdcFoundation&&this.mdcFoundation.setAnchorCorner(t)}))],dh.prototype,"bitwiseCorner",void 0),t([J({type:String}),vt((function(t){if(this.mdcFoundation){const e="START"===t||"END"===t,n=null===this.previousMenuCorner,i=!n&&t!==this.previousMenuCorner,o=n&&"END"===t;e&&(i||o)&&(this.bitwiseCorner=this.bitwiseCorner^Zu.RIGHT,this.mdcFoundation.flipCornerHorizontally(),this.previousMenuCorner=t)}}))],dh.prototype,"menuCorner",void 0),t([J({type:String}),vt((function(t){if(this.mdcFoundation&&t){let e=ch[t];"END"===this.menuCorner&&(e^=Zu.RIGHT),this.bitwiseCorner=e}}))],dh.prototype,"corner",void 0),t([q()],dh.prototype,"styleTop",void 0),t([q()],dh.prototype,"styleLeft",void 0),t([q()],dh.prototype,"styleRight",void 0),t([q()],dh.prototype,"styleBottom",void 0),t([q()],dh.prototype,"styleMaxHeight",void 0),t([q()],dh.prototype,"styleTransformOrigin",void 0);const uh=st(ah||(ah=lh`.mdc-menu-surface{display:none;position:absolute;box-sizing:border-box;max-width:calc(100vw - 32px);max-height:calc(100vh - 32px);margin:0;padding:0;transform:scale(1);transform-origin:top left;opacity:0;overflow:auto;will-change:transform,opacity;z-index:8;transition:opacity .03s linear,transform .12s cubic-bezier(0,0,.2,1),height 250ms cubic-bezier(0,0,.2,1);box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12);background-color:#fff;background-color:var(--mdc-theme-surface,#fff);color:#000;color:var(--mdc-theme-on-surface,#000);border-radius:4px;border-radius:var(--mdc-shape-medium,4px);transform-origin-left:top left;transform-origin-right:top right}.mdc-menu-surface:focus{outline:0}.mdc-menu-surface--open{display:inline-block;transform:scale(1);opacity:1}.mdc-menu-surface--animating-open{display:inline-block;transform:scale(.8);opacity:0}.mdc-menu-surface--animating-closed{display:inline-block;opacity:0;transition:opacity 75ms linear}.mdc-menu-surface[dir=rtl],[dir=rtl] .mdc-menu-surface{transform-origin-left:top right;transform-origin-right:top left}.mdc-menu-surface--anchor{position:relative;overflow:visible}.mdc-menu-surface--fixed{position:fixed}.mdc-menu-surface--fullwidth{width:100%}:host(:not([open])){display:none}.mdc-menu-surface{z-index:8;z-index:var(--mdc-menu-z-index,8);max-height:calc(100vh - 32px);max-height:var(--mdc-menu-max-height,calc(100vh - 32px))}`));class hh extends dh{}hh.styles=uh;var ph=function(t,e){return(ph=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var gh=function(){return(gh=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},fh={animation:{prefixed:"-webkit-animation",standard:"animation"},transform:{prefixed:"-webkit-transform",standard:"transform"},transition:{prefixed:"-webkit-transition",standard:"transition"}},mh={animationend:{cssProperty:"animation",prefixed:"webkitAnimationEnd",standard:"animationend"},animationiteration:{cssProperty:"animation",prefixed:"webkitAnimationIteration",standard:"animationiteration"},animationstart:{cssProperty:"animation",prefixed:"webkitAnimationStart",standard:"animationstart"},transitionend:{cssProperty:"transition",prefixed:"webkitTransitionEnd",standard:"transitionend"}};function _h(t){return Boolean(t.document)&&"function"==typeof t.document.createElement}var vh=function(){function t(t){void 0===t&&(t={}),this.adapter=t}return Object.defineProperty(t,"cssClasses",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{}},enumerable:!0,configurable:!0}),t.prototype.init=function(){},t.prototype.destroy=function(){},t}(),yh={ACTIVE:"mdc-slider--active",DISABLED:"mdc-slider--disabled",DISCRETE:"mdc-slider--discrete",FOCUS:"mdc-slider--focus",HAS_TRACK_MARKER:"mdc-slider--display-markers",IN_TRANSIT:"mdc-slider--in-transit",IS_DISCRETE:"mdc-slider--discrete",DISABLE_TOUCH_ACTION:"mdc-slider--disable-touch-action"},bh={ARIA_DISABLED:"aria-disabled",ARIA_VALUEMAX:"aria-valuemax",ARIA_VALUEMIN:"aria-valuemin",ARIA_VALUENOW:"aria-valuenow",CHANGE_EVENT:"MDCSlider:change",INPUT_EVENT:"MDCSlider:input",PIN_VALUE_MARKER_SELECTOR:".mdc-slider__pin-value-marker",STEP_DATA_ATTR:"data-step",THUMB_CONTAINER_SELECTOR:".mdc-slider__thumb-container",TRACK_MARKER_CONTAINER_SELECTOR:".mdc-slider__track-marker-container",TRACK_SELECTOR:".mdc-slider__track"},Eh={PAGE_FACTOR:4},Th="undefined"!=typeof window,Rh=Th&&!!window.PointerEvent,Ch=Rh?["pointerdown"]:["mousedown","touchstart"],xh=Rh?["pointerup"]:["mouseup","touchend"],Sh={mousedown:"mousemove",pointerdown:"pointermove",touchstart:"touchmove"},Ih="ArrowDown",Oh="ArrowLeft",kh="ArrowRight",wh="ArrowUp",Ah="End",Dh="Home",Nh="PageDown",Lh="PageUp",Ph=function(t){function e(n){var i=t.call(this,gh(gh({},e.defaultAdapter),n))||this;return i.savedTabIndex_=NaN,i.active_=!1,i.inTransit_=!1,i.isDiscrete_=!1,i.hasTrackMarker_=!1,i.handlingThumbTargetEvt_=!1,i.min_=0,i.max_=100,i.step_=0,i.value_=0,i.disabled_=!1,i.preventFocusState_=!1,i.thumbContainerPointerHandler_=function(){return i.handlingThumbTargetEvt_=!0},i.interactionStartHandler_=function(t){return i.handleDown_(t)},i.keydownHandler_=function(t){return i.handleKeydown_(t)},i.focusHandler_=function(){return i.handleFocus_()},i.blurHandler_=function(){return i.handleBlur_()},i.resizeHandler_=function(){return i.layout()},i}return function(t,e){function n(){this.constructor=t}ph(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return yh},enumerable:!0,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return bh},enumerable:!0,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return Eh},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{hasClass:function(){return!1},addClass:function(){},removeClass:function(){},getAttribute:function(){return null},setAttribute:function(){},removeAttribute:function(){},computeBoundingRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},getTabIndex:function(){return 0},registerInteractionHandler:function(){},deregisterInteractionHandler:function(){},registerThumbContainerInteractionHandler:function(){},deregisterThumbContainerInteractionHandler:function(){},registerBodyInteractionHandler:function(){},deregisterBodyInteractionHandler:function(){},registerResizeHandler:function(){},deregisterResizeHandler:function(){},notifyInput:function(){},notifyChange:function(){},setThumbContainerStyleProperty:function(){},setTrackStyleProperty:function(){},setMarkerValue:function(){},setTrackMarkers:function(){},isRTL:function(){return!1}}},enumerable:!0,configurable:!0}),e.prototype.init=function(){var t=this;this.isDiscrete_=this.adapter.hasClass(yh.IS_DISCRETE),this.hasTrackMarker_=this.adapter.hasClass(yh.HAS_TRACK_MARKER),Ch.forEach((function(e){t.adapter.registerInteractionHandler(e,t.interactionStartHandler_),t.adapter.registerThumbContainerInteractionHandler(e,t.thumbContainerPointerHandler_)})),Rh&&this.adapter.addClass(yh.DISABLE_TOUCH_ACTION),this.adapter.registerInteractionHandler("keydown",this.keydownHandler_),this.adapter.registerInteractionHandler("focus",this.focusHandler_),this.adapter.registerInteractionHandler("blur",this.blurHandler_),this.adapter.registerResizeHandler(this.resizeHandler_),this.layout(),this.isDiscrete_&&0===this.getStep()&&(this.step_=1)},e.prototype.destroy=function(){var t=this;Ch.forEach((function(e){t.adapter.deregisterInteractionHandler(e,t.interactionStartHandler_),t.adapter.deregisterThumbContainerInteractionHandler(e,t.thumbContainerPointerHandler_)})),this.adapter.deregisterInteractionHandler("keydown",this.keydownHandler_),this.adapter.deregisterInteractionHandler("focus",this.focusHandler_),this.adapter.deregisterInteractionHandler("blur",this.blurHandler_),this.adapter.deregisterResizeHandler(this.resizeHandler_)},e.prototype.setupTrackMarker=function(){this.isDiscrete_&&this.hasTrackMarker_&&0!==this.getStep()&&this.adapter.setTrackMarkers(this.getStep(),this.getMax(),this.getMin())},e.prototype.layout=function(){this.rect_=this.adapter.computeBoundingRect(),this.updateUIForCurrentValue_()},e.prototype.getValue=function(){return this.value_},e.prototype.setValue=function(t){this.setValue_(t,!1)},e.prototype.getMax=function(){return this.max_},e.prototype.setMax=function(t){if(t<this.min_)throw new Error("Cannot set max to be less than the slider's minimum value");this.max_=t,this.setValue_(this.value_,!1,!0),this.adapter.setAttribute(bh.ARIA_VALUEMAX,String(this.max_)),this.setupTrackMarker()},e.prototype.getMin=function(){return this.min_},e.prototype.setMin=function(t){if(t>this.max_)throw new Error("Cannot set min to be greater than the slider's maximum value");this.min_=t,this.setValue_(this.value_,!1,!0),this.adapter.setAttribute(bh.ARIA_VALUEMIN,String(this.min_)),this.setupTrackMarker()},e.prototype.getStep=function(){return this.step_},e.prototype.setStep=function(t){if(t<0)throw new Error("Step cannot be set to a negative number");this.isDiscrete_&&("number"!=typeof t||t<1)&&(t=1),this.step_=t,this.setValue_(this.value_,!1,!0),this.setupTrackMarker()},e.prototype.isDisabled=function(){return this.disabled_},e.prototype.setDisabled=function(t){this.disabled_=t,this.toggleClass_(yh.DISABLED,this.disabled_),this.disabled_?(this.savedTabIndex_=this.adapter.getTabIndex(),this.adapter.setAttribute(bh.ARIA_DISABLED,"true"),this.adapter.removeAttribute("tabindex")):(this.adapter.removeAttribute(bh.ARIA_DISABLED),isNaN(this.savedTabIndex_)||this.adapter.setAttribute("tabindex",String(this.savedTabIndex_)))},e.prototype.handleDown_=function(t){var e=this;if(!this.disabled_){this.preventFocusState_=!0,this.setInTransit_(!this.handlingThumbTargetEvt_),this.handlingThumbTargetEvt_=!1,this.setActive_(!0);var n=function(t){e.handleMove_(t)},i=Sh[t.type],o=function(){e.handleUp_(),e.adapter.deregisterBodyInteractionHandler(i,n),xh.forEach((function(t){return e.adapter.deregisterBodyInteractionHandler(t,o)}))};this.adapter.registerBodyInteractionHandler(i,n),xh.forEach((function(t){return e.adapter.registerBodyInteractionHandler(t,o)})),this.setValueFromEvt_(t)}},e.prototype.handleMove_=function(t){t.preventDefault(),this.setValueFromEvt_(t)},e.prototype.handleUp_=function(){this.setActive_(!1),this.adapter.notifyChange()},e.prototype.getClientX_=function(t){return t.targetTouches&&t.targetTouches.length>0?t.targetTouches[0].clientX:t.clientX},e.prototype.setValueFromEvt_=function(t){var e=this.getClientX_(t),n=this.computeValueFromClientX_(e);this.setValue_(n,!0)},e.prototype.computeValueFromClientX_=function(t){var e=this.max_,n=this.min_,i=(t-this.rect_.left)/this.rect_.width;return this.adapter.isRTL()&&(i=1-i),n+i*(e-n)},e.prototype.handleKeydown_=function(t){var e=this.getKeyId_(t),n=this.getValueForKeyId_(e);isNaN(n)||(t.preventDefault(),this.adapter.addClass(yh.FOCUS),this.setValue_(n,!0),this.adapter.notifyChange())},e.prototype.getKeyId_=function(t){return t.key===Oh||37===t.keyCode?Oh:t.key===kh||39===t.keyCode?kh:t.key===wh||38===t.keyCode?wh:t.key===Ih||40===t.keyCode?Ih:t.key===Dh||36===t.keyCode?Dh:t.key===Ah||35===t.keyCode?Ah:t.key===Lh||33===t.keyCode?Lh:t.key===Nh||34===t.keyCode?Nh:""},e.prototype.getValueForKeyId_=function(t){var e=this,n=e.max_,i=e.min_,o=e.step_||(n-i)/100;switch(this.adapter.isRTL()&&(t===Oh||t===kh)&&(o=-o),t){case Oh:case Ih:return this.value_-o;case kh:case wh:return this.value_+o;case Dh:return this.min_;case Ah:return this.max_;case Lh:return this.value_+o*Eh.PAGE_FACTOR;case Nh:return this.value_-o*Eh.PAGE_FACTOR;default:return NaN}},e.prototype.handleFocus_=function(){this.preventFocusState_||this.adapter.addClass(yh.FOCUS)},e.prototype.handleBlur_=function(){this.preventFocusState_=!1,this.adapter.removeClass(yh.FOCUS)},e.prototype.setValue_=function(t,e,n){if(void 0===n&&(n=!1),t!==this.value_||n){var i=this.min_,o=this.max_,r=t===i||t===o;this.step_&&!r&&(t=this.quantize_(t)),t<i?t=i:t>o&&(t=o),t=t||0,this.value_=t,this.adapter.setAttribute(bh.ARIA_VALUENOW,String(this.value_)),this.updateUIForCurrentValue_(),e&&(this.adapter.notifyInput(),this.isDiscrete_&&this.adapter.setMarkerValue(t))}},e.prototype.quantize_=function(t){return Math.round(t/this.step_)*this.step_},e.prototype.updateUIForCurrentValue_=function(){var t=this,e=this,n=e.max_,i=e.min_,o=(e.value_-i)/(n-i),r=o*this.rect_.width;this.adapter.isRTL()&&(r=this.rect_.width-r);var s=Th?function(t,e){if(_h(t)&&e in fh){var n=t.document.createElement("div"),i=fh[e],o=i.standard,r=i.prefixed;return o in n.style?o:r}return e}(window,"transform"):"transform",a=Th?function(t,e){if(_h(t)&&e in mh){var n=t.document.createElement("div"),i=mh[e],o=i.standard,r=i.prefixed;return i.cssProperty in n.style?o:r}return e}(window,"transitionend"):"transitionend";if(this.inTransit_){var l=function(){t.setInTransit_(!1),t.adapter.deregisterThumbContainerInteractionHandler(a,l)};this.adapter.registerThumbContainerInteractionHandler(a,l)}requestAnimationFrame((function(){t.adapter.setThumbContainerStyleProperty(s,"translateX("+r+"px) translateX(-50%)"),t.adapter.setTrackStyleProperty(s,"scaleX("+o+")")}))},e.prototype.setActive_=function(t){this.active_=t,this.toggleClass_(yh.ACTIVE,this.active_)},e.prototype.setInTransit_=function(t){this.inTransit_=t,this.toggleClass_(yh.IN_TRANSIT,this.inTransit_)},e.prototype.toggleClass_=function(t,e){e?this.adapter.addClass(t):this.adapter.removeClass(t)},e}(vh);let Mh,Bh,Fh,Hh,Uh=t=>t;class Vh extends wa{constructor(){super(...arguments),this.mdcFoundationClass=Ph,this.min=0,this.max=100,this._value=0,this.step=0,this.disabled=!1,this.pin=!1,this.markers=!1,this.pinMarkerText="",this.trackMarkerContainerStyles={},this.thumbContainerStyles={},this.trackStyles={},this.isFoundationDestroyed=!1}set value(t){this.mdcFoundation&&this.mdcFoundation.setValue(t),this._value=t,this.requestUpdate("value",t)}get value(){return this.mdcFoundation?this.mdcFoundation.getValue():this._value}render(){const t=0!==this.step,e={"mdc-slider--discrete":t,"mdc-slider--display-markers":this.markers&&t};let n="";t&&this.markers&&(n=F(Mh||(Mh=Uh` <div class="mdc-slider__track-marker-container" style="${0}"> </div>`),qt(this.trackMarkerContainerStyles)));let i="";return this.pin&&(i=F(Bh||(Bh=Uh` <div class="mdc-slider__pin"> <span class="mdc-slider__pin-value-marker">${0}</span> </div>`),this.pinMarkerText)),F(Fh||(Fh=Uh` <div class="mdc-slider ${0}" tabindex="0" role="slider" aria-valuemin="${0}" aria-valuemax="${0}" aria-valuenow="${0}" aria-disabled="${0}" data-step="${0}" @mousedown="${0}" @touchstart="${0}"> <div class="mdc-slider__track-container"> <div class="mdc-slider__track" style="${0}"> </div> ${0} </div> <div class="mdc-slider__thumb-container" style="${0}"> ${0} <svg class="mdc-slider__thumb" width="21" height="21"> <circle cx="10.5" cy="10.5" r="7.875"></circle> </svg> <div class="mdc-slider__focus-ring"></div> </div> </div>`),Nt(e),this.min,this.max,this.value,this.disabled.toString(),this.step,this.layout,this.layout,qt(this.trackStyles),n,qt(this.thumbContainerStyles),i)}connectedCallback(){super.connectedCallback(),this.mdcRoot&&this.isFoundationDestroyed&&(this.isFoundationDestroyed=!1,this.mdcFoundation.init())}updated(t){const e=t.has("min"),n=t.has("max");e&&n?this.max<this.mdcFoundation.getMin()?(this.mdcFoundation.setMin(this.min),this.mdcFoundation.setMax(this.max)):(this.mdcFoundation.setMax(this.max),this.mdcFoundation.setMin(this.min)):e?this.mdcFoundation.setMin(this.min):n&&this.mdcFoundation.setMax(this.max),super.updated(t)}disconnectedCallback(){super.disconnectedCallback(),this.isFoundationDestroyed=!0,this.mdcFoundation.destroy()}createAdapter(){return Object.assign(Object.assign({},ht(this.mdcRoot)),{getAttribute:t=>this.mdcRoot.getAttribute(t),setAttribute:(t,e)=>this.mdcRoot.setAttribute(t,e),removeAttribute:t=>this.mdcRoot.removeAttribute(t),computeBoundingRect:()=>{const t=this.mdcRoot.getBoundingClientRect();return{bottom:t.bottom,height:t.height,left:t.left+window.pageXOffset,right:t.right,top:t.top,width:t.width}},getTabIndex:()=>this.mdcRoot.tabIndex,registerInteractionHandler:(t,e)=>{const n="touchstart"===t?Gu():void 0;this.mdcRoot.addEventListener(t,e,n)},deregisterInteractionHandler:(t,e)=>this.mdcRoot.removeEventListener(t,e),registerThumbContainerInteractionHandler:(t,e)=>{const n="touchstart"===t?Gu():void 0;this.thumbContainer.addEventListener(t,e,n)},deregisterThumbContainerInteractionHandler:(t,e)=>this.thumbContainer.removeEventListener(t,e),registerBodyInteractionHandler:(t,e)=>document.body.addEventListener(t,e),deregisterBodyInteractionHandler:(t,e)=>document.body.removeEventListener(t,e),registerResizeHandler:t=>window.addEventListener("resize",t,Gu()),deregisterResizeHandler:t=>window.removeEventListener("resize",t),notifyInput:()=>{const t=this.mdcFoundation.getValue();t!==this._value&&(this.value=t,this.dispatchEvent(new CustomEvent("input",{detail:this,composed:!0,bubbles:!0,cancelable:!0})))},notifyChange:()=>{this.dispatchEvent(new CustomEvent("change",{detail:this,composed:!0,bubbles:!0,cancelable:!0}))},setThumbContainerStyleProperty:(t,e)=>{this.thumbContainerStyles[t]=e,this.requestUpdate()},setTrackStyleProperty:(t,e)=>{this.trackStyles[t]=e,this.requestUpdate()},setMarkerValue:t=>this.pinMarkerText=t.toLocaleString(),setTrackMarkers:(t,e,n)=>{const i=t.toLocaleString(),o=`linear-gradient(to right, currentColor 2px, transparent 0) ${`0 center / calc((100% - 2px) / ${`((${e.toLocaleString()} - ${n.toLocaleString()}) / ${i})`}) 100% repeat-x`}`;this.trackMarkerContainerStyles.background=o,this.requestUpdate()},isRTL:()=>"rtl"===getComputedStyle(this.mdcRoot).direction})}resetFoundation(){this.mdcFoundation&&(this.mdcFoundation.destroy(),this.mdcFoundation.init())}async firstUpdated(){await super.firstUpdated(),this.mdcFoundation.setValue(this._value)}layout(){this.mdcFoundation.layout()}}t([Z(".mdc-slider")],Vh.prototype,"mdcRoot",void 0),t([Z(".mdc-slider")],Vh.prototype,"formElement",void 0),t([Z(".mdc-slider__thumb-container")],Vh.prototype,"thumbContainer",void 0),t([Z(".mdc-slider__pin-value-marker")],Vh.prototype,"pinMarker",void 0),t([J({type:Number})],Vh.prototype,"min",void 0),t([J({type:Number})],Vh.prototype,"max",void 0),t([J({type:Number})],Vh.prototype,"value",null),t([J({type:Number}),vt((function(t,e){0!==e!==(0!==t)&&this.resetFoundation(),this.mdcFoundation.setStep(t)}))],Vh.prototype,"step",void 0),t([J({type:Boolean,reflect:!0}),vt((function(t){this.mdcFoundation.setDisabled(t)}))],Vh.prototype,"disabled",void 0),t([J({type:Boolean,reflect:!0})],Vh.prototype,"pin",void 0),t([J({type:Boolean,reflect:!0}),vt((function(){this.mdcFoundation.setupTrackMarker()}))],Vh.prototype,"markers",void 0),t([J({type:String})],Vh.prototype,"pinMarkerText",void 0),t([J({type:Object})],Vh.prototype,"trackMarkerContainerStyles",void 0),t([J({type:Object})],Vh.prototype,"thumbContainerStyles",void 0),t([J({type:Object})],Vh.prototype,"trackStyles",void 0),t([nt({capture:!0,passive:!0})],Vh.prototype,"layout",null);const Gh=st(Hh||(Hh=Uh`@keyframes mdc-slider-emphasize{0%{animation-timing-function:ease-out}50%{animation-timing-function:ease-in;transform:scale(.85)}100%{transform:scale(.571)}}.mdc-slider{position:relative;width:100%;height:48px;cursor:pointer;touch-action:pan-x;-webkit-tap-highlight-color:transparent}.mdc-slider:not(.mdc-slider--disabled) .mdc-slider__track{background-color:#018786;background-color:var(--mdc-theme-secondary,#018786)}.mdc-slider:not(.mdc-slider--disabled) .mdc-slider__track-container::after{background-color:#018786;background-color:var(--mdc-theme-secondary,#018786);opacity:.26}.mdc-slider:not(.mdc-slider--disabled) .mdc-slider__track-marker-container{background-color:#018786;background-color:var(--mdc-theme-secondary,#018786)}.mdc-slider:not(.mdc-slider--disabled) .mdc-slider__thumb{fill:#018786;fill:var(--mdc-theme-secondary,#018786);stroke:#018786;stroke:var(--mdc-theme-secondary,#018786)}.mdc-slider:not(.mdc-slider--disabled) .mdc-slider__focus-ring{background-color:#018786;background-color:var(--mdc-theme-secondary,#018786)}.mdc-slider:not(.mdc-slider--disabled) .mdc-slider__pin{background-color:#018786;background-color:var(--mdc-theme-secondary,#018786)}.mdc-slider:not(.mdc-slider--disabled) .mdc-slider__pin{color:#fff;color:var(--mdc-theme-text-primary-on-dark,#fff)}.mdc-slider--disable-touch-action{touch-action:none}.mdc-slider--disabled{cursor:auto}.mdc-slider--disabled .mdc-slider__track{background-color:#9a9a9a}.mdc-slider--disabled .mdc-slider__track-container::after{background-color:#9a9a9a;opacity:.26}.mdc-slider--disabled .mdc-slider__track-marker-container{background-color:#9a9a9a}.mdc-slider--disabled .mdc-slider__thumb{fill:#9a9a9a;stroke:#9a9a9a}.mdc-slider--disabled .mdc-slider__thumb{stroke:#fff;stroke:var(--mdc-slider-bg-color-behind-component,#fff)}.mdc-slider:focus{outline:0}.mdc-slider__track-container{position:absolute;top:50%;width:100%;height:2px;overflow:hidden}.mdc-slider__track-container::after{position:absolute;top:0;left:0;display:block;width:100%;height:100%;content:""}.mdc-slider__track{position:absolute;width:100%;height:100%;transform-origin:left top;will-change:transform}.mdc-slider[dir=rtl] .mdc-slider__track,[dir=rtl] .mdc-slider .mdc-slider__track{transform-origin:right top}.mdc-slider__track-marker-container{display:flex;margin-right:0;margin-left:-1px;visibility:hidden}.mdc-slider[dir=rtl] .mdc-slider__track-marker-container,[dir=rtl] .mdc-slider .mdc-slider__track-marker-container{margin-right:-1px;margin-left:0}.mdc-slider__track-marker-container::after{display:block;width:2px;height:2px;content:""}.mdc-slider__track-marker{flex:1}.mdc-slider__track-marker::after{display:block;width:2px;height:2px;content:""}.mdc-slider__track-marker:first-child::after{width:3px}.mdc-slider__thumb-container{position:absolute;top:15px;left:0;width:21px;height:100%;user-select:none;will-change:transform}.mdc-slider__thumb{position:absolute;top:0;left:0;transform:scale(.571);stroke-width:3.5;transition:transform .1s ease-out,fill .1s ease-out,stroke .1s ease-out}.mdc-slider__focus-ring{width:21px;height:21px;border-radius:50%;opacity:0;transition:transform .266s ease-out,opacity .266s ease-out,background-color .266s ease-out}.mdc-slider__pin{display:flex;position:absolute;top:0;left:0;align-items:center;justify-content:center;width:26px;height:26px;margin-top:-2px;margin-left:-2px;transform:rotate(-45deg) scale(0) translate(0,0);border-radius:50% 50% 50% 0;z-index:1;transition:transform .1s ease-out}.mdc-slider__pin-value-marker{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto,sans-serif;font-family:var(--mdc-typography-body2-font-family,var(--mdc-typography-font-family,Roboto,sans-serif));font-size:.875rem;font-size:var(--mdc-typography-body2-font-size,.875rem);line-height:1.25rem;line-height:var(--mdc-typography-body2-line-height,1.25rem);font-weight:400;font-weight:var(--mdc-typography-body2-font-weight,400);letter-spacing:.0178571429em;letter-spacing:var(--mdc-typography-body2-letter-spacing,.0178571429em);text-decoration:inherit;text-decoration:var(--mdc-typography-body2-text-decoration,inherit);text-transform:inherit;text-transform:var(--mdc-typography-body2-text-transform,inherit);transform:rotate(45deg)}.mdc-slider--active .mdc-slider__thumb{transform:scale3d(1,1,1)}.mdc-slider--focus .mdc-slider__thumb{animation:mdc-slider-emphasize .266s linear}.mdc-slider--focus .mdc-slider__focus-ring{transform:scale3d(1.55,1.55,1.55);opacity:.25}.mdc-slider--in-transit .mdc-slider__thumb{transition-delay:140ms}.mdc-slider--in-transit .mdc-slider__thumb-container,.mdc-slider--in-transit .mdc-slider__track,.mdc-slider:focus:not(.mdc-slider--active) .mdc-slider__thumb-container,.mdc-slider:focus:not(.mdc-slider--active) .mdc-slider__track{transition:transform 80ms ease}.mdc-slider--discrete.mdc-slider--active .mdc-slider__thumb{transform:scale(calc(12 / 21))}.mdc-slider--discrete.mdc-slider--active .mdc-slider__pin{transform:rotate(-45deg) scale(1) translate(19px,-20px)}.mdc-slider--discrete.mdc-slider--focus .mdc-slider__thumb{animation:none}.mdc-slider--discrete.mdc-slider--display-markers .mdc-slider__track-marker-container{visibility:visible}:host{display:inline-block;min-width:120px;outline:0}`));class Wh extends Vh{}Wh.styles=Gh;var zh=function(t,e){return(zh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var Xh=function(){return(Xh=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},jh={CHECKED:"mdc-switch--checked",DISABLED:"mdc-switch--disabled"},Yh={ARIA_CHECKED_ATTR:"aria-checked",NATIVE_CONTROL_SELECTOR:".mdc-switch__native-control",RIPPLE_SURFACE_SELECTOR:".mdc-switch__thumb-underlay"},Kh=function(t){function e(n){return t.call(this,Xh(Xh({},e.defaultAdapter),n))||this}return function(t,e){function n(){this.constructor=t}zh(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),Object.defineProperty(e,"strings",{get:function(){return Yh},enumerable:!0,configurable:!0}),Object.defineProperty(e,"cssClasses",{get:function(){return jh},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},setNativeControlChecked:function(){},setNativeControlDisabled:function(){},setNativeControlAttr:function(){}}},enumerable:!0,configurable:!0}),e.prototype.setChecked=function(t){this.adapter.setNativeControlChecked(t),this.updateAriaChecked_(t),this.updateCheckedStyling_(t)},e.prototype.setDisabled=function(t){this.adapter.setNativeControlDisabled(t),t?this.adapter.addClass(jh.DISABLED):this.adapter.removeClass(jh.DISABLED)},e.prototype.handleChange=function(t){var e=t.target;this.updateAriaChecked_(e.checked),this.updateCheckedStyling_(e.checked)},e.prototype.updateCheckedStyling_=function(t){t?this.adapter.addClass(jh.CHECKED):this.adapter.removeClass(jh.CHECKED)},e.prototype.updateAriaChecked_=function(t){this.adapter.setNativeControlAttr(Yh.ARIA_CHECKED_ATTR,""+!!t)},e}(Et);let $h,Jh,qh,Zh=t=>t;class Qh extends wa{constructor(){super(...arguments),this.checked=!1,this.disabled=!1,this.shouldRenderRipple=!1,this.mdcFoundationClass=Kh,this.rippleHandlers=new ae((()=>(this.shouldRenderRipple=!0,this.ripple)))}changeHandler(t){this.mdcFoundation.handleChange(t),this.checked=this.formElement.checked}createAdapter(){return Object.assign(Object.assign({},ht(this.mdcRoot)),{setNativeControlChecked:t=>{this.formElement.checked=t},setNativeControlDisabled:t=>{this.formElement.disabled=t},setNativeControlAttr:(t,e)=>{this.formElement.setAttribute(t,e)}})}renderRipple(){return this.shouldRenderRipple?F($h||($h=Zh` <mwc-ripple .accent="${0}" .disabled="${0}" unbounded> </mwc-ripple>`),this.checked,this.disabled):""}focus(){const t=this.formElement;t&&(this.rippleHandlers.startFocus(),t.focus())}blur(){const t=this.formElement;t&&(this.rippleHandlers.endFocus(),t.blur())}render(){return F(Jh||(Jh=Zh` <div class="mdc-switch"> <div class="mdc-switch__track"></div> <div class="mdc-switch__thumb-underlay"> ${0} <div class="mdc-switch__thumb"> <input type="checkbox" id="basic-switch" class="mdc-switch__native-control" role="switch" @change="${0}" @focus="${0}" @blur="${0}" @mousedown="${0}" @mouseenter="${0}" @mouseleave="${0}" @touchstart="${0}" @touchend="${0}" @touchcancel="${0}"> </div> </div> </div>`),this.renderRipple(),this.changeHandler,this.handleRippleFocus,this.handleRippleBlur,this.handleRippleMouseDown,this.handleRippleMouseEnter,this.handleRippleMouseLeave,this.handleRippleTouchStart,this.handleRippleDeactivate,this.handleRippleDeactivate)}handleRippleMouseDown(t){const e=()=>{window.removeEventListener("mouseup",e),this.handleRippleDeactivate()};window.addEventListener("mouseup",e),this.rippleHandlers.startPress(t)}handleRippleTouchStart(t){this.rippleHandlers.startPress(t)}handleRippleDeactivate(){this.rippleHandlers.endPress()}handleRippleMouseEnter(){this.rippleHandlers.startHover()}handleRippleMouseLeave(){this.rippleHandlers.endHover()}handleRippleFocus(){this.rippleHandlers.startFocus()}handleRippleBlur(){this.rippleHandlers.endFocus()}}t([J({type:Boolean}),vt((function(t){this.mdcFoundation.setChecked(t)}))],Qh.prototype,"checked",void 0),t([J({type:Boolean}),vt((function(t){this.mdcFoundation.setDisabled(t)}))],Qh.prototype,"disabled",void 0),t([Z(".mdc-switch")],Qh.prototype,"mdcRoot",void 0),t([Z("input")],Qh.prototype,"formElement",void 0),t([Q("mwc-ripple")],Qh.prototype,"ripple",void 0),t([q()],Qh.prototype,"shouldRenderRipple",void 0),t([nt({passive:!0})],Qh.prototype,"handleRippleMouseDown",null),t([nt({passive:!0})],Qh.prototype,"handleRippleTouchStart",null);const tp=st(qh||(qh=Zh`.mdc-switch__thumb-underlay{left:-14px;right:initial;top:-17px;width:48px;height:48px}.mdc-switch__thumb-underlay[dir=rtl],[dir=rtl] .mdc-switch__thumb-underlay{left:initial;right:-14px}.mdc-switch__native-control{width:64px;height:48px}.mdc-switch{display:inline-block;position:relative;outline:0;user-select:none}.mdc-switch.mdc-switch--checked .mdc-switch__track{background-color:#018786;background-color:var(--mdc-theme-secondary,#018786)}.mdc-switch.mdc-switch--checked .mdc-switch__thumb{background-color:#018786;background-color:var(--mdc-theme-secondary,#018786);border-color:#018786;border-color:var(--mdc-theme-secondary,#018786)}.mdc-switch:not(.mdc-switch--checked) .mdc-switch__track{background-color:#000;background-color:var(--mdc-theme-on-surface,#000)}.mdc-switch:not(.mdc-switch--checked) .mdc-switch__thumb{background-color:#fff;background-color:var(--mdc-theme-surface,#fff);border-color:#fff;border-color:var(--mdc-theme-surface,#fff)}.mdc-switch__native-control{left:0;right:initial;position:absolute;top:0;margin:0;opacity:0;cursor:pointer;pointer-events:auto;transition:transform 90ms cubic-bezier(.4,0,.2,1)}.mdc-switch__native-control[dir=rtl],[dir=rtl] .mdc-switch__native-control{left:initial;right:0}.mdc-switch__track{box-sizing:border-box;width:36px;height:14px;border:1px solid transparent;border-radius:7px;opacity:.38;transition:opacity 90ms cubic-bezier(.4,0,.2,1),background-color 90ms cubic-bezier(.4,0,.2,1),border-color 90ms cubic-bezier(.4,0,.2,1)}.mdc-switch__thumb-underlay{display:flex;position:absolute;align-items:center;justify-content:center;transform:translateX(0);transition:transform 90ms cubic-bezier(.4,0,.2,1),background-color 90ms cubic-bezier(.4,0,.2,1),border-color 90ms cubic-bezier(.4,0,.2,1)}.mdc-switch__thumb{box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);box-sizing:border-box;width:20px;height:20px;border:10px solid;border-radius:50%;pointer-events:none;z-index:1}.mdc-switch--checked .mdc-switch__track{opacity:.54}.mdc-switch--checked .mdc-switch__thumb-underlay{transform:translateX(16px)}.mdc-switch--checked .mdc-switch__thumb-underlay[dir=rtl],[dir=rtl] .mdc-switch--checked .mdc-switch__thumb-underlay{transform:translateX(-16px)}.mdc-switch--checked .mdc-switch__native-control{transform:translateX(-16px)}.mdc-switch--checked .mdc-switch__native-control[dir=rtl],[dir=rtl] .mdc-switch--checked .mdc-switch__native-control{transform:translateX(16px)}.mdc-switch--disabled{opacity:.38;pointer-events:none}.mdc-switch--disabled .mdc-switch__thumb{border-width:1px}.mdc-switch--disabled .mdc-switch__native-control{cursor:default;pointer-events:none}:host{display:inline-flex;outline:0;-webkit-tap-highlight-color:transparent}`));class ep extends(Le(Qh)){static get scopedElements(){return{"mwc-ripple":$e}}}ep.styles=tp;let np,ip,op=t=>t;class rp extends lt{constructor(){super(...arguments),this.indeterminate=!1,this.progress=0,this.buffer=1,this.reverse=!1,this.closed=!1,this.ariaLabel="",this.stylePrimaryHalf="",this.stylePrimaryFull="",this.styleSecondaryQuarter="",this.styleSecondaryHalf="",this.styleSecondaryFull="",this.animationReady=!0,this.closedAnimationOff=!1,this.resizeObserver=null}connectedCallback(){super.connectedCallback(),this.rootEl&&this.attachResizeObserver()}render(){const t={"mdc-linear-progress--closed":this.closed,"mdc-linear-progress--closed-animation-off":this.closedAnimationOff,"mdc-linear-progress--indeterminate":this.indeterminate,"mdc-linear-progress--reversed":this.reverse,"mdc-linear-progress--animation-ready":this.animationReady},e={"--mdc-linear-progress-primary-half":this.stylePrimaryHalf,"--mdc-linear-progress-primary-half-neg":""!==this.stylePrimaryHalf?`-${this.stylePrimaryHalf}`:"","--mdc-linear-progress-primary-full":this.stylePrimaryFull,"--mdc-linear-progress-primary-full-neg":""!==this.stylePrimaryFull?`-${this.stylePrimaryFull}`:"","--mdc-linear-progress-secondary-quarter":this.styleSecondaryQuarter,"--mdc-linear-progress-secondary-quarter-neg":""!==this.styleSecondaryQuarter?`-${this.styleSecondaryQuarter}`:"","--mdc-linear-progress-secondary-half":this.styleSecondaryHalf,"--mdc-linear-progress-secondary-half-neg":""!==this.styleSecondaryHalf?`-${this.styleSecondaryHalf}`:"","--mdc-linear-progress-secondary-full":this.styleSecondaryFull,"--mdc-linear-progress-secondary-full-neg":""!==this.styleSecondaryFull?`-${this.styleSecondaryFull}`:""},n={"flex-basis":this.indeterminate?"100%":100*this.buffer+"%"},i={transform:this.indeterminate?"scaleX(1)":`scaleX(${this.progress})`};return F(np||(np=op` <div role="progressbar" class="mdc-linear-progress ${0}" style="${0}" aria-label="${0}" aria-valuemin="0" aria-valuemax="1" aria-valuenow="${0}" @transitionend="${0}"> <div class="mdc-linear-progress__buffer"> <div class="mdc-linear-progress__buffer-bar" style="${0}"> </div> <div class="mdc-linear-progress__buffer-dots"></div> </div> <div class="mdc-linear-progress__bar mdc-linear-progress__primary-bar" style="${0}"> <span class="mdc-linear-progress__bar-inner"></span> </div> <div class="mdc-linear-progress__bar mdc-linear-progress__secondary-bar"> <span class="mdc-linear-progress__bar-inner"></span> </div> </div>`),Nt(t),qt(e),$t(this.ariaLabel?this.ariaLabel:void 0),$t(this.indeterminate?void 0:this.progress),this.syncClosedState,qt(n),qt(i))}update(t){!t.has("closed")||this.closed&&void 0!==t.get("closed")||this.syncClosedState(),super.update(t)}async firstUpdated(t){super.firstUpdated(t),this.attachResizeObserver()}syncClosedState(){this.closedAnimationOff=this.closed}updated(t){!t.has("indeterminate")&&t.has("reverse")&&this.indeterminate&&this.restartAnimation(),t.has("indeterminate")&&void 0!==t.get("indeterminate")&&this.indeterminate&&window.ResizeObserver&&this.calculateAndSetAnimationDimensions(this.rootEl.offsetWidth),super.updated(t)}disconnectedCallback(){this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),super.disconnectedCallback()}attachResizeObserver(){if(window.ResizeObserver)return this.resizeObserver=new ResizeObserver((t=>{if(this.indeterminate)for(const e of t)if(e.contentRect){const t=e.contentRect.width;this.calculateAndSetAnimationDimensions(t)}})),void this.resizeObserver.observe(this.rootEl);this.resizeObserver=null}calculateAndSetAnimationDimensions(t){const e=.8367142*t,n=2.00611057*t,i=.37651913*t,o=.84386165*t,r=1.60277782*t;this.stylePrimaryHalf=`${e}px`,this.stylePrimaryFull=`${n}px`,this.styleSecondaryQuarter=`${i}px`,this.styleSecondaryHalf=`${o}px`,this.styleSecondaryFull=`${r}px`,this.restartAnimation()}async restartAnimation(){this.animationReady=!1,await this.updateComplete,await new Promise(requestAnimationFrame),this.animationReady=!0,await this.updateComplete}open(){this.closed=!1}close(){this.closed=!0}}t([Z(".mdc-linear-progress")],rp.prototype,"rootEl",void 0),t([J({type:Boolean,reflect:!0})],rp.prototype,"indeterminate",void 0),t([J({type:Number})],rp.prototype,"progress",void 0),t([J({type:Number})],rp.prototype,"buffer",void 0),t([J({type:Boolean,reflect:!0})],rp.prototype,"reverse",void 0),t([J({type:Boolean,reflect:!0})],rp.prototype,"closed",void 0),t([J()],rp.prototype,"ariaLabel",void 0),t([q()],rp.prototype,"stylePrimaryHalf",void 0),t([q()],rp.prototype,"stylePrimaryFull",void 0),t([q()],rp.prototype,"styleSecondaryQuarter",void 0),t([q()],rp.prototype,"styleSecondaryHalf",void 0),t([q()],rp.prototype,"styleSecondaryFull",void 0),t([q()],rp.prototype,"animationReady",void 0),t([q()],rp.prototype,"closedAnimationOff",void 0);const sp=st(ip||(ip=op`@keyframes mdc-linear-progress-primary-indeterminate-translate{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(.5,0,.701732,.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(.302435,.381352,.55,.956352);transform:translateX(83.67142%);transform:translateX(var(--mdc-linear-progress-primary-half,83.67142%))}100%{transform:translateX(200.611057%);transform:translateX(var(--mdc-linear-progress-primary-full,200.611057%))}}@keyframes mdc-linear-progress-primary-indeterminate-scale{0%{transform:scaleX(.08)}36.65%{animation-timing-function:cubic-bezier(.334731,.12482,.785844,1);transform:scaleX(.08)}69.15%{animation-timing-function:cubic-bezier(.06,.11,.6,1);transform:scaleX(.661479)}100%{transform:scaleX(.08)}}@keyframes mdc-linear-progress-secondary-indeterminate-translate{0%{animation-timing-function:cubic-bezier(.15,0,.515058,.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(.31033,.284058,.8,.733712);transform:translateX(37.651913%);transform:translateX(var(--mdc-linear-progress-secondary-quarter,37.651913%))}48.35%{animation-timing-function:cubic-bezier(.4,.627035,.6,.902026);transform:translateX(84.386165%);transform:translateX(var(--mdc-linear-progress-secondary-half,84.386165%))}100%{transform:translateX(160.277782%);transform:translateX(var(--mdc-linear-progress-secondary-full,160.277782%))}}@keyframes mdc-linear-progress-secondary-indeterminate-scale{0%{animation-timing-function:cubic-bezier(.205028,.057051,.57661,.453971);transform:scaleX(.08)}19.15%{animation-timing-function:cubic-bezier(.152313,.196432,.648374,1.004315);transform:scaleX(.457104)}44.15%{animation-timing-function:cubic-bezier(.257759,-.003163,.211762,1.38179);transform:scaleX(.72796)}100%{transform:scaleX(.08)}}@keyframes mdc-linear-progress-buffering{from{transform:rotate(180deg) translateX(-10px)}}@keyframes mdc-linear-progress-primary-indeterminate-translate-reverse{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(.5,0,.701732,.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(.302435,.381352,.55,.956352);transform:translateX(-83.67142%);transform:translateX(var(--mdc-linear-progress-primary-half-neg,-83.67142%))}100%{transform:translateX(-200.611057%);transform:translateX(var(--mdc-linear-progress-primary-full-neg,-200.611057%))}}@keyframes mdc-linear-progress-secondary-indeterminate-translate-reverse{0%{animation-timing-function:cubic-bezier(.15,0,.515058,.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(.31033,.284058,.8,.733712);transform:translateX(-37.651913%);transform:translateX(var(--mdc-linear-progress-secondary-quarter-neg,-37.651913%))}48.35%{animation-timing-function:cubic-bezier(.4,.627035,.6,.902026);transform:translateX(-84.386165%);transform:translateX(var(--mdc-linear-progress-secondary-half-neg,-84.386165%))}100%{transform:translateX(-160.277782%);transform:translateX(var(--mdc-linear-progress-secondary-full-neg,-160.277782%))}}@keyframes mdc-linear-progress-buffering-reverse{from{transform:translateX(-10px)}}.mdc-linear-progress{position:relative;width:100%;height:4px;transform:translateZ(0);outline:1px solid transparent;overflow:hidden;transition:opacity 250ms 0s cubic-bezier(.4,0,.6,1)}.mdc-linear-progress__bar{position:absolute;width:100%;height:100%;animation:none;transform-origin:top left;transition:transform 250ms 0s cubic-bezier(.4,0,.6,1)}.mdc-linear-progress__bar-inner{display:inline-block;position:absolute;width:100%;animation:none;border-top:4px solid}.mdc-linear-progress__buffer{display:flex;position:absolute;width:100%;height:100%}.mdc-linear-progress__buffer-dots{background-repeat:repeat-x;background-size:10px 4px;flex:auto;transform:rotate(180deg);animation:mdc-linear-progress-buffering 250ms infinite linear}.mdc-linear-progress__buffer-bar{flex:0 1 100%;transition:flex-basis 250ms 0s cubic-bezier(.4,0,.6,1)}.mdc-linear-progress__primary-bar{transform:scaleX(0)}.mdc-linear-progress__secondary-bar{visibility:hidden}.mdc-linear-progress--indeterminate .mdc-linear-progress__bar{transition:none}.mdc-linear-progress--indeterminate .mdc-linear-progress__primary-bar{left:-145.166611%}.mdc-linear-progress--indeterminate .mdc-linear-progress__secondary-bar{left:-54.888891%;visibility:visible}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar{animation:mdc-linear-progress-primary-indeterminate-translate 2s infinite linear}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar>.mdc-linear-progress__bar-inner{animation:mdc-linear-progress-primary-indeterminate-scale 2s infinite linear}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar{animation:mdc-linear-progress-secondary-indeterminate-translate 2s infinite linear}.mdc-linear-progress--indeterminate.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar>.mdc-linear-progress__bar-inner{animation:mdc-linear-progress-secondary-indeterminate-scale 2s infinite linear}.mdc-linear-progress--reversed .mdc-linear-progress__bar{right:0;transform-origin:center right}.mdc-linear-progress--reversed.mdc-linear-progress--animation-ready .mdc-linear-progress__primary-bar{animation-name:mdc-linear-progress-primary-indeterminate-translate-reverse}.mdc-linear-progress--reversed.mdc-linear-progress--animation-ready .mdc-linear-progress__secondary-bar{animation-name:mdc-linear-progress-secondary-indeterminate-translate-reverse}.mdc-linear-progress--reversed .mdc-linear-progress__buffer-dots{animation:mdc-linear-progress-buffering-reverse 250ms infinite linear;order:0;transform:rotate(0)}.mdc-linear-progress--reversed .mdc-linear-progress__buffer-bar{order:1}.mdc-linear-progress--closed{opacity:0}.mdc-linear-progress--closed-animation-off .mdc-linear-progress__buffer-dots{animation:none}.mdc-linear-progress--closed-animation-off.mdc-linear-progress--indeterminate .mdc-linear-progress__bar,.mdc-linear-progress--closed-animation-off.mdc-linear-progress--indeterminate .mdc-linear-progress__bar .mdc-linear-progress__bar-inner{animation:none}.mdc-linear-progress__bar-inner{border-color:#6200ee;border-color:var(--mdc-theme-primary,#6200ee)}.mdc-linear-progress__buffer-dots{background-image:url("data:image/svg+xml,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' enable-background='new 0 0 5 2' xml:space='preserve' viewBox='0 0 5 2' preserveAspectRatio='none slice'%3E%3Ccircle cx='1' cy='1' r='1' fill='%23e6e6e6'/%3E%3C/svg%3E")}.mdc-linear-progress__buffer-bar{background-color:#e6e6e6}.mdc-linear-progress--indeterminate.mdc-linear-progress--reversed .mdc-linear-progress__primary-bar{right:-145.166611%;left:auto}.mdc-linear-progress--indeterminate.mdc-linear-progress--reversed .mdc-linear-progress__secondary-bar{right:-54.888891%;left:auto}:host{display:block}.mdc-linear-progress__buffer-bar{background-color:#e6e6e6;background-color:var(--mdc-linear-progress-buffer-color,#e6e6e6)}.mdc-linear-progress__buffer-dots{background-image:url("data:image/svg+xml,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' enable-background='new 0 0 5 2' xml:space='preserve' viewBox='0 0 5 2' preserveAspectRatio='none slice'%3E%3Ccircle cx='1' cy='1' r='1' fill='%23e6e6e6'/%3E%3C/svg%3E");background-image:var(--mdc-linear-progress-buffering-dots-image, url("data:image/svg+xml,%3Csvg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' enable-background='new 0 0 5 2' xml:space='preserve' viewBox='0 0 5 2' preserveAspectRatio='none slice'%3E%3Ccircle cx='1' cy='1' r='1' fill='%23e6e6e6'/%3E%3C/svg%3E"))}`));class ap extends rp{}ap.styles=[sp];var lp=function(t,e){return(lp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var cp=function(){return(cp=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},dp={ROOT:"mdc-form-field"},up={LABEL_SELECTOR:".mdc-form-field > label"},hp=function(t){function e(n){var i=t.call(this,cp(cp({},e.defaultAdapter),n))||this;return i.click=function(){i.handleClick()},i}return function(t,e){function n(){this.constructor=t}lp(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return dp},enumerable:!0,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return up},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{activateInputRipple:function(){},deactivateInputRipple:function(){},deregisterInteractionHandler:function(){},registerInteractionHandler:function(){}}},enumerable:!0,configurable:!0}),e.prototype.init=function(){this.adapter.registerInteractionHandler("click",this.click)},e.prototype.destroy=function(){this.adapter.deregisterInteractionHandler("click",this.click)},e.prototype.handleClick=function(){var t=this;this.adapter.activateInputRipple(),requestAnimationFrame((function(){t.adapter.deactivateInputRipple()}))},e}(Et);let pp,gp=t=>t;class fp extends _t{constructor(){super(...arguments),this.alignEnd=!1,this.spaceBetween=!1,this.nowrap=!1,this.label="",this.mdcFoundationClass=hp}createAdapter(){return{registerInteractionHandler:(t,e)=>{this.labelEl.addEventListener(t,e)},deregisterInteractionHandler:(t,e)=>{this.labelEl.removeEventListener(t,e)},activateInputRipple:async()=>{const t=this.input;if(t instanceof wa){const e=await t.ripple;e&&e.startPress()}},deactivateInputRipple:async()=>{const t=this.input;if(t instanceof wa){const e=await t.ripple;e&&e.endPress()}}}}get input(){return ut(this.slotEl,"*")}render(){const t={"mdc-form-field--align-end":this.alignEnd,"mdc-form-field--space-between":this.spaceBetween,"mdc-form-field--nowrap":this.nowrap};return F(pp||(pp=gp` <div class="mdc-form-field ${0}"> <slot></slot> <label class="mdc-label" @click="${0}">${0}</label> </div>`),Nt(t),this._labelClick,this.label)}_labelClick(){const t=this.input;t&&(t.focus(),t.click())}}t([J({type:Boolean})],fp.prototype,"alignEnd",void 0),t([J({type:Boolean})],fp.prototype,"spaceBetween",void 0),t([J({type:Boolean})],fp.prototype,"nowrap",void 0),t([J({type:String}),vt((async function(t){const e=this.input;e&&("input"===e.localName?e.setAttribute("aria-label",t):e instanceof wa&&(await e.updateComplete,e.setAriaLabel(t)))}))],fp.prototype,"label",void 0),t([Z(".mdc-form-field")],fp.prototype,"mdcRoot",void 0),t([Z("slot")],fp.prototype,"slotEl",void 0),t([Z("label")],fp.prototype,"labelEl",void 0);let mp;const _p=st(mp||(mp=(t=>t)`.mdc-form-field{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto,sans-serif;font-family:var(--mdc-typography-body2-font-family,var(--mdc-typography-font-family,Roboto,sans-serif));font-size:.875rem;font-size:var(--mdc-typography-body2-font-size,.875rem);line-height:1.25rem;line-height:var(--mdc-typography-body2-line-height,1.25rem);font-weight:400;font-weight:var(--mdc-typography-body2-font-weight,400);letter-spacing:.0178571429em;letter-spacing:var(--mdc-typography-body2-letter-spacing,.0178571429em);text-decoration:inherit;text-decoration:var(--mdc-typography-body2-text-decoration,inherit);text-transform:inherit;text-transform:var(--mdc-typography-body2-text-transform,inherit);color:rgba(0,0,0,.87);color:var(--mdc-theme-text-primary-on-background,rgba(0,0,0,.87));display:inline-flex;align-items:center;vertical-align:middle}.mdc-form-field>label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0;order:0}.mdc-form-field>label[dir=rtl],[dir=rtl] .mdc-form-field>label{margin-left:auto;margin-right:0}.mdc-form-field>label[dir=rtl],[dir=rtl] .mdc-form-field>label{padding-left:0;padding-right:4px}.mdc-form-field--nowrap>label{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mdc-form-field--align-end>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px;order:-1}.mdc-form-field--align-end>label[dir=rtl],[dir=rtl] .mdc-form-field--align-end>label{margin-left:0;margin-right:auto}.mdc-form-field--align-end>label[dir=rtl],[dir=rtl] .mdc-form-field--align-end>label{padding-left:4px;padding-right:0}.mdc-form-field--space-between{justify-content:space-between}.mdc-form-field--space-between>label{margin:0}.mdc-form-field--space-between>label[dir=rtl],[dir=rtl] .mdc-form-field--space-between>label{margin:0}:host{display:inline-flex}.mdc-form-field{width:100%}::slotted(*){-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto,sans-serif;font-family:var(--mdc-typography-body2-font-family,var(--mdc-typography-font-family,Roboto,sans-serif));font-size:.875rem;font-size:var(--mdc-typography-body2-font-size,.875rem);line-height:1.25rem;line-height:var(--mdc-typography-body2-line-height,1.25rem);font-weight:400;font-weight:var(--mdc-typography-body2-font-weight,400);letter-spacing:.0178571429em;letter-spacing:var(--mdc-typography-body2-letter-spacing,.0178571429em);text-decoration:inherit;text-decoration:var(--mdc-typography-body2-text-decoration,inherit);text-transform:inherit;text-transform:var(--mdc-typography-body2-text-transform,inherit);color:rgba(0,0,0,.87);color:var(--mdc-theme-text-primary-on-background,rgba(0,0,0,.87))}::slotted(mwc-switch){margin-right:10px}::slotted(mwc-switch)[dir=rtl],[dir=rtl] ::slotted(mwc-switch){margin-left:10px}`));class vp extends fp{}vp.styles=_p;var yp=function(t,e){return(yp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function bp(t,e){function n(){this.constructor=t}yp(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function Ep(t){return"function"==typeof t}var Tp=!1,Rp={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack;Tp=t},get useDeprecatedSynchronousErrorHandling(){return Tp}};function Cp(t){setTimeout((function(){throw t}),0)}var xp={closed:!0,next:function(t){},error:function(t){if(Rp.useDeprecatedSynchronousErrorHandling)throw t;Cp(t)},complete:function(){}},Sp=function(){return Array.isArray||function(t){return t&&"number"==typeof t.length}}();var Ip=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}(),Op=function(){function t(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}return t.prototype.unsubscribe=function(){var e;if(!this.closed){var n,i=this,o=i._parentOrParents,r=i._ctorUnsubscribe,s=i._unsubscribe,a=i._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,o instanceof t)o.remove(this);else if(null!==o)for(var l=0;l<o.length;++l){o[l].remove(this)}if(Ep(s)){r&&(this._unsubscribe=void 0);try{s.call(this)}catch(t){e=t instanceof Ip?kp(t.errors):[t]}}if(Sp(a)){l=-1;for(var c=a.length;++l<c;){var d=a[l];if(null!==(n=d)&&"object"==typeof n)try{d.unsubscribe()}catch(t){e=e||[],t instanceof Ip?e=e.concat(kp(t.errors)):e.push(t)}}}if(e)throw new Ip(e)}},t.prototype.add=function(e){var n=e;if(!e)return t.EMPTY;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){var i=n;(n=new t)._subscriptions=[i]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var o=n._parentOrParents;if(null===o)n._parentOrParents=this;else if(o instanceof t){if(o===this)return n;n._parentOrParents=[o,this]}else{if(-1!==o.indexOf(this))return n;o.push(this)}var r=this._subscriptions;return null===r?this._subscriptions=[n]:r.push(n),n},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}},t.EMPTY=function(t){return t.closed=!0,t}(new t),t}();function kp(t){return t.reduce((function(t,e){return t.concat(e instanceof Ip?e.errors:e)}),[])}var wp=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),Ap=function(t){function e(n,i,o){var r=t.call(this)||this;switch(r.syncErrorValue=null,r.syncErrorThrown=!1,r.syncErrorThrowable=!1,r.isStopped=!1,arguments.length){case 0:r.destination=xp;break;case 1:if(!n){r.destination=xp;break}if("object"==typeof n){n instanceof e?(r.syncErrorThrowable=n.syncErrorThrowable,r.destination=n,n.add(r)):(r.syncErrorThrowable=!0,r.destination=new Dp(r,n));break}default:r.syncErrorThrowable=!0,r.destination=new Dp(r,n,i,o)}return r}return bp(e,t),e.prototype[wp]=function(){return this},e.create=function(t,n,i){var o=new e(t,n,i);return o.syncErrorThrowable=!1,o},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},e}(Op),Dp=function(t){function e(e,n,i,o){var r,s=t.call(this)||this;s._parentSubscriber=e;var a=s;return Ep(n)?r=n:n&&(r=n.next,i=n.error,o=n.complete,n!==xp&&(Ep((a=Object.create(n)).unsubscribe)&&s.add(a.unsubscribe.bind(a)),a.unsubscribe=s.unsubscribe.bind(s))),s._context=a,s._next=r,s._error=i,s._complete=o,s}return bp(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;Rp.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,n=Rp.useDeprecatedSynchronousErrorHandling;if(this._error)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):Cp(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;Cp(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var n=function(){return t._complete.call(t._context)};Rp.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),Rp.useDeprecatedSynchronousErrorHandling)throw t;Cp(t)}},e.prototype.__tryOrSetError=function(t,e,n){if(!Rp.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,n)}catch(e){return Rp.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):(Cp(e),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(Ap);var Np=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function Lp(t){return t}function Pp(t){return 0===t.length?Lp:1===t.length?t[0]:function(e){return t.reduce((function(t,e){return e(t)}),e)}}var Mp=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(t,e,n){var i=this.operator,o=function(t,e,n){if(t){if(t instanceof Ap)return t;if(t[wp])return t[wp]()}return t||e||n?new Ap(t,e,n):new Ap(xp)}(t,e,n);if(i?o.add(i.call(o,this.source)):o.add(this.source||Rp.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),Rp.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){Rp.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),!function(t){for(;t;){var e=t,n=e.closed,i=e.destination,o=e.isStopped;if(n||o)return!1;t=i&&i instanceof Ap?i:null}return!0}(t)?console.warn(e):t.error(e)}},t.prototype.forEach=function(t,e){var n=this;return new(e=Bp(e))((function(e,i){var o;o=n.subscribe((function(e){try{t(e)}catch(t){i(t),o&&o.unsubscribe()}}),i,e)}))},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[Np]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?this:Pp(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=Bp(t))((function(t,n){var i;e.subscribe((function(t){return i=t}),(function(t){return n(t)}),(function(){return t(i)}))}))},t.create=function(e){return new t(e)},t}();function Bp(t){if(t||(t=Promise),!t)throw new Error("no Promise impl found");return t}var Fp,Hp=function(){function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t}(),Up=function(t){function e(e,n){var i=t.call(this)||this;return i.subject=e,i.subscriber=n,i.closed=!1,i}return bp(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}},e}(Op),Vp=function(t){function e(e){var n=t.call(this,e)||this;return n.destination=e,n}return bp(e,t),e}(Ap),Gp=function(t){function e(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return bp(e,t),e.prototype[wp]=function(){return new Vp(this)},e.prototype.lift=function(t){var e=new Wp(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new Hp;if(!this.isStopped)for(var e=this.observers,n=e.length,i=e.slice(),o=0;o<n;o++)i[o].next(t)},e.prototype.error=function(t){if(this.closed)throw new Hp;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,n=e.length,i=e.slice(),o=0;o<n;o++)i[o].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new Hp;this.isStopped=!0;for(var t=this.observers,e=t.length,n=t.slice(),i=0;i<e;i++)n[i].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new Hp;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new Hp;return this.hasError?(t.error(this.thrownError),Op.EMPTY):this.isStopped?(t.complete(),Op.EMPTY):(this.observers.push(t),new Up(this,t))},e.prototype.asObservable=function(){var t=new Mp;return t.source=this,t},e.create=function(t,e){return new Wp(t,e)},e}(Mp),Wp=function(t){function e(e,n){var i=t.call(this)||this;return i.destination=e,i.source=n,i}return bp(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):Op.EMPTY},e}(Gp),zp={MENU_SELECTED_LIST_ITEM:"mdc-menu-item--selected",MENU_SELECTION_GROUP:"mdc-menu__selection-group",ROOT:"mdc-menu"},Xp={ARIA_CHECKED_ATTR:"aria-checked",ARIA_DISABLED_ATTR:"aria-disabled",CHECKBOX_SELECTOR:'input[type="checkbox"]',LIST_SELECTOR:".mdc-list",SELECTED_EVENT:"MDCMenu:selected"},jp={FOCUS_ROOT_INDEX:-1};!function(t){t[t.NONE=0]="NONE",t[t.LIST_ROOT=1]="LIST_ROOT",t[t.FIRST_ITEM=2]="FIRST_ITEM",t[t.LAST_ITEM=3]="LAST_ITEM"}(Fp||(Fp={}));var Yp=function(t,e){return(Yp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var Kp=function(){return(Kp=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},$p=function(t){function e(n){var i=t.call(this,Kp(Kp({},e.defaultAdapter),n))||this;return i.closeAnimationEndTimerId_=0,i.defaultFocusState_=Fp.LIST_ROOT,i}return function(t,e){function n(){this.constructor=t}Yp(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return zp},enumerable:!0,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return Xp},enumerable:!0,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return jp},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClassToElementAtIndex:function(){},removeClassFromElementAtIndex:function(){},addAttributeToElementAtIndex:function(){},removeAttributeFromElementAtIndex:function(){},elementContainsClass:function(){return!1},closeSurface:function(){},getElementIndex:function(){return-1},notifySelected:function(){},getMenuItemCount:function(){return 0},focusItemAtIndex:function(){},focusListRoot:function(){},getSelectedSiblingOfItemAtIndex:function(){return-1},isSelectableItemAtIndex:function(){return!1}}},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.closeAnimationEndTimerId_&&clearTimeout(this.closeAnimationEndTimerId_),this.adapter.closeSurface()},e.prototype.handleKeydown=function(t){var e=t.key,n=t.keyCode;("Tab"===e||9===n)&&this.adapter.closeSurface(!0)},e.prototype.handleItemAction=function(t){var e=this,n=this.adapter.getElementIndex(t);n<0||(this.adapter.notifySelected({index:n}),this.adapter.closeSurface(),this.closeAnimationEndTimerId_=setTimeout((function(){var n=e.adapter.getElementIndex(t);n>=0&&e.adapter.isSelectableItemAtIndex(n)&&e.setSelectedIndex(n)}),rh.numbers.TRANSITION_CLOSE_DURATION))},e.prototype.handleMenuSurfaceOpened=function(){switch(this.defaultFocusState_){case Fp.FIRST_ITEM:this.adapter.focusItemAtIndex(0);break;case Fp.LAST_ITEM:this.adapter.focusItemAtIndex(this.adapter.getMenuItemCount()-1);break;case Fp.NONE:break;default:this.adapter.focusListRoot()}},e.prototype.setDefaultFocusState=function(t){this.defaultFocusState_=t},e.prototype.setSelectedIndex=function(t){if(this.validatedIndex_(t),!this.adapter.isSelectableItemAtIndex(t))throw new Error("MDCMenuFoundation: No selection group at specified index.");var e=this.adapter.getSelectedSiblingOfItemAtIndex(t);e>=0&&(this.adapter.removeAttributeFromElementAtIndex(e,Xp.ARIA_CHECKED_ATTR),this.adapter.removeClassFromElementAtIndex(e,zp.MENU_SELECTED_LIST_ITEM)),this.adapter.addClassToElementAtIndex(t,zp.MENU_SELECTED_LIST_ITEM),this.adapter.addAttributeToElementAtIndex(t,Xp.ARIA_CHECKED_ATTR,"true")},e.prototype.setEnabled=function(t,e){this.validatedIndex_(t),e?(this.adapter.removeClassFromElementAtIndex(t,nu),this.adapter.addAttributeToElementAtIndex(t,Xp.ARIA_DISABLED_ATTR,"false")):(this.adapter.addClassToElementAtIndex(t,nu),this.adapter.addAttributeToElementAtIndex(t,Xp.ARIA_DISABLED_ATTR,"true"))},e.prototype.validatedIndex_=function(t){var e=this.adapter.getMenuItemCount();if(!(t>=0&&t<e))throw new Error("MDCMenuFoundation: No list item at specified index.")},e}(Et);let Jp,qp,Zp=t=>t,Qp=class extends fu{};Qp.styles=mu,Qp=t([],Qp);let tg=class extends dh{};tg.styles=uh,tg=t([],tg);class eg extends _t{constructor(){super(...arguments),this.mdcFoundationClass=$p,this.listElement_=null,this.anchor=null,this.open=!1,this.quick=!1,this.wrapFocus=!1,this.innerRole="menu",this.corner="TOP_START",this.x=null,this.y=null,this.absolute=!1,this.multi=!1,this.activatable=!1,this.fixed=!1,this.forceGroupSelection=!1,this.fullwidth=!1,this.menuCorner="START",this.defaultFocus="LIST_ROOT",this._listUpdateComplete=null}get listElement(){return this.listElement_||(this.listElement_=this.renderRoot.querySelector("mwc-list")),this.listElement_}get items(){const t=this.listElement;return t?t.items:[]}get index(){const t=this.listElement;return t?t.index:-1}get selected(){const t=this.listElement;return t?t.selected:null}render(){const t="menu"===this.innerRole?"menuitem":"option";return F(Jp||(Jp=Zp` <mwc-menu-surface ?hidden="${0}" .anchor="${0}" .open="${0}" .quick="${0}" .corner="${0}" .x="${0}" .y="${0}" .absolute="${0}" .fixed="${0}" .fullwidth="${0}" .menuCorner="${0}" class="mdc-menu mdc-menu-surface" @closed="${0}" @opened="${0}" @keydown="${0}"> <mwc-list rootTabbable .innerRole="${0}" .multi="${0}" class="mdc-list" .itemRoles="${0}" .wrapFocus="${0}" .activatable="${0}" @action="${0}"> <slot></slot> </mwc-list> </mwc-menu-surface>`),!this.open,this.anchor,this.open,this.quick,this.corner,this.x,this.y,this.absolute,this.fixed,this.fullwidth,this.menuCorner,this.onClosed,this.onOpened,this.onKeydown,this.innerRole,this.multi,t,this.wrapFocus,this.activatable,this.onAction)}createAdapter(){return{addClassToElementAtIndex:(t,e)=>{const n=this.listElement;if(!n)return;const i=n.items[t];i&&("mdc-menu-item--selected"===e?this.forceGroupSelection&&!i.selected&&n.toggle(t,!0):i.classList.add(e))},removeClassFromElementAtIndex:(t,e)=>{const n=this.listElement;if(!n)return;const i=n.items[t];i&&("mdc-menu-item--selected"===e?i.selected&&n.toggle(t,!1):i.classList.remove(e))},addAttributeToElementAtIndex:(t,e,n)=>{const i=this.listElement;if(!i)return;const o=i.items[t];o&&o.setAttribute(e,n)},removeAttributeFromElementAtIndex:(t,e)=>{const n=this.listElement;if(!n)return;const i=n.items[t];i&&i.removeAttribute(e)},elementContainsClass:(t,e)=>t.classList.contains(e),closeSurface:()=>{this.open=!1},getElementIndex:t=>{const e=this.listElement;return e?e.items.indexOf(t):-1},notifySelected:()=>{},getMenuItemCount:()=>{const t=this.listElement;return t?t.items.length:0},focusItemAtIndex:t=>{const e=this.listElement;if(!e)return;const n=e.items[t];n&&n.focus()},focusListRoot:()=>{this.listElement&&this.listElement.focus()},getSelectedSiblingOfItemAtIndex:t=>{const e=this.listElement;if(!e)return-1;const n=e.items[t];if(!n||!n.group)return-1;for(let i=0;i<e.items.length;i++){if(i===t)continue;const o=e.items[i];if(o.selected&&o.group===n.group)return i}return-1},isSelectableItemAtIndex:t=>{const e=this.listElement;if(!e)return!1;const n=e.items[t];return!!n&&n.hasAttribute("group")}}}onKeydown(t){this.mdcFoundation&&this.mdcFoundation.handleKeydown(t)}onAction(t){const e=this.listElement;if(this.mdcFoundation&&e){const n=t.detail.index,i=e.items[n];i&&this.mdcFoundation.handleItemAction(i)}}onOpened(){this.open=!0,this.mdcFoundation&&this.mdcFoundation.handleMenuSurfaceOpened()}onClosed(){this.open=!1}async _getUpdateComplete(){await this._listUpdateComplete,await super._getUpdateComplete()}async firstUpdated(){super.firstUpdated();const t=this.listElement;t&&(this._listUpdateComplete=t.updateComplete,await this._listUpdateComplete)}select(t){const e=this.listElement;e&&e.select(t)}close(){this.open=!1}show(){this.open=!0}getFocusedItemIndex(){const t=this.listElement;return t?t.getFocusedItemIndex():-1}focusItemAtIndex(t){const e=this.listElement;e&&e.focusItemAtIndex(t)}layout(t=!0){const e=this.listElement;e&&e.layout(t)}}t([Z(".mdc-menu")],eg.prototype,"mdcRoot",void 0),t([Z("slot")],eg.prototype,"slotElement",void 0),t([J({type:Object})],eg.prototype,"anchor",void 0),t([J({type:Boolean,reflect:!0})],eg.prototype,"open",void 0),t([J({type:Boolean})],eg.prototype,"quick",void 0),t([J({type:Boolean})],eg.prototype,"wrapFocus",void 0),t([J({type:String})],eg.prototype,"innerRole",void 0),t([J({type:String})],eg.prototype,"corner",void 0),t([J({type:Number})],eg.prototype,"x",void 0),t([J({type:Number})],eg.prototype,"y",void 0),t([J({type:Boolean})],eg.prototype,"absolute",void 0),t([J({type:Boolean})],eg.prototype,"multi",void 0),t([J({type:Boolean})],eg.prototype,"activatable",void 0),t([J({type:Boolean})],eg.prototype,"fixed",void 0),t([J({type:Boolean})],eg.prototype,"forceGroupSelection",void 0),t([J({type:Boolean})],eg.prototype,"fullwidth",void 0),t([J({type:String})],eg.prototype,"menuCorner",void 0),t([J({type:String}),vt((function(t){this.mdcFoundation&&this.mdcFoundation.setDefaultFocusState(Fp[t])}))],eg.prototype,"defaultFocus",void 0);const ng=st(qp||(qp=Zp`mwc-list ::slotted([mwc-list-item]:not([twoline])){height:var(--mdc-menu-item-height,48px)}mwc-list{max-width:var(--mdc-menu-max-width,auto);min-width:var(--mdc-menu-min-width,auto)}`));class ig extends(Le(eg)){get listElement(){return this.listElement_||(this.listElement_=this.renderRoot.querySelector(".mdc-list")),this.listElement_}static get scopedElements(){return{"mwc-menu-surface":tg,"mwc-list":_u}}}ig.styles=ng;let og,rg,sg,ag=t=>t;class lg extends wa{constructor(){super(...arguments),this.checked=!1,this.indeterminate=!1,this.disabled=!1,this.value="",this.reducedTouchTarget=!1,this.animationClass="",this.shouldRenderRipple=!1,this.focused=!1,this.mdcFoundationClass=void 0,this.mdcFoundation=void 0,this.rippleElement=null,this.rippleHandlers=new ae((()=>(this.shouldRenderRipple=!0,this.ripple.then((t=>this.rippleElement=t)),this.ripple)))}createAdapter(){return{}}update(t){const e=t.get("indeterminate"),n=t.get("checked"),i=t.get("disabled");if(void 0!==e||void 0!==n||void 0!==i){const t=this.calculateAnimationStateName(!!n,!!e,!!i),o=this.calculateAnimationStateName(this.checked,this.indeterminate,this.disabled);this.animationClass=`${t}-${o}`}super.update(t)}calculateAnimationStateName(t,e,n){return n?"disabled":e?"indeterminate":t?"checked":"unchecked"}renderRipple(){const t=this.indeterminate||this.checked;return this.shouldRenderRipple?F(og||(og=ag` <mwc-ripple .accent="${0}" .disabled="${0}" unbounded> </mwc-ripple>`),t,this.disabled):""}render(){const t=this.indeterminate||this.checked,e={"mdc-checkbox--disabled":this.disabled,"mdc-checkbox--selected":t,"mdc-checkbox--touch":!this.reducedTouchTarget,"mdc-ripple-upgraded--background-focused":this.focused,"mdc-checkbox--anim-checked-indeterminate":"checked-indeterminate"==this.animationClass,"mdc-checkbox--anim-checked-unchecked":"checked-unchecked"==this.animationClass,"mdc-checkbox--anim-indeterminate-checked":"indeterminate-checked"==this.animationClass,"mdc-checkbox--anim-indeterminate-unchecked":"indeterminate-unchecked"==this.animationClass,"mdc-checkbox--anim-unchecked-checked":"unchecked-checked"==this.animationClass,"mdc-checkbox--anim-unchecked-indeterminate":"unchecked-indeterminate"==this.animationClass},n=this.indeterminate?"mixed":void 0;return F(rg||(rg=ag` <div class="mdc-checkbox mdc-checkbox--upgraded ${0}"> <input type="checkbox" class="mdc-checkbox__native-control" aria-checked="${0}" data-indeterminate="${0}" ?disabled="${0}" .indeterminate="${0}" .checked="${0}" .value="${0}" @change="${0}" @focus="${0}" @blur="${0}" @mousedown="${0}" @mouseenter="${0}" @mouseleave="${0}" @touchstart="${0}" @touchend="${0}" @touchcancel="${0}"> <div class="mdc-checkbox__background" @animationend="${0}"> <svg class="mdc-checkbox__checkmark" viewBox="0 0 24 24"> <path class="mdc-checkbox__checkmark-path" fill="none" d="M1.73,12.91 8.1,19.28 22.79,4.59"></path> </svg> <div class="mdc-checkbox__mixedmark"></div> </div> ${0} </div>`),Nt(e),$t(n),this.indeterminate?"true":"false",this.disabled,this.indeterminate,this.checked,this.value,this._changeHandler,this._handleFocus,this._handleBlur,this.handleRippleMouseDown,this.handleRippleMouseEnter,this.handleRippleMouseLeave,this.handleRippleTouchStart,this.handleRippleDeactivate,this.handleRippleDeactivate,this.resetAnimationClass,this.renderRipple())}_handleFocus(){this.focused=!0,this.handleRippleFocus()}_handleBlur(){this.focused=!1,this.handleRippleBlur()}handleRippleMouseDown(t){const e=()=>{window.removeEventListener("mouseup",e),this.handleRippleDeactivate()};window.addEventListener("mouseup",e),this.rippleHandlers.startPress(t)}handleRippleTouchStart(t){this.rippleHandlers.startPress(t)}handleRippleDeactivate(){this.rippleHandlers.endPress()}handleRippleMouseEnter(){this.rippleHandlers.startHover()}handleRippleMouseLeave(){this.rippleHandlers.endHover()}handleRippleFocus(){this.rippleHandlers.startFocus()}handleRippleBlur(){this.rippleHandlers.endFocus()}_changeHandler(){this.checked=this.formElement.checked,this.indeterminate=this.formElement.indeterminate}resetAnimationClass(){this.animationClass=""}get isRippleActive(){var t;return(null===(t=this.rippleElement)||void 0===t?void 0:t.isActive)||!1}}t([Z(".mdc-checkbox")],lg.prototype,"mdcRoot",void 0),t([Z("input")],lg.prototype,"formElement",void 0),t([J({type:Boolean,reflect:!0})],lg.prototype,"checked",void 0),t([J({type:Boolean})],lg.prototype,"indeterminate",void 0),t([J({type:Boolean,reflect:!0})],lg.prototype,"disabled",void 0),t([J({type:String})],lg.prototype,"value",void 0),t([J({type:Boolean})],lg.prototype,"reducedTouchTarget",void 0),t([q()],lg.prototype,"animationClass",void 0),t([q()],lg.prototype,"shouldRenderRipple",void 0),t([q()],lg.prototype,"focused",void 0),t([Q("mwc-ripple")],lg.prototype,"ripple",void 0),t([nt({passive:!0})],lg.prototype,"handleRippleTouchStart",null);const cg=st(sg||(sg=ag`.mdc-checkbox{padding:11px;margin-top:0;margin-bottom:0;margin-right:0;margin-left:0}.mdc-checkbox .mdc-checkbox__ripple::after,.mdc-checkbox .mdc-checkbox__ripple::before{background-color:#000;background-color:var(--mdc-ripple-color,#000)}.mdc-checkbox.mdc-ripple-surface--hover .mdc-checkbox__ripple::before,.mdc-checkbox:hover .mdc-checkbox__ripple::before{opacity:.04;opacity:var(--mdc-ripple-hover-opacity,.04)}.mdc-checkbox.mdc-ripple-upgraded--background-focused .mdc-checkbox__ripple::before,.mdc-checkbox:not(.mdc-ripple-upgraded):focus .mdc-checkbox__ripple::before{transition-duration:75ms;opacity:.12;opacity:var(--mdc-ripple-focus-opacity,.12)}.mdc-checkbox:not(.mdc-ripple-upgraded) .mdc-checkbox__ripple::after{transition:opacity 150ms linear}.mdc-checkbox:not(.mdc-ripple-upgraded):active .mdc-checkbox__ripple::after{transition-duration:75ms;opacity:.12;opacity:var(--mdc-ripple-press-opacity,.12)}.mdc-checkbox.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.12)}.mdc-checkbox .mdc-checkbox__native-control:checked~.mdc-checkbox__background::before,.mdc-checkbox .mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background::before,.mdc-checkbox .mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background::before{background-color:#018786;background-color:var(--mdc-theme-secondary,#018786)}.mdc-checkbox.mdc-checkbox--selected .mdc-checkbox__ripple::after,.mdc-checkbox.mdc-checkbox--selected .mdc-checkbox__ripple::before{background-color:#018786;background-color:var(--mdc-ripple-color,var(--mdc-theme-secondary,#018786))}.mdc-checkbox.mdc-checkbox--selected.mdc-ripple-surface--hover .mdc-checkbox__ripple::before,.mdc-checkbox.mdc-checkbox--selected:hover .mdc-checkbox__ripple::before{opacity:.04;opacity:var(--mdc-ripple-hover-opacity,.04)}.mdc-checkbox.mdc-checkbox--selected.mdc-ripple-upgraded--background-focused .mdc-checkbox__ripple::before,.mdc-checkbox.mdc-checkbox--selected:not(.mdc-ripple-upgraded):focus .mdc-checkbox__ripple::before{transition-duration:75ms;opacity:.12;opacity:var(--mdc-ripple-focus-opacity,.12)}.mdc-checkbox.mdc-checkbox--selected:not(.mdc-ripple-upgraded) .mdc-checkbox__ripple::after{transition:opacity 150ms linear}.mdc-checkbox.mdc-checkbox--selected:not(.mdc-ripple-upgraded):active .mdc-checkbox__ripple::after{transition-duration:75ms;opacity:.12;opacity:var(--mdc-ripple-press-opacity,.12)}.mdc-checkbox.mdc-checkbox--selected.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.12)}.mdc-checkbox.mdc-ripple-upgraded--background-focused.mdc-checkbox--selected .mdc-checkbox__ripple::after,.mdc-checkbox.mdc-ripple-upgraded--background-focused.mdc-checkbox--selected .mdc-checkbox__ripple::before{background-color:#018786;background-color:var(--mdc-ripple-color,var(--mdc-theme-secondary,#018786))}.mdc-checkbox .mdc-checkbox__background{top:11px;left:11px}.mdc-checkbox .mdc-checkbox__background::before{top:-13px;left:-13px;width:40px;height:40px}.mdc-checkbox .mdc-checkbox__native-control{top:0;right:0;left:0;width:40px;height:40px}.mdc-checkbox .mdc-checkbox__native-control:enabled:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:rgba(0,0,0,.54);border-color:var(--mdc-checkbox-unchecked-color,rgba(0,0,0,.54));background-color:transparent}.mdc-checkbox .mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control[data-indeterminate=true]:enabled~.mdc-checkbox__background{border-color:#018786;border-color:var(--mdc-checkbox-checked-color,var(--mdc-theme-secondary,#018786));background-color:#018786;background-color:var(--mdc-checkbox-checked-color,var(--mdc-theme-secondary,#018786))}@keyframes mdc-checkbox-fade-in-background-8A000000FF01878600000000FF018786{0%{border-color:rgba(0,0,0,.54);border-color:var(--mdc-checkbox-unchecked-color,rgba(0,0,0,.54));background-color:transparent}50%{border-color:#018786;border-color:var(--mdc-checkbox-checked-color,var(--mdc-theme-secondary,#018786));background-color:#018786;background-color:var(--mdc-checkbox-checked-color,var(--mdc-theme-secondary,#018786))}}@keyframes mdc-checkbox-fade-out-background-8A000000FF01878600000000FF018786{0%,80%{border-color:#018786;border-color:var(--mdc-checkbox-checked-color,var(--mdc-theme-secondary,#018786));background-color:#018786;background-color:var(--mdc-checkbox-checked-color,var(--mdc-theme-secondary,#018786))}100%{border-color:rgba(0,0,0,.54);border-color:var(--mdc-checkbox-unchecked-color,rgba(0,0,0,.54));background-color:transparent}}.mdc-checkbox.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-in-background-8A000000FF01878600000000FF018786}.mdc-checkbox.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background,.mdc-checkbox.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__native-control:enabled~.mdc-checkbox__background{animation-name:mdc-checkbox-fade-out-background-8A000000FF01878600000000FF018786}.mdc-checkbox .mdc-checkbox__native-control[disabled]:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:rgba(0,0,0,.38);border-color:var(--mdc-checkbox-disabled-color,rgba(0,0,0,.38));background-color:transparent}.mdc-checkbox .mdc-checkbox__native-control[data-indeterminate=true][disabled]~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control[disabled]:checked~.mdc-checkbox__background,.mdc-checkbox .mdc-checkbox__native-control[disabled]:indeterminate~.mdc-checkbox__background{border-color:transparent;background-color:rgba(0,0,0,.38);background-color:var(--mdc-checkbox-disabled-color,rgba(0,0,0,.38))}.mdc-checkbox .mdc-checkbox__native-control:enabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:#fff;color:var(--mdc-checkbox-ink-color,#fff)}.mdc-checkbox .mdc-checkbox__native-control:enabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:#fff;border-color:var(--mdc-checkbox-ink-color,#fff)}.mdc-checkbox .mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:#fff;color:var(--mdc-checkbox-ink-color,#fff)}.mdc-checkbox .mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:#fff;border-color:var(--mdc-checkbox-ink-color,#fff)}.mdc-touch-target-wrapper{display:inline}@keyframes mdc-checkbox-unchecked-checked-checkmark-path{0%,50%{stroke-dashoffset:29.7833385}50%{animation-timing-function:cubic-bezier(0,0,.2,1)}100%{stroke-dashoffset:0}}@keyframes mdc-checkbox-unchecked-indeterminate-mixedmark{0%,68.2%{transform:scaleX(0)}68.2%{animation-timing-function:cubic-bezier(0,0,0,1)}100%{transform:scaleX(1)}}@keyframes mdc-checkbox-checked-unchecked-checkmark-path{from{animation-timing-function:cubic-bezier(.4,0,1,1);opacity:1;stroke-dashoffset:0}to{opacity:0;stroke-dashoffset:-29.7833385}}@keyframes mdc-checkbox-checked-indeterminate-checkmark{from{animation-timing-function:cubic-bezier(0,0,.2,1);transform:rotate(0);opacity:1}to{transform:rotate(45deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-checked-checkmark{from{animation-timing-function:cubic-bezier(.14,0,0,1);transform:rotate(45deg);opacity:0}to{transform:rotate(360deg);opacity:1}}@keyframes mdc-checkbox-checked-indeterminate-mixedmark{from{animation-timing-function:mdc-animation-deceleration-curve-timing-function;transform:rotate(-45deg);opacity:0}to{transform:rotate(0);opacity:1}}@keyframes mdc-checkbox-indeterminate-checked-mixedmark{from{animation-timing-function:cubic-bezier(.14,0,0,1);transform:rotate(0);opacity:1}to{transform:rotate(315deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-unchecked-mixedmark{0%{animation-timing-function:linear;transform:scaleX(1);opacity:1}100%,32.8%{transform:scaleX(0);opacity:0}}.mdc-checkbox{display:inline-block;position:relative;flex:0 0 18px;box-sizing:content-box;width:18px;height:18px;line-height:0;white-space:nowrap;cursor:pointer;vertical-align:bottom}@media screen and (-ms-high-contrast:active){.mdc-checkbox__native-control[disabled]:not(:checked):not(:indeterminate):not([data-indeterminate=true])~.mdc-checkbox__background{border-color:GrayText;border-color:var(--mdc-checkbox-disabled-color,GrayText);background-color:transparent}.mdc-checkbox__native-control[data-indeterminate=true][disabled]~.mdc-checkbox__background,.mdc-checkbox__native-control[disabled]:checked~.mdc-checkbox__background,.mdc-checkbox__native-control[disabled]:indeterminate~.mdc-checkbox__background{border-color:GrayText;background-color:transparent;background-color:var(--mdc-checkbox-disabled-color,transparent)}.mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__checkmark{color:GrayText;color:var(--mdc-checkbox-ink-color,GrayText)}.mdc-checkbox__native-control:disabled~.mdc-checkbox__background .mdc-checkbox__mixedmark{border-color:GrayText;border-color:var(--mdc-checkbox-ink-color,GrayText)}.mdc-checkbox__mixedmark{margin:0 1px}}.mdc-checkbox--disabled{cursor:default;pointer-events:none}.mdc-checkbox__background{display:inline-flex;position:absolute;align-items:center;justify-content:center;box-sizing:border-box;width:18px;height:18px;border:2px solid currentColor;border-radius:2px;background-color:transparent;pointer-events:none;will-change:background-color,border-color;transition:background-color 90ms 0s cubic-bezier(.4,0,.6,1),border-color 90ms 0s cubic-bezier(.4,0,.6,1)}.mdc-checkbox__background .mdc-checkbox__background::before{background-color:#000;background-color:var(--mdc-theme-on-surface,#000)}.mdc-checkbox__checkmark{position:absolute;top:0;right:0;bottom:0;left:0;width:100%;opacity:0;transition:opacity 180ms 0s cubic-bezier(.4,0,.6,1)}.mdc-checkbox--upgraded .mdc-checkbox__checkmark{opacity:1}.mdc-checkbox__checkmark-path{transition:stroke-dashoffset 180ms 0s cubic-bezier(.4,0,.6,1);stroke:currentColor;stroke-width:3.12px;stroke-dashoffset:29.7833385;stroke-dasharray:29.7833385}.mdc-checkbox__mixedmark{width:100%;height:0;transform:scaleX(0) rotate(0);border-width:1px;border-style:solid;opacity:0;transition:opacity 90ms 0s cubic-bezier(.4,0,.6,1),transform 90ms 0s cubic-bezier(.4,0,.6,1)}.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__background,.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__background,.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__background,.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__background{animation-duration:180ms;animation-timing-function:linear}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-unchecked-checked-checkmark-path 180ms linear 0s;transition:none}.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-unchecked-indeterminate-mixedmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-checked-unchecked-checkmark-path 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__checkmark{animation:mdc-checkbox-checked-indeterminate-checkmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-checked-indeterminate-mixedmark 90ms linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__checkmark{animation:mdc-checkbox-indeterminate-checked-checkmark .5s linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-checked-mixedmark .5s linear 0s;transition:none}.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-unchecked-mixedmark .3s linear 0s;transition:none}.mdc-checkbox__native-control:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background{transition:border-color 90ms 0s cubic-bezier(0,0,.2,1),background-color 90ms 0s cubic-bezier(0,0,.2,1)}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark-path,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark-path,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__checkmark-path{stroke-dashoffset:0}.mdc-checkbox__background::before{position:absolute;transform:scale(0,0);border-radius:50%;opacity:0;pointer-events:none;content:"";will-change:opacity,transform;transition:opacity 90ms 0s cubic-bezier(.4,0,.6,1),transform 90ms 0s cubic-bezier(.4,0,.6,1)}.mdc-checkbox__native-control:focus~.mdc-checkbox__background::before{transform:scale(1);opacity:.12;transition:opacity 80ms 0s cubic-bezier(0,0,.2,1),transform 80ms 0s cubic-bezier(0,0,.2,1)}.mdc-checkbox__native-control{position:absolute;margin:0;padding:0;opacity:0;cursor:inherit}.mdc-checkbox__native-control:disabled{cursor:default;pointer-events:none}.mdc-checkbox--touch{margin-top:4px;margin-bottom:4px;margin-right:4px;margin-left:4px}.mdc-checkbox--touch .mdc-checkbox__native-control{top:-4px;right:-4px;left:-4px;width:48px;height:48px}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark{transition:opacity 180ms 0s cubic-bezier(0,0,.2,1),transform 180ms 0s cubic-bezier(0,0,.2,1);opacity:1}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(-45deg)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__checkmark{transform:rotate(45deg);opacity:0;transition:opacity 90ms 0s cubic-bezier(.4,0,.6,1),transform 90ms 0s cubic-bezier(.4,0,.6,1)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__mixedmark,.mdc-checkbox__native-control[data-indeterminate=true]~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(0);opacity:1}.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__background,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__checkmark,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__checkmark-path,.mdc-checkbox.mdc-checkbox--upgraded .mdc-checkbox__mixedmark{transition:none}:host{outline:0;display:inline-flex;-webkit-tap-highlight-color:transparent}.mdc-checkbox .mdc-checkbox__background::before{content:none}`));class dg extends(Le(lg)){static get scopedElements(){return{"mwc-ripple":$e}}}dg.styles=cg;var ug=["input","button","textarea","select"],hg=function(t){var e=t.target;if(e){var n=(""+e.tagName).toLowerCase();-1===ug.indexOf(n)&&t.preventDefault()}};function pg(t,e){for(var n=new Map,i=0;i<t;i++){var o=e(i).trim();if(o){var r=o[0].toLowerCase();n.has(r)||n.set(r,[]),n.get(r).push({text:o.toLowerCase(),index:i})}}return n.forEach((function(t){t.sort((function(t,e){return t.index-e.index}))})),n}function gg(t,e){var n,i=t.nextChar,o=t.focusItemAtIndex,r=t.sortedIndexByFirstChar,s=t.focusedItemIndex,a=t.skipFocus,l=t.isItemAtIndexDisabled;return clearTimeout(e.bufferClearTimeout),e.bufferClearTimeout=setTimeout((function(){!function(t){t.typeaheadBuffer=""}(e)}),ou.TYPEAHEAD_BUFFER_CLEAR_TIMEOUT_MS),e.typeaheadBuffer=e.typeaheadBuffer+i,-1===(n=1===e.typeaheadBuffer.length?function(t,e,n,i){var o=i.typeaheadBuffer[0],r=t.get(o);if(!r)return-1;if(o===i.currentFirstChar&&r[i.sortedIndexCursor].index===e){i.sortedIndexCursor=(i.sortedIndexCursor+1)%r.length;var s=r[i.sortedIndexCursor].index;if(!n(s))return s}i.currentFirstChar=o;var a,l=-1;for(a=0;a<r.length;a++)if(!n(r[a].index)){l=a;break}for(;a<r.length;a++)if(r[a].index>e&&!n(r[a].index)){l=a;break}if(-1!==l)return i.sortedIndexCursor=l,r[i.sortedIndexCursor].index;return-1}(r,s,l,e):function(t,e,n){var i=n.typeaheadBuffer[0],o=t.get(i);if(!o)return-1;var r=o[n.sortedIndexCursor];if(0===r.text.lastIndexOf(n.typeaheadBuffer,0)&&!e(r.index))return r.index;var s=(n.sortedIndexCursor+1)%o.length,a=-1;for(;s!==n.sortedIndexCursor;){var l=o[s],c=0===l.text.lastIndexOf(n.typeaheadBuffer,0),d=!e(l.index);if(c&&d){a=s;break}s=(s+1)%o.length}if(-1!==a)return n.sortedIndexCursor=a,o[n.sortedIndexCursor].index;return-1}(r,l,e))||a||o(n),n}function fg(t){return t.typeaheadBuffer.length>0}var mg=function(t,e){return(mg=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var _g=function(){return(_g=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},vg={ACTIVATED:"mdc-select--activated",DISABLED:"mdc-select--disabled",FOCUSED:"mdc-select--focused",INVALID:"mdc-select--invalid",MENU_INVALID:"mdc-select__menu--invalid",OUTLINED:"mdc-select--outlined",REQUIRED:"mdc-select--required",ROOT:"mdc-select",WITH_LEADING_ICON:"mdc-select--with-leading-icon"},yg={ARIA_CONTROLS:"aria-controls",ARIA_DESCRIBEDBY:"aria-describedby",ARIA_SELECTED_ATTR:"aria-selected",CHANGE_EVENT:"MDCSelect:change",HIDDEN_INPUT_SELECTOR:'input[type="hidden"]',LABEL_SELECTOR:".mdc-floating-label",LEADING_ICON_SELECTOR:".mdc-select__icon",LINE_RIPPLE_SELECTOR:".mdc-line-ripple",MENU_SELECTOR:".mdc-select__menu",OUTLINE_SELECTOR:".mdc-notched-outline",SELECTED_TEXT_SELECTOR:".mdc-select__selected-text",SELECT_ANCHOR_SELECTOR:".mdc-select__anchor",VALUE_ATTR:"data-value"},bg={LABEL_SCALE:.75,UNSET_INDEX:-1,CLICK_DEBOUNCE_TIMEOUT_MS:330},Eg=function(t){function e(n,i){void 0===i&&(i={});var o=t.call(this,_g(_g({},e.defaultAdapter),n))||this;return o.disabled=!1,o.isMenuOpen=!1,o.useDefaultValidation=!0,o.customValidity=!0,o.lastSelectedIndex=bg.UNSET_INDEX,o.clickDebounceTimeout=0,o.recentlyClicked=!1,o.leadingIcon=i.leadingIcon,o.helperText=i.helperText,o}return function(t,e){function n(){this.constructor=t}mg(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),Object.defineProperty(e,"cssClasses",{get:function(){return vg},enumerable:!0,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return bg},enumerable:!0,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return yg},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{addClass:function(){},removeClass:function(){},hasClass:function(){return!1},activateBottomLine:function(){},deactivateBottomLine:function(){},getSelectedIndex:function(){return-1},setSelectedIndex:function(){},hasLabel:function(){return!1},floatLabel:function(){},getLabelWidth:function(){return 0},setLabelRequired:function(){},hasOutline:function(){return!1},notchOutline:function(){},closeOutline:function(){},setRippleCenter:function(){},notifyChange:function(){},setSelectedText:function(){},isSelectAnchorFocused:function(){return!1},getSelectAnchorAttr:function(){return""},setSelectAnchorAttr:function(){},removeSelectAnchorAttr:function(){},addMenuClass:function(){},removeMenuClass:function(){},openMenu:function(){},closeMenu:function(){},getAnchorElement:function(){return null},setMenuAnchorElement:function(){},setMenuAnchorCorner:function(){},setMenuWrapFocus:function(){},focusMenuItemAtIndex:function(){},getMenuItemCount:function(){return 0},getMenuItemValues:function(){return[]},getMenuItemTextAtIndex:function(){return""},isTypeaheadInProgress:function(){return!1},typeaheadMatchItem:function(){return-1}}},enumerable:!0,configurable:!0}),e.prototype.getSelectedIndex=function(){return this.adapter.getSelectedIndex()},e.prototype.setSelectedIndex=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1),t>=this.adapter.getMenuItemCount()||(t===bg.UNSET_INDEX?this.adapter.setSelectedText(""):this.adapter.setSelectedText(this.adapter.getMenuItemTextAtIndex(t).trim()),this.adapter.setSelectedIndex(t),e&&this.adapter.closeMenu(),n||this.lastSelectedIndex===t||this.handleChange(),this.lastSelectedIndex=t)},e.prototype.setValue=function(t,e){void 0===e&&(e=!1);var n=this.adapter.getMenuItemValues().indexOf(t);this.setSelectedIndex(n,!1,e)},e.prototype.getValue=function(){var t=this.adapter.getSelectedIndex(),e=this.adapter.getMenuItemValues();return t!==bg.UNSET_INDEX?e[t]:""},e.prototype.getDisabled=function(){return this.disabled},e.prototype.setDisabled=function(t){this.disabled=t,this.disabled?(this.adapter.addClass(vg.DISABLED),this.adapter.closeMenu()):this.adapter.removeClass(vg.DISABLED),this.leadingIcon&&this.leadingIcon.setDisabled(this.disabled),this.disabled?this.adapter.removeSelectAnchorAttr("tabindex"):this.adapter.setSelectAnchorAttr("tabindex","0"),this.adapter.setSelectAnchorAttr("aria-disabled",this.disabled.toString())},e.prototype.openMenu=function(){this.adapter.addClass(vg.ACTIVATED),this.adapter.openMenu(),this.isMenuOpen=!0,this.adapter.setSelectAnchorAttr("aria-expanded","true")},e.prototype.setHelperTextContent=function(t){this.helperText&&this.helperText.setContent(t)},e.prototype.layout=function(){if(this.adapter.hasLabel()){var t=this.getValue().length>0,e=this.adapter.hasClass(vg.FOCUSED),n=t||e,i=this.adapter.hasClass(vg.REQUIRED);this.notchOutline(n),this.adapter.floatLabel(n),this.adapter.setLabelRequired(i)}},e.prototype.layoutOptions=function(){var t=this.adapter.getMenuItemValues().indexOf(this.getValue());this.setSelectedIndex(t,!1,!0)},e.prototype.handleMenuOpened=function(){if(0!==this.adapter.getMenuItemValues().length){var t=this.getSelectedIndex(),e=t>=0?t:0;this.adapter.focusMenuItemAtIndex(e)}},e.prototype.handleMenuClosed=function(){this.adapter.removeClass(vg.ACTIVATED),this.isMenuOpen=!1,this.adapter.setSelectAnchorAttr("aria-expanded","false"),this.adapter.isSelectAnchorFocused()||this.blur()},e.prototype.handleChange=function(){this.layout(),this.adapter.notifyChange(this.getValue()),this.adapter.hasClass(vg.REQUIRED)&&this.useDefaultValidation&&this.setValid(this.isValid())},e.prototype.handleMenuItemAction=function(t){this.setSelectedIndex(t,!0)},e.prototype.handleFocus=function(){this.adapter.addClass(vg.FOCUSED),this.layout(),this.adapter.activateBottomLine()},e.prototype.handleBlur=function(){this.isMenuOpen||this.blur()},e.prototype.handleClick=function(t){this.disabled||this.recentlyClicked||(this.setClickDebounceTimeout(),this.isMenuOpen?this.adapter.closeMenu():(this.adapter.setRippleCenter(t),this.openMenu()))},e.prototype.handleKeydown=function(t){if(!this.isMenuOpen&&this.adapter.hasClass(vg.FOCUSED)){var e=tu(t)===Sd,n=tu(t)===Id,i=tu(t)===Nd,o=tu(t)===Pd;if(!n&&t.key&&1===t.key.length||n&&this.adapter.isTypeaheadInProgress()){var r=n?" ":t.key,s=this.adapter.typeaheadMatchItem(r,this.getSelectedIndex());return s>=0&&this.setSelectedIndex(s),void t.preventDefault()}(e||n||i||o)&&(i&&this.getSelectedIndex()>0?this.setSelectedIndex(this.getSelectedIndex()-1):o&&this.getSelectedIndex()<this.adapter.getMenuItemCount()-1&&this.setSelectedIndex(this.getSelectedIndex()+1),this.openMenu(),t.preventDefault())}},e.prototype.notchOutline=function(t){if(this.adapter.hasOutline()){var e=this.adapter.hasClass(vg.FOCUSED);if(t){var n=bg.LABEL_SCALE,i=this.adapter.getLabelWidth()*n;this.adapter.notchOutline(i)}else e||this.adapter.closeOutline()}},e.prototype.setLeadingIconAriaLabel=function(t){this.leadingIcon&&this.leadingIcon.setAriaLabel(t)},e.prototype.setLeadingIconContent=function(t){this.leadingIcon&&this.leadingIcon.setContent(t)},e.prototype.setUseDefaultValidation=function(t){this.useDefaultValidation=t},e.prototype.setValid=function(t){this.useDefaultValidation||(this.customValidity=t),this.adapter.setSelectAnchorAttr("aria-invalid",(!t).toString()),t?(this.adapter.removeClass(vg.INVALID),this.adapter.removeMenuClass(vg.MENU_INVALID)):(this.adapter.addClass(vg.INVALID),this.adapter.addMenuClass(vg.MENU_INVALID)),this.syncHelperTextValidity(t)},e.prototype.isValid=function(){return this.useDefaultValidation&&this.adapter.hasClass(vg.REQUIRED)&&!this.adapter.hasClass(vg.DISABLED)?this.getSelectedIndex()!==bg.UNSET_INDEX&&(0!==this.getSelectedIndex()||Boolean(this.getValue())):this.customValidity},e.prototype.setRequired=function(t){t?this.adapter.addClass(vg.REQUIRED):this.adapter.removeClass(vg.REQUIRED),this.adapter.setSelectAnchorAttr("aria-required",t.toString()),this.adapter.setLabelRequired(t)},e.prototype.getRequired=function(){return"true"===this.adapter.getSelectAnchorAttr("aria-required")},e.prototype.init=function(){var t=this.adapter.getAnchorElement();t&&(this.adapter.setMenuAnchorElement(t),this.adapter.setMenuAnchorCorner(Qu.BOTTOM_START)),this.adapter.setMenuWrapFocus(!1),this.setDisabled(this.adapter.hasClass(vg.DISABLED)),this.syncHelperTextValidity(!this.adapter.hasClass(vg.INVALID)),this.layout(),this.layoutOptions()},e.prototype.blur=function(){this.adapter.removeClass(vg.FOCUSED),this.layout(),this.adapter.deactivateBottomLine(),this.adapter.hasClass(vg.REQUIRED)&&this.useDefaultValidation&&this.setValid(this.isValid())},e.prototype.syncHelperTextValidity=function(t){if(this.helperText){this.helperText.setValidity(t);var e=this.helperText.isVisible(),n=this.helperText.getId();e&&n?this.adapter.setSelectAnchorAttr(yg.ARIA_DESCRIBEDBY,n):this.adapter.removeSelectAnchorAttr(yg.ARIA_DESCRIBEDBY)}},e.prototype.setClickDebounceTimeout=function(){var t=this;clearTimeout(this.clickDebounceTimeout),this.clickDebounceTimeout=setTimeout((function(){t.recentlyClicked=!1}),bg.CLICK_DEBOUNCE_TIMEOUT_MS),this.recentlyClicked=!0},e}(Et);let Tg,Rg,Cg,xg,Sg,Ig,Og,kg,wg,Ag=t=>t,Dg=class extends eg{};Dg.styles=ng,Dg=t([],Dg);let Ng=class extends lt{render(){return F(Tg||(Tg=Ag`<slot></slot>`))}};Ng.styles=dl,Ng=t([],Ng);const Lg=(t={})=>{const e={};for(const n in t)e[n]=t[n];return Object.assign({badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valid:!0,valueMissing:!1},e)};class Pg extends wa{constructor(){super(...arguments),this.mdcFoundationClass=Eg,this.disabled=!1,this.outlined=!1,this.label="",this.outlineOpen=!1,this.outlineWidth=0,this.value="",this.selectedText="",this.icon="",this.menuOpen=!1,this.helper="",this.validateOnInitialRender=!1,this.validationMessage="",this.required=!1,this.naturalMenuWidth=!1,this.isUiValid=!0,this.typeaheadState={bufferClearTimeout:0,currentFirstChar:"",sortedIndexCursor:0,typeaheadBuffer:""},this.sortedIndexByFirstChar=new Map,this.menuElement_=null,this.listeners=[],this.onBodyClickBound=()=>{},this._menuUpdateComplete=null,this.renderReady=!1,this.valueSetDirectly=!1,this.validityTransform=null,this._validity=Lg()}get items(){return this.menuElement_||(this.menuElement_=this.menuElement),this.menuElement_?this.menuElement_.items:[]}get selected(){const t=this.menuElement;return t?t.selected:null}get index(){const t=this.menuElement;return t?t.index:-1}get shouldRenderHelperText(){return!!this.helper||!!this.validationMessage}get validity(){return this._checkValidity(this.value),this._validity}render(){const t={"mdc-select--disabled":this.disabled,"mdc-select--no-label":!this.label,"mdc-select--filled":!this.outlined,"mdc-select--outlined":this.outlined,"mdc-select--with-leading-icon":!!this.icon,"mdc-select--required":this.required,"mdc-select--invalid":!this.isUiValid},e={"mdc-select__menu--invalid":!this.isUiValid},n=this.shouldRenderHelperText?"helper-text":void 0;return F(Rg||(Rg=Ag` <div class="mdc-select ${0}"> <input class="formElement" .value="${0}" hidden ?required="${0}"> <div class="mdc-select__anchor" aria-autocomplete="none" role="combobox" aria-expanded="${0}" aria-invalid="${0}" aria-haspopup="listbox" aria-labelledby="label" aria-required="${0}" aria-describedby="${0}" @click="${0}" @focus="${0}" @blur="${0}" @keydown="${0}"> ${0} ${0} ${0} <span class="mdc-select__selected-text-container"> <span class="mdc-select__selected-text">${0}</span> </span> <span class="mdc-select__dropdown-icon"> <svg class="mdc-select__dropdown-icon-graphic" viewBox="7 10 10 5" focusable="false"> <polygon class="mdc-select__dropdown-icon-inactive" stroke="none" fill-rule="evenodd" points="7 10 12 15 17 10"> </polygon> <polygon class="mdc-select__dropdown-icon-active" stroke="none" fill-rule="evenodd" points="7 15 12 10 17 15"> </polygon> </svg> </span> ${0} </div> <mwc-menu innerRole="listbox" wrapFocus class="mdc-select__menu mdc-menu mdc-menu-surface ${0}" activatable .fullwidth="${0}" .open="${0}" .anchor="${0}" @selected="${0}" @opened="${0}" @closed="${0}" @items-updated="${0}" @keydown="${0}"> <slot></slot> </mwc-menu> </div> ${0}`),Nt(t),this.value,this.required,this.menuOpen,!this.isUiValid,this.required,$t(n),this.onClick,this.onFocus,this.onBlur,this.onKeydown,this.renderRipple(),this.outlined?this.renderOutline():this.renderLabel(),this.renderLeadingIcon(),this.selectedText,this.renderLineRipple(),Nt(e),!this.naturalMenuWidth,this.menuOpen,this.anchorElement,this.onSelected,this.onOpened,this.onClosed,this.onItemsUpdated,this.handleTypeahead,this.renderHelperText())}renderRipple(){return this.outlined?v:F(Cg||(Cg=Ag` <span class="mdc-select__ripple"></span> `))}renderOutline(){return this.outlined?F(xg||(xg=Ag` <mwc-notched-outline .width="${0}" .open="${0}" class="mdc-notched-outline"> ${0} </mwc-notched-outline>`),this.outlineWidth,this.outlineOpen,this.renderLabel()):v}renderLabel(){return this.label?F(Sg||(Sg=Ag` <span .floatingLabelFoundation="${0}" id="label">${0}</span> `),Ia(this.label),this.label):v}renderLeadingIcon(){return this.icon?F(Ig||(Ig=Ag`<mwc-icon class="mdc-select__icon"><div>${0}</div></mwc-icon>`),this.icon):v}renderLineRipple(){return this.outlined?v:F(Og||(Og=Ag` <span .lineRippleFoundation="${0}"></span> `),ka())}renderHelperText(){if(!this.shouldRenderHelperText)return v;const t=this.validationMessage&&!this.isUiValid;return F(kg||(kg=Ag` <p class="mdc-select-helper-text ${0}" id="helper-text">${0}</p>`),Nt({"mdc-select-helper-text--validation-msg":t}),t?this.validationMessage:this.helper)}createAdapter(){return Object.assign(Object.assign({},ht(this.mdcRoot)),{activateBottomLine:()=>{this.lineRippleElement&&this.lineRippleElement.lineRippleFoundation.activate()},deactivateBottomLine:()=>{this.lineRippleElement&&this.lineRippleElement.lineRippleFoundation.deactivate()},hasLabel:()=>!!this.label,floatLabel:t=>{this.labelElement&&this.labelElement.floatingLabelFoundation.float(t)},getLabelWidth:()=>this.labelElement?this.labelElement.floatingLabelFoundation.getWidth():0,setLabelRequired:t=>{this.labelElement&&this.labelElement.floatingLabelFoundation.setRequired(t)},hasOutline:()=>this.outlined,notchOutline:t=>{this.outlineElement&&!this.outlineOpen&&(this.outlineWidth=t,this.outlineOpen=!0)},closeOutline:()=>{this.outlineElement&&(this.outlineOpen=!1)},setRippleCenter:t=>{if(this.lineRippleElement){this.lineRippleElement.lineRippleFoundation.setRippleCenter(t)}},notifyChange:async t=>{if(!this.valueSetDirectly&&t===this.value)return;this.valueSetDirectly=!1,this.value=t,await this.updateComplete;const e=new Event("change",{bubbles:!0});this.dispatchEvent(e)},setSelectedText:t=>this.selectedText=t,isSelectAnchorFocused:()=>{const t=this.anchorElement;if(!t)return!1;return t.getRootNode().activeElement===t},getSelectAnchorAttr:t=>{const e=this.anchorElement;return e?e.getAttribute(t):null},setSelectAnchorAttr:(t,e)=>{const n=this.anchorElement;n&&n.setAttribute(t,e)},removeSelectAnchorAttr:t=>{const e=this.anchorElement;e&&e.removeAttribute(t)},openMenu:()=>{this.menuOpen=!0},closeMenu:()=>{this.menuOpen=!1},addMenuClass:()=>{},removeMenuClass:()=>{},getAnchorElement:()=>this.anchorElement,setMenuAnchorElement:()=>{},setMenuAnchorCorner:()=>{const t=this.menuElement;t&&(t.corner="BOTTOM_START")},setMenuWrapFocus:t=>{const e=this.menuElement;e&&(e.wrapFocus=t)},focusMenuItemAtIndex:t=>{const e=this.menuElement;if(!e)return;const n=e.items[t];n&&n.focus()},getMenuItemCount:()=>{const t=this.menuElement;return t?t.items.length:0},getMenuItemValues:()=>{const t=this.menuElement;if(!t)return[];return t.items.map((t=>t.value))},getMenuItemTextAtIndex:t=>{const e=this.menuElement;if(!e)return"";const n=e.items[t];return n?n.text:""},getSelectedIndex:()=>this.index,setSelectedIndex:()=>{},isTypeaheadInProgress:()=>fg(this.typeaheadState),typeaheadMatchItem:(t,e)=>{if(!this.menuElement)return-1;const n=gg({focusItemAtIndex:t=>{this.menuElement.focusItemAtIndex(t)},focusedItemIndex:e||this.menuElement.getFocusedItemIndex(),nextChar:t,sortedIndexByFirstChar:this.sortedIndexByFirstChar,skipFocus:!1,isItemAtIndexDisabled:t=>this.items[t].disabled},this.typeaheadState);return-1!==n&&this.select(n),n}})}checkValidity(){const t=this._checkValidity(this.value);if(!t){const t=new Event("invalid",{bubbles:!1,cancelable:!0});this.dispatchEvent(t)}return t}reportValidity(){const t=this.checkValidity();return this.isUiValid=t,t}_checkValidity(t){const e=this.formElement.validity;let n=Lg(e);if(this.validityTransform){const e=this.validityTransform(t,n);n=Object.assign(Object.assign({},n),e)}return this._validity=n,this._validity.valid}setCustomValidity(t){this.validationMessage=t,this.formElement.setCustomValidity(t)}async _getUpdateComplete(){await this._menuUpdateComplete,await super._getUpdateComplete()}async firstUpdated(){const t=this.menuElement;if(t&&(this._menuUpdateComplete=t.updateComplete,await this._menuUpdateComplete),super.firstUpdated(),this.mdcFoundation.isValid=()=>!0,this.mdcFoundation.setValid=()=>{},this.mdcFoundation.setDisabled(this.disabled),this.validateOnInitialRender&&this.reportValidity(),!this.selected){!this.items.length&&this.slotElement&&this.slotElement.assignedNodes({flatten:!0}).length&&(await new Promise((t=>requestAnimationFrame(t))),await this.layout());const t=this.items.length&&""===this.items[0].value;if(!this.value&&t)return void this.select(0);this.selectByValue(this.value)}this.sortedIndexByFirstChar=pg(this.items.length,(t=>this.items[t].text)),this.renderReady=!0}onItemsUpdated(){this.sortedIndexByFirstChar=pg(this.items.length,(t=>this.items[t].text))}select(t){const e=this.menuElement;e&&e.select(t)}selectByValue(t){let e=-1;for(let n=0;n<this.items.length;n++){if(this.items[n].value===t){e=n;break}}this.valueSetDirectly=!0,this.select(e),this.mdcFoundation.handleChange()}disconnectedCallback(){super.disconnectedCallback();for(const t of this.listeners)t.target.removeEventListener(t.name,t.cb)}focus(){const t=new CustomEvent("focus"),e=this.anchorElement;e&&(e.dispatchEvent(t),e.focus())}blur(){const t=new CustomEvent("blur"),e=this.anchorElement;e&&(e.dispatchEvent(t),e.blur())}onFocus(){this.mdcFoundation&&this.mdcFoundation.handleFocus()}onBlur(){this.mdcFoundation&&this.mdcFoundation.handleBlur();const t=this.menuElement;t&&!t.open&&this.reportValidity()}onClick(t){if(this.mdcFoundation){this.focus();const e=t.target.getBoundingClientRect();let n=0;n="touches"in t?t.touches[0].clientX:t.clientX;const i=n-e.left;this.mdcFoundation.handleClick(i)}}onKeydown(t){const e=tu(t)===Nd,n=tu(t)===Pd;if(n||e){const i=e&&this.index>0,o=n&&this.index<this.items.length-1;return i?this.select(this.index-1):o&&this.select(this.index+1),t.preventDefault(),void this.mdcFoundation.openMenu()}this.mdcFoundation.handleKeydown(t)}handleTypeahead(t){if(!this.menuElement)return;const e=this.menuElement.getFocusedItemIndex(),n=dt(t.target)?t.target:null;!function(t,e){var n=t.event,i=t.isTargetListItem,o=t.focusedItemIndex,r=t.focusItemAtIndex,s=t.sortedIndexByFirstChar,a=t.isItemAtIndexDisabled,l="ArrowLeft"===tu(n),c="ArrowUp"===tu(n),d="ArrowRight"===tu(n),u="ArrowDown"===tu(n),h="Home"===tu(n),p="End"===tu(n),g="Enter"===tu(n),f="Spacebar"===tu(n);l||c||d||u||h||p||g||(f||1!==n.key.length?f&&(i&&hg(n),i&&fg(e)&&gg({focusItemAtIndex:r,focusedItemIndex:o,nextChar:" ",sortedIndexByFirstChar:s,skipFocus:!1,isItemAtIndexDisabled:a},e)):(hg(n),gg({focusItemAtIndex:r,focusedItemIndex:o,nextChar:n.key.toLowerCase(),sortedIndexByFirstChar:s,skipFocus:!1,isItemAtIndexDisabled:a},e)))}({event:t,focusItemAtIndex:t=>{this.menuElement.focusItemAtIndex(t)},focusedItemIndex:e,isTargetListItem:!!n&&n.hasAttribute("mwc-list-item"),sortedIndexByFirstChar:this.sortedIndexByFirstChar,isItemAtIndexDisabled:t=>this.items[t].disabled},this.typeaheadState)}async onSelected(t){this.mdcFoundation||await this.updateComplete,this.mdcFoundation.handleMenuItemAction(t.detail.index);const e=this.items[t.detail.index];e&&(this.value=e.value)}onOpened(){this.mdcFoundation&&(this.menuOpen=!0,this.mdcFoundation.handleMenuOpened())}onClosed(){this.mdcFoundation&&(this.menuOpen=!1,this.mdcFoundation.handleMenuClosed())}async layout(t=!0){this.mdcFoundation&&this.mdcFoundation.layout(),await this.updateComplete;const e=this.menuElement;e&&e.layout(t);const n=this.labelElement;if(!n)return void(this.outlineOpen=!1);const i=!!this.label&&!!this.value;if(n.floatingLabelFoundation.float(i),!this.outlined)return;this.outlineOpen=i,await this.updateComplete;const o=n.floatingLabelFoundation.getWidth();this.outlineOpen&&(this.outlineWidth=o)}}t([Z(".mdc-select")],Pg.prototype,"mdcRoot",void 0),t([Z(".formElement")],Pg.prototype,"formElement",void 0),t([Z("slot")],Pg.prototype,"slotElement",void 0),t([Z("select")],Pg.prototype,"nativeSelectElement",void 0),t([Z("input")],Pg.prototype,"nativeInputElement",void 0),t([Z(".mdc-line-ripple")],Pg.prototype,"lineRippleElement",void 0),t([Z(".mdc-floating-label")],Pg.prototype,"labelElement",void 0),t([Z("mwc-notched-outline")],Pg.prototype,"outlineElement",void 0),t([Z(".mdc-menu")],Pg.prototype,"menuElement",void 0),t([Z(".mdc-select__anchor")],Pg.prototype,"anchorElement",void 0),t([J({type:Boolean,attribute:"disabled",reflect:!0}),vt((function(t){this.renderReady&&this.mdcFoundation.setDisabled(t)}))],Pg.prototype,"disabled",void 0),t([J({type:Boolean}),vt((function(t,e){void 0!==e&&this.outlined!==e&&this.layout(!1)}))],Pg.prototype,"outlined",void 0),t([J({type:String}),vt((function(t,e){void 0!==e&&this.label!==e&&this.layout(!1)}))],Pg.prototype,"label",void 0),t([J({type:Boolean})],Pg.prototype,"outlineOpen",void 0),t([J({type:Number})],Pg.prototype,"outlineWidth",void 0),t([J({type:String}),vt((function(t){if(this.mdcFoundation){const e=null===this.selected&&!!t,n=this.selected&&this.selected.value!==t;(e||n)&&this.selectByValue(t),this.reportValidity()}}))],Pg.prototype,"value",void 0),t([J({type:String})],Pg.prototype,"selectedText",void 0),t([J({type:String})],Pg.prototype,"icon",void 0),t([J({type:Boolean})],Pg.prototype,"menuOpen",void 0),t([J({type:String})],Pg.prototype,"helper",void 0),t([J({type:Boolean})],Pg.prototype,"validateOnInitialRender",void 0),t([J({type:String})],Pg.prototype,"validationMessage",void 0),t([J({type:Boolean})],Pg.prototype,"required",void 0),t([J({type:Boolean})],Pg.prototype,"naturalMenuWidth",void 0),t([J({type:Boolean})],Pg.prototype,"isUiValid",void 0),t([nt({capture:!0})],Pg.prototype,"handleTypeahead",null);const Mg=st(wg||(wg=Ag`.mdc-floating-label{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto,sans-serif;font-family:var(--mdc-typography-subtitle1-font-family,var(--mdc-typography-font-family,Roboto,sans-serif));font-size:1rem;font-size:var(--mdc-typography-subtitle1-font-size,1rem);font-weight:400;font-weight:var(--mdc-typography-subtitle1-font-weight,400);letter-spacing:.009375em;letter-spacing:var(--mdc-typography-subtitle1-letter-spacing,.009375em);text-decoration:inherit;text-decoration:var(--mdc-typography-subtitle1-text-decoration,inherit);text-transform:inherit;text-transform:var(--mdc-typography-subtitle1-text-transform,inherit);position:absolute;left:0;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform;transition:transform 150ms cubic-bezier(.4,0,.2,1),color 150ms cubic-bezier(.4,0,.2,1)}.mdc-floating-label[dir=rtl],[dir=rtl] .mdc-floating-label{right:0;left:auto;transform-origin:right top;text-align:right}.mdc-floating-label--float-above{cursor:auto}.mdc-floating-label--required::after{margin-left:1px;margin-right:0;content:"*"}.mdc-floating-label--required[dir=rtl]::after,[dir=rtl] .mdc-floating-label--required::after{margin-left:0;margin-right:1px}.mdc-floating-label--float-above{transform:translateY(-106%) scale(.75)}.mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-standard 250ms 1}@keyframes mdc-floating-label-shake-float-above-standard{0%{transform:translateX(calc(0 - 0)) translateY(-106%) scale(.75)}33%{animation-timing-function:cubic-bezier(.5,0,.701732,.495819);transform:translateX(calc(4% - 0)) translateY(-106%) scale(.75)}66%{animation-timing-function:cubic-bezier(.302435,.381352,.55,.956352);transform:translateX(calc(-4% - 0)) translateY(-106%) scale(.75)}100%{transform:translateX(calc(0 - 0)) translateY(-106%) scale(.75)}}@keyframes mdc-ripple-fg-radius-in{from{animation-timing-function:cubic-bezier(.4,0,.2,1);transform:translate(var(--mdc-ripple-fg-translate-start,0)) scale(1)}to{transform:translate(var(--mdc-ripple-fg-translate-end,0)) scale(var(--mdc-ripple-fg-scale,1))}}@keyframes mdc-ripple-fg-opacity-in{from{animation-timing-function:linear;opacity:0}to{opacity:var(--mdc-ripple-fg-opacity,0)}}@keyframes mdc-ripple-fg-opacity-out{from{animation-timing-function:linear;opacity:var(--mdc-ripple-fg-opacity,0)}to{opacity:0}}.mdc-line-ripple::after,.mdc-line-ripple::before{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{border-bottom-width:1px;z-index:1}.mdc-line-ripple::after{transform:scaleX(0);border-bottom-width:2px;opacity:0;z-index:2}.mdc-line-ripple::after{transition:transform 180ms cubic-bezier(.4,0,.2,1),opacity 180ms cubic-bezier(.4,0,.2,1)}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}.mdc-notched-outline[dir=rtl],[dir=rtl] .mdc-notched-outline{text-align:right}.mdc-notched-outline__leading,.mdc-notched-outline__notch,.mdc-notched-outline__trailing{box-sizing:border-box;height:100%;border-top:1px solid;border-bottom:1px solid;pointer-events:none}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;width:12px}.mdc-notched-outline__leading[dir=rtl],[dir=rtl] .mdc-notched-outline__leading{border-left:none;border-right:1px solid}.mdc-notched-outline__trailing{border-left:none;border-right:1px solid;flex-grow:1}.mdc-notched-outline__trailing[dir=rtl],[dir=rtl] .mdc-notched-outline__trailing{border-left:1px solid;border-right:none}.mdc-notched-outline__notch{flex:0 0 auto;width:auto;max-width:calc(100% - 12px * 2)}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(100% / .75)}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none}.mdc-notched-outline--notched .mdc-notched-outline__notch[dir=rtl],[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}.mdc-select{display:inline-flex;position:relative}.mdc-select:not(.mdc-select--disabled) .mdc-select__selected-text{color:rgba(0,0,0,.87)}.mdc-select.mdc-select--disabled .mdc-select__selected-text{color:rgba(0,0,0,.38)}.mdc-select:not(.mdc-select--disabled) .mdc-floating-label{color:rgba(0,0,0,.6)}.mdc-select:not(.mdc-select--disabled).mdc-select--focused .mdc-floating-label{color:rgba(98,0,238,.87)}.mdc-select.mdc-select--disabled .mdc-floating-label{color:rgba(0,0,0,.38)}.mdc-select:not(.mdc-select--disabled) .mdc-select__dropdown-icon{fill:rgba(0,0,0,.54)}.mdc-select:not(.mdc-select--disabled).mdc-select--focused .mdc-select__dropdown-icon{fill:#6200ee;fill:var(--mdc-theme-primary,#6200ee)}.mdc-select.mdc-select--disabled .mdc-select__dropdown-icon{fill:rgba(0,0,0,.38)}.mdc-select:not(.mdc-select--disabled)+.mdc-select-helper-text{color:rgba(0,0,0,.6)}.mdc-select.mdc-select--disabled+.mdc-select-helper-text{color:rgba(0,0,0,.38)}.mdc-select:not(.mdc-select--disabled) .mdc-select__icon{color:rgba(0,0,0,.54)}.mdc-select.mdc-select--disabled .mdc-select__icon{color:rgba(0,0,0,.38)}@media screen and (-ms-high-contrast:active){.mdc-select.mdc-select--disabled .mdc-select__selected-text{color:GrayText}.mdc-select.mdc-select--disabled .mdc-select__dropdown-icon{fill:red}.mdc-select.mdc-select--disabled .mdc-floating-label{color:GrayText}.mdc-select.mdc-select--disabled .mdc-line-ripple::before{border-bottom-color:GrayText}.mdc-select.mdc-select--disabled .mdc-notched-outline__leading,.mdc-select.mdc-select--disabled .mdc-notched-outline__notch,.mdc-select.mdc-select--disabled .mdc-notched-outline__trailing{border-color:GrayText}.mdc-select.mdc-select--disabled .mdc-select__icon{color:GrayText}.mdc-select.mdc-select--disabled+.mdc-select-helper-text{color:GrayText}}.mdc-select .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-select .mdc-select__anchor{padding-left:16px;padding-right:0}.mdc-select .mdc-select__anchor[dir=rtl],[dir=rtl] .mdc-select .mdc-select__anchor{padding-left:0;padding-right:16px}.mdc-select.mdc-select--with-leading-icon .mdc-select__anchor{padding-left:0;padding-right:0}.mdc-select.mdc-select--with-leading-icon .mdc-select__anchor[dir=rtl],[dir=rtl] .mdc-select.mdc-select--with-leading-icon .mdc-select__anchor{padding-left:0;padding-right:0}.mdc-select .mdc-select__icon{width:24px;height:24px;font-size:24px}.mdc-select .mdc-select__dropdown-icon{width:24px;height:24px}.mdc-select .mdc-select__menu .mdc-list-item{padding-left:16px;padding-right:16px}.mdc-select .mdc-select__menu .mdc-list-item[dir=rtl],[dir=rtl] .mdc-select .mdc-select__menu .mdc-list-item{padding-left:16px;padding-right:16px}.mdc-select .mdc-select__menu .mdc-list-item__graphic{margin-left:0;margin-right:12px}.mdc-select .mdc-select__menu .mdc-list-item__graphic[dir=rtl],[dir=rtl] .mdc-select .mdc-select__menu .mdc-list-item__graphic{margin-left:12px;margin-right:0}.mdc-select__dropdown-icon{margin-left:12px;margin-right:12px;display:inline-flex;position:relative;align-self:center;align-items:center;justify-content:center;flex-shrink:0;pointer-events:none}.mdc-select__dropdown-icon .mdc-select__dropdown-icon-active,.mdc-select__dropdown-icon .mdc-select__dropdown-icon-inactive{position:absolute;top:0;left:0}.mdc-select__dropdown-icon .mdc-select__dropdown-icon-graphic{width:41.6666666667%;height:20.8333333333%}.mdc-select__dropdown-icon .mdc-select__dropdown-icon-inactive{opacity:1;transition:opacity 75ms linear 75ms}.mdc-select__dropdown-icon .mdc-select__dropdown-icon-active{opacity:0;transition:opacity 75ms linear}.mdc-select__dropdown-icon[dir=rtl],[dir=rtl] .mdc-select__dropdown-icon{margin-left:12px;margin-right:12px}.mdc-select--activated .mdc-select__dropdown-icon .mdc-select__dropdown-icon-inactive{opacity:0;transition:opacity 49.5ms linear}.mdc-select--activated .mdc-select__dropdown-icon .mdc-select__dropdown-icon-active{opacity:1;transition:opacity .1s linear 49.5ms}.mdc-select__anchor{width:200px;min-width:0;flex:1 1 auto;position:relative;box-sizing:border-box;overflow:hidden;outline:0;cursor:pointer}.mdc-select__anchor .mdc-floating-label--float-above{transform:translateY(-106%) scale(.75)}.mdc-select__selected-text-container{display:flex;appearance:none;pointer-events:none;box-sizing:border-box;width:auto;min-width:0;flex-grow:1;height:28px;border:none;outline:0;padding:0;background-color:transparent;color:inherit}.mdc-select__selected-text{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto,sans-serif;font-family:var(--mdc-typography-subtitle1-font-family,var(--mdc-typography-font-family,Roboto,sans-serif));font-size:1rem;font-size:var(--mdc-typography-subtitle1-font-size,1rem);line-height:1.75rem;line-height:var(--mdc-typography-subtitle1-line-height,1.75rem);font-weight:400;font-weight:var(--mdc-typography-subtitle1-font-weight,400);letter-spacing:.009375em;letter-spacing:var(--mdc-typography-subtitle1-letter-spacing,.009375em);text-decoration:inherit;text-decoration:var(--mdc-typography-subtitle1-text-decoration,inherit);text-transform:inherit;text-transform:var(--mdc-typography-subtitle1-text-transform,inherit);text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block;width:100%;text-align:left}.mdc-select__selected-text[dir=rtl],[dir=rtl] .mdc-select__selected-text{text-align:right}.mdc-select--invalid:not(.mdc-select--disabled) .mdc-floating-label{color:#b00020;color:var(--mdc-theme-error,#b00020)}.mdc-select--invalid:not(.mdc-select--disabled).mdc-select--focused .mdc-floating-label{color:#b00020;color:var(--mdc-theme-error,#b00020)}.mdc-select--invalid:not(.mdc-select--disabled).mdc-select--invalid+.mdc-select-helper-text--validation-msg{color:#b00020;color:var(--mdc-theme-error,#b00020)}.mdc-select--invalid:not(.mdc-select--disabled) .mdc-select__dropdown-icon{fill:#b00020;fill:var(--mdc-theme-error,#b00020)}.mdc-select--invalid:not(.mdc-select--disabled).mdc-select--focused .mdc-select__dropdown-icon{fill:#b00020;fill:var(--mdc-theme-error,#b00020)}.mdc-select--disabled{cursor:default;pointer-events:none}.mdc-select--with-leading-icon .mdc-select__menu .mdc-list-item{padding-left:12px;padding-right:12px}.mdc-select--with-leading-icon .mdc-select__menu .mdc-list-item[dir=rtl],[dir=rtl] .mdc-select--with-leading-icon .mdc-select__menu .mdc-list-item{padding-left:12px;padding-right:12px}.mdc-select__menu .mdc-list .mdc-select__icon{margin-left:0;margin-right:0}.mdc-select__menu .mdc-list .mdc-select__icon[dir=rtl],[dir=rtl] .mdc-select__menu .mdc-list .mdc-select__icon{margin-left:0;margin-right:0}.mdc-select__menu .mdc-list .mdc-list-item--activated,.mdc-select__menu .mdc-list .mdc-list-item--selected{color:#000;color:var(--mdc-theme-on-surface,#000)}.mdc-select__menu .mdc-list .mdc-list-item--activated .mdc-list-item__graphic,.mdc-select__menu .mdc-list .mdc-list-item--selected .mdc-list-item__graphic{color:#000;color:var(--mdc-theme-on-surface,#000)}.mdc-select--filled .mdc-select__anchor{height:56px;display:flex;align-items:baseline}.mdc-select--filled .mdc-select__anchor::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}.mdc-select--filled.mdc-select--no-label .mdc-select__anchor .mdc-select__selected-text::before{content:"â€‹"}.mdc-select--filled.mdc-select--no-label .mdc-select__anchor .mdc-select__selected-text-container{height:100%;display:inline-flex;align-items:center}.mdc-select--filled.mdc-select--no-label .mdc-select__anchor::before{display:none}.mdc-select--filled .mdc-select__anchor{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small,4px);border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small,4px);border-bottom-right-radius:0;border-bottom-left-radius:0}.mdc-select--filled:not(.mdc-select--disabled) .mdc-select__anchor{background-color:#f5f5f5}.mdc-select--filled.mdc-select--disabled .mdc-select__anchor{background-color:#fafafa}.mdc-select--filled:not(.mdc-select--disabled) .mdc-line-ripple::before{border-bottom-color:rgba(0,0,0,.42)}.mdc-select--filled:not(.mdc-select--disabled):hover .mdc-line-ripple::before{border-bottom-color:rgba(0,0,0,.87)}.mdc-select--filled:not(.mdc-select--disabled) .mdc-line-ripple::after{border-bottom-color:#6200ee;border-bottom-color:var(--mdc-theme-primary,#6200ee)}.mdc-select--filled.mdc-select--disabled .mdc-line-ripple::before{border-bottom-color:rgba(0,0,0,.06)}.mdc-select--filled .mdc-floating-label{max-width:calc(100% - 64px)}.mdc-select--filled .mdc-floating-label--float-above{max-width:calc(100% / .75 - 64px / .75)}.mdc-select--filled .mdc-menu-surface--is-open-below{border-top-left-radius:0;border-top-right-radius:0}.mdc-select--filled.mdc-select--focused.mdc-line-ripple::after{transform:scale(1,2);opacity:1}.mdc-select--filled .mdc-floating-label{left:16px;right:initial}.mdc-select--filled .mdc-floating-label[dir=rtl],[dir=rtl] .mdc-select--filled .mdc-floating-label{left:initial;right:16px}.mdc-select--filled.mdc-select--with-leading-icon .mdc-floating-label{left:48px;right:initial}.mdc-select--filled.mdc-select--with-leading-icon .mdc-floating-label[dir=rtl],[dir=rtl] .mdc-select--filled.mdc-select--with-leading-icon .mdc-floating-label{left:initial;right:48px}.mdc-select--filled.mdc-select--with-leading-icon .mdc-floating-label{max-width:calc(100% - 96px)}.mdc-select--filled.mdc-select--with-leading-icon .mdc-floating-label--float-above{max-width:calc(100% / .75 - 96px / .75)}.mdc-select--invalid:not(.mdc-select--disabled) .mdc-line-ripple::before{border-bottom-color:#b00020;border-bottom-color:var(--mdc-theme-error,#b00020)}.mdc-select--invalid:not(.mdc-select--disabled):hover .mdc-line-ripple::before{border-bottom-color:#b00020;border-bottom-color:var(--mdc-theme-error,#b00020)}.mdc-select--invalid:not(.mdc-select--disabled) .mdc-line-ripple::after{border-bottom-color:#b00020;border-bottom-color:var(--mdc-theme-error,#b00020)}.mdc-select--outlined{border:none}.mdc-select--outlined .mdc-select__anchor{height:56px}.mdc-select--outlined .mdc-select__anchor .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1)}.mdc-select--outlined .mdc-select__anchor .mdc-floating-label--float-above{font-size:.75rem}.mdc-select--outlined .mdc-select__anchor .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-select--outlined .mdc-select__anchor.mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(.75)}.mdc-select--outlined .mdc-select__anchor .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-select--outlined .mdc-select__anchor.mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-select--outlined .mdc-select__anchor .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-select-outlined-56px 250ms 1}@keyframes mdc-floating-label-shake-float-above-select-outlined-56px{0%{transform:translateX(calc(0 - 0)) translateY(-34.75px) scale(.75)}33%{animation-timing-function:cubic-bezier(.5,0,.701732,.495819);transform:translateX(calc(4% - 0)) translateY(-34.75px) scale(.75)}66%{animation-timing-function:cubic-bezier(.302435,.381352,.55,.956352);transform:translateX(calc(-4% - 0)) translateY(-34.75px) scale(.75)}100%{transform:translateX(calc(0 - 0)) translateY(-34.75px) scale(.75)}}.mdc-select--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small,4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small,4px)}.mdc-select--outlined .mdc-notched-outline .mdc-notched-outline__leading[dir=rtl],[dir=rtl] .mdc-select--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small,4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small,4px);border-bottom-left-radius:0}@supports(top:max(0%)){.mdc-select--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-shape-small,4px))}}@supports(top:max(0%)){.mdc-select--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:calc(100% - max(12px,var(--mdc-shape-small,4px)) * 2)}}.mdc-select--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:0;border-top-right-radius:4px;border-top-right-radius:var(--mdc-shape-small,4px);border-bottom-right-radius:4px;border-bottom-right-radius:var(--mdc-shape-small,4px);border-bottom-left-radius:0}.mdc-select--outlined .mdc-notched-outline .mdc-notched-outline__trailing[dir=rtl],[dir=rtl] .mdc-select--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-top-left-radius:4px;border-top-left-radius:var(--mdc-shape-small,4px);border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:4px;border-bottom-left-radius:var(--mdc-shape-small,4px)}@supports(top:max(0%)){.mdc-select--outlined .mdc-select__anchor{padding-left:max(16px,calc(var(--mdc-shape-small,4px) + 4px))}}.mdc-select--outlined .mdc-select__anchor[dir=rtl],[dir=rtl] .mdc-select--outlined .mdc-select__anchor{padding-left:0}@supports(top:max(0%)){.mdc-select--outlined .mdc-select__anchor[dir=rtl],[dir=rtl] .mdc-select--outlined .mdc-select__anchor{padding-right:max(16px,calc(var(--mdc-shape-small,4px) + 4px))}}@supports(top:max(0%)){.mdc-select--outlined+.mdc-select-helper-text{margin-left:max(16px,calc(var(--mdc-shape-small,4px) + 4px))}}.mdc-select--outlined+.mdc-select-helper-text[dir=rtl],[dir=rtl] .mdc-select--outlined+.mdc-select-helper-text{margin-left:0}@supports(top:max(0%)){.mdc-select--outlined+.mdc-select-helper-text[dir=rtl],[dir=rtl] .mdc-select--outlined+.mdc-select-helper-text{margin-right:max(16px,calc(var(--mdc-shape-small,4px) + 4px))}}.mdc-select--outlined:not(.mdc-select--disabled) .mdc-select__anchor{background-color:transparent}.mdc-select--outlined.mdc-select--disabled .mdc-select__anchor{background-color:transparent}.mdc-select--outlined:not(.mdc-select--disabled) .mdc-notched-outline__leading,.mdc-select--outlined:not(.mdc-select--disabled) .mdc-notched-outline__notch,.mdc-select--outlined:not(.mdc-select--disabled) .mdc-notched-outline__trailing{border-color:rgba(0,0,0,.38)}.mdc-select--outlined:not(.mdc-select--disabled):not(.mdc-select--focused) .mdc-select__anchor:hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-select--outlined:not(.mdc-select--disabled):not(.mdc-select--focused) .mdc-select__anchor:hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-select--outlined:not(.mdc-select--disabled):not(.mdc-select--focused) .mdc-select__anchor:hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:rgba(0,0,0,.87)}.mdc-select--outlined:not(.mdc-select--disabled).mdc-select--focused .mdc-notched-outline .mdc-notched-outline__leading,.mdc-select--outlined:not(.mdc-select--disabled).mdc-select--focused .mdc-notched-outline .mdc-notched-outline__notch,.mdc-select--outlined:not(.mdc-select--disabled).mdc-select--focused .mdc-notched-outline .mdc-notched-outline__trailing{border-width:2px}.mdc-select--outlined:not(.mdc-select--disabled).mdc-select--focused .mdc-notched-outline .mdc-notched-outline__leading,.mdc-select--outlined:not(.mdc-select--disabled).mdc-select--focused .mdc-notched-outline .mdc-notched-outline__notch,.mdc-select--outlined:not(.mdc-select--disabled).mdc-select--focused .mdc-notched-outline .mdc-notched-outline__trailing{border-color:#6200ee;border-color:var(--mdc-theme-primary,#6200ee)}.mdc-select--outlined.mdc-select--disabled .mdc-notched-outline__leading,.mdc-select--outlined.mdc-select--disabled .mdc-notched-outline__notch,.mdc-select--outlined.mdc-select--disabled .mdc-notched-outline__trailing{border-color:rgba(0,0,0,.06)}.mdc-select--outlined .mdc-select__anchor :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mdc-select--outlined .mdc-select__anchor{display:flex;align-items:baseline;overflow:visible}.mdc-select--outlined .mdc-select__anchor .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-select-outlined 250ms 1}.mdc-select--outlined .mdc-select__anchor .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1)}.mdc-select--outlined .mdc-select__anchor .mdc-floating-label--float-above{font-size:.75rem}.mdc-select--outlined .mdc-select__anchor .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-select--outlined .mdc-select__anchor.mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(.75)}.mdc-select--outlined .mdc-select__anchor .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-select--outlined .mdc-select__anchor.mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-select--outlined .mdc-select__anchor .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-select--outlined .mdc-select__anchor .mdc-select__selected-text::before{content:"â€‹"}.mdc-select--outlined .mdc-select__anchor .mdc-select__selected-text-container{height:100%;display:inline-flex;align-items:center}.mdc-select--outlined .mdc-select__anchor::before{display:none}.mdc-select--outlined .mdc-select__selected-text-container{display:flex;border:none;z-index:1;background-color:transparent}.mdc-select--outlined .mdc-select__icon{z-index:2}.mdc-select--outlined .mdc-floating-label{line-height:1.15rem;left:4px;right:initial}.mdc-select--outlined .mdc-floating-label[dir=rtl],[dir=rtl] .mdc-select--outlined .mdc-floating-label{left:initial;right:4px}.mdc-select--outlined.mdc-select--focused .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-select--outlined.mdc-select--invalid:not(.mdc-select--disabled) .mdc-notched-outline__leading,.mdc-select--outlined.mdc-select--invalid:not(.mdc-select--disabled) .mdc-notched-outline__notch,.mdc-select--outlined.mdc-select--invalid:not(.mdc-select--disabled) .mdc-notched-outline__trailing{border-color:#b00020;border-color:var(--mdc-theme-error,#b00020)}.mdc-select--outlined.mdc-select--invalid:not(.mdc-select--disabled):not(.mdc-select--focused) .mdc-select__anchor:hover .mdc-notched-outline .mdc-notched-outline__leading,.mdc-select--outlined.mdc-select--invalid:not(.mdc-select--disabled):not(.mdc-select--focused) .mdc-select__anchor:hover .mdc-notched-outline .mdc-notched-outline__notch,.mdc-select--outlined.mdc-select--invalid:not(.mdc-select--disabled):not(.mdc-select--focused) .mdc-select__anchor:hover .mdc-notched-outline .mdc-notched-outline__trailing{border-color:#b00020;border-color:var(--mdc-theme-error,#b00020)}.mdc-select--outlined.mdc-select--invalid:not(.mdc-select--disabled).mdc-select--focused .mdc-notched-outline .mdc-notched-outline__leading,.mdc-select--outlined.mdc-select--invalid:not(.mdc-select--disabled).mdc-select--focused .mdc-notched-outline .mdc-notched-outline__notch,.mdc-select--outlined.mdc-select--invalid:not(.mdc-select--disabled).mdc-select--focused .mdc-notched-outline .mdc-notched-outline__trailing{border-width:2px}.mdc-select--outlined.mdc-select--invalid:not(.mdc-select--disabled).mdc-select--focused .mdc-notched-outline .mdc-notched-outline__leading,.mdc-select--outlined.mdc-select--invalid:not(.mdc-select--disabled).mdc-select--focused .mdc-notched-outline .mdc-notched-outline__notch,.mdc-select--outlined.mdc-select--invalid:not(.mdc-select--disabled).mdc-select--focused .mdc-notched-outline .mdc-notched-outline__trailing{border-color:#b00020;border-color:var(--mdc-theme-error,#b00020)}.mdc-select--outlined.mdc-select--with-leading-icon .mdc-floating-label{left:36px;right:initial}.mdc-select--outlined.mdc-select--with-leading-icon .mdc-floating-label[dir=rtl],[dir=rtl] .mdc-select--outlined.mdc-select--with-leading-icon .mdc-floating-label{left:initial;right:36px}.mdc-select--outlined.mdc-select--with-leading-icon .mdc-floating-label--float-above{transform:translateY(-37.25px) translateX(-32px) scale(1)}.mdc-select--outlined.mdc-select--with-leading-icon .mdc-floating-label--float-above[dir=rtl],[dir=rtl] .mdc-select--outlined.mdc-select--with-leading-icon .mdc-floating-label--float-above{transform:translateY(-37.25px) translateX(32px) scale(1)}.mdc-select--outlined.mdc-select--with-leading-icon .mdc-floating-label--float-above{font-size:.75rem}.mdc-select--outlined.mdc-select--with-leading-icon .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-select--outlined.mdc-select--with-leading-icon.mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) translateX(-32px) scale(.75)}.mdc-select--outlined.mdc-select--with-leading-icon .mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl],.mdc-select--outlined.mdc-select--with-leading-icon.mdc-notched-outline--upgraded .mdc-floating-label--float-above[dir=rtl],[dir=rtl] .mdc-select--outlined.mdc-select--with-leading-icon .mdc-notched-outline--upgraded .mdc-floating-label--float-above,[dir=rtl] .mdc-select--outlined.mdc-select--with-leading-icon.mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) translateX(32px) scale(.75)}.mdc-select--outlined.mdc-select--with-leading-icon .mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-select--outlined.mdc-select--with-leading-icon.mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-select--outlined.mdc-select--with-leading-icon .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-select-outlined-leading-icon-56px 250ms 1}@keyframes mdc-floating-label-shake-float-above-select-outlined-leading-icon-56px{0%{transform:translateX(calc(0 - 32px)) translateY(-34.75px) scale(.75)}33%{animation-timing-function:cubic-bezier(.5,0,.701732,.495819);transform:translateX(calc(4% - 32px)) translateY(-34.75px) scale(.75)}66%{animation-timing-function:cubic-bezier(.302435,.381352,.55,.956352);transform:translateX(calc(-4% - 32px)) translateY(-34.75px) scale(.75)}100%{transform:translateX(calc(0 - 32px)) translateY(-34.75px) scale(.75)}}.mdc-select--outlined.mdc-select--with-leading-icon[dir=rtl] .mdc-floating-label--shake,[dir=rtl] .mdc-select--outlined.mdc-select--with-leading-icon .mdc-floating-label--shake{animation:mdc-floating-label-shake-float-above-select-outlined-leading-icon-56px 250ms 1}@keyframes mdc-floating-label-shake-float-above-select-outlined-leading-icon-56px-rtl{0%{transform:translateX(calc(0 - -32px)) translateY(-34.75px) scale(.75)}33%{animation-timing-function:cubic-bezier(.5,0,.701732,.495819);transform:translateX(calc(4% - -32px)) translateY(-34.75px) scale(.75)}66%{animation-timing-function:cubic-bezier(.302435,.381352,.55,.956352);transform:translateX(calc(-4% - -32px)) translateY(-34.75px) scale(.75)}100%{transform:translateX(calc(0 - -32px)) translateY(-34.75px) scale(.75)}}.mdc-select--outlined.mdc-select--with-leading-icon .mdc-select__anchor :not(.mdc-notched-outline--notched) .mdc-notched-outline__notch{max-width:calc(100% - 96px)}.mdc-select--outlined .mdc-menu-surface{margin-bottom:8px}.mdc-select--outlined .mdc-menu-surface--is-open-below,.mdc-select--outlined.mdc-select--no-label .mdc-menu-surface{margin-bottom:0}.mdc-select__anchor{--mdc-ripple-fg-size:0;--mdc-ripple-left:0;--mdc-ripple-top:0;--mdc-ripple-fg-scale:1;--mdc-ripple-fg-translate-end:0;--mdc-ripple-fg-translate-start:0;-webkit-tap-highlight-color:transparent;will-change:transform,opacity}.mdc-select__anchor .mdc-select__ripple::after,.mdc-select__anchor .mdc-select__ripple::before{position:absolute;border-radius:50%;opacity:0;pointer-events:none;content:""}.mdc-select__anchor .mdc-select__ripple::before{transition:opacity 15ms linear,background-color 15ms linear;z-index:1;z-index:var(--mdc-ripple-z-index,1)}.mdc-select__anchor .mdc-select__ripple::after{z-index:0;z-index:var(--mdc-ripple-z-index,0)}.mdc-select__anchor.mdc-ripple-upgraded .mdc-select__ripple::before{transform:scale(var(--mdc-ripple-fg-scale,1))}.mdc-select__anchor.mdc-ripple-upgraded .mdc-select__ripple::after{top:0;left:0;transform:scale(0);transform-origin:center center}.mdc-select__anchor.mdc-ripple-upgraded--unbounded .mdc-select__ripple::after{top:var(--mdc-ripple-top,0);left:var(--mdc-ripple-left,0)}.mdc-select__anchor.mdc-ripple-upgraded--foreground-activation .mdc-select__ripple::after{animation:mdc-ripple-fg-radius-in 225ms forwards,mdc-ripple-fg-opacity-in 75ms forwards}.mdc-select__anchor.mdc-ripple-upgraded--foreground-deactivation .mdc-select__ripple::after{animation:mdc-ripple-fg-opacity-out 150ms;transform:translate(var(--mdc-ripple-fg-translate-end,0)) scale(var(--mdc-ripple-fg-scale,1))}.mdc-select__anchor .mdc-select__ripple::after,.mdc-select__anchor .mdc-select__ripple::before{top:calc(50% - 100%);left:calc(50% - 100%);width:200%;height:200%}.mdc-select__anchor.mdc-ripple-upgraded .mdc-select__ripple::after{width:var(--mdc-ripple-fg-size,100%);height:var(--mdc-ripple-fg-size,100%)}.mdc-select__anchor .mdc-select__ripple::after,.mdc-select__anchor .mdc-select__ripple::before{background-color:rgba(0,0,0,.87);background-color:var(--mdc-ripple-color,rgba(0,0,0,.87))}.mdc-select__anchor.mdc-ripple-surface--hover .mdc-select__ripple::before,.mdc-select__anchor:hover .mdc-select__ripple::before{opacity:.04;opacity:var(--mdc-ripple-hover-opacity,.04)}.mdc-select__anchor.mdc-ripple-upgraded--background-focused .mdc-select__ripple::before,.mdc-select__anchor:not(.mdc-ripple-upgraded):focus .mdc-select__ripple::before{transition-duration:75ms;opacity:.12;opacity:var(--mdc-ripple-focus-opacity,.12)}.mdc-select__anchor .mdc-select__ripple{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none}.mdc-select__menu .mdc-list .mdc-list-item--selected .mdc-list-item__ripple::after,.mdc-select__menu .mdc-list .mdc-list-item--selected .mdc-list-item__ripple::before{background-color:#000;background-color:var(--mdc-ripple-color,var(--mdc-theme-on-surface,#000))}.mdc-select__menu .mdc-list .mdc-list-item--selected.mdc-ripple-surface--hover .mdc-list-item__ripple::before,.mdc-select__menu .mdc-list .mdc-list-item--selected:hover .mdc-list-item__ripple::before{opacity:.04;opacity:var(--mdc-ripple-hover-opacity,.04)}.mdc-select__menu .mdc-list .mdc-list-item--selected.mdc-ripple-upgraded--background-focused .mdc-list-item__ripple::before,.mdc-select__menu .mdc-list .mdc-list-item--selected:not(.mdc-ripple-upgraded):focus .mdc-list-item__ripple::before{transition-duration:75ms;opacity:.12;opacity:var(--mdc-ripple-focus-opacity,.12)}.mdc-select__menu .mdc-list .mdc-list-item--selected:not(.mdc-ripple-upgraded) .mdc-list-item__ripple::after{transition:opacity 150ms linear}.mdc-select__menu .mdc-list .mdc-list-item--selected:not(.mdc-ripple-upgraded):active .mdc-list-item__ripple::after{transition-duration:75ms;opacity:.12;opacity:var(--mdc-ripple-press-opacity,.12)}.mdc-select__menu .mdc-list .mdc-list-item--selected.mdc-ripple-upgraded{--mdc-ripple-fg-opacity:var(--mdc-ripple-press-opacity, 0.12)}.mdc-select-helper-text{margin:0;margin-left:16px;margin-right:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:Roboto,sans-serif;font-family:var(--mdc-typography-caption-font-family,var(--mdc-typography-font-family,Roboto,sans-serif));font-size:.75rem;font-size:var(--mdc-typography-caption-font-size,.75rem);line-height:1.25rem;line-height:var(--mdc-typography-caption-line-height,1.25rem);font-weight:400;font-weight:var(--mdc-typography-caption-font-weight,400);letter-spacing:.0333333333em;letter-spacing:var(--mdc-typography-caption-letter-spacing,.0333333333em);text-decoration:inherit;text-decoration:var(--mdc-typography-caption-text-decoration,inherit);text-transform:inherit;text-transform:var(--mdc-typography-caption-text-transform,inherit);display:block;margin-top:0;line-height:normal}.mdc-select-helper-text[dir=rtl],[dir=rtl] .mdc-select-helper-text{margin-left:16px;margin-right:16px}.mdc-select-helper-text::before{display:inline-block;width:0;height:16px;content:"";vertical-align:0}.mdc-select-helper-text--validation-msg{opacity:0;transition:opacity 180ms cubic-bezier(.4,0,.2,1)}.mdc-select--invalid+.mdc-select-helper-text--validation-msg,.mdc-select-helper-text--validation-msg-persistent{opacity:1}.mdc-select--with-leading-icon .mdc-select__icon{display:inline-block;box-sizing:border-box;border:none;text-decoration:none;cursor:pointer;user-select:none;flex-shrink:0;align-self:center;background-color:transparent;fill:currentColor}.mdc-select--with-leading-icon .mdc-select__icon{margin-left:12px;margin-right:12px}.mdc-select--with-leading-icon .mdc-select__icon[dir=rtl],[dir=rtl] .mdc-select--with-leading-icon .mdc-select__icon{margin-left:12px;margin-right:12px}.mdc-select__icon:not([tabindex]),.mdc-select__icon[tabindex="-1"]{cursor:default;pointer-events:none}.material-icons{font-family:var(--mdc-icon-font, "Material Icons");font-weight:400;font-style:normal;font-size:var(--mdc-icon-size,24px);line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;-moz-osx-font-smoothing:grayscale;font-feature-settings:"liga"}:host{display:inline-block;vertical-align:top;outline:0}.mdc-select{width:100%}[hidden]{display:none}.mdc-select__icon{z-index:2}.mdc-select--with-leading-icon{--mdc-list-item-graphic-margin:calc(48px - var(--mdc-list-item-graphic-size, 24px) - var(--mdc-list-side-padding, 16px))}.mdc-select .mdc-select__anchor .mdc-select__selected-text{overflow:hidden}.mdc-select .mdc-select__anchor *{display:inline-flex}.mdc-select .mdc-select__anchor .mdc-floating-label{display:inline-block}mwc-notched-outline{--mdc-notched-outline-border-color:var(--mdc-select-outlined-idle-border-color, rgba(0, 0, 0, 0.38));--mdc-notched-outline-notch-offset:1px}:host(:not([disabled]):hover) .mdc-select:not(.mdc-select--invalid):not(.mdc-select--focused) mwc-notched-outline{--mdc-notched-outline-border-color:var(--mdc-select-outlined-hover-border-color, rgba(0, 0, 0, 0.87))}:host(:not([disabled])) .mdc-select:not(.mdc-select--disabled) .mdc-select__selected-text{color:rgba(0,0,0,.87);color:var(--mdc-select-ink-color,rgba(0,0,0,.87))}:host(:not([disabled])) .mdc-select:not(.mdc-select--disabled) .mdc-line-ripple::before{border-bottom-color:rgba(0,0,0,.42);border-bottom-color:var(--mdc-select-idle-line-color,rgba(0,0,0,.42))}:host(:not([disabled])) .mdc-select:not(.mdc-select--disabled):hover .mdc-line-ripple::before{border-bottom-color:rgba(0,0,0,.87);border-bottom-color:var(--mdc-select-hover-line-color,rgba(0,0,0,.87))}:host(:not([disabled])) .mdc-select:not(.mdc-select--outlined):not(.mdc-select--disabled) .mdc-select__anchor{background-color:#f5f5f5;background-color:var(--mdc-select-fill-color,#f5f5f5)}:host(:not([disabled])) .mdc-select.mdc-select--invalid .mdc-select__dropdown-icon{fill:var(--mdc-select-error-dropdown-icon-color,var(--mdc-select-error-color,var(--mdc-theme-error,#b00020)))}:host(:not([disabled])) .mdc-select.mdc-select--invalid .mdc-floating-label,:host(:not([disabled])) .mdc-select.mdc-select--invalid .mdc-floating-label::after{color:var(--mdc-select-error-color,var(--mdc-theme-error,#b00020))}:host(:not([disabled])) .mdc-select.mdc-select--invalid mwc-notched-outline{--mdc-notched-outline-border-color:var(--mdc-select-error-color, var(--mdc-theme-error, #b00020))}.mdc-select__menu--invalid{--mdc-theme-primary:var(--mdc-select-error-color, var(--mdc-theme-error, #b00020))}:host(:not([disabled])) .mdc-select:not(.mdc-select--invalid):not(.mdc-select--focused) .mdc-floating-label,:host(:not([disabled])) .mdc-select:not(.mdc-select--invalid):not(.mdc-select--focused) .mdc-floating-label::after{color:rgba(0,0,0,.6);color:var(--mdc-select-label-ink-color,rgba(0,0,0,.6))}:host(:not([disabled])) .mdc-select:not(.mdc-select--invalid):not(.mdc-select--focused) .mdc-select__dropdown-icon{fill:rgba(0,0,0,.54);fill:var(--mdc-select-dropdown-icon-color,rgba(0,0,0,.54))}:host(:not([disabled])) .mdc-select.mdc-select--focused mwc-notched-outline{--mdc-notched-outline-stroke-width:2px;--mdc-notched-outline-notch-offset:2px}:host(:not([disabled])) .mdc-select.mdc-select--focused:not(.mdc-select--invalid) mwc-notched-outline{--mdc-notched-outline-border-color:var(--mdc-select-focused-label-color, var(--mdc-theme-primary, rgba(98, 0, 238, 0.87)))}:host(:not([disabled])) .mdc-select.mdc-select--focused:not(.mdc-select--invalid) .mdc-select__dropdown-icon{fill:rgba(98,0,238,.87);fill:var(--mdc-select-focused-dropdown-icon-color,var(--mdc-theme-primary,rgba(98,0,238,.87)))}:host(:not([disabled])) .mdc-select.mdc-select--focused:not(.mdc-select--invalid) .mdc-floating-label{color:#6200ee;color:var(--mdc-theme-primary,#6200ee)}:host(:not([disabled])) .mdc-select.mdc-select--focused:not(.mdc-select--invalid) .mdc-floating-label::after{color:#6200ee;color:var(--mdc-theme-primary,#6200ee)}:host(:not([disabled])) .mdc-select-helper-text:not(.mdc-select-helper-text--validation-msg){color:var(--mdc-select-label-ink-color,rgba(0,0,0,.6))}:host([disabled]){pointer-events:none}:host([disabled]) .mdc-select:not(.mdc-select--outlined).mdc-select--disabled .mdc-select__anchor{background-color:#fafafa;background-color:var(--mdc-select-disabled-fill-color,#fafafa)}:host([disabled]) .mdc-select.mdc-select--outlined mwc-notched-outline{--mdc-notched-outline-border-color:var(--mdc-select-outlined-disabled-border-color, rgba(0, 0, 0, 0.06))}:host([disabled]) .mdc-select .mdc-select__dropdown-icon{fill:rgba(0,0,0,.38);fill:var(--mdc-select-disabled-dropdown-icon-color,rgba(0,0,0,.38))}:host([disabled]) .mdc-select:not(.mdc-select--invalid):not(.mdc-select--focused) .mdc-floating-label,:host([disabled]) .mdc-select:not(.mdc-select--invalid):not(.mdc-select--focused) .mdc-floating-label::after{color:rgba(0,0,0,.38);color:var(--mdc-select-disabled-ink-color,rgba(0,0,0,.38))}:host([disabled]) .mdc-select-helper-text{color:rgba(0,0,0,.38);color:var(--mdc-select-disabled-ink-color,rgba(0,0,0,.38))}:host([disabled]) .mdc-select__selected-text{color:rgba(0,0,0,.38);color:var(--mdc-select-disabled-ink-color,rgba(0,0,0,.38))}`));class Bg extends(Le(Pg)){static get scopedElements(){return{"mwc-notched-outline":il,"mwc-menu":ig,"mwc-icon":ul}}}Bg.styles=Mg,t([Z(".mdc-notched-outline")],Bg.prototype,"outlineElement",void 0);let Fg,Hg,Ug,Vg,Gg,Wg,zg,Xg,jg,Yg,Kg,$g,Jg,qg,Zg,Qg,tf,ef,nf,of,rf,sf,af,lf,cf,df,uf,hf,pf,gf,ff,mf,_f,vf,yf,bf,Ef,Tf,Rf,Cf,xf,Sf,If,Of,kf,wf,Af,Df,Nf,Lf,Pf,Mf,Bf,Ff,Hf,Uf,Vf,Gf,Wf,zf,Xf,jf,Yf,Kf,$f,Jf,qf,Zf,Qf,tm,em,nm,im,om,rm,sm,am,lm,cm,dm,um,hm,pm,gm,fm,mm,_m,vm,ym,bm,Em,Tm,Rm,Cm,xm,Sm,Im,Om,km=t=>t;function wm(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,n,s):o(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s}function Am(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}class Dm extends(on(Le(lt))){constructor(){super(...arguments),this.numberOfSimulatedConductors=10,this.simulatedDnaTemplate=na(),this.conductors=[]}static get provide(){return["activeDna","activeAgentPubKey","activeHash","conductors","conductorsUrls"]}static get styles(){return st(Fg||(Fg=km`:host{display:contents}`))}async firstUpdated(){this.conductorsUrls||(this.conductors=await ra(this.numberOfSimulatedConductors,[],this.simulatedDnaTemplate),this.activeDna=this.conductors[0].getAllCells()[0].dnaHash,this.dispatchEvent(new CustomEvent("ready",{bubbles:!0,composed:!0,detail:{activeDna:this.activeDna,activeAgentPubKey:this.activeAgentPubKey,activeHash:this.activeHash,conductors:this.conductors,conductorsUrls:this.conductorsUrls}}))),this.addEventListener("update-context",(t=>{const e=Object.keys(t.detail);for(const n of e)this[n]=t.detail[n]})),this.addEventListener("show-message",(t=>{this.showMessage(t.detail.message)}))}showMessage(t){this.message=t,this.snackbar.show()}renderSnackbar(){return F(Hg||(Hg=km` <mwc-snackbar id="snackbar" labelText="${0}"> <mwc-icon-button icon="close" slot="dismiss"></mwc-icon-button> </mwc-snackbar> `),this.message)}render(){return F(Ug||(Ug=km` ${0} ${0} `),this.renderSnackbar(),this.conductors?F(Vg||(Vg=km` <slot></slot> `)):F(Gg||(Gg=km` <mwc-circular-progress></mwc-circular-progress>`)))}static get scopedElements(){return{"mwc-circular-progress":se,"mwc-snackbar":Yt,"mwc-icon-button":en}}}wm([J({type:Number}),Am("design:type",Number)],Dm.prototype,"numberOfSimulatedConductors",void 0),wm([J({type:Object}),Am("design:type",Object)],Dm.prototype,"simulatedDnaTemplate",void 0),wm([Z("#snackbar"),Am("design:type",Yt)],Dm.prototype,"snackbar",void 0),wm([J({type:String}),Am("design:type",String)],Dm.prototype,"message",void 0),wm([J({type:String}),Am("design:type",String)],Dm.prototype,"activeDna",void 0),wm([J({type:String}),Am("design:type",String)],Dm.prototype,"activeAgentPubKey",void 0),wm([J({type:String}),Am("design:type",String)],Dm.prototype,"activeHash",void 0),wm([J({type:Array}),Am("design:type",Array)],Dm.prototype,"conductors",void 0),wm([J({type:Array}),Am("design:type",Array)],Dm.prototype,"conductorsUrls",void 0);const Nm=t=>{class e extends(nn(t)){constructor(){super(...arguments),this.conductors=[]}static get inject(){return["activeDna","activeAgentPubKey","activeHash","conductors","conductorsUrls"]}updatePlayground(t){this.dispatchEvent(new CustomEvent("update-context",{bubbles:!0,composed:!0,detail:t}))}showMessage(t){this.dispatchEvent(new CustomEvent("show-message",{bubbles:!0,composed:!0,detail:{message:t}}))}}return wm([J({type:String}),Am("design:type",String)],e.prototype,"activeDna",void 0),wm([J({type:String}),Am("design:type",String)],e.prototype,"activeAgentPubKey",void 0),wm([J({type:String}),Am("design:type",String)],e.prototype,"activeHash",void 0),wm([J({type:Array}),Am("design:type",Array)],e.prototype,"conductors",void 0),wm([J({type:Array}),Am("design:type",Array)],e.prototype,"conductorsUrls",void 0),e};class Lm extends(Nm(Le(lt))){constructor(){super(...arguments),this._subscriptions={},this._observedCells=[]}observedCells(){return[]}onNewObservedCell(t){return[]}onCellsChanged(){}getStrCellId(t){return`${t.dnaHash}/${t.agentPubKey}`}updated(t){super.updated(t),this._observedCells=this.observedCells().filter((t=>!!t));const e=this._observedCells.reduce(((t,e)=>({...t,[this.getStrCellId(e)]:e})),{}),n=Object.keys(e),i=Object.keys(this._subscriptions),o=n.filter((t=>!i.includes(t))),r=i.filter((t=>!n.includes(t)));for(const t of o){const n=e[t],i=n.workflowExecutor.success((async()=>{this.requestUpdate()}));this._subscriptions[t]=[...this.onNewObservedCell(n),i]}r.forEach((t=>this.unsubscribeFromCellId(t))),(o.length>0||r.length>0)&&this.onCellsChanged()}unsubscribeFromCellId(t){for(const e of this._subscriptions[t])e.unsubscribe();this._subscriptions[t]=void 0,delete this._subscriptions[t]}disconnectedCallback(){super.disconnectedCallback();for(const t of Object.values(this._subscriptions))for(const e of t)e.unsubscribe()}}const Pm=st(Wg||(Wg=km`.row{display:flex;flex-direction:row}.column{display:flex;flex-direction:column}.fill{flex:1}.center-content{align-items:center;justify-content:center;display:flex}span{margin-block-start:0}.title{font-size:20px}.placeholder{opacity:.6}.flex-scrollable-parent{position:relative;display:flex;flex:1}.flex-scrollable-container{position:absolute;top:0;left:0;right:0;bottom:0}.flex-scrollable-x{max-width:100%;overflow-x:auto}.flex-scrollable-y{max-height:100%;overflow-y:auto}.json-info{padding:4px;max-width:400px}.block-card{width:auto;position:relative;flex:1}.block-title{font-size:20px}.block-help{position:absolute;right:8px;top:8px}.horizontal-divider{background-color:grey;height:1px;opacity:.3;margin-bottom:0;width:100%}.vertical-divider{background-color:grey;width:1px;height:60%;opacity:.3;margin-bottom:0}`));function Mm(t,e){return e.getCells(t)}function Bm(t,e){const n=e.map((e=>Mm(t,e)));return[].concat(...n)}function Fm(t,e,n){for(const i of n)for(const n of i.getAllCells())if(n.agentPubKey===e&&n.dnaHash===t)return n}function Hm(t){return t.p2p.redundancyFactor}const Um=(...t)=>t.reduce(((t,e)=>(...n)=>t(e(...n)))),Vm=t=>"string"==typeof t,Gm=t=>t.trim(),Wm=(...t)=>e=>e.replace(...t);var zm;const Xm=Um((t=>Object.fromEntries?Object.fromEntries(t):t.reduce(((t,[e,n])=>({[e]:n,...t})),{})),(zm=([t,e])=>void 0===e?[]:[[t,e]],t=>"flatMap"in Array.prototype?t.flatMap(zm):t.reduce(((t,e)=>t.concat(zm(e))),[])),Object.entries),jm=(t,e)=>{return""===t?e:(n=e)instanceof Element?`<mark part='string'>${n.outerHTML.replace(/</g,"&lt;").replace(/"/g,"'")}</mark>`:(t=>null!==t&&"[object Object]"==`${t}`)(n)||Array.isArray(n)?n:`<mark part='${null===n?"null":typeof n}'>${n}</mark>`;var n},Ym=Wm(/"(.*)":/g,((t,e)=>`<mark part="key">"${e}"</mark>:`)),Km=Um(Wm(/"<mark(.*)>(.*)<\/mark>"/g,((t,e,n)=>`<mark${e}>${e.includes("string")?`"${n}"`:n}</mark>`)),Ym,(t=>JSON.stringify(t,jm,2)),Xm),$m='\n[hidden],\n:host([hidden]) {\n  display: none !important;\n}\n\n:host {\n  display: block;\n  position: relative;\n  color: var(--json-viewer-color, currentColor);\n}\n\ncode { white-space: pre; }\nmark { background: none; }\n\n@media (prefers-color-scheme: dark), (prefers-color-scheme: no-preference) {\n  :host { background: var(--json-viewer-background, #212529); }\n  [part="key"] { color: var(--json-viewer-key-color, #ff922b); }\n  [part="boolean"] { color: var(--json-viewer-boolean-color, #22b8cf); }\n  [part="number"] { color: var(--json-viewer-number-color, #51cf66); }\n  [part="null"] { color: var(--json-viewer-null-color, #ff6b6b); }\n  [part="string"] { color: var(--json-viewer-string-color, #22b8cf); }\n}\n\n@media (prefers-color-scheme: light) {\n  :host { background: var(--json-viewer-background, white); }\n  [part="key"] { color: var(--json-viewer-key-color, #f76707); }\n  [part="boolean"] { color: var(--json-viewer-boolean-color, #0c8599); }\n  [part="number"] { color: var(--json-viewer-number-color, #0ca678); }\n  [part="null"] { color: var(--json-viewer-null-color, #e03131); }\n  [part="string"] { color: var(--json-viewer-string-color, #0c8599); }\n}\n',Jm=document.createElement("template");Jm.innerHTML='<code hidden part="code"></code>';class qm extends HTMLElement{static get is(){return"json-viewer"}static get observedAttributes(){return["allowlist","object"]}get object(){return this.__object}set object(t){t&&"string"==typeof t&&(t=this.tryParse(t)),this.__object=t,this.render()}get allowlist(){return this.__allowlist}set allowlist(t){if(e=t,!Array.isArray(e)||!e.every(Vm))throw new Error("allowlist must be an array of strings");var e;this.__allowlist=t;const n=t.join(",");n&&this.setAttribute("allowlist",n),this.render()}get error(){return this.__error}set error(t){this.__error=t,t instanceof Error&&this.dispatchEvent(new CustomEvent("json-parse-error"))}constructor(){if(super(),this.__error=null,this.__allowlist=[],this.__mo=new MutationObserver(this.parse.bind(this)),this.__mo.observe(this,{subtree:!0,characterData:!0,childList:!0}),this.attachShadow({mode:"open"}),"adoptedStyleSheets"in Document.prototype){const t=new CSSStyleSheet;t.replaceSync($m),this.shadowRoot.adoptedStyleSheets=[t]}else this.shadowRoot.innerHTML=`<style>${$m}</style>`;this.shadowRoot.append(Jm.content.cloneNode(!0))}connectedCallback(){this.parse(),this.object&&this.shadowRoot.querySelector("code").hidden&&this.render()}attributeChangedCallback(t,e,n){switch(t){case"allowlist":return this.allowlistAttrChanged(n,e);case"object":return this.objectAttrChanged(n,e)}}allowlistAttrChanged(t,e){const n=t;this.allowlist.join(",")!==n&&(this.allowlist=(t=>(t||"").split(",").map(Gm).filter(Boolean))(n))}objectAttrChanged(t,e){t!==e&&(this.object=this.tryParse(t))}getHighlightedDomString(){const{allowlist:t,object:e}=this;if(void 0===e)return"";const n=Array.isArray(t)&&t.length?((t,e)=>t.reduce(((t,n)=>Object.assign(t,{[n]:e[n]})),{}))(t,e):e;return Km(n)}render(){const t=this.getHighlightedDomString();this.shadowRoot.querySelector("code").hidden=!t,this.shadowRoot.querySelector("code").innerHTML=t}parse(){const t=this.querySelector('script[type="application/json"]')||this.querySelector('script[type="application/ld+json"]')||this,{textContent:e=""}=t;e.trim()&&(this.object=this.tryParse(e))}tryParse(t){let e;try{e=JSON.parse(t)}catch(n){const{name:i,message:o}=n;e={name:i,message:o,string:t},this.error=n}return e}}class Zm extends(Le(lt)){constructor(){super(...arguments),this._expanded=!1}render(){return F(zg||(zg=km` <div class="row"> <mwc-icon-button style="--mdc-icon-button-size:30px;margin-right:4px" .icon="${0}" @click="${0}"></mwc-icon-button> <div style="${0}"> <div style="${0}"></div> <div style="${0}"> <slot></slot> </div> </div> </div> `),this._expanded?"arrow_drop_up":"arrow_drop_down",(()=>this._expanded=!this._expanded),qt({position:this._expanded?"unset":"relative",flex:"1",display:"flex"}),qt({display:this._expanded?"none":"block","z-index":"3",position:this._expanded?"unset":"absolute",width:"100%",height:"100%","box-shadow":this._expanded?"":"inset 0 -10px 10px -10px #000000"}),qt({height:this._expanded?"auto":"30px",width:this._expanded?"auto":"100%",overflow:this._expanded?"auto":"hidden",position:this._expanded?"unset":"absolute",flex:"1"}))}static get styles(){return Pm}static get scopedElements(){return{"mwc-icon-button":en}}}wm([J({type:Boolean}),Am("design:type",Object)],Zm.prototype,"_expanded",void 0);class Qm extends Lm{constructor(){super(...arguments),this.hideResults=!1,this.hideZomeSelector=!1,this.hideAgentPubKey=!1,this.selectedZomeFnName=void 0,this._selectedZomeIndex=0,this._results={},this._arguments={}}get activeCell(){return Fm(this.activeDna,this.activeAgentPubKey,this.conductors)}get activeZome(){return this.activeCell.getSimulatedDna().zomes[this._selectedZomeIndex]}get activeZomeFn(){let t=Object.keys(this.activeZome.zome_functions)[0];return this.selectedZomeFnName&&(t=this.selectedZomeFnName),{name:t,fn:this.activeZome.zome_functions[t]}}observedCells(){return[this.activeCell]}setResultValue(t,e){const n=this.activeCell.dnaHash,i=this.activeCell.agentPubKey;this._results[n]||(this._results[n]={}),this._results[n][i]||(this._results[n][i]={}),this._results[n][i][t]=e}getResultValue(t){return this.getActiveResults()[t]}getActiveResults(){const t=this.activeCell.dnaHash,e=this.activeCell.agentPubKey;return this._results[t]&&this._results[t][e]||{}}setFunctionArgument(t,e,n){const i=this.activeCell.dnaHash,o=this.activeCell.agentPubKey,r=this.activeZome.name;this._arguments[i]||(this._arguments[i]={}),this._arguments[i][o]||(this._arguments[i][o]={}),this._arguments[i][o][r]||(this._arguments[i][o][r]={}),this._arguments[i][o][r][t]||(this._arguments[i][o][r][t]={}),this._arguments[i][o][r][t][e]=n,this.requestUpdate()}getFunctionArguments(t){const e=this.activeCell.dnaHash,n=this.activeCell.agentPubKey,i=this.activeZome.name;return this._arguments[e]&&this._arguments[e][n]&&this._arguments[e][n][i]&&this._arguments[e][n][i][t]}getFunctionArgument(t,e){const n=this.activeCell.dnaHash,i=this.activeCell.agentPubKey,o=this.activeZome.name;return this._arguments[n]&&this._arguments[n][i]&&this._arguments[n][i][o]&&this._arguments[n][i][o][t]&&this._arguments[n][i][o][t][e]}async callZomeFunction(t){const e=this.activeZome,n=Date.now(),i={cellId:this.activeCell.cellId,result:void 0,fnName:t,zome:e};this.setResultValue(n,i),this.requestUpdate();try{const o=await this.activeCell.conductor.callZomeFn({cellId:this.activeCell.cellId,zome:e.name,payload:this.getFunctionArguments(t),fnName:t,cap:null});i.result={success:!0,payload:o},this.setResultValue(n,i)}catch(t){i.result={success:!1,payload:t.message},this.setResultValue(n,i)}finally{this.requestUpdate()}}renderCallableFunction(t,e){return F(Xg||(Xg=km` <div class="column" style="flex:1;margin:16px"> <div class="flex-scrollable-parent"> <div class="flex-scrollable-container"> <div class="flex-scrollable-y"> <div class="column" style="flex:1"> ${0} </div> </div> </div> </div> <mwc-button raised @click="${0}">Execute</mwc-button> </div>`),0===e.arguments.length?F(jg||(jg=km`<span class="placeholder" style="margin-top:28px">This function has no arguments</span>`)):e.arguments.map((e=>F(Yg||(Yg=km`<mwc-textfield style="margin-top:8px" outlined label="${0}" .value="${0}" @input="${0}"></mwc-textfield>`),e.name+": "+e.type,this.getFunctionArgument(t,e.name)||"",(n=>this.setFunctionArgument(t,e.name,n.target.value))))),(()=>this.callZomeFunction(t)))}renderActiveZomeFns(){const t=this.activeCell.getSimulatedDna().zomes[this._selectedZomeIndex],e=Object.entries(t.zome_functions);return 0===e.length?F(Kg||(Kg=km`<div class="fill center-content"> <span class="placeholder" style="padding:24px">This zome has no functions</span> </div> `)):F($g||($g=km` <mwc-drawer style="--mdc-drawer-width:auto"> <mwc-list activatable @selected="${0}"> ${0} </mwc-list> <div slot="appContent" class="column" style="height:100%"> <div class="column" style="flex:1"> ${0} </div> </div> </mwc-drawer> `),(t=>this.selectedZomeFnName=e[t.detail.index][0]),e.map((([t,e])=>F(Jg||(Jg=km` <mwc-list-item .activated="${0}">${0} </mwc-list-item> `),this.activeZomeFn.name===t,t))),this.renderCallableFunction(this.activeZomeFn.name,this.activeZomeFn.fn))}renderResult(t){return t.result?t.result.payload&&"string"!=typeof t.result.payload?F(Qg||(Qg=km` <expandable-line> <json-viewer .object="${0}" class="fill"></json-viewer> </expandable-line> `),t.result.payload):F(Zg||(Zg=km`<span>${0}</span>`),t.result.payload):F(qg||(qg=km`<span class="placeholder">Executing...</span>`))}renderResults(){const t=this.getActiveResults(),e=Object.keys(t).sort().map((e=>[e,t[e]]));return F(tf||(tf=km` <div class="column" style="flex:1"> ${0} </div> `),0===e.length?F(ef||(ef=km` <div class="row fill center-content"> <span class="placeholder" style="margin:0 24px">Call a ZomeFn to see its results</span> </div> `)):F(nf||(nf=km` <div class="flex-scrollable-parent"> <div class="flex-scrollable-container"> <div class="flex-scrollable-y"> <div style="margin:0 16px"> ${0} </div> </div> </div> </div>`),e.map((([t,n],i)=>F(of||(of=km` <div class="column" style="flex:1"> <div class="row" style="margin:8px 0"> ${0} <div class="column" style="flex:1;margin:12px;margin-right:0"> <div class="row" style="flex:1"> <span style="flex:1;margin-bottom:8px"> ${0} <span class="placeholder"> in ${0} zome${0} </span> </span> <span class="placeholder"> ${0} </span> </div> ${0} </div> </div> ${0} </div> `),n.result?F(rf||(rf=km` <mwc-icon style="${0}">${0}</mwc-icon> `),qt({color:n.result.success?"green":"red","align-self":"start","margin-top":"16px","--mdc-icon-size":"36px"}),n.result.success?"check_circle_outline":"error_outline"):F(sf||(sf=km` <mwc-circular-progress indeterminate density="-2" style="align-self:center"></mwc-circular-progress> `)),n.fnName,n.zome.name,n.result?n.result.success?", result:":", error:":"",new Date(parseInt(t)).toLocaleTimeString(),this.renderResult(n),i<e.length-1?F(af||(af=km` <span class="horizontal-divider" style="align-self:center"></span> `)):F(lf||(lf=km``)))))))}render(){return F(cf||(cf=km` <mwc-card style="width:auto;flex:1"> ${0} </mwc-card> `),this.activeCell?F(df||(df=km` <div class="column" style="flex:1"> <span class="title" style="margin:16px">Call Zome Fns${0}</span> ${0} <div class="row" style="flex:1"> <div class="column" style="flex:1"> ${0} ${0} </div> ${0} </div> </div> `),this.hideAgentPubKey?F(uf||(uf=km``)):F(hf||(hf=km`, <span class="placeholder">for agent ${0}</span> `),this.activeAgentPubKey),this.hideZomeSelector?F(pf||(pf=km` <span class="horizontal-divider"></span> `)):F(gf||(gf=km``)),this.hideZomeSelector?F(ff||(ff=km``)):F(mf||(mf=km` <mwc-tab-bar .activeIndex="${0}" @MDCTabBar:activated="${0}"> ${0} </mwc-tab-bar> `),this._selectedZomeIndex,(t=>{this.selectedZomeFnName=void 0,this._selectedZomeIndex=t.detail.index}),this.activeCell.getSimulatedDna().zomes.map((t=>F(_f||(_f=km` <mwc-tab .label="${0}"></mwc-tab> `),t.name)))),this.renderActiveZomeFns(),this.hideResults?F(vf||(vf=km``)):F(yf||(yf=km` <span class="vertical-divider" style="height:100%"></span> ${0} `),this.renderResults())):F(bf||(bf=km`<div class="fill center-content placeholder"> <span style="padding:24px">Select a cell to call its zome functions</span> </div>`)))}static get styles(){return[Pm,st(Ef||(Ef=km`:host{display:flex;flex:1}`))]}static get scopedElements(){return{"mwc-button":bl,"mwc-textfield":sl,"mwc-circular-progress":se,"mwc-icon":ul,"mwc-tab":tc,"mwc-list":_u,"mwc-drawer":Pu,"mwc-list-item":Rd,"mwc-tab-bar":wc,"mwc-card":ld,"json-viewer":qm,"expandable-line":Zm}}}wm([J({type:Boolean,attribute:"hide-results"}),Am("design:type",Object)],Qm.prototype,"hideResults",void 0),wm([J({type:Boolean,attribute:"hide-zome-selector"}),Am("design:type",Object)],Qm.prototype,"hideZomeSelector",void 0),wm([J({type:Boolean,attribute:"hide-agent-pub-key"}),Am("design:type",Object)],Qm.prototype,"hideAgentPubKey",void 0),wm([J({type:String}),Am("design:type",String)],Qm.prototype,"selectedZomeFnName",void 0),wm([J({type:Number}),Am("design:type",Number)],Qm.prototype,"_selectedZomeIndex",void 0),wm([J({type:Array}),Am("design:type",Object)],Qm.prototype,"_results",void 0);class t_ extends Lm{constructor(){super(...arguments),this.cell=void 0}static style(){return Pm}get activeCell(){return Fm(this.activeDna,this.activeAgentPubKey,this.conductors)||Bm(this.activeDna,this.conductors)[0]}render(){return F(Tf||(Tf=km` <div class="column"> ${0} </div> `),this.activeCell?F(Rf||(Rf=km` <span> <strong> Entries with associated metadata, and agent ids with all their headers </strong> </span> <json-viewer id="dht-shard" style="margin-top:16px" .object="${0}"> </json-viewer> `),JSON.stringify(function(t){const e=Wr(t),n={};for(const i of e)n[i]={details:Gr(t,i),links:Xr(t,i)};return n}(this.activeCell.getState()))):F(Cf||(Cf=km` <span class="placeholder"> Select a cell to see its DHT Shard </span> `)))}static get scopedElements(){return{"json-viewer":qm}}}function e_(t){if(null==t)return t;if(Array.isArray(t))return t.map(e_);if("object"==typeof t){for(const e of Object.keys(t))t[e]=e_(t[e]);return t}return"string"==typeof t&&t.length>23?`${t.substring(0,20)}...`:t}wm([J({type:Object}),Am("design:type",Object)],t_.prototype,"cell",void 0);class n_ extends Lm{static get styles(){return[Pm,st(xf||(xf=km`:host{display:flex}`))]}get activeHashedContent(){const t=Bm(this.activeDna,this.conductors);return function(t,e){if(t)for(const n of e){const e=n.getState().CAS[t];if(e)return e}}(this.activeHash,t)}render(){return F(Sf||(Sf=km` <mwc-card style="width:auto;min-height:200px" class="fill"> <div class="column fill" style="padding:16px"> <span class="title"> ${0} Contents</span> ${0} </div> </mwc-card> `),this.activeHashedContent&&this.activeHashedContent.header?"Header":"Entry",this.activeHashedContent?F(If||(If=km` <div class="column fill"> <span style="margin-bottom:16px"> ${0} Hash: ${0} </span> <div class="fill flex-scrollable-parent"> <div class="flex-scrollable-container"> <div class="flex-scrollable-y" style="height:100%"> <json-viewer .object="${0}" class="fill"></json-viewer> </div> </div> </div> </div> `),this.activeHashedContent.header?"Header":"Entry",this.activeHash,e_(this.activeHashedContent)):F(Of||(Of=km` <div class="column fill center-content"> <span class="placeholder">Select entry to inspect</span> </div> `)))}static get scopedElements(){return{"json-viewer":qm,"mwc-card":ld}}}class i_ extends Lm{constructor(){super(...arguments),this.selectedTabIndex=0}firstUpdated(){this.addEventListener("entry-committed",(t=>{this.selectedTabIndex=0}))}static get styles(){return[Pm,st(kf||(kf=km`:host{display:flex}mwc-card{padding:16px}`))]}renderAgentHelp(){return F(wf||(wf=km` <mwc-dialog id="conductor-help" heading="Node Help" style="--mdc-dialog-max-width:700px"> <span> You've selected the node or conductor with Agent ID ${0}. Here you can see its internal state: <ul> <li> <strong>Source Chain</strong>: entries that this node has committed. Here you can see in grey the <a href="https://developer.holochain.org/docs/concepts/3_private_data/" target="_blank">headers </a> of the entries, and in colors the entries themselves. When you select an entry, the other nodes that are holding the entry DHT will be hightlighted in the DHT. </li> <br> <li> <strong>DHT Shard</strong>: slice of the DHT that this node is holding. You can see the list of all the entries that this node is holding indexed by their hash, and metadata associated to those entries. </li> <br> <li> <strong>Commit Entries</strong>: here you can actually create entries yourself. They will be created on behalf of this node. Try it! You can create an entry and see where it lands on the DHT, and go to the DHT Shard of those nodes and check it's there. </li> </ul> </span> <mwc-button slot="primaryAction" dialogAction="cancel"> Got it! </mwc-button> </mwc-dialog> `),this.activeAgentPubKey)}render(){return F(Af||(Af=km` ${0} <mwc-card style="width:auto" class="fill"> <div class="column fill"> <div class="row" style="padding:16px"> <div class="column" style="flex:1"> <span class="title">Conductor Detail</span> <span>Agent Pub Key: ${0}</span> </div> <mwc-icon-button icon="help_outline" @click="${0}"></mwc-icon-button> </div> <div class="column fill"> <mwc-tab-bar @MDCTabBar:activated="${0}" .activeIndex="${0}"> <mwc-tab label="Source Chain"></mwc-tab> <mwc-tab label="DHT Shard"></mwc-tab> <mwc-tab label="Commit entries"></mwc-tab> </mwc-tab-bar> <div style="padding:16px" class="column fill"> ${0} </div> </div> </div> </mwc-card> `),this.renderAgentHelp(),this.activeAgentPubKey,(()=>this.conductorHelp.open=!0),(t=>this.selectedTabIndex=t.detail.index),this.selectedTabIndex,0===this.selectedTabIndex?F(Df||(Df=km` <div class="row fill"> <holochain-playground-source-chain class="fill"></holochain-playground-source-chain> <div class="flex-scrollable-parent"> <div class="flex-scrollable-container"> <div class="flex-scrollable-y"> <holochain-playground-entry-detail class="fill"></holochain-playground-entry-detail> </div> </div> </div> </div> `)):1===this.selectedTabIndex?F(Nf||(Nf=km` <div class="flex-scrollable-parent"> <div class="flex-scrollable-container"> <div class="flex-scrollable-y"> <holochain-playground-dht-shard></holochain-playground-dht-shard> </div> </div> </div> `)):F(Lf||(Lf=km` <holochain-playground-create-entries></holochain-playground-create-entries> `)))}static get scopedElements(){return{"holochain-playground-dht-shard":t_,"holochain-playground-entry-detail":n_,"mwc-tab":tc,"mwc-tab-bar":wc,"mwc-card":ld,"mwc-icon-button":en,"mwc-dialog":qu}}}wm([J({type:Number}),Am("design:type",Number)],i_.prototype,"selectedTabIndex",void 0),wm([Z("#conductor-help"),Am("design:type",qu)],i_.prototype,"conductorHelp",void 0);var o_="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r_(t,e,n){return t(n={path:e,exports:{},require:function(t,e){return s_(null==e&&n.path)}},n.exports),n.exports}function s_(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var a_=/^\s+|\s+$/g,l_=/^[-+]0x[0-9a-f]+$/i,c_=/^0b[01]+$/i,d_=/^0o[0-7]+$/i,u_=parseInt,h_="object"==typeof o_&&o_&&o_.Object===Object&&o_,p_="object"==typeof self&&self&&self.Object===Object&&self,g_=h_||p_||Function("return this")(),f_=Object.prototype.toString,m_=Math.max,__=Math.min,v_=function(){return g_.Date.now()};function y_(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function b_(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==f_.call(t)}(t))return NaN;if(y_(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=y_(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(a_,"");var n=c_.test(t);return n||d_.test(t)?u_(t.slice(2),n?2:8):l_.test(t)?NaN:+t}var E_=function(t,e,n){var i,o,r,s,a,l,c=0,d=!1,u=!1,h=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function p(e){var n=i,r=o;return i=o=void 0,c=e,s=t.apply(r,n)}function g(t){return c=t,a=setTimeout(m,e),d?p(t):s}function f(t){var n=t-l;return void 0===l||n>=e||n<0||u&&t-c>=r}function m(){var t=v_();if(f(t))return _(t);a=setTimeout(m,function(t){var n=e-(t-l);return u?__(n,r-(t-c)):n}(t))}function _(t){return a=void 0,h&&i?p(t):(i=o=void 0,s)}function v(){var t=v_(),n=f(t);if(i=arguments,o=this,l=t,n){if(void 0===a)return g(l);if(u)return a=setTimeout(m,e),p(l)}return void 0===a&&(a=setTimeout(m,e)),s}return e=b_(e)||0,y_(n)&&(d=!!n.leading,r=(u="maxWait"in n)?m_(b_(n.maxWait)||0,e):r,h="trailing"in n?!!n.trailing:h),v.cancel=function(){void 0!==a&&clearTimeout(a),c=0,i=l=o=a=void 0},v.flush=function(){return void 0===a?s:_(v_())},v},T_=r_((function(t,e){(function(){var e,n,i,o,r,s,a,l,c,d,u,h,p,g,f;i=Math.floor,d=Math.min,n=function(t,e){return t<e?-1:t>e?1:0},c=function(t,e,o,r,s){var a;if(null==o&&(o=0),null==s&&(s=n),o<0)throw new Error("lo must be non-negative");for(null==r&&(r=t.length);o<r;)s(e,t[a=i((o+r)/2)])<0?r=a:o=a+1;return[].splice.apply(t,[o,o-o].concat(e)),e},s=function(t,e,i){return null==i&&(i=n),t.push(e),g(t,0,t.length-1,i)},r=function(t,e){var i,o;return null==e&&(e=n),i=t.pop(),t.length?(o=t[0],t[0]=i,f(t,0,e)):o=i,o},l=function(t,e,i){var o;return null==i&&(i=n),o=t[0],t[0]=e,f(t,0,i),o},a=function(t,e,i){var o;return null==i&&(i=n),t.length&&i(t[0],e)<0&&(e=(o=[t[0],e])[0],t[0]=o[1],f(t,0,i)),e},o=function(t,e){var o,r,s,a,l,c;for(null==e&&(e=n),l=[],r=0,s=(a=function(){c=[];for(var e=0,n=i(t.length/2);0<=n?e<n:e>n;0<=n?e++:e--)c.push(e);return c}.apply(this).reverse()).length;r<s;r++)o=a[r],l.push(f(t,o,e));return l},p=function(t,e,i){var o;if(null==i&&(i=n),-1!==(o=t.indexOf(e)))return g(t,0,o,i),f(t,o,i)},u=function(t,e,i){var r,s,l,c,d;if(null==i&&(i=n),!(s=t.slice(0,e)).length)return s;for(o(s,i),l=0,c=(d=t.slice(e)).length;l<c;l++)r=d[l],a(s,r,i);return s.sort(i).reverse()},h=function(t,e,i){var s,a,l,u,h,p,g,f,m;if(null==i&&(i=n),10*e<=t.length){if(!(l=t.slice(0,e).sort(i)).length)return l;for(a=l[l.length-1],u=0,p=(g=t.slice(e)).length;u<p;u++)i(s=g[u],a)<0&&(c(l,s,0,null,i),l.pop(),a=l[l.length-1]);return l}for(o(t,i),m=[],h=0,f=d(e,t.length);0<=f?h<f:h>f;0<=f?++h:--h)m.push(r(t,i));return m},g=function(t,e,i,o){var r,s,a;for(null==o&&(o=n),r=t[i];i>e&&o(r,s=t[a=i-1>>1])<0;)t[i]=s,i=a;return t[i]=r},f=function(t,e,i){var o,r,s,a,l;for(null==i&&(i=n),r=t.length,l=e,s=t[e],o=2*e+1;o<r;)(a=o+1)<r&&!(i(t[o],t[a])<0)&&(o=a),t[e]=t[o],o=2*(e=o)+1;return t[e]=s,g(t,l,e,i)},e=function(){function t(t){this.cmp=null!=t?t:n,this.nodes=[]}return t.push=s,t.pop=r,t.replace=l,t.pushpop=a,t.heapify=o,t.updateItem=p,t.nlargest=u,t.nsmallest=h,t.prototype.push=function(t){return s(this.nodes,t,this.cmp)},t.prototype.pop=function(){return r(this.nodes,this.cmp)},t.prototype.peek=function(){return this.nodes[0]},t.prototype.contains=function(t){return-1!==this.nodes.indexOf(t)},t.prototype.replace=function(t){return l(this.nodes,t,this.cmp)},t.prototype.pushpop=function(t){return a(this.nodes,t,this.cmp)},t.prototype.heapify=function(){return o(this.nodes,this.cmp)},t.prototype.updateItem=function(t){return p(this.nodes,t,this.cmp)},t.prototype.clear=function(){return this.nodes=[]},t.prototype.empty=function(){return 0===this.nodes.length},t.prototype.size=function(){return this.nodes.length},t.prototype.clone=function(){var e;return(e=new t).nodes=this.nodes.slice(0),e},t.prototype.toArray=function(){return this.nodes.slice(0)},t.prototype.insert=t.prototype.push,t.prototype.top=t.prototype.peek,t.prototype.front=t.prototype.peek,t.prototype.has=t.prototype.contains,t.prototype.copy=t.prototype.clone,t}(),t.exports=e}).call(o_)}));function R_(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var C_=R_(E_),x_=R_(T_);function S_(t){return(S_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function I_(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function O_(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function k_(t,e,n){return e&&O_(t.prototype,e),n&&O_(t,n),t}function w_(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A_(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],i=!0,o=!1,r=void 0;try{for(var s,a=t[Symbol.iterator]();!(i=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){o=!0,r=t}finally{try{i||null==a.return||a.return()}finally{if(o)throw r}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var D_="undefined"==typeof window?null:window,N_=D_?D_.navigator:null;D_&&D_.document;var L_=S_(""),P_=S_({}),M_=S_((function(){})),B_="undefined"==typeof HTMLElement?"undefined":S_(HTMLElement),F_=function(t){return t&&t.instanceString&&U_(t.instanceString)?t.instanceString():null},H_=function(t){return null!=t&&S_(t)==L_},U_=function(t){return null!=t&&S_(t)===M_},V_=function(t){return!X_(t)&&(Array.isArray?Array.isArray(t):null!=t&&t instanceof Array)},G_=function(t){return null!=t&&S_(t)===P_&&!V_(t)&&t.constructor===Object},W_=function(t){return null!=t&&S_(t)===S_(1)&&!isNaN(t)},z_=function(t){return"undefined"===B_?void 0:null!=t&&t instanceof HTMLElement},X_=function(t){return j_(t)||Y_(t)},j_=function(t){return"collection"===F_(t)&&t._private.single},Y_=function(t){return"collection"===F_(t)&&!t._private.single},K_=function(t){return"core"===F_(t)},$_=function(t){return"stylesheet"===F_(t)},J_=function(t){return null==t||!(""!==t&&!t.match(/^\s+$/))},q_=function(t){return function(t){return null!=t&&S_(t)===P_}(t)&&U_(t.then)},Z_=function(t,e){e||(e=function(){if(1===arguments.length)return arguments[0];if(0===arguments.length)return"undefined";for(var t=[],e=0;e<arguments.length;e++)t.push(arguments[e]);return t.join("$")});var n=function n(){var i,o=this,r=arguments,s=e.apply(o,r),a=n.cache;return(i=a[s])||(i=a[s]=t.apply(o,r)),i};return n.cache={},n},Q_=Z_((function(t){return t.replace(/([A-Z])/g,(function(t){return"-"+t.toLowerCase()}))})),tv=Z_((function(t){return t.replace(/(-\w)/g,(function(t){return t[1].toUpperCase()}))})),ev=Z_((function(t,e){return t+e[0].toUpperCase()+e.substring(1)}),(function(t,e){return t+"$"+e})),nv=function(t){return J_(t)?t:t.charAt(0).toUpperCase()+t.substring(1)},iv="(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))",ov=function(t,e){return t<e?-1:t>e?1:0},rv=null!=Object.assign?Object.assign.bind(Object):function(t){for(var e=arguments,n=1;n<e.length;n++){var i=e[n];if(null!=i)for(var o=Object.keys(i),r=0;r<o.length;r++){var s=o[r];t[s]=i[s]}}return t},sv=function(t){return(V_(t)?t:null)||function(t){return av[t.toLowerCase()]}(t)||function(t){if((4===t.length||7===t.length)&&"#"===t[0]){var e,n,i,o=16;return 4===t.length?(e=parseInt(t[1]+t[1],o),n=parseInt(t[2]+t[2],o),i=parseInt(t[3]+t[3],o)):(e=parseInt(t[1]+t[2],o),n=parseInt(t[3]+t[4],o),i=parseInt(t[5]+t[6],o)),[e,n,i]}}(t)||function(t){var e,n=new RegExp("^rgb[a]?\\(((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)(?:\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))))?\\)$").exec(t);if(n){e=[];for(var i=[],o=1;o<=3;o++){var r=n[o];if("%"===r[r.length-1]&&(i[o]=!0),r=parseFloat(r),i[o]&&(r=r/100*255),r<0||r>255)return;e.push(Math.floor(r))}var s=i[1]||i[2]||i[3],a=i[1]&&i[2]&&i[3];if(s&&!a)return;var l=n[4];if(void 0!==l){if((l=parseFloat(l))<0||l>1)return;e.push(l)}}return e}(t)||function(t){var e,n,i,o,r,s,a,l;function c(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}var d=new RegExp("^hsl[a]?\\(((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?)))\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%])\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%])(?:\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))))?\\)$").exec(t);if(d){if((n=parseInt(d[1]))<0?n=(360- -1*n%360)%360:n>360&&(n%=360),n/=360,(i=parseFloat(d[2]))<0||i>100)return;if(i/=100,(o=parseFloat(d[3]))<0||o>100)return;if(o/=100,void 0!==(r=d[4])&&((r=parseFloat(r))<0||r>1))return;if(0===i)s=a=l=Math.round(255*o);else{var u=o<.5?o*(1+i):o+i-o*i,h=2*o-u;s=Math.round(255*c(h,u,n+1/3)),a=Math.round(255*c(h,u,n)),l=Math.round(255*c(h,u,n-1/3))}e=[s,a,l,r]}return e}(t)},av={transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},lv=function(t){for(var e=t.map,n=t.keys,i=n.length,o=0;o<i;o++){var r=n[o];if(G_(r))throw Error("Tried to set map with object key");o<n.length-1?(null==e[r]&&(e[r]={}),e=e[r]):e[r]=t.value}},cv=function(t){for(var e=t.map,n=t.keys,i=n.length,o=0;o<i;o++){var r=n[o];if(G_(r))throw Error("Tried to get map with object key");if(null==(e=e[r]))return e}return e},dv=D_?D_.performance:null,uv=dv&&dv.now?function(){return dv.now()}:function(){return Date.now()},hv=function(){if(D_){if(D_.requestAnimationFrame)return function(t){D_.requestAnimationFrame(t)};if(D_.mozRequestAnimationFrame)return function(t){D_.mozRequestAnimationFrame(t)};if(D_.webkitRequestAnimationFrame)return function(t){D_.webkitRequestAnimationFrame(t)};if(D_.msRequestAnimationFrame)return function(t){D_.msRequestAnimationFrame(t)}}return function(t){t&&setTimeout((function(){t(uv())}),1e3/60)}}(),pv=function(t){return hv(t)},gv=uv,fv=65599,mv=function(t){for(var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9261,i=n;!(e=t.next()).done;)i=i*fv+e.value|0;return i},_v=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9261;return e*fv+t|0},vv=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5381;return(e<<5)+e+t|0},yv=function(t){return 2097152*t[0]+t[1]},bv=function(t,e){return[_v(t[0],e[0]),vv(t[1],e[1])]},Ev=function(t,e){var n={value:0,done:!1},i=0,o=t.length;return mv({next:function(){return i<o?n.value=t.charCodeAt(i++):n.done=!0,n}},e)},Tv=function(){return Rv(arguments)},Rv=function(t){for(var e,n=0;n<t.length;n++){var i=t[n];e=0===n?Ev(i):Ev(i,e)}return e},Cv=!0,xv=null!=console.warn,Sv=null!=console.trace,Iv=Number.MAX_SAFE_INTEGER||9007199254740991,Ov=function(){return!0},kv=function(){return!1},wv=function(){return 0},Av=function(){},Dv=function(t){throw new Error(t)},Nv=function(t){if(void 0===t)return Cv;Cv=!!t},Lv=function(t){Nv()&&(xv?console.warn(t):(console.log(t),Sv&&console.trace()))},Pv=function(t){return null==t?t:V_(t)?t.slice():G_(t)?function(t){return rv({},t)}(t):t},Mv=function(t,e){for(e=t="";t++<36;e+=51*t&52?(15^t?8^Math.random()*(20^t?16:4):4).toString(16):"-");return e},Bv={},Fv=function(){return Bv},Hv=function(t){var e=Object.keys(t);return function(n){for(var i={},o=0;o<e.length;o++){var r=e[o],s=null==n?void 0:n[r];i[r]=void 0===s?t[r]:s}return i}},Uv=function(t,e,n){for(var i=t.length;i>=0&&(t[i]!==e||(t.splice(i,1),n));i--);},Vv=function(t){t.splice(0,t.length)},Gv=function(t,e,n){return n&&(e=ev(n,e)),t[e]},Wv=function(t,e,n,i){n&&(e=ev(n,e)),t[e]=i},zv="undefined"!=typeof Map?Map:function(){function t(){I_(this,t),this._obj={}}return k_(t,[{key:"set",value:function(t,e){return this._obj[t]=e,this}},{key:"delete",value:function(t){return this._obj[t]=void 0,this}},{key:"clear",value:function(){this._obj={}}},{key:"has",value:function(t){return void 0!==this._obj[t]}},{key:"get",value:function(t){return this._obj[t]}}]),t}(),Xv=function(){function t(e){if(I_(this,t),this._obj=Object.create(null),this.size=0,null!=e){var n;n=null!=e.instanceString&&e.instanceString()===this.instanceString()?e.toArray():e;for(var i=0;i<n.length;i++)this.add(n[i])}}return k_(t,[{key:"instanceString",value:function(){return"set"}},{key:"add",value:function(t){var e=this._obj;1!==e[t]&&(e[t]=1,this.size++)}},{key:"delete",value:function(t){var e=this._obj;1===e[t]&&(e[t]=0,this.size--)}},{key:"clear",value:function(){this._obj=Object.create(null)}},{key:"has",value:function(t){return 1===this._obj[t]}},{key:"toArray",value:function(){var t=this;return Object.keys(this._obj).filter((function(e){return t.has(e)}))}},{key:"forEach",value:function(t,e){return this.toArray().forEach(t,e)}}]),t}(),jv="undefined"!==("undefined"==typeof Set?"undefined":S_(Set))?Set:Xv,Yv=function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(void 0!==t&&void 0!==e&&K_(t)){var i=e.group;if(null==i&&(i=e.data&&null!=e.data.source&&null!=e.data.target?"edges":"nodes"),"nodes"===i||"edges"===i){this.length=1,this[0]=this;var o=this._private={cy:t,single:!0,data:e.data||{},position:e.position||{x:0,y:0},autoWidth:void 0,autoHeight:void 0,autoPadding:void 0,compoundBoundsClean:!1,listeners:[],group:i,style:{},rstyle:{},styleCxts:[],styleKeys:{},removed:!0,selected:!!e.selected,selectable:void 0===e.selectable||!!e.selectable,locked:!!e.locked,grabbed:!1,grabbable:void 0===e.grabbable||!!e.grabbable,pannable:void 0===e.pannable?"edges"===i:!!e.pannable,active:!1,classes:new jv,animation:{current:[],queue:[]},rscratch:{},scratch:e.scratch||{},edges:[],children:[],parent:null,traversalCache:{},backgrounding:!1,bbCache:null,bbCacheShift:{x:0,y:0},bodyBounds:null,overlayBounds:null,labelBounds:{all:null,source:null,target:null,main:null},arrowBounds:{source:null,target:null,"mid-source":null,"mid-target":null}};if(null==o.position.x&&(o.position.x=0),null==o.position.y&&(o.position.y=0),e.renderedPosition){var r=e.renderedPosition,s=t.pan(),a=t.zoom();o.position={x:(r.x-s.x)/a,y:(r.y-s.y)/a}}var l=[];V_(e.classes)?l=e.classes:H_(e.classes)&&(l=e.classes.split(/\s+/));for(var c=0,d=l.length;c<d;c++){var u=l[c];u&&""!==u&&o.classes.add(u)}this.createEmitter();var h=e.style||e.css;h&&(Lv("Setting a `style` bypass at element creation should be done only when absolutely necessary.  Try to use the stylesheet instead."),this.style(h)),(void 0===n||n)&&this.restore()}else Dv("An element must be of type `nodes` or `edges`; you specified `"+i+"`")}else Dv("An element must have a core reference and parameters set")},Kv=function(t){return t={bfs:t.bfs||!t.dfs,dfs:t.dfs||!t.bfs},function(e,n,i){var o;G_(e)&&!X_(e)&&(e=(o=e).roots||o.root,n=o.visit,i=o.directed),i=2!==arguments.length||U_(n)?i:n,n=U_(n)?n:function(){};for(var r,s=this._private.cy,a=e=H_(e)?this.filter(e):e,l=[],c=[],d={},u={},h={},p=0,g=this.byGroup(),f=g.nodes,m=g.edges,_=0;_<a.length;_++){var v=a[_],y=v.id();v.isNode()&&(l.unshift(v),t.bfs&&(h[y]=!0,c.push(v)),u[y]=0)}var b=function(){var e=t.bfs?l.shift():l.pop(),o=e.id();if(t.dfs){if(h[o])return"continue";h[o]=!0,c.push(e)}var s,a=u[o],g=d[o],_=null!=g?g.source():null,v=null!=g?g.target():null,y=null==g?void 0:e.same(_)?v[0]:_[0];if(!0===(s=n(e,g,y,p++,a)))return r=e,"break";if(!1===s)return"break";for(var b=e.connectedEdges().filter((function(t){return(!i||t.source().same(e))&&m.has(t)})),E=0;E<b.length;E++){var T=b[E],R=T.connectedNodes().filter((function(t){return!t.same(e)&&f.has(t)})),C=R.id();0===R.length||h[C]||(R=R[0],l.push(R),t.bfs&&(h[C]=!0,c.push(R)),d[C]=T,u[C]=u[o]+1)}};t:for(;0!==l.length;){var E=b();switch(E){case"continue":continue;case"break":break t}}for(var T=s.collection(),R=0;R<c.length;R++){var C=c[R],x=d[C.id()];null!=x&&T.push(x),T.push(C)}return{path:s.collection(T),found:s.collection(r)}}},$v={breadthFirstSearch:Kv({bfs:!0}),depthFirstSearch:Kv({dfs:!0})};$v.bfs=$v.breadthFirstSearch,$v.dfs=$v.depthFirstSearch;var Jv=Hv({root:null,weight:function(t){return 1},directed:!1}),qv={dijkstra:function(t){if(!G_(t)){var e=arguments;t={root:e[0],weight:e[1],directed:e[2]}}var n=Jv(t),i=n.root,o=n.weight,r=n.directed,s=this,a=o,l=H_(i)?this.filter(i)[0]:i[0],c={},d={},u={},h=this.byGroup(),p=h.nodes,g=h.edges;g.unmergeBy((function(t){return t.isLoop()}));for(var f=function(t){return c[t.id()]},m=function(t,e){c[t.id()]=e,_.updateItem(t)},_=new x_((function(t,e){return f(t)-f(e)})),v=0;v<p.length;v++){var y=p[v];c[y.id()]=y.same(l)?0:1/0,_.push(y)}for(var b=function(t,e){for(var n,i=(r?t.edgesTo(e):t.edgesWith(e)).intersect(g),o=1/0,s=0;s<i.length;s++){var l=i[s],c=a(l);(c<o||!n)&&(o=c,n=l)}return{edge:n,dist:o}};_.size()>0;){var E=_.pop(),T=f(E),R=E.id();if(u[R]=T,T!==1/0)for(var C=E.neighborhood().intersect(p),x=0;x<C.length;x++){var S=C[x],I=S.id(),O=b(E,S),k=T+O.dist;k<f(S)&&(m(S,k),d[I]={node:E,edge:O.edge})}}return{distanceTo:function(t){var e=H_(t)?p.filter(t)[0]:t[0];return u[e.id()]},pathTo:function(t){var e=H_(t)?p.filter(t)[0]:t[0],n=[],i=e,o=i.id();if(e.length>0)for(n.unshift(e);d[o];){var r=d[o];n.unshift(r.edge),n.unshift(r.node),o=(i=r.node).id()}return s.spawn(n)}}}},Zv={kruskal:function(t){t=t||function(t){return 1};for(var e=this.byGroup(),n=e.nodes,i=e.edges,o=n.length,r=new Array(o),s=n,a=function(t){for(var e=0;e<r.length;e++){if(r[e].has(t))return e}},l=0;l<o;l++)r[l]=this.spawn(n[l]);for(var c=i.sort((function(e,n){return t(e)-t(n)})),d=0;d<c.length;d++){var u=c[d],h=u.source()[0],p=u.target()[0],g=a(h),f=a(p),m=r[g],_=r[f];g!==f&&(s.merge(u),m.merge(_),r.splice(f,1))}return s}},Qv=Hv({root:null,goal:null,weight:function(t){return 1},heuristic:function(t){return 0},directed:!1}),ty={aStar:function(t){var e=this.cy(),n=Qv(t),i=n.root,o=n.goal,r=n.heuristic,s=n.directed,a=n.weight;i=e.collection(i)[0],o=e.collection(o)[0];var l,c,d=i.id(),u=o.id(),h={},p={},g={},f=new x_((function(t,e){return p[t.id()]-p[e.id()]})),m=new jv,_={},v={},y=function(t,e){f.push(t),m.add(e)};y(i,d),h[d]=0,p[d]=r(i);for(var b,E=0;f.size()>0;){if(l=f.pop(),c=l.id(),m.delete(c),E++,c===u){for(var T=[],R=o,C=u,x=v[C];T.unshift(R),null!=x&&T.unshift(x),null!=(R=_[C]);)x=v[C=R.id()];return{found:!0,distance:h[c],path:this.spawn(T),steps:E}}g[c]=!0;for(var S=l._private.edges,I=0;I<S.length;I++){var O=S[I];if(this.hasElementWithId(O.id())&&(!s||O.data("source")===c)){var k=O.source(),w=O.target(),A=k.id()!==c?k:w,D=A.id();if(this.hasElementWithId(D)&&!g[D]){var N=h[c]+a(O);b=D,m.has(b)?N<h[D]&&(h[D]=N,p[D]=N+r(A),_[D]=l):(h[D]=N,p[D]=N+r(A),y(A,D),_[D]=l,v[D]=O)}}}}return{found:!1,distance:void 0,path:void 0,steps:E}}},ey=Hv({weight:function(t){return 1},directed:!1}),ny={floydWarshall:function(t){for(var e=this.cy(),n=ey(t),i=n.weight,o=n.directed,r=i,s=this.byGroup(),a=s.nodes,l=s.edges,c=a.length,d=c*c,u=function(t){return a.indexOf(t)},h=function(t){return a[t]},p=new Array(d),g=0;g<d;g++){var f=g%c,m=(g-f)/c;p[g]=m===f?0:1/0}for(var _=new Array(d),v=new Array(d),y=0;y<l.length;y++){var b=l[y],E=b.source()[0],T=b.target()[0];if(E!==T){var R=u(E),C=u(T),x=R*c+C,S=r(b);if(p[x]>S&&(p[x]=S,_[x]=C,v[x]=b),!o){var I=C*c+R;!o&&p[I]>S&&(p[I]=S,_[I]=R,v[I]=b)}}}for(var O=0;O<c;O++)for(var k=0;k<c;k++)for(var w=k*c+O,A=0;A<c;A++){var D=k*c+A,N=O*c+A;p[w]+p[N]<p[D]&&(p[D]=p[w]+p[N],_[D]=_[w])}var L=function(t){return u(function(t){return(H_(t)?e.filter(t):t)[0]}(t))};return{distance:function(t,e){var n=L(t),i=L(e);return p[n*c+i]},path:function(t,n){var i=L(t),o=L(n),r=h(i);if(i===o)return r.collection();if(null==_[i*c+o])return e.collection();var s,a=e.collection(),l=i;for(a.merge(r);i!==o;)l=i,i=_[i*c+o],s=v[l*c+i],a.merge(s),a.merge(h(i));return a}}}},iy=Hv({weight:function(t){return 1},directed:!1,root:null}),oy={bellmanFord:function(t){var e=this,n=iy(t),i=n.weight,o=n.directed,r=n.root,s=i,a=this,l=this.cy(),c=this.byGroup(),d=c.edges,u=c.nodes,h=u.length,p=new zv,g=!1;r=l.collection(r)[0],d.unmergeBy((function(t){return t.isLoop()}));for(var f=d.length,m=function(t){var e=p.get(t.id());return e||(e={},p.set(t.id(),e)),e},_=function(t){return(H_(t)?l.$(t):t)[0]},v=0;v<h;v++){var y=u[v],b=m(y);y.same(r)?b.dist=0:b.dist=1/0,b.pred=null,b.edge=null}for(var E=!1,T=function(t,e,n,i,o,r){var s=i.dist+r;s<o.dist&&!n.same(i.edge)&&(o.dist=s,o.pred=t,o.edge=n,E=!0)},R=1;R<h;R++){E=!1;for(var C=0;C<f;C++){var x=d[C],S=x.source(),I=x.target(),O=s(x),k=m(S),w=m(I);T(S,0,x,k,w,O),o||T(I,0,x,w,k,O)}if(!E)break}if(E)for(var A=0;A<f;A++){var D=d[A],N=D.source(),L=D.target(),P=s(D),M=m(N).dist,B=m(L).dist;if(M+P<B||!o&&B+P<M){Lv("Graph contains a negative weight cycle for Bellman-Ford"),g=!0;break}}return{distanceTo:function(t){return m(_(t)).dist},pathTo:function(t){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r,i=_(t),o=[],s=i;;){if(null==s)return e.spawn();var l=m(s),c=l.edge,d=l.pred;if(o.unshift(s[0]),s.same(n)&&o.length>0)break;null!=c&&o.unshift(c),s=d}return a.spawn(o)},hasNegativeWeightCycle:g,negativeWeightCycles:[]}}},ry=Math.sqrt(2),sy=function(t,e,n){0===n.length&&Dv("Karger-Stein must be run on a connected (sub)graph");for(var i=n[t],o=i[1],r=i[2],s=e[o],a=e[r],l=n,c=l.length-1;c>=0;c--){var d=l[c],u=d[1],h=d[2];(e[u]===s&&e[h]===a||e[u]===a&&e[h]===s)&&l.splice(c,1)}for(var p=0;p<l.length;p++){var g=l[p];g[1]===a?(l[p]=g.slice(),l[p][1]=s):g[2]===a&&(l[p]=g.slice(),l[p][2]=s)}for(var f=0;f<e.length;f++)e[f]===a&&(e[f]=s);return l},ay=function(t,e,n,i){for(;n>i;){var o=Math.floor(Math.random()*e.length);e=sy(o,t,e),n--}return e},ly={kargerStein:function(){var t=this,e=this.byGroup(),n=e.nodes,i=e.edges;i.unmergeBy((function(t){return t.isLoop()}));var o=n.length,r=i.length,s=Math.ceil(Math.pow(Math.log(o)/Math.LN2,2)),a=Math.floor(o/ry);if(!(o<2)){for(var l=[],c=0;c<r;c++){var d=i[c];l.push([c,n.indexOf(d.source()),n.indexOf(d.target())])}for(var u=1/0,h=[],p=new Array(o),g=new Array(o),f=new Array(o),m=function(t,e){for(var n=0;n<o;n++)e[n]=t[n]},_=0;_<=s;_++){for(var v=0;v<o;v++)g[v]=v;var y=ay(g,l.slice(),o,a),b=y.slice();m(g,f);var E=ay(g,y,a,2),T=ay(f,b,a,2);E.length<=T.length&&E.length<u?(u=E.length,h=E,m(g,p)):T.length<=E.length&&T.length<u&&(u=T.length,h=T,m(f,p))}for(var R=this.spawn(h.map((function(t){return i[t[0]]}))),C=this.spawn(),x=this.spawn(),S=p[0],I=0;I<p.length;I++){var O=p[I],k=n[I];O===S?C.merge(k):x.merge(k)}var w=function(e){var n=t.spawn();return e.forEach((function(e){n.merge(e),e.connectedEdges().forEach((function(e){t.contains(e)&&!R.contains(e)&&n.merge(e)}))})),n},A=[w(C),w(x)];return{cut:R,components:A,partition1:C,partition2:x}}Dv("At least 2 nodes are required for Karger-Stein algorithm")}},cy=function(t,e,n){return{x:t.x*e+n.x,y:t.y*e+n.y}},dy=function(t,e,n){return{x:(t.x-n.x)/e,y:(t.y-n.y)/e}},uy=function(t){return{x:t[0],y:t[1]}},hy=function(t,e){return Math.atan2(e,t)-Math.PI/2},py=Math.log2||function(t){return Math.log(t)/Math.log(2)},gy=function(t){return t>0?1:t<0?-1:0},fy=function(t,e){return Math.sqrt(my(t,e))},my=function(t,e){var n=e.x-t.x,i=e.y-t.y;return n*n+i*i},_y=function(t){for(var e=t.length,n=0,i=0;i<e;i++)n+=t[i];for(var o=0;o<e;o++)t[o]=t[o]/n;return t},vy=function(t,e,n,i){return(1-i)*(1-i)*t+2*(1-i)*i*e+i*i*n},yy=function(t,e,n,i){return{x:vy(t.x,e.x,n.x,i),y:vy(t.y,e.y,n.y,i)}},by=function(t,e,n){return Math.max(t,Math.min(n,e))},Ey=function(t){if(null==t)return{x1:1/0,y1:1/0,x2:-1/0,y2:-1/0,w:0,h:0};if(null!=t.x1&&null!=t.y1){if(null!=t.x2&&null!=t.y2&&t.x2>=t.x1&&t.y2>=t.y1)return{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,w:t.x2-t.x1,h:t.y2-t.y1};if(null!=t.w&&null!=t.h&&t.w>=0&&t.h>=0)return{x1:t.x1,y1:t.y1,x2:t.x1+t.w,y2:t.y1+t.h,w:t.w,h:t.h}}},Ty=function(t,e,n){t.x1=Math.min(t.x1,e),t.x2=Math.max(t.x2,e),t.w=t.x2-t.x1,t.y1=Math.min(t.y1,n),t.y2=Math.max(t.y2,n),t.h=t.y2-t.y1},Ry=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.x1-=e,t.x2+=e,t.y1-=e,t.y2+=e,t.w=t.x2-t.x1,t.h=t.y2-t.y1,t},Cy=function(t){var e,n,i,o,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0];if(1===r.length)e=n=i=o=r[0];else if(2===r.length)e=i=r[0],o=n=r[1];else if(4===r.length){var s=A_(r,4);e=s[0],n=s[1],i=s[2],o=s[3]}return t.x1-=o,t.x2+=n,t.y1-=e,t.y2+=i,t.w=t.x2-t.x1,t.h=t.y2-t.y1,t},xy=function(t,e){t.x1=e.x1,t.y1=e.y1,t.x2=e.x2,t.y2=e.y2,t.w=t.x2-t.x1,t.h=t.y2-t.y1},Sy=function(t,e){return!(t.x1>e.x2)&&(!(e.x1>t.x2)&&(!(t.x2<e.x1)&&(!(e.x2<t.x1)&&(!(t.y2<e.y1)&&(!(e.y2<t.y1)&&(!(t.y1>e.y2)&&!(e.y1>t.y2)))))))},Iy=function(t,e,n){return t.x1<=e&&e<=t.x2&&t.y1<=n&&n<=t.y2},Oy=function(t,e){return Iy(t,e.x1,e.y1)&&Iy(t,e.x2,e.y2)},ky=function(t,e,n,i,o,r,s){var a,l=Yy(o,r),c=o/2,d=r/2,u=i-d-s;if((a=Vy(t,e,n,i,n-c+l-s,u,n+c-l+s,u,!1)).length>0)return a;var h=n+c+s;if((a=Vy(t,e,n,i,h,i-d+l-s,h,i+d-l+s,!1)).length>0)return a;var p=i+d+s;if((a=Vy(t,e,n,i,n-c+l-s,p,n+c-l+s,p,!1)).length>0)return a;var g,f=n-c-s;if((a=Vy(t,e,n,i,f,i-d+l-s,f,i+d-l+s,!1)).length>0)return a;var m=n-c+l,_=i-d+l;if((g=Hy(t,e,n,i,m,_,l+s)).length>0&&g[0]<=m&&g[1]<=_)return[g[0],g[1]];var v=n+c-l,y=i-d+l;if((g=Hy(t,e,n,i,v,y,l+s)).length>0&&g[0]>=v&&g[1]<=y)return[g[0],g[1]];var b=n+c-l,E=i+d-l;if((g=Hy(t,e,n,i,b,E,l+s)).length>0&&g[0]>=b&&g[1]>=E)return[g[0],g[1]];var T=n-c+l,R=i+d-l;return(g=Hy(t,e,n,i,T,R,l+s)).length>0&&g[0]<=T&&g[1]>=R?[g[0],g[1]]:[]},wy=function(t,e,n,i,o,r,s){var a=s,l=Math.min(n,o),c=Math.max(n,o),d=Math.min(i,r),u=Math.max(i,r);return l-a<=t&&t<=c+a&&d-a<=e&&e<=u+a},Ay=function(t,e,n,i,o,r,s,a,l){var c=Math.min(n,s,o)-l,d=Math.max(n,s,o)+l,u=Math.min(i,a,r)-l,h=Math.max(i,a,r)+l;return!(t<c||t>d||e<u||e>h)},Dy=function(t,e,n,i,o,r,s,a){var l=[];!function(t,e,n,i,o){var r,s,a,l,c,d,u,h;0===t&&(t=1e-5),a=-27*(i/=t)+(e/=t)*(9*(n/=t)-e*e*2),r=(s=(3*n-e*e)/9)*s*s+(a/=54)*a,o[1]=0,u=e/3,r>0?(c=(c=a+Math.sqrt(r))<0?-Math.pow(-c,1/3):Math.pow(c,1/3),d=(d=a-Math.sqrt(r))<0?-Math.pow(-d,1/3):Math.pow(d,1/3),o[0]=-u+c+d,u+=(c+d)/2,o[4]=o[2]=-u,u=Math.sqrt(3)*(-d+c)/2,o[3]=u,o[5]=-u):(o[5]=o[3]=0,0===r?(h=a<0?-Math.pow(-a,1/3):Math.pow(a,1/3),o[0]=2*h-u,o[4]=o[2]=-(h+u)):(l=(s=-s)*s*s,l=Math.acos(a/Math.sqrt(l)),h=2*Math.sqrt(s),o[0]=-u+h*Math.cos(l/3),o[2]=-u+h*Math.cos((l+2*Math.PI)/3),o[4]=-u+h*Math.cos((l+4*Math.PI)/3)))}(1*n*n-4*n*o+2*n*s+4*o*o-4*o*s+s*s+i*i-4*i*r+2*i*a+4*r*r-4*r*a+a*a,9*n*o-3*n*n-3*n*s-6*o*o+3*o*s+9*i*r-3*i*i-3*i*a-6*r*r+3*r*a,3*n*n-6*n*o+n*s-n*t+2*o*o+2*o*t-s*t+3*i*i-6*i*r+i*a-i*e+2*r*r+2*r*e-a*e,1*n*o-n*n+n*t-o*t+i*r-i*i+i*e-r*e,l);for(var c=[],d=0;d<6;d+=2)Math.abs(l[d+1])<1e-7&&l[d]>=0&&l[d]<=1&&c.push(l[d]);c.push(1),c.push(0);for(var u,h,p,g=-1,f=0;f<c.length;f++)u=Math.pow(1-c[f],2)*n+2*(1-c[f])*c[f]*o+c[f]*c[f]*s,h=Math.pow(1-c[f],2)*i+2*(1-c[f])*c[f]*r+c[f]*c[f]*a,p=Math.pow(u-t,2)+Math.pow(h-e,2),g>=0?p<g&&(g=p):g=p;return g},Ny=function(t,e,n,i,o,r){var s=[t-n,e-i],a=[o-n,r-i],l=a[0]*a[0]+a[1]*a[1],c=s[0]*s[0]+s[1]*s[1],d=s[0]*a[0]+s[1]*a[1],u=d*d/l;return d<0?c:u>l?(t-o)*(t-o)+(e-r)*(e-r):c-u},Ly=function(t,e,n){for(var i,o,r,s,a=0,l=0;l<n.length/2;l++)if(i=n[2*l],o=n[2*l+1],l+1<n.length/2?(r=n[2*(l+1)],s=n[2*(l+1)+1]):(r=n[2*(l+1-n.length/2)],s=n[2*(l+1-n.length/2)+1]),i==t&&r==t);else{if(!(i>=t&&t>=r||i<=t&&t<=r))continue;(t-i)/(r-i)*(s-o)+o>e&&a++}return a%2!=0},Py=function(t,e,n,i,o,r,s,a,l){var c,d=new Array(n.length);null!=a[0]?(c=Math.atan(a[1]/a[0]),a[0]<0?c+=Math.PI/2:c=-c-Math.PI/2):c=a;for(var u,h=Math.cos(-c),p=Math.sin(-c),g=0;g<d.length/2;g++)d[2*g]=r/2*(n[2*g]*h-n[2*g+1]*p),d[2*g+1]=s/2*(n[2*g+1]*h+n[2*g]*p),d[2*g]+=i,d[2*g+1]+=o;if(l>0){var f=By(d,-l);u=My(f)}else u=d;return Ly(t,e,u)},My=function(t){for(var e,n,i,o,r,s,a,l,c=new Array(t.length/2),d=0;d<t.length/4;d++){e=t[4*d],n=t[4*d+1],i=t[4*d+2],o=t[4*d+3],d<t.length/4-1?(r=t[4*(d+1)],s=t[4*(d+1)+1],a=t[4*(d+1)+2],l=t[4*(d+1)+3]):(r=t[0],s=t[1],a=t[2],l=t[3]);var u=Vy(e,n,i,o,r,s,a,l,!0);c[2*d]=u[0],c[2*d+1]=u[1]}return c},By=function(t,e){for(var n,i,o,r,s=new Array(2*t.length),a=0;a<t.length/2;a++){n=t[2*a],i=t[2*a+1],a<t.length/2-1?(o=t[2*(a+1)],r=t[2*(a+1)+1]):(o=t[0],r=t[1]);var l=r-i,c=-(o-n),d=Math.sqrt(l*l+c*c),u=l/d,h=c/d;s[4*a]=n+u*e,s[4*a+1]=i+h*e,s[4*a+2]=o+u*e,s[4*a+3]=r+h*e}return s},Fy=function(t,e,n,i,o,r,s){return t-=o,e-=r,(t/=n/2+s)*t+(e/=i/2+s)*e<=1},Hy=function(t,e,n,i,o,r,s){var a=[n-t,i-e],l=[t-o,e-r],c=a[0]*a[0]+a[1]*a[1],d=2*(l[0]*a[0]+l[1]*a[1]),u=d*d-4*c*(l[0]*l[0]+l[1]*l[1]-s*s);if(u<0)return[];var h=(-d+Math.sqrt(u))/(2*c),p=(-d-Math.sqrt(u))/(2*c),g=Math.min(h,p),f=Math.max(h,p),m=[];if(g>=0&&g<=1&&m.push(g),f>=0&&f<=1&&m.push(f),0===m.length)return[];var _=m[0]*a[0]+t,v=m[0]*a[1]+e;return m.length>1?m[0]==m[1]?[_,v]:[_,v,m[1]*a[0]+t,m[1]*a[1]+e]:[_,v]},Uy=function(t,e,n){return e<=t&&t<=n||n<=t&&t<=e?t:t<=e&&e<=n||n<=e&&e<=t?e:n},Vy=function(t,e,n,i,o,r,s,a,l){var c=t-o,d=n-t,u=s-o,h=e-r,p=i-e,g=a-r,f=u*h-g*c,m=d*h-p*c,_=g*d-u*p;if(0!==_){var v=f/_,y=m/_,b=-.001;return b<=v&&v<=1.001&&b<=y&&y<=1.001||l?[t+v*d,e+v*p]:[]}return 0===f||0===m?Uy(t,n,s)===s?[s,a]:Uy(t,n,o)===o?[o,r]:Uy(o,s,n)===n?[n,i]:[]:[]},Gy=function(t,e,n,i,o,r,s,a){var l,c,d,u,h,p,g=[],f=new Array(n.length),m=!0;if(null==r&&(m=!1),m){for(var _=0;_<f.length/2;_++)f[2*_]=n[2*_]*r+i,f[2*_+1]=n[2*_+1]*s+o;if(a>0){var v=By(f,-a);c=My(v)}else c=f}else c=n;for(var y=0;y<c.length/2;y++)d=c[2*y],u=c[2*y+1],y<c.length/2-1?(h=c[2*(y+1)],p=c[2*(y+1)+1]):(h=c[0],p=c[1]),0!==(l=Vy(t,e,i,o,d,u,h,p)).length&&g.push(l[0],l[1]);return g},Wy=function(t,e,n){var i=[t[0]-e[0],t[1]-e[1]],o=Math.sqrt(i[0]*i[0]+i[1]*i[1]),r=(o-n)/o;return r<0&&(r=1e-5),[e[0]+r*i[0],e[1]+r*i[1]]},zy=function(t,e){var n=jy(t,e);return n=Xy(n)},Xy=function(t){for(var e,n,i=t.length/2,o=1/0,r=1/0,s=-1/0,a=-1/0,l=0;l<i;l++)e=t[2*l],n=t[2*l+1],o=Math.min(o,e),s=Math.max(s,e),r=Math.min(r,n),a=Math.max(a,n);for(var c=2/(s-o),d=2/(a-r),u=0;u<i;u++)e=t[2*u]=t[2*u]*c,n=t[2*u+1]=t[2*u+1]*d,o=Math.min(o,e),s=Math.max(s,e),r=Math.min(r,n),a=Math.max(a,n);if(r<-1)for(var h=0;h<i;h++)n=t[2*h+1]=t[2*h+1]+(-1-r);return t},jy=function(t,e){var n=1/t*2*Math.PI,i=t%2==0?Math.PI/2+n/2:Math.PI/2;i+=e;for(var o,r=new Array(2*t),s=0;s<t;s++)o=s*n+i,r[2*s]=Math.cos(o),r[2*s+1]=Math.sin(-o);return r},Yy=function(t,e){return Math.min(t/4,e/4,8)},Ky=function(t,e){return Math.min(t/10,e/10,8)},$y=function(t,e){return{heightOffset:Math.min(15,.05*e),widthOffset:Math.min(100,.25*t),ctrlPtOffsetPct:.05}},Jy=Hv({dampingFactor:.8,precision:1e-6,iterations:200,weight:function(t){return 1}}),qy={pageRank:function(t){for(var e=Jy(t),n=e.dampingFactor,i=e.precision,o=e.iterations,r=e.weight,s=this._private.cy,a=this.byGroup(),l=a.nodes,c=a.edges,d=l.length,u=d*d,h=c.length,p=new Array(u),g=new Array(d),f=(1-n)/d,m=0;m<d;m++){for(var _=0;_<d;_++){p[m*d+_]=0}g[m]=0}for(var v=0;v<h;v++){var y=c[v],b=y.data("source"),E=y.data("target");if(b!==E){var T=l.indexOfId(b),R=l.indexOfId(E),C=r(y);p[R*d+T]+=C,g[T]+=C}}for(var x=1/d+f,S=0;S<d;S++)if(0===g[S])for(var I=0;I<d;I++){p[I*d+S]=x}else for(var O=0;O<d;O++){var k=O*d+S;p[k]=p[k]/g[S]+f}for(var w,A=new Array(d),D=new Array(d),N=0;N<d;N++)A[N]=1;for(var L=0;L<o;L++){for(var P=0;P<d;P++)D[P]=0;for(var M=0;M<d;M++)for(var B=0;B<d;B++){var F=M*d+B;D[M]+=p[F]*A[B]}_y(D),w=A,A=D,D=w;for(var H=0,U=0;U<d;U++){var V=w[U]-A[U];H+=V*V}if(H<i)break}return{rank:function(t){return t=s.collection(t)[0],A[l.indexOf(t)]}}}},Zy=Hv({root:null,weight:function(t){return 1},directed:!1,alpha:0}),Qy={degreeCentralityNormalized:function(t){t=Zy(t);var e=this.cy(),n=this.nodes(),i=n.length;if(t.directed){for(var o={},r={},s=0,a=0,l=0;l<i;l++){var c=n[l],d=c.id();t.root=c;var u=this.degreeCentrality(t);s<u.indegree&&(s=u.indegree),a<u.outdegree&&(a=u.outdegree),o[d]=u.indegree,r[d]=u.outdegree}return{indegree:function(t){return 0==s?0:(H_(t)&&(t=e.filter(t)),o[t.id()]/s)},outdegree:function(t){return 0===a?0:(H_(t)&&(t=e.filter(t)),r[t.id()]/a)}}}for(var h={},p=0,g=0;g<i;g++){var f=n[g];t.root=f;var m=this.degreeCentrality(t);p<m.degree&&(p=m.degree),h[f.id()]=m.degree}return{degree:function(t){return 0===p?0:(H_(t)&&(t=e.filter(t)),h[t.id()]/p)}}},degreeCentrality:function(t){t=Zy(t);var e=this.cy(),n=this,i=t,o=i.root,r=i.weight,s=i.directed,a=i.alpha;if(o=e.collection(o)[0],s){for(var l=o.connectedEdges(),c=l.filter((function(t){return t.target().same(o)&&n.has(t)})),d=l.filter((function(t){return t.source().same(o)&&n.has(t)})),u=c.length,h=d.length,p=0,g=0,f=0;f<c.length;f++)p+=r(c[f]);for(var m=0;m<d.length;m++)g+=r(d[m]);return{indegree:Math.pow(u,1-a)*Math.pow(p,a),outdegree:Math.pow(h,1-a)*Math.pow(g,a)}}for(var _=o.connectedEdges().intersection(n),v=_.length,y=0,b=0;b<_.length;b++)y+=r(_[b]);return{degree:Math.pow(v,1-a)*Math.pow(y,a)}}};Qy.dc=Qy.degreeCentrality,Qy.dcn=Qy.degreeCentralityNormalised=Qy.degreeCentralityNormalized;var tb=Hv({harmonic:!0,weight:function(){return 1},directed:!1,root:null}),eb={closenessCentralityNormalized:function(t){for(var e=tb(t),n=e.harmonic,i=e.weight,o=e.directed,r=this.cy(),s={},a=0,l=this.nodes(),c=this.floydWarshall({weight:i,directed:o}),d=0;d<l.length;d++){for(var u=0,h=l[d],p=0;p<l.length;p++)if(d!==p){var g=c.distance(h,l[p]);u+=n?1/g:g}n||(u=1/u),a<u&&(a=u),s[h.id()]=u}return{closeness:function(t){return 0==a?0:(t=H_(t)?r.filter(t)[0].id():t.id(),s[t]/a)}}},closenessCentrality:function(t){var e=tb(t),n=e.root,i=e.weight,o=e.directed,r=e.harmonic;n=this.filter(n)[0];for(var s=this.dijkstra({root:n,weight:i,directed:o}),a=0,l=this.nodes(),c=0;c<l.length;c++){var d=l[c];if(!d.same(n)){var u=s.distanceTo(d);a+=r?1/u:u}}return r?a:1/a}};eb.cc=eb.closenessCentrality,eb.ccn=eb.closenessCentralityNormalised=eb.closenessCentralityNormalized;var nb=Hv({weight:null,directed:!1}),ib={betweennessCentrality:function(t){for(var e=nb(t),n=e.directed,i=e.weight,o=null!=i,r=this.cy(),s=this.nodes(),a={},l={},c=0,d=function(t,e){l[t]=e,e>c&&(c=e)},u=function(t){return l[t]},h=0;h<s.length;h++){var p=s[h],g=p.id();a[g]=n?p.outgoers().nodes():p.openNeighborhood().nodes(),d(g,0)}for(var f=function(t){for(var e=s[t].id(),n=[],l={},c={},h={},p=new x_((function(t,e){return h[t]-h[e]})),g=0;g<s.length;g++){var f=s[g].id();l[f]=[],c[f]=0,h[f]=1/0}for(c[e]=1,h[e]=0,p.push(e);!p.empty();){var m=p.pop();if(n.push(m),o)for(var _=0;_<a[m].length;_++){var v=a[m][_],y=r.getElementById(m),b=void 0;b=y.edgesTo(v).length>0?y.edgesTo(v)[0]:v.edgesTo(y)[0];var E=i(b);v=v.id(),h[v]>h[m]+E&&(h[v]=h[m]+E,p.nodes.indexOf(v)<0?p.push(v):p.updateItem(v),c[v]=0,l[v]=[]),h[v]==h[m]+E&&(c[v]=c[v]+c[m],l[v].push(m))}else for(var T=0;T<a[m].length;T++){var R=a[m][T].id();h[R]==1/0&&(p.push(R),h[R]=h[m]+1),h[R]==h[m]+1&&(c[R]=c[R]+c[m],l[R].push(m))}}for(var C={},x=0;x<s.length;x++)C[s[x].id()]=0;for(;n.length>0;){for(var S=n.pop(),I=0;I<l[S].length;I++){var O=l[S][I];C[O]=C[O]+c[O]/c[S]*(1+C[S])}S!=s[t].id()&&d(S,u(S)+C[S])}},m=0;m<s.length;m++)f(m);var _={betweenness:function(t){var e=r.collection(t).id();return u(e)},betweennessNormalized:function(t){if(0==c)return 0;var e=r.collection(t).id();return u(e)/c}};return _.betweennessNormalised=_.betweennessNormalized,_}};ib.bc=ib.betweennessCentrality;var ob=Hv({expandFactor:2,inflateFactor:2,multFactor:1,maxIterations:20,attributes:[function(t){return 1}]}),rb=function(t,e){for(var n=0,i=0;i<e.length;i++)n+=e[i](t);return n},sb=function(t,e){for(var n,i=0;i<e;i++){n=0;for(var o=0;o<e;o++)n+=t[o*e+i];for(var r=0;r<e;r++)t[r*e+i]=t[r*e+i]/n}},ab=function(t,e,n){for(var i=new Array(n*n),o=0;o<n;o++){for(var r=0;r<n;r++)i[o*n+r]=0;for(var s=0;s<n;s++)for(var a=0;a<n;a++)i[o*n+a]+=t[o*n+s]*e[s*n+a]}return i},lb=function(t,e,n){for(var i=t.slice(0),o=1;o<n;o++)t=ab(t,i,e);return t},cb=function(t,e,n){for(var i=new Array(e*e),o=0;o<e*e;o++)i[o]=Math.pow(t[o],n);return sb(i,e),i},db=function(t,e,n,i){for(var o=0;o<n;o++){if(Math.round(t[o]*Math.pow(10,i))/Math.pow(10,i)!==Math.round(e[o]*Math.pow(10,i))/Math.pow(10,i))return!1}return!0},ub=function(t,e){for(var n=0;n<t.length;n++)if(!e[n]||t[n].id()!==e[n].id())return!1;return!0},hb=function(t){for(var e=this.nodes(),n=this.edges(),i=this.cy(),o=function(t){return ob(t)}(t),r={},s=0;s<e.length;s++)r[e[s].id()]=s;for(var a,l=e.length,c=l*l,d=new Array(c),u=0;u<c;u++)d[u]=0;for(var h=0;h<n.length;h++){var p=n[h],g=r[p.source().id()],f=r[p.target().id()],m=rb(p,o.attributes);d[g*l+f]+=m,d[f*l+g]+=m}!function(t,e,n){for(var i=0;i<e;i++)t[i*e+i]=n}(d,l,o.multFactor),sb(d,l);for(var _=!0,v=0;_&&v<o.maxIterations;)_=!1,a=lb(d,l,o.expandFactor),d=cb(a,l,o.inflateFactor),db(d,a,c,4)||(_=!0),v++;var y=function(t,e,n,i){for(var o=[],r=0;r<e;r++){for(var s=[],a=0;a<e;a++)Math.round(1e3*t[r*e+a])/1e3>0&&s.push(n[a]);0!==s.length&&o.push(i.collection(s))}return o}(d,l,e,i);return y=function(t){for(var e=0;e<t.length;e++)for(var n=0;n<t.length;n++)e!=n&&ub(t[e],t[n])&&t.splice(n,1);return t}(y)},pb={markovClustering:hb,mcl:hb},gb=function(t){return t},fb=function(t,e){return Math.abs(e-t)},mb=function(t,e,n){return t+fb(e,n)},_b=function(t,e,n){return t+Math.pow(n-e,2)},vb=function(t){return Math.sqrt(t)},yb=function(t,e,n){return Math.max(t,fb(e,n))},bb=function(t,e,n,i,o){for(var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:gb,s=i,a=0;a<t;a++)s=o(s,e(a),n(a));return r(s)},Eb={euclidean:function(t,e,n){return t>=2?bb(t,e,n,0,_b,vb):bb(t,e,n,0,mb)},squaredEuclidean:function(t,e,n){return bb(t,e,n,0,_b)},manhattan:function(t,e,n){return bb(t,e,n,0,mb)},max:function(t,e,n){return bb(t,e,n,-1/0,yb)}};function Tb(t,e,n,i,o,r){var s;return s=U_(t)?t:Eb[t]||Eb.euclidean,0===e&&U_(t)?s(o,r):s(e,n,i,o,r)}Eb["squared-euclidean"]=Eb.squaredEuclidean,Eb.squaredeuclidean=Eb.squaredEuclidean;var Rb=Hv({k:2,m:2,sensitivityThreshold:1e-4,distance:"euclidean",maxIterations:10,attributes:[],testMode:!1,testCentroids:null}),Cb=function(t){return Rb(t)},xb=function(t,e,n,i,o){var r="kMedoids"!==o?function(t){return n[t]}:function(t){return i[t](n)},s=n,a=e;return Tb(t,i.length,r,(function(t){return i[t](e)}),s,a)},Sb=function(t,e,n){for(var i=n.length,o=new Array(i),r=new Array(i),s=new Array(e),a=null,l=0;l<i;l++)o[l]=t.min(n[l]).value,r[l]=t.max(n[l]).value;for(var c=0;c<e;c++){a=[];for(var d=0;d<i;d++)a[d]=Math.random()*(r[d]-o[d])+o[d];s[c]=a}return s},Ib=function(t,e,n,i,o){for(var r=1/0,s=0,a=0;a<e.length;a++){var l=xb(n,t,e[a],i,o);l<r&&(r=l,s=a)}return s},Ob=function(t,e,n){for(var i=[],o=null,r=0;r<e.length;r++)n[(o=e[r]).id()]===t&&i.push(o);return i},kb=function(t,e,n){for(var i=0;i<t.length;i++)for(var o=0;o<t[i].length;o++){if(Math.abs(t[i][o]-e[i][o])>n)return!1}return!0},wb=function(t,e,n){for(var i=0;i<n;i++)if(t===e[i])return!0;return!1},Ab=function(t,e){var n=new Array(e);if(t.length<50)for(var i=0;i<e;i++){for(var o=t[Math.floor(Math.random()*t.length)];wb(o,n,i);)o=t[Math.floor(Math.random()*t.length)];n[i]=o}else for(var r=0;r<e;r++)n[r]=t[Math.floor(Math.random()*t.length)];return n},Db=function(t,e,n){for(var i=0,o=0;o<e.length;o++)i+=xb("manhattan",e[o],t,n,"kMedoids");return i},Nb=function(t,e,n,i,o){for(var r,s,a=0;a<e.length;a++)for(var l=0;l<t.length;l++)i[a][l]=Math.pow(n[a][l],o.m);for(var c=0;c<t.length;c++)for(var d=0;d<o.attributes.length;d++){r=0,s=0;for(var u=0;u<e.length;u++)r+=i[u][c]*o.attributes[d](e[u]),s+=i[u][c];t[c][d]=r/s}},Lb=function(t,e,n,i,o){for(var r=0;r<t.length;r++)e[r]=t[r].slice();for(var s,a,l,c=2/(o.m-1),d=0;d<n.length;d++)for(var u=0;u<i.length;u++){s=0;for(var h=0;h<n.length;h++)a=xb(o.distance,i[u],n[d],o.attributes,"cmeans"),l=xb(o.distance,i[u],n[h],o.attributes,"cmeans"),s+=Math.pow(a/l,c);t[u][d]=1/s}},Pb=function(t){var e,n,i,o,r=this.cy(),s=this.nodes(),a=Cb(t);i=new Array(s.length);for(var l=0;l<s.length;l++)i[l]=new Array(a.k);n=new Array(s.length);for(var c=0;c<s.length;c++)n[c]=new Array(a.k);for(var d=0;d<s.length;d++){for(var u=0,h=0;h<a.k;h++)n[d][h]=Math.random(),u+=n[d][h];for(var p=0;p<a.k;p++)n[d][p]=n[d][p]/u}e=new Array(a.k);for(var g=0;g<a.k;g++)e[g]=new Array(a.attributes.length);o=new Array(s.length);for(var f=0;f<s.length;f++)o[f]=new Array(a.k);for(var m=!0,_=0;m&&_<a.maxIterations;)m=!1,Nb(e,s,n,o,a),Lb(n,i,e,s,a),kb(n,i,a.sensitivityThreshold)||(m=!0),_++;return{clusters:function(t,e,n,i){for(var o,r,s=new Array(n.k),a=0;a<s.length;a++)s[a]=[];for(var l=0;l<e.length;l++){o=-1/0,r=-1;for(var c=0;c<e[0].length;c++)e[l][c]>o&&(o=e[l][c],r=c);s[r].push(t[l])}for(var d=0;d<s.length;d++)s[d]=i.collection(s[d]);return s}(s,n,a,r),degreeOfMembership:n}},Mb={kMeans:function(t){var e,n=this.cy(),i=this.nodes(),o=null,r=Cb(t),s=new Array(r.k),a={};e=r.testMode?"number"==typeof r.testCentroids?Sb(i,r.k,r.attributes):"object"===S_(r.testCentroids)?r.testCentroids:Sb(i,r.k,r.attributes):Sb(i,r.k,r.attributes);for(var l,c,d,u=!0,h=0;u&&h<r.maxIterations;){for(var p=0;p<i.length;p++)a[(o=i[p]).id()]=Ib(o,e,r.distance,r.attributes,"kMeans");u=!1;for(var g=0;g<r.k;g++){var f=Ob(g,i,a);if(0!==f.length){for(var m=r.attributes.length,_=e[g],v=new Array(m),y=new Array(m),b=0;b<m;b++){y[b]=0;for(var E=0;E<f.length;E++)o=f[E],y[b]+=r.attributes[b](o);v[b]=y[b]/f.length,l=v[b],c=_[b],d=r.sensitivityThreshold,Math.abs(c-l)<=d||(u=!0)}e[g]=v,s[g]=n.collection(f)}}h++}return s},kMedoids:function(t){var e,n,i=this.cy(),o=this.nodes(),r=null,s=Cb(t),a=new Array(s.k),l={},c=new Array(s.k);s.testMode?"number"==typeof s.testCentroids||(e="object"===S_(s.testCentroids)?s.testCentroids:Ab(o,s.k)):e=Ab(o,s.k);for(var d=!0,u=0;d&&u<s.maxIterations;){for(var h=0;h<o.length;h++)l[(r=o[h]).id()]=Ib(r,e,s.distance,s.attributes,"kMedoids");d=!1;for(var p=0;p<e.length;p++){var g=Ob(p,o,l);if(0!==g.length){c[p]=Db(e[p],g,s.attributes);for(var f=0;f<g.length;f++)(n=Db(g[f],g,s.attributes))<c[p]&&(c[p]=n,e[p]=g[f],d=!0);a[p]=i.collection(g)}}u++}return a},fuzzyCMeans:Pb,fcm:Pb},Bb=Hv({distance:"euclidean",linkage:"min",mode:"threshold",threshold:1/0,addDendrogram:!1,dendrogramDepth:0,attributes:[]}),Fb={single:"min",complete:"max"},Hb=function(t,e,n,i,o){for(var r,s=0,a=1/0,l=o.attributes,c=function(t,e){return Tb(o.distance,l.length,(function(e){return l[e](t)}),(function(t){return l[t](e)}),t,e)},d=0;d<t.length;d++){var u=t[d].key,h=n[u][i[u]];h<a&&(s=u,a=h)}if("threshold"===o.mode&&a>=o.threshold||"dendrogram"===o.mode&&1===t.length)return!1;var p,g=e[s],f=e[i[s]];p="dendrogram"===o.mode?{left:g,right:f,key:g.key}:{value:g.value.concat(f.value),key:g.key},t[g.index]=p,t.splice(f.index,1),e[g.key]=p;for(var m=0;m<t.length;m++){var _=t[m];g.key===_.key?r=1/0:"min"===o.linkage?(r=n[g.key][_.key],n[g.key][_.key]>n[f.key][_.key]&&(r=n[f.key][_.key])):"max"===o.linkage?(r=n[g.key][_.key],n[g.key][_.key]<n[f.key][_.key]&&(r=n[f.key][_.key])):r="mean"===o.linkage?(n[g.key][_.key]*g.size+n[f.key][_.key]*f.size)/(g.size+f.size):"dendrogram"===o.mode?c(_.value,g.value):c(_.value[0],g.value[0]),n[g.key][_.key]=n[_.key][g.key]=r}for(var v=0;v<t.length;v++){var y=t[v].key;if(i[y]===g.key||i[y]===f.key){for(var b=y,E=0;E<t.length;E++){var T=t[E].key;n[y][T]<n[y][b]&&(b=T)}i[y]=b}t[v].index=v}return g.key=f.key=g.index=f.index=null,!0},Ub=function t(e,n,i){e&&(e.value?n.push(e.value):(e.left&&t(e.left,n),e.right&&t(e.right,n)))},Vb=function t(e,n){if(!e)return"";if(e.left&&e.right){var i=t(e.left,n),o=t(e.right,n),r=n.add({group:"nodes",data:{id:i+","+o}});return n.add({group:"edges",data:{source:i,target:r.id()}}),n.add({group:"edges",data:{source:o,target:r.id()}}),r.id()}return e.value?e.value.id():void 0},Gb=function t(e,n,i){if(!e)return[];var o=[],r=[],s=[];return 0===n?(e.left&&Ub(e.left,o),e.right&&Ub(e.right,r),s=o.concat(r),[i.collection(s)]):1===n?e.value?[i.collection(e.value)]:(e.left&&Ub(e.left,o),e.right&&Ub(e.right,r),[i.collection(o),i.collection(r)]):e.value?[i.collection(e.value)]:(e.left&&(o=t(e.left,n-1,i)),e.right&&(r=t(e.right,n-1,i)),o.concat(r))},Wb=function(t){for(var e=this.cy(),n=this.nodes(),i=function(t){var e=Bb(t),n=Fb[e.linkage];return null!=n&&(e.linkage=n),e}(t),o=i.attributes,r=function(t,e){return Tb(i.distance,o.length,(function(e){return o[e](t)}),(function(t){return o[t](e)}),t,e)},s=[],a=[],l=[],c=[],d=0;d<n.length;d++){var u={value:"dendrogram"===i.mode?n[d]:[n[d]],key:d,index:d};s[d]=u,c[d]=u,a[d]=[],l[d]=0}for(var h=0;h<s.length;h++)for(var p=0;p<=h;p++){var g=void 0;g="dendrogram"===i.mode?h===p?1/0:r(s[h].value,s[p].value):h===p?1/0:r(s[h].value[0],s[p].value[0]),a[h][p]=g,a[p][h]=g,g<a[h][l[h]]&&(l[h]=p)}for(var f,m=Hb(s,c,a,l,i);m;)m=Hb(s,c,a,l,i);return"dendrogram"===i.mode?(f=Gb(s[0],i.dendrogramDepth,e),i.addDendrogram&&Vb(s[0],e)):(f=new Array(s.length),s.forEach((function(t,n){t.key=t.index=null,f[n]=e.collection(t.value)}))),f},zb={hierarchicalClustering:Wb,hca:Wb},Xb=Hv({distance:"euclidean",preference:"median",damping:.8,maxIterations:1e3,minIterations:100,attributes:[]}),jb=function(t,e,n,i){var o=function(t,e){return i[e](t)};return-Tb(t,i.length,(function(t){return o(e,t)}),(function(t){return o(n,t)}),e,n)},Yb=function(t,e){return"median"===e?function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.length,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];arguments.length>3&&void 0!==arguments[3]&&!arguments[3]?(n<t.length&&t.splice(n,t.length-n),e>0&&t.splice(0,e)):t=t.slice(e,n);for(var r=0,s=t.length-1;s>=0;s--){var a=t[s];o?isFinite(a)||(t[s]=-1/0,r++):t.splice(s,1)}i&&t.sort((function(t,e){return t-e}));var l=t.length,c=Math.floor(l/2);return l%2!=0?t[c+1+r]:(t[c-1+r]+t[c+r])/2}(t):"mean"===e?function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.length,i=0,o=0,r=e;r<n;r++){var s=t[r];isFinite(s)&&(i+=s,o++)}return i/o}(t):"min"===e?function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.length,i=1/0,o=e;o<n;o++){var r=t[o];isFinite(r)&&(i=Math.min(r,i))}return i}(t):"max"===e?function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.length,i=-1/0,o=e;o<n;o++){var r=t[o];isFinite(r)&&(i=Math.max(r,i))}return i}(t):e},Kb=function(t,e,n){for(var i=[],o=0;o<t;o++){for(var r=-1,s=-1/0,a=0;a<n.length;a++){var l=n[a];e[o*t+l]>s&&(r=l,s=e[o*t+l])}r>0&&i.push(r)}for(var c=0;c<n.length;c++)i[n[c]]=n[c];return i},$b=function(t){for(var e,n,i,o,r,s,a=this.cy(),l=this.nodes(),c=function(t){var e=t.damping,n=t.preference;.5<=e&&e<1||Dv("Damping must range on [0.5, 1).  Got: ".concat(e));var i=["median","mean","min","max"];return i.some((function(t){return t===n}))||W_(n)||Dv("Preference must be one of [".concat(i.map((function(t){return"'".concat(t,"'")})).join(", "),"] or a number.  Got: ").concat(n)),Xb(t)}(t),d={},u=0;u<l.length;u++)d[l[u].id()]=u;n=(e=l.length)*e,i=new Array(n);for(var h=0;h<n;h++)i[h]=-1/0;for(var p=0;p<e;p++)for(var g=0;g<e;g++)p!==g&&(i[p*e+g]=jb(c.distance,l[p],l[g],c.attributes));o=Yb(i,c.preference);for(var f=0;f<e;f++)i[f*e+f]=o;r=new Array(n);for(var m=0;m<n;m++)r[m]=0;s=new Array(n);for(var _=0;_<n;_++)s[_]=0;for(var v=new Array(e),y=new Array(e),b=new Array(e),E=0;E<e;E++)v[E]=0,y[E]=0,b[E]=0;for(var T,R=new Array(e*c.minIterations),C=0;C<R.length;C++)R[C]=0;for(T=0;T<c.maxIterations;T++){for(var x=0;x<e;x++){for(var S=-1/0,I=-1/0,O=-1,k=0,w=0;w<e;w++)v[w]=r[x*e+w],(k=s[x*e+w]+i[x*e+w])>=S?(I=S,S=k,O=w):k>I&&(I=k);for(var A=0;A<e;A++)r[x*e+A]=(1-c.damping)*(i[x*e+A]-S)+c.damping*v[A];r[x*e+O]=(1-c.damping)*(i[x*e+O]-I)+c.damping*v[O]}for(var D=0;D<e;D++){for(var N=0,L=0;L<e;L++)v[L]=s[L*e+D],y[L]=Math.max(0,r[L*e+D]),N+=y[L];N-=y[D],y[D]=r[D*e+D],N+=y[D];for(var P=0;P<e;P++)s[P*e+D]=(1-c.damping)*Math.min(0,N-y[P])+c.damping*v[P];s[D*e+D]=(1-c.damping)*(N-y[D])+c.damping*v[D]}for(var M=0,B=0;B<e;B++){var F=s[B*e+B]+r[B*e+B]>0?1:0;R[T%c.minIterations*e+B]=F,M+=F}if(M>0&&(T>=c.minIterations-1||T==c.maxIterations-1)){for(var H=0,U=0;U<e;U++){b[U]=0;for(var V=0;V<c.minIterations;V++)b[U]+=R[V*e+U];0!==b[U]&&b[U]!==c.minIterations||H++}if(H===e)break}}for(var G=function(t,e,n){for(var i=[],o=0;o<t;o++)e[o*t+o]+n[o*t+o]>0&&i.push(o);return i}(e,r,s),W=function(t,e,n){for(var i=Kb(t,e,n),o=0;o<n.length;o++){for(var r=[],s=0;s<i.length;s++)i[s]===n[o]&&r.push(s);for(var a=-1,l=-1/0,c=0;c<r.length;c++){for(var d=0,u=0;u<r.length;u++)d+=e[r[u]*t+r[c]];d>l&&(a=c,l=d)}n[o]=r[a]}return Kb(t,e,n)}(e,i,G),z={},X=0;X<G.length;X++)z[G[X]]=[];for(var j=0;j<l.length;j++){var Y=W[d[l[j].id()]];null!=Y&&z[Y].push(l[j])}for(var K=new Array(G.length),$=0;$<G.length;$++)K[$]=a.collection(z[G[$]]);return K},Jb={affinityPropagation:$b,ap:$b},qb=Hv({root:void 0,directed:!1}),Zb=function(){var t=this,e={},n=0,i=0,o=[],r=[],s={},a=function a(l,c,d){l===d&&(i+=1),e[c]={id:n,low:n++,cutVertex:!1};var u,h,p,g,f=t.getElementById(c).connectedEdges().intersection(t);0===f.size()?o.push(t.spawn(t.getElementById(c))):f.forEach((function(n){u=n.source().id(),h=n.target().id(),(p=u===c?h:u)!==d&&(g=n.id(),s[g]||(s[g]=!0,r.push({x:c,y:p,edge:n})),p in e?e[c].low=Math.min(e[c].low,e[p].id):(a(l,p,c),e[c].low=Math.min(e[c].low,e[p].low),e[c].id<=e[p].low&&(e[c].cutVertex=!0,function(n,i){for(var s=r.length-1,a=[],l=t.spawn();r[s].x!=n||r[s].y!=i;)a.push(r.pop().edge),s--;a.push(r.pop().edge),a.forEach((function(n){var i=n.connectedNodes().intersection(t);l.merge(n),i.forEach((function(n){var i=n.id(),o=n.connectedEdges().intersection(t);l.merge(n),e[i].cutVertex?l.merge(o.filter((function(t){return t.isLoop()}))):l.merge(o)}))})),o.push(l)}(c,p))))}))};t.forEach((function(t){if(t.isNode()){var n=t.id();n in e||(i=0,a(n,n),e[n].cutVertex=i>1)}}));var l=Object.keys(e).filter((function(t){return e[t].cutVertex})).map((function(e){return t.getElementById(e)}));return{cut:t.spawn(l),components:o}},Qb=function(){var t=this,e={},n=0,i=[],o=[],r=t.spawn(t),s=function s(a){if(o.push(a),e[a]={index:n,low:n++,explored:!1},t.getElementById(a).connectedEdges().intersection(t).forEach((function(t){var n=t.target().id();n!==a&&(n in e||s(n),e[n].explored||(e[a].low=Math.min(e[a].low,e[n].low)))})),e[a].index===e[a].low){for(var l=t.spawn();;){var c=o.pop();if(l.merge(t.getElementById(c)),e[c].low=e[a].index,e[c].explored=!0,c===a)break}var d=l.edgesWith(l),u=l.merge(d);i.push(u),r=r.difference(u)}};return t.forEach((function(t){if(t.isNode()){var n=t.id();n in e||s(n)}})),{cut:r,components:i}},tE={};[$v,qv,Zv,ty,ny,oy,ly,qy,Qy,eb,ib,pb,Mb,zb,Jb,{hierholzer:function(t){if(!G_(t)){var e=arguments;t={root:e[0],directed:e[1]}}var n,i,o,r=qb(t),s=r.root,a=r.directed,l=this,c=!1;s&&(o=H_(s)?this.filter(s)[0].id():s[0].id());var d={},u={};a?l.forEach((function(t){var e=t.id();if(t.isNode()){var o=t.indegree(!0),r=t.outdegree(!0),s=o-r,a=r-o;1==s?n?c=!0:n=e:1==a?i?c=!0:i=e:(a>1||s>1)&&(c=!0),d[e]=[],t.outgoers().forEach((function(t){t.isEdge()&&d[e].push(t.id())}))}else u[e]=[void 0,t.target().id()]})):l.forEach((function(t){var e=t.id();t.isNode()?(t.degree(!0)%2&&(n?i?c=!0:i=e:n=e),d[e]=[],t.connectedEdges().forEach((function(t){return d[e].push(t.id())}))):u[e]=[t.source().id(),t.target().id()]}));var h={found:!1,trail:void 0};if(c)return h;if(i&&n)if(a){if(o&&i!=o)return h;o=i}else{if(o&&i!=o&&n!=o)return h;o||(o=i)}else o||(o=l[0].id());var p=function(t){for(var e,n,i,o=t,r=[t];d[o].length;)e=d[o].shift(),n=u[e][0],o!=(i=u[e][1])?(d[i]=d[i].filter((function(t){return t!=e})),o=i):a||o==n||(d[n]=d[n].filter((function(t){return t!=e})),o=n),r.unshift(e),r.unshift(o);return r},g=[],f=[];for(f=p(o);1!=f.length;)0==d[f[0]].length?(g.unshift(l.getElementById(f.shift())),g.unshift(l.getElementById(f.shift()))):f=p(f.shift()).concat(f);for(var m in g.unshift(l.getElementById(f.shift())),d)if(d[m].length)return h;return h.found=!0,h.trail=this.spawn(g,!0),h}},{hopcroftTarjanBiconnected:Zb,htbc:Zb,htb:Zb,hopcroftTarjanBiconnectedComponents:Zb},{tarjanStronglyConnected:Qb,tsc:Qb,tscc:Qb,tarjanStronglyConnectedComponents:Qb}].forEach((function(t){rv(tE,t)}));var eE=function t(e){if(!(this instanceof t))return new t(e);this.id="Thenable/1.0.7",this.state=0,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},"function"==typeof e&&e.call(this,this.fulfill.bind(this),this.reject.bind(this))};eE.prototype={fulfill:function(t){return nE(this,1,"fulfillValue",t)},reject:function(t){return nE(this,2,"rejectReason",t)},then:function(t,e){var n=this,i=new eE;return n.onFulfilled.push(rE(t,i,"fulfill")),n.onRejected.push(rE(e,i,"reject")),iE(n),i.proxy}};var nE=function(t,e,n,i){return 0===t.state&&(t.state=e,t[n]=i,iE(t)),t},iE=function(t){1===t.state?oE(t,"onFulfilled",t.fulfillValue):2===t.state&&oE(t,"onRejected",t.rejectReason)},oE=function(t,e,n){if(0!==t[e].length){var i=t[e];t[e]=[];var o=function(){for(var t=0;t<i.length;t++)i[t](n)};"function"==typeof setImmediate?setImmediate(o):setTimeout(o,0)}},rE=function(t,e,n){return function(i){if("function"!=typeof t)e[n].call(e,i);else{var o;try{o=t(i)}catch(t){return void e.reject(t)}sE(e,o)}}},sE=function t(e,n){if(e!==n&&e.proxy!==n){var i;if("object"===S_(n)&&null!==n||"function"==typeof n)try{i=n.then}catch(t){return void e.reject(t)}if("function"!=typeof i)e.fulfill(n);else{var o=!1;try{i.call(n,(function(i){o||(o=!0,i===n?e.reject(new TypeError("circular thenable chain")):t(e,i))}),(function(t){o||(o=!0,e.reject(t))}))}catch(t){o||e.reject(t)}}}else e.reject(new TypeError("cannot resolve promise with itself"))};eE.all=function(t){return new eE((function(e,n){for(var i=new Array(t.length),o=0,r=function(n,r){i[n]=r,++o===t.length&&e(i)},s=0;s<t.length;s++)!function(e){var i=t[e];null!=i&&null!=i.then?i.then((function(t){r(e,t)}),(function(t){n(t)})):r(e,i)}(s)}))},eE.resolve=function(t){return new eE((function(e,n){e(t)}))},eE.reject=function(t){return new eE((function(e,n){n(t)}))};var aE="undefined"!=typeof Promise?Promise:eE,lE=function(t,e,n){var i=K_(t),o=!i,r=this._private=rv({duration:1e3},e,n);if(r.target=t,r.style=r.style||r.css,r.started=!1,r.playing=!1,r.hooked=!1,r.applying=!1,r.progress=0,r.completes=[],r.frames=[],r.complete&&U_(r.complete)&&r.completes.push(r.complete),o){var s=t.position();r.startPosition=r.startPosition||{x:s.x,y:s.y},r.startStyle=r.startStyle||t.cy().style().getAnimationStartStyle(t,r.style)}if(i){var a=t.pan();r.startPan={x:a.x,y:a.y},r.startZoom=t.zoom()}this.length=1,this[0]=this},cE=lE.prototype;rv(cE,{instanceString:function(){return"animation"},hook:function(){var t=this._private;if(!t.hooked){var e=t.target._private.animation;(t.queue?e.queue:e.current).push(this),X_(t.target)&&t.target.cy().addToAnimationPool(t.target),t.hooked=!0}return this},play:function(){var t=this._private;return 1===t.progress&&(t.progress=0),t.playing=!0,t.started=!1,t.stopped=!1,this.hook(),this},playing:function(){return this._private.playing},apply:function(){var t=this._private;return t.applying=!0,t.started=!1,t.stopped=!1,this.hook(),this},applying:function(){return this._private.applying},pause:function(){var t=this._private;return t.playing=!1,t.started=!1,this},stop:function(){var t=this._private;return t.playing=!1,t.started=!1,t.stopped=!0,this},rewind:function(){return this.progress(0)},fastforward:function(){return this.progress(1)},time:function(t){var e=this._private;return void 0===t?e.progress*e.duration:this.progress(t/e.duration)},progress:function(t){var e=this._private,n=e.playing;return void 0===t?e.progress:(n&&this.pause(),e.progress=t,e.started=!1,n&&this.play(),this)},completed:function(){return 1===this._private.progress},reverse:function(){var t=this._private,e=t.playing;e&&this.pause(),t.progress=1-t.progress,t.started=!1;var n=function(e,n){var i=t[e];null!=i&&(t[e]=t[n],t[n]=i)};if(n("zoom","startZoom"),n("pan","startPan"),n("position","startPosition"),t.style)for(var i=0;i<t.style.length;i++){var o=t.style[i],r=o.name,s=t.startStyle[r];t.startStyle[r]=o,t.style[i]=s}return e&&this.play(),this},promise:function(t){var e,n=this._private;switch(t){case"frame":e=n.frames;break;default:case"complete":case"completed":e=n.completes}return new aE((function(t,n){e.push((function(){t()}))}))}}),cE.complete=cE.completed,cE.run=cE.play,cE.running=cE.playing;var dE={};[{animated:function(){return function(){var t=this,e=void 0!==t.length?t:[t];if(!(this._private.cy||this).styleEnabled())return!1;var n=e[0];return n?n._private.animation.current.length>0:void 0}},clearQueue:function(){return function(){var t=this,e=void 0!==t.length?t:[t];if(!(this._private.cy||this).styleEnabled())return this;for(var n=0;n<e.length;n++){e[n]._private.animation.queue=[]}return this}},delay:function(){return function(t,e){return(this._private.cy||this).styleEnabled()?this.animate({delay:t,duration:t,complete:e}):this}},delayAnimation:function(){return function(t,e){return(this._private.cy||this).styleEnabled()?this.animation({delay:t,duration:t,complete:e}):this}},animation:function(){return function(t,e){var n=this,i=void 0!==n.length,o=i?n:[n],r=this._private.cy||this,s=!i,a=!s;if(!r.styleEnabled())return this;var l=r.style();if(t=rv({},t,e),0===Object.keys(t).length)return new lE(o[0],t);switch(void 0===t.duration&&(t.duration=400),t.duration){case"slow":t.duration=600;break;case"fast":t.duration=200}if(a&&(t.style=l.getPropsList(t.style||t.css),t.css=void 0),a&&null!=t.renderedPosition){var c=t.renderedPosition,d=r.pan(),u=r.zoom();t.position=dy(c,u,d)}if(s&&null!=t.panBy){var h=t.panBy,p=r.pan();t.pan={x:p.x+h.x,y:p.y+h.y}}var g=t.center||t.centre;if(s&&null!=g){var f=r.getCenterPan(g.eles,t.zoom);null!=f&&(t.pan=f)}if(s&&null!=t.fit){var m=t.fit,_=r.getFitViewport(m.eles||m.boundingBox,m.padding);null!=_&&(t.pan=_.pan,t.zoom=_.zoom)}if(s&&G_(t.zoom)){var v=r.getZoomedViewport(t.zoom);null!=v?(v.zoomed&&(t.zoom=v.zoom),v.panned&&(t.pan=v.pan)):t.zoom=null}return new lE(o[0],t)}},animate:function(){return function(t,e){var n=this,i=void 0!==n.length?n:[n];if(!(this._private.cy||this).styleEnabled())return this;e&&(t=rv({},t,e));for(var o=0;o<i.length;o++){var r=i[o],s=r.animated()&&(void 0===t.queue||t.queue);r.animation(t,s?{queue:!0}:void 0).play()}return this}},stop:function(){return function(t,e){var n=this,i=void 0!==n.length?n:[n],o=this._private.cy||this;if(!o.styleEnabled())return this;for(var r=0;r<i.length;r++){for(var s=i[r]._private,a=s.animation.current,l=0;l<a.length;l++){var c=a[l]._private;e&&(c.duration=0)}t&&(s.animation.queue=[]),e||(s.animation.current=[])}return o.notify("draw"),this}}},{data:function(t){return t=rv({},{field:"data",bindingEvent:"data",allowBinding:!1,allowSetting:!1,allowGetting:!1,settingEvent:"data",settingTriggersEvent:!1,triggerFnName:"trigger",immutableKeys:{},updateStyle:!1,beforeGet:function(t){},beforeSet:function(t,e){},onSet:function(t){},canSet:function(t){return!0}},t),function(e,n){var i=t,o=this,r=void 0!==o.length,s=r?o:[o],a=r?o[0]:o;if(H_(e)){var l;if(i.allowGetting&&void 0===n)return a&&(i.beforeGet(a),l=a._private[i.field][e]),l;if(i.allowSetting&&void 0!==n&&!i.immutableKeys[e]){var c=w_({},e,n);i.beforeSet(o,c);for(var d=0,u=s.length;d<u;d++){var h=s[d];i.canSet(h)&&(h._private[i.field][e]=n)}i.updateStyle&&o.updateStyle(),i.onSet(o),i.settingTriggersEvent&&o[i.triggerFnName](i.settingEvent)}}else if(i.allowSetting&&G_(e)){var p,g,f=e,m=Object.keys(f);i.beforeSet(o,f);for(var _=0;_<m.length;_++){if(g=f[p=m[_]],!i.immutableKeys[p])for(var v=0;v<s.length;v++){var y=s[v];i.canSet(y)&&(y._private[i.field][p]=g)}}i.updateStyle&&o.updateStyle(),i.onSet(o),i.settingTriggersEvent&&o[i.triggerFnName](i.settingEvent)}else if(i.allowBinding&&U_(e)){var b=e;o.on(i.bindingEvent,b)}else if(i.allowGetting&&void 0===e){var E;return a&&(i.beforeGet(a),E=a._private[i.field]),E}return o}},removeData:function(t){return t=rv({},{field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!1,immutableKeys:{}},t),function(e){var n=t,i=this,o=void 0!==i.length?i:[i];if(H_(e)){for(var r=e.split(/\s+/),s=r.length,a=0;a<s;a++){var l=r[a];if(!J_(l))if(!n.immutableKeys[l])for(var c=0,d=o.length;c<d;c++)o[c]._private[n.field][l]=void 0}n.triggerEvent&&i[n.triggerFnName](n.event)}else if(void 0===e){for(var u=0,h=o.length;u<h;u++)for(var p=o[u]._private[n.field],g=Object.keys(p),f=0;f<g.length;f++){var m=g[f];!n.immutableKeys[m]&&(p[m]=void 0)}n.triggerEvent&&i[n.triggerFnName](n.event)}return i}}},{eventAliasesOn:function(t){var e=t;e.addListener=e.listen=e.bind=e.on,e.unlisten=e.unbind=e.off=e.removeListener,e.trigger=e.emit,e.pon=e.promiseOn=function(t,e){var n=this,i=Array.prototype.slice.call(arguments,0);return new aE((function(t,e){var o=i.concat([function(e){n.off.apply(n,r),t(e)}]),r=o.concat([]);n.on.apply(n,o)}))}}}].forEach((function(t){rv(dE,t)}));var uE={animate:dE.animate(),animation:dE.animation(),animated:dE.animated(),clearQueue:dE.clearQueue(),delay:dE.delay(),delayAnimation:dE.delayAnimation(),stop:dE.stop()},hE={classes:function(t){var e=this;if(void 0===t){var n=[];return e[0]._private.classes.forEach((function(t){return n.push(t)})),n}V_(t)||(t=(t||"").match(/\S+/g)||[]);for(var i=[],o=new jv(t),r=0;r<e.length;r++){for(var s=e[r],a=s._private,l=a.classes,c=!1,d=0;d<t.length;d++){var u=t[d];if(!l.has(u)){c=!0;break}}c||(c=l.size!==t.length),c&&(a.classes=o,i.push(s))}return i.length>0&&this.spawn(i).updateStyle().emit("class"),e},addClass:function(t){return this.toggleClass(t,!0)},hasClass:function(t){var e=this[0];return null!=e&&e._private.classes.has(t)},toggleClass:function(t,e){V_(t)||(t=t.match(/\S+/g)||[]);for(var n=this,i=void 0===e,o=[],r=0,s=n.length;r<s;r++)for(var a=n[r],l=a._private.classes,c=!1,d=0;d<t.length;d++){var u=t[d],h=l.has(u),p=!1;e||i&&!h?(l.add(u),p=!0):(!e||i&&h)&&(l.delete(u),p=!0),!c&&p&&(o.push(a),c=!0)}return o.length>0&&this.spawn(o).updateStyle().emit("class"),n},removeClass:function(t){return this.toggleClass(t,!1)},flashClass:function(t,e){var n=this;if(null==e)e=250;else if(0===e)return n;return n.addClass(t),setTimeout((function(){n.removeClass(t)}),e),n}};hE.className=hE.classNames=hE.classes;var pE={metaChar:"[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]",comparatorOp:"=|\\!=|>|>=|<|<=|\\$=|\\^=|\\*=",boolOp:"\\?|\\!|\\^",string:"\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'",number:iv,meta:"degree|indegree|outdegree",separator:"\\s*,\\s*",descendant:"\\s+",child:"\\s+>\\s+",subject:"\\$",group:"node|edge|\\*",directedEdge:"\\s+->\\s+",undirectedEdge:"\\s+<->\\s+"};pE.variable="(?:[\\w-]|(?:\\\\"+pE.metaChar+"))+",pE.value=pE.string+"|"+pE.number,pE.className=pE.variable,pE.id=pE.variable,function(){var t,e,n;for(t=pE.comparatorOp.split("|"),n=0;n<t.length;n++)e=t[n],pE.comparatorOp+="|@"+e;for(t=pE.comparatorOp.split("|"),n=0;n<t.length;n++)(e=t[n]).indexOf("!")>=0||"="!==e&&(pE.comparatorOp+="|\\!"+e)}();var gE=0,fE=1,mE=2,_E=3,vE=4,yE=5,bE=6,EE=7,TE=8,RE=9,CE=10,xE=11,SE=12,IE=13,OE=14,kE=15,wE=16,AE=17,DE=18,NE=19,LE=20,PE=[{selector:":selected",matches:function(t){return t.selected()}},{selector:":unselected",matches:function(t){return!t.selected()}},{selector:":selectable",matches:function(t){return t.selectable()}},{selector:":unselectable",matches:function(t){return!t.selectable()}},{selector:":locked",matches:function(t){return t.locked()}},{selector:":unlocked",matches:function(t){return!t.locked()}},{selector:":visible",matches:function(t){return t.visible()}},{selector:":hidden",matches:function(t){return!t.visible()}},{selector:":transparent",matches:function(t){return t.transparent()}},{selector:":grabbed",matches:function(t){return t.grabbed()}},{selector:":free",matches:function(t){return!t.grabbed()}},{selector:":removed",matches:function(t){return t.removed()}},{selector:":inside",matches:function(t){return!t.removed()}},{selector:":grabbable",matches:function(t){return t.grabbable()}},{selector:":ungrabbable",matches:function(t){return!t.grabbable()}},{selector:":animated",matches:function(t){return t.animated()}},{selector:":unanimated",matches:function(t){return!t.animated()}},{selector:":parent",matches:function(t){return t.isParent()}},{selector:":childless",matches:function(t){return t.isChildless()}},{selector:":child",matches:function(t){return t.isChild()}},{selector:":orphan",matches:function(t){return t.isOrphan()}},{selector:":nonorphan",matches:function(t){return t.isChild()}},{selector:":compound",matches:function(t){return t.isNode()?t.isParent():t.source().isParent()||t.target().isParent()}},{selector:":loop",matches:function(t){return t.isLoop()}},{selector:":simple",matches:function(t){return t.isSimple()}},{selector:":active",matches:function(t){return t.active()}},{selector:":inactive",matches:function(t){return!t.active()}},{selector:":backgrounding",matches:function(t){return t.backgrounding()}},{selector:":nonbackgrounding",matches:function(t){return!t.backgrounding()}}].sort((function(t,e){return function(t,e){return-1*ov(t,e)}(t.selector,e.selector)})),ME=function(){for(var t,e={},n=0;n<PE.length;n++)e[(t=PE[n]).selector]=t.matches;return e}(),BE="("+PE.map((function(t){return t.selector})).join("|")+")",FE=function(t){return t.replace(new RegExp("\\\\("+pE.metaChar+")","g"),(function(t,e){return e}))},HE=function(t,e,n){t[t.length-1]=n},UE=[{name:"group",query:!0,regex:"("+pE.group+")",populate:function(t,e,n){var i=A_(n,1)[0];e.checks.push({type:gE,value:"*"===i?i:i+"s"})}},{name:"state",query:!0,regex:BE,populate:function(t,e,n){var i=A_(n,1)[0];e.checks.push({type:EE,value:i})}},{name:"id",query:!0,regex:"\\#("+pE.id+")",populate:function(t,e,n){var i=A_(n,1)[0];e.checks.push({type:TE,value:FE(i)})}},{name:"className",query:!0,regex:"\\.("+pE.className+")",populate:function(t,e,n){var i=A_(n,1)[0];e.checks.push({type:RE,value:FE(i)})}},{name:"dataExists",query:!0,regex:"\\[\\s*("+pE.variable+")\\s*\\]",populate:function(t,e,n){var i=A_(n,1)[0];e.checks.push({type:vE,field:FE(i)})}},{name:"dataCompare",query:!0,regex:"\\[\\s*("+pE.variable+")\\s*("+pE.comparatorOp+")\\s*("+pE.value+")\\s*\\]",populate:function(t,e,n){var i=A_(n,3),o=i[0],r=i[1],s=i[2];s=null!=new RegExp("^"+pE.string+"$").exec(s)?s.substring(1,s.length-1):parseFloat(s),e.checks.push({type:_E,field:FE(o),operator:r,value:s})}},{name:"dataBool",query:!0,regex:"\\[\\s*("+pE.boolOp+")\\s*("+pE.variable+")\\s*\\]",populate:function(t,e,n){var i=A_(n,2),o=i[0],r=i[1];e.checks.push({type:yE,field:FE(r),operator:o})}},{name:"metaCompare",query:!0,regex:"\\[\\[\\s*("+pE.meta+")\\s*("+pE.comparatorOp+")\\s*("+pE.number+")\\s*\\]\\]",populate:function(t,e,n){var i=A_(n,3),o=i[0],r=i[1],s=i[2];e.checks.push({type:bE,field:FE(o),operator:r,value:parseFloat(s)})}},{name:"nextQuery",separator:!0,regex:pE.separator,populate:function(t,e){var n=t.currentSubject,i=t.edgeCount,o=t.compoundCount,r=t[t.length-1];return null!=n&&(r.subject=n,t.currentSubject=null),r.edgeCount=i,r.compoundCount=o,t.edgeCount=0,t.compoundCount=0,t[t.length++]={checks:[]}}},{name:"directedEdge",separator:!0,regex:pE.directedEdge,populate:function(t,e){if(null==t.currentSubject){var n={checks:[]},i=e,o={checks:[]};return n.checks.push({type:xE,source:i,target:o}),HE(t,0,n),t.edgeCount++,o}var r={checks:[]},s=e,a={checks:[]};return r.checks.push({type:SE,source:s,target:a}),HE(t,0,r),t.edgeCount++,a}},{name:"undirectedEdge",separator:!0,regex:pE.undirectedEdge,populate:function(t,e){if(null==t.currentSubject){var n={checks:[]},i=e,o={checks:[]};return n.checks.push({type:CE,nodes:[i,o]}),HE(t,0,n),t.edgeCount++,o}var r={checks:[]},s=e,a={checks:[]};return r.checks.push({type:OE,node:s,neighbor:a}),HE(t,0,r),a}},{name:"child",separator:!0,regex:pE.child,populate:function(t,e){if(null==t.currentSubject){var n={checks:[]},i={checks:[]},o=t[t.length-1];return n.checks.push({type:kE,parent:o,child:i}),HE(t,0,n),t.compoundCount++,i}if(t.currentSubject===e){var r={checks:[]},s=t[t.length-1],a={checks:[]},l={checks:[]},c={checks:[]},d={checks:[]};return r.checks.push({type:NE,left:s,right:a,subject:l}),l.checks=e.checks,e.checks=[{type:LE}],d.checks.push({type:LE}),a.checks.push({type:AE,parent:d,child:c}),HE(t,0,r),t.currentSubject=l,t.compoundCount++,c}var u={checks:[]},h={checks:[]},p=[{type:AE,parent:u,child:h}];return u.checks=e.checks,e.checks=p,t.compoundCount++,h}},{name:"descendant",separator:!0,regex:pE.descendant,populate:function(t,e){if(null==t.currentSubject){var n={checks:[]},i={checks:[]},o=t[t.length-1];return n.checks.push({type:wE,ancestor:o,descendant:i}),HE(t,0,n),t.compoundCount++,i}if(t.currentSubject===e){var r={checks:[]},s=t[t.length-1],a={checks:[]},l={checks:[]},c={checks:[]},d={checks:[]};return r.checks.push({type:NE,left:s,right:a,subject:l}),l.checks=e.checks,e.checks=[{type:LE}],d.checks.push({type:LE}),a.checks.push({type:DE,ancestor:d,descendant:c}),HE(t,0,r),t.currentSubject=l,t.compoundCount++,c}var u={checks:[]},h={checks:[]},p=[{type:DE,ancestor:u,descendant:h}];return u.checks=e.checks,e.checks=p,t.compoundCount++,h}},{name:"subject",modifier:!0,regex:pE.subject,populate:function(t,e){if(null!=t.currentSubject&&t.currentSubject!==e)return Lv("Redefinition of subject in selector `"+t.toString()+"`"),!1;t.currentSubject=e;var n=t[t.length-1].checks[0],i=null==n?null:n.type;i===xE?n.type=IE:i===CE&&(n.type=OE,n.node=n.nodes[1],n.neighbor=n.nodes[0],n.nodes=null)}}];UE.forEach((function(t){return t.regexObj=new RegExp("^"+t.regex)}));var VE=function(t){for(var e,n,i,o=0;o<UE.length;o++){var r=UE[o],s=r.name,a=t.match(r.regexObj);if(null!=a){n=a,e=r,i=s;var l=a[0];t=t.substring(l.length);break}}return{expr:e,match:n,name:i,remaining:t}},GE={parse:function(t){var e=this,n=e.inputText=t,i=e[0]={checks:[]};for(e.length=1,n=function(t){var e=t.match(/^\s+/);if(e){var n=e[0];t=t.substring(n.length)}return t}(n);;){var o=VE(n);if(null==o.expr)return Lv("The selector `"+t+"`is invalid"),!1;var r=o.match.slice(1),s=o.expr.populate(e,i,r);if(!1===s)return!1;if(null!=s&&(i=s),(n=o.remaining).match(/^\s*$/))break}var a=e[e.length-1];null!=e.currentSubject&&(a.subject=e.currentSubject),a.edgeCount=e.edgeCount,a.compoundCount=e.compoundCount;for(var l=0;l<e.length;l++){var c=e[l];if(c.compoundCount>0&&c.edgeCount>0)return Lv("The selector `"+t+"` is invalid because it uses both a compound selector and an edge selector"),!1;if(c.edgeCount>1)return Lv("The selector `"+t+"` is invalid because it uses multiple edge selectors"),!1;1===c.edgeCount&&Lv("The selector `"+t+"` is deprecated.  Edge selectors do not take effect on changes to source and target nodes after an edge is added, for performance reasons.  Use a class or data selector on edges instead, updating the class or data of an edge when your app detects a change in source or target nodes.")}return!0},toString:function(){if(null!=this.toStringCache)return this.toStringCache;for(var t=function(t){return null==t?"":t},e=function(e){return H_(e)?'"'+e+'"':t(e)},n=function(t){return" "+t+" "},i=function(i,r){var s=i.type,a=i.value;switch(s){case gE:var l=t(a);return l.substring(0,l.length-1);case _E:var c=i.field,d=i.operator;return"["+c+n(t(d))+e(a)+"]";case yE:var u=i.operator,h=i.field;return"["+t(u)+h+"]";case vE:return"["+i.field+"]";case bE:var p=i.operator;return"[["+i.field+n(t(p))+e(a)+"]]";case EE:return a;case TE:return"#"+a;case RE:return"."+a;case AE:case kE:return o(i.parent,r)+n(">")+o(i.child,r);case DE:case wE:return o(i.ancestor,r)+" "+o(i.descendant,r);case NE:var g=o(i.left,r),f=o(i.subject,r),m=o(i.right,r);return g+(g.length>0?" ":"")+f+m;case LE:return""}},o=function(t,e){return t.checks.reduce((function(n,o,r){return n+(e===t&&0===r?"$":"")+i(o,e)}),"")},r="",s=0;s<this.length;s++){var a=this[s];r+=o(a,a.subject),this.length>1&&s<this.length-1&&(r+=", ")}return this.toStringCache=r,r}},WE=function(t,e,n){var i,o,r,s=H_(t),a=W_(t),l=H_(n),c=!1,d=!1,u=!1;switch(e.indexOf("!")>=0&&(e=e.replace("!",""),d=!0),e.indexOf("@")>=0&&(e=e.replace("@",""),c=!0),(s||l||c)&&(o=s||a?""+t:"",r=""+n),c&&(t=o=o.toLowerCase(),n=r=r.toLowerCase()),e){case"*=":i=o.indexOf(r)>=0;break;case"$=":i=o.indexOf(r,o.length-r.length)>=0;break;case"^=":i=0===o.indexOf(r);break;case"=":i=t===n;break;case">":u=!0,i=t>n;break;case">=":u=!0,i=t>=n;break;case"<":u=!0,i=t<n;break;case"<=":u=!0,i=t<=n;break;default:i=!1}return!d||null==t&&u||(i=!i),i},zE=function(t,e){return t.data(e)},XE=[],jE=function(t,e){return t.checks.every((function(t){return XE[t.type](t,e)}))};XE[gE]=function(t,e){var n=t.value;return"*"===n||n===e.group()},XE[EE]=function(t,e){return function(t,e){return ME[t](e)}(t.value,e)},XE[TE]=function(t,e){var n=t.value;return e.id()===n},XE[RE]=function(t,e){var n=t.value;return e.hasClass(n)},XE[bE]=function(t,e){var n=t.field,i=t.operator,o=t.value;return WE(function(t,e){return t[e]()}(e,n),i,o)},XE[_E]=function(t,e){var n=t.field,i=t.operator,o=t.value;return WE(zE(e,n),i,o)},XE[yE]=function(t,e){var n=t.field,i=t.operator;return function(t,e){switch(e){case"?":return!!t;case"!":return!t;case"^":return void 0===t}}(zE(e,n),i)},XE[vE]=function(t,e){var n=t.field;return t.operator,void 0!==zE(e,n)},XE[CE]=function(t,e){var n=t.nodes[0],i=t.nodes[1],o=e.source(),r=e.target();return jE(n,o)&&jE(i,r)||jE(i,o)&&jE(n,r)},XE[OE]=function(t,e){return jE(t.node,e)&&e.neighborhood().some((function(e){return e.isNode()&&jE(t.neighbor,e)}))},XE[xE]=function(t,e){return jE(t.source,e.source())&&jE(t.target,e.target())},XE[SE]=function(t,e){return jE(t.source,e)&&e.outgoers().some((function(e){return e.isNode()&&jE(t.target,e)}))},XE[IE]=function(t,e){return jE(t.target,e)&&e.incomers().some((function(e){return e.isNode()&&jE(t.source,e)}))},XE[kE]=function(t,e){return jE(t.child,e)&&jE(t.parent,e.parent())},XE[AE]=function(t,e){return jE(t.parent,e)&&e.children().some((function(e){return jE(t.child,e)}))},XE[wE]=function(t,e){return jE(t.descendant,e)&&e.ancestors().some((function(e){return jE(t.ancestor,e)}))},XE[DE]=function(t,e){return jE(t.ancestor,e)&&e.descendants().some((function(e){return jE(t.descendant,e)}))},XE[NE]=function(t,e){return jE(t.subject,e)&&jE(t.left,e)&&jE(t.right,e)},XE[LE]=function(){return!0},XE[fE]=function(t,e){return t.value.has(e)},XE[mE]=function(t,e){return(0,t.value)(e)};var YE=function(t){this.inputText=t,this.currentSubject=null,this.compoundCount=0,this.edgeCount=0,this.length=0,null==t||H_(t)&&t.match(/^\s*$/)||(X_(t)?this.addQuery({checks:[{type:fE,value:t.collection()}]}):U_(t)?this.addQuery({checks:[{type:mE,value:t}]}):H_(t)?this.parse(t)||(this.invalid=!0):Dv("A selector must be created from a string; found "))},KE=YE.prototype;[GE,{matches:function(t){for(var e=0;e<this.length;e++){var n=this[e];if(jE(n,t))return!0}return!1},filter:function(t){var e=this;if(1===e.length&&1===e[0].checks.length&&e[0].checks[0].type===TE)return t.getElementById(e[0].checks[0].value).collection();var n=function(t){for(var n=0;n<e.length;n++){var i=e[n];if(jE(i,t))return!0}return!1};return null==e.text()&&(n=function(){return!0}),t.filter(n)}}].forEach((function(t){return rv(KE,t)})),KE.text=function(){return this.inputText},KE.size=function(){return this.length},KE.eq=function(t){return this[t]},KE.sameText=function(t){return!this.invalid&&!t.invalid&&this.text()===t.text()},KE.addQuery=function(t){this[this.length++]=t},KE.selector=KE.toString;var $E={allAre:function(t){var e=new YE(t);return this.every((function(t){return e.matches(t)}))},is:function(t){var e=new YE(t);return this.some((function(t){return e.matches(t)}))},some:function(t,e){for(var n=0;n<this.length;n++){if(e?t.apply(e,[this[n],n,this]):t(this[n],n,this))return!0}return!1},every:function(t,e){for(var n=0;n<this.length;n++){if(!(e?t.apply(e,[this[n],n,this]):t(this[n],n,this)))return!1}return!0},same:function(t){if(this===t)return!0;t=this.cy().collection(t);var e=this.length;return e===t.length&&(1===e?this[0]===t[0]:this.every((function(e){return t.hasElementWithId(e.id())})))},anySame:function(t){return t=this.cy().collection(t),this.some((function(e){return t.hasElementWithId(e.id())}))},allAreNeighbors:function(t){t=this.cy().collection(t);var e=this.neighborhood();return t.every((function(t){return e.hasElementWithId(t.id())}))},contains:function(t){t=this.cy().collection(t);var e=this;return t.every((function(t){return e.hasElementWithId(t.id())}))}};$E.allAreNeighbours=$E.allAreNeighbors,$E.has=$E.contains,$E.equal=$E.equals=$E.same;var JE,qE,ZE=function(t,e){return function(n,i,o,r){var s,a=n,l=this;if(null==a?s="":X_(a)&&1===a.length&&(s=a.id()),1===l.length&&s){var c=l[0]._private,d=c.traversalCache=c.traversalCache||{},u=d[e]=d[e]||[],h=Ev(s),p=u[h];return p||(u[h]=t.call(l,n,i,o,r))}return t.call(l,n,i,o,r)}},QE={parent:function(t){var e=[];if(1===this.length){var n=this[0]._private.parent;if(n)return n}for(var i=0;i<this.length;i++){var o=this[i]._private.parent;o&&e.push(o)}return this.spawn(e,!0).filter(t)},parents:function(t){for(var e=[],n=this.parent();n.nonempty();){for(var i=0;i<n.length;i++){var o=n[i];e.push(o)}n=n.parent()}return this.spawn(e,!0).filter(t)},commonAncestors:function(t){for(var e,n=0;n<this.length;n++){var i=this[n].parents();e=(e=e||i).intersect(i)}return e.filter(t)},orphans:function(t){return this.stdFilter((function(t){return t.isOrphan()})).filter(t)},nonorphans:function(t){return this.stdFilter((function(t){return t.isChild()})).filter(t)},children:ZE((function(t){for(var e=[],n=0;n<this.length;n++)for(var i=this[n]._private.children,o=0;o<i.length;o++)e.push(i[o]);return this.spawn(e,!0).filter(t)}),"children"),siblings:function(t){return this.parent().children().not(this).filter(t)},isParent:function(){var t=this[0];if(t)return t.isNode()&&0!==t._private.children.length},isChildless:function(){var t=this[0];if(t)return t.isNode()&&0===t._private.children.length},isChild:function(){var t=this[0];if(t)return t.isNode()&&null!=t._private.parent},isOrphan:function(){var t=this[0];if(t)return t.isNode()&&null==t._private.parent},descendants:function(t){var e=[];return function t(n){for(var i=0;i<n.length;i++){var o=n[i];e.push(o),o.children().nonempty()&&t(o.children())}}(this.children()),this.spawn(e,!0).filter(t)}};function tT(t,e,n,i){for(var o=[],r=new jv,s=t.cy().hasCompoundNodes(),a=0;a<t.length;a++){var l=t[a];n?o.push(l):s&&i(o,r,l)}for(;o.length>0;){var c=o.shift();e(c),r.add(c.id()),s&&i(o,r,c)}return t}function eT(t,e,n){if(n.isParent())for(var i=n._private.children,o=0;o<i.length;o++){var r=i[o];e.has(r.id())||t.push(r)}}function nT(t,e,n){if(n.isChild()){var i=n._private.parent;e.has(i.id())||t.push(i)}}function iT(t,e,n){nT(t,e,n),eT(t,e,n)}QE.forEachDown=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return tT(this,t,e,eT)},QE.forEachUp=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return tT(this,t,e,nT)},QE.forEachUpAndDown=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return tT(this,t,e,iT)},QE.ancestors=QE.parents,(JE=qE={data:dE.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),removeData:dE.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),scratch:dE.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:dE.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),rscratch:dE.data({field:"rscratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeRscratch:dE.removeData({field:"rscratch",triggerEvent:!1}),id:function(){var t=this[0];if(t)return t._private.data.id}}).attr=JE.data,JE.removeAttr=JE.removeData;var oT,rT,sT=qE,aT={};function lT(t){return function(e){var n=this;if(void 0===e&&(e=!0),0!==n.length&&n.isNode()&&!n.removed()){for(var i=0,o=n[0],r=o._private.edges,s=0;s<r.length;s++){var a=r[s];!e&&a.isLoop()||(i+=t(o,a))}return i}}}function cT(t,e){return function(n){for(var i,o=this.nodes(),r=0;r<o.length;r++){var s=o[r][t](n);void 0===s||void 0!==i&&!e(s,i)||(i=s)}return i}}rv(aT,{degree:lT((function(t,e){return e.source().same(e.target())?2:1})),indegree:lT((function(t,e){return e.target().same(t)?1:0})),outdegree:lT((function(t,e){return e.source().same(t)?1:0}))}),rv(aT,{minDegree:cT("degree",(function(t,e){return t<e})),maxDegree:cT("degree",(function(t,e){return t>e})),minIndegree:cT("indegree",(function(t,e){return t<e})),maxIndegree:cT("indegree",(function(t,e){return t>e})),minOutdegree:cT("outdegree",(function(t,e){return t<e})),maxOutdegree:cT("outdegree",(function(t,e){return t>e}))}),rv(aT,{totalDegree:function(t){for(var e=0,n=this.nodes(),i=0;i<n.length;i++)e+=n[i].degree(t);return e}});var dT=function(t,e,n){for(var i=0;i<t.length;i++){var o=t[i];if(!o.locked()){var r=o._private.position,s={x:null!=e.x?e.x-r.x:0,y:null!=e.y?e.y-r.y:0};!o.isParent()||0===s.x&&0===s.y||o.children().shift(s,n),o.dirtyBoundingBoxCache()}}},uT={field:"position",bindingEvent:"position",allowBinding:!0,allowSetting:!0,settingEvent:"position",settingTriggersEvent:!0,triggerFnName:"emitAndNotify",allowGetting:!0,validKeys:["x","y"],beforeGet:function(t){t.updateCompoundBounds()},beforeSet:function(t,e){dT(t,e,!1)},onSet:function(t){t.dirtyCompoundBoundsCache()},canSet:function(t){return!t.locked()}};(oT=rT={position:dE.data(uT),silentPosition:dE.data(rv({},uT,{allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!1,beforeSet:function(t,e){dT(t,e,!0)},onSet:function(t){t.dirtyCompoundBoundsCache()}})),positions:function(t,e){if(G_(t))e?this.silentPosition(t):this.position(t);else if(U_(t)){var n=t,i=this.cy();i.startBatch();for(var o=0;o<this.length;o++){var r,s=this[o];(r=n(s,o))&&(e?s.silentPosition(r):s.position(r))}i.endBatch()}return this},silentPositions:function(t){return this.positions(t,!0)},shift:function(t,e,n){var i;if(G_(t)?(i={x:W_(t.x)?t.x:0,y:W_(t.y)?t.y:0},n=e):H_(t)&&W_(e)&&((i={x:0,y:0})[t]=e),null!=i){var o=this.cy();o.startBatch();for(var r=0;r<this.length;r++){var s=this[r],a=s.position(),l={x:a.x+i.x,y:a.y+i.y};n?s.silentPosition(l):s.position(l)}o.endBatch()}return this},silentShift:function(t,e){return G_(t)?this.shift(t,!0):H_(t)&&W_(e)&&this.shift(t,e,!0),this},renderedPosition:function(t,e){var n=this[0],i=this.cy(),o=i.zoom(),r=i.pan(),s=G_(t)?t:void 0,a=void 0!==s||void 0!==e&&H_(t);if(n&&n.isNode()){if(!a){var l=n.position();return s=cy(l,o,r),void 0===t?s:s[t]}for(var c=0;c<this.length;c++){var d=this[c];void 0!==e?d.position(t,(e-r[t])/o):void 0!==s&&d.position(dy(s,o,r))}}else if(!a)return;return this},relativePosition:function(t,e){var n=this[0],i=this.cy(),o=G_(t)?t:void 0,r=void 0!==o||void 0!==e&&H_(t),s=i.hasCompoundNodes();if(n&&n.isNode()){if(!r){var a=n.position(),l=s?n.parent():null,c=l&&l.length>0,d=c;c&&(l=l[0]);var u=d?l.position():{x:0,y:0};return o={x:a.x-u.x,y:a.y-u.y},void 0===t?o:o[t]}for(var h=0;h<this.length;h++){var p=this[h],g=s?p.parent():null,f=g&&g.length>0,m=f;f&&(g=g[0]);var _=m?g.position():{x:0,y:0};void 0!==e?p.position(t,e+_[t]):void 0!==o&&p.position({x:o.x+_.x,y:o.y+_.y})}}else if(!r)return;return this}}).modelPosition=oT.point=oT.position,oT.modelPositions=oT.points=oT.positions,oT.renderedPoint=oT.renderedPosition,oT.relativePoint=oT.relativePosition;var hT,pT,gT=rT;hT=pT={},pT.renderedBoundingBox=function(t){var e=this.boundingBox(t),n=this.cy(),i=n.zoom(),o=n.pan(),r=e.x1*i+o.x,s=e.x2*i+o.x,a=e.y1*i+o.y,l=e.y2*i+o.y;return{x1:r,x2:s,y1:a,y2:l,w:s-r,h:l-a}},pT.dirtyCompoundBoundsCache=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.cy();return e.styleEnabled()&&e.hasCompoundNodes()?(this.forEachUp((function(e){if(e.isParent()){var n=e._private;n.compoundBoundsClean=!1,n.bbCache=null,t||e.emitAndNotify("bounds")}})),this):this},pT.updateCompoundBounds=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.cy();if(!e.styleEnabled()||!e.hasCompoundNodes())return this;if(!t&&e.batching())return this;function n(t){if(t.isParent()){var e=t._private,n=t.children(),i="include"===t.pstyle("compound-sizing-wrt-labels").value,o={width:{val:t.pstyle("min-width").pfValue,left:t.pstyle("min-width-bias-left"),right:t.pstyle("min-width-bias-right")},height:{val:t.pstyle("min-height").pfValue,top:t.pstyle("min-height-bias-top"),bottom:t.pstyle("min-height-bias-bottom")}},r=n.boundingBox({includeLabels:i,includeOverlays:!1,useCache:!1}),s=e.position;0!==r.w&&0!==r.h||((r={w:t.pstyle("width").pfValue,h:t.pstyle("height").pfValue}).x1=s.x-r.w/2,r.x2=s.x+r.w/2,r.y1=s.y-r.h/2,r.y2=s.y+r.h/2);var a=o.width.left.value;"px"===o.width.left.units&&o.width.val>0&&(a=100*a/o.width.val);var l=o.width.right.value;"px"===o.width.right.units&&o.width.val>0&&(l=100*l/o.width.val);var c=o.height.top.value;"px"===o.height.top.units&&o.height.val>0&&(c=100*c/o.height.val);var d=o.height.bottom.value;"px"===o.height.bottom.units&&o.height.val>0&&(d=100*d/o.height.val);var u=_(o.width.val-r.w,a,l),h=u.biasDiff,p=u.biasComplementDiff,g=_(o.height.val-r.h,c,d),f=g.biasDiff,m=g.biasComplementDiff;e.autoPadding=function(t,e,n,i){if("%"!==n.units)return"px"===n.units?n.pfValue:0;switch(i){case"width":return t>0?n.pfValue*t:0;case"height":return e>0?n.pfValue*e:0;case"average":return t>0&&e>0?n.pfValue*(t+e)/2:0;case"min":return t>0&&e>0?t>e?n.pfValue*e:n.pfValue*t:0;case"max":return t>0&&e>0?t>e?n.pfValue*t:n.pfValue*e:0;default:return 0}}(r.w,r.h,t.pstyle("padding"),t.pstyle("padding-relative-to").value),e.autoWidth=Math.max(r.w,o.width.val),s.x=(-h+r.x1+r.x2+p)/2,e.autoHeight=Math.max(r.h,o.height.val),s.y=(-f+r.y1+r.y2+m)/2}function _(t,e,n){var i=0,o=0,r=e+n;return t>0&&r>0&&(i=e/r*t,o=n/r*t),{biasDiff:i,biasComplementDiff:o}}}for(var i=0;i<this.length;i++){var o=this[i],r=o._private;r.compoundBoundsClean&&!t||(n(o),e.batching()||(r.compoundBoundsClean=!0))}return this};var fT=function(t){return t===1/0||t===-1/0?0:t},mT=function(t,e,n,i,o){i-e!=0&&o-n!=0&&null!=e&&null!=n&&null!=i&&null!=o&&(t.x1=e<t.x1?e:t.x1,t.x2=i>t.x2?i:t.x2,t.y1=n<t.y1?n:t.y1,t.y2=o>t.y2?o:t.y2,t.w=t.x2-t.x1,t.h=t.y2-t.y1)},_T=function(t,e){return null==e?t:mT(t,e.x1,e.y1,e.x2,e.y2)},vT=function(t,e,n){return Gv(t,e,n)},yT=function(t,e,n){if(!e.cy().headless()){var i,o,r=e._private,s=r.rstyle,a=s.arrowWidth/2;if("none"!==e.pstyle(n+"-arrow-shape").value){"source"===n?(i=s.srcX,o=s.srcY):"target"===n?(i=s.tgtX,o=s.tgtY):(i=s.midX,o=s.midY);var l=r.arrowBounds=r.arrowBounds||{},c=l[n]=l[n]||{};c.x1=i-a,c.y1=o-a,c.x2=i+a,c.y2=o+a,c.w=c.x2-c.x1,c.h=c.y2-c.y1,Ry(c,1),mT(t,c.x1,c.y1,c.x2,c.y2)}}},bT=function(t,e,n){if(!e.cy().headless()){var i;i=n?n+"-":"";var o=e._private,r=o.rstyle;if(e.pstyle(i+"label").strValue){var s,a,l,c,d=e.pstyle("text-halign"),u=e.pstyle("text-valign"),h=vT(r,"labelWidth",n),p=vT(r,"labelHeight",n),g=vT(r,"labelX",n),f=vT(r,"labelY",n),m=e.pstyle(i+"text-margin-x").pfValue,_=e.pstyle(i+"text-margin-y").pfValue,v=e.isEdge(),y=e.pstyle(i+"text-rotation"),b=e.pstyle("text-outline-width").pfValue,E=e.pstyle("text-border-width").pfValue/2,T=e.pstyle("text-background-padding").pfValue,R=p,C=h,x=C/2,S=R/2;if(v)s=g-x,a=g+x,l=f-S,c=f+S;else{switch(d.value){case"left":s=g-C,a=g;break;case"center":s=g-x,a=g+x;break;case"right":s=g,a=g+C}switch(u.value){case"top":l=f-R,c=f;break;case"center":l=f-S,c=f+S;break;case"bottom":l=f,c=f+R}}s+=m-Math.max(b,E)-T-2,a+=m+Math.max(b,E)+T+2,l+=_-Math.max(b,E)-T-2,c+=_+Math.max(b,E)+T+2;var I=n||"main",O=o.labelBounds,k=O[I]=O[I]||{};k.x1=s,k.y1=l,k.x2=a,k.y2=c,k.w=a-s,k.h=c-l;var w=v&&"autorotate"===y.strValue,A=null!=y.pfValue&&0!==y.pfValue;if(w||A){var D=w?vT(o.rstyle,"labelAngle",n):y.pfValue,N=Math.cos(D),L=Math.sin(D),P=(s+a)/2,M=(l+c)/2;if(!v){switch(d.value){case"left":P=a;break;case"right":P=s}switch(u.value){case"top":M=c;break;case"bottom":M=l}}var B=function(t,e){return{x:(t-=P)*N-(e-=M)*L+P,y:t*L+e*N+M}},F=B(s,l),H=B(s,c),U=B(a,l),V=B(a,c);s=Math.min(F.x,H.x,U.x,V.x),a=Math.max(F.x,H.x,U.x,V.x),l=Math.min(F.y,H.y,U.y,V.y),c=Math.max(F.y,H.y,U.y,V.y)}var G=I+"Rot",W=O[G]=O[G]||{};W.x1=s,W.y1=l,W.x2=a,W.y2=c,W.w=a-s,W.h=c-l,mT(t,s,l,a,c),mT(o.labelBounds.all,s,l,a,c)}return t}},ET=function(t){var e=0,n=function(t){return(t?1:0)<<e++},i=0;return i+=n(t.incudeNodes),i+=n(t.includeEdges),i+=n(t.includeLabels),i+=n(t.includeMainLabels),i+=n(t.includeSourceLabels),i+=n(t.includeTargetLabels),i+=n(t.includeOverlays)},TT=function(t){if(t.isEdge()){var e=t.source().position(),n=t.target().position(),i=function(t){return Math.round(t)};return function(t,e){var n={value:0,done:!1},i=0,o=t.length;return mv({next:function(){return i<o?n.value=t[i++]:n.done=!0,n}},e)}([i(e.x),i(e.y),i(n.x),i(n.y)])}return 0},RT=function(t,e){var n,i=t._private,o=t.isEdge(),r=(null==e?xT:ET(e))===xT,s=TT(t),a=i.bbCachePosKey===s,l=e.useCache&&a,c=function(t){return null==t._private.bbCache||t._private.styleDirty};if(!l||c(t)||o&&c(t.source())||c(t.target())?(a||t.recalculateRenderedStyle(l),n=function(t,e){var n,i,o,r,s,a,l,c=t._private.cy,d=c.styleEnabled(),u=c.headless(),h=Ey(),p=t._private,g=t.isNode(),f=t.isEdge(),m=p.rstyle,_=g&&d?t.pstyle("bounds-expansion").pfValue:[0],v=function(t){return"none"!==t.pstyle("display").value},y=!d||v(t)&&(!f||v(t.source())&&v(t.target()));if(y){var b=0;d&&e.includeOverlays&&0!==t.pstyle("overlay-opacity").value&&(b=t.pstyle("overlay-padding").value);var E=0;if(d&&(E=t.pstyle("width").pfValue/2),g&&e.includeNodes){var T=t.position();s=T.x,a=T.y;var R=t.outerWidth()/2,C=t.outerHeight()/2;mT(h,n=s-R,o=a-C,i=s+R,r=a+C)}else if(f&&e.includeEdges)if(d&&!u){var x=t.pstyle("curve-style").strValue;if(n=Math.min(m.srcX,m.midX,m.tgtX),i=Math.max(m.srcX,m.midX,m.tgtX),o=Math.min(m.srcY,m.midY,m.tgtY),r=Math.max(m.srcY,m.midY,m.tgtY),mT(h,n-=E,o-=E,i+=E,r+=E),"haystack"===x){var S=m.haystackPts;if(S&&2===S.length){if(n=S[0].x,o=S[0].y,n>(i=S[1].x)){var I=n;n=i,i=I}if(o>(r=S[1].y)){var O=o;o=r,r=O}mT(h,n-E,o-E,i+E,r+E)}}else if("bezier"===x||"unbundled-bezier"===x||"segments"===x||"taxi"===x){var k;switch(x){case"bezier":case"unbundled-bezier":k=m.bezierPts;break;case"segments":case"taxi":k=m.linePts}if(null!=k)for(var w=0;w<k.length;w++){var A=k[w];n=A.x-E,i=A.x+E,o=A.y-E,r=A.y+E,mT(h,n,o,i,r)}}}else{var D=t.source().position(),N=t.target().position();if((n=D.x)>(i=N.x)){var L=n;n=i,i=L}if((o=D.y)>(r=N.y)){var P=o;o=r,r=P}mT(h,n-=E,o-=E,i+=E,r+=E)}if(d&&e.includeEdges&&f&&(yT(h,t,"mid-source"),yT(h,t,"mid-target"),yT(h,t,"source"),yT(h,t,"target")),d&&"yes"===t.pstyle("ghost").value){var M=t.pstyle("ghost-offset-x").pfValue,B=t.pstyle("ghost-offset-y").pfValue;mT(h,h.x1+M,h.y1+B,h.x2+M,h.y2+B)}var F=p.bodyBounds=p.bodyBounds||{};xy(F,h),Cy(F,_),Ry(F,1),d&&(n=h.x1,i=h.x2,o=h.y1,r=h.y2,mT(h,n-b,o-b,i+b,r+b));var H=p.overlayBounds=p.overlayBounds||{};xy(H,h),Cy(H,_),Ry(H,1);var U=p.labelBounds=p.labelBounds||{};null!=U.all?((l=U.all).x1=1/0,l.y1=1/0,l.x2=-1/0,l.y2=-1/0,l.w=0,l.h=0):U.all=Ey(),d&&e.includeLabels&&(e.includeMainLabels&&bT(h,t,null),f&&(e.includeSourceLabels&&bT(h,t,"source"),e.includeTargetLabels&&bT(h,t,"target")))}return h.x1=fT(h.x1),h.y1=fT(h.y1),h.x2=fT(h.x2),h.y2=fT(h.y2),h.w=fT(h.x2-h.x1),h.h=fT(h.y2-h.y1),h.w>0&&h.h>0&&y&&(Cy(h,_),Ry(h,1)),h}(t,CT),i.bbCache=n,i.bbCachePosKey=s):n=i.bbCache,!r){var d=t.isNode();n=Ey(),(e.includeNodes&&d||e.includeEdges&&!d)&&(e.includeOverlays?_T(n,i.overlayBounds):_T(n,i.bodyBounds)),e.includeLabels&&(e.includeMainLabels&&(!o||e.includeSourceLabels&&e.includeTargetLabels)?_T(n,i.labelBounds.all):(e.includeMainLabels&&_T(n,i.labelBounds.mainRot),e.includeSourceLabels&&_T(n,i.labelBounds.sourceRot),e.includeTargetLabels&&_T(n,i.labelBounds.targetRot))),n.w=n.x2-n.x1,n.h=n.y2-n.y1}return n},CT={includeNodes:!0,includeEdges:!0,includeLabels:!0,includeMainLabels:!0,includeSourceLabels:!0,includeTargetLabels:!0,includeOverlays:!0,useCache:!0},xT=ET(CT),ST=Hv(CT);pT.boundingBox=function(t){var e;if(1!==this.length||null==this[0]._private.bbCache||this[0]._private.styleDirty||void 0!==t&&void 0!==t.useCache&&!0!==t.useCache){e=Ey();var n=ST(t=t||CT),i=this;if(i.cy().styleEnabled())for(var o=0;o<i.length;o++){var r=i[o],s=r._private,a=TT(r),l=s.bbCachePosKey===a,c=n.useCache&&l&&!s.styleDirty;r.recalculateRenderedStyle(c)}this.updateCompoundBounds(!t.useCache);for(var d=0;d<i.length;d++){var u=i[d];_T(e,RT(u,n))}}else t=void 0===t?CT:ST(t),e=RT(this[0],t);return e.x1=fT(e.x1),e.y1=fT(e.y1),e.x2=fT(e.x2),e.y2=fT(e.y2),e.w=fT(e.x2-e.x1),e.h=fT(e.y2-e.y1),e},pT.dirtyBoundingBoxCache=function(){for(var t=0;t<this.length;t++){var e=this[t]._private;e.bbCache=null,e.bbCachePosKey=null,e.bodyBounds=null,e.overlayBounds=null,e.labelBounds.all=null,e.labelBounds.source=null,e.labelBounds.target=null,e.labelBounds.main=null,e.labelBounds.sourceRot=null,e.labelBounds.targetRot=null,e.labelBounds.mainRot=null,e.arrowBounds.source=null,e.arrowBounds.target=null,e.arrowBounds["mid-source"]=null,e.arrowBounds["mid-target"]=null}return this.emitAndNotify("bounds"),this},pT.boundingBoxAt=function(t){var e=this.nodes(),n=this.cy(),i=n.hasCompoundNodes(),o=n.collection();if(i&&(o=e.filter((function(t){return t.isParent()})),e=e.not(o)),G_(t)){var r=t;t=function(){return r}}n.startBatch(),e.forEach((function(e,n){return e._private.bbAtOldPos=t(e,n)})).silentPositions(t),i&&(o.dirtyCompoundBoundsCache(),o.dirtyBoundingBoxCache(),o.updateCompoundBounds(!0));var s=function(t){return{x1:t.x1,x2:t.x2,w:t.w,y1:t.y1,y2:t.y2,h:t.h}}(this.boundingBox({useCache:!1}));return e.silentPositions((function(t){return t._private.bbAtOldPos})),i&&(o.dirtyCompoundBoundsCache(),o.dirtyBoundingBoxCache(),o.updateCompoundBounds(!0)),n.endBatch(),s},hT.boundingbox=hT.bb=hT.boundingBox,hT.renderedBoundingbox=hT.renderedBoundingBox;var IT,OT,kT=pT;IT=OT={};var wT=function(t){t.uppercaseName=nv(t.name),t.autoName="auto"+t.uppercaseName,t.labelName="label"+t.uppercaseName,t.outerName="outer"+t.uppercaseName,t.uppercaseOuterName=nv(t.outerName),IT[t.name]=function(){var e=this[0],n=e._private,i=n.cy._private.styleEnabled;if(e){if(!i)return 1;if(e.isParent())return e.updateCompoundBounds(),n[t.autoName]||0;var o=e.pstyle(t.name);switch(o.strValue){case"label":return e.recalculateRenderedStyle(),n.rstyle[t.labelName]||0;default:return o.pfValue}}},IT["outer"+t.uppercaseName]=function(){var e=this[0],n=e._private.cy._private.styleEnabled;if(e)return n?e[t.name]()+e.pstyle("border-width").pfValue+2*e.padding():1},IT["rendered"+t.uppercaseName]=function(){var e=this[0];if(e)return e[t.name]()*this.cy().zoom()},IT["rendered"+t.uppercaseOuterName]=function(){var e=this[0];if(e)return e[t.outerName]()*this.cy().zoom()}};wT({name:"width"}),wT({name:"height"}),OT.padding=function(){var t=this[0],e=t._private;return t.isParent()?(t.updateCompoundBounds(),void 0!==e.autoPadding?e.autoPadding:t.pstyle("padding").pfValue):t.pstyle("padding").pfValue},OT.paddedHeight=function(){var t=this[0];return t.height()+2*t.padding()},OT.paddedWidth=function(){var t=this[0];return t.width()+2*t.padding()};var AT=OT,DT={controlPoints:{get:function(t){return t.renderer().getControlPoints(t)},mult:!0},segmentPoints:{get:function(t){return t.renderer().getSegmentPoints(t)},mult:!0},sourceEndpoint:{get:function(t){return t.renderer().getSourceEndpoint(t)}},targetEndpoint:{get:function(t){return t.renderer().getTargetEndpoint(t)}},midpoint:{get:function(t){return t.renderer().getEdgeMidpoint(t)}}},NT=Object.keys(DT).reduce((function(t,e){var n=DT[e],i=function(t){return"rendered"+t[0].toUpperCase()+t.substr(1)}(e);return t[e]=function(){return function(t,e){if(t.isEdge())return e(t)}(this,n.get)},n.mult?t[i]=function(){return function(t,e){if(t.isEdge()){var n=t.cy(),i=n.pan(),o=n.zoom();return e(t).map((function(t){return cy(t,o,i)}))}}(this,n.get)}:t[i]=function(){return function(t,e){if(t.isEdge()){var n=t.cy();return cy(e(t),n.zoom(),n.pan())}}(this,n.get)},t}),{}),LT=rv({},gT,kT,AT,NT),PT=function(t,e){this.recycle(t,e)};function MT(){return!1}function BT(){return!0}PT.prototype={instanceString:function(){return"event"},recycle:function(t,e){if(this.isImmediatePropagationStopped=this.isPropagationStopped=this.isDefaultPrevented=MT,null!=t&&t.preventDefault?(this.type=t.type,this.isDefaultPrevented=t.defaultPrevented?BT:MT):null!=t&&t.type?e=t:this.type=t,null!=e&&(this.originalEvent=e.originalEvent,this.type=null!=e.type?e.type:this.type,this.cy=e.cy,this.target=e.target,this.position=e.position,this.renderedPosition=e.renderedPosition,this.namespace=e.namespace,this.layout=e.layout),null!=this.cy&&null!=this.position&&null==this.renderedPosition){var n=this.position,i=this.cy.zoom(),o=this.cy.pan();this.renderedPosition={x:n.x*i+o.x,y:n.y*i+o.y}}this.timeStamp=t&&t.timeStamp||Date.now()},preventDefault:function(){this.isDefaultPrevented=BT;var t=this.originalEvent;t&&t.preventDefault&&t.preventDefault()},stopPropagation:function(){this.isPropagationStopped=BT;var t=this.originalEvent;t&&t.stopPropagation&&t.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=BT,this.stopPropagation()},isDefaultPrevented:MT,isPropagationStopped:MT,isImmediatePropagationStopped:MT};var FT=/^([^.]+)(\.(?:[^.]+))?$/,HT={qualifierCompare:function(t,e){return t===e},eventMatches:function(){return!0},addEventFields:function(){},callbackContext:function(t){return t},beforeEmit:function(){},afterEmit:function(){},bubble:function(){return!1},parent:function(){return null},context:null},UT=Object.keys(HT),VT={};function GT(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:VT,e=arguments.length>1?arguments[1]:void 0,n=0;n<UT.length;n++){var i=UT[n];this[i]=t[i]||HT[i]}this.context=e||this.context,this.listeners=[],this.emitting=0}var WT=GT.prototype,zT=function(t,e,n,i,o,r,s){U_(i)&&(o=i,i=null),s&&(r=null==r?s:rv({},r,s));for(var a=V_(n)?n:n.split(/\s+/),l=0;l<a.length;l++){var c=a[l];if(!J_(c)){var d=c.match(FT);if(d)if(!1===e(t,c,d[1],d[2]?d[2]:null,i,o,r))break}}},XT=function(t,e){return t.addEventFields(t.context,e),new PT(e.type,e)},jT=function(t,e,n){if("event"!==F_(n))if(G_(n))e(t,XT(t,n));else for(var i=V_(n)?n:n.split(/\s+/),o=0;o<i.length;o++){var r=i[o];if(!J_(r)){var s=r.match(FT);if(s){var a=s[1],l=s[2]?s[2]:null;e(t,XT(t,{type:a,namespace:l,target:t.context}))}}}else e(t,n)};WT.on=WT.addListener=function(t,e,n,i,o){return zT(this,(function(t,e,n,i,o,r,s){U_(r)&&t.listeners.push({event:e,callback:r,type:n,namespace:i,qualifier:o,conf:s})}),t,e,n,i,o),this},WT.one=function(t,e,n,i){return this.on(t,e,n,i,{one:!0})},WT.removeListener=WT.off=function(t,e,n,i){var o=this;0!==this.emitting&&(this.listeners=this.listeners.slice());for(var r=this.listeners,s=function(s){var a=r[s];zT(o,(function(e,n,i,o,l,c){if((a.type===i||"*"===t)&&(!o&&".*"!==a.namespace||a.namespace===o)&&(!l||e.qualifierCompare(a.qualifier,l))&&(!c||a.callback===c))return r.splice(s,1),!1}),t,e,n,i)},a=r.length-1;a>=0;a--)s(a);return this},WT.removeAllListeners=function(){return this.removeListener("*")},WT.emit=WT.trigger=function(t,e,n){var i=this.listeners,o=i.length;return this.emitting++,V_(e)||(e=[e]),jT(this,(function(t,r){null!=n&&(i=[{event:r.event,type:r.type,namespace:r.namespace,callback:n}],o=i.length);for(var s=function(n){var o=i[n];if(o.type===r.type&&(!o.namespace||o.namespace===r.namespace||".*"===o.namespace)&&t.eventMatches(t.context,o,r)){var s=[r];null!=e&&function(t,e){for(var n=0;n<e.length;n++){var i=e[n];t.push(i)}}(s,e),t.beforeEmit(t.context,o,r),o.conf&&o.conf.one&&(t.listeners=t.listeners.filter((function(t){return t!==o})));var a=t.callbackContext(t.context,o,r),l=o.callback.apply(a,s);t.afterEmit(t.context,o,r),!1===l&&(r.stopPropagation(),r.preventDefault())}},a=0;a<o;a++)s(a);t.bubble(t.context)&&!r.isPropagationStopped()&&t.parent(t.context).emit(r,e)}),t),this.emitting--,this};var YT={qualifierCompare:function(t,e){return null==t||null==e?null==t&&null==e:t.sameText(e)},eventMatches:function(t,e,n){var i=e.qualifier;return null==i||t!==n.target&&j_(n.target)&&i.matches(n.target)},addEventFields:function(t,e){e.cy=t.cy(),e.target=t},callbackContext:function(t,e,n){return null!=e.qualifier?n.target:t},beforeEmit:function(t,e){e.conf&&e.conf.once&&e.conf.onceCollection.removeListener(e.event,e.qualifier,e.callback)},bubble:function(){return!0},parent:function(t){return t.isChild()?t.parent():t.cy()}},KT=function(t){return H_(t)?new YE(t):t},$T={createEmitter:function(){for(var t=0;t<this.length;t++){var e=this[t],n=e._private;n.emitter||(n.emitter=new GT(YT,e))}return this},emitter:function(){return this._private.emitter},on:function(t,e,n){for(var i=KT(e),o=0;o<this.length;o++){this[o].emitter().on(t,i,n)}return this},removeListener:function(t,e,n){for(var i=KT(e),o=0;o<this.length;o++){this[o].emitter().removeListener(t,i,n)}return this},removeAllListeners:function(){for(var t=0;t<this.length;t++){this[t].emitter().removeAllListeners()}return this},one:function(t,e,n){for(var i=KT(e),o=0;o<this.length;o++){this[o].emitter().one(t,i,n)}return this},once:function(t,e,n){for(var i=KT(e),o=0;o<this.length;o++){this[o].emitter().on(t,i,n,{once:!0,onceCollection:this})}},emit:function(t,e){for(var n=0;n<this.length;n++){this[n].emitter().emit(t,e)}return this},emitAndNotify:function(t,e){if(0!==this.length)return this.cy().notify(t,this),this.emit(t,e),this}};dE.eventAliasesOn($T);var JT={nodes:function(t){return this.filter((function(t){return t.isNode()})).filter(t)},edges:function(t){return this.filter((function(t){return t.isEdge()})).filter(t)},byGroup:function(){for(var t=this.spawn(),e=this.spawn(),n=0;n<this.length;n++){var i=this[n];i.isNode()?t.push(i):e.push(i)}return{nodes:t,edges:e}},filter:function(t,e){if(void 0===t)return this;if(H_(t)||X_(t))return new YE(t).filter(this);if(U_(t)){for(var n=this.spawn(),i=this,o=0;o<i.length;o++){var r=i[o];(e?t.apply(e,[r,o,i]):t(r,o,i))&&n.push(r)}return n}return this.spawn()},not:function(t){if(t){H_(t)&&(t=this.filter(t));for(var e=this.spawn(),n=0;n<this.length;n++){var i=this[n];t.has(i)||e.push(i)}return e}return this},absoluteComplement:function(){return this.cy().mutableElements().not(this)},intersect:function(t){if(H_(t)){var e=t;return this.filter(e)}for(var n=this.spawn(),i=t,o=this.length<t.length,r=o?this:i,s=o?i:this,a=0;a<r.length;a++){var l=r[a];s.has(l)&&n.push(l)}return n},xor:function(t){var e=this._private.cy;H_(t)&&(t=e.$(t));var n=this.spawn(),i=t,o=function(t,e){for(var i=0;i<t.length;i++){var o=t[i],r=o._private.data.id;e.hasElementWithId(r)||n.push(o)}};return o(this,i),o(i,this),n},diff:function(t){var e=this._private.cy;H_(t)&&(t=e.$(t));var n=this.spawn(),i=this.spawn(),o=this.spawn(),r=t,s=function(t,e,n){for(var i=0;i<t.length;i++){var r=t[i],s=r._private.data.id;e.hasElementWithId(s)?o.merge(r):n.push(r)}};return s(this,r,n),s(r,this,i),{left:n,right:i,both:o}},add:function(t){var e=this._private.cy;if(!t)return this;if(H_(t)){var n=t;t=e.mutableElements().filter(n)}for(var i=this.spawnSelf(),o=0;o<t.length;o++){var r=t[o],s=!this.has(r);s&&i.push(r)}return i},merge:function(t){var e=this._private,n=e.cy;if(!t)return this;if(t&&H_(t)){var i=t;t=n.mutableElements().filter(i)}for(var o=e.map,r=0;r<t.length;r++){var s=t[r],a=s._private.data.id;if(!o.has(a)){var l=this.length++;this[l]=s,o.set(a,{ele:s,index:l})}}return this},unmergeAt:function(t){var e=this[t].id(),n=this._private.map;this[t]=void 0,n.delete(e);var i=t===this.length-1;if(this.length>1&&!i){var o=this.length-1,r=this[o],s=r._private.data.id;this[o]=void 0,this[t]=r,n.set(s,{ele:r,index:t})}return this.length--,this},unmergeOne:function(t){t=t[0];var e=this._private,n=t._private.data.id,i=e.map.get(n);if(!i)return this;var o=i.index;return this.unmergeAt(o),this},unmerge:function(t){var e=this._private.cy;if(!t)return this;if(t&&H_(t)){var n=t;t=e.mutableElements().filter(n)}for(var i=0;i<t.length;i++)this.unmergeOne(t[i]);return this},unmergeBy:function(t){for(var e=this.length-1;e>=0;e--){t(this[e])&&this.unmergeAt(e)}return this},map:function(t,e){for(var n=[],i=this,o=0;o<i.length;o++){var r=i[o],s=e?t.apply(e,[r,o,i]):t(r,o,i);n.push(s)}return n},reduce:function(t,e){for(var n=e,i=this,o=0;o<i.length;o++)n=t(n,i[o],o,i);return n},max:function(t,e){for(var n,i=-1/0,o=this,r=0;r<o.length;r++){var s=o[r],a=e?t.apply(e,[s,r,o]):t(s,r,o);a>i&&(i=a,n=s)}return{value:i,ele:n}},min:function(t,e){for(var n,i=1/0,o=this,r=0;r<o.length;r++){var s=o[r],a=e?t.apply(e,[s,r,o]):t(s,r,o);a<i&&(i=a,n=s)}return{value:i,ele:n}}},qT=JT;qT.u=qT["|"]=qT["+"]=qT.union=qT.or=qT.add,qT["\\"]=qT["!"]=qT["-"]=qT.difference=qT.relativeComplement=qT.subtract=qT.not,qT.n=qT["&"]=qT["."]=qT.and=qT.intersection=qT.intersect,qT["^"]=qT["(+)"]=qT["(-)"]=qT.symmetricDifference=qT.symdiff=qT.xor,qT.fnFilter=qT.filterFn=qT.stdFilter=qT.filter,qT.complement=qT.abscomp=qT.absoluteComplement;var ZT=function(t,e){var n=t.cy().hasCompoundNodes();function i(t){var e=t.pstyle("z-compound-depth");return"auto"===e.value?n?t.zDepth():0:"bottom"===e.value?-1:"top"===e.value?Iv:0}var o=i(t)-i(e);if(0!==o)return o;function r(t){return"auto"===t.pstyle("z-index-compare").value&&t.isNode()?1:0}var s=r(t)-r(e);if(0!==s)return s;var a=t.pstyle("z-index").value-e.pstyle("z-index").value;return 0!==a?a:t.poolIndex()-e.poolIndex()},QT={forEach:function(t,e){if(U_(t))for(var n=this.length,i=0;i<n;i++){var o=this[i];if(!1===(e?t.apply(e,[o,i,this]):t(o,i,this)))break}return this},toArray:function(){for(var t=[],e=0;e<this.length;e++)t.push(this[e]);return t},slice:function(t,e){var n=[],i=this.length;null==e&&(e=i),null==t&&(t=0),t<0&&(t=i+t),e<0&&(e=i+e);for(var o=t;o>=0&&o<e&&o<i;o++)n.push(this[o]);return this.spawn(n)},size:function(){return this.length},eq:function(t){return this[t]||this.spawn()},first:function(){return this[0]||this.spawn()},last:function(){return this[this.length-1]||this.spawn()},empty:function(){return 0===this.length},nonempty:function(){return!this.empty()},sort:function(t){if(!U_(t))return this;var e=this.toArray().sort(t);return this.spawn(e)},sortByZIndex:function(){return this.sort(ZT)},zDepth:function(){var t=this[0];if(t){var e=t._private;if("nodes"===e.group){var n=e.data.parent?t.parents().size():0;return t.isParent()?n:Iv-1}var i=e.source,o=e.target,r=i.zDepth(),s=o.zDepth();return Math.max(r,s,0)}}};QT.each=QT.forEach;var tR;tR="undefined",("undefined"==typeof Symbol?"undefined":S_(Symbol))!=tR&&S_(Symbol.iterator)!=tR&&(QT[Symbol.iterator]=function(){var t=this,e={value:void 0,done:!1},n=0,i=this.length;return w_({next:function(){return n<i?e.value=t[n++]:(e.value=void 0,e.done=!0),e}},Symbol.iterator,(function(){return this}))});var eR=Hv({nodeDimensionsIncludeLabels:!1}),nR={layoutDimensions:function(t){var e;if(t=eR(t),this.takesUpSpace())if(t.nodeDimensionsIncludeLabels){var n=this.boundingBox();e={w:n.w,h:n.h}}else e={w:this.outerWidth(),h:this.outerHeight()};else e={w:0,h:0};return 0!==e.w&&0!==e.h||(e.w=e.h=1),e},layoutPositions:function(t,e,n){var i=this.nodes().filter((function(t){return!t.isParent()})),o=this.cy(),r=e.eles,s=function(t){return t.id()},a=Z_(n,s);t.emit({type:"layoutstart",layout:t}),t.animations=[];var l=e.spacingFactor&&1!==e.spacingFactor,c=function(){if(!l)return null;for(var t=Ey(),e=0;e<i.length;e++){var n=i[e],o=a(n,e);Ty(t,o.x,o.y)}return t}(),d=Z_((function(t,n){var i=a(t,n);l&&(i=function(t,e,n){var i=e.x1+e.w/2,o=e.y1+e.h/2;return{x:i+(n.x-i)*t,y:o+(n.y-o)*t}}(Math.abs(e.spacingFactor),c,i));return null!=e.transform&&(i=e.transform(t,i)),i}),s);if(e.animate){for(var u=0;u<i.length;u++){var h=i[u],p=d(h,u);if(null==e.animateFilter||e.animateFilter(h,u)){var g=h.animation({position:p,duration:e.animationDuration,easing:e.animationEasing});t.animations.push(g)}else h.position(p)}if(e.fit){var f=o.animation({fit:{boundingBox:r.boundingBoxAt(d),padding:e.padding},duration:e.animationDuration,easing:e.animationEasing});t.animations.push(f)}else if(void 0!==e.zoom&&void 0!==e.pan){var m=o.animation({zoom:e.zoom,pan:e.pan,duration:e.animationDuration,easing:e.animationEasing});t.animations.push(m)}t.animations.forEach((function(t){return t.play()})),t.one("layoutready",e.ready),t.emit({type:"layoutready",layout:t}),aE.all(t.animations.map((function(t){return t.promise()}))).then((function(){t.one("layoutstop",e.stop),t.emit({type:"layoutstop",layout:t})}))}else i.positions(d),e.fit&&o.fit(e.eles,e.padding),null!=e.zoom&&o.zoom(e.zoom),e.pan&&o.pan(e.pan),t.one("layoutready",e.ready),t.emit({type:"layoutready",layout:t}),t.one("layoutstop",e.stop),t.emit({type:"layoutstop",layout:t});return this},layout:function(t){return this.cy().makeLayout(rv({},t,{eles:this}))}};function iR(t,e,n){var i,o=n._private,r=o.styleCache=o.styleCache||[];return null!=(i=r[t])?i:i=r[t]=e(n)}function oR(t,e){return t=Ev(t),function(n){return iR(t,e,n)}}function rR(t,e){t=Ev(t);var n=function(t){return e.call(t)};return function(){var e=this[0];if(e)return iR(t,n,e)}}nR.createLayout=nR.makeLayout=nR.layout;var sR={recalculateRenderedStyle:function(t){var e=this.cy(),n=e.renderer(),i=e.styleEnabled();return n&&i&&n.recalculateRenderedStyle(this,t),this},dirtyStyleCache:function(){var t,e=this.cy(),n=function(t){return t._private.styleCache=null};e.hasCompoundNodes()?((t=this.spawnSelf().merge(this.descendants()).merge(this.parents())).merge(t.connectedEdges()),t.forEach(n)):this.forEach((function(t){n(t),t.connectedEdges().forEach(n)}));return this},updateStyle:function(t){var e=this._private.cy;if(!e.styleEnabled())return this;if(e.batching())return e._private.batchStyleEles.merge(this),this;var n=this;t=!(!t&&void 0!==t),e.hasCompoundNodes()&&(n=this.spawnSelf().merge(this.descendants()).merge(this.parents()));var i=n;return t?i.emitAndNotify("style"):i.emit("style"),n.forEach((function(t){return t._private.styleDirty=!0})),this},cleanStyle:function(){var t=this.cy();if(t.styleEnabled())for(var e=0;e<this.length;e++){var n=this[e];n._private.styleDirty&&(n._private.styleDirty=!1,t.style().apply(n))}},parsedStyle:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this[0],i=n.cy();if(i.styleEnabled()&&n){this.cleanStyle();var o=n._private.style[t];return null!=o?o:e?i.style().getDefaultProperty(t):null}},numericStyle:function(t){var e=this[0];if(e.cy().styleEnabled()&&e){var n=e.pstyle(t);return void 0!==n.pfValue?n.pfValue:n.value}},numericStyleUnits:function(t){var e=this[0];if(e.cy().styleEnabled())return e?e.pstyle(t).units:void 0},renderedStyle:function(t){var e=this.cy();if(!e.styleEnabled())return this;var n=this[0];return n?e.style().getRenderedStyle(n,t):void 0},style:function(t,e){var n=this.cy();if(!n.styleEnabled())return this;var i=n.style();if(G_(t)){var o=t;i.applyBypass(this,o,false),this.emitAndNotify("style")}else if(H_(t)){if(void 0===e){var r=this[0];return r?i.getStylePropertyValue(r,t):void 0}i.applyBypass(this,t,e,false),this.emitAndNotify("style")}else if(void 0===t){var s=this[0];return s?i.getRawStyle(s):void 0}return this},removeStyle:function(t){var e=this.cy();if(!e.styleEnabled())return this;var n=e.style(),i=this;if(void 0===t)for(var o=0;o<i.length;o++){var r=i[o];n.removeAllBypasses(r,false)}else{t=t.split(/\s+/);for(var s=0;s<i.length;s++){var a=i[s];n.removeBypasses(a,t,false)}}return this.emitAndNotify("style"),this},show:function(){return this.css("display","element"),this},hide:function(){return this.css("display","none"),this},effectiveOpacity:function(){var t=this.cy();if(!t.styleEnabled())return 1;var e=t.hasCompoundNodes(),n=this[0];if(n){var i=n._private,o=n.pstyle("opacity").value;if(!e)return o;var r=i.data.parent?n.parents():null;if(r)for(var s=0;s<r.length;s++){o*=r[s].pstyle("opacity").value}return o}},transparent:function(){if(!this.cy().styleEnabled())return!1;var t=this[0],e=t.cy().hasCompoundNodes();return t?e?0===t.effectiveOpacity():0===t.pstyle("opacity").value:void 0},backgrounding:function(){return!!this.cy().styleEnabled()&&!!this[0]._private.backgrounding}};function aR(t,e){var n=t._private.data.parent?t.parents():null;if(n)for(var i=0;i<n.length;i++){if(!e(n[i]))return!1}return!0}function lR(t){var e=t.ok,n=t.edgeOkViaNode||t.ok,i=t.parentOk||t.ok;return function(){var t=this.cy();if(!t.styleEnabled())return!0;var o=this[0],r=t.hasCompoundNodes();if(o){var s=o._private;if(!e(o))return!1;if(o.isNode())return!r||aR(o,i);var a=s.source,l=s.target;return n(a)&&(!r||aR(a,n))&&(a===l||n(l)&&(!r||aR(l,n)))}}}var cR=oR("eleTakesUpSpace",(function(t){return"element"===t.pstyle("display").value&&0!==t.width()&&(!t.isNode()||0!==t.height())}));sR.takesUpSpace=rR("takesUpSpace",lR({ok:cR}));var dR=oR("eleInteractive",(function(t){return"yes"===t.pstyle("events").value&&"visible"===t.pstyle("visibility").value&&cR(t)})),uR=oR("parentInteractive",(function(t){return"visible"===t.pstyle("visibility").value&&cR(t)}));sR.interactive=rR("interactive",lR({ok:dR,parentOk:uR,edgeOkViaNode:cR})),sR.noninteractive=function(){var t=this[0];if(t)return!t.interactive()};var hR=oR("eleVisible",(function(t){return"visible"===t.pstyle("visibility").value&&0!==t.pstyle("opacity").pfValue&&cR(t)})),pR=cR;sR.visible=rR("visible",lR({ok:hR,edgeOkViaNode:pR})),sR.hidden=function(){var t=this[0];if(t)return!t.visible()},sR.isBundledBezier=rR("isBundledBezier",(function(){return!!this.cy().styleEnabled()&&(!this.removed()&&"bezier"===this.pstyle("curve-style").value&&this.takesUpSpace())})),sR.bypass=sR.css=sR.style,sR.renderedCss=sR.renderedStyle,sR.removeBypass=sR.removeCss=sR.removeStyle,sR.pstyle=sR.parsedStyle;var gR={};function fR(t){return function(){var e=arguments,n=[];if(2===e.length){var i=e[0],o=e[1];this.on(t.event,i,o)}else if(1===e.length&&U_(e[0])){var r=e[0];this.on(t.event,r)}else if(0===e.length||1===e.length&&V_(e[0])){for(var s=1===e.length?e[0]:null,a=0;a<this.length;a++){var l=this[a],c=!t.ableField||l._private[t.ableField],d=l._private[t.field]!=t.value;if(t.overrideAble){var u=t.overrideAble(l);if(void 0!==u&&(c=u,!u))return this}c&&(l._private[t.field]=t.value,d&&n.push(l))}var h=this.spawn(n);h.updateStyle(),h.emit(t.event),s&&h.emit(s)}return this}}function mR(t){gR[t.field]=function(){var e=this[0];if(e){if(t.overrideField){var n=t.overrideField(e);if(void 0!==n)return n}return e._private[t.field]}},gR[t.on]=fR({event:t.on,field:t.field,ableField:t.ableField,overrideAble:t.overrideAble,value:!0}),gR[t.off]=fR({event:t.off,field:t.field,ableField:t.ableField,overrideAble:t.overrideAble,value:!1})}mR({field:"locked",overrideField:function(t){return!!t.cy().autolock()||void 0},on:"lock",off:"unlock"}),mR({field:"grabbable",overrideField:function(t){return!t.cy().autoungrabify()&&!t.pannable()&&void 0},on:"grabify",off:"ungrabify"}),mR({field:"selected",ableField:"selectable",overrideAble:function(t){return!t.cy().autounselectify()&&void 0},on:"select",off:"unselect"}),mR({field:"selectable",overrideField:function(t){return!t.cy().autounselectify()&&void 0},on:"selectify",off:"unselectify"}),gR.deselect=gR.unselect,gR.grabbed=function(){var t=this[0];if(t)return t._private.grabbed},mR({field:"active",on:"activate",off:"unactivate"}),mR({field:"pannable",on:"panify",off:"unpanify"}),gR.inactive=function(){var t=this[0];if(t)return!t._private.active};var _R={},vR=function(t){return function(e){for(var n=[],i=0;i<this.length;i++){var o=this[i];if(o.isNode()){for(var r=!1,s=o.connectedEdges(),a=0;a<s.length;a++){var l=s[a],c=l.source(),d=l.target();if(t.noIncomingEdges&&d===o&&c!==o||t.noOutgoingEdges&&c===o&&d!==o){r=!0;break}}r||n.push(o)}}return this.spawn(n,!0).filter(e)}},yR=function(t){return function(e){for(var n=[],i=0;i<this.length;i++){var o=this[i];if(o.isNode())for(var r=o.connectedEdges(),s=0;s<r.length;s++){var a=r[s],l=a.source(),c=a.target();t.outgoing&&l===o?(n.push(a),n.push(c)):t.incoming&&c===o&&(n.push(a),n.push(l))}}return this.spawn(n,!0).filter(e)}},bR=function(t){return function(e){for(var n=this,i=[],o={};;){var r=t.outgoing?n.outgoers():n.incomers();if(0===r.length)break;for(var s=!1,a=0;a<r.length;a++){var l=r[a],c=l.id();o[c]||(o[c]=!0,i.push(l),s=!0)}if(!s)break;n=r}return this.spawn(i,!0).filter(e)}};function ER(t){return function(e){for(var n=[],i=0;i<this.length;i++){var o=this[i]._private[t.attr];o&&n.push(o)}return this.spawn(n,!0).filter(e)}}function TR(t){return function(e){var n=[],i=this._private.cy,o=t||{};H_(e)&&(e=i.$(e));for(var r=0;r<e.length;r++)for(var s=e[r]._private.edges,a=0;a<s.length;a++){var l=s[a],c=l._private.data,d=this.hasElementWithId(c.source)&&e.hasElementWithId(c.target),u=e.hasElementWithId(c.source)&&this.hasElementWithId(c.target);if(d||u){if(o.thisIsSrc||o.thisIsTgt){if(o.thisIsSrc&&!d)continue;if(o.thisIsTgt&&!u)continue}n.push(l)}}return this.spawn(n,!0)}}function RR(t){return t=rv({},{codirected:!1},t),function(e){for(var n=[],i=this.edges(),o=t,r=0;r<i.length;r++)for(var s=i[r]._private,a=s.source,l=a._private.data.id,c=s.data.target,d=a._private.edges,u=0;u<d.length;u++){var h=d[u],p=h._private.data,g=p.target,f=p.source,m=g===c&&f===l,_=l===g&&c===f;(o.codirected&&m||!o.codirected&&(m||_))&&n.push(h)}return this.spawn(n,!0).filter(e)}}_R.clearTraversalCache=function(){for(var t=0;t<this.length;t++)this[t]._private.traversalCache=null},rv(_R,{roots:vR({noIncomingEdges:!0}),leaves:vR({noOutgoingEdges:!0}),outgoers:ZE(yR({outgoing:!0}),"outgoers"),successors:bR({outgoing:!0}),incomers:ZE(yR({incoming:!0}),"incomers"),predecessors:bR({incoming:!0})}),rv(_R,{neighborhood:ZE((function(t){for(var e=[],n=this.nodes(),i=0;i<n.length;i++)for(var o=n[i],r=o.connectedEdges(),s=0;s<r.length;s++){var a=r[s],l=a.source(),c=a.target(),d=o===l?c:l;d.length>0&&e.push(d[0]),e.push(a[0])}return this.spawn(e,!0).filter(t)}),"neighborhood"),closedNeighborhood:function(t){return this.neighborhood().add(this).filter(t)},openNeighborhood:function(t){return this.neighborhood(t)}}),_R.neighbourhood=_R.neighborhood,_R.closedNeighbourhood=_R.closedNeighborhood,_R.openNeighbourhood=_R.openNeighborhood,rv(_R,{source:ZE((function(t){var e,n=this[0];return n&&(e=n._private.source||n.cy().collection()),e&&t?e.filter(t):e}),"source"),target:ZE((function(t){var e,n=this[0];return n&&(e=n._private.target||n.cy().collection()),e&&t?e.filter(t):e}),"target"),sources:ER({attr:"source"}),targets:ER({attr:"target"})}),rv(_R,{edgesWith:ZE(TR(),"edgesWith"),edgesTo:ZE(TR({thisIsSrc:!0}),"edgesTo")}),rv(_R,{connectedEdges:ZE((function(t){for(var e=[],n=0;n<this.length;n++){var i=this[n];if(i.isNode())for(var o=i._private.edges,r=0;r<o.length;r++){var s=o[r];e.push(s)}}return this.spawn(e,!0).filter(t)}),"connectedEdges"),connectedNodes:ZE((function(t){for(var e=[],n=0;n<this.length;n++){var i=this[n];i.isEdge()&&(e.push(i.source()[0]),e.push(i.target()[0]))}return this.spawn(e,!0).filter(t)}),"connectedNodes"),parallelEdges:ZE(RR(),"parallelEdges"),codirectedEdges:ZE(RR({codirected:!0}),"codirectedEdges")}),rv(_R,{components:function(t){var e=this,n=e.cy(),i=n.collection(),o=null==t?e.nodes():t.nodes(),r=[];null!=t&&o.empty()&&(o=t.sources());var s=function(t,e){i.merge(t),o.unmerge(t),e.merge(t)};if(o.empty())return e.spawn();var a=function(){var t=n.collection();r.push(t);var i=o[0];s(i,t),e.bfs({directed:!1,roots:i,visit:function(e){return s(e,t)}}),t.forEach((function(n){n.connectedEdges().forEach((function(n){e.has(n)&&t.has(n.source())&&t.has(n.target())&&t.merge(n)}))}))};do{a()}while(o.length>0);return r},component:function(){var t=this[0];return t.cy().mutableElements().components(t)[0]}}),_R.componentsOf=_R.components;var CR=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(void 0!==t){var i=new zv,o=!1;if(e){if(e.length>0&&G_(e[0])&&!j_(e[0])){o=!0;for(var r=[],s=new jv,a=0,l=e.length;a<l;a++){var c=e[a];null==c.data&&(c.data={});var d=c.data;if(null==d.id)d.id=Mv();else if(t.hasElementWithId(d.id)||s.has(d.id))continue;var u=new Yv(t,c,!1);r.push(u),s.add(d.id)}e=r}}else e=[];this.length=0;for(var h=0,p=e.length;h<p;h++){var g=e[h][0];if(null!=g){var f=g._private.data.id;n&&i.has(f)||(n&&i.set(f,{index:this.length,ele:g}),this[this.length]=g,this.length++)}}this._private={eles:this,cy:t,get map(){return null==this.lazyMap&&this.rebuildMap(),this.lazyMap},set map(t){this.lazyMap=t},rebuildMap:function(){for(var t=this.lazyMap=new zv,e=this.eles,n=0;n<e.length;n++){var i=e[n];t.set(i.id(),{index:n,ele:i})}}},n&&(this._private.map=i),o&&this.restore()}else Dv("A collection must have a reference to the core")},xR=Yv.prototype=CR.prototype=Object.create(Array.prototype);xR.instanceString=function(){return"collection"},xR.spawn=function(t,e){return new CR(this.cy(),t,e)},xR.spawnSelf=function(){return this.spawn(this)},xR.cy=function(){return this._private.cy},xR.renderer=function(){return this._private.cy.renderer()},xR.element=function(){return this[0]},xR.collection=function(){return Y_(this)?this:new CR(this._private.cy,[this])},xR.unique=function(){return new CR(this._private.cy,this,!0)},xR.hasElementWithId=function(t){return t=""+t,this._private.map.has(t)},xR.getElementById=function(t){t=""+t;var e=this._private.cy,n=this._private.map.get(t);return n?n.ele:new CR(e)},xR.$id=xR.getElementById,xR.poolIndex=function(){var t=this._private.cy._private.elements,e=this[0]._private.data.id;return t._private.map.get(e).index},xR.indexOf=function(t){var e=t[0]._private.data.id;return this._private.map.get(e).index},xR.indexOfId=function(t){return t=""+t,this._private.map.get(t).index},xR.json=function(t){var e=this.element(),n=this.cy();if(null==e&&t)return this;if(null!=e){var i=e._private;if(G_(t)){if(n.startBatch(),t.data){e.data(t.data);var o=i.data;if(e.isEdge()){var r=!1,s={},a=t.data.source,l=t.data.target;null!=a&&a!=o.source&&(s.source=""+a,r=!0),null!=l&&l!=o.target&&(s.target=""+l,r=!0),r&&(e=e.move(s))}else{var c="parent"in t.data,d=t.data.parent;!c||null==d&&null==o.parent||d==o.parent||(void 0===d&&(d=null),null!=d&&(d=""+d),e=e.move({parent:d}))}}t.position&&e.position(t.position);var u=function(n,o,r){var s=t[n];null!=s&&s!==i[n]&&(s?e[o]():e[r]())};return u("removed","remove","restore"),u("selected","select","unselect"),u("selectable","selectify","unselectify"),u("locked","lock","unlock"),u("grabbable","grabify","ungrabify"),u("pannable","panify","unpanify"),null!=t.classes&&e.classes(t.classes),n.endBatch(),this}if(void 0===t){var h={data:Pv(i.data),position:Pv(i.position),group:i.group,removed:i.removed,selected:i.selected,selectable:i.selectable,locked:i.locked,grabbable:i.grabbable,pannable:i.pannable,classes:null};h.classes="";var p=0;return i.classes.forEach((function(t){return h.classes+=0==p++?t:" "+t})),h}}},xR.jsons=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e].json();t.push(n)}return t},xR.clone=function(){for(var t=this.cy(),e=[],n=0;n<this.length;n++){var i=this[n].json(),o=new Yv(t,i,!1);e.push(o)}return new CR(t,e)},xR.copy=xR.clone,xR.restore=function(){for(var t,e,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=this,r=o.cy(),s=r._private,a=[],l=[],c=0,d=o.length;c<d;c++){var u=o[c];i&&!u.removed()||(u.isNode()?a.push(u):l.push(u))}t=a.concat(l);var h=function(){t.splice(e,1),e--};for(e=0;e<t.length;e++){var p=t[e],g=p._private,f=g.data;if(p.clearTraversalCache(),i||g.removed)if(void 0===f.id)f.id=Mv();else if(W_(f.id))f.id=""+f.id;else{if(J_(f.id)||!H_(f.id)){Dv("Can not create element with invalid string ID `"+f.id+"`"),h();continue}if(r.hasElementWithId(f.id)){Dv("Can not create second element with ID `"+f.id+"`"),h();continue}}else;var m=f.id;if(p.isNode()){var _=g.position;null==_.x&&(_.x=0),null==_.y&&(_.y=0)}if(p.isEdge()){for(var v=p,y=["source","target"],b=y.length,E=!1,T=0;T<b;T++){var R=y[T],C=f[R];W_(C)&&(C=f[R]=""+f[R]),null==C||""===C?(Dv("Can not create edge `"+m+"` with unspecified "+R),E=!0):r.hasElementWithId(C)||(Dv("Can not create edge `"+m+"` with nonexistant "+R+" `"+C+"`"),E=!0)}if(E){h();continue}var x=r.getElementById(f.source),S=r.getElementById(f.target);x.same(S)?x._private.edges.push(v):(x._private.edges.push(v),S._private.edges.push(v)),v._private.source=x,v._private.target=S}g.map=new zv,g.map.set(m,{ele:p,index:0}),g.removed=!1,i&&r.addToPool(p)}for(var I=0;I<a.length;I++){var O=a[I],k=O._private.data;W_(k.parent)&&(k.parent=""+k.parent);var w=k.parent,A=null!=w;if(A){var D=r.getElementById(w);if(D.empty())k.parent=void 0;else{for(var N=!1,L=D;!L.empty();){if(O.same(L)){N=!0,k.parent=void 0;break}L=L.parent()}N||(D[0]._private.children.push(O),O._private.parent=D[0],s.hasCompoundNodes=!0)}}}if(t.length>0){for(var P=t.length===o.length?o:new CR(r,t),M=0;M<P.length;M++){var B=P[M];B.isNode()||(B.parallelEdges().clearTraversalCache(),B.source().clearTraversalCache(),B.target().clearTraversalCache())}(s.hasCompoundNodes?r.collection().merge(P).merge(P.connectedNodes()).merge(P.parent()):P).dirtyCompoundBoundsCache().dirtyBoundingBoxCache().updateStyle(n),n?P.emitAndNotify("add"):i&&P.emit("add")}return o},xR.removed=function(){var t=this[0];return t&&t._private.removed},xR.inside=function(){var t=this[0];return t&&!t._private.removed},xR.remove=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this,i=[],o={},r=n._private.cy;function s(t){for(var e=t._private.edges,n=0;n<e.length;n++)l(e[n])}function a(t){for(var e=t._private.children,n=0;n<e.length;n++)l(e[n])}function l(t){var n=o[t.id()];e&&t.removed()||n||(o[t.id()]=!0,t.isNode()?(i.push(t),s(t),a(t)):i.unshift(t))}for(var c=0,d=n.length;c<d;c++){var u=n[c];l(u)}function h(t,e){var n=t._private.edges;Uv(n,e),t.clearTraversalCache()}function p(t){t.clearTraversalCache()}var g=[];function f(t,e){e=e[0];var n=(t=t[0])._private.children,i=t.id();Uv(n,e),e._private.parent=null,g.ids[i]||(g.ids[i]=!0,g.push(t))}g.ids={},n.dirtyCompoundBoundsCache(),e&&r.removeFromPool(i);for(var m=0;m<i.length;m++){var _=i[m];if(_.isEdge()){var v=_.source()[0],y=_.target()[0];h(v,_),h(y,_);for(var b=_.parallelEdges(),E=0;E<b.length;E++){var T=b[E];p(T),T.isBundledBezier()&&T.dirtyBoundingBoxCache()}}else{var R=_.parent();0!==R.length&&f(R,_)}e&&(_._private.removed=!0)}var C=r._private.elements;r._private.hasCompoundNodes=!1;for(var x=0;x<C.length;x++){var S=C[x];if(S.isParent()){r._private.hasCompoundNodes=!0;break}}var I=new CR(this.cy(),i);I.size()>0&&(t?I.emitAndNotify("remove"):e&&I.emit("remove"));for(var O=0;O<g.length;O++){var k=g[O];e&&k.removed()||k.updateStyle()}return I},xR.move=function(t){var e=this._private.cy,n=this,i=!1,o=!1,r=function(t){return null==t?t:""+t};if(void 0!==t.source||void 0!==t.target){var s=r(t.source),a=r(t.target),l=null!=s&&e.hasElementWithId(s),c=null!=a&&e.hasElementWithId(a);(l||c)&&(e.batch((function(){n.remove(i,o),n.emitAndNotify("moveout");for(var t=0;t<n.length;t++){var e=n[t],r=e._private.data;e.isEdge()&&(l&&(r.source=s),c&&(r.target=a))}n.restore(i,o)})),n.emitAndNotify("move"))}else if(void 0!==t.parent){var d=r(t.parent);if(null===d||e.hasElementWithId(d)){var u=null===d?void 0:d;e.batch((function(){var t=n.remove(i,o);t.emitAndNotify("moveout");for(var e=0;e<n.length;e++){var r=n[e],s=r._private.data;r.isNode()&&(s.parent=u)}t.restore(i,o)})),n.emitAndNotify("move")}}return this},[tE,uE,hE,$E,QE,sT,aT,LT,$T,JT,{isNode:function(){return"nodes"===this.group()},isEdge:function(){return"edges"===this.group()},isLoop:function(){return this.isEdge()&&this.source()[0]===this.target()[0]},isSimple:function(){return this.isEdge()&&this.source()[0]!==this.target()[0]},group:function(){var t=this[0];if(t)return t._private.group}},QT,nR,sR,gR,_R].forEach((function(t){rv(xR,t)}));var SR={add:function(t){var e,n=this;if(X_(t)){var i=t;if(i._private.cy===n)e=i.restore();else{for(var o=[],r=0;r<i.length;r++){var s=i[r];o.push(s.json())}e=new CR(n,o)}}else if(V_(t)){e=new CR(n,t)}else if(G_(t)&&(V_(t.nodes)||V_(t.edges))){for(var a=t,l=[],c=["nodes","edges"],d=0,u=c.length;d<u;d++){var h=c[d],p=a[h];if(V_(p))for(var g=0,f=p.length;g<f;g++){var m=rv({group:h},p[g]);l.push(m)}}e=new CR(n,l)}else{e=new Yv(n,t).collection()}return e},remove:function(t){if(X_(t));else if(H_(t)){var e=t;t=this.$(e)}return t.remove()}};var IR=function(){function t(t){return-t.tension*t.x-t.friction*t.v}function e(e,n,i){var o={x:e.x+i.dx*n,v:e.v+i.dv*n,tension:e.tension,friction:e.friction};return{dx:o.v,dv:t(o)}}function n(n,i){var o={dx:n.v,dv:t(n)},r=e(n,.5*i,o),s=e(n,.5*i,r),a=e(n,i,s),l=1/6*(o.dx+2*(r.dx+s.dx)+a.dx),c=1/6*(o.dv+2*(r.dv+s.dv)+a.dv);return n.x=n.x+l*i,n.v=n.v+c*i,n}return function t(e,i,o){var r,s,a,l={x:-1,v:0,tension:null,friction:null},c=[0],d=0,u=1e-4;for(e=parseFloat(e)||500,i=parseFloat(i)||20,o=o||null,l.tension=e,l.friction=i,s=(r=null!==o)?(d=t(e,i))/o*.016:.016;a=n(a||l,s),c.push(1+a.x),d+=16,Math.abs(a.x)>u&&Math.abs(a.v)>u;);return r?function(t){return c[t*(c.length-1)|0]}:d}}(),OR=function(t,e,n,i){var o=function(t,e,n,i){var o=4,r=.001,s=1e-7,a=10,l=11,c=1/(l-1),d="undefined"!=typeof Float32Array;if(4!==arguments.length)return!1;for(var u=0;u<4;++u)if("number"!=typeof arguments[u]||isNaN(arguments[u])||!isFinite(arguments[u]))return!1;t=Math.min(t,1),n=Math.min(n,1),t=Math.max(t,0),n=Math.max(n,0);var h=d?new Float32Array(l):new Array(l);function p(t,e){return 1-3*e+3*t}function g(t,e){return 3*e-6*t}function f(t){return 3*t}function m(t,e,n){return((p(e,n)*t+g(e,n))*t+f(e))*t}function _(t,e,n){return 3*p(e,n)*t*t+2*g(e,n)*t+f(e)}function v(e,i){for(var r=0;r<o;++r){var s=_(i,t,n);if(0===s)return i;i-=(m(i,t,n)-e)/s}return i}function y(){for(var e=0;e<l;++e)h[e]=m(e*c,t,n)}function b(e,i,o){var r,l,c=0;do{(r=m(l=i+(o-i)/2,t,n)-e)>0?o=l:i=l}while(Math.abs(r)>s&&++c<a);return l}function E(e){for(var i=0,o=1,s=l-1;o!==s&&h[o]<=e;++o)i+=c;--o;var a=i+(e-h[o])/(h[o+1]-h[o])*c,d=_(a,t,n);return d>=r?v(e,a):0===d?a:b(e,i,i+c)}var T=!1;function R(){T=!0,t===e&&n===i||y()}var C=function(o){return T||R(),t===e&&n===i?o:0===o?0:1===o?1:m(E(o),e,i)};C.getControlPoints=function(){return[{x:t,y:e},{x:n,y:i}]};var x="generateBezier("+[t,e,n,i]+")";return C.toString=function(){return x},C}(t,e,n,i);return function(t,e,n){return t+(e-t)*o(n)}},kR={linear:function(t,e,n){return t+(e-t)*n},ease:OR(.25,.1,.25,1),"ease-in":OR(.42,0,1,1),"ease-out":OR(0,0,.58,1),"ease-in-out":OR(.42,0,.58,1),"ease-in-sine":OR(.47,0,.745,.715),"ease-out-sine":OR(.39,.575,.565,1),"ease-in-out-sine":OR(.445,.05,.55,.95),"ease-in-quad":OR(.55,.085,.68,.53),"ease-out-quad":OR(.25,.46,.45,.94),"ease-in-out-quad":OR(.455,.03,.515,.955),"ease-in-cubic":OR(.55,.055,.675,.19),"ease-out-cubic":OR(.215,.61,.355,1),"ease-in-out-cubic":OR(.645,.045,.355,1),"ease-in-quart":OR(.895,.03,.685,.22),"ease-out-quart":OR(.165,.84,.44,1),"ease-in-out-quart":OR(.77,0,.175,1),"ease-in-quint":OR(.755,.05,.855,.06),"ease-out-quint":OR(.23,1,.32,1),"ease-in-out-quint":OR(.86,0,.07,1),"ease-in-expo":OR(.95,.05,.795,.035),"ease-out-expo":OR(.19,1,.22,1),"ease-in-out-expo":OR(1,0,0,1),"ease-in-circ":OR(.6,.04,.98,.335),"ease-out-circ":OR(.075,.82,.165,1),"ease-in-out-circ":OR(.785,.135,.15,.86),spring:function(t,e,n){if(0===n)return kR.linear;var i=IR(t,e,n);return function(t,e,n){return t+(e-t)*i(n)}},"cubic-bezier":OR};function wR(t,e,n,i,o){if(1===i)return n;if(e===n)return n;var r=o(e,n,i);return null==t||((t.roundValue||t.color)&&(r=Math.round(r)),void 0!==t.min&&(r=Math.max(r,t.min)),void 0!==t.max&&(r=Math.min(r,t.max))),r}function AR(t,e){return null!=t.pfValue||null!=t.value?null==t.pfValue||null!=e&&"%"===e.type.units?t.value:t.pfValue:t}function DR(t,e,n,i,o){var r=null!=o?o.type:null;n<0?n=0:n>1&&(n=1);var s=AR(t,o),a=AR(e,o);if(W_(s)&&W_(a))return wR(r,s,a,n,i);if(V_(s)&&V_(a)){for(var l=[],c=0;c<a.length;c++){var d=s[c],u=a[c];if(null!=d&&null!=u){var h=wR(r,d,u,n,i);l.push(h)}else l.push(u)}return l}}function NR(t,e,n,i){var o=!i,r=t._private,s=e._private,a=s.easing,l=s.startTime,c=(i?t:t.cy()).style();if(!s.easingImpl)if(null==a)s.easingImpl=kR.linear;else{var d,u,h;if(H_(a))d=c.parse("transition-timing-function",a).value;else d=a;H_(d)?(u=d,h=[]):(u=d[1],h=d.slice(2).map((function(t){return+t}))),h.length>0?("spring"===u&&h.push(s.duration),s.easingImpl=kR[u].apply(null,h)):s.easingImpl=kR[u]}var p,g=s.easingImpl;if(p=0===s.duration?1:(n-l)/s.duration,s.applying&&(p=s.progress),p<0?p=0:p>1&&(p=1),null==s.delay){var f=s.startPosition,m=s.position;if(m&&o&&!t.locked()){var _={};LR(f.x,m.x)&&(_.x=DR(f.x,m.x,p,g)),LR(f.y,m.y)&&(_.y=DR(f.y,m.y,p,g)),t.position(_)}var v=s.startPan,y=s.pan,b=r.pan,E=null!=y&&i;E&&(LR(v.x,y.x)&&(b.x=DR(v.x,y.x,p,g)),LR(v.y,y.y)&&(b.y=DR(v.y,y.y,p,g)),t.emit("pan"));var T=s.startZoom,R=s.zoom,C=null!=R&&i;C&&(LR(T,R)&&(r.zoom=by(r.minZoom,DR(T,R,p,g),r.maxZoom)),t.emit("zoom")),(E||C)&&t.emit("viewport");var x=s.style;if(x&&x.length>0&&o){for(var S=0;S<x.length;S++){var I=x[S],O=I.name,k=I,w=s.startStyle[O],A=DR(w,k,p,g,c.properties[w.name]);c.overrideBypass(t,O,A)}t.emit("style")}}return s.progress=p,p}function LR(t,e){return null!=t&&null!=e&&(!(!W_(t)||!W_(e))||!(!t||!e))}function PR(t,e,n,i){var o=e._private;o.started=!0,o.startTime=n-o.progress*o.duration}function MR(t,e){var n=e._private.aniEles,i=[];function o(e,n){var o=e._private,r=o.animation.current,s=o.animation.queue,a=!1;if(0===r.length){var l=s.shift();l&&r.push(l)}for(var c=function(t){for(var e=t.length-1;e>=0;e--){(0,t[e])()}t.splice(0,t.length)},d=r.length-1;d>=0;d--){var u=r[d],h=u._private;h.stopped?(r.splice(d,1),h.hooked=!1,h.playing=!1,h.started=!1,c(h.frames)):(h.playing||h.applying)&&(h.playing&&h.applying&&(h.applying=!1),h.started||PR(0,u,t),NR(e,u,t,n),h.applying&&(h.applying=!1),c(h.frames),null!=h.step&&h.step(t),u.completed()&&(r.splice(d,1),h.hooked=!1,h.playing=!1,h.started=!1,c(h.completes)),a=!0)}return n||0!==r.length||0!==s.length||i.push(e),a}for(var r=!1,s=0;s<n.length;s++){var a=o(n[s]);r=r||a}var l=o(e,!0);(r||l)&&(n.length>0?e.notify("draw",n):e.notify("draw")),n.unmerge(i),e.emit("step")}var BR={animate:dE.animate(),animation:dE.animation(),animated:dE.animated(),clearQueue:dE.clearQueue(),delay:dE.delay(),delayAnimation:dE.delayAnimation(),stop:dE.stop(),addToAnimationPool:function(t){this.styleEnabled()&&this._private.aniEles.merge(t)},stopAnimationLoop:function(){this._private.animationsRunning=!1},startAnimationLoop:function(){var t=this;if(t._private.animationsRunning=!0,t.styleEnabled()){var e=t.renderer();e&&e.beforeRender?e.beforeRender((function(e,n){MR(n,t)}),e.beforeRenderPriorities.animations):function e(){t._private.animationsRunning&&pv((function(n){MR(n,t),e()}))}()}}},FR={qualifierCompare:function(t,e){return null==t||null==e?null==t&&null==e:t.sameText(e)},eventMatches:function(t,e,n){var i=e.qualifier;return null==i||t!==n.target&&j_(n.target)&&i.matches(n.target)},addEventFields:function(t,e){e.cy=t,e.target=t},callbackContext:function(t,e,n){return null!=e.qualifier?n.target:t}},HR=function(t){return H_(t)?new YE(t):t},UR={createEmitter:function(){var t=this._private;return t.emitter||(t.emitter=new GT(FR,this)),this},emitter:function(){return this._private.emitter},on:function(t,e,n){return this.emitter().on(t,HR(e),n),this},removeListener:function(t,e,n){return this.emitter().removeListener(t,HR(e),n),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},one:function(t,e,n){return this.emitter().one(t,HR(e),n),this},once:function(t,e,n){return this.emitter().one(t,HR(e),n),this},emit:function(t,e){return this.emitter().emit(t,e),this},emitAndNotify:function(t,e){return this.emit(t),this.notify(t,e),this}};dE.eventAliasesOn(UR);var VR={png:function(t){return t=t||{},this._private.renderer.png(t)},jpg:function(t){var e=this._private.renderer;return(t=t||{}).bg=t.bg||"#fff",e.jpg(t)}};VR.jpeg=VR.jpg;var GR={layout:function(t){var e=this;if(null!=t)if(null!=t.name){var n=t.name,i=e.extension("layout",n);if(null!=i){var o;o=H_(t.eles)?e.$(t.eles):null!=t.eles?t.eles:e.$();var r=new i(rv({},t,{cy:e,eles:o}));return r}Dv("No such layout `"+n+"` found.  Did you forget to import it and `cytoscape.use()` it?")}else Dv("A `name` must be specified to make a layout");else Dv("Layout options must be specified to make a layout")}};GR.createLayout=GR.makeLayout=GR.layout;var WR={notify:function(t,e){var n=this._private;if(this.batching()){n.batchNotifications=n.batchNotifications||{};var i=n.batchNotifications[t]=n.batchNotifications[t]||this.collection();null!=e&&i.merge(e)}else if(n.notificationsEnabled){var o=this.renderer();!this.destroyed()&&o&&o.notify(t,e)}},notifications:function(t){var e=this._private;return void 0===t?e.notificationsEnabled:(e.notificationsEnabled=!!t,this)},noNotifications:function(t){this.notifications(!1),t(),this.notifications(!0)},batching:function(){return this._private.batchCount>0},startBatch:function(){var t=this._private;return null==t.batchCount&&(t.batchCount=0),0===t.batchCount&&(t.batchStyleEles=this.collection(),t.batchNotifications={}),t.batchCount++,this},endBatch:function(){var t=this._private;if(0===t.batchCount)return this;if(t.batchCount--,0===t.batchCount){t.batchStyleEles.updateStyle();var e=this.renderer();Object.keys(t.batchNotifications).forEach((function(n){var i=t.batchNotifications[n];i.empty()?e.notify(n):e.notify(n,i)}))}return this},batch:function(t){return this.startBatch(),t(),this.endBatch(),this},batchData:function(t){var e=this;return this.batch((function(){for(var n=Object.keys(t),i=0;i<n.length;i++){var o=n[i],r=t[o];e.getElementById(o).data(r)}}))}},zR=Hv({hideEdgesOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.05,pixelRatio:void 0,desktopTapThreshold:4,touchTapThreshold:8,wheelSensitivity:1,debug:!1,showFps:!1}),XR={renderTo:function(t,e,n,i){return this._private.renderer.renderTo(t,e,n,i),this},renderer:function(){return this._private.renderer},forceRender:function(){return this.notify("draw"),this},resize:function(){return this.invalidateSize(),this.emitAndNotify("resize"),this},initRenderer:function(t){var e=this,n=e.extension("renderer",t.name);if(null!=n){void 0!==t.wheelSensitivity&&Lv("You have set a custom wheel sensitivity.  This will make your app zoom unnaturally when using mainstream mice.  You should change this value from the default only if you can guarantee that all your users will use the same hardware and OS configuration as your current machine.");var i=zR(t);i.cy=e,e._private.renderer=new n(i),this.notify("init")}else Dv("Can not initialise: No such renderer `".concat(t.name,"` found. Did you forget to import it and `cytoscape.use()` it?"))},destroyRenderer:function(){var t=this;t.notify("destroy");var e=t.container();if(e)for(e._cyreg=null;e.childNodes.length>0;)e.removeChild(e.childNodes[0]);t._private.renderer=null,t.mutableElements().forEach((function(t){var e=t._private;e.rscratch={},e.rstyle={},e.animation.current=[],e.animation.queue=[]}))},onRender:function(t){return this.on("render",t)},offRender:function(t){return this.off("render",t)}};XR.invalidateDimensions=XR.resize;var jR={collection:function(t,e){return H_(t)?this.$(t):X_(t)?t.collection():V_(t)?new CR(this,t,e):new CR(this)},nodes:function(t){var e=this.$((function(t){return t.isNode()}));return t?e.filter(t):e},edges:function(t){var e=this.$((function(t){return t.isEdge()}));return t?e.filter(t):e},$:function(t){var e=this._private.elements;return t?e.filter(t):e.spawnSelf()},mutableElements:function(){return this._private.elements}};jR.elements=jR.filter=jR.$;var YR={};YR.apply=function(t){for(var e=this,n=e._private.cy.collection(),i=0;i<t.length;i++){var o=t[i],r=e.getContextMeta(o);if(!r.empty){var s=e.getContextStyle(r),a=e.applyContextStyle(r,s,o);o._private.appliedInitStyle?e.updateTransitions(o,a.diffProps):o._private.appliedInitStyle=!0,e.updateStyleHints(o)&&n.push(o)}}return n},YR.getPropertiesDiff=function(t,e){var n=this,i=n._private.propDiffs=n._private.propDiffs||{},o=t+"-"+e,r=i[o];if(r)return r;for(var s=[],a={},l=0;l<n.length;l++){var c=n[l],d="t"===t[l],u="t"===e[l],h=d!==u,p=c.mappedProperties.length>0;if(h||u&&p){var g=void 0;h&&p||h?g=c.properties:p&&(g=c.mappedProperties);for(var f=0;f<g.length;f++){for(var m=g[f],_=m.name,v=!1,y=l+1;y<n.length;y++){var b=n[y];if("t"===e[y]&&(v=null!=b.properties[m.name]))break}a[_]||v||(a[_]=!0,s.push(_))}}}return i[o]=s,s},YR.getContextMeta=function(t){for(var e,n=this,i="",o=t._private.styleCxtKey||"",r=0;r<n.length;r++){var s=n[r];i+=s.selector&&s.selector.matches(t)?"t":"f"}return e=n.getPropertiesDiff(o,i),t._private.styleCxtKey=i,{key:i,diffPropNames:e,empty:0===e.length}},YR.getContextStyle=function(t){var e=t.key,n=this._private.contextStyles=this._private.contextStyles||{};if(n[e])return n[e];for(var i={_private:{key:e}},o=0;o<this.length;o++){var r=this[o];if("t"===e[o])for(var s=0;s<r.properties.length;s++){var a=r.properties[s];i[a.name]=a}}return n[e]=i,i},YR.applyContextStyle=function(t,e,n){for(var i=t.diffPropNames,o={},r=this.types,s=0;s<i.length;s++){var a=i[s],l=e[a],c=n.pstyle(a);if(!l){if(!c)continue;l=c.bypass?{name:a,deleteBypassed:!0}:{name:a,delete:!0}}if(c!==l){if(l.mapped===r.fn&&null!=c&&null!=c.mapping&&c.mapping.value===l.value){var d=c.mapping;if((d.fnValue=l.value(n))===d.prevFnValue)continue}var u=o[a]={prev:c};this.applyParsedProperty(n,l),u.next=n.pstyle(a),u.next&&u.next.bypass&&(u.next=u.next.bypassed)}}return{diffProps:o}},YR.updateStyleHints=function(t){var e=t._private,n=this,i=n.propertyGroupNames,o=n.propertyGroupKeys,r=function(t,e,i){return n.getPropertiesHash(t,e,i)},s=e.styleKey;if(t.removed())return!1;var a="nodes"===e.group,l=t._private.style;i=Object.keys(l);for(var c=0;c<o.length;c++){var d=o[c];e.styleKeys[d]=[9261,5381]}for(var u,h=function(t,n){return e.styleKeys[n][0]=_v(t,e.styleKeys[n][0])},p=function(t,n){return e.styleKeys[n][1]=vv(t,e.styleKeys[n][1])},g=function(t,e){h(t,e),p(t,e)},f=function(t,e){for(var n=0;n<t.length;n++){var i=t.charCodeAt(n);h(i,e),p(i,e)}},m=0;m<i.length;m++){var _=i[m],v=l[_];if(null!=v){var y=this.properties[_],b=y.type,E=y.groupKey,T=void 0;null!=y.hashOverride?T=y.hashOverride(t,v):null!=v.pfValue&&(T=v.pfValue);var R=null==y.enums?v.value:null,C=null!=T,x=C||null!=R,S=v.units;if(b.number&&x&&!b.multiple)g(-128<(u=C?T:R)&&u<128&&Math.floor(u)!==u?2e9-(1024*u|0):u,E),C||null==S||f(S,E);else f(v.strValue,E)}}for(var I,O,k=[9261,5381],w=0;w<o.length;w++){var A=o[w],D=e.styleKeys[A];k[0]=_v(D[0],k[0]),k[1]=vv(D[1],k[1])}e.styleKey=(I=k[0],O=k[1],2097152*I+O);var N=e.styleKeys;e.labelDimsKey=yv(N.labelDimensions);var L=r(t,["label"],N.labelDimensions);if(e.labelKey=yv(L),e.labelStyleKey=yv(bv(N.commonLabel,L)),!a){var P=r(t,["source-label"],N.labelDimensions);e.sourceLabelKey=yv(P),e.sourceLabelStyleKey=yv(bv(N.commonLabel,P));var M=r(t,["target-label"],N.labelDimensions);e.targetLabelKey=yv(M),e.targetLabelStyleKey=yv(bv(N.commonLabel,M))}if(a){var B=e.styleKeys,F=B.nodeBody,H=B.nodeBorder,U=B.backgroundImage,V=B.compound,G=B.pie,W=[F,H,U,V,G].filter((function(t){return null!=t})).reduce(bv,[9261,5381]);e.nodeKey=yv(W),e.hasPie=null!=G&&9261!==G[0]&&5381!==G[1]}return s!==e.styleKey},YR.clearStyleHints=function(t){var e=t._private;e.styleCxtKey="",e.styleKeys={},e.styleKey=null,e.labelKey=null,e.labelStyleKey=null,e.sourceLabelKey=null,e.sourceLabelStyleKey=null,e.targetLabelKey=null,e.targetLabelStyleKey=null,e.nodeKey=null,e.hasPie=null},YR.applyParsedProperty=function(t,e){var n,i=this,o=e,r=t._private.style,s=i.types,a=i.properties[o.name].type,l=o.bypass,c=r[o.name],d=c&&c.bypass,u=t._private,h="mapping",p=function(t){return null==t?null:null!=t.pfValue?t.pfValue:t.value},g=function(){var e=p(c),n=p(o);i.checkTriggers(t,o.name,e,n)};if(o&&"pie"===o.name.substr(0,3)&&Lv("The pie style properties are deprecated.  Create charts using background images instead."),"curve-style"===e.name&&t.isEdge()&&("bezier"!==e.value&&t.isLoop()||"haystack"===e.value&&(t.source().isParent()||t.target().isParent()))&&(o=e=this.parse(e.name,"bezier",l)),o.delete)return r[o.name]=void 0,g(),!0;if(o.deleteBypassed)return c?!!c.bypass&&(c.bypassed=void 0,g(),!0):(g(),!0);if(o.deleteBypass)return c?!!c.bypass&&(r[o.name]=c.bypassed,g(),!0):(g(),!0);var f=function(){Lv("Do not assign mappings to elements without corresponding data (i.e. ele `"+t.id()+"` has no mapping for property `"+o.name+"` with data field `"+o.field+"`); try a `["+o.field+"]` selector to limit scope to elements with `"+o.field+"` defined")};switch(o.mapped){case s.mapData:for(var m,_=o.field.split("."),v=u.data,y=0;y<_.length&&v;y++){v=v[_[y]]}if(null==v)return f(),!1;if(!W_(v))return Lv("Do not use continuous mappers without specifying numeric data (i.e. `"+o.field+": "+v+"` for `"+t.id()+"` is non-numeric)"),!1;var b=o.fieldMax-o.fieldMin;if((m=0===b?0:(v-o.fieldMin)/b)<0?m=0:m>1&&(m=1),a.color){var E=o.valueMin[0],T=o.valueMax[0],R=o.valueMin[1],C=o.valueMax[1],x=o.valueMin[2],S=o.valueMax[2],I=null==o.valueMin[3]?1:o.valueMin[3],O=null==o.valueMax[3]?1:o.valueMax[3],k=[Math.round(E+(T-E)*m),Math.round(R+(C-R)*m),Math.round(x+(S-x)*m),Math.round(I+(O-I)*m)];n={bypass:o.bypass,name:o.name,value:k,strValue:"rgb("+k[0]+", "+k[1]+", "+k[2]+")"}}else{if(!a.number)return!1;var w=o.valueMin+(o.valueMax-o.valueMin)*m;n=this.parse(o.name,w,o.bypass,h)}if(!n)return f(),!1;n.mapping=o,o=n;break;case s.data:for(var A=o.field.split("."),D=u.data,N=0;N<A.length&&D;N++){D=D[A[N]]}if(null!=D&&(n=this.parse(o.name,D,o.bypass,h)),!n)return f(),!1;n.mapping=o,o=n;break;case s.fn:var L=o.value,P=null!=o.fnValue?o.fnValue:L(t);if(o.prevFnValue=P,null==P)return Lv("Custom function mappers may not return null (i.e. `"+o.name+"` for ele `"+t.id()+"` is null)"),!1;if(!(n=this.parse(o.name,P,o.bypass,h)))return Lv("Custom function mappers may not return invalid values for the property type (i.e. `"+o.name+"` for ele `"+t.id()+"` is invalid)"),!1;n.mapping=Pv(o),o=n;break;case void 0:break;default:return!1}return l?(o.bypassed=d?c.bypassed:c,r[o.name]=o):d?c.bypassed=o:r[o.name]=o,g(),!0},YR.cleanElements=function(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(this.clearStyleHints(i),i.dirtyCompoundBoundsCache(),i.dirtyBoundingBoxCache(),e)for(var o=i._private.style,r=Object.keys(o),s=0;s<r.length;s++){var a=r[s],l=o[a];null!=l&&(l.bypass?l.bypassed=null:o[a]=null)}else i._private.style={}}},YR.update=function(){this._private.cy.mutableElements().updateStyle()},YR.updateTransitions=function(t,e){var n=this,i=t._private,o=t.pstyle("transition-property").value,r=t.pstyle("transition-duration").pfValue,s=t.pstyle("transition-delay").pfValue;if(o.length>0&&r>0){for(var a={},l=!1,c=0;c<o.length;c++){var d=o[c],u=t.pstyle(d),h=e[d];if(h){var p=h.prev,g=null!=h.next?h.next:u,f=!1,m=void 0,_=1e-6;p&&(W_(p.pfValue)&&W_(g.pfValue)?(f=g.pfValue-p.pfValue,m=p.pfValue+_*f):W_(p.value)&&W_(g.value)?(f=g.value-p.value,m=p.value+_*f):V_(p.value)&&V_(g.value)&&(f=p.value[0]!==g.value[0]||p.value[1]!==g.value[1]||p.value[2]!==g.value[2],m=p.strValue),f&&(a[d]=g.strValue,this.applyBypass(t,d,m),l=!0))}}if(!l)return;i.transitioning=!0,new aE((function(e){s>0?t.delayAnimation(s).play().promise().then(e):e()})).then((function(){return t.animation({style:a,duration:r,easing:t.pstyle("transition-timing-function").value,queue:!1}).play().promise()})).then((function(){n.removeBypasses(t,o),t.emitAndNotify("style"),i.transitioning=!1}))}else i.transitioning&&(this.removeBypasses(t,o),t.emitAndNotify("style"),i.transitioning=!1)},YR.checkTrigger=function(t,e,n,i,o,r){var s=this.properties[e],a=o(s);null!=a&&a(n,i)&&r(s)},YR.checkZOrderTrigger=function(t,e,n,i){var o=this;this.checkTrigger(t,e,n,i,(function(t){return t.triggersZOrder}),(function(){o._private.cy.notify("zorder",t)}))},YR.checkBoundsTrigger=function(t,e,n,i){this.checkTrigger(t,e,n,i,(function(t){return t.triggersBounds}),(function(o){t.dirtyCompoundBoundsCache(),t.dirtyBoundingBoxCache(),"curve-style"!==e||"bezier"!==n&&"bezier"!==i||!o.triggersBoundsOfParallelBeziers||t.parallelEdges().forEach((function(t){t.isBundledBezier()&&t.dirtyBoundingBoxCache()}))}))},YR.checkTriggers=function(t,e,n,i){t.dirtyStyleCache(),this.checkZOrderTrigger(t,e,n,i),this.checkBoundsTrigger(t,e,n,i)};var KR={applyBypass:function(t,e,n,i){var o=[];if("*"===e||"**"===e){if(void 0!==n)for(var r=0;r<this.properties.length;r++){var s=this.properties[r].name,a=this.parse(s,n,!0);a&&o.push(a)}}else if(H_(e)){var l=this.parse(e,n,!0);l&&o.push(l)}else{if(!G_(e))return!1;var c=e;i=n;for(var d=Object.keys(c),u=0;u<d.length;u++){var h=d[u],p=c[h];if(void 0===p&&(p=c[tv(h)]),void 0!==p){var g=this.parse(h,p,!0);g&&o.push(g)}}}if(0===o.length)return!1;for(var f=!1,m=0;m<t.length;m++){for(var _=t[m],v={},y=void 0,b=0;b<o.length;b++){var E=o[b];if(i){var T=_.pstyle(E.name);y=v[E.name]={prev:T}}f=this.applyParsedProperty(_,Pv(E))||f,i&&(y.next=_.pstyle(E.name))}f&&this.updateStyleHints(_),i&&this.updateTransitions(_,v,true)}return f},overrideBypass:function(t,e,n){e=Q_(e);for(var i=0;i<t.length;i++){var o=t[i],r=o._private.style[e],s=this.properties[e].type,a=s.color,l=s.mutiple,c=r?null!=r.pfValue?r.pfValue:r.value:null;r&&r.bypass?(r.value=n,null!=r.pfValue&&(r.pfValue=n),r.strValue=a?"rgb("+n.join(",")+")":l?n.join(" "):""+n,this.updateStyleHints(o)):this.applyBypass(o,e,n),this.checkTriggers(o,e,c,n)}},removeAllBypasses:function(t,e){return this.removeBypasses(t,this.propertyNames,e)},removeBypasses:function(t,e,n){for(var i=0;i<t.length;i++){for(var o=t[i],r={},s=0;s<e.length;s++){var a=e[s],l=this.properties[a],c=o.pstyle(l.name);if(c&&c.bypass){var d=this.parse(a,"",!0),u=r[l.name]={prev:c};this.applyParsedProperty(o,d),u.next=o.pstyle(l.name)}}this.updateStyleHints(o),n&&this.updateTransitions(o,r,true)}}},$R={getEmSizeInPixels:function(){var t=this.containerCss("font-size");return null!=t?parseFloat(t):1},containerCss:function(t){var e=this._private.cy.container();if(D_&&e&&D_.getComputedStyle)return D_.getComputedStyle(e).getPropertyValue(t)}},JR={getRenderedStyle:function(t,e){return e?this.getStylePropertyValue(t,e,!0):this.getRawStyle(t,!0)},getRawStyle:function(t,e){var n=this;if(t=t[0]){for(var i={},o=0;o<n.properties.length;o++){var r=n.properties[o],s=n.getStylePropertyValue(t,r.name,e);null!=s&&(i[r.name]=s,i[tv(r.name)]=s)}return i}},getIndexedStyle:function(t,e,n,i){var o=t.pstyle(e)[n][i];return null!=o?o:t.cy().style().getDefaultProperty(e)[n][0]},getStylePropertyValue:function(t,e,n){if(t=t[0]){var i=this.properties[e];i.alias&&(i=i.pointsTo);var o=i.type,r=t.pstyle(i.name);if(r){var s=r.value,a=r.units,l=r.strValue;if(n&&o.number&&null!=s&&W_(s)){var c=t.cy().zoom(),d=function(t){return t*c},u=function(t,e){return d(t)+e},h=V_(s);return(h?a.every((function(t){return null!=t})):null!=a)?h?s.map((function(t,e){return u(t,a[e])})).join(" "):u(s,a):h?s.map((function(t){return H_(t)?t:""+d(t)})).join(" "):""+d(s)}if(null!=l)return l}return null}},getAnimationStartStyle:function(t,e){for(var n={},i=0;i<e.length;i++){var o=e[i].name,r=t.pstyle(o);void 0!==r&&(r=G_(r)?this.parse(o,r.strValue):this.parse(o,r)),r&&(n[o]=r)}return n},getPropsList:function(t){var e=[],n=t,i=this.properties;if(n)for(var o=Object.keys(n),r=0;r<o.length;r++){var s=o[r],a=n[s],l=i[s]||i[Q_(s)],c=this.parse(l.name,a);c&&e.push(c)}return e},getNonDefaultPropertiesHash:function(t,e,n){var i,o,r,s,a,l,c=n.slice();for(a=0;a<e.length;a++)if(i=e[a],null!=(o=t.pstyle(i,!1)))if(null!=o.pfValue)c[0]=_v(s,c[0]),c[1]=vv(s,c[1]);else for(r=o.strValue,l=0;l<r.length;l++)s=r.charCodeAt(l),c[0]=_v(s,c[0]),c[1]=vv(s,c[1]);return c}};JR.getPropertiesHash=JR.getNonDefaultPropertiesHash;var qR={appendFromJson:function(t){for(var e=this,n=0;n<t.length;n++){var i=t[n],o=i.selector,r=i.style||i.css,s=Object.keys(r);e.selector(o);for(var a=0;a<s.length;a++){var l=s[a],c=r[l];e.css(l,c)}}return e},fromJson:function(t){var e=this;return e.resetToDefault(),e.appendFromJson(t),e},json:function(){for(var t=[],e=this.defaultLength;e<this.length;e++){for(var n=this[e],i=n.selector,o=n.properties,r={},s=0;s<o.length;s++){var a=o[s];r[a.name]=a.strValue}t.push({selector:i?i.toString():"core",style:r})}return t}},ZR={appendFromString:function(t){var e,n,i,o=this,r=""+t;function s(){r=r.length>e.length?r.substr(e.length):""}function a(){n=n.length>i.length?n.substr(i.length):""}for(r=r.replace(/[/][*](\s|.)+?[*][/]/g,"");;){if(r.match(/^\s*$/))break;var l=r.match(/^\s*((?:.|\s)+?)\s*\{((?:.|\s)+?)\}/);if(!l){Lv("Halting stylesheet parsing: String stylesheet contains more to parse but no selector and block found in: "+r);break}e=l[0];var c=l[1];if("core"!==c)if(new YE(c).invalid){Lv("Skipping parsing of block: Invalid selector found in string stylesheet: "+c),s();continue}var d=l[2],u=!1;n=d;for(var h=[];;){if(n.match(/^\s*$/))break;var p=n.match(/^\s*(.+?)\s*:\s*(.+?)\s*;/);if(!p){Lv("Skipping parsing of block: Invalid formatting of style property and value definitions found in:"+d),u=!0;break}i=p[0];var g=p[1],f=p[2];if(this.properties[g])o.parse(g,f)?(h.push({name:g,val:f}),a()):(Lv("Skipping property: Invalid property definition in: "+i),a());else Lv("Skipping property: Invalid property name in: "+i),a()}if(u){s();break}o.selector(c);for(var m=0;m<h.length;m++){var _=h[m];o.css(_.name,_.val)}s()}return o},fromString:function(t){var e=this;return e.resetToDefault(),e.appendFromString(t),e}},QR={};!function(){var t=iv,e=function(t){return"^"+t+"\\s*\\(\\s*([\\w\\.]+)\\s*\\)$"},n=function(e){var n=t+"|\\w+|rgb[a]?\\((?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)(?:\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))))?\\)|hsl[a]?\\((?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?)))\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%])\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%])(?:\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))))?\\)|\\#[0-9a-fA-F]{3}|\\#[0-9a-fA-F]{6}";return"^"+e+"\\s*\\(([\\w\\.]+)\\s*\\,\\s*("+t+")\\s*\\,\\s*("+t+")\\s*,\\s*("+n+")\\s*\\,\\s*("+n+")\\)$"},i=["^url\\s*\\(\\s*['\"]?(.+?)['\"]?\\s*\\)$","^(none)$","^(.+)$"];QR.types={time:{number:!0,min:0,units:"s|ms",implicitUnits:"ms"},percent:{number:!0,min:0,max:100,units:"%",implicitUnits:"%"},percentages:{number:!0,min:0,max:100,units:"%",implicitUnits:"%",multiple:!0},zeroOneNumber:{number:!0,min:0,max:1,unitless:!0},zeroOneNumbers:{number:!0,min:0,max:1,unitless:!0,multiple:!0},nOneOneNumber:{number:!0,min:-1,max:1,unitless:!0},nonNegativeInt:{number:!0,min:0,integer:!0,unitless:!0},position:{enums:["parent","origin"]},nodeSize:{number:!0,min:0,enums:["label"]},number:{number:!0,unitless:!0},numbers:{number:!0,unitless:!0,multiple:!0},positiveNumber:{number:!0,unitless:!0,min:0,strictMin:!0},size:{number:!0,min:0},bidirectionalSize:{number:!0},bidirectionalSizeMaybePercent:{number:!0,allowPercent:!0},bidirectionalSizes:{number:!0,multiple:!0},sizeMaybePercent:{number:!0,min:0,allowPercent:!0},axisDirection:{enums:["horizontal","leftward","rightward","vertical","upward","downward","auto"]},paddingRelativeTo:{enums:["width","height","average","min","max"]},bgWH:{number:!0,min:0,allowPercent:!0,enums:["auto"],multiple:!0},bgPos:{number:!0,allowPercent:!0,multiple:!0},bgRelativeTo:{enums:["inner","include-padding"],multiple:!0},bgRepeat:{enums:["repeat","repeat-x","repeat-y","no-repeat"],multiple:!0},bgFit:{enums:["none","contain","cover"],multiple:!0},bgCrossOrigin:{enums:["anonymous","use-credentials"],multiple:!0},bgClip:{enums:["none","node"],multiple:!0},bgContainment:{enums:["inside","over"],multiple:!0},color:{color:!0},colors:{color:!0,multiple:!0},fill:{enums:["solid","linear-gradient","radial-gradient"]},bool:{enums:["yes","no"]},bools:{enums:["yes","no"],multiple:!0},lineStyle:{enums:["solid","dotted","dashed"]},lineCap:{enums:["butt","round","square"]},borderStyle:{enums:["solid","dotted","dashed","double"]},curveStyle:{enums:["bezier","unbundled-bezier","haystack","segments","straight","taxi"]},fontFamily:{regex:'^([\\w- \\"]+(?:\\s*,\\s*[\\w- \\"]+)*)$'},fontStyle:{enums:["italic","normal","oblique"]},fontWeight:{enums:["normal","bold","bolder","lighter","100","200","300","400","500","600","800","900",100,200,300,400,500,600,700,800,900]},textDecoration:{enums:["none","underline","overline","line-through"]},textTransform:{enums:["none","uppercase","lowercase"]},textWrap:{enums:["none","wrap","ellipsis"]},textOverflowWrap:{enums:["whitespace","anywhere"]},textBackgroundShape:{enums:["rectangle","roundrectangle","round-rectangle"]},nodeShape:{enums:["rectangle","roundrectangle","round-rectangle","cutrectangle","cut-rectangle","bottomroundrectangle","bottom-round-rectangle","barrel","ellipse","triangle","round-triangle","square","pentagon","round-pentagon","hexagon","round-hexagon","concavehexagon","concave-hexagon","heptagon","round-heptagon","octagon","round-octagon","tag","round-tag","star","diamond","round-diamond","vee","rhomboid","polygon"]},compoundIncludeLabels:{enums:["include","exclude"]},arrowShape:{enums:["tee","triangle","triangle-tee","circle-triangle","triangle-cross","triangle-backcurve","vee","square","circle","diamond","chevron","none"]},arrowFill:{enums:["filled","hollow"]},display:{enums:["element","none"]},visibility:{enums:["hidden","visible"]},zCompoundDepth:{enums:["bottom","orphan","auto","top"]},zIndexCompare:{enums:["auto","manual"]},valign:{enums:["top","center","bottom"]},halign:{enums:["left","center","right"]},justification:{enums:["left","center","right","auto"]},text:{string:!0},data:{mapping:!0,regex:e("data")},layoutData:{mapping:!0,regex:e("layoutData")},scratch:{mapping:!0,regex:e("scratch")},mapData:{mapping:!0,regex:n("mapData")},mapLayoutData:{mapping:!0,regex:n("mapLayoutData")},mapScratch:{mapping:!0,regex:n("mapScratch")},fn:{mapping:!0,fn:!0},url:{regexes:i,singleRegexMatchValue:!0},urls:{regexes:i,singleRegexMatchValue:!0,multiple:!0},propList:{propList:!0},angle:{number:!0,units:"deg|rad",implicitUnits:"rad"},textRotation:{number:!0,units:"deg|rad",implicitUnits:"rad",enums:["none","autorotate"]},polygonPointList:{number:!0,multiple:!0,evenMultiple:!0,min:-1,max:1,unitless:!0},edgeDistances:{enums:["intersection","node-position"]},edgeEndpoint:{number:!0,multiple:!0,units:"%|px|em|deg|rad",implicitUnits:"px",enums:["inside-to-node","outside-to-node","outside-to-node-or-label","outside-to-line","outside-to-line-or-label"],singleEnum:!0,validate:function(t,e){switch(t.length){case 2:return"deg"!==e[0]&&"rad"!==e[0]&&"deg"!==e[1]&&"rad"!==e[1];case 1:return H_(t[0])||"deg"===e[0]||"rad"===e[0];default:return!1}}},easing:{regexes:["^(spring)\\s*\\(\\s*("+t+")\\s*,\\s*("+t+")\\s*\\)$","^(cubic-bezier)\\s*\\(\\s*("+t+")\\s*,\\s*("+t+")\\s*,\\s*("+t+")\\s*,\\s*("+t+")\\s*\\)$"],enums:["linear","ease","ease-in","ease-out","ease-in-out","ease-in-sine","ease-out-sine","ease-in-out-sine","ease-in-quad","ease-out-quad","ease-in-out-quad","ease-in-cubic","ease-out-cubic","ease-in-out-cubic","ease-in-quart","ease-out-quart","ease-in-out-quart","ease-in-quint","ease-out-quint","ease-in-out-quint","ease-in-expo","ease-out-expo","ease-in-out-expo","ease-in-circ","ease-out-circ","ease-in-out-circ"]},gradientDirection:{enums:["to-bottom","to-top","to-left","to-right","to-bottom-right","to-bottom-left","to-top-right","to-top-left","to-right-bottom","to-left-bottom","to-right-top","to-left-top"]},boundsExpansion:{number:!0,multiple:!0,min:0,validate:function(t){var e=t.length;return 1===e||2===e||4===e}}};var o={zeroNonZero:function(t,e){return(null==t||null==e)&&t!==e||(0==t&&0!=e||0!=t&&0==e)},any:function(t,e){return t!=e},emptyNonEmpty:function(t,e){var n=J_(t),i=J_(e);return n&&!i||!n&&i}},r=QR.types,s=[{name:"label",type:r.text,triggersBounds:o.any,triggersZOrder:o.emptyNonEmpty},{name:"text-rotation",type:r.textRotation,triggersBounds:o.any},{name:"text-margin-x",type:r.bidirectionalSize,triggersBounds:o.any},{name:"text-margin-y",type:r.bidirectionalSize,triggersBounds:o.any}],a=[{name:"source-label",type:r.text,triggersBounds:o.any},{name:"source-text-rotation",type:r.textRotation,triggersBounds:o.any},{name:"source-text-margin-x",type:r.bidirectionalSize,triggersBounds:o.any},{name:"source-text-margin-y",type:r.bidirectionalSize,triggersBounds:o.any},{name:"source-text-offset",type:r.size,triggersBounds:o.any}],l=[{name:"target-label",type:r.text,triggersBounds:o.any},{name:"target-text-rotation",type:r.textRotation,triggersBounds:o.any},{name:"target-text-margin-x",type:r.bidirectionalSize,triggersBounds:o.any},{name:"target-text-margin-y",type:r.bidirectionalSize,triggersBounds:o.any},{name:"target-text-offset",type:r.size,triggersBounds:o.any}],c=[{name:"font-family",type:r.fontFamily,triggersBounds:o.any},{name:"font-style",type:r.fontStyle,triggersBounds:o.any},{name:"font-weight",type:r.fontWeight,triggersBounds:o.any},{name:"font-size",type:r.size,triggersBounds:o.any},{name:"text-transform",type:r.textTransform,triggersBounds:o.any},{name:"text-wrap",type:r.textWrap,triggersBounds:o.any},{name:"text-overflow-wrap",type:r.textOverflowWrap,triggersBounds:o.any},{name:"text-max-width",type:r.size,triggersBounds:o.any},{name:"text-outline-width",type:r.size,triggersBounds:o.any},{name:"line-height",type:r.positiveNumber,triggersBounds:o.any}],d=[{name:"text-valign",type:r.valign,triggersBounds:o.any},{name:"text-halign",type:r.halign,triggersBounds:o.any},{name:"color",type:r.color},{name:"text-outline-color",type:r.color},{name:"text-outline-opacity",type:r.zeroOneNumber},{name:"text-background-color",type:r.color},{name:"text-background-opacity",type:r.zeroOneNumber},{name:"text-background-padding",type:r.size,triggersBounds:o.any},{name:"text-border-opacity",type:r.zeroOneNumber},{name:"text-border-color",type:r.color},{name:"text-border-width",type:r.size,triggersBounds:o.any},{name:"text-border-style",type:r.borderStyle,triggersBounds:o.any},{name:"text-background-shape",type:r.textBackgroundShape,triggersBounds:o.any},{name:"text-justification",type:r.justification}],u=[{name:"events",type:r.bool},{name:"text-events",type:r.bool}],h=[{name:"display",type:r.display,triggersZOrder:o.any,triggersBounds:o.any,triggersBoundsOfParallelBeziers:!0},{name:"visibility",type:r.visibility,triggersZOrder:o.any},{name:"opacity",type:r.zeroOneNumber,triggersZOrder:o.zeroNonZero},{name:"text-opacity",type:r.zeroOneNumber},{name:"min-zoomed-font-size",type:r.size},{name:"z-compound-depth",type:r.zCompoundDepth,triggersZOrder:o.any},{name:"z-index-compare",type:r.zIndexCompare,triggersZOrder:o.any},{name:"z-index",type:r.nonNegativeInt,triggersZOrder:o.any}],p=[{name:"overlay-padding",type:r.size,triggersBounds:o.any},{name:"overlay-color",type:r.color},{name:"overlay-opacity",type:r.zeroOneNumber,triggersBounds:o.zeroNonZero}],g=[{name:"transition-property",type:r.propList},{name:"transition-duration",type:r.time},{name:"transition-delay",type:r.time},{name:"transition-timing-function",type:r.easing}],f=function(t,e){return"label"===e.value?-t.poolIndex():e.pfValue},m=[{name:"height",type:r.nodeSize,triggersBounds:o.any,hashOverride:f},{name:"width",type:r.nodeSize,triggersBounds:o.any,hashOverride:f},{name:"shape",type:r.nodeShape,triggersBounds:o.any},{name:"shape-polygon-points",type:r.polygonPointList,triggersBounds:o.any},{name:"background-color",type:r.color},{name:"background-fill",type:r.fill},{name:"background-opacity",type:r.zeroOneNumber},{name:"background-blacken",type:r.nOneOneNumber},{name:"background-gradient-stop-colors",type:r.colors},{name:"background-gradient-stop-positions",type:r.percentages},{name:"background-gradient-direction",type:r.gradientDirection},{name:"padding",type:r.sizeMaybePercent,triggersBounds:o.any},{name:"padding-relative-to",type:r.paddingRelativeTo,triggersBounds:o.any},{name:"bounds-expansion",type:r.boundsExpansion,triggersBounds:o.any}],_=[{name:"border-color",type:r.color},{name:"border-opacity",type:r.zeroOneNumber},{name:"border-width",type:r.size,triggersBounds:o.any},{name:"border-style",type:r.borderStyle}],v=[{name:"background-image",type:r.urls},{name:"background-image-crossorigin",type:r.bgCrossOrigin},{name:"background-image-opacity",type:r.zeroOneNumbers},{name:"background-image-containment",type:r.bgContainment},{name:"background-image-smoothing",type:r.bools},{name:"background-position-x",type:r.bgPos},{name:"background-position-y",type:r.bgPos},{name:"background-width-relative-to",type:r.bgRelativeTo},{name:"background-height-relative-to",type:r.bgRelativeTo},{name:"background-repeat",type:r.bgRepeat},{name:"background-fit",type:r.bgFit},{name:"background-clip",type:r.bgClip},{name:"background-width",type:r.bgWH},{name:"background-height",type:r.bgWH},{name:"background-offset-x",type:r.bgPos},{name:"background-offset-y",type:r.bgPos}],y=[{name:"position",type:r.position,triggersBounds:o.any},{name:"compound-sizing-wrt-labels",type:r.compoundIncludeLabels,triggersBounds:o.any},{name:"min-width",type:r.size,triggersBounds:o.any},{name:"min-width-bias-left",type:r.sizeMaybePercent,triggersBounds:o.any},{name:"min-width-bias-right",type:r.sizeMaybePercent,triggersBounds:o.any},{name:"min-height",type:r.size,triggersBounds:o.any},{name:"min-height-bias-top",type:r.sizeMaybePercent,triggersBounds:o.any},{name:"min-height-bias-bottom",type:r.sizeMaybePercent,triggersBounds:o.any}],b=[{name:"line-style",type:r.lineStyle},{name:"line-color",type:r.color},{name:"line-fill",type:r.fill},{name:"line-cap",type:r.lineCap},{name:"line-opacity",type:r.zeroOneNumber},{name:"line-dash-pattern",type:r.numbers},{name:"line-dash-offset",type:r.number},{name:"line-gradient-stop-colors",type:r.colors},{name:"line-gradient-stop-positions",type:r.percentages},{name:"curve-style",type:r.curveStyle,triggersBounds:o.any,triggersBoundsOfParallelBeziers:!0},{name:"haystack-radius",type:r.zeroOneNumber,triggersBounds:o.any},{name:"source-endpoint",type:r.edgeEndpoint,triggersBounds:o.any},{name:"target-endpoint",type:r.edgeEndpoint,triggersBounds:o.any},{name:"control-point-step-size",type:r.size,triggersBounds:o.any},{name:"control-point-distances",type:r.bidirectionalSizes,triggersBounds:o.any},{name:"control-point-weights",type:r.numbers,triggersBounds:o.any},{name:"segment-distances",type:r.bidirectionalSizes,triggersBounds:o.any},{name:"segment-weights",type:r.numbers,triggersBounds:o.any},{name:"taxi-turn",type:r.bidirectionalSizeMaybePercent,triggersBounds:o.any},{name:"taxi-turn-min-distance",type:r.size,triggersBounds:o.any},{name:"taxi-direction",type:r.axisDirection,triggersBounds:o.any},{name:"edge-distances",type:r.edgeDistances,triggersBounds:o.any},{name:"arrow-scale",type:r.positiveNumber,triggersBounds:o.any},{name:"loop-direction",type:r.angle,triggersBounds:o.any},{name:"loop-sweep",type:r.angle,triggersBounds:o.any},{name:"source-distance-from-node",type:r.size,triggersBounds:o.any},{name:"target-distance-from-node",type:r.size,triggersBounds:o.any}],E=[{name:"ghost",type:r.bool,triggersBounds:o.any},{name:"ghost-offset-x",type:r.bidirectionalSize,triggersBounds:o.any},{name:"ghost-offset-y",type:r.bidirectionalSize,triggersBounds:o.any},{name:"ghost-opacity",type:r.zeroOneNumber}],T=[{name:"selection-box-color",type:r.color},{name:"selection-box-opacity",type:r.zeroOneNumber},{name:"selection-box-border-color",type:r.color},{name:"selection-box-border-width",type:r.size},{name:"active-bg-color",type:r.color},{name:"active-bg-opacity",type:r.zeroOneNumber},{name:"active-bg-size",type:r.size},{name:"outside-texture-bg-color",type:r.color},{name:"outside-texture-bg-opacity",type:r.zeroOneNumber}],R=[];QR.pieBackgroundN=16,R.push({name:"pie-size",type:r.sizeMaybePercent});for(var C=1;C<=QR.pieBackgroundN;C++)R.push({name:"pie-"+C+"-background-color",type:r.color}),R.push({name:"pie-"+C+"-background-size",type:r.percent}),R.push({name:"pie-"+C+"-background-opacity",type:r.zeroOneNumber});var x=[],S=QR.arrowPrefixes=["source","mid-source","target","mid-target"];[{name:"arrow-shape",type:r.arrowShape,triggersBounds:o.any},{name:"arrow-color",type:r.color},{name:"arrow-fill",type:r.arrowFill}].forEach((function(t){S.forEach((function(e){var n=e+"-"+t.name,i=t.type,o=t.triggersBounds;x.push({name:n,type:i,triggersBounds:o})}))}),{});var I=QR.properties=[].concat(u,g,h,p,E,d,c,s,a,l,m,_,v,R,y,b,x,T),O=QR.propertyGroups={behavior:u,transition:g,visibility:h,overlay:p,ghost:E,commonLabel:d,labelDimensions:c,mainLabel:s,sourceLabel:a,targetLabel:l,nodeBody:m,nodeBorder:_,backgroundImage:v,pie:R,compound:y,edgeLine:b,edgeArrow:x,core:T},k=QR.propertyGroupNames={};(QR.propertyGroupKeys=Object.keys(O)).forEach((function(t){k[t]=O[t].map((function(t){return t.name})),O[t].forEach((function(e){return e.groupKey=t}))}));var w=QR.aliases=[{name:"content",pointsTo:"label"},{name:"control-point-distance",pointsTo:"control-point-distances"},{name:"control-point-weight",pointsTo:"control-point-weights"},{name:"edge-text-rotation",pointsTo:"text-rotation"},{name:"padding-left",pointsTo:"padding"},{name:"padding-right",pointsTo:"padding"},{name:"padding-top",pointsTo:"padding"},{name:"padding-bottom",pointsTo:"padding"}];QR.propertyNames=I.map((function(t){return t.name}));for(var A=0;A<I.length;A++){var D=I[A];I[D.name]=D}for(var N=0;N<w.length;N++){var L=w[N],P=I[L.pointsTo],M={name:L.name,alias:!0,pointsTo:P};I.push(M),I[L.name]=M}}(),QR.getDefaultProperty=function(t){return this.getDefaultProperties()[t]},QR.getDefaultProperties=function(){var t=this._private;if(null!=t.defaultProperties)return t.defaultProperties;for(var e=rv({"selection-box-color":"#ddd","selection-box-opacity":.65,"selection-box-border-color":"#aaa","selection-box-border-width":1,"active-bg-color":"black","active-bg-opacity":.15,"active-bg-size":30,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":.125,events:"yes","text-events":"no","text-valign":"top","text-halign":"center","text-justification":"auto","line-height":1,color:"#000","text-outline-color":"#000","text-outline-width":0,"text-outline-opacity":1,"text-opacity":1,"text-decoration":"none","text-transform":"none","text-wrap":"none","text-overflow-wrap":"whitespace","text-max-width":9999,"text-background-color":"#000","text-background-opacity":0,"text-background-shape":"rectangle","text-background-padding":0,"text-border-opacity":0,"text-border-width":0,"text-border-style":"solid","text-border-color":"#000","font-family":"Helvetica Neue, Helvetica, sans-serif","font-style":"normal","font-weight":"normal","font-size":16,"min-zoomed-font-size":0,"text-rotation":"none","source-text-rotation":"none","target-text-rotation":"none",visibility:"visible",display:"element",opacity:1,"z-compound-depth":"auto","z-index-compare":"auto","z-index":0,label:"","text-margin-x":0,"text-margin-y":0,"source-label":"","source-text-offset":0,"source-text-margin-x":0,"source-text-margin-y":0,"target-label":"","target-text-offset":0,"target-text-margin-x":0,"target-text-margin-y":0,"overlay-opacity":0,"overlay-color":"#000","overlay-padding":10,"transition-property":"none","transition-duration":0,"transition-delay":0,"transition-timing-function":"linear","background-blacken":0,"background-color":"#999","background-fill":"solid","background-opacity":1,"background-image":"none","background-image-crossorigin":"anonymous","background-image-opacity":1,"background-image-containment":"inside","background-image-smoothing":"yes","background-position-x":"50%","background-position-y":"50%","background-offset-x":0,"background-offset-y":0,"background-width-relative-to":"include-padding","background-height-relative-to":"include-padding","background-repeat":"no-repeat","background-fit":"none","background-clip":"node","background-width":"auto","background-height":"auto","border-color":"#000","border-opacity":1,"border-width":0,"border-style":"solid",height:30,width:30,shape:"ellipse","shape-polygon-points":"-1, -1,   1, -1,   1, 1,   -1, 1","bounds-expansion":0,"background-gradient-direction":"to-bottom","background-gradient-stop-colors":"#999","background-gradient-stop-positions":"0%",ghost:"no","ghost-offset-y":0,"ghost-offset-x":0,"ghost-opacity":0,padding:0,"padding-relative-to":"width",position:"origin","compound-sizing-wrt-labels":"include","min-width":0,"min-width-bias-left":0,"min-width-bias-right":0,"min-height":0,"min-height-bias-top":0,"min-height-bias-bottom":0},{"pie-size":"100%"},[{name:"pie-{{i}}-background-color",value:"black"},{name:"pie-{{i}}-background-size",value:"0%"},{name:"pie-{{i}}-background-opacity",value:1}].reduce((function(t,e){for(var n=1;n<=QR.pieBackgroundN;n++){var i=e.name.replace("{{i}}",n),o=e.value;t[i]=o}return t}),{}),{"line-style":"solid","line-color":"#999","line-fill":"solid","line-cap":"butt","line-opacity":1,"line-gradient-stop-colors":"#999","line-gradient-stop-positions":"0%","control-point-step-size":40,"control-point-weights":.5,"segment-weights":.5,"segment-distances":20,"taxi-turn":"50%","taxi-turn-min-distance":10,"taxi-direction":"auto","edge-distances":"intersection","curve-style":"haystack","haystack-radius":0,"arrow-scale":1,"loop-direction":"-45deg","loop-sweep":"-90deg","source-distance-from-node":0,"target-distance-from-node":0,"source-endpoint":"outside-to-node","target-endpoint":"outside-to-node","line-dash-pattern":[6,3],"line-dash-offset":0},[{name:"arrow-shape",value:"none"},{name:"arrow-color",value:"#999"},{name:"arrow-fill",value:"filled"}].reduce((function(t,e){return QR.arrowPrefixes.forEach((function(n){var i=n+"-"+e.name,o=e.value;t[i]=o})),t}),{})),n={},i=0;i<this.properties.length;i++){var o=this.properties[i];if(!o.pointsTo){var r=o.name,s=e[r],a=this.parse(r,s);n[r]=a}}return t.defaultProperties=n,t.defaultProperties},QR.addDefaultStylesheet=function(){this.selector(":parent").css({shape:"rectangle",padding:10,"background-color":"#eee","border-color":"#ccc","border-width":1}).selector("edge").css({width:3}).selector(":loop").css({"curve-style":"bezier"}).selector("edge:compound").css({"curve-style":"bezier","source-endpoint":"outside-to-line","target-endpoint":"outside-to-line"}).selector(":selected").css({"background-color":"#0169D9","line-color":"#0169D9","source-arrow-color":"#0169D9","target-arrow-color":"#0169D9","mid-source-arrow-color":"#0169D9","mid-target-arrow-color":"#0169D9"}).selector(":parent:selected").css({"background-color":"#CCE1F9","border-color":"#aec8e5"}).selector(":active").css({"overlay-color":"black","overlay-padding":10,"overlay-opacity":.25}),this.defaultLength=this.length};var tC={parse:function(t,e,n,i){var o=this;if(U_(e))return o.parseImplWarn(t,e,n,i);var r,s=Tv(t,""+e,n?"t":"f","mapping"===i||!0===i||!1===i||null==i?"dontcare":i),a=o.propCache=o.propCache||[];return(r=a[s])||(r=a[s]=o.parseImplWarn(t,e,n,i)),(n||"mapping"===i)&&(r=Pv(r))&&(r.value=Pv(r.value)),r},parseImplWarn:function(t,e,n,i){var o=this.parseImpl(t,e,n,i);return o||null==e||Lv("The style property `".concat(t,": ").concat(e,"` is invalid")),!o||"width"!==o.name&&"height"!==o.name||"label"!==e||Lv("The style value of `label` is deprecated for `"+o.name+"`"),o}};tC.parseImpl=function(t,e,n,i){var o=this;t=Q_(t);var r=o.properties[t],s=e,a=o.types;if(!r)return null;if(void 0===e)return null;r.alias&&(r=r.pointsTo,t=r.name);var l=H_(e);l&&(e=e.trim());var c,d,u=r.type;if(!u)return null;if(n&&(""===e||null===e))return{name:t,value:e,bypass:!0,deleteBypass:!0};if(U_(e))return{name:t,value:e,strValue:"fn",mapped:a.fn,bypass:n};if(!l||i||e.length<7||"a"!==e[1]);else{if(e.length>=7&&"d"===e[0]&&(c=new RegExp(a.data.regex).exec(e))){if(n)return!1;var h=a.data;return{name:t,value:c,strValue:""+e,mapped:h,field:c[1],bypass:n}}if(e.length>=10&&"m"===e[0]&&(d=new RegExp(a.mapData.regex).exec(e))){if(n)return!1;if(u.multiple)return!1;var p=a.mapData;if(!u.color&&!u.number)return!1;var g=this.parse(t,d[4]);if(!g||g.mapped)return!1;var f=this.parse(t,d[5]);if(!f||f.mapped)return!1;if(g.pfValue===f.pfValue||g.strValue===f.strValue)return Lv("`"+t+": "+e+"` is not a valid mapper because the output range is zero; converting to `"+t+": "+g.strValue+"`"),this.parse(t,g.strValue);if(u.color){var m=g.value,_=f.value;if(!(m[0]!==_[0]||m[1]!==_[1]||m[2]!==_[2]||m[3]!==_[3]&&(null!=m[3]&&1!==m[3]||null!=_[3]&&1!==_[3])))return!1}return{name:t,value:d,strValue:""+e,mapped:p,field:d[1],fieldMin:parseFloat(d[2]),fieldMax:parseFloat(d[3]),valueMin:g.value,valueMax:f.value,bypass:n}}}if(u.multiple&&"multiple"!==i){var v;if(v=l?e.split(/\s+/):V_(e)?e:[e],u.evenMultiple&&v.length%2!=0)return null;for(var y=[],b=[],E=[],T="",R=!1,C=0;C<v.length;C++){var x=o.parse(t,v[C],n,"multiple");R=R||H_(x.value),y.push(x.value),E.push(null!=x.pfValue?x.pfValue:x.value),b.push(x.units),T+=(C>0?" ":"")+x.strValue}return u.validate&&!u.validate(y,b)?null:u.singleEnum&&R?1===y.length&&H_(y[0])?{name:t,value:y[0],strValue:y[0],bypass:n}:null:{name:t,value:y,pfValue:E,strValue:T,bypass:n,units:b}}var S,I,O=function(){for(var i=0;i<u.enums.length;i++){if(u.enums[i]===e)return{name:t,value:e,strValue:""+e,bypass:n}}return null};if(u.number){var k,w="px";if(u.units&&(k=u.units),u.implicitUnits&&(w=u.implicitUnits),!u.unitless)if(l){var A="px|em"+(u.allowPercent?"|\\%":"");k&&(A=k);var D=e.match("^("+iv+")("+A+")?$");D&&(e=D[1],k=D[2]||w)}else k&&!u.implicitUnits||(k=w);if(e=parseFloat(e),isNaN(e)&&void 0===u.enums)return null;if(isNaN(e)&&void 0!==u.enums)return e=s,O();if(u.integer&&(!W_(I=e)||Math.floor(I)!==I))return null;if(void 0!==u.min&&(e<u.min||u.strictMin&&e===u.min)||void 0!==u.max&&(e>u.max||u.strictMax&&e===u.max))return null;var N={name:t,value:e,strValue:""+e+(k||""),units:k,bypass:n};return u.unitless||"px"!==k&&"em"!==k?N.pfValue=e:N.pfValue="px"!==k&&k?this.getEmSizeInPixels()*e:e,"ms"!==k&&"s"!==k||(N.pfValue="ms"===k?e:1e3*e),"deg"!==k&&"rad"!==k||(N.pfValue="rad"===k?e:(S=e,Math.PI*S/180)),"%"===k&&(N.pfValue=e/100),N}if(u.propList){var L=[],P=""+e;if("none"===P);else{for(var M=P.split(/\s*,\s*|\s+/),B=0;B<M.length;B++){var F=M[B].trim();o.properties[F]?L.push(F):Lv("`"+F+"` is not a valid property name")}if(0===L.length)return null}return{name:t,value:L,strValue:0===L.length?"none":L.join(" "),bypass:n}}if(u.color){var H=sv(e);return H?{name:t,value:H,pfValue:H,strValue:"rgb("+H[0]+","+H[1]+","+H[2]+")",bypass:n}:null}if(u.regex||u.regexes){if(u.enums){var U=O();if(U)return U}for(var V=u.regexes?u.regexes:[u.regex],G=0;G<V.length;G++){var W=new RegExp(V[G]).exec(e);if(W)return{name:t,value:u.singleRegexMatchValue?W[1]:W,strValue:""+e,bypass:n}}return null}return u.string?{name:t,value:""+e,strValue:""+e,bypass:n}:u.enums?O():null};var eC=function t(e){if(!(this instanceof t))return new t(e);K_(e)?(this._private={cy:e,coreStyle:{}},this.length=0,this.resetToDefault()):Dv("A style must have a core reference")},nC=eC.prototype;nC.instanceString=function(){return"style"},nC.clear=function(){for(var t=this._private,e=t.cy.elements(),n=0;n<this.length;n++)this[n]=void 0;return this.length=0,t.contextStyles={},t.propDiffs={},this.cleanElements(e,!0),e.forEach((function(t){var e=t[0]._private;e.styleDirty=!0,e.appliedInitStyle=!1})),this},nC.resetToDefault=function(){return this.clear(),this.addDefaultStylesheet(),this},nC.core=function(t){return this._private.coreStyle[t]||this.getDefaultProperty(t)},nC.selector=function(t){var e="core"===t?null:new YE(t),n=this.length++;return this[n]={selector:e,properties:[],mappedProperties:[],index:n},this},nC.css=function(){var t=this,e=arguments;if(1===e.length)for(var n=e[0],i=0;i<t.properties.length;i++){var o=t.properties[i],r=n[o.name];void 0===r&&(r=n[tv(o.name)]),void 0!==r&&this.cssRule(o.name,r)}else 2===e.length&&this.cssRule(e[0],e[1]);return this},nC.style=nC.css,nC.cssRule=function(t,e){var n=this.parse(t,e);if(n){var i=this.length-1;this[i].properties.push(n),this[i].properties[n.name]=n,n.name.match(/pie-(\d+)-background-size/)&&n.value&&(this._private.hasPie=!0),n.mapped&&this[i].mappedProperties.push(n),!this[i].selector&&(this._private.coreStyle[n.name]=n)}return this},nC.append=function(t){return $_(t)?t.appendToStyle(this):V_(t)?this.appendFromJson(t):H_(t)&&this.appendFromString(t),this},eC.fromJson=function(t,e){var n=new eC(t);return n.fromJson(e),n},eC.fromString=function(t,e){return new eC(t).fromString(e)},[YR,KR,$R,JR,qR,ZR,QR,tC].forEach((function(t){rv(nC,t)})),eC.types=nC.types,eC.properties=nC.properties,eC.propertyGroups=nC.propertyGroups,eC.propertyGroupNames=nC.propertyGroupNames,eC.propertyGroupKeys=nC.propertyGroupKeys;var iC={style:function(t){t&&this.setStyle(t).update();return this._private.style},setStyle:function(t){var e=this._private;return $_(t)?e.style=t.generateStyle(this):V_(t)?e.style=eC.fromJson(this,t):H_(t)?e.style=eC.fromString(this,t):e.style=eC(this),e.style},updateStyle:function(){this.mutableElements().updateStyle()}},oC={autolock:function(t){return void 0===t?this._private.autolock:(this._private.autolock=!!t,this)},autoungrabify:function(t){return void 0===t?this._private.autoungrabify:(this._private.autoungrabify=!!t,this)},autounselectify:function(t){return void 0===t?this._private.autounselectify:(this._private.autounselectify=!!t,this)},selectionType:function(t){var e=this._private;return null==e.selectionType&&(e.selectionType="single"),void 0===t?e.selectionType:("additive"!==t&&"single"!==t||(e.selectionType=t),this)},panningEnabled:function(t){return void 0===t?this._private.panningEnabled:(this._private.panningEnabled=!!t,this)},userPanningEnabled:function(t){return void 0===t?this._private.userPanningEnabled:(this._private.userPanningEnabled=!!t,this)},zoomingEnabled:function(t){return void 0===t?this._private.zoomingEnabled:(this._private.zoomingEnabled=!!t,this)},userZoomingEnabled:function(t){return void 0===t?this._private.userZoomingEnabled:(this._private.userZoomingEnabled=!!t,this)},boxSelectionEnabled:function(t){return void 0===t?this._private.boxSelectionEnabled:(this._private.boxSelectionEnabled=!!t,this)},pan:function(){var t,e,n,i,o,r=arguments,s=this._private.pan;switch(r.length){case 0:return s;case 1:if(H_(r[0]))return s[t=r[0]];if(G_(r[0])){if(!this._private.panningEnabled)return this;i=(n=r[0]).x,o=n.y,W_(i)&&(s.x=i),W_(o)&&(s.y=o),this.emit("pan viewport")}break;case 2:if(!this._private.panningEnabled)return this;t=r[0],e=r[1],"x"!==t&&"y"!==t||!W_(e)||(s[t]=e),this.emit("pan viewport")}return this.notify("viewport"),this},panBy:function(t,e){var n,i,o,r,s,a=arguments,l=this._private.pan;if(!this._private.panningEnabled)return this;switch(a.length){case 1:G_(t)&&(r=(o=a[0]).x,s=o.y,W_(r)&&(l.x+=r),W_(s)&&(l.y+=s),this.emit("pan viewport"));break;case 2:i=e,"x"!==(n=t)&&"y"!==n||!W_(i)||(l[n]+=i),this.emit("pan viewport")}return this.notify("viewport"),this},fit:function(t,e){var n=this.getFitViewport(t,e);if(n){var i=this._private;i.zoom=n.zoom,i.pan=n.pan,this.emit("pan zoom viewport"),this.notify("viewport")}return this},getFitViewport:function(t,e){if(W_(t)&&void 0===e&&(e=t,t=void 0),this._private.panningEnabled&&this._private.zoomingEnabled){var n,i;if(H_(t)){var o=t;t=this.$(o)}else if(G_(i=t)&&W_(i.x1)&&W_(i.x2)&&W_(i.y1)&&W_(i.y2)){var r=t;(n={x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2}).w=n.x2-n.x1,n.h=n.y2-n.y1}else X_(t)||(t=this.mutableElements());if(!X_(t)||!t.empty()){n=n||t.boundingBox();var s,a=this.width(),l=this.height();if(e=W_(e)?e:0,!isNaN(a)&&!isNaN(l)&&a>0&&l>0&&!isNaN(n.w)&&!isNaN(n.h)&&n.w>0&&n.h>0)return{zoom:s=(s=(s=Math.min((a-2*e)/n.w,(l-2*e)/n.h))>this._private.maxZoom?this._private.maxZoom:s)<this._private.minZoom?this._private.minZoom:s,pan:{x:(a-s*(n.x1+n.x2))/2,y:(l-s*(n.y1+n.y2))/2}}}}},zoomRange:function(t,e){var n=this._private;if(null==e){var i=t;t=i.min,e=i.max}return W_(t)&&W_(e)&&t<=e?(n.minZoom=t,n.maxZoom=e):W_(t)&&void 0===e&&t<=n.maxZoom?n.minZoom=t:W_(e)&&void 0===t&&e>=n.minZoom&&(n.maxZoom=e),this},minZoom:function(t){return void 0===t?this._private.minZoom:this.zoomRange({min:t})},maxZoom:function(t){return void 0===t?this._private.maxZoom:this.zoomRange({max:t})},getZoomedViewport:function(t){var e,n,i=this._private,o=i.pan,r=i.zoom,s=!1;if(i.zoomingEnabled||(s=!0),W_(t)?n=t:G_(t)&&(n=t.level,null!=t.position?e=cy(t.position,r,o):null!=t.renderedPosition&&(e=t.renderedPosition),null==e||i.panningEnabled||(s=!0)),n=(n=n>i.maxZoom?i.maxZoom:n)<i.minZoom?i.minZoom:n,s||!W_(n)||n===r||null!=e&&(!W_(e.x)||!W_(e.y)))return null;if(null!=e){var a=o,l=r,c=n;return{zoomed:!0,panned:!0,zoom:c,pan:{x:-c/l*(e.x-a.x)+e.x,y:-c/l*(e.y-a.y)+e.y}}}return{zoomed:!0,panned:!1,zoom:n,pan:o}},zoom:function(t){if(void 0===t)return this._private.zoom;var e=this.getZoomedViewport(t),n=this._private;return null!=e&&e.zoomed?(n.zoom=e.zoom,e.panned&&(n.pan.x=e.pan.x,n.pan.y=e.pan.y),this.emit("zoom"+(e.panned?" pan":"")+" viewport"),this.notify("viewport"),this):this},viewport:function(t){var e=this._private,n=!0,i=!0,o=[],r=!1,s=!1;if(!t)return this;if(W_(t.zoom)||(n=!1),G_(t.pan)||(i=!1),!n&&!i)return this;if(n){var a=t.zoom;a<e.minZoom||a>e.maxZoom||!e.zoomingEnabled?r=!0:(e.zoom=a,o.push("zoom"))}if(i&&(!r||!t.cancelOnFailedZoom)&&e.panningEnabled){var l=t.pan;W_(l.x)&&(e.pan.x=l.x,s=!1),W_(l.y)&&(e.pan.y=l.y,s=!1),s||o.push("pan")}return o.length>0&&(o.push("viewport"),this.emit(o.join(" ")),this.notify("viewport")),this},center:function(t){var e=this.getCenterPan(t);return e&&(this._private.pan=e,this.emit("pan viewport"),this.notify("viewport")),this},getCenterPan:function(t,e){if(this._private.panningEnabled){if(H_(t)){var n=t;t=this.mutableElements().filter(n)}else X_(t)||(t=this.mutableElements());if(0!==t.length){var i=t.boundingBox(),o=this.width(),r=this.height();return{x:(o-(e=void 0===e?this._private.zoom:e)*(i.x1+i.x2))/2,y:(r-e*(i.y1+i.y2))/2}}}},reset:function(){return this._private.panningEnabled&&this._private.zoomingEnabled?(this.viewport({pan:{x:0,y:0},zoom:1}),this):this},invalidateSize:function(){this._private.sizeCache=null},size:function(){var t=this._private,e=t.container;return t.sizeCache=t.sizeCache||(e?function(){var t=D_.getComputedStyle(e),n=function(e){return parseFloat(t.getPropertyValue(e))};return{width:e.clientWidth-n("padding-left")-n("padding-right"),height:e.clientHeight-n("padding-top")-n("padding-bottom")}}():{width:1,height:1})},width:function(){return this.size().width},height:function(){return this.size().height},extent:function(){var t=this._private.pan,e=this._private.zoom,n=this.renderedExtent(),i={x1:(n.x1-t.x)/e,x2:(n.x2-t.x)/e,y1:(n.y1-t.y)/e,y2:(n.y2-t.y)/e};return i.w=i.x2-i.x1,i.h=i.y2-i.y1,i},renderedExtent:function(){var t=this.width(),e=this.height();return{x1:0,y1:0,x2:t,y2:e,w:t,h:e}}};oC.centre=oC.center,oC.autolockNodes=oC.autolock,oC.autoungrabifyNodes=oC.autoungrabify;var rC={data:dE.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeData:dE.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),scratch:dE.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:dE.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0})};rC.attr=rC.data,rC.removeAttr=rC.removeData;var sC=function(t){var e=this,n=(t=rv({},t)).container;n&&!z_(n)&&z_(n[0])&&(n=n[0]);var i=n?n._cyreg:null;(i=i||{})&&i.cy&&(i.cy.destroy(),i={});var o=i.readies=i.readies||[];n&&(n._cyreg=i),i.cy=e;var r=void 0!==D_&&void 0!==n&&!t.headless,s=t;s.layout=rv({name:r?"grid":"null"},s.layout),s.renderer=rv({name:r?"canvas":"null"},s.renderer);var a=function(t,e,n){return void 0!==e?e:void 0!==n?n:t},l=this._private={container:n,ready:!1,options:s,elements:new CR(this),listeners:[],aniEles:new CR(this),data:s.data||{},scratch:{},layout:null,renderer:null,destroyed:!1,notificationsEnabled:!0,minZoom:1e-50,maxZoom:1e50,zoomingEnabled:a(!0,s.zoomingEnabled),userZoomingEnabled:a(!0,s.userZoomingEnabled),panningEnabled:a(!0,s.panningEnabled),userPanningEnabled:a(!0,s.userPanningEnabled),boxSelectionEnabled:a(!0,s.boxSelectionEnabled),autolock:a(!1,s.autolock,s.autolockNodes),autoungrabify:a(!1,s.autoungrabify,s.autoungrabifyNodes),autounselectify:a(!1,s.autounselectify),styleEnabled:void 0===s.styleEnabled?r:s.styleEnabled,zoom:W_(s.zoom)?s.zoom:1,pan:{x:G_(s.pan)&&W_(s.pan.x)?s.pan.x:0,y:G_(s.pan)&&W_(s.pan.y)?s.pan.y:0},animation:{current:[],queue:[]},hasCompoundNodes:!1};this.createEmitter(),this.selectionType(s.selectionType),this.zoomRange({min:s.minZoom,max:s.maxZoom});l.styleEnabled&&e.setStyle([]);var c=rv({},s,s.renderer);e.initRenderer(c);!function(t,e){if(t.some(q_))return aE.all(t).then(e);e(t)}([s.style,s.elements],(function(t){var n=t[0],r=t[1];l.styleEnabled&&e.style().append(n),function(t,n,i){e.notifications(!1);var o=e.mutableElements();o.length>0&&o.remove(),null!=t&&(G_(t)||V_(t))&&e.add(t),e.one("layoutready",(function(t){e.notifications(!0),e.emit(t),e.one("load",n),e.emitAndNotify("load")})).one("layoutstop",(function(){e.one("done",i),e.emit("done")}));var r=rv({},e._private.options.layout);r.eles=e.elements(),e.layout(r).run()}(r,(function(){e.startAnimationLoop(),l.ready=!0,U_(s.ready)&&e.on("ready",s.ready);for(var t=0;t<o.length;t++){var n=o[t];e.on("ready",n)}i&&(i.readies=[]),e.emit("ready")}),s.done)}))},aC=sC.prototype;rv(aC,{instanceString:function(){return"core"},isReady:function(){return this._private.ready},destroyed:function(){return this._private.destroyed},ready:function(t){return this.isReady()?this.emitter().emit("ready",[],t):this.on("ready",t),this},destroy:function(){var t=this;if(!t.destroyed())return t.stopAnimationLoop(),t.destroyRenderer(),this.emit("destroy"),t._private.destroyed=!0,t},hasElementWithId:function(t){return this._private.elements.hasElementWithId(t)},getElementById:function(t){return this._private.elements.getElementById(t)},hasCompoundNodes:function(){return this._private.hasCompoundNodes},headless:function(){return this._private.renderer.isHeadless()},styleEnabled:function(){return this._private.styleEnabled},addToPool:function(t){return this._private.elements.merge(t),this},removeFromPool:function(t){return this._private.elements.unmerge(t),this},container:function(){return this._private.container||null},mount:function(t){if(null!=t){var e=this,n=e._private,i=n.options;return!z_(t)&&z_(t[0])&&(t=t[0]),e.stopAnimationLoop(),e.destroyRenderer(),n.container=t,n.styleEnabled=!0,e.invalidateSize(),e.initRenderer(rv({},i,i.renderer,{name:"null"===i.renderer.name?"canvas":i.renderer.name})),e.startAnimationLoop(),e.style(i.style),e.emit("mount"),e}},unmount:function(){var t=this;return t.stopAnimationLoop(),t.destroyRenderer(),t.initRenderer({name:"null"}),t.emit("unmount"),t},options:function(){return Pv(this._private.options)},json:function(t){var e=this,n=e._private,i=e.mutableElements();if(G_(t)){if(e.startBatch(),t.elements){var o={},r=function(t,n){for(var i=[],r=[],s=0;s<t.length;s++){var a=t[s];if(a.data.id){var l=""+a.data.id,c=e.getElementById(l);o[l]=!0,0!==c.length?r.push({ele:c,json:a}):n?(a.group=n,i.push(a)):i.push(a)}else Lv("cy.json() cannot handle elements without an ID attribute")}e.add(i);for(var d=0;d<r.length;d++){var u=r[d],h=u.ele,p=u.json;h.json(p)}};if(V_(t.elements))r(t.elements);else for(var s=["nodes","edges"],a=0;a<s.length;a++){var l=s[a],c=t.elements[l];V_(c)&&r(c,l)}var d=e.collection();i.filter((function(t){return!o[t.id()]})).forEach((function(t){t.isParent()?d.merge(t):t.remove()})),d.forEach((function(t){return t.children().move({parent:null})})),d.forEach((function(t){return function(t){return e.getElementById(t.id())}(t).remove()}))}t.style&&e.style(t.style),null!=t.zoom&&t.zoom!==n.zoom&&e.zoom(t.zoom),t.pan&&(t.pan.x===n.pan.x&&t.pan.y===n.pan.y||e.pan(t.pan)),t.data&&e.data(t.data);for(var u=["minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","panningEnabled","userPanningEnabled","boxSelectionEnabled","autolock","autoungrabify","autounselectify"],h=0;h<u.length;h++){var p=u[h];null!=t[p]&&e[p](t[p])}return e.endBatch(),this}var g={};!!t?g.elements=this.elements().map((function(t){return t.json()})):(g.elements={},i.forEach((function(t){var e=t.group();g.elements[e]||(g.elements[e]=[]),g.elements[e].push(t.json())}))),this._private.styleEnabled&&(g.style=e.style().json()),g.data=Pv(e.data());var f=n.options;return g.zoomingEnabled=n.zoomingEnabled,g.userZoomingEnabled=n.userZoomingEnabled,g.zoom=n.zoom,g.minZoom=n.minZoom,g.maxZoom=n.maxZoom,g.panningEnabled=n.panningEnabled,g.userPanningEnabled=n.userPanningEnabled,g.pan=Pv(n.pan),g.boxSelectionEnabled=n.boxSelectionEnabled,g.renderer=Pv(f.renderer),g.hideEdgesOnViewport=f.hideEdgesOnViewport,g.textureOnViewport=f.textureOnViewport,g.wheelSensitivity=f.wheelSensitivity,g.motionBlur=f.motionBlur,g}}),aC.$id=aC.getElementById,[SR,BR,UR,VR,GR,WR,XR,jR,iC,oC,rC].forEach((function(t){rv(aC,t)}));var lC={fit:!0,directed:!1,padding:30,circle:!1,grid:!1,spacingFactor:1.75,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,roots:void 0,maximal:!1,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,e){return!0},ready:void 0,stop:void 0,transform:function(t,e){return e}},cC=function(t){return t.scratch("breadthfirst")},dC=function(t,e){return t.scratch("breadthfirst",e)};function uC(t){this.options=rv({},lC,t)}uC.prototype.run=function(){var t,e=this.options,n=e,i=e.cy,o=n.eles,r=o.nodes().filter((function(t){return!t.isParent()})),s=o,a=n.directed,l=n.maximal||n.maximalAdjustments>0,c=Ey(n.boundingBox?n.boundingBox:{x1:0,y1:0,w:i.width(),h:i.height()});if(X_(n.roots))t=n.roots;else if(V_(n.roots)){for(var d=[],u=0;u<n.roots.length;u++){var h=n.roots[u],p=i.getElementById(h);d.push(p)}t=i.collection(d)}else if(H_(n.roots))t=i.$(n.roots);else if(a)t=r.roots();else{var g=o.components();t=i.collection();for(var f=function(e){var n=g[e],i=n.maxDegree(!1),o=n.filter((function(t){return t.degree(!1)===i}));t=t.add(o)},m=0;m<g.length;m++)f(m)}var _=[],v={},y=function(t,e){null==_[e]&&(_[e]=[]);var n=_[e].length;_[e].push(t),dC(t,{index:n,depth:e})};s.bfs({roots:t,directed:n.directed,visit:function(t,e,n,i,o){var r=t[0],s=r.id();y(r,o),v[s]=!0}});for(var b=[],E=0;E<r.length;E++){var T=r[E];v[T.id()]||b.push(T)}var R=function(t){for(var e=_[t],n=0;n<e.length;n++){var i=e[n];null!=i?dC(i,{depth:t,index:n}):(e.splice(n,1),n--)}},C=function(){for(var t=0;t<_.length;t++)R(t)},x=function(t,e){for(var n=cC(t),i=t.incomers().filter((function(t){return t.isNode()&&o.has(t)})),r=-1,s=t.id(),a=0;a<i.length;a++){var l=i[a],c=cC(l);r=Math.max(r,c.depth)}return n.depth<=r&&(e[s]?null:(function(t,e){var n=cC(t),i=n.depth,o=n.index;_[i][o]=null,y(t,e)}(t,r+1),e[s]=!0,!0))};if(a&&l){var S=[],I={},O=function(t){return S.push(t)};for(r.forEach((function(t){return S.push(t)}));S.length>0;){var k=S.shift(),w=x(k,I);if(w)k.outgoers().filter((function(t){return t.isNode()&&o.has(t)})).forEach(O);else if(null===w){Lv("Detected double maximal shift for node `"+k.id()+"`.  Bailing maximal adjustment due to cycle.  Use `options.maximal: true` only on DAGs.");break}}}C();var A=0;if(n.avoidOverlap)for(var D=0;D<r.length;D++){var N=r[D].layoutDimensions(n),L=N.w,P=N.h;A=Math.max(A,L,P)}for(var M={},B=function(t){if(M[t.id()])return M[t.id()];for(var e=cC(t).depth,n=t.neighborhood(),i=0,o=0,s=0;s<n.length;s++){var a=n[s];if(!a.isEdge()&&!a.isParent()&&r.has(a)){var l=cC(a);if(null!=l){var c=l.index,d=l.depth;if(null!=c&&null!=d){var u=_[d].length;d<e&&(i+=c/u,o++)}}}}return i/=o=Math.max(1,o),0===o&&(i=0),M[t.id()]=i,i},F=function(t,e){var n=B(t)-B(e);return 0===n?ov(t.id(),e.id()):n},H=0;H<_.length;H++)_[H].sort(F),R(H);for(var U=[],V=0;V<b.length;V++)U.push(b[V]);_.unshift(U),C();for(var G=0,W=0;W<_.length;W++)G=Math.max(_[W].length,G);var z=c.x1+c.w/2,X=c.x1+c.h/2,j=_.reduce((function(t,e){return Math.max(t,e.length)}),0);return o.nodes().layoutPositions(this,n,(function(t){var e=cC(t),i=e.depth,o=e.index,r=_[i].length,s=Math.max(c.w/((n.grid?j:r)+1),A),a=Math.max(c.h/(_.length+1),A),l=Math.min(c.w/2/_.length,c.h/2/_.length);if(l=Math.max(l,A),n.circle){var d=l*i+l-(_.length>0&&_[0].length<=3?l/2:0),u=2*Math.PI/_[i].length*o;return 0===i&&1===_[0].length&&(d=1),{x:z+d*Math.cos(u),y:X+d*Math.sin(u)}}return{x:z+(o+1-(r+1)/2)*s,y:(i+1)*a}})),this};var hC={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,radius:void 0,startAngle:1.5*Math.PI,sweep:void 0,clockwise:!0,sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,e){return!0},ready:void 0,stop:void 0,transform:function(t,e){return e}};function pC(t){this.options=rv({},hC,t)}pC.prototype.run=function(){var t=this.options,e=t,n=t.cy,i=e.eles,o=void 0!==e.counterclockwise?!e.counterclockwise:e.clockwise,r=i.nodes().not(":parent");e.sort&&(r=r.sort(e.sort));for(var s,a=Ey(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()}),l=a.x1+a.w/2,c=a.y1+a.h/2,d=(void 0===e.sweep?2*Math.PI-2*Math.PI/r.length:e.sweep)/Math.max(1,r.length-1),u=0,h=0;h<r.length;h++){var p=r[h].layoutDimensions(e),g=p.w,f=p.h;u=Math.max(u,g,f)}if(s=W_(e.radius)?e.radius:r.length<=1?0:Math.min(a.h,a.w)/2-u,r.length>1&&e.avoidOverlap){u*=1.75;var m=Math.cos(d)-Math.cos(0),_=Math.sin(d)-Math.sin(0),v=Math.sqrt(u*u/(m*m+_*_));s=Math.max(v,s)}return i.nodes().layoutPositions(this,e,(function(t,n){var i=e.startAngle+n*d*(o?1:-1),r=s*Math.cos(i),a=s*Math.sin(i);return{x:l+r,y:c+a}})),this};var gC,fC={fit:!0,padding:30,startAngle:1.5*Math.PI,sweep:void 0,clockwise:!0,equidistant:!1,minNodeSpacing:10,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,height:void 0,width:void 0,spacingFactor:void 0,concentric:function(t){return t.degree()},levelWidth:function(t){return t.maxDegree()/4},animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,e){return!0},ready:void 0,stop:void 0,transform:function(t,e){return e}};function mC(t){this.options=rv({},fC,t)}mC.prototype.run=function(){for(var t=this.options,e=t,n=void 0!==e.counterclockwise?!e.counterclockwise:e.clockwise,i=t.cy,o=e.eles,r=o.nodes().not(":parent"),s=Ey(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:i.width(),h:i.height()}),a=s.x1+s.w/2,l=s.y1+s.h/2,c=[],d=0,u=0;u<r.length;u++){var h,p=r[u];h=e.concentric(p),c.push({value:h,node:p}),p._private.scratch.concentric=h}r.updateStyle();for(var g=0;g<r.length;g++){var f=r[g].layoutDimensions(e);d=Math.max(d,f.w,f.h)}c.sort((function(t,e){return e.value-t.value}));for(var m=e.levelWidth(r),_=[[]],v=_[0],y=0;y<c.length;y++){var b=c[y];if(v.length>0)Math.abs(v[0].value-b.value)>=m&&(v=[],_.push(v));v.push(b)}var E=d+e.minNodeSpacing;if(!e.avoidOverlap){var T=_.length>0&&_[0].length>1,R=(Math.min(s.w,s.h)/2-E)/(_.length+T?1:0);E=Math.min(E,R)}for(var C=0,x=0;x<_.length;x++){var S=_[x],I=void 0===e.sweep?2*Math.PI-2*Math.PI/S.length:e.sweep,O=S.dTheta=I/Math.max(1,S.length-1);if(S.length>1&&e.avoidOverlap){var k=Math.cos(O)-Math.cos(0),w=Math.sin(O)-Math.sin(0),A=Math.sqrt(E*E/(k*k+w*w));C=Math.max(A,C)}S.r=C,C+=E}if(e.equidistant){for(var D=0,N=0,L=0;L<_.length;L++){var P=_[L].r-N;D=Math.max(D,P)}N=0;for(var M=0;M<_.length;M++){var B=_[M];0===M&&(N=B.r),B.r=N,N+=D}}for(var F={},H=0;H<_.length;H++)for(var U=_[H],V=U.dTheta,G=U.r,W=0;W<U.length;W++){var z=U[W],X=e.startAngle+(n?1:-1)*V*W,j={x:a+G*Math.cos(X),y:l+G*Math.sin(X)};F[z.node.id()]=j}return o.nodes().layoutPositions(this,e,(function(t){var e=t.id();return F[e]})),this};var _C={ready:function(){},stop:function(){},animate:!0,animationEasing:void 0,animationDuration:void 0,animateFilter:function(t,e){return!0},animationThreshold:250,refresh:20,fit:!0,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,randomize:!1,componentSpacing:40,nodeRepulsion:function(t){return 2048},nodeOverlap:4,idealEdgeLength:function(t){return 32},edgeElasticity:function(t){return 32},nestingFactor:1.2,gravity:1,numIter:1e3,initialTemp:1e3,coolingFactor:.99,minTemp:1};function vC(t){this.options=rv({},_C,t),this.options.layout=this}vC.prototype.run=function(){var t=this.options,e=t.cy,n=this;n.stopped=!1,!0!==t.animate&&!1!==t.animate||n.emit({type:"layoutstart",layout:n}),gC=!0===t.debug;var i=yC(e,n,t);gC&&undefined(),t.randomize&&TC(i);var o=gv(),r=function(){CC(i,e,t),!0===t.fit&&e.fit(t.padding)},s=function(e){return!(n.stopped||e>=t.numIter)&&(xC(i,t),i.temperature=i.temperature*t.coolingFactor,!(i.temperature<t.minTemp))},a=function(){if(!0===t.animate||!1===t.animate)r(),n.one("layoutstop",t.stop),n.emit({type:"layoutstop",layout:n});else{var e=t.eles.nodes(),o=RC(i,t,e);e.layoutPositions(n,t,o)}},l=0,c=!0;if(!0===t.animate){!function e(){for(var n=0;c&&n<t.refresh;)c=s(l),l++,n++;c?(gv()-o>=t.animationThreshold&&r(),pv(e)):(BC(i,t),a())}()}else{for(;c;)c=s(l),l++;BC(i,t),a()}return this},vC.prototype.stop=function(){return this.stopped=!0,this.thread&&this.thread.stop(),this.emit("layoutstop"),this},vC.prototype.destroy=function(){return this.thread&&this.thread.stop(),this};var yC=function(t,e,n){for(var i=n.eles.edges(),o=n.eles.nodes(),r={isCompound:t.hasCompoundNodes(),layoutNodes:[],idToIndex:{},nodeSize:o.size(),graphSet:[],indexToGraph:[],layoutEdges:[],edgeSize:i.size(),temperature:n.initialTemp,clientWidth:t.width(),clientHeight:t.width(),boundingBox:Ey(n.boundingBox?n.boundingBox:{x1:0,y1:0,w:t.width(),h:t.height()})},s=n.eles.components(),a={},l=0;l<s.length;l++)for(var c=s[l],d=0;d<c.length;d++){a[c[d].id()]=l}for(l=0;l<r.nodeSize;l++){var u=(m=o[l]).layoutDimensions(n);(D={}).isLocked=m.locked(),D.id=m.data("id"),D.parentId=m.data("parent"),D.cmptId=a[m.id()],D.children=[],D.positionX=m.position("x"),D.positionY=m.position("y"),D.offsetX=0,D.offsetY=0,D.height=u.w,D.width=u.h,D.maxX=D.positionX+D.width/2,D.minX=D.positionX-D.width/2,D.maxY=D.positionY+D.height/2,D.minY=D.positionY-D.height/2,D.padLeft=parseFloat(m.style("padding")),D.padRight=parseFloat(m.style("padding")),D.padTop=parseFloat(m.style("padding")),D.padBottom=parseFloat(m.style("padding")),D.nodeRepulsion=U_(n.nodeRepulsion)?n.nodeRepulsion(m):n.nodeRepulsion,r.layoutNodes.push(D),r.idToIndex[D.id]=l}var h=[],p=0,g=-1,f=[];for(l=0;l<r.nodeSize;l++){var m,_=(m=r.layoutNodes[l]).parentId;null!=_?r.layoutNodes[r.idToIndex[_]].children.push(m.id):(h[++g]=m.id,f.push(m.id))}for(r.graphSet.push(f);p<=g;){var v=h[p++],y=r.idToIndex[v],b=r.layoutNodes[y].children;if(b.length>0){r.graphSet.push(b);for(l=0;l<b.length;l++)h[++g]=b[l]}}for(l=0;l<r.graphSet.length;l++){var E=r.graphSet[l];for(d=0;d<E.length;d++){var T=r.idToIndex[E[d]];r.indexToGraph[T]=l}}for(l=0;l<r.edgeSize;l++){var R=i[l],C={};C.id=R.data("id"),C.sourceId=R.data("source"),C.targetId=R.data("target");var x=U_(n.idealEdgeLength)?n.idealEdgeLength(R):n.idealEdgeLength,S=U_(n.edgeElasticity)?n.edgeElasticity(R):n.edgeElasticity,I=r.idToIndex[C.sourceId],O=r.idToIndex[C.targetId];if(r.indexToGraph[I]!=r.indexToGraph[O]){for(var k=bC(C.sourceId,C.targetId,r),w=r.graphSet[k],A=0,D=r.layoutNodes[I];-1===w.indexOf(D.id);)D=r.layoutNodes[r.idToIndex[D.parentId]],A++;for(D=r.layoutNodes[O];-1===w.indexOf(D.id);)D=r.layoutNodes[r.idToIndex[D.parentId]],A++;x*=A*n.nestingFactor}C.idealLength=x,C.elasticity=S,r.layoutEdges.push(C)}return r},bC=function(t,e,n){var i=EC(t,e,0,n);return 2>i.count?0:i.graph},EC=function t(e,n,i,o){var r=o.graphSet[i];if(-1<r.indexOf(e)&&-1<r.indexOf(n))return{count:2,graph:i};for(var s=0,a=0;a<r.length;a++){var l=r[a],c=o.idToIndex[l],d=o.layoutNodes[c].children;if(0!==d.length){var u=t(e,n,o.indexToGraph[o.idToIndex[d[0]]],o);if(0!==u.count){if(1!==u.count)return u;if(2===++s)break}}}return{count:s,graph:i}},TC=function(t,e){for(var n=t.clientWidth,i=t.clientHeight,o=0;o<t.nodeSize;o++){var r=t.layoutNodes[o];0!==r.children.length||r.isLocked||(r.positionX=Math.random()*n,r.positionY=Math.random()*i)}},RC=function(t,e,n){var i=t.boundingBox,o={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0};return e.boundingBox&&(n.forEach((function(e){var n=t.layoutNodes[t.idToIndex[e.data("id")]];o.x1=Math.min(o.x1,n.positionX),o.x2=Math.max(o.x2,n.positionX),o.y1=Math.min(o.y1,n.positionY),o.y2=Math.max(o.y2,n.positionY)})),o.w=o.x2-o.x1,o.h=o.y2-o.y1),function(n,r){var s=t.layoutNodes[t.idToIndex[n.data("id")]];if(e.boundingBox){var a=(s.positionX-o.x1)/o.w,l=(s.positionY-o.y1)/o.h;return{x:i.x1+a*i.w,y:i.y1+l*i.h}}return{x:s.positionX,y:s.positionY}}},CC=function(t,e,n){var i=n.layout,o=n.eles.nodes(),r=RC(t,n,o);o.positions(r),!0!==t.ready&&(t.ready=!0,i.one("layoutready",n.ready),i.emit({type:"layoutready",layout:this}))},xC=function(t,e,n){SC(t,e),AC(t),DC(t,e),NC(t),LC(t)},SC=function(t,e){for(var n=0;n<t.graphSet.length;n++)for(var i=t.graphSet[n],o=i.length,r=0;r<o;r++)for(var s=t.layoutNodes[t.idToIndex[i[r]]],a=r+1;a<o;a++){var l=t.layoutNodes[t.idToIndex[i[a]]];OC(s,l,t,e)}},IC=function(t){return-t+2*t*Math.random()},OC=function(t,e,n,i){if(t.cmptId===e.cmptId||n.isCompound){var o=e.positionX-t.positionX,r=e.positionY-t.positionY;0===o&&0===r&&(o=IC(1),r=IC(1));var s=kC(t,e,o,r);if(s>0)var a=(c=i.nodeOverlap*s)*o/(f=Math.sqrt(o*o+r*r)),l=c*r/f;else{var c,d=wC(t,o,r),u=wC(e,-1*o,-1*r),h=u.x-d.x,p=u.y-d.y,g=h*h+p*p,f=Math.sqrt(g);a=(c=(t.nodeRepulsion+e.nodeRepulsion)/g)*h/f,l=c*p/f}t.isLocked||(t.offsetX-=a,t.offsetY-=l),e.isLocked||(e.offsetX+=a,e.offsetY+=l)}},kC=function(t,e,n,i){if(n>0)var o=t.maxX-e.minX;else o=e.maxX-t.minX;if(i>0)var r=t.maxY-e.minY;else r=e.maxY-t.minY;return o>=0&&r>=0?Math.sqrt(o*o+r*r):0},wC=function(t,e,n){var i=t.positionX,o=t.positionY,r=t.height||1,s=t.width||1,a=n/e,l=r/s,c={};return 0===e&&0<n||0===e&&0>n?(c.x=i,c.y=o+r/2,c):0<e&&-1*l<=a&&a<=l?(c.x=i+s/2,c.y=o+s*n/2/e,c):0>e&&-1*l<=a&&a<=l?(c.x=i-s/2,c.y=o-s*n/2/e,c):0<n&&(a<=-1*l||a>=l)?(c.x=i+r*e/2/n,c.y=o+r/2,c):0>n&&(a<=-1*l||a>=l)?(c.x=i-r*e/2/n,c.y=o-r/2,c):c},AC=function(t,e){for(var n=0;n<t.edgeSize;n++){var i=t.layoutEdges[n],o=t.idToIndex[i.sourceId],r=t.layoutNodes[o],s=t.idToIndex[i.targetId],a=t.layoutNodes[s],l=a.positionX-r.positionX,c=a.positionY-r.positionY;if(0!==l||0!==c){var d=wC(r,l,c),u=wC(a,-1*l,-1*c),h=u.x-d.x,p=u.y-d.y,g=Math.sqrt(h*h+p*p),f=Math.pow(i.idealLength-g,2)/i.elasticity;if(0!==g)var m=f*h/g,_=f*p/g;else m=0,_=0;r.isLocked||(r.offsetX+=m,r.offsetY+=_),a.isLocked||(a.offsetX-=m,a.offsetY-=_)}}},DC=function(t,e){for(var n=0;n<t.graphSet.length;n++){var i=t.graphSet[n],o=i.length;if(0===n)var r=t.clientHeight/2,s=t.clientWidth/2;else{var a=t.layoutNodes[t.idToIndex[i[0]]],l=t.layoutNodes[t.idToIndex[a.parentId]];r=l.positionX,s=l.positionY}for(var c=0;c<o;c++){var d=t.layoutNodes[t.idToIndex[i[c]]];if(!d.isLocked){var u=r-d.positionX,h=s-d.positionY,p=Math.sqrt(u*u+h*h);if(p>1){var g=e.gravity*u/p,f=e.gravity*h/p;d.offsetX+=g,d.offsetY+=f}}}}},NC=function(t,e){var n=[],i=0,o=-1;for(n.push.apply(n,t.graphSet[0]),o+=t.graphSet[0].length;i<=o;){var r=n[i++],s=t.idToIndex[r],a=t.layoutNodes[s],l=a.children;if(0<l.length&&!a.isLocked){for(var c=a.offsetX,d=a.offsetY,u=0;u<l.length;u++){var h=t.layoutNodes[t.idToIndex[l[u]]];h.offsetX+=c,h.offsetY+=d,n[++o]=l[u]}a.offsetX=0,a.offsetY=0}}},LC=function(t,e){for(var n=0;n<t.nodeSize;n++){0<(o=t.layoutNodes[n]).children.length&&(o.maxX=void 0,o.minX=void 0,o.maxY=void 0,o.minY=void 0)}for(n=0;n<t.nodeSize;n++){if(!(0<(o=t.layoutNodes[n]).children.length||o.isLocked)){var i=PC(o.offsetX,o.offsetY,t.temperature);o.positionX+=i.x,o.positionY+=i.y,o.offsetX=0,o.offsetY=0,o.minX=o.positionX-o.width,o.maxX=o.positionX+o.width,o.minY=o.positionY-o.height,o.maxY=o.positionY+o.height,MC(o,t)}}for(n=0;n<t.nodeSize;n++){var o;0<(o=t.layoutNodes[n]).children.length&&!o.isLocked&&(o.positionX=(o.maxX+o.minX)/2,o.positionY=(o.maxY+o.minY)/2,o.width=o.maxX-o.minX,o.height=o.maxY-o.minY)}},PC=function(t,e,n){var i=Math.sqrt(t*t+e*e);if(i>n)var o={x:n*t/i,y:n*e/i};else o={x:t,y:e};return o},MC=function t(e,n){var i=e.parentId;if(null!=i){var o=n.layoutNodes[n.idToIndex[i]],r=!1;return(null==o.maxX||e.maxX+o.padRight>o.maxX)&&(o.maxX=e.maxX+o.padRight,r=!0),(null==o.minX||e.minX-o.padLeft<o.minX)&&(o.minX=e.minX-o.padLeft,r=!0),(null==o.maxY||e.maxY+o.padBottom>o.maxY)&&(o.maxY=e.maxY+o.padBottom,r=!0),(null==o.minY||e.minY-o.padTop<o.minY)&&(o.minY=e.minY-o.padTop,r=!0),r?t(o,n):void 0}},BC=function(t,e){for(var n=t.layoutNodes,i=[],o=0;o<n.length;o++){var r=n[o],s=r.cmptId;(i[s]=i[s]||[]).push(r)}var a=0;for(o=0;o<i.length;o++){if(f=i[o]){f.x1=1/0,f.x2=-1/0,f.y1=1/0,f.y2=-1/0;for(var l=0;l<f.length;l++){var c=f[l];f.x1=Math.min(f.x1,c.positionX-c.width/2),f.x2=Math.max(f.x2,c.positionX+c.width/2),f.y1=Math.min(f.y1,c.positionY-c.height/2),f.y2=Math.max(f.y2,c.positionY+c.height/2)}f.w=f.x2-f.x1,f.h=f.y2-f.y1,a+=f.w*f.h}}i.sort((function(t,e){return e.w*e.h-t.w*t.h}));var d=0,u=0,h=0,p=0,g=Math.sqrt(a)*t.clientWidth/t.clientHeight;for(o=0;o<i.length;o++){var f;if(f=i[o]){for(l=0;l<f.length;l++){(c=f[l]).isLocked||(c.positionX+=d-f.x1,c.positionY+=u-f.y1)}d+=f.w+e.componentSpacing,h+=f.w+e.componentSpacing,p=Math.max(p,f.h),h>g&&(u+=p+e.componentSpacing,d=0,h=0,p=0)}}},FC={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,avoidOverlapPadding:10,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,condense:!1,rows:void 0,cols:void 0,position:function(t){},sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,e){return!0},ready:void 0,stop:void 0,transform:function(t,e){return e}};function HC(t){this.options=rv({},FC,t)}HC.prototype.run=function(){var t=this.options,e=t,n=t.cy,i=e.eles,o=i.nodes().not(":parent");e.sort&&(o=o.sort(e.sort));var r=Ey(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()});if(0===r.h||0===r.w)i.nodes().layoutPositions(this,e,(function(t){return{x:r.x1,y:r.y1}}));else{var s=o.size(),a=Math.sqrt(s*r.h/r.w),l=Math.round(a),c=Math.round(r.w/r.h*a),d=function(t){if(null==t)return Math.min(l,c);Math.min(l,c)==l?l=t:c=t},u=function(t){if(null==t)return Math.max(l,c);Math.max(l,c)==l?l=t:c=t},h=e.rows,p=null!=e.cols?e.cols:e.columns;if(null!=h&&null!=p)l=h,c=p;else if(null!=h&&null==p)l=h,c=Math.ceil(s/l);else if(null==h&&null!=p)c=p,l=Math.ceil(s/c);else if(c*l>s){var g=d(),f=u();(g-1)*f>=s?d(g-1):(f-1)*g>=s&&u(f-1)}else for(;c*l<s;){var m=d(),_=u();(_+1)*m>=s?u(_+1):d(m+1)}var v=r.w/c,y=r.h/l;if(e.condense&&(v=0,y=0),e.avoidOverlap)for(var b=0;b<o.length;b++){var E=o[b],T=E._private.position;null!=T.x&&null!=T.y||(T.x=0,T.y=0);var R=E.layoutDimensions(e),C=e.avoidOverlapPadding,x=R.w+C,S=R.h+C;v=Math.max(v,x),y=Math.max(y,S)}for(var I={},O=function(t,e){return!!I["c-"+t+"-"+e]},k=function(t,e){I["c-"+t+"-"+e]=!0},w=0,A=0,D=function(){++A>=c&&(A=0,w++)},N={},L=0;L<o.length;L++){var P=o[L],M=e.position(P);if(M&&(void 0!==M.row||void 0!==M.col)){var B={row:M.row,col:M.col};if(void 0===B.col)for(B.col=0;O(B.row,B.col);)B.col++;else if(void 0===B.row)for(B.row=0;O(B.row,B.col);)B.row++;N[P.id()]=B,k(B.row,B.col)}}o.layoutPositions(this,e,(function(t,e){var n,i;if(t.locked()||t.isParent())return!1;var o=N[t.id()];if(o)n=o.col*v+v/2+r.x1,i=o.row*y+y/2+r.y1;else{for(;O(w,A);)D();n=A*v+v/2+r.x1,i=w*y+y/2+r.y1,k(w,A),D()}return{x:n,y:i}}))}return this};var UC={ready:function(){},stop:function(){}};function VC(t){this.options=rv({},UC,t)}VC.prototype.run=function(){var t=this.options,e=t.eles,n=this;return t.cy,n.emit("layoutstart"),e.nodes().positions((function(){return{x:0,y:0}})),n.one("layoutready",t.ready),n.emit("layoutready"),n.one("layoutstop",t.stop),n.emit("layoutstop"),this},VC.prototype.stop=function(){return this};var GC={positions:void 0,zoom:void 0,pan:void 0,fit:!0,padding:30,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,e){return!0},ready:void 0,stop:void 0,transform:function(t,e){return e}};function WC(t){this.options=rv({},GC,t)}WC.prototype.run=function(){var t=this.options,e=t.eles.nodes(),n=U_(t.positions);return e.layoutPositions(this,t,(function(e,i){var o=function(e){if(null==t.positions)return function(t){return{x:t.x,y:t.y}}(e.position());if(n)return t.positions(e);var i=t.positions[e._private.data.id];return null==i?null:i}(e);return!e.locked()&&null!=o&&o})),this};var zC={fit:!0,padding:30,boundingBox:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(t,e){return!0},ready:void 0,stop:void 0,transform:function(t,e){return e}};function XC(t){this.options=rv({},zC,t)}XC.prototype.run=function(){var t=this.options,e=t.cy,n=t.eles,i=Ey(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()});return n.nodes().layoutPositions(this,t,(function(t,e){return{x:i.x1+Math.round(Math.random()*i.w),y:i.y1+Math.round(Math.random()*i.h)}})),this};var jC=[{name:"breadthfirst",impl:uC},{name:"circle",impl:pC},{name:"concentric",impl:mC},{name:"cose",impl:vC},{name:"grid",impl:HC},{name:"null",impl:VC},{name:"preset",impl:WC},{name:"random",impl:XC}];function YC(t){this.options=t,this.notifications=0}var KC=function(){},$C=function(){throw new Error("A headless instance can not render images")};YC.prototype={recalculateRenderedStyle:KC,notify:function(){this.notifications++},init:KC,isHeadless:function(){return!0},png:$C,jpg:$C};var JC={arrowShapeWidth:.3,registerArrowShapes:function(){var t=this.arrowShapes={},e=this,n=function(t,e,n,i,o,r,s){var a=o.x-n/2-s,l=o.x+n/2+s,c=o.y-n/2-s,d=o.y+n/2+s;return a<=t&&t<=l&&c<=e&&e<=d},i=function(t,e,n,i,o){var r=t*Math.cos(i)-e*Math.sin(i),s=(t*Math.sin(i)+e*Math.cos(i))*n;return{x:r*n+o.x,y:s+o.y}},o=function(t,e,n,o){for(var r=[],s=0;s<t.length;s+=2){var a=t[s],l=t[s+1];r.push(i(a,l,e,n,o))}return r},r=function(t){for(var e=[],n=0;n<t.length;n++){var i=t[n];e.push(i.x,i.y)}return e},s=function(t){return t.pstyle("width").pfValue*t.pstyle("arrow-scale").pfValue*2},a=function(i,a){H_(a)&&(a=t[a]),t[i]=rv({name:i,points:[-.15,-.3,.15,-.3,.15,.3,-.15,.3],collide:function(t,e,n,i,s,a){var l=r(o(this.points,n+2*a,i,s));return Ly(t,e,l)},roughCollide:n,draw:function(t,n,i,r){var s=o(this.points,n,i,r);e.arrowShapeImpl("polygon")(t,s)},spacing:function(t){return 0},gap:s},a)};a("none",{collide:kv,roughCollide:kv,draw:Av,spacing:wv,gap:wv}),a("triangle",{points:[-.15,-.3,0,0,.15,-.3]}),a("arrow","triangle"),a("triangle-backcurve",{points:t.triangle.points,controlPoint:[0,-.15],roughCollide:n,draw:function(t,n,r,s,a){var l=o(this.points,n,r,s),c=this.controlPoint,d=i(c[0],c[1],n,r,s);e.arrowShapeImpl(this.name)(t,l,d)},gap:function(t){return.8*s(t)}}),a("triangle-tee",{points:[0,0,.15,-.3,-.15,-.3,0,0],pointsTee:[-.15,-.4,-.15,-.5,.15,-.5,.15,-.4],collide:function(t,e,n,i,s,a,l){var c=r(o(this.points,n+2*l,i,s)),d=r(o(this.pointsTee,n+2*l,i,s));return Ly(t,e,c)||Ly(t,e,d)},draw:function(t,n,i,r,s){var a=o(this.points,n,i,r),l=o(this.pointsTee,n,i,r);e.arrowShapeImpl(this.name)(t,a,l)}}),a("circle-triangle",{radius:.15,pointsTr:[0,-.15,.15,-.45,-.15,-.45,0,-.15],collide:function(t,e,n,i,s,a,l){var c=s,d=Math.pow(c.x-t,2)+Math.pow(c.y-e,2)<=Math.pow((n+2*l)*this.radius,2),u=r(o(this.points,n+2*l,i,s));return Ly(t,e,u)||d},draw:function(t,n,i,r,s){var a=o(this.pointsTr,n,i,r);e.arrowShapeImpl(this.name)(t,a,r.x,r.y,this.radius*n)},spacing:function(t){return e.getArrowWidth(t.pstyle("width").pfValue,t.pstyle("arrow-scale").value)*this.radius}}),a("triangle-cross",{points:[0,0,.15,-.3,-.15,-.3,0,0],baseCrossLinePts:[-.15,-.4,-.15,-.4,.15,-.4,.15,-.4],crossLinePts:function(t,e){var n=this.baseCrossLinePts.slice(),i=e/t;return n[3]=n[3]-i,n[5]=n[5]-i,n},collide:function(t,e,n,i,s,a,l){var c=r(o(this.points,n+2*l,i,s)),d=r(o(this.crossLinePts(n,a),n+2*l,i,s));return Ly(t,e,c)||Ly(t,e,d)},draw:function(t,n,i,r,s){var a=o(this.points,n,i,r),l=o(this.crossLinePts(n,s),n,i,r);e.arrowShapeImpl(this.name)(t,a,l)}}),a("vee",{points:[-.15,-.3,0,0,.15,-.3,0,-.15],gap:function(t){return.525*s(t)}}),a("circle",{radius:.15,collide:function(t,e,n,i,o,r,s){var a=o;return Math.pow(a.x-t,2)+Math.pow(a.y-e,2)<=Math.pow((n+2*s)*this.radius,2)},draw:function(t,n,i,o,r){e.arrowShapeImpl(this.name)(t,o.x,o.y,this.radius*n)},spacing:function(t){return e.getArrowWidth(t.pstyle("width").pfValue,t.pstyle("arrow-scale").value)*this.radius}}),a("tee",{points:[-.15,0,-.15,-.1,.15,-.1,.15,0],spacing:function(t){return 1},gap:function(t){return 1}}),a("square",{points:[-.15,0,.15,0,.15,-.3,-.15,-.3]}),a("diamond",{points:[-.15,-.15,0,-.3,.15,-.15,0,0],gap:function(t){return t.pstyle("width").pfValue*t.pstyle("arrow-scale").value}}),a("chevron",{points:[0,0,-.15,-.15,-.1,-.2,0,-.1,.1,-.2,.15,-.15],gap:function(t){return.95*t.pstyle("width").pfValue*t.pstyle("arrow-scale").value}})}},qC={projectIntoViewport:function(t,e){var n=this.cy,i=this.findContainerClientCoords(),o=i[0],r=i[1],s=i[4],a=n.pan(),l=n.zoom();return[((t-o)/s-a.x)/l,((e-r)/s-a.y)/l]},findContainerClientCoords:function(){if(this.containerBB)return this.containerBB;var t=this.container,e=t.getBoundingClientRect(),n=D_.getComputedStyle(t),i=function(t){return parseFloat(n.getPropertyValue(t))},o=i("padding-left"),r=i("padding-right"),s=i("padding-top"),a=i("padding-bottom"),l=i("border-left-width"),c=i("border-right-width"),d=i("border-top-width"),u=(i("border-bottom-width"),t.clientWidth),h=t.clientHeight,p=o+r,g=s+a,f=l+c,m=e.width/(u+f),_=u-p,v=h-g,y=e.left+o+l,b=e.top+s+d;return this.containerBB=[y,b,_,v,m]},invalidateContainerClientCoordsCache:function(){this.containerBB=null},findNearestElement:function(t,e,n,i){return this.findNearestElements(t,e,n,i)[0]},findNearestElements:function(t,e,n,i){var o,r,s=this,a=this,l=a.getCachedZSortedEles(),c=[],d=a.cy.zoom(),u=a.cy.hasCompoundNodes(),h=(i?24:8)/d,p=(i?8:2)/d,g=(i?8:2)/d,f=1/0;function m(t,e){if(t.isNode()){if(r)return;r=t,c.push(t)}if(t.isEdge()&&(null==e||e<f))if(o){if(o.pstyle("z-compound-depth").value===t.pstyle("z-compound-depth").value&&o.pstyle("z-compound-depth").value===t.pstyle("z-compound-depth").value)for(var n=0;n<c.length;n++)if(c[n].isEdge()){c[n]=t,o=t,f=null!=e?e:f;break}}else c.push(t),o=t,f=null!=e?e:f}function _(n){var i=n.outerWidth()+2*p,o=n.outerHeight()+2*p,r=i/2,l=o/2,c=n.position();if(c.x-r<=t&&t<=c.x+r&&c.y-l<=e&&e<=c.y+l&&a.nodeShapes[s.getNodeShape(n)].checkPoint(t,e,0,i,o,c.x,c.y))return m(n,0),!0}function v(n){var i,o=n._private,r=o.rscratch,l=n.pstyle("width").pfValue,d=n.pstyle("arrow-scale").value,p=l/2+h,g=p*p,f=2*p,v=o.source,y=o.target;if("segments"===r.edgeType||"straight"===r.edgeType||"haystack"===r.edgeType){for(var b=r.allpts,E=0;E+3<b.length;E+=2)if(wy(t,e,b[E],b[E+1],b[E+2],b[E+3],f)&&g>(i=Ny(t,e,b[E],b[E+1],b[E+2],b[E+3])))return m(n,i),!0}else if("bezier"===r.edgeType||"multibezier"===r.edgeType||"self"===r.edgeType||"compound"===r.edgeType)for(b=r.allpts,E=0;E+5<r.allpts.length;E+=4)if(Ay(t,e,b[E],b[E+1],b[E+2],b[E+3],b[E+4],b[E+5],f)&&g>(i=Dy(t,e,b[E],b[E+1],b[E+2],b[E+3],b[E+4],b[E+5])))return m(n,i),!0;v=v||o.source,y=y||o.target;var T=s.getArrowWidth(l,d),R=[{name:"source",x:r.arrowStartX,y:r.arrowStartY,angle:r.srcArrowAngle},{name:"target",x:r.arrowEndX,y:r.arrowEndY,angle:r.tgtArrowAngle},{name:"mid-source",x:r.midX,y:r.midY,angle:r.midsrcArrowAngle},{name:"mid-target",x:r.midX,y:r.midY,angle:r.midtgtArrowAngle}];for(E=0;E<R.length;E++){var C=R[E],x=a.arrowShapes[n.pstyle(C.name+"-arrow-shape").value],S=n.pstyle("width").pfValue;if(x.roughCollide(t,e,T,C.angle,{x:C.x,y:C.y},S,h)&&x.collide(t,e,T,C.angle,{x:C.x,y:C.y},S,h))return m(n),!0}u&&c.length>0&&(_(v),_(y))}function y(t,e,n){return Gv(t,e,n)}function b(n,i){var o,r=n._private,s=g;o=i?i+"-":"",n.boundingBox();var a=r.labelBounds[i||"main"],l=n.pstyle(o+"label").value;if("yes"===n.pstyle("text-events").strValue&&l){var c=y(r.rscratch,"labelX",i),d=y(r.rscratch,"labelY",i),u=y(r.rscratch,"labelAngle",i),h=n.pstyle(o+"text-margin-x").pfValue,p=n.pstyle(o+"text-margin-y").pfValue,f=a.x1-s-h,_=a.x2+s-h,v=a.y1-s-p,b=a.y2+s-p;if(u){var E=Math.cos(u),T=Math.sin(u),R=function(t,e){return{x:(t-=c)*E-(e-=d)*T+c,y:t*T+e*E+d}},C=R(f,v),x=R(f,b),S=R(_,v),I=R(_,b),O=[C.x+h,C.y+p,S.x+h,S.y+p,I.x+h,I.y+p,x.x+h,x.y+p];if(Ly(t,e,O))return m(n),!0}else if(Iy(a,t,e))return m(n),!0}}n&&(l=l.interactive);for(var E=l.length-1;E>=0;E--){var T=l[E];T.isNode()?_(T)||b(T):v(T)||b(T)||b(T,"source")||b(T,"target")}return c},getAllInBox:function(t,e,n,i){for(var o,r,s=this.getCachedZSortedEles().interactive,a=[],l=Math.min(t,n),c=Math.max(t,n),d=Math.min(e,i),u=Math.max(e,i),h=Ey({x1:t=l,y1:e=d,x2:n=c,y2:i=u}),p=0;p<s.length;p++){var g=s[p];if(g.isNode()){var f=g,m=f.boundingBox({includeNodes:!0,includeEdges:!1,includeLabels:!1});Sy(h,m)&&!Oy(m,h)&&a.push(f)}else{var _=g,v=_._private,y=v.rscratch;if(null!=y.startX&&null!=y.startY&&!Iy(h,y.startX,y.startY))continue;if(null!=y.endX&&null!=y.endY&&!Iy(h,y.endX,y.endY))continue;if("bezier"===y.edgeType||"multibezier"===y.edgeType||"self"===y.edgeType||"compound"===y.edgeType||"segments"===y.edgeType||"haystack"===y.edgeType){for(var b=v.rstyle.bezierPts||v.rstyle.linePts||v.rstyle.haystackPts,E=!0,T=0;T<b.length;T++)if(o=h,r=b[T],!Iy(o,r.x,r.y)){E=!1;break}E&&a.push(_)}else"haystack"!==y.edgeType&&"straight"!==y.edgeType||a.push(_)}}return a}},ZC={calculateArrowAngles:function(t){var e,n,i,o,r,s,a=t._private.rscratch,l="haystack"===a.edgeType,c="bezier"===a.edgeType,d="multibezier"===a.edgeType,u="segments"===a.edgeType,h="compound"===a.edgeType,p="self"===a.edgeType;if(l?(i=a.haystackPts[0],o=a.haystackPts[1],r=a.haystackPts[2],s=a.haystackPts[3]):(i=a.arrowStartX,o=a.arrowStartY,r=a.arrowEndX,s=a.arrowEndY),f=a.midX,m=a.midY,u)e=i-a.segpts[0],n=o-a.segpts[1];else if(d||h||p||c){var g=a.allpts;e=i-vy(g[0],g[2],g[4],.1),n=o-vy(g[1],g[3],g[5],.1)}else e=i-f,n=o-m;a.srcArrowAngle=hy(e,n);var f=a.midX,m=a.midY;if(l&&(f=(i+r)/2,m=(o+s)/2),e=r-i,n=s-o,u)if((g=a.allpts).length/2%2==0){var _=(v=g.length/2)-2;e=g[v]-g[_],n=g[v+1]-g[_+1]}else{_=(v=g.length/2-1)-2;var v,y=v+2;e=g[v]-g[_],n=g[v+1]-g[_+1]}else if(d||h||p){var b,E,T,R,g=a.allpts;if(a.ctrlpts.length/2%2==0){var C=(x=(S=g.length/2-1)+2)+2;b=vy(g[S],g[x],g[C],0),E=vy(g[S+1],g[x+1],g[C+1],0),T=vy(g[S],g[x],g[C],1e-4),R=vy(g[S+1],g[x+1],g[C+1],1e-4)}else{var x,S;C=(x=g.length/2-1)+2;b=vy(g[S=x-2],g[x],g[C],.4999),E=vy(g[S+1],g[x+1],g[C+1],.4999),T=vy(g[S],g[x],g[C],.5),R=vy(g[S+1],g[x+1],g[C+1],.5)}e=T-b,n=R-E}(a.midtgtArrowAngle=hy(e,n),a.midDispX=e,a.midDispY=n,e*=-1,n*=-1,u)&&((g=a.allpts).length/2%2==0||(e=-(g[y=(v=g.length/2-1)+2]-g[v]),n=-(g[y+1]-g[v+1])));if(a.midsrcArrowAngle=hy(e,n),u)e=r-a.segpts[a.segpts.length-2],n=s-a.segpts[a.segpts.length-1];else if(d||h||p||c){var I=(g=a.allpts).length;e=r-vy(g[I-6],g[I-4],g[I-2],.9),n=s-vy(g[I-5],g[I-3],g[I-1],.9)}else e=r-f,n=s-m;a.tgtArrowAngle=hy(e,n)}};ZC.getArrowWidth=ZC.getArrowHeight=function(t,e){var n=this.arrowWidthCache=this.arrowWidthCache||{},i=n[t+", "+e];return i||(i=Math.max(Math.pow(13.37*t,.9),29)*e,n[t+", "+e]=i,i)};var QC={};function tx(t){var e=[];if(null!=t){for(var n=0;n<t.length;n+=2){var i=t[n],o=t[n+1];e.push({x:i,y:o})}return e}}QC.findHaystackPoints=function(t){for(var e=0;e<t.length;e++){var n=t[e],i=n._private,o=i.rscratch;if(!o.haystack){var r=2*Math.random()*Math.PI;o.source={x:Math.cos(r),y:Math.sin(r)},r=2*Math.random()*Math.PI,o.target={x:Math.cos(r),y:Math.sin(r)}}var s=i.source,a=i.target,l=s.position(),c=a.position(),d=s.width(),u=a.width(),h=s.height(),p=a.height(),g=n.pstyle("haystack-radius").value/2;o.haystackPts=o.allpts=[o.source.x*d*g+l.x,o.source.y*h*g+l.y,o.target.x*u*g+c.x,o.target.y*p*g+c.y],o.midX=(o.allpts[0]+o.allpts[2])/2,o.midY=(o.allpts[1]+o.allpts[3])/2,o.edgeType="haystack",o.haystack=!0,this.storeEdgeProjections(n),this.calculateArrowAngles(n),this.recalculateEdgeLabelProjections(n),this.calculateLabelAngles(n)}},QC.findSegmentsPoints=function(t,e){var n=t._private.rscratch,i=e.posPts,o=e.intersectionPts,r=e.vectorNormInverse,s=t.pstyle("edge-distances").value,a=t.pstyle("segment-weights"),l=t.pstyle("segment-distances"),c=Math.min(a.pfValue.length,l.pfValue.length);n.edgeType="segments",n.segpts=[];for(var d=0;d<c;d++){var u=a.pfValue[d],h=l.pfValue[d],p=1-u,g=u,f="node-position"===s?i:o,m={x:f.x1*p+f.x2*g,y:f.y1*p+f.y2*g};n.segpts.push(m.x+r.x*h,m.y+r.y*h)}},QC.findLoopPoints=function(t,e,n,i){var o=t._private.rscratch,r=e.dirCounts,s=e.srcPos,a=t.pstyle("control-point-distances"),l=a?a.pfValue[0]:void 0,c=t.pstyle("loop-direction").pfValue,d=t.pstyle("loop-sweep").pfValue,u=t.pstyle("control-point-step-size").pfValue;o.edgeType="self";var h=n,p=u;i&&(h=0,p=l);var g=c-Math.PI/2,f=g-d/2,m=g+d/2,_=String(c+"_"+d);h=void 0===r[_]?r[_]=0:++r[_],o.ctrlpts=[s.x+1.4*Math.cos(f)*p*(h/3+1),s.y+1.4*Math.sin(f)*p*(h/3+1),s.x+1.4*Math.cos(m)*p*(h/3+1),s.y+1.4*Math.sin(m)*p*(h/3+1)]},QC.findCompoundLoopPoints=function(t,e,n,i){var o=t._private.rscratch;o.edgeType="compound";var r=e.srcPos,s=e.tgtPos,a=e.srcW,l=e.srcH,c=e.tgtW,d=e.tgtH,u=t.pstyle("control-point-step-size").pfValue,h=t.pstyle("control-point-distances"),p=h?h.pfValue[0]:void 0,g=n,f=u;i&&(g=0,f=p);var m={x:r.x-a/2,y:r.y-l/2},_={x:s.x-c/2,y:s.y-d/2},v={x:Math.min(m.x,_.x),y:Math.min(m.y,_.y)},y=Math.max(.5,Math.log(.01*a)),b=Math.max(.5,Math.log(.01*c));o.ctrlpts=[v.x,v.y-(1+Math.pow(50,1.12)/100)*f*(g/3+1)*y,v.x-(1+Math.pow(50,1.12)/100)*f*(g/3+1)*b,v.y]},QC.findStraightEdgePoints=function(t){t._private.rscratch.edgeType="straight"},QC.findBezierPoints=function(t,e,n,i,o){var r=t._private.rscratch,s=e.vectorNormInverse,a=e.posPts,l=e.intersectionPts,c=t.pstyle("edge-distances").value,d=t.pstyle("control-point-step-size").pfValue,u=t.pstyle("control-point-distances"),h=t.pstyle("control-point-weights"),p=u&&h?Math.min(u.value.length,h.value.length):1,g=u?u.pfValue[0]:void 0,f=h.value[0],m=i;r.edgeType=m?"multibezier":"bezier",r.ctrlpts=[];for(var _=0;_<p;_++){var v=(.5-e.eles.length/2+n)*d*(o?-1:1),y=void 0,b=gy(v);m&&(g=u?u.pfValue[_]:d,f=h.value[_]);var E=void 0!==(y=i?g:void 0!==g?b*g:void 0)?y:v,T=1-f,R=f,C="node-position"===c?a:l,x={x:C.x1*T+C.x2*R,y:C.y1*T+C.y2*R};r.ctrlpts.push(x.x+s.x*E,x.y+s.y*E)}},QC.findTaxiPoints=function(t,e){var n=t._private.rscratch;n.edgeType="segments";var i="vertical",o="horizontal",r="leftward",s="rightward",a="downward",l="upward",c=e.posPts,d=e.srcW,u=e.srcH,h=e.tgtW,p=e.tgtH,g="node-position"!==t.pstyle("edge-distances").value,f=t.pstyle("taxi-direction").value,m=f,_=t.pstyle("taxi-turn"),v="%"===_.units,y=_.pfValue,b=y<0,E=t.pstyle("taxi-turn-min-distance").pfValue,T=g?(d+h)/2:0,R=g?(u+p)/2:0,C=c.x2-c.x1,x=c.y2-c.y1,S=function(t,e){return t>0?Math.max(t-e,0):Math.min(t+e,0)},I=S(C,T),O=S(x,R),k=!1;"auto"===m?f=Math.abs(I)>Math.abs(O)?o:i:m===l||m===a?(f=i,k=!0):m!==r&&m!==s||(f=o,k=!0);var w,A=f===i,D=A?O:I,N=A?x:C,L=gy(N),P=!1;(k&&(v||b)||!(m===a&&N<0||m===l&&N>0||m===r&&N>0||m===s&&N<0)||(D=(L*=-1)*Math.abs(D),P=!0),v)?w=(y<0?1+y:y)*D:w=(y<0?D:0)+y*L;var M=function(t){return Math.abs(t)<E||Math.abs(t)>=Math.abs(D)},B=M(w),F=M(Math.abs(D)-Math.abs(w));if((B||F)&&!P)if(A){var H=Math.abs(N)<=u/2,U=Math.abs(C)<=h/2;if(H){var V=(c.x1+c.x2)/2,G=c.y1,W=c.y2;n.segpts=[V,G,V,W]}else if(U){var z=(c.y1+c.y2)/2,X=c.x1,j=c.x2;n.segpts=[X,z,j,z]}else n.segpts=[c.x1,c.y2]}else{var Y=Math.abs(N)<=d/2,K=Math.abs(x)<=p/2;if(Y){var $=(c.y1+c.y2)/2,J=c.x1,q=c.x2;n.segpts=[J,$,q,$]}else if(K){var Z=(c.x1+c.x2)/2,Q=c.y1,tt=c.y2;n.segpts=[Z,Q,Z,tt]}else n.segpts=[c.x2,c.y1]}else if(A){var et=c.y1+w+(g?u/2*L:0),nt=c.x1,it=c.x2;n.segpts=[nt,et,it,et]}else{var ot=c.x1+w+(g?d/2*L:0),rt=c.y1,st=c.y2;n.segpts=[ot,rt,ot,st]}},QC.tryToCorrectInvalidPoints=function(t,e){var n=t._private.rscratch;if("bezier"===n.edgeType){var i=e.srcPos,o=e.tgtPos,r=e.srcW,s=e.srcH,a=e.tgtW,l=e.tgtH,c=e.srcShape,d=e.tgtShape,u=!W_(n.startX)||!W_(n.startY),h=!W_(n.arrowStartX)||!W_(n.arrowStartY),p=!W_(n.endX)||!W_(n.endY),g=!W_(n.arrowEndX)||!W_(n.arrowEndY),f=3*(this.getArrowWidth(t.pstyle("width").pfValue,t.pstyle("arrow-scale").value)*this.arrowShapeWidth),m=fy({x:n.ctrlpts[0],y:n.ctrlpts[1]},{x:n.startX,y:n.startY}),_=m<f,v=fy({x:n.ctrlpts[0],y:n.ctrlpts[1]},{x:n.endX,y:n.endY}),y=v<f,b=!1;if(u||h||_){b=!0;var E={x:n.ctrlpts[0]-i.x,y:n.ctrlpts[1]-i.y},T=Math.sqrt(E.x*E.x+E.y*E.y),R={x:E.x/T,y:E.y/T},C=Math.max(r,s),x={x:n.ctrlpts[0]+2*R.x*C,y:n.ctrlpts[1]+2*R.y*C},S=c.intersectLine(i.x,i.y,r,s,x.x,x.y,0);_?(n.ctrlpts[0]=n.ctrlpts[0]+R.x*(f-m),n.ctrlpts[1]=n.ctrlpts[1]+R.y*(f-m)):(n.ctrlpts[0]=S[0]+R.x*f,n.ctrlpts[1]=S[1]+R.y*f)}if(p||g||y){b=!0;var I={x:n.ctrlpts[0]-o.x,y:n.ctrlpts[1]-o.y},O=Math.sqrt(I.x*I.x+I.y*I.y),k={x:I.x/O,y:I.y/O},w=Math.max(r,s),A={x:n.ctrlpts[0]+2*k.x*w,y:n.ctrlpts[1]+2*k.y*w},D=d.intersectLine(o.x,o.y,a,l,A.x,A.y,0);y?(n.ctrlpts[0]=n.ctrlpts[0]+k.x*(f-v),n.ctrlpts[1]=n.ctrlpts[1]+k.y*(f-v)):(n.ctrlpts[0]=D[0]+k.x*f,n.ctrlpts[1]=D[1]+k.y*f)}b&&this.findEndpoints(t)}},QC.storeAllpts=function(t){var e=t._private.rscratch;if("multibezier"===e.edgeType||"bezier"===e.edgeType||"self"===e.edgeType||"compound"===e.edgeType){e.allpts=[],e.allpts.push(e.startX,e.startY);for(var n=0;n+1<e.ctrlpts.length;n+=2)e.allpts.push(e.ctrlpts[n],e.ctrlpts[n+1]),n+3<e.ctrlpts.length&&e.allpts.push((e.ctrlpts[n]+e.ctrlpts[n+2])/2,(e.ctrlpts[n+1]+e.ctrlpts[n+3])/2);var i;e.allpts.push(e.endX,e.endY),e.ctrlpts.length/2%2==0?(i=e.allpts.length/2-1,e.midX=e.allpts[i],e.midY=e.allpts[i+1]):(i=e.allpts.length/2-3,.5,e.midX=vy(e.allpts[i],e.allpts[i+2],e.allpts[i+4],.5),e.midY=vy(e.allpts[i+1],e.allpts[i+3],e.allpts[i+5],.5))}else if("straight"===e.edgeType)e.allpts=[e.startX,e.startY,e.endX,e.endY],e.midX=(e.startX+e.endX+e.arrowStartX+e.arrowEndX)/4,e.midY=(e.startY+e.endY+e.arrowStartY+e.arrowEndY)/4;else if("segments"===e.edgeType)if(e.allpts=[],e.allpts.push(e.startX,e.startY),e.allpts.push.apply(e.allpts,e.segpts),e.allpts.push(e.endX,e.endY),e.segpts.length%4==0){var o=e.segpts.length/2,r=o-2;e.midX=(e.segpts[r]+e.segpts[o])/2,e.midY=(e.segpts[r+1]+e.segpts[o+1])/2}else{var s=e.segpts.length/2-1;e.midX=e.segpts[s],e.midY=e.segpts[s+1]}},QC.checkForInvalidEdgeWarning=function(t){var e=t[0]._private.rscratch;e.nodesOverlap||W_(e.startX)&&W_(e.startY)&&W_(e.endX)&&W_(e.endY)?e.loggedErr=!1:e.loggedErr||(e.loggedErr=!0,Lv("Edge `"+t.id()+"` has invalid endpoints and so it is impossible to draw.  Adjust your edge style (e.g. control points) accordingly or use an alternative edge type.  This is expected behaviour when the source node and the target node overlap."))},QC.findEdgeControlPoints=function(t){var e=this;if(t&&0!==t.length){for(var n=this,i=n.cy.hasCompoundNodes(),o={map:new zv,get:function(t){var e=this.map.get(t[0]);return null!=e?e.get(t[1]):null},set:function(t,e){var n=this.map.get(t[0]);null==n&&(n=new zv,this.map.set(t[0],n)),n.set(t[1],e)}},r=[],s=[],a=0;a<t.length;a++){var l=t[a],c=l._private,d=l.pstyle("curve-style").value;if(!l.removed()&&l.takesUpSpace())if("haystack"!==d){var u="unbundled-bezier"===d||"segments"===d||"straight"===d||"taxi"===d,h="unbundled-bezier"===d||"bezier"===d,p=c.source,g=c.target,f=[p.poolIndex(),g.poolIndex()].sort(),m=o.get(f);null==m&&(m={eles:[]},o.set(f,m),r.push(f)),m.eles.push(l),u&&(m.hasUnbundled=!0),h&&(m.hasBezier=!0)}else s.push(l)}for(var _=function(t){var s=r[t],a=o.get(s),l=void 0;if(!a.hasUnbundled){var c=a.eles[0].parallelEdges().filter((function(t){return t.isBundledBezier()}));Vv(a.eles),c.forEach((function(t){return a.eles.push(t)})),a.eles.sort((function(t,e){return t.poolIndex()-e.poolIndex()}))}var d=a.eles[0],u=d.source(),h=d.target();if(u.poolIndex()>h.poolIndex()){var p=u;u=h,h=p}var g=a.srcPos=u.position(),f=a.tgtPos=h.position(),m=a.srcW=u.outerWidth(),_=a.srcH=u.outerHeight(),v=a.tgtW=h.outerWidth(),y=a.tgtH=h.outerHeight(),b=a.srcShape=n.nodeShapes[e.getNodeShape(u)],E=a.tgtShape=n.nodeShapes[e.getNodeShape(h)];a.dirCounts={north:0,west:0,south:0,east:0,northwest:0,southwest:0,northeast:0,southeast:0};for(var T=0;T<a.eles.length;T++){var R=a.eles[T],C=R[0]._private.rscratch,x=R.pstyle("curve-style").value,S="unbundled-bezier"===x||"segments"===x||"taxi"===x,I=!u.same(R.source());if(!a.calculatedIntersection&&u!==h&&(a.hasBezier||a.hasUnbundled)){a.calculatedIntersection=!0;var O=b.intersectLine(g.x,g.y,m,_,f.x,f.y,0),k=a.srcIntn=O,w=E.intersectLine(f.x,f.y,v,y,g.x,g.y,0),A=a.tgtIntn=w,D=a.intersectionPts={x1:O[0],x2:w[0],y1:O[1],y2:w[1]},N=a.posPts={x1:g.x,x2:f.x,y1:g.y,y2:f.y},L=w[1]-O[1],P=w[0]-O[0],M=Math.sqrt(P*P+L*L),B=a.vector={x:P,y:L},F=a.vectorNorm={x:B.x/M,y:B.y/M},H={x:-F.y,y:F.x};a.nodesOverlap=!W_(M)||E.checkPoint(O[0],O[1],0,v,y,f.x,f.y)||b.checkPoint(w[0],w[1],0,m,_,g.x,g.y),a.vectorNormInverse=H,l={nodesOverlap:a.nodesOverlap,dirCounts:a.dirCounts,calculatedIntersection:!0,hasBezier:a.hasBezier,hasUnbundled:a.hasUnbundled,eles:a.eles,srcPos:f,tgtPos:g,srcW:v,srcH:y,tgtW:m,tgtH:_,srcIntn:A,tgtIntn:k,srcShape:E,tgtShape:b,posPts:{x1:N.x2,y1:N.y2,x2:N.x1,y2:N.y1},intersectionPts:{x1:D.x2,y1:D.y2,x2:D.x1,y2:D.y1},vector:{x:-B.x,y:-B.y},vectorNorm:{x:-F.x,y:-F.y},vectorNormInverse:{x:-H.x,y:-H.y}}}var U=I?l:a;C.nodesOverlap=U.nodesOverlap,C.srcIntn=U.srcIntn,C.tgtIntn=U.tgtIntn,i&&(u.isParent()||u.isChild()||h.isParent()||h.isChild())&&(u.parents().anySame(h)||h.parents().anySame(u)||u.same(h)&&u.isParent())?e.findCompoundLoopPoints(R,U,T,S):u===h?e.findLoopPoints(R,U,T,S):"segments"===x?e.findSegmentsPoints(R,U):"taxi"===x?e.findTaxiPoints(R,U):"straight"===x||!S&&a.eles.length%2==1&&T===Math.floor(a.eles.length/2)?e.findStraightEdgePoints(R):e.findBezierPoints(R,U,T,S,I),e.findEndpoints(R),e.tryToCorrectInvalidPoints(R,U),e.checkForInvalidEdgeWarning(R),e.storeAllpts(R),e.storeEdgeProjections(R),e.calculateArrowAngles(R),e.recalculateEdgeLabelProjections(R),e.calculateLabelAngles(R)}},v=0;v<r.length;v++)_(v);this.findHaystackPoints(s)}},QC.getSegmentPoints=function(t){var e=t[0]._private.rscratch;if("segments"===e.edgeType)return this.recalculateRenderedStyle(t),tx(e.segpts)},QC.getControlPoints=function(t){var e=t[0]._private.rscratch,n=e.edgeType;if("bezier"===n||"multibezier"===n||"self"===n||"compound"===n)return this.recalculateRenderedStyle(t),tx(e.ctrlpts)},QC.getEdgeMidpoint=function(t){var e=t[0]._private.rscratch;return this.recalculateRenderedStyle(t),{x:e.midX,y:e.midY}};var ex={manualEndptToPx:function(t,e){var n=t.position(),i=t.outerWidth(),o=t.outerHeight();if(2===e.value.length){var r=[e.pfValue[0],e.pfValue[1]];return"%"===e.units[0]&&(r[0]=r[0]*i),"%"===e.units[1]&&(r[1]=r[1]*o),r[0]+=n.x,r[1]+=n.y,r}var s=e.pfValue[0];s=-Math.PI/2+s;var a=2*Math.max(i,o),l=[n.x+Math.cos(s)*a,n.y+Math.sin(s)*a];return this.nodeShapes[this.getNodeShape(t)].intersectLine(n.x,n.y,i,o,l[0],l[1],0)},findEndpoints:function(t){var e,n,i,o,r,s=this,a=t.source()[0],l=t.target()[0],c=a.position(),d=l.position(),u=t.pstyle("target-arrow-shape").value,h=t.pstyle("source-arrow-shape").value,p=t.pstyle("target-distance-from-node").pfValue,g=t.pstyle("source-distance-from-node").pfValue,f=t.pstyle("curve-style").value,m=t._private.rscratch,_=m.edgeType,v="self"===_||"compound"===_,y="bezier"===_||"multibezier"===_||v,b="bezier"!==_,E="straight"===_||"segments"===_,T="segments"===_,R=y||b||E,C=v||"taxi"===f,x=t.pstyle("source-endpoint"),S=C?"outside-to-node":x.value,I=t.pstyle("target-endpoint"),O=C?"outside-to-node":I.value;if(m.srcManEndpt=x,m.tgtManEndpt=I,y){var k=[m.ctrlpts[0],m.ctrlpts[1]];n=b?[m.ctrlpts[m.ctrlpts.length-2],m.ctrlpts[m.ctrlpts.length-1]]:k,i=k}else if(E){var w=T?m.segpts.slice(0,2):[d.x,d.y];n=T?m.segpts.slice(m.segpts.length-2):[c.x,c.y],i=w}if("inside-to-node"===O)e=[d.x,d.y];else if(I.units)e=this.manualEndptToPx(l,I);else if("outside-to-line"===O)e=m.tgtIntn;else if("outside-to-node"===O||"outside-to-node-or-label"===O?o=n:"outside-to-line"!==O&&"outside-to-line-or-label"!==O||(o=[c.x,c.y]),e=s.nodeShapes[this.getNodeShape(l)].intersectLine(d.x,d.y,l.outerWidth(),l.outerHeight(),o[0],o[1],0),"outside-to-node-or-label"===O||"outside-to-line-or-label"===O){var A=l._private.rscratch,D=A.labelWidth,N=A.labelHeight,L=A.labelX,P=A.labelY,M=D/2,B=N/2,F=l.pstyle("text-valign").value;"top"===F?P-=B:"bottom"===F&&(P+=B);var H=l.pstyle("text-halign").value;"left"===H?L-=M:"right"===H&&(L+=M);var U=Gy(o[0],o[1],[L-M,P-B,L+M,P-B,L+M,P+B,L-M,P+B],d.x,d.y);if(U.length>0){var V=c,G=my(V,uy(e)),W=my(V,uy(U)),z=G;if(W<G&&(e=U,z=W),U.length>2)my(V,{x:U[2],y:U[3]})<z&&(e=[U[2],U[3]])}}var X=Wy(e,n,s.arrowShapes[u].spacing(t)+p),j=Wy(e,n,s.arrowShapes[u].gap(t)+p);if(m.endX=j[0],m.endY=j[1],m.arrowEndX=X[0],m.arrowEndY=X[1],"inside-to-node"===S)e=[c.x,c.y];else if(x.units)e=this.manualEndptToPx(a,x);else if("outside-to-line"===S)e=m.srcIntn;else if("outside-to-node"===S||"outside-to-node-or-label"===S?r=i:"outside-to-line"!==S&&"outside-to-line-or-label"!==S||(r=[d.x,d.y]),e=s.nodeShapes[this.getNodeShape(a)].intersectLine(c.x,c.y,a.outerWidth(),a.outerHeight(),r[0],r[1],0),"outside-to-node-or-label"===S||"outside-to-line-or-label"===S){var Y=a._private.rscratch,K=Y.labelWidth,$=Y.labelHeight,J=Y.labelX,q=Y.labelY,Z=K/2,Q=$/2,tt=a.pstyle("text-valign").value;"top"===tt?q-=Q:"bottom"===tt&&(q+=Q);var et=a.pstyle("text-halign").value;"left"===et?J-=Z:"right"===et&&(J+=Z);var nt=Gy(r[0],r[1],[J-Z,q-Q,J+Z,q-Q,J+Z,q+Q,J-Z,q+Q],c.x,c.y);if(nt.length>0){var it=d,ot=my(it,uy(e)),rt=my(it,uy(nt)),st=ot;if(rt<ot&&(e=[nt[0],nt[1]],st=rt),nt.length>2)my(it,{x:nt[2],y:nt[3]})<st&&(e=[nt[2],nt[3]])}}var at=Wy(e,i,s.arrowShapes[h].spacing(t)+g),lt=Wy(e,i,s.arrowShapes[h].gap(t)+g);m.startX=lt[0],m.startY=lt[1],m.arrowStartX=at[0],m.arrowStartY=at[1],R&&(W_(m.startX)&&W_(m.startY)&&W_(m.endX)&&W_(m.endY)?m.badLine=!1:m.badLine=!0)},getSourceEndpoint:function(t){var e=t[0]._private.rscratch;switch(this.recalculateRenderedStyle(t),e.edgeType){case"haystack":return{x:e.haystackPts[0],y:e.haystackPts[1]};default:return{x:e.arrowStartX,y:e.arrowStartY}}},getTargetEndpoint:function(t){var e=t[0]._private.rscratch;switch(this.recalculateRenderedStyle(t),e.edgeType){case"haystack":return{x:e.haystackPts[2],y:e.haystackPts[3]};default:return{x:e.arrowEndX,y:e.arrowEndY}}}},nx={};function ix(t,e,n){for(var i=function(t,e,n,i){return vy(t,e,n,i)},o=e._private.rstyle.bezierPts,r=0;r<t.bezierProjPcts.length;r++){var s=t.bezierProjPcts[r];o.push({x:i(n[0],n[2],n[4],s),y:i(n[1],n[3],n[5],s)})}}nx.storeEdgeProjections=function(t){var e=t._private,n=e.rscratch,i=n.edgeType;if(e.rstyle.bezierPts=null,e.rstyle.linePts=null,e.rstyle.haystackPts=null,"multibezier"===i||"bezier"===i||"self"===i||"compound"===i){e.rstyle.bezierPts=[];for(var o=0;o+5<n.allpts.length;o+=4)ix(this,t,n.allpts.slice(o,o+6))}else if("segments"===i){var r=e.rstyle.linePts=[];for(o=0;o+1<n.allpts.length;o+=2)r.push({x:n.allpts[o],y:n.allpts[o+1]})}else if("haystack"===i){var s=n.haystackPts;e.rstyle.haystackPts=[{x:s[0],y:s[1]},{x:s[2],y:s[3]}]}e.rstyle.arrowWidth=this.getArrowWidth(t.pstyle("width").pfValue,t.pstyle("arrow-scale").value)*this.arrowShapeWidth},nx.recalculateEdgeProjections=function(t){this.findEdgeControlPoints(t)};var ox={recalculateNodeLabelProjection:function(t){var e=t.pstyle("label").strValue;if(!J_(e)){var n,i,o=t._private,r=t.width(),s=t.height(),a=t.padding(),l=t.position(),c=t.pstyle("text-halign").strValue,d=t.pstyle("text-valign").strValue,u=o.rscratch,h=o.rstyle;switch(c){case"left":n=l.x-r/2-a;break;case"right":n=l.x+r/2+a;break;default:n=l.x}switch(d){case"top":i=l.y-s/2-a;break;case"bottom":i=l.y+s/2+a;break;default:i=l.y}u.labelX=n,u.labelY=i,h.labelX=n,h.labelY=i,this.calculateLabelAngles(t),this.applyLabelDimensions(t)}}},rx=function(t,e){var n=Math.atan(e/t);return 0===t&&n<0&&(n*=-1),n},sx=function(t,e){var n=e.x-t.x,i=e.y-t.y;return rx(n,i)};ox.recalculateEdgeLabelProjections=function(t){var e,n=t._private,i=n.rscratch,o=this,r={mid:t.pstyle("label").strValue,source:t.pstyle("source-label").strValue,target:t.pstyle("target-label").strValue};if(r.mid||r.source||r.target){e={x:i.midX,y:i.midY};var s=function(t,e,i){Wv(n.rscratch,t,e,i),Wv(n.rstyle,t,e,i)};s("labelX",null,e.x),s("labelY",null,e.y);var a=rx(i.midDispX,i.midDispY);s("labelAutoAngle",null,a);var l=function t(){if(t.cache)return t.cache;for(var e=[],r=0;r+5<i.allpts.length;r+=4){var s={x:i.allpts[r],y:i.allpts[r+1]},a={x:i.allpts[r+2],y:i.allpts[r+3]},l={x:i.allpts[r+4],y:i.allpts[r+5]};e.push({p0:s,p1:a,p2:l,startDist:0,length:0,segments:[]})}var c=n.rstyle.bezierPts,d=o.bezierProjPcts.length;function u(t,e,n,i,o){var r=fy(e,n),s=t.segments[t.segments.length-1],a={p0:e,p1:n,t0:i,t1:o,startDist:s?s.startDist+s.length:0,length:r};t.segments.push(a),t.length+=r}for(var h=0;h<e.length;h++){var p=e[h],g=e[h-1];g&&(p.startDist=g.startDist+g.length),u(p,p.p0,c[h*d],0,o.bezierProjPcts[0]);for(var f=0;f<d-1;f++)u(p,c[h*d+f],c[h*d+f+1],o.bezierProjPcts[f],o.bezierProjPcts[f+1]);u(p,c[h*d+d-1],p.p2,o.bezierProjPcts[d-1],1)}return t.cache=e},c=function(n){var o,a="source"===n;if(r[n]){var c=t.pstyle(n+"-text-offset").pfValue;switch(i.edgeType){case"self":case"compound":case"bezier":case"multibezier":for(var d,u=l(),h=0,p=0,g=0;g<u.length;g++){for(var f=u[a?g:u.length-1-g],m=0;m<f.segments.length;m++){var _=f.segments[a?m:f.segments.length-1-m],v=g===u.length-1&&m===f.segments.length-1;if(h=p,(p+=_.length)>=c||v){d={cp:f,segment:_};break}}if(d)break}var y=d.cp,b=d.segment,E=(c-h)/b.length,T=b.t1-b.t0,R=a?b.t0+T*E:b.t1-T*E;R=by(0,R,1),e=yy(y.p0,y.p1,y.p2,R),o=function(t,e,n,i){var o=by(0,i-.001,1),r=by(0,i+.001,1),s=yy(t,e,n,o),a=yy(t,e,n,r);return sx(s,a)}(y.p0,y.p1,y.p2,R);break;case"straight":case"segments":case"haystack":for(var C,x,S,I,O=0,k=i.allpts.length,w=0;w+3<k&&(a?(S={x:i.allpts[w],y:i.allpts[w+1]},I={x:i.allpts[w+2],y:i.allpts[w+3]}):(S={x:i.allpts[k-2-w],y:i.allpts[k-1-w]},I={x:i.allpts[k-4-w],y:i.allpts[k-3-w]}),x=O,!((O+=C=fy(S,I))>=c));w+=2);var A=(c-x)/C;A=by(0,A,1),e=function(t,e,n,i){var o=e.x-t.x,r=e.y-t.y,s=fy(t,e),a=o/s,l=r/s;return n=null==n?0:n,i=null!=i?i:n*s,{x:t.x+a*i,y:t.y+l*i}}(S,I,A),o=sx(S,I)}s("labelX",n,e.x),s("labelY",n,e.y),s("labelAutoAngle",n,o)}};c("source"),c("target"),this.applyLabelDimensions(t)}},ox.applyLabelDimensions=function(t){this.applyPrefixedLabelDimensions(t),t.isEdge()&&(this.applyPrefixedLabelDimensions(t,"source"),this.applyPrefixedLabelDimensions(t,"target"))},ox.applyPrefixedLabelDimensions=function(t,e){var n=t._private,i=this.getLabelText(t,e),o=this.calculateLabelDimensions(t,i),r=t.pstyle("line-height").pfValue,s=t.pstyle("text-wrap").strValue,a=Gv(n.rscratch,"labelWrapCachedLines",e)||[],l="wrap"!==s?1:Math.max(a.length,1),c=o.height/l,d=c*r,u=o.width,h=o.height+(l-1)*(r-1)*c;Wv(n.rstyle,"labelWidth",e,u),Wv(n.rscratch,"labelWidth",e,u),Wv(n.rstyle,"labelHeight",e,h),Wv(n.rscratch,"labelHeight",e,h),Wv(n.rscratch,"labelLineHeight",e,d)},ox.getLabelText=function(t,e){var n=t._private,i=e?e+"-":"",o=t.pstyle(i+"label").strValue,r=t.pstyle("text-transform").value,s=function(t,i){return i?(Wv(n.rscratch,t,e,i),i):Gv(n.rscratch,t,e)};if(!o)return"";"none"==r||("uppercase"==r?o=o.toUpperCase():"lowercase"==r&&(o=o.toLowerCase()));var a=t.pstyle("text-wrap").value;if("wrap"===a){var l=s("labelKey");if(null!=l&&s("labelWrapKey")===l)return s("labelWrapCachedText");for(var c=o.split("\n"),d=t.pstyle("text-max-width").pfValue,u="anywhere"===t.pstyle("text-overflow-wrap").value,h=[],p=/[\s\u200b]+/,g=u?"":" ",f=0;f<c.length;f++){var m=c[f],_=this.calculateLabelDimensions(t,m).width;if(u){var v=m.split("").join("â€‹");m=v}if(_>d){for(var y=m.split(p),b="",E=0;E<y.length;E++){var T=y[E],R=0===b.length?T:b+g+T;this.calculateLabelDimensions(t,R).width<=d?b+=T+g:(b&&h.push(b),b=T+g)}b.match(/^[\s\u200b]+$/)||h.push(b)}else h.push(m)}s("labelWrapCachedLines",h),o=s("labelWrapCachedText",h.join("\n")),s("labelWrapKey",l)}else if("ellipsis"===a){var C=t.pstyle("text-max-width").pfValue,x="",S=!1;if(this.calculateLabelDimensions(t,o).width<C)return o;for(var I=0;I<o.length;I++){if(this.calculateLabelDimensions(t,x+o[I]+"â€¦").width>C)break;x+=o[I],I===o.length-1&&(S=!0)}return S||(x+="â€¦"),x}return o},ox.getLabelJustification=function(t){var e=t.pstyle("text-justification").strValue,n=t.pstyle("text-halign").strValue;if("auto"!==e)return e;if(!t.isNode())return"center";switch(n){case"left":return"right";case"right":return"left";default:return"center"}},ox.calculateLabelDimensions=function(t,e){var n=Ev(e,t._private.labelDimsKey),i=this.labelDimCache||(this.labelDimCache=[]),o=i[n];if(null!=o)return o;var r=t.pstyle("font-style").strValue,s=t.pstyle("font-size").pfValue,a=t.pstyle("font-family").strValue,l=t.pstyle("font-weight").strValue,c=this.labelCalcCanvas,d=this.labelCalcCanvasContext;if(!c){c=this.labelCalcCanvas=document.createElement("canvas"),d=this.labelCalcCanvasContext=c.getContext("2d");var u=c.style;u.position="absolute",u.left="-9999px",u.top="-9999px",u.zIndex="-1",u.visibility="hidden",u.pointerEvents="none"}d.font="".concat(r," ").concat(l," ").concat(s,"px ").concat(a);for(var h=0,p=0,g=e.split("\n"),f=0;f<g.length;f++){var m=g[f],_=d.measureText(m),v=Math.ceil(_.width),y=s;h=Math.max(v,h),p+=y}return h+=0,p+=0,i[n]={width:h,height:p}},ox.calculateLabelAngle=function(t,e){var n=t._private.rscratch,i=t.isEdge(),o=e?e+"-":"",r=t.pstyle(o+"text-rotation"),s=r.strValue;return"none"===s?0:i&&"autorotate"===s?n.labelAutoAngle:"autorotate"===s?0:r.pfValue},ox.calculateLabelAngles=function(t){var e=this,n=t.isEdge(),i=t._private.rscratch;i.labelAngle=e.calculateLabelAngle(t),n&&(i.sourceLabelAngle=e.calculateLabelAngle(t,"source"),i.targetLabelAngle=e.calculateLabelAngle(t,"target"))};var ax={},lx=!1;ax.getNodeShape=function(t){var e=t.pstyle("shape").value;if("cutrectangle"===e&&(t.width()<28||t.height()<28))return lx||(Lv("The `cutrectangle` node shape can not be used at small sizes so `rectangle` is used instead"),lx=!0),"rectangle";if(t.isParent())return"rectangle"===e||"roundrectangle"===e||"round-rectangle"===e||"cutrectangle"===e||"cut-rectangle"===e||"barrel"===e?e:"rectangle";if("polygon"===e){var n=t.pstyle("shape-polygon-points").value;return this.nodeShapes.makePolygon(n).name}return e};var cx={registerCalculationListeners:function(){var t=this.cy,e=t.collection(),n=this,i=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.merge(t),n)for(var i=0;i<t.length;i++){var o=t[i],r=o._private,s=r.rstyle;s.clean=!1,s.cleanConnected=!1}};n.binder(t).on("bounds.* dirty.*",(function(t){var e=t.target;i(e)})).on("style.* background.*",(function(t){var e=t.target;i(e,!1)}));var o=function(o){if(o){var r=n.onUpdateEleCalcsFns;e.cleanStyle();for(var s=0;s<e.length;s++){var a=e[s],l=a._private.rstyle;a.isNode()&&!l.cleanConnected&&(i(a.connectedEdges()),l.cleanConnected=!0)}if(r)for(var c=0;c<r.length;c++){(0,r[c])(o,e)}n.recalculateRenderedStyle(e),e=t.collection()}};n.flushRenderedStyleQueue=function(){o(!0)},n.beforeRender(o,n.beforeRenderPriorities.eleCalcs)},onUpdateEleCalcs:function(t){(this.onUpdateEleCalcsFns=this.onUpdateEleCalcsFns||[]).push(t)},recalculateRenderedStyle:function(t,e){var n=function(t){return t._private.rstyle.cleanConnected},i=[],o=[];if(!this.destroyed){void 0===e&&(e=!0);for(var r=0;r<t.length;r++){var s=t[r],a=s._private,l=a.rstyle;!s.isEdge()||n(s.source())&&n(s.target())||(l.clean=!1),e&&l.clean||s.removed()||"none"!==s.pstyle("display").value&&("nodes"===a.group?o.push(s):i.push(s),l.clean=!0)}for(var c=0;c<o.length;c++){var d=o[c],u=d._private.rstyle,h=d.position();this.recalculateNodeLabelProjection(d),u.nodeX=h.x,u.nodeY=h.y,u.nodeW=d.pstyle("width").pfValue,u.nodeH=d.pstyle("height").pfValue}this.recalculateEdgeProjections(i);for(var p=0;p<i.length;p++){var g=i[p]._private,f=g.rstyle,m=g.rscratch;f.srcX=m.arrowStartX,f.srcY=m.arrowStartY,f.tgtX=m.arrowEndX,f.tgtY=m.arrowEndY,f.midX=m.midX,f.midY=m.midY,f.labelAngle=m.labelAngle,f.sourceLabelAngle=m.sourceLabelAngle,f.targetLabelAngle=m.targetLabelAngle}}}},dx={updateCachedGrabbedEles:function(){var t=this.cachedZSortedEles;if(t){t.drag=[],t.nondrag=[];for(var e=[],n=0;n<t.length;n++){var i=(o=t[n])._private.rscratch;o.grabbed()&&!o.isParent()?e.push(o):i.inDragLayer?t.drag.push(o):t.nondrag.push(o)}for(n=0;n<e.length;n++){var o=e[n];t.drag.push(o)}}},invalidateCachedZSortedEles:function(){this.cachedZSortedEles=null},getCachedZSortedEles:function(t){if(t||!this.cachedZSortedEles){var e=this.cy.mutableElements().toArray();e.sort(ZT),e.interactive=e.filter((function(t){return t.interactive()})),this.cachedZSortedEles=e,this.updateCachedGrabbedEles()}else e=this.cachedZSortedEles;return e}},ux={};[qC,ZC,QC,ex,nx,ox,ax,cx,dx].forEach((function(t){rv(ux,t)}));var hx={getCachedImage:function(t,e,n){var i=this.imageCache=this.imageCache||{},o=i[t];if(o)return o.image.complete||o.image.addEventListener("load",n),o.image;var r=(o=i[t]=i[t]||{}).image=new Image;r.addEventListener("load",n),r.addEventListener("error",(function(){r.error=!0}));var s="data:";return t.substring(0,s.length).toLowerCase()===s||(r.crossOrigin=e),r.src=t,r}},px={registerBinding:function(t,e,n,i){var o=Array.prototype.slice.apply(arguments,[1]),r=this.binder(t);return r.on.apply(r,o)}};px.binder=function(t){var e,n=this,i=t===window||t===document||t===document.body||(e=t,"undefined"!=typeof HTMLElement&&e instanceof HTMLElement);if(null==n.supportsPassiveEvents){var o=!1;try{var r=Object.defineProperty({},"passive",{get:function(){return o=!0,!0}});window.addEventListener("test",null,r)}catch(t){}n.supportsPassiveEvents=o}var s=function(e,o,r){var s=Array.prototype.slice.call(arguments);return i&&n.supportsPassiveEvents&&(s[2]={capture:null!=r&&r,passive:!1,once:!1}),n.bindings.push({target:t,args:s}),(t.addEventListener||t.on).apply(t,s),this};return{on:s,addEventListener:s,addListener:s,bind:s}},px.nodeIsDraggable=function(t){return t&&t.isNode()&&!t.locked()&&t.grabbable()},px.nodeIsGrabbable=function(t){return this.nodeIsDraggable(t)&&t.interactive()},px.load=function(){var t=this,e=function(t){return t.selected()},n=function(e,n,i,o){null==e&&(e=t.cy);for(var r=0;r<n.length;r++){var s=n[r];e.emit({originalEvent:i,type:s,position:o})}},i=function(t){return t.shiftKey||t.metaKey||t.ctrlKey},o=function(e,n){var i=!0;if(t.cy.hasCompoundNodes()&&e&&e.pannable())for(var o=0;n&&o<n.length;o++){if((e=n[o]).isNode()&&e.isParent()&&!e.pannable()){i=!1;break}}else i=!0;return i},r=function(t){t[0]._private.rscratch.inDragLayer=!0},s=function(t){t[0]._private.rscratch.isGrabTarget=!0},a=function(t,e){var n=e.addToList;n.has(t)||(n.merge(t),function(t){t[0]._private.grabbed=!0}(t))},l=function(e,n){n=n||{};var i=e.cy().hasCompoundNodes();n.inDragLayer&&(e.forEach(r),e.neighborhood().stdFilter((function(t){return!i||t.isEdge()})).forEach(r)),n.addToList&&e.forEach((function(t){a(t,n)})),function(t,e){if(t.cy().hasCompoundNodes()&&(null!=e.inDragLayer||null!=e.addToList)){var n=t.descendants();e.inDragLayer&&(n.forEach(r),n.connectedEdges().forEach(r)),e.addToList&&e.addToList.unmerge(n)}}(e,n),u(e,{inDragLayer:n.inDragLayer}),t.updateCachedGrabbedEles()},c=l,d=function(e){e&&(t.getCachedZSortedEles().forEach((function(t){!function(t){t[0]._private.grabbed=!1}(t),function(t){t[0]._private.rscratch.inDragLayer=!1}(t),function(t){t[0]._private.rscratch.isGrabTarget=!1}(t)})),t.updateCachedGrabbedEles())},u=function(t,e){if((null!=e.inDragLayer||null!=e.addToList)&&t.cy().hasCompoundNodes()){var n=t.ancestors().orphans();if(!n.same(t)){var i=n.descendants().spawnSelf().merge(n).unmerge(t).unmerge(t.descendants()),o=i.connectedEdges();e.inDragLayer&&(o.forEach(r),i.forEach(r)),e.addToList&&i.forEach((function(t){a(t,e)}))}}},h=function(){null!=document.activeElement&&null!=document.activeElement.blur&&document.activeElement.blur()},p="undefined"!=typeof MutationObserver,g="undefined"!=typeof ResizeObserver;p?(t.removeObserver=new MutationObserver((function(e){for(var n=0;n<e.length;n++){var i=e[n].removedNodes;if(i)for(var o=0;o<i.length;o++){if(i[o]===t.container){t.destroy();break}}}})),t.container.parentNode&&t.removeObserver.observe(t.container.parentNode,{childList:!0})):t.registerBinding(t.container,"DOMNodeRemoved",(function(e){t.destroy()}));var f=C_((function(){t.cy.resize()}),100);p&&(t.styleObserver=new MutationObserver(f),t.styleObserver.observe(t.container,{attributes:!0})),t.registerBinding(window,"resize",f),g&&(t.resizeObserver=new ResizeObserver(f),t.resizeObserver.observe(t.container));var m=function(){t.invalidateContainerClientCoordsCache()};!function(t,e){for(;null!=t;)e(t),t=t.parentNode}(t.container,(function(e){t.registerBinding(e,"transitionend",m),t.registerBinding(e,"animationend",m),t.registerBinding(e,"scroll",m)})),t.registerBinding(t.container,"contextmenu",(function(t){t.preventDefault()}));var _=function(e){for(var n=t.findContainerClientCoords(),i=n[0],o=n[1],r=n[2],s=n[3],a=e.touches?e.touches:[e],l=!1,c=0;c<a.length;c++){var d=a[c];if(i<=d.clientX&&d.clientX<=i+r&&o<=d.clientY&&d.clientY<=o+s){l=!0;break}}if(!l)return!1;for(var u=t.container,h=e.target.parentNode,p=!1;h;){if(h===u){p=!0;break}h=h.parentNode}return!!p};t.registerBinding(t.container,"mousedown",(function(e){if(_(e)){e.preventDefault(),h(),t.hoverData.capture=!0,t.hoverData.which=e.which;var i=t.cy,o=[e.clientX,e.clientY],r=t.projectIntoViewport(o[0],o[1]),a=t.selection,d=t.findNearestElements(r[0],r[1],!0,!1),u=d[0],p=t.dragData.possibleDragElements;t.hoverData.mdownPos=r,t.hoverData.mdownGPos=o;if(3==e.which){t.hoverData.cxtStarted=!0;var g={originalEvent:e,type:"cxttapstart",position:{x:r[0],y:r[1]}};u?(u.activate(),u.emit(g),t.hoverData.down=u):i.emit(g),t.hoverData.downTime=(new Date).getTime(),t.hoverData.cxtDragged=!1}else if(1==e.which){if(u&&u.activate(),null!=u&&t.nodeIsGrabbable(u)){var f=function(t){return{originalEvent:e,type:t,position:{x:r[0],y:r[1]}}};if(s(u),u.selected()){p=t.dragData.possibleDragElements=i.collection();var m=i.$((function(e){return e.isNode()&&e.selected()&&t.nodeIsGrabbable(e)}));l(m,{addToList:p}),u.emit(f("grabon")),m.forEach((function(t){t.emit(f("grab"))}))}else p=t.dragData.possibleDragElements=i.collection(),c(u,{addToList:p}),u.emit(f("grabon")).emit(f("grab"));t.redrawHint("eles",!0),t.redrawHint("drag",!0)}t.hoverData.down=u,t.hoverData.downs=d,t.hoverData.downTime=(new Date).getTime(),n(u,["mousedown","tapstart","vmousedown"],e,{x:r[0],y:r[1]}),null==u?(a[4]=1,t.data.bgActivePosistion={x:r[0],y:r[1]},t.redrawHint("select",!0),t.redraw()):u.pannable()&&(a[4]=1),t.hoverData.tapholdCancelled=!1,clearTimeout(t.hoverData.tapholdTimeout),t.hoverData.tapholdTimeout=setTimeout((function(){if(!t.hoverData.tapholdCancelled){var n=t.hoverData.down;n?n.emit({originalEvent:e,type:"taphold",position:{x:r[0],y:r[1]}}):i.emit({originalEvent:e,type:"taphold",position:{x:r[0],y:r[1]}})}}),t.tapholdDuration)}a[0]=a[2]=r[0],a[1]=a[3]=r[1]}}),!1),t.registerBinding(window,"mousemove",(function(e){if(t.hoverData.capture||_(e)){var r=!1,s=t.cy,a=s.zoom(),c=[e.clientX,e.clientY],u=t.projectIntoViewport(c[0],c[1]),h=t.hoverData.mdownPos,p=t.hoverData.mdownGPos,g=t.selection,f=null;t.hoverData.draggingEles||t.hoverData.dragging||t.hoverData.selecting||(f=t.findNearestElement(u[0],u[1],!0,!1));var m,v=t.hoverData.last,y=t.hoverData.down,b=[u[0]-g[2],u[1]-g[3]],E=t.dragData.possibleDragElements;if(p){var T=c[0]-p[0],R=T*T,C=c[1]-p[1],x=R+C*C;t.hoverData.isOverThresholdDrag=m=x>=t.desktopTapThreshold2}var S=i(e);m&&(t.hoverData.tapholdCancelled=!0);r=!0,n(f,["mousemove","vmousemove","tapdrag"],e,{x:u[0],y:u[1]});var I=function(){t.data.bgActivePosistion=void 0,t.hoverData.selecting||s.emit({originalEvent:e,type:"boxstart",position:{x:u[0],y:u[1]}}),g[4]=1,t.hoverData.selecting=!0,t.redrawHint("select",!0),t.redraw()};if(3===t.hoverData.which){if(m){var O={originalEvent:e,type:"cxtdrag",position:{x:u[0],y:u[1]}};y?y.emit(O):s.emit(O),t.hoverData.cxtDragged=!0,t.hoverData.cxtOver&&f===t.hoverData.cxtOver||(t.hoverData.cxtOver&&t.hoverData.cxtOver.emit({originalEvent:e,type:"cxtdragout",position:{x:u[0],y:u[1]}}),t.hoverData.cxtOver=f,f&&f.emit({originalEvent:e,type:"cxtdragover",position:{x:u[0],y:u[1]}}))}}else if(t.hoverData.dragging){if(r=!0,s.panningEnabled()&&s.userPanningEnabled()){var k;if(t.hoverData.justStartedPan){var w=t.hoverData.mdownPos;k={x:(u[0]-w[0])*a,y:(u[1]-w[1])*a},t.hoverData.justStartedPan=!1}else k={x:b[0]*a,y:b[1]*a};s.panBy(k),t.hoverData.dragged=!0}u=t.projectIntoViewport(e.clientX,e.clientY)}else if(1!=g[4]||null!=y&&!y.pannable()){if(y&&y.pannable()&&y.active()&&y.unactivate(),y&&y.grabbed()||f==v||(v&&n(v,["mouseout","tapdragout"],e,{x:u[0],y:u[1]}),f&&n(f,["mouseover","tapdragover"],e,{x:u[0],y:u[1]}),t.hoverData.last=f),y)if(m){if(s.boxSelectionEnabled()&&S)y&&y.grabbed()&&(d(E),y.emit("freeon"),E.emit("free"),t.dragData.didDrag&&(y.emit("dragfreeon"),E.emit("dragfree"))),I();else if(y&&y.grabbed()&&t.nodeIsDraggable(y)){var A=!t.dragData.didDrag;A&&t.redrawHint("eles",!0),t.dragData.didDrag=!0;var D=s.collection();t.hoverData.draggingEles||l(E,{inDragLayer:!0});var N={x:0,y:0};if(W_(b[0])&&W_(b[1])&&(N.x+=b[0],N.y+=b[1],A)){var L=t.hoverData.dragDelta;L&&W_(L[0])&&W_(L[1])&&(N.x+=L[0],N.y+=L[1])}for(var P=0;P<E.length;P++){var M=E[P];t.nodeIsDraggable(M)&&M.grabbed()&&D.push(M)}t.hoverData.draggingEles=!0,D.silentShift(N).emit("position drag"),t.redrawHint("drag",!0),t.redraw()}}else!function(){var e=t.hoverData.dragDelta=t.hoverData.dragDelta||[];0===e.length?(e.push(b[0]),e.push(b[1])):(e[0]+=b[0],e[1]+=b[1])}();r=!0}else if(m){if(t.hoverData.dragging||!s.boxSelectionEnabled()||!S&&s.panningEnabled()&&s.userPanningEnabled()){if(!t.hoverData.selecting&&s.panningEnabled()&&s.userPanningEnabled()){o(y,t.hoverData.downs)&&(t.hoverData.dragging=!0,t.hoverData.justStartedPan=!0,g[4]=0,t.data.bgActivePosistion=uy(h),t.redrawHint("select",!0),t.redraw())}}else I();y&&y.pannable()&&y.active()&&y.unactivate()}return g[2]=u[0],g[3]=u[1],r?(e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),!1):void 0}}),!1),t.registerBinding(window,"mouseup",(function(o){if(t.hoverData.capture){t.hoverData.capture=!1;var r=t.cy,s=t.projectIntoViewport(o.clientX,o.clientY),a=t.selection,l=t.findNearestElement(s[0],s[1],!0,!1),c=t.dragData.possibleDragElements,u=t.hoverData.down,h=i(o);if(t.data.bgActivePosistion&&(t.redrawHint("select",!0),t.redraw()),t.hoverData.tapholdCancelled=!0,t.data.bgActivePosistion=void 0,u&&u.unactivate(),3===t.hoverData.which){var p={originalEvent:o,type:"cxttapend",position:{x:s[0],y:s[1]}};if(u?u.emit(p):r.emit(p),!t.hoverData.cxtDragged){var g={originalEvent:o,type:"cxttap",position:{x:s[0],y:s[1]}};u?u.emit(g):r.emit(g)}t.hoverData.cxtDragged=!1,t.hoverData.which=null}else if(1===t.hoverData.which){if(n(l,["mouseup","tapend","vmouseup"],o,{x:s[0],y:s[1]}),t.dragData.didDrag||t.hoverData.dragged||t.hoverData.selecting||t.hoverData.isOverThresholdDrag||n(u,["click","tap","vclick"],o,{x:s[0],y:s[1]}),null!=u||t.dragData.didDrag||t.hoverData.selecting||t.hoverData.dragged||i(o)||(r.$(e).unselect(["tapunselect"]),c.length>0&&t.redrawHint("eles",!0),t.dragData.possibleDragElements=c=r.collection()),l!=u||t.dragData.didDrag||t.hoverData.selecting||null!=l&&l._private.selectable&&(t.hoverData.dragging||("additive"===r.selectionType()||h?l.selected()?l.unselect(["tapunselect"]):l.select(["tapselect"]):h||(r.$(e).unmerge(l).unselect(["tapunselect"]),l.select(["tapselect"]))),t.redrawHint("eles",!0)),t.hoverData.selecting){var f=r.collection(t.getAllInBox(a[0],a[1],a[2],a[3]));t.redrawHint("select",!0),f.length>0&&t.redrawHint("eles",!0),r.emit({type:"boxend",originalEvent:o,position:{x:s[0],y:s[1]}});var m=function(t){return t.selectable()&&!t.selected()};"additive"===r.selectionType()||h||r.$(e).unmerge(f).unselect(),f.emit("box").stdFilter(m).select().emit("boxselect"),t.redraw()}if(t.hoverData.dragging&&(t.hoverData.dragging=!1,t.redrawHint("select",!0),t.redrawHint("eles",!0),t.redraw()),!a[4]){t.redrawHint("drag",!0),t.redrawHint("eles",!0);var _=u&&u.grabbed();d(c),_&&(u.emit("freeon"),c.emit("free"),t.dragData.didDrag&&(u.emit("dragfreeon"),c.emit("dragfree")))}}a[4]=0,t.hoverData.down=null,t.hoverData.cxtStarted=!1,t.hoverData.draggingEles=!1,t.hoverData.selecting=!1,t.hoverData.isOverThresholdDrag=!1,t.dragData.didDrag=!1,t.hoverData.dragged=!1,t.hoverData.dragDelta=[],t.hoverData.mdownPos=null,t.hoverData.mdownGPos=null}}),!1);var v,y,b,E,T,R,C,x,S,I,O,k,w,A=function(e){if(!t.scrollingPage){var n=t.cy,i=n.zoom(),o=n.pan(),r=t.projectIntoViewport(e.clientX,e.clientY),s=[r[0]*i+o.x,r[1]*i+o.y];if(t.hoverData.draggingEles||t.hoverData.dragging||t.hoverData.cxtStarted||0!==t.selection[4])e.preventDefault();else if(n.panningEnabled()&&n.userPanningEnabled()&&n.zoomingEnabled()&&n.userZoomingEnabled()){var a;e.preventDefault(),t.data.wheelZooming=!0,clearTimeout(t.data.wheelTimeout),t.data.wheelTimeout=setTimeout((function(){t.data.wheelZooming=!1,t.redrawHint("eles",!0),t.redraw()}),150),a=null!=e.deltaY?e.deltaY/-250:null!=e.wheelDeltaY?e.wheelDeltaY/1e3:e.wheelDelta/1e3,a*=t.wheelSensitivity,1===e.deltaMode&&(a*=33);var l=n.zoom()*Math.pow(10,a);"gesturechange"===e.type&&(l=t.gestureStartZoom*e.scale),n.zoom({level:l,renderedPosition:{x:s[0],y:s[1]}})}}};t.registerBinding(t.container,"wheel",A,!0),t.registerBinding(window,"scroll",(function(e){t.scrollingPage=!0,clearTimeout(t.scrollingPageTimeout),t.scrollingPageTimeout=setTimeout((function(){t.scrollingPage=!1}),250)}),!0),t.registerBinding(t.container,"gesturestart",(function(e){t.gestureStartZoom=t.cy.zoom(),t.hasTouchStarted||e.preventDefault()}),!0),t.registerBinding(t.container,"gesturechange",(function(e){t.hasTouchStarted||A(e)}),!0),t.registerBinding(t.container,"mouseout",(function(e){var n=t.projectIntoViewport(e.clientX,e.clientY);t.cy.emit({originalEvent:e,type:"mouseout",position:{x:n[0],y:n[1]}})}),!1),t.registerBinding(t.container,"mouseover",(function(e){var n=t.projectIntoViewport(e.clientX,e.clientY);t.cy.emit({originalEvent:e,type:"mouseover",position:{x:n[0],y:n[1]}})}),!1);var D,N,L,P,M=function(t,e,n,i){return Math.sqrt((n-t)*(n-t)+(i-e)*(i-e))},B=function(t,e,n,i){return(n-t)*(n-t)+(i-e)*(i-e)};if(t.registerBinding(t.container,"touchstart",D=function(e){if(t.hasTouchStarted=!0,_(e)){h(),t.touchData.capture=!0,t.data.bgActivePosistion=void 0;var i=t.cy,o=t.touchData.now,r=t.touchData.earlier;if(e.touches[0]){var a=t.projectIntoViewport(e.touches[0].clientX,e.touches[0].clientY);o[0]=a[0],o[1]=a[1]}if(e.touches[1]){a=t.projectIntoViewport(e.touches[1].clientX,e.touches[1].clientY);o[2]=a[0],o[3]=a[1]}if(e.touches[2]){a=t.projectIntoViewport(e.touches[2].clientX,e.touches[2].clientY);o[4]=a[0],o[5]=a[1]}if(e.touches[1]){t.touchData.singleTouchMoved=!0,d(t.dragData.touchDragEles);var u=t.findContainerClientCoords();S=u[0],I=u[1],O=u[2],k=u[3],v=e.touches[0].clientX-S,y=e.touches[0].clientY-I,b=e.touches[1].clientX-S,E=e.touches[1].clientY-I,w=0<=v&&v<=O&&0<=b&&b<=O&&0<=y&&y<=k&&0<=E&&E<=k;var p=i.pan(),g=i.zoom();T=M(v,y,b,E),R=B(v,y,b,E),x=[((C=[(v+b)/2,(y+E)/2])[0]-p.x)/g,(C[1]-p.y)/g];if(R<4e4&&!e.touches[2]){var f=t.findNearestElement(o[0],o[1],!0,!0),m=t.findNearestElement(o[2],o[3],!0,!0);return f&&f.isNode()?(f.activate().emit({originalEvent:e,type:"cxttapstart",position:{x:o[0],y:o[1]}}),t.touchData.start=f):m&&m.isNode()?(m.activate().emit({originalEvent:e,type:"cxttapstart",position:{x:o[0],y:o[1]}}),t.touchData.start=m):i.emit({originalEvent:e,type:"cxttapstart",position:{x:o[0],y:o[1]}}),t.touchData.start&&(t.touchData.start._private.grabbed=!1),t.touchData.cxt=!0,t.touchData.cxtDragged=!1,t.data.bgActivePosistion=void 0,void t.redraw()}}if(e.touches[2])i.boxSelectionEnabled()&&e.preventDefault();else if(e.touches[1]);else if(e.touches[0]){var A=t.findNearestElements(o[0],o[1],!0,!0),D=A[0];if(null!=D&&(D.activate(),t.touchData.start=D,t.touchData.starts=A,t.nodeIsGrabbable(D))){var N=t.dragData.touchDragEles=i.collection(),L=null;t.redrawHint("eles",!0),t.redrawHint("drag",!0),D.selected()?(L=i.$((function(e){return e.selected()&&t.nodeIsGrabbable(e)})),l(L,{addToList:N})):c(D,{addToList:N}),s(D);var P=function(t){return{originalEvent:e,type:t,position:{x:o[0],y:o[1]}}};D.emit(P("grabon")),L?L.forEach((function(t){t.emit(P("grab"))})):D.emit(P("grab"))}n(D,["touchstart","tapstart","vmousedown"],e,{x:o[0],y:o[1]}),null==D&&(t.data.bgActivePosistion={x:a[0],y:a[1]},t.redrawHint("select",!0),t.redraw()),t.touchData.singleTouchMoved=!1,t.touchData.singleTouchStartTime=+new Date,clearTimeout(t.touchData.tapholdTimeout),t.touchData.tapholdTimeout=setTimeout((function(){!1!==t.touchData.singleTouchMoved||t.pinching||t.touchData.selecting||n(t.touchData.start,["taphold"],e,{x:o[0],y:o[1]})}),t.tapholdDuration)}if(e.touches.length>=1){for(var F=t.touchData.startPosition=[],H=0;H<o.length;H++)F[H]=r[H]=o[H];var U=e.touches[0];t.touchData.startGPosition=[U.clientX,U.clientY]}}},!1),t.registerBinding(window,"touchmove",N=function(e){var i=t.touchData.capture;if(i||_(e)){var r=t.selection,s=t.cy,a=t.touchData.now,c=t.touchData.earlier,u=s.zoom();if(e.touches[0]){var h=t.projectIntoViewport(e.touches[0].clientX,e.touches[0].clientY);a[0]=h[0],a[1]=h[1]}if(e.touches[1]){h=t.projectIntoViewport(e.touches[1].clientX,e.touches[1].clientY);a[2]=h[0],a[3]=h[1]}if(e.touches[2]){h=t.projectIntoViewport(e.touches[2].clientX,e.touches[2].clientY);a[4]=h[0],a[5]=h[1]}var p,g=t.touchData.startGPosition;if(i&&e.touches[0]&&g){for(var f=[],m=0;m<a.length;m++)f[m]=a[m]-c[m];var C=e.touches[0].clientX-g[0],O=C*C,k=e.touches[0].clientY-g[1];p=O+k*k>=t.touchTapThreshold2}if(i&&t.touchData.cxt){e.preventDefault();var A=e.touches[0].clientX-S,D=e.touches[0].clientY-I,N=e.touches[1].clientX-S,L=e.touches[1].clientY-I,P=B(A,D,N,L);if(P/R>=2.25||P>=22500){t.touchData.cxt=!1,t.data.bgActivePosistion=void 0,t.redrawHint("select",!0);var F={originalEvent:e,type:"cxttapend",position:{x:a[0],y:a[1]}};t.touchData.start?(t.touchData.start.unactivate().emit(F),t.touchData.start=null):s.emit(F)}}if(i&&t.touchData.cxt){F={originalEvent:e,type:"cxtdrag",position:{x:a[0],y:a[1]}};t.data.bgActivePosistion=void 0,t.redrawHint("select",!0),t.touchData.start?t.touchData.start.emit(F):s.emit(F),t.touchData.start&&(t.touchData.start._private.grabbed=!1),t.touchData.cxtDragged=!0;var H=t.findNearestElement(a[0],a[1],!0,!0);t.touchData.cxtOver&&H===t.touchData.cxtOver||(t.touchData.cxtOver&&t.touchData.cxtOver.emit({originalEvent:e,type:"cxtdragout",position:{x:a[0],y:a[1]}}),t.touchData.cxtOver=H,H&&H.emit({originalEvent:e,type:"cxtdragover",position:{x:a[0],y:a[1]}}))}else if(i&&e.touches[2]&&s.boxSelectionEnabled())e.preventDefault(),t.data.bgActivePosistion=void 0,this.lastThreeTouch=+new Date,t.touchData.selecting||s.emit({originalEvent:e,type:"boxstart",position:{x:a[0],y:a[1]}}),t.touchData.selecting=!0,t.touchData.didSelect=!0,r[4]=1,r&&0!==r.length&&void 0!==r[0]?(r[2]=(a[0]+a[2]+a[4])/3,r[3]=(a[1]+a[3]+a[5])/3):(r[0]=(a[0]+a[2]+a[4])/3,r[1]=(a[1]+a[3]+a[5])/3,r[2]=(a[0]+a[2]+a[4])/3+1,r[3]=(a[1]+a[3]+a[5])/3+1),t.redrawHint("select",!0),t.redraw();else if(i&&e.touches[1]&&!t.touchData.didSelect&&s.zoomingEnabled()&&s.panningEnabled()&&s.userZoomingEnabled()&&s.userPanningEnabled()){if(e.preventDefault(),t.data.bgActivePosistion=void 0,t.redrawHint("select",!0),Q=t.dragData.touchDragEles){t.redrawHint("drag",!0);for(var U=0;U<Q.length;U++){var V=Q[U]._private;V.grabbed=!1,V.rscratch.inDragLayer=!1}}var G=t.touchData.start,W=(A=e.touches[0].clientX-S,D=e.touches[0].clientY-I,N=e.touches[1].clientX-S,L=e.touches[1].clientY-I,M(A,D,N,L)),z=W/T;if(w){var X=(A-v+(N-b))/2,j=(D-y+(L-E))/2,Y=s.zoom(),K=Y*z,$=s.pan(),J=x[0]*Y+$.x,q=x[1]*Y+$.y,Z={x:-K/Y*(J-$.x-X)+J,y:-K/Y*(q-$.y-j)+q};if(G&&G.active()){var Q=t.dragData.touchDragEles;d(Q),t.redrawHint("drag",!0),t.redrawHint("eles",!0),G.unactivate().emit("freeon"),Q.emit("free"),t.dragData.didDrag&&(G.emit("dragfreeon"),Q.emit("dragfree"))}s.viewport({zoom:K,pan:Z,cancelOnFailedZoom:!0}),T=W,v=A,y=D,b=N,E=L,t.pinching=!0}if(e.touches[0]){h=t.projectIntoViewport(e.touches[0].clientX,e.touches[0].clientY);a[0]=h[0],a[1]=h[1]}if(e.touches[1]){h=t.projectIntoViewport(e.touches[1].clientX,e.touches[1].clientY);a[2]=h[0],a[3]=h[1]}if(e.touches[2]){h=t.projectIntoViewport(e.touches[2].clientX,e.touches[2].clientY);a[4]=h[0],a[5]=h[1]}}else if(e.touches[0]&&!t.touchData.didSelect){var tt=t.touchData.start,et=t.touchData.last;if(t.hoverData.draggingEles||t.swipePanning||(H=t.findNearestElement(a[0],a[1],!0,!0)),i&&null!=tt&&e.preventDefault(),i&&null!=tt&&t.nodeIsDraggable(tt))if(p){Q=t.dragData.touchDragEles;var nt=!t.dragData.didDrag;nt&&l(Q,{inDragLayer:!0}),t.dragData.didDrag=!0;var it={x:0,y:0};if(W_(f[0])&&W_(f[1]))if(it.x+=f[0],it.y+=f[1],nt)t.redrawHint("eles",!0),(ot=t.touchData.dragDelta)&&W_(ot[0])&&W_(ot[1])&&(it.x+=ot[0],it.y+=ot[1]);t.hoverData.draggingEles=!0,Q.silentShift(it).emit("position drag"),t.redrawHint("drag",!0),t.touchData.startPosition[0]==c[0]&&t.touchData.startPosition[1]==c[1]&&t.redrawHint("eles",!0),t.redraw()}else{var ot;0===(ot=t.touchData.dragDelta=t.touchData.dragDelta||[]).length?(ot.push(f[0]),ot.push(f[1])):(ot[0]+=f[0],ot[1]+=f[1])}if(n(tt||H,["touchmove","tapdrag","vmousemove"],e,{x:a[0],y:a[1]}),tt&&tt.grabbed()||H==et||(et&&et.emit({originalEvent:e,type:"tapdragout",position:{x:a[0],y:a[1]}}),H&&H.emit({originalEvent:e,type:"tapdragover",position:{x:a[0],y:a[1]}})),t.touchData.last=H,i)for(U=0;U<a.length;U++)a[U]&&t.touchData.startPosition[U]&&p&&(t.touchData.singleTouchMoved=!0);if(i&&(null==tt||tt.pannable())&&s.panningEnabled()&&s.userPanningEnabled()){o(tt,t.touchData.starts)&&(e.preventDefault(),t.data.bgActivePosistion||(t.data.bgActivePosistion=uy(t.touchData.startPosition)),t.swipePanning?s.panBy({x:f[0]*u,y:f[1]*u}):p&&(t.swipePanning=!0,s.panBy({x:C*u,y:k*u}),tt&&(tt.unactivate(),t.redrawHint("select",!0),t.touchData.start=null)));h=t.projectIntoViewport(e.touches[0].clientX,e.touches[0].clientY);a[0]=h[0],a[1]=h[1]}}for(m=0;m<a.length;m++)c[m]=a[m];i&&e.touches.length>0&&!t.hoverData.draggingEles&&!t.swipePanning&&null!=t.data.bgActivePosistion&&(t.data.bgActivePosistion=void 0,t.redrawHint("select",!0),t.redraw())}},!1),t.registerBinding(window,"touchcancel",L=function(e){var n=t.touchData.start;t.touchData.capture=!1,n&&n.unactivate()}),t.registerBinding(window,"touchend",P=function(i){var o=t.touchData.start;if(t.touchData.capture){0===i.touches.length&&(t.touchData.capture=!1),i.preventDefault();var r=t.selection;t.swipePanning=!1,t.hoverData.draggingEles=!1;var s,a=t.cy,l=a.zoom(),c=t.touchData.now,u=t.touchData.earlier;if(i.touches[0]){var h=t.projectIntoViewport(i.touches[0].clientX,i.touches[0].clientY);c[0]=h[0],c[1]=h[1]}if(i.touches[1]){h=t.projectIntoViewport(i.touches[1].clientX,i.touches[1].clientY);c[2]=h[0],c[3]=h[1]}if(i.touches[2]){h=t.projectIntoViewport(i.touches[2].clientX,i.touches[2].clientY);c[4]=h[0],c[5]=h[1]}if(o&&o.unactivate(),t.touchData.cxt){if(s={originalEvent:i,type:"cxttapend",position:{x:c[0],y:c[1]}},o?o.emit(s):a.emit(s),!t.touchData.cxtDragged){var p={originalEvent:i,type:"cxttap",position:{x:c[0],y:c[1]}};o?o.emit(p):a.emit(p)}return t.touchData.start&&(t.touchData.start._private.grabbed=!1),t.touchData.cxt=!1,t.touchData.start=null,void t.redraw()}if(!i.touches[2]&&a.boxSelectionEnabled()&&t.touchData.selecting){t.touchData.selecting=!1;var g=a.collection(t.getAllInBox(r[0],r[1],r[2],r[3]));r[0]=void 0,r[1]=void 0,r[2]=void 0,r[3]=void 0,r[4]=0,t.redrawHint("select",!0),a.emit({type:"boxend",originalEvent:i,position:{x:c[0],y:c[1]}});g.emit("box").stdFilter((function(t){return t.selectable()&&!t.selected()})).select().emit("boxselect"),g.nonempty()&&t.redrawHint("eles",!0),t.redraw()}if(null!=o&&o.unactivate(),i.touches[2])t.data.bgActivePosistion=void 0,t.redrawHint("select",!0);else if(i.touches[1]);else if(i.touches[0]);else if(!i.touches[0]){t.data.bgActivePosistion=void 0,t.redrawHint("select",!0);var f=t.dragData.touchDragEles;if(null!=o){var m=o._private.grabbed;d(f),t.redrawHint("drag",!0),t.redrawHint("eles",!0),m&&(o.emit("freeon"),f.emit("free"),t.dragData.didDrag&&(o.emit("dragfreeon"),f.emit("dragfree"))),n(o,["touchend","tapend","vmouseup","tapdragout"],i,{x:c[0],y:c[1]}),o.unactivate(),t.touchData.start=null}else{var _=t.findNearestElement(c[0],c[1],!0,!0);n(_,["touchend","tapend","vmouseup","tapdragout"],i,{x:c[0],y:c[1]})}var v=t.touchData.startPosition[0]-c[0],y=v*v,b=t.touchData.startPosition[1]-c[1],E=(y+b*b)*l*l;t.touchData.singleTouchMoved||(o||a.$(":selected").unselect(["tapunselect"]),n(o,["tap","vclick"],i,{x:c[0],y:c[1]})),null!=o&&!t.dragData.didDrag&&o._private.selectable&&E<t.touchTapThreshold2&&!t.pinching&&("single"===a.selectionType()?(a.$(e).unmerge(o).unselect(["tapunselect"]),o.select(["tapselect"])):o.selected()?o.unselect(["tapunselect"]):o.select(["tapselect"]),t.redrawHint("eles",!0)),t.touchData.singleTouchMoved=!0}for(var T=0;T<c.length;T++)u[T]=c[T];t.dragData.didDrag=!1,0===i.touches.length&&(t.touchData.dragDelta=[],t.touchData.startPosition=null,t.touchData.startGPosition=null,t.touchData.didSelect=!1),i.touches.length<2&&(1===i.touches.length&&(t.touchData.startGPosition=[i.touches[0].clientX,i.touches[0].clientY]),t.pinching=!1,t.redrawHint("eles",!0),t.redraw())}},!1),"undefined"==typeof TouchEvent){var F=[],H=function(t){return{clientX:t.clientX,clientY:t.clientY,force:1,identifier:t.pointerId,pageX:t.pageX,pageY:t.pageY,radiusX:t.width/2,radiusY:t.height/2,screenX:t.screenX,screenY:t.screenY,target:t.target}},U=function(t){F.push(function(t){return{event:t,touch:H(t)}}(t))},V=function(t){for(var e=0;e<F.length;e++){if(F[e].event.pointerId===t.pointerId)return void F.splice(e,1)}},G=function(t){t.touches=F.map((function(t){return t.touch}))},W=function(t){return"mouse"===t.pointerType||4===t.pointerType};t.registerBinding(t.container,"pointerdown",(function(t){W(t)||(t.preventDefault(),U(t),G(t),D(t))})),t.registerBinding(t.container,"pointerup",(function(t){W(t)||(V(t),G(t),P(t))})),t.registerBinding(t.container,"pointercancel",(function(t){W(t)||(V(t),G(t),L())})),t.registerBinding(t.container,"pointermove",(function(t){W(t)||(t.preventDefault(),function(t){var e=F.filter((function(e){return e.event.pointerId===t.pointerId}))[0];e.event=t,e.touch=H(t)}(t),G(t),N(t))}))}};var gx={generatePolygon:function(t,e){return this.nodeShapes[t]={renderer:this,name:t,points:e,draw:function(t,e,n,i,o){this.renderer.nodeShapeImpl("polygon",t,e,n,i,o,this.points)},intersectLine:function(t,e,n,i,o,r,s){return Gy(o,r,this.points,t,e,n/2,i/2,s)},checkPoint:function(t,e,n,i,o,r,s){return Py(t,e,this.points,r,s,i,o,[0,-1],n)}}}};gx.generateEllipse=function(){return this.nodeShapes.ellipse={renderer:this,name:"ellipse",draw:function(t,e,n,i,o){this.renderer.nodeShapeImpl(this.name,t,e,n,i,o)},intersectLine:function(t,e,n,i,o,r,s){return function(t,e,n,i,o,r){var s=n-t,a=i-e;s/=o,a/=r;var l=Math.sqrt(s*s+a*a),c=l-1;if(c<0)return[];var d=c/l;return[(n-t)*d+t,(i-e)*d+e]}(o,r,t,e,n/2+s,i/2+s)},checkPoint:function(t,e,n,i,o,r,s){return Fy(t,e,i,o,r,s,n)}}},gx.generateRoundPolygon=function(t,e){for(var n=new Array(2*e.length),i=0;i<e.length/2;i++){var o=2*i,r=void 0;r=i<e.length/2-1?2*(i+1):0,n[4*i]=e[o],n[4*i+1]=e[o+1];var s=e[r]-e[o],a=e[r+1]-e[o+1],l=Math.sqrt(s*s+a*a);n[4*i+2]=s/l,n[4*i+3]=a/l}return this.nodeShapes[t]={renderer:this,name:t,points:n,draw:function(t,e,n,i,o){this.renderer.nodeShapeImpl("round-polygon",t,e,n,i,o,this.points)},intersectLine:function(t,e,n,i,o,r,s){return function(t,e,n,i,o,r,s,a){for(var l,c=[],d=new Array(n.length),u=r/2,h=s/2,p=Ky(r,s),g=0;g<n.length/4;g++){var f,m=void 0;m=0===g?n.length-2:4*g-2,f=4*g+2;var _=i+u*n[4*g],v=o+h*n[4*g+1],y=-n[m]*n[f]-n[m+1]*n[f+1],b=p/Math.tan(Math.acos(y)/2),E=_-b*n[m],T=v-b*n[m+1],R=_+b*n[f],C=v+b*n[f+1];0===g?(d[n.length-2]=E,d[n.length-1]=T):(d[4*g-2]=E,d[4*g-1]=T),d[4*g]=R,d[4*g+1]=C;var x=n[m+1],S=-n[m];x*n[f]+S*n[f+1]<0&&(x*=-1,S*=-1),0!==(l=Hy(t,e,i,o,E+x*p,T+S*p,p)).length&&c.push(l[0],l[1])}for(var I=0;I<d.length/4;I++)0!==(l=Vy(t,e,i,o,d[4*I],d[4*I+1],d[4*I+2],d[4*I+3],!1)).length&&c.push(l[0],l[1]);if(c.length>2){for(var O=[c[0],c[1]],k=Math.pow(O[0]-t,2)+Math.pow(O[1]-e,2),w=1;w<c.length/2;w++){var A=Math.pow(c[2*w]-t,2)+Math.pow(c[2*w+1]-e,2);A<=k&&(O[0]=c[2*w],O[1]=c[2*w+1],k=A)}return O}return c}(o,r,this.points,t,e,n,i)},checkPoint:function(t,e,n,i,o,r,s){return function(t,e,n,i,o,r,s){for(var a=new Array(n.length),l=r/2,c=s/2,d=Ky(r,s),u=d*d,h=0;h<n.length/4;h++){var p,g=void 0;g=0===h?n.length-2:4*h-2,p=4*h+2;var f=i+l*n[4*h],m=o+c*n[4*h+1],_=-n[g]*n[p]-n[g+1]*n[p+1],v=d/Math.tan(Math.acos(_)/2),y=f-v*n[g],b=m-v*n[g+1],E=f+v*n[p],T=m+v*n[p+1];a[4*h]=y,a[4*h+1]=b,a[4*h+2]=E,a[4*h+3]=T;var R=n[g+1],C=-n[g];R*n[p]+C*n[p+1]<0&&(R*=-1,C*=-1);var x=y+R*d,S=b+C*d;if(Math.pow(x-t,2)+Math.pow(S-e,2)<=u)return!0}return Ly(t,e,a)}(t,e,this.points,r,s,i,o)}}},gx.generateRoundRectangle=function(){return this.nodeShapes["round-rectangle"]=this.nodeShapes.roundrectangle={renderer:this,name:"round-rectangle",points:zy(4,0),draw:function(t,e,n,i,o){this.renderer.nodeShapeImpl(this.name,t,e,n,i,o)},intersectLine:function(t,e,n,i,o,r,s){return ky(o,r,t,e,n,i,s)},checkPoint:function(t,e,n,i,o,r,s){var a=Yy(i,o),l=2*a;return!!Py(t,e,this.points,r,s,i,o-l,[0,-1],n)||(!!Py(t,e,this.points,r,s,i-l,o,[0,-1],n)||(!!Fy(t,e,l,l,r-i/2+a,s-o/2+a,n)||(!!Fy(t,e,l,l,r+i/2-a,s-o/2+a,n)||(!!Fy(t,e,l,l,r+i/2-a,s+o/2-a,n)||!!Fy(t,e,l,l,r-i/2+a,s+o/2-a,n)))))}}},gx.generateCutRectangle=function(){return this.nodeShapes["cut-rectangle"]=this.nodeShapes.cutrectangle={renderer:this,name:"cut-rectangle",cornerLength:8,points:zy(4,0),draw:function(t,e,n,i,o){this.renderer.nodeShapeImpl(this.name,t,e,n,i,o)},generateCutTrianglePts:function(t,e,n,i){var o=this.cornerLength,r=e/2,s=t/2,a=n-s,l=n+s,c=i-r,d=i+r;return{topLeft:[a,c+o,a+o,c,a+o,c+o],topRight:[l-o,c,l,c+o,l-o,c+o],bottomRight:[l,d-o,l-o,d,l-o,d-o],bottomLeft:[a+o,d,a,d-o,a+o,d-o]}},intersectLine:function(t,e,n,i,o,r,s){var a=this.generateCutTrianglePts(n+2*s,i+2*s,t,e),l=[].concat.apply([],[a.topLeft.splice(0,4),a.topRight.splice(0,4),a.bottomRight.splice(0,4),a.bottomLeft.splice(0,4)]);return Gy(o,r,l,t,e)},checkPoint:function(t,e,n,i,o,r,s){if(Py(t,e,this.points,r,s,i,o-2*this.cornerLength,[0,-1],n))return!0;if(Py(t,e,this.points,r,s,i-2*this.cornerLength,o,[0,-1],n))return!0;var a=this.generateCutTrianglePts(i,o,r,s);return Ly(t,e,a.topLeft)||Ly(t,e,a.topRight)||Ly(t,e,a.bottomRight)||Ly(t,e,a.bottomLeft)}}},gx.generateBarrel=function(){return this.nodeShapes.barrel={renderer:this,name:"barrel",points:zy(4,0),draw:function(t,e,n,i,o){this.renderer.nodeShapeImpl(this.name,t,e,n,i,o)},intersectLine:function(t,e,n,i,o,r,s){var a=this.generateBarrelBezierPts(n+2*s,i+2*s,t,e),l=function(t){var e=yy({x:t[0],y:t[1]},{x:t[2],y:t[3]},{x:t[4],y:t[5]},.15),n=yy({x:t[0],y:t[1]},{x:t[2],y:t[3]},{x:t[4],y:t[5]},.5),i=yy({x:t[0],y:t[1]},{x:t[2],y:t[3]},{x:t[4],y:t[5]},.85);return[t[0],t[1],e.x,e.y,n.x,n.y,i.x,i.y,t[4],t[5]]},c=[].concat(l(a.topLeft),l(a.topRight),l(a.bottomRight),l(a.bottomLeft));return Gy(o,r,c,t,e)},generateBarrelBezierPts:function(t,e,n,i){var o=e/2,r=t/2,s=n-r,a=n+r,l=i-o,c=i+o,d=$y(t,e),u=d.heightOffset,h=d.widthOffset,p=d.ctrlPtOffsetPct*t,g={topLeft:[s,l+u,s+p,l,s+h,l],topRight:[a-h,l,a-p,l,a,l+u],bottomRight:[a,c-u,a-p,c,a-h,c],bottomLeft:[s+h,c,s+p,c,s,c-u]};return g.topLeft.isTop=!0,g.topRight.isTop=!0,g.bottomLeft.isBottom=!0,g.bottomRight.isBottom=!0,g},checkPoint:function(t,e,n,i,o,r,s){var a=$y(i,o),l=a.heightOffset,c=a.widthOffset;if(Py(t,e,this.points,r,s,i,o-2*l,[0,-1],n))return!0;if(Py(t,e,this.points,r,s,i-2*c,o,[0,-1],n))return!0;for(var d=this.generateBarrelBezierPts(i,o,r,s),u=function(t,e,n){var i,o,r=n[4],s=n[2],a=n[0],l=n[5],c=n[1],d=Math.min(r,a),u=Math.max(r,a),h=Math.min(l,c),p=Math.max(l,c);if(d<=t&&t<=u&&h<=e&&e<=p){var g=[(i=r)-2*(o=s)+a,2*(o-i),i],f=function(t,e,n,i){var o=e*e-4*t*(n-=i);if(o<0)return[];var r=Math.sqrt(o),s=2*t;return[(-e+r)/s,(-e-r)/s]}(g[0],g[1],g[2],t).filter((function(t){return 0<=t&&t<=1}));if(f.length>0)return f[0]}return null},h=Object.keys(d),p=0;p<h.length;p++){var g=d[h[p]],f=u(t,e,g);if(null!=f){var m=g[5],_=g[3],v=g[1],y=vy(m,_,v,f);if(g.isTop&&y<=e)return!0;if(g.isBottom&&e<=y)return!0}}return!1}}},gx.generateBottomRoundrectangle=function(){return this.nodeShapes["bottom-round-rectangle"]=this.nodeShapes.bottomroundrectangle={renderer:this,name:"bottom-round-rectangle",points:zy(4,0),draw:function(t,e,n,i,o){this.renderer.nodeShapeImpl(this.name,t,e,n,i,o)},intersectLine:function(t,e,n,i,o,r,s){var a=e-(i/2+s),l=Vy(o,r,t,e,t-(n/2+s),a,t+(n/2+s),a,!1);return l.length>0?l:ky(o,r,t,e,n,i,s)},checkPoint:function(t,e,n,i,o,r,s){var a=Yy(i,o),l=2*a;if(Py(t,e,this.points,r,s,i,o-l,[0,-1],n))return!0;if(Py(t,e,this.points,r,s,i-l,o,[0,-1],n))return!0;var c=i/2+2*n,d=o/2+2*n;return!!Ly(t,e,[r-c,s-d,r-c,s,r+c,s,r+c,s-d])||(!!Fy(t,e,l,l,r+i/2-a,s+o/2-a,n)||!!Fy(t,e,l,l,r-i/2+a,s+o/2-a,n))}}},gx.registerNodeShapes=function(){var t=this.nodeShapes={},e=this;this.generateEllipse(),this.generatePolygon("triangle",zy(3,0)),this.generateRoundPolygon("round-triangle",zy(3,0)),this.generatePolygon("rectangle",zy(4,0)),t.square=t.rectangle,this.generateRoundRectangle(),this.generateCutRectangle(),this.generateBarrel(),this.generateBottomRoundrectangle();var n=[0,1,1,0,0,-1,-1,0];this.generatePolygon("diamond",n),this.generateRoundPolygon("round-diamond",n),this.generatePolygon("pentagon",zy(5,0)),this.generateRoundPolygon("round-pentagon",zy(5,0)),this.generatePolygon("hexagon",zy(6,0)),this.generateRoundPolygon("round-hexagon",zy(6,0)),this.generatePolygon("heptagon",zy(7,0)),this.generateRoundPolygon("round-heptagon",zy(7,0)),this.generatePolygon("octagon",zy(8,0)),this.generateRoundPolygon("round-octagon",zy(8,0));var i=new Array(20),o=jy(5,0),r=jy(5,Math.PI/5),s=.5*(3-Math.sqrt(5));s*=1.57;for(var a=0;a<r.length/2;a++)r[2*a]*=s,r[2*a+1]*=s;for(a=0;a<5;a++)i[4*a]=o[2*a],i[4*a+1]=o[2*a+1],i[4*a+2]=r[2*a],i[4*a+3]=r[2*a+1];i=Xy(i),this.generatePolygon("star",i),this.generatePolygon("vee",[-1,-1,0,-.333,1,-1,0,1]),this.generatePolygon("rhomboid",[-1,-1,.333,-1,1,1,-.333,1]),this.nodeShapes.concavehexagon=this.generatePolygon("concave-hexagon",[-1,-.95,-.75,0,-1,.95,1,.95,.75,0,1,-.95]);var l=[-1,-1,.25,-1,1,0,.25,1,-1,1];this.generatePolygon("tag",l),this.generateRoundPolygon("round-tag",l),t.makePolygon=function(t){var n,i="polygon-"+t.join("$");return(n=this[i])?n:e.generatePolygon(i,t)}};var fx={timeToRender:function(){return this.redrawTotalTime/this.redrawCount},redraw:function(t){t=t||Fv();var e=this;void 0===e.averageRedrawTime&&(e.averageRedrawTime=0),void 0===e.lastRedrawTime&&(e.lastRedrawTime=0),void 0===e.lastDrawTime&&(e.lastDrawTime=0),e.requestedFrame=!0,e.renderOptions=t},beforeRender:function(t,e){if(!this.destroyed){null==e&&Dv("Priority is not optional for beforeRender");var n=this.beforeRenderCallbacks;n.push({fn:t,priority:e}),n.sort((function(t,e){return e.priority-t.priority}))}}},mx=function(t,e,n){for(var i=t.beforeRenderCallbacks,o=0;o<i.length;o++)i[o].fn(e,n)};fx.startRenderLoop=function(){var t=this,e=t.cy;if(!t.renderLoopStarted){t.renderLoopStarted=!0;pv((function n(i){if(!t.destroyed){if(e.batching());else if(t.requestedFrame&&!t.skipFrame){mx(t,!0,i);var o=gv();t.render(t.renderOptions);var r=t.lastDrawTime=gv();void 0===t.averageRedrawTime&&(t.averageRedrawTime=r-o),void 0===t.redrawCount&&(t.redrawCount=0),t.redrawCount++,void 0===t.redrawTotalTime&&(t.redrawTotalTime=0);var s=r-o;t.redrawTotalTime+=s,t.lastRedrawTime=s,t.averageRedrawTime=t.averageRedrawTime/2+s/2,t.requestedFrame=!1}else mx(t,!1,i);t.skipFrame=!1,pv(n)}}))}};var _x=function(t){this.init(t)},vx=_x.prototype;vx.clientFunctions=["redrawHint","render","renderTo","matchCanvasSize","nodeShapeImpl","arrowShapeImpl"],vx.init=function(t){var e=this;e.options=t,e.cy=t.cy;var n=e.container=t.cy.container();if(D_){var i=D_.document,o=i.head,r="__________cytoscape_stylesheet",s="__________cytoscape_container",a=null!=i.getElementById(r);if(n.className.indexOf(s)<0&&(n.className=(n.className||"")+" "+s),!a){var l=i.createElement("style");l.id=r,l.innerHTML="."+s+" { position: relative; }",o.insertBefore(l,o.children[0])}"static"===D_.getComputedStyle(n).getPropertyValue("position")&&Lv("A Cytoscape container has style position:static and so can not use UI extensions properly")}e.selection=[void 0,void 0,void 0,void 0,0],e.bezierProjPcts=[.05,.225,.4,.5,.6,.775,.95],e.hoverData={down:null,last:null,downTime:null,triggerMode:null,dragging:!1,initialPan:[null,null],capture:!1},e.dragData={possibleDragElements:[]},e.touchData={start:null,capture:!1,startPosition:[null,null,null,null,null,null],singleTouchStartTime:null,singleTouchMoved:!0,now:[null,null,null,null,null,null],earlier:[null,null,null,null,null,null]},e.redraws=0,e.showFps=t.showFps,e.debug=t.debug,e.hideEdgesOnViewport=t.hideEdgesOnViewport,e.textureOnViewport=t.textureOnViewport,e.wheelSensitivity=t.wheelSensitivity,e.motionBlurEnabled=t.motionBlur,e.forcedPixelRatio=W_(t.pixelRatio)?t.pixelRatio:null,e.motionBlur=t.motionBlur,e.motionBlurOpacity=t.motionBlurOpacity,e.motionBlurTransparency=1-e.motionBlurOpacity,e.motionBlurPxRatio=1,e.mbPxRBlurry=1,e.minMbLowQualFrames=4,e.fullQualityMb=!1,e.clearedForMotionBlur=[],e.desktopTapThreshold=t.desktopTapThreshold,e.desktopTapThreshold2=t.desktopTapThreshold*t.desktopTapThreshold,e.touchTapThreshold=t.touchTapThreshold,e.touchTapThreshold2=t.touchTapThreshold*t.touchTapThreshold,e.tapholdDuration=500,e.bindings=[],e.beforeRenderCallbacks=[],e.beforeRenderPriorities={animations:400,eleCalcs:300,eleTxrDeq:200,lyrTxrDeq:150,lyrTxrSkip:100},e.registerNodeShapes(),e.registerArrowShapes(),e.registerCalculationListeners()},vx.notify=function(t,e){var n=this,i=n.cy;this.destroyed||("init"!==t?"destroy"!==t?(("add"===t||"remove"===t||"move"===t&&i.hasCompoundNodes()||"load"===t||"zorder"===t||"mount"===t)&&n.invalidateCachedZSortedEles(),"viewport"===t&&n.redrawHint("select",!0),"load"!==t&&"resize"!==t&&"mount"!==t||(n.invalidateContainerClientCoordsCache(),n.matchCanvasSize(n.container)),n.redrawHint("eles",!0),n.redrawHint("drag",!0),this.startRenderLoop(),this.redraw()):n.destroy():n.load())},vx.destroy=function(){var t=this;t.destroyed=!0,t.cy.stopAnimationLoop();for(var e=0;e<t.bindings.length;e++){var n=t.bindings[e],i=n.target;(i.off||i.removeEventListener).apply(i,n.args)}if(t.bindings=[],t.beforeRenderCallbacks=[],t.onUpdateEleCalcsFns=[],t.removeObserver&&t.removeObserver.disconnect(),t.styleObserver&&t.styleObserver.disconnect(),t.resizeObserver&&t.resizeObserver.disconnect(),t.labelCalcDiv)try{document.body.removeChild(t.labelCalcDiv)}catch(t){}},vx.isHeadless=function(){return!1},[JC,ux,hx,px,gx,fx].forEach((function(t){rv(vx,t)}));var yx=function(t){return function(){var e=this,n=this.renderer;if(!e.dequeueingSetup){e.dequeueingSetup=!0;var i=C_((function(){n.redrawHint("eles",!0),n.redrawHint("drag",!0),n.redraw()}),t.deqRedrawThreshold),o=t.priority||Av;n.beforeRender((function(o,r){var s=gv(),a=n.averageRedrawTime,l=n.lastRedrawTime,c=[],d=n.cy.extent(),u=n.getPixelRatio();for(o||n.flushRenderedStyleQueue();;){var h=gv(),p=h-s,g=h-r;if(l<16.666666666666668){var f=16.666666666666668-(o?a:0);if(g>=t.deqFastCost*f)break}else if(o){if(p>=t.deqCost*l||p>=t.deqAvgCost*a)break}else if(g>=16.666666666666668*t.deqNoDrawCost)break;var m=t.deq(e,u,d);if(!(m.length>0))break;for(var _=0;_<m.length;_++)c.push(m[_])}c.length>0&&(t.onDeqd(e,c),!o&&t.shouldRedraw(e,c,u,d)&&i())}),o(e))}}},bx=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:kv;I_(this,t),this.idsByKey=new zv,this.keyForId=new zv,this.cachesByLvl=new zv,this.lvls=[],this.getKey=e,this.doesEleInvalidateKey=n}return k_(t,[{key:"getIdsFor",value:function(t){null==t&&Dv("Can not get id list for null key");var e=this.idsByKey,n=this.idsByKey.get(t);return n||(n=new jv,e.set(t,n)),n}},{key:"addIdForKey",value:function(t,e){null!=t&&this.getIdsFor(t).add(e)}},{key:"deleteIdForKey",value:function(t,e){null!=t&&this.getIdsFor(t).delete(e)}},{key:"getNumberOfIdsForKey",value:function(t){return null==t?0:this.getIdsFor(t).size}},{key:"updateKeyMappingFor",value:function(t){var e=t.id(),n=this.keyForId.get(e),i=this.getKey(t);this.deleteIdForKey(n,e),this.addIdForKey(i,e),this.keyForId.set(e,i)}},{key:"deleteKeyMappingFor",value:function(t){var e=t.id(),n=this.keyForId.get(e);this.deleteIdForKey(n,e),this.keyForId.delete(e)}},{key:"keyHasChangedFor",value:function(t){var e=t.id();return this.keyForId.get(e)!==this.getKey(t)}},{key:"isInvalid",value:function(t){return this.keyHasChangedFor(t)||this.doesEleInvalidateKey(t)}},{key:"getCachesAt",value:function(t){var e=this.cachesByLvl,n=this.lvls,i=e.get(t);return i||(i=new zv,e.set(t,i),n.push(t)),i}},{key:"getCache",value:function(t,e){return this.getCachesAt(e).get(t)}},{key:"get",value:function(t,e){var n=this.getKey(t),i=this.getCache(n,e);return null!=i&&this.updateKeyMappingFor(t),i}},{key:"getForCachedKey",value:function(t,e){var n=this.keyForId.get(t.id());return this.getCache(n,e)}},{key:"hasCache",value:function(t,e){return this.getCachesAt(e).has(t)}},{key:"has",value:function(t,e){var n=this.getKey(t);return this.hasCache(n,e)}},{key:"setCache",value:function(t,e,n){n.key=t,this.getCachesAt(e).set(t,n)}},{key:"set",value:function(t,e,n){var i=this.getKey(t);this.setCache(i,e,n),this.updateKeyMappingFor(t)}},{key:"deleteCache",value:function(t,e){this.getCachesAt(e).delete(t)}},{key:"delete",value:function(t,e){var n=this.getKey(t);this.deleteCache(n,e)}},{key:"invalidateKey",value:function(t){var e=this;this.lvls.forEach((function(n){return e.deleteCache(t,n)}))}},{key:"invalidate",value:function(t){var e=t.id(),n=this.keyForId.get(e);this.deleteKeyMappingFor(t);var i=this.doesEleInvalidateKey(t);return i&&this.invalidateKey(n),i||0===this.getNumberOfIdsForKey(n)}}]),t}(),Ex={dequeue:"dequeue",downscale:"downscale",highQuality:"highQuality"},Tx=Hv({getKey:null,doesEleInvalidateKey:kv,drawElement:null,getBoundingBox:null,getRotationPoint:null,getRotationOffset:null,isVisible:Ov,allowEdgeTxrCaching:!0,allowParentTxrCaching:!0}),Rx=function(t,e){var n=this;n.renderer=t,n.onDequeues=[];var i=Tx(e);rv(n,i),n.lookup=new bx(i.getKey,i.doesEleInvalidateKey),n.setupDequeueing()},Cx=Rx.prototype;Cx.reasons=Ex,Cx.getTextureQueue=function(t){var e=this;return e.eleImgCaches=e.eleImgCaches||{},e.eleImgCaches[t]=e.eleImgCaches[t]||[]},Cx.getRetiredTextureQueue=function(t){var e=this.eleImgCaches.retired=this.eleImgCaches.retired||{};return e[t]=e[t]||[]},Cx.getElementQueue=function(){return this.eleCacheQueue=this.eleCacheQueue||new x_((function(t,e){return e.reqs-t.reqs}))},Cx.getElementKeyToQueue=function(){return this.eleKeyToCacheQueue=this.eleKeyToCacheQueue||{}},Cx.getElement=function(t,e,n,i,o){var r=this,s=this.renderer,a=s.cy.zoom(),l=this.lookup;if(!e||0===e.w||0===e.h||isNaN(e.w)||isNaN(e.h)||!t.visible()||t.removed())return null;if(!r.allowEdgeTxrCaching&&t.isEdge()||!r.allowParentTxrCaching&&t.isParent())return null;if(null==i&&(i=Math.ceil(py(a*n))),i<-4)i=-4;else if(a>=7.99||i>3)return null;var c=Math.pow(2,i),d=e.h*c,u=e.w*c,h=s.eleTextBiggerThanMin(t,c);if(!this.isVisible(t,h))return null;var p,g=l.get(t,i);if(g&&g.invalidated&&(g.invalidated=!1,g.texture.invalidatedWidth-=g.width),g)return g;if(p=d<=25?25:d<=50?50:50*Math.ceil(d/50),d>1024||u>1024)return null;var f=r.getTextureQueue(p),m=f[f.length-2],_=function(){return r.recycleTexture(p,u)||r.addTexture(p,u)};m||(m=f[f.length-1]),m||(m=_()),m.width-m.usedWidth<u&&(m=_());for(var v,y=function(t){return t&&t.scaledLabelShown===h},b=o&&o===Ex.dequeue,E=o&&o===Ex.highQuality,T=o&&o===Ex.downscale,R=i+1;R<=3;R++){var C=l.get(t,R);if(C){v=C;break}}var x=v&&v.level===i+1?v:null,S=function(){m.context.drawImage(x.texture.canvas,x.x,0,x.width,x.height,m.usedWidth,0,u,d)};if(m.context.setTransform(1,0,0,1,0,0),m.context.clearRect(m.usedWidth,0,u,p),y(x))S();else if(y(v)){if(!E)return r.queueElement(t,v.level-1),v;for(var I=v.level;I>i;I--)x=r.getElement(t,e,n,I,Ex.downscale);S()}else{var O;if(!b&&!E&&!T)for(var k=i-1;k>=-4;k--){var w=l.get(t,k);if(w){O=w;break}}if(y(O))return r.queueElement(t,i),O;m.context.translate(m.usedWidth,0),m.context.scale(c,c),this.drawElement(m.context,t,e,h,!1),m.context.scale(1/c,1/c),m.context.translate(-m.usedWidth,0)}return g={x:m.usedWidth,texture:m,level:i,scale:c,width:u,height:d,scaledLabelShown:h},m.usedWidth+=Math.ceil(u+8),m.eleCaches.push(g),l.set(t,i,g),r.checkTextureFullness(m),g},Cx.invalidateElements=function(t){for(var e=0;e<t.length;e++)this.invalidateElement(t[e])},Cx.invalidateElement=function(t){var e=this,n=e.lookup,i=[];if(n.isInvalid(t)){for(var o=-4;o<=3;o++){var r=n.getForCachedKey(t,o);r&&i.push(r)}if(n.invalidate(t))for(var s=0;s<i.length;s++){var a=i[s],l=a.texture;l.invalidatedWidth+=a.width,a.invalidated=!0,e.checkTextureUtility(l)}e.removeFromQueue(t)}},Cx.checkTextureUtility=function(t){t.invalidatedWidth>=.2*t.width&&this.retireTexture(t)},Cx.checkTextureFullness=function(t){var e=this.getTextureQueue(t.height);t.usedWidth/t.width>.8&&t.fullnessChecks>=10?Uv(e,t):t.fullnessChecks++},Cx.retireTexture=function(t){var e=t.height,n=this.getTextureQueue(e),i=this.lookup;Uv(n,t),t.retired=!0;for(var o=t.eleCaches,r=0;r<o.length;r++){var s=o[r];i.deleteCache(s.key,s.level)}Vv(o),this.getRetiredTextureQueue(e).push(t)},Cx.addTexture=function(t,e){var n={};return this.getTextureQueue(t).push(n),n.eleCaches=[],n.height=t,n.width=Math.max(1024,e),n.usedWidth=0,n.invalidatedWidth=0,n.fullnessChecks=0,n.canvas=this.renderer.makeOffscreenCanvas(n.width,n.height),n.context=n.canvas.getContext("2d"),n},Cx.recycleTexture=function(t,e){for(var n=this.getTextureQueue(t),i=this.getRetiredTextureQueue(t),o=0;o<i.length;o++){var r=i[o];if(r.width>=e)return r.retired=!1,r.usedWidth=0,r.invalidatedWidth=0,r.fullnessChecks=0,Vv(r.eleCaches),r.context.setTransform(1,0,0,1,0,0),r.context.clearRect(0,0,r.width,r.height),Uv(i,r),n.push(r),r}},Cx.queueElement=function(t,e){var n=this.getElementQueue(),i=this.getElementKeyToQueue(),o=this.getKey(t),r=i[o];if(r)r.level=Math.max(r.level,e),r.eles.merge(t),r.reqs++,n.updateItem(r);else{var s={eles:t.spawn().merge(t),level:e,reqs:1,key:o};n.push(s),i[o]=s}},Cx.dequeue=function(t){for(var e=this,n=e.getElementQueue(),i=e.getElementKeyToQueue(),o=[],r=e.lookup,s=0;s<1&&n.size()>0;s++){var a=n.pop(),l=a.key,c=a.eles[0],d=r.hasCache(c,a.level);if(i[l]=null,!d){o.push(a);var u=e.getBoundingBox(c);e.getElement(c,u,t,a.level,Ex.dequeue)}}return o},Cx.removeFromQueue=function(t){var e=this.getElementQueue(),n=this.getElementKeyToQueue(),i=this.getKey(t),o=n[i];null!=o&&(1===o.eles.length?(o.reqs=Iv,e.updateItem(o),e.pop(),n[i]=null):o.eles.unmerge(t))},Cx.onDequeue=function(t){this.onDequeues.push(t)},Cx.offDequeue=function(t){Uv(this.onDequeues,t)},Cx.setupDequeueing=yx({deqRedrawThreshold:100,deqCost:.15,deqAvgCost:.1,deqNoDrawCost:.9,deqFastCost:.9,deq:function(t,e,n){return t.dequeue(e,n)},onDeqd:function(t,e){for(var n=0;n<t.onDequeues.length;n++){(0,t.onDequeues[n])(e)}},shouldRedraw:function(t,e,n,i){for(var o=0;o<e.length;o++)for(var r=e[o].eles,s=0;s<r.length;s++){var a=r[s].boundingBox();if(Sy(a,i))return!0}return!1},priority:function(t){return t.renderer.beforeRenderPriorities.eleTxrDeq}});var xx=function(t){var e=this,n=e.renderer=t,i=n.cy;e.layersByLevel={},e.firstGet=!0,e.lastInvalidationTime=gv()-500,e.skipping=!1,e.eleTxrDeqs=i.collection(),e.scheduleElementRefinement=C_((function(){e.refineElementTextures(e.eleTxrDeqs),e.eleTxrDeqs.unmerge(e.eleTxrDeqs)}),50),n.beforeRender((function(t,n){n-e.lastInvalidationTime<=250?e.skipping=!0:e.skipping=!1}),n.beforeRenderPriorities.lyrTxrSkip);e.layersQueue=new x_((function(t,e){return e.reqs-t.reqs})),e.setupDequeueing()},Sx=xx.prototype,Ix=0,Ox=Math.pow(2,53)-1;Sx.makeLayer=function(t,e){var n=Math.pow(2,e),i=Math.ceil(t.w*n),o=Math.ceil(t.h*n),r=this.renderer.makeOffscreenCanvas(i,o),s={id:Ix=++Ix%Ox,bb:t,level:e,width:i,height:o,canvas:r,context:r.getContext("2d"),eles:[],elesQueue:[],reqs:0},a=s.context,l=-s.bb.x1,c=-s.bb.y1;return a.scale(n,n),a.translate(l,c),s},Sx.getLayers=function(t,e,n){var i=this,o=i.renderer.cy.zoom(),r=i.firstGet;if(i.firstGet=!1,null==n)if((n=Math.ceil(py(o*e)))<-4)n=-4;else if(o>=3.99||n>2)return null;i.validateLayersElesOrdering(n,t);var s,a,l=i.layersByLevel,c=Math.pow(2,n),d=l[n]=l[n]||[];if(i.levelIsComplete(n,t))return d;!function(){var e=function(e){if(i.validateLayersElesOrdering(e,t),i.levelIsComplete(e,t))return a=l[e],!0},o=function(t){if(!a)for(var i=n+t;-4<=i&&i<=2&&!e(i);i+=t);};o(1),o(-1);for(var r=d.length-1;r>=0;r--){var s=d[r];s.invalid&&Uv(d,s)}}();var u=function(e){var o=(e=e||{}).after;if(function(){if(!s){s=Ey();for(var e=0;e<t.length;e++)n=s,i=t[e].boundingBox(),n.x1=Math.min(n.x1,i.x1),n.x2=Math.max(n.x2,i.x2),n.w=n.x2-n.x1,n.y1=Math.min(n.y1,i.y1),n.y2=Math.max(n.y2,i.y2),n.h=n.y2-n.y1}var n,i}(),s.w*c*(s.h*c)>16e6)return null;var r=i.makeLayer(s,n);if(null!=o){var a=d.indexOf(o)+1;d.splice(a,0,r)}else(void 0===e.insert||e.insert)&&d.unshift(r);return r};if(i.skipping&&!r)return null;for(var h=null,p=t.length/1,g=!r,f=0;f<t.length;f++){var m=t[f],_=m._private.rscratch,v=_.imgLayerCaches=_.imgLayerCaches||{},y=v[n];if(y)h=y;else{if((!h||h.eles.length>=p||!Oy(h.bb,m.boundingBox()))&&!(h=u({insert:!0,after:h})))return null;a||g?i.queueLayer(h,m):i.drawEleInLayer(h,m,n,e),h.eles.push(m),v[n]=h}}return a||(g?null:d)},Sx.getEleLevelForLayerLevel=function(t,e){return t},Sx.drawEleInLayer=function(t,e,n,i){var o=this.renderer,r=t.context,s=e.boundingBox();0!==s.w&&0!==s.h&&e.visible()&&(n=this.getEleLevelForLayerLevel(n,i),o.setImgSmoothing(r,!1),o.drawCachedElement(r,e,null,null,n,true),o.setImgSmoothing(r,!0))},Sx.levelIsComplete=function(t,e){var n=this.layersByLevel[t];if(!n||0===n.length)return!1;for(var i=0,o=0;o<n.length;o++){var r=n[o];if(r.reqs>0)return!1;if(r.invalid)return!1;i+=r.eles.length}return i===e.length},Sx.validateLayersElesOrdering=function(t,e){var n=this.layersByLevel[t];if(n)for(var i=0;i<n.length;i++){for(var o=n[i],r=-1,s=0;s<e.length;s++)if(o.eles[0]===e[s]){r=s;break}if(r<0)this.invalidateLayer(o);else{var a=r;for(s=0;s<o.eles.length;s++)if(o.eles[s]!==e[a+s]){this.invalidateLayer(o);break}}}},Sx.updateElementsInLayers=function(t,e){for(var n=j_(t[0]),i=0;i<t.length;i++)for(var o=n?null:t[i],r=n?t[i]:t[i].ele,s=r._private.rscratch,a=s.imgLayerCaches=s.imgLayerCaches||{},l=-4;l<=2;l++){var c=a[l];c&&(o&&this.getEleLevelForLayerLevel(c.level)!==o.level||e(c,r,o))}},Sx.haveLayers=function(){for(var t=!1,e=-4;e<=2;e++){var n=this.layersByLevel[e];if(n&&n.length>0){t=!0;break}}return t},Sx.invalidateElements=function(t){var e=this;0!==t.length&&(e.lastInvalidationTime=gv(),0!==t.length&&e.haveLayers()&&e.updateElementsInLayers(t,(function(t,n,i){e.invalidateLayer(t)})))},Sx.invalidateLayer=function(t){if(this.lastInvalidationTime=gv(),!t.invalid){var e=t.level,n=t.eles,i=this.layersByLevel[e];Uv(i,t),t.elesQueue=[],t.invalid=!0,t.replacement&&(t.replacement.invalid=!0);for(var o=0;o<n.length;o++){var r=n[o]._private.rscratch.imgLayerCaches;r&&(r[e]=null)}}},Sx.refineElementTextures=function(t){var e=this;e.updateElementsInLayers(t,(function(t,n,i){var o=t.replacement;if(o||((o=t.replacement=e.makeLayer(t.bb,t.level)).replaces=t,o.eles=t.eles),!o.reqs)for(var r=0;r<o.eles.length;r++)e.queueLayer(o,o.eles[r])}))},Sx.enqueueElementRefinement=function(t){this.eleTxrDeqs.merge(t),this.scheduleElementRefinement()},Sx.queueLayer=function(t,e){var n=this.layersQueue,i=t.elesQueue,o=i.hasId=i.hasId||{};if(!t.replacement){if(e){if(o[e.id()])return;i.push(e),o[e.id()]=!0}t.reqs?(t.reqs++,n.updateItem(t)):(t.reqs=1,n.push(t))}},Sx.dequeue=function(t){for(var e=this,n=e.layersQueue,i=[],o=0;o<1&&0!==n.size();){var r=n.peek();if(r.replacement)n.pop();else if(r.replaces&&r!==r.replaces.replacement)n.pop();else if(r.invalid)n.pop();else{var s=r.elesQueue.shift();s&&(e.drawEleInLayer(r,s,r.level,t),o++),0===i.length&&i.push(!0),0===r.elesQueue.length&&(n.pop(),r.reqs=0,r.replaces&&e.applyLayerReplacement(r),e.requestRedraw())}}return i},Sx.applyLayerReplacement=function(t){var e=this.layersByLevel[t.level],n=t.replaces,i=e.indexOf(n);if(!(i<0||n.invalid)){e[i]=t;for(var o=0;o<t.eles.length;o++){var r=t.eles[o]._private,s=r.imgLayerCaches=r.imgLayerCaches||{};s&&(s[t.level]=t)}this.requestRedraw()}},Sx.requestRedraw=C_((function(){var t=this.renderer;t.redrawHint("eles",!0),t.redrawHint("drag",!0),t.redraw()}),100),Sx.setupDequeueing=yx({deqRedrawThreshold:50,deqCost:.15,deqAvgCost:.1,deqNoDrawCost:.9,deqFastCost:.9,deq:function(t,e){return t.dequeue(e)},onDeqd:Av,shouldRedraw:Ov,priority:function(t){return t.renderer.beforeRenderPriorities.lyrTxrDeq}});var kx,wx={};function Ax(t,e){for(var n=0;n<e.length;n++){var i=e[n];t.lineTo(i.x,i.y)}}function Dx(t,e,n){for(var i,o=0;o<e.length;o++){var r=e[o];0===o&&(i=r),t.lineTo(r.x,r.y)}t.quadraticCurveTo(n.x,n.y,i.x,i.y)}function Nx(t,e,n){t.beginPath&&t.beginPath();for(var i=e,o=0;o<i.length;o++){var r=i[o];t.lineTo(r.x,r.y)}var s=n,a=n[0];t.moveTo(a.x,a.y);for(o=1;o<s.length;o++){r=s[o];t.lineTo(r.x,r.y)}t.closePath&&t.closePath()}function Lx(t,e,n,i,o){t.beginPath&&t.beginPath(),t.arc(n,i,o,0,2*Math.PI,!1);var r=e,s=r[0];t.moveTo(s.x,s.y);for(var a=0;a<r.length;a++){var l=r[a];t.lineTo(l.x,l.y)}t.closePath&&t.closePath()}function Px(t,e,n,i){t.arc(e,n,i,0,2*Math.PI,!1)}wx.arrowShapeImpl=function(t){return(kx||(kx={polygon:Ax,"triangle-backcurve":Dx,"triangle-tee":Nx,"circle-triangle":Lx,"triangle-cross":Nx,circle:Px}))[t]};var Mx={drawElement:function(t,e,n,i,o,r){e.isNode()?this.drawNode(t,e,n,i,o,r):this.drawEdge(t,e,n,i,o,r)},drawElementOverlay:function(t,e){e.isNode()?this.drawNodeOverlay(t,e):this.drawEdgeOverlay(t,e)},drawCachedElementPortion:function(t,e,n,i,o,r,s,a){var l=this,c=n.getBoundingBox(e);if(0!==c.w&&0!==c.h){var d=n.getElement(e,c,i,o,r);if(null!=d){var u=a(l,e);if(0===u)return;var h,p,g,f,m,_,v=s(l,e),y=c.x1,b=c.y1,E=c.w,T=c.h;if(0!==v){var R=n.getRotationPoint(e);g=R.x,f=R.y,t.translate(g,f),t.rotate(v),(m=l.getImgSmoothing(t))||l.setImgSmoothing(t,!0);var C=n.getRotationOffset(e);h=C.x,p=C.y}else h=y,p=b;1!==u&&(_=t.globalAlpha,t.globalAlpha=_*u),t.drawImage(d.texture.canvas,d.x,0,d.width,d.height,h,p,E,T),1!==u&&(t.globalAlpha=_),0!==v&&(t.rotate(-v),t.translate(-g,-f),m||l.setImgSmoothing(t,!1))}else n.drawElement(t,e)}}},Bx=function(){return 0},Fx=function(t,e){return t.getTextAngle(e,null)},Hx=function(t,e){return t.getTextAngle(e,"source")},Ux=function(t,e){return t.getTextAngle(e,"target")},Vx=function(t,e){return e.effectiveOpacity()},Gx=function(t,e){return e.pstyle("text-opacity").pfValue*e.effectiveOpacity()};Mx.drawCachedElement=function(t,e,n,i,o,r){var s=this,a=s.data,l=a.eleTxrCache,c=a.lblTxrCache,d=a.slbTxrCache,u=a.tlbTxrCache,h=e.boundingBox(),p=!0===r?l.reasons.highQuality:null;if(0!==h.w&&0!==h.h&&e.visible()&&(!i||Sy(h,i))){var g=e.isEdge(),f=e.element()._private.rscratch.badLine;s.drawCachedElementPortion(t,e,l,n,o,p,Bx,Vx),g&&f||s.drawCachedElementPortion(t,e,c,n,o,p,Fx,Gx),g&&!f&&(s.drawCachedElementPortion(t,e,d,n,o,p,Hx,Gx),s.drawCachedElementPortion(t,e,u,n,o,p,Ux,Gx)),s.drawElementOverlay(t,e)}},Mx.drawElements=function(t,e){for(var n=0;n<e.length;n++){var i=e[n];this.drawElement(t,i)}},Mx.drawCachedElements=function(t,e,n,i){for(var o=0;o<e.length;o++){var r=e[o];this.drawCachedElement(t,r,n,i)}},Mx.drawCachedNodes=function(t,e,n,i){for(var o=0;o<e.length;o++){var r=e[o];r.isNode()&&this.drawCachedElement(t,r,n,i)}},Mx.drawLayeredElements=function(t,e,n,i){var o=this.data.lyrTxrCache.getLayers(e,n);if(o)for(var r=0;r<o.length;r++){var s=o[r],a=s.bb;0!==a.w&&0!==a.h&&t.drawImage(s.canvas,a.x1,a.y1,a.w,a.h)}else this.drawCachedElements(t,e,n,i)};var Wx={drawEdge:function(t,e,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],s=this,a=e._private.rscratch;if((!r||e.visible())&&!a.badLine&&null!=a.allpts&&!isNaN(a.allpts[0])){var l;n&&(l=n,t.translate(-l.x1,-l.y1));var c=r?e.pstyle("opacity").value:1,d=r?e.pstyle("line-opacity").value:1,u=e.pstyle("line-style").value,h=e.pstyle("width").pfValue,p=e.pstyle("line-cap").value,g=c*d,f=c*d,m=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g;t.lineWidth=h,t.lineCap=p,s.eleStrokeStyle(t,e,n),s.drawEdgePath(e,t,a.allpts,u),t.lineCap="butt"},_=function(){o&&s.drawEdgeOverlay(t,e)},v=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f;s.drawArrowheads(t,e,n)},y=function(){s.drawElementText(t,e,null,i)};t.lineJoin="round";var b="yes"===e.pstyle("ghost").value;if(b){var E=e.pstyle("ghost-offset-x").pfValue,T=e.pstyle("ghost-offset-y").pfValue,R=e.pstyle("ghost-opacity").value,C=g*R;t.translate(E,T),m(C),v(C),t.translate(-E,-T)}m(),v(),_(),y(),n&&t.translate(l.x1,l.y1)}},drawEdgeOverlay:function(t,e){if(e.visible()){var n=e.pstyle("overlay-opacity").value;if(0!==n){var i=this,o=i.usePaths(),r=e._private.rscratch,s=2*e.pstyle("overlay-padding").pfValue,a=e.pstyle("overlay-color").value;t.lineWidth=s,"self"!==r.edgeType||o?t.lineCap="round":t.lineCap="butt",i.colorStrokeStyle(t,a[0],a[1],a[2],n),i.drawEdgePath(e,t,r.allpts,"solid")}}},drawEdgePath:function(t,e,n,i){var o,r=t._private.rscratch,s=e,a=!1,l=this.usePaths(),c=t.pstyle("line-dash-pattern").pfValue,d=t.pstyle("line-dash-offset").pfValue;if(l){var u=n.join("$");r.pathCacheKey&&r.pathCacheKey===u?(o=e=r.pathCache,a=!0):(o=e=new Path2D,r.pathCacheKey=u,r.pathCache=o)}if(s.setLineDash)switch(i){case"dotted":s.setLineDash([1,1]);break;case"dashed":s.setLineDash(c),s.lineDashOffset=d;break;case"solid":s.setLineDash([])}if(!a&&!r.badLine)switch(e.beginPath&&e.beginPath(),e.moveTo(n[0],n[1]),r.edgeType){case"bezier":case"self":case"compound":case"multibezier":for(var h=2;h+3<n.length;h+=4)e.quadraticCurveTo(n[h],n[h+1],n[h+2],n[h+3]);break;case"straight":case"segments":case"haystack":for(var p=2;p+1<n.length;p+=2)e.lineTo(n[p],n[p+1])}e=s,l?e.stroke(o):e.stroke(),e.setLineDash&&e.setLineDash([])},drawArrowheads:function(t,e,n){var i=e._private.rscratch,o="haystack"===i.edgeType;o||this.drawArrowhead(t,e,"source",i.arrowStartX,i.arrowStartY,i.srcArrowAngle,n),this.drawArrowhead(t,e,"mid-target",i.midX,i.midY,i.midtgtArrowAngle,n),this.drawArrowhead(t,e,"mid-source",i.midX,i.midY,i.midsrcArrowAngle,n),o||this.drawArrowhead(t,e,"target",i.arrowEndX,i.arrowEndY,i.tgtArrowAngle,n)},drawArrowhead:function(t,e,n,i,o,r,s){if(!(isNaN(i)||null==i||isNaN(o)||null==o||isNaN(r)||null==r)){var a=this,l=e.pstyle(n+"-arrow-shape").value;if("none"!==l){var c="hollow"===e.pstyle(n+"-arrow-fill").value?"both":"filled",d=e.pstyle(n+"-arrow-fill").value,u=e.pstyle("width").pfValue,h=e.pstyle("opacity").value;void 0===s&&(s=h);var p=t.globalCompositeOperation;1===s&&"hollow"!==d||(t.globalCompositeOperation="destination-out",a.colorFillStyle(t,255,255,255,1),a.colorStrokeStyle(t,255,255,255,1),a.drawArrowShape(e,t,c,u,l,i,o,r),t.globalCompositeOperation=p);var g=e.pstyle(n+"-arrow-color").value;a.colorFillStyle(t,g[0],g[1],g[2],s),a.colorStrokeStyle(t,g[0],g[1],g[2],s),a.drawArrowShape(e,t,d,u,l,i,o,r)}}},drawArrowShape:function(t,e,n,i,o,r,s,a){var l,c=this,d=this.usePaths()&&"triangle-cross"!==o,u=!1,h=e,p={x:r,y:s},g=t.pstyle("arrow-scale").value,f=this.getArrowWidth(i,g),m=c.arrowShapes[o];if(d){var _=c.arrowPathCache=c.arrowPathCache||[],v=Ev(o),y=_[v];null!=y?(l=e=y,u=!0):(l=e=new Path2D,_[v]=l)}u||(e.beginPath&&e.beginPath(),d?m.draw(e,1,0,{x:0,y:0},1):m.draw(e,f,a,p,i),e.closePath&&e.closePath()),e=h,d&&(e.translate(r,s),e.rotate(a),e.scale(f,f)),"filled"!==n&&"both"!==n||(d?e.fill(l):e.fill()),"hollow"!==n&&"both"!==n||(e.lineWidth=(m.matchEdgeWidth?i:1)/(d?f:1),e.lineJoin="miter",d?e.stroke(l):e.stroke()),d&&(e.scale(1/f,1/f),e.rotate(-a),e.translate(-r,-s))}},zx={safeDrawImage:function(t,e,n,i,o,r,s,a,l,c){o<=0||r<=0||l<=0||c<=0||t.drawImage(e,n,i,o,r,s,a,l,c)},drawInscribedImage:function(t,e,n,i,o){var r=this,s=n.position(),a=s.x,l=s.y,c=n.cy().style(),d=c.getIndexedStyle.bind(c),u=d(n,"background-fit","value",i),h=d(n,"background-repeat","value",i),p=n.width(),g=n.height(),f=2*n.padding(),m=p+("inner"===d(n,"background-width-relative-to","value",i)?0:f),_=g+("inner"===d(n,"background-height-relative-to","value",i)?0:f),v=n._private.rscratch,y="node"===d(n,"background-clip","value",i),b=d(n,"background-image-opacity","value",i)*o,E=d(n,"background-image-smoothing","value",i),T=e.width||e.cachedW,R=e.height||e.cachedH;null!=T&&null!=R||(document.body.appendChild(e),T=e.cachedW=e.width||e.offsetWidth,R=e.cachedH=e.height||e.offsetHeight,document.body.removeChild(e));var C=T,x=R;if("auto"!==d(n,"background-width","value",i)&&(C="%"===d(n,"background-width","units",i)?d(n,"background-width","pfValue",i)*m:d(n,"background-width","pfValue",i)),"auto"!==d(n,"background-height","value",i)&&(x="%"===d(n,"background-height","units",i)?d(n,"background-height","pfValue",i)*_:d(n,"background-height","pfValue",i)),0!==C&&0!==x){if("contain"===u)C*=S=Math.min(m/C,_/x),x*=S;else if("cover"===u){var S;C*=S=Math.max(m/C,_/x),x*=S}var I=a-m/2,O=d(n,"background-position-x","units",i),k=d(n,"background-position-x","pfValue",i);I+="%"===O?(m-C)*k:k;var w=d(n,"background-offset-x","units",i),A=d(n,"background-offset-x","pfValue",i);I+="%"===w?(m-C)*A:A;var D=l-_/2,N=d(n,"background-position-y","units",i),L=d(n,"background-position-y","pfValue",i);D+="%"===N?(_-x)*L:L;var P=d(n,"background-offset-y","units",i),M=d(n,"background-offset-y","pfValue",i);D+="%"===P?(_-x)*M:M,v.pathCache&&(I-=a,D-=l,a=0,l=0);var B=t.globalAlpha;t.globalAlpha=b;var F=r.getImgSmoothing(t),H=!1;if("no"===E&&F?(r.setImgSmoothing(t,!1),H=!0):"yes"!==E||F||(r.setImgSmoothing(t,!0),H=!0),"no-repeat"===h)y&&(t.save(),v.pathCache?t.clip(v.pathCache):(r.nodeShapes[r.getNodeShape(n)].draw(t,a,l,m,_),t.clip())),r.safeDrawImage(t,e,0,0,T,R,I,D,C,x),y&&t.restore();else{var U=t.createPattern(e,h);t.fillStyle=U,r.nodeShapes[r.getNodeShape(n)].draw(t,a,l,m,_),t.translate(I,D),t.fill(),t.translate(-I,-D)}t.globalAlpha=B,H&&r.setImgSmoothing(t,F)}}},Xx={};function jx(t,e,n,i,o){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:5;t.beginPath(),t.moveTo(e+r,n),t.lineTo(e+i-r,n),t.quadraticCurveTo(e+i,n,e+i,n+r),t.lineTo(e+i,n+o-r),t.quadraticCurveTo(e+i,n+o,e+i-r,n+o),t.lineTo(e+r,n+o),t.quadraticCurveTo(e,n+o,e,n+o-r),t.lineTo(e,n+r),t.quadraticCurveTo(e,n,e+r,n),t.closePath(),t.fill()}Xx.eleTextBiggerThanMin=function(t,e){if(!e){var n=t.cy().zoom(),i=this.getPixelRatio(),o=Math.ceil(py(n*i));e=Math.pow(2,o)}return!(t.pstyle("font-size").pfValue*e<t.pstyle("min-zoomed-font-size").pfValue)},Xx.drawElementText=function(t,e,n,i,o){var r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],s=this;if(null==i){if(r&&!s.eleTextBiggerThanMin(e))return}else if(!1===i)return;if(e.isNode()){var a=e.pstyle("label");if(!a||!a.value)return;var l=s.getLabelJustification(e);t.textAlign=l,t.textBaseline="bottom"}else{var c=e.element()._private.rscratch.badLine,d=e.pstyle("label"),u=e.pstyle("source-label"),h=e.pstyle("target-label");if(c||(!d||!d.value)&&(!u||!u.value)&&(!h||!h.value))return;t.textAlign="center",t.textBaseline="bottom"}var p,g=!n;n&&(p=n,t.translate(-p.x1,-p.y1)),null==o?(s.drawText(t,e,null,g,r),e.isEdge()&&(s.drawText(t,e,"source",g,r),s.drawText(t,e,"target",g,r))):s.drawText(t,e,o,g,r),n&&t.translate(p.x1,p.y1)},Xx.getFontCache=function(t){var e;this.fontCaches=this.fontCaches||[];for(var n=0;n<this.fontCaches.length;n++)if((e=this.fontCaches[n]).context===t)return e;return e={context:t},this.fontCaches.push(e),e},Xx.setupTextStyle=function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=e.pstyle("font-style").strValue,o=e.pstyle("font-size").pfValue+"px",r=e.pstyle("font-family").strValue,s=e.pstyle("font-weight").strValue,a=n?e.effectiveOpacity()*e.pstyle("text-opacity").value:1,l=e.pstyle("text-outline-opacity").value*a,c=e.pstyle("color").value,d=e.pstyle("text-outline-color").value;t.font=i+" "+s+" "+o+" "+r,t.lineJoin="round",this.colorFillStyle(t,c[0],c[1],c[2],a),this.colorStrokeStyle(t,d[0],d[1],d[2],l)},Xx.getTextAngle=function(t,e){var n=t._private.rscratch,i=e?e+"-":"",o=t.pstyle(i+"text-rotation"),r=Gv(n,"labelAngle",e);return"autorotate"===o.strValue?t.isEdge()?r:0:"none"===o.strValue?0:o.pfValue},Xx.drawText=function(t,e,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=e._private,s=r.rscratch,a=o?e.effectiveOpacity():1;if(!o||0!==a&&0!==e.pstyle("text-opacity").value){"main"===n&&(n=null);var l,c,d=Gv(s,"labelX",n),u=Gv(s,"labelY",n),h=this.getLabelText(e,n);if(null!=h&&""!==h&&!isNaN(d)&&!isNaN(u)){this.setupTextStyle(t,e,o);var p,g=n?n+"-":"",f=Gv(s,"labelWidth",n),m=Gv(s,"labelHeight",n),_=e.pstyle(g+"text-margin-x").pfValue,v=e.pstyle(g+"text-margin-y").pfValue,y=e.isEdge(),b=e.pstyle("text-halign").value,E=e.pstyle("text-valign").value;switch(y&&(b="center",E="center"),d+=_,u+=v,0!==(p=i?this.getTextAngle(e,n):0)&&(l=d,c=u,t.translate(l,c),t.rotate(p),d=0,u=0),E){case"top":break;case"center":u+=m/2;break;case"bottom":u+=m}var T=e.pstyle("text-background-opacity").value,R=e.pstyle("text-border-opacity").value,C=e.pstyle("text-border-width").pfValue,x=e.pstyle("text-background-padding").pfValue;if(T>0||C>0&&R>0){var S=d-x;switch(b){case"left":S-=f;break;case"center":S-=f/2}var I=u-m-x,O=f+2*x,k=m+2*x;if(T>0){var w=t.fillStyle,A=e.pstyle("text-background-color").value;t.fillStyle="rgba("+A[0]+","+A[1]+","+A[2]+","+T*a+")";var D=e.pstyle("text-background-shape").strValue;0===D.indexOf("round")?jx(t,S,I,O,k,2):t.fillRect(S,I,O,k),t.fillStyle=w}if(C>0&&R>0){var N=t.strokeStyle,L=t.lineWidth,P=e.pstyle("text-border-color").value,M=e.pstyle("text-border-style").value;if(t.strokeStyle="rgba("+P[0]+","+P[1]+","+P[2]+","+R*a+")",t.lineWidth=C,t.setLineDash)switch(M){case"dotted":t.setLineDash([1,1]);break;case"dashed":t.setLineDash([4,2]);break;case"double":t.lineWidth=C/4,t.setLineDash([]);break;case"solid":t.setLineDash([])}if(t.strokeRect(S,I,O,k),"double"===M){var B=C/2;t.strokeRect(S+B,I+B,O-2*B,k-2*B)}t.setLineDash&&t.setLineDash([]),t.lineWidth=L,t.strokeStyle=N}}var F=2*e.pstyle("text-outline-width").pfValue;if(F>0&&(t.lineWidth=F),"wrap"===e.pstyle("text-wrap").value){var H=Gv(s,"labelWrapCachedLines",n),U=Gv(s,"labelLineHeight",n),V=f/2,G=this.getLabelJustification(e);switch("auto"===G||("left"===b?"left"===G?d+=-f:"center"===G&&(d+=-V):"center"===b?"left"===G?d+=-V:"right"===G&&(d+=V):"right"===b&&("center"===G?d+=V:"right"===G&&(d+=f))),E){case"top":u-=(H.length-1)*U;break;case"center":case"bottom":u-=(H.length-1)*U}for(var W=0;W<H.length;W++)F>0&&t.strokeText(H[W],d,u),t.fillText(H[W],d,u),u+=U}else F>0&&t.strokeText(h,d,u),t.fillText(h,d,u);0!==p&&(t.rotate(-p),t.translate(-l,-c))}}};var Yx={drawNode:function(t,e,n){var i,o,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],l=this,c=e._private,d=c.rscratch,u=e.position();if(W_(u.x)&&W_(u.y)&&(!a||e.visible())){var h,p,g=a?e.effectiveOpacity():1,f=l.usePaths(),m=!1,_=e.padding();i=e.width()+2*_,o=e.height()+2*_,n&&(p=n,t.translate(-p.x1,-p.y1));for(var v=e.pstyle("background-image"),y=v.value,b=new Array(y.length),E=new Array(y.length),T=0,R=0;R<y.length;R++){var C=y[R],x=b[R]=null!=C&&"none"!==C;if(x){var S=e.cy().style().getIndexedStyle(e,"background-image-crossorigin","value",R);T++,E[R]=l.getCachedImage(C,S,(function(){c.backgroundTimestamp=Date.now(),e.emitAndNotify("background")}))}}var I=e.pstyle("background-blacken").value,O=e.pstyle("border-width").pfValue,k=e.pstyle("background-opacity").value*g,w=e.pstyle("border-color").value,A=e.pstyle("border-style").value,D=e.pstyle("border-opacity").value*g;t.lineJoin="miter";var N=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k;l.eleFillStyle(t,e,n)},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D;l.colorStrokeStyle(t,w[0],w[1],w[2],e)},P=e.pstyle("shape").strValue,M=e.pstyle("shape-polygon-points").pfValue;if(f){t.translate(u.x,u.y);var B=l.nodePathCache=l.nodePathCache||[],F=Tv("polygon"===P?P+","+M.join(","):P,""+o,""+i),H=B[F];null!=H?(h=H,m=!0,d.pathCache=h):(h=new Path2D,B[F]=d.pathCache=h)}var U=function(){if(!m){var n=u;f&&(n={x:0,y:0}),l.nodeShapes[l.getNodeShape(e)].draw(h||t,n.x,n.y,i,o)}f?t.fill(h):t.fill()},V=function(){for(var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=c.backgrounding,r=0,s=0;s<E.length;s++){var a=e.cy().style().getIndexedStyle(e,"background-image-containment","value",s);i&&"over"===a||!i&&"inside"===a?r++:b[s]&&E[s].complete&&!E[s].error&&(r++,l.drawInscribedImage(t,E[s],e,s,n))}c.backgrounding=!(r===T),o!==c.backgrounding&&e.updateStyle(!1)},G=function(){var n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g;l.hasPie(e)&&(l.drawPie(t,e,r),n&&(f||l.nodeShapes[l.getNodeShape(e)].draw(t,u.x,u.y,i,o)))},W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,n=(I>0?I:-I)*e,i=I>0?0:255;0!==I&&(l.colorFillStyle(t,i,i,i,n),f?t.fill(h):t.fill())},z=function(){if(O>0){if(t.lineWidth=O,t.lineCap="butt",t.setLineDash)switch(A){case"dotted":t.setLineDash([1,1]);break;case"dashed":t.setLineDash([4,2]);break;case"solid":case"double":t.setLineDash([])}if(f?t.stroke(h):t.stroke(),"double"===A){t.lineWidth=O/3;var e=t.globalCompositeOperation;t.globalCompositeOperation="destination-out",f?t.stroke(h):t.stroke(),t.globalCompositeOperation=e}t.setLineDash&&t.setLineDash([])}},X=function(){s&&l.drawNodeOverlay(t,e,u,i,o)},j=function(){l.drawElementText(t,e,null,r)},Y="yes"===e.pstyle("ghost").value;if(Y){var K=e.pstyle("ghost-offset-x").pfValue,$=e.pstyle("ghost-offset-y").pfValue,J=e.pstyle("ghost-opacity").value,q=J*g;t.translate(K,$),N(J*k),U(),V(q,!0),L(J*D),z(),G(0!==I||0!==O),V(q,!1),W(q),t.translate(-K,-$)}N(),U(),V(g,!0),L(),z(),G(0!==I||0!==O),V(g,!1),W(),f&&t.translate(-u.x,-u.y),j(),X(),n&&t.translate(p.x1,p.y1)}},drawNodeOverlay:function(t,e,n,i,o){if(e.visible()){var r=e.pstyle("overlay-padding").pfValue,s=e.pstyle("overlay-opacity").value,a=e.pstyle("overlay-color").value;if(s>0){if(n=n||e.position(),null==i||null==o){var l=e.padding();i=e.width()+2*l,o=e.height()+2*l}this.colorFillStyle(t,a[0],a[1],a[2],s),this.nodeShapes.roundrectangle.draw(t,n.x,n.y,i+2*r,o+2*r),t.fill()}}},hasPie:function(t){return(t=t[0])._private.hasPie},drawPie:function(t,e,n,i){e=e[0],i=i||e.position();var o=e.cy().style(),r=e.pstyle("pie-size"),s=i.x,a=i.y,l=e.width(),c=e.height(),d=Math.min(l,c)/2,u=0;this.usePaths()&&(s=0,a=0),"%"===r.units?d*=r.pfValue:void 0!==r.pfValue&&(d=r.pfValue/2);for(var h=1;h<=o.pieBackgroundN;h++){var p=e.pstyle("pie-"+h+"-background-size").value,g=e.pstyle("pie-"+h+"-background-color").value,f=e.pstyle("pie-"+h+"-background-opacity").value*n,m=p/100;m+u>1&&(m=1-u);var _=1.5*Math.PI+2*Math.PI*u,v=_+2*Math.PI*m;0===p||u>=1||u+m>1||(t.beginPath(),t.moveTo(s,a),t.arc(s,a,d,_,v),t.closePath(),this.colorFillStyle(t,g[0],g[1],g[2],f),t.fill(),u+=m)}}},Kx={};Kx.getPixelRatio=function(){var t=this.data.contexts[0];if(null!=this.forcedPixelRatio)return this.forcedPixelRatio;var e=t.backingStorePixelRatio||t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/e},Kx.paintCache=function(t){for(var e,n=this.paintCaches=this.paintCaches||[],i=!0,o=0;o<n.length;o++)if((e=n[o]).context===t){i=!1;break}return i&&(e={context:t},n.push(e)),e},Kx.createGradientStyleFor=function(t,e,n,i,o){var r,s=this.usePaths(),a=n.pstyle(e+"-gradient-stop-colors").value,l=n.pstyle(e+"-gradient-stop-positions").pfValue;if("radial-gradient"===i)if(n.isEdge()){var c=n.sourceEndpoint(),d=n.targetEndpoint(),u=n.midpoint(),h=fy(c,u),p=fy(d,u);r=t.createRadialGradient(u.x,u.y,0,u.x,u.y,Math.max(h,p))}else{var g=s?{x:0,y:0}:n.position(),f=n.paddedWidth(),m=n.paddedHeight();r=t.createRadialGradient(g.x,g.y,0,g.x,g.y,Math.max(f,m))}else if(n.isEdge()){var _=n.sourceEndpoint(),v=n.targetEndpoint();r=t.createLinearGradient(_.x,_.y,v.x,v.y)}else{var y=s?{x:0,y:0}:n.position(),b=n.paddedWidth()/2,E=n.paddedHeight()/2;switch(n.pstyle("background-gradient-direction").value){case"to-bottom":r=t.createLinearGradient(y.x,y.y-E,y.x,y.y+E);break;case"to-top":r=t.createLinearGradient(y.x,y.y+E,y.x,y.y-E);break;case"to-left":r=t.createLinearGradient(y.x+b,y.y,y.x-b,y.y);break;case"to-right":r=t.createLinearGradient(y.x-b,y.y,y.x+b,y.y);break;case"to-bottom-right":case"to-right-bottom":r=t.createLinearGradient(y.x-b,y.y-E,y.x+b,y.y+E);break;case"to-top-right":case"to-right-top":r=t.createLinearGradient(y.x-b,y.y+E,y.x+b,y.y-E);break;case"to-bottom-left":case"to-left-bottom":r=t.createLinearGradient(y.x+b,y.y-E,y.x-b,y.y+E);break;case"to-top-left":case"to-left-top":r=t.createLinearGradient(y.x+b,y.y+E,y.x-b,y.y-E)}}if(!r)return null;for(var T=l.length===a.length,R=a.length,C=0;C<R;C++)r.addColorStop(T?l[C]:C/(R-1),"rgba("+a[C][0]+","+a[C][1]+","+a[C][2]+","+o+")");return r},Kx.gradientFillStyle=function(t,e,n,i){var o=this.createGradientStyleFor(t,"background",e,n,i);if(!o)return null;t.fillStyle=o},Kx.colorFillStyle=function(t,e,n,i,o){t.fillStyle="rgba("+e+","+n+","+i+","+o+")"},Kx.eleFillStyle=function(t,e,n){var i=e.pstyle("background-fill").value;if("linear-gradient"===i||"radial-gradient"===i)this.gradientFillStyle(t,e,i,n);else{var o=e.pstyle("background-color").value;this.colorFillStyle(t,o[0],o[1],o[2],n)}},Kx.gradientStrokeStyle=function(t,e,n,i){var o=this.createGradientStyleFor(t,"line",e,n,i);if(!o)return null;t.strokeStyle=o},Kx.colorStrokeStyle=function(t,e,n,i,o){t.strokeStyle="rgba("+e+","+n+","+i+","+o+")"},Kx.eleStrokeStyle=function(t,e,n){var i=e.pstyle("line-fill").value;if("linear-gradient"===i||"radial-gradient"===i)this.gradientStrokeStyle(t,e,i,n);else{var o=e.pstyle("line-color").value;this.colorStrokeStyle(t,o[0],o[1],o[2],n)}},Kx.matchCanvasSize=function(t){var e=this,n=e.data,i=e.findContainerClientCoords(),o=i[2],r=i[3],s=e.getPixelRatio(),a=e.motionBlurPxRatio;t!==e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_NODE]&&t!==e.data.bufferCanvases[e.MOTIONBLUR_BUFFER_DRAG]||(s=a);var l,c=o*s,d=r*s;if(c!==e.canvasWidth||d!==e.canvasHeight){e.fontCaches=null;var u=n.canvasContainer;u.style.width=o+"px",u.style.height=r+"px";for(var h=0;h<e.CANVAS_LAYERS;h++)(l=n.canvases[h]).width=c,l.height=d,l.style.width=o+"px",l.style.height=r+"px";for(h=0;h<e.BUFFER_COUNT;h++)(l=n.bufferCanvases[h]).width=c,l.height=d,l.style.width=o+"px",l.style.height=r+"px";e.textureMult=1,s<=1&&(l=n.bufferCanvases[e.TEXTURE_BUFFER],e.textureMult=2,l.width=c*e.textureMult,l.height=d*e.textureMult),e.canvasWidth=c,e.canvasHeight=d}},Kx.renderTo=function(t,e,n,i){this.render({forcedContext:t,forcedZoom:e,forcedPan:n,drawAllLayers:!0,forcedPxRatio:i})},Kx.render=function(t){var e=(t=t||Fv()).forcedContext,n=t.drawAllLayers,i=t.drawOnlyNodeLayer,o=t.forcedZoom,r=t.forcedPan,s=this,a=void 0===t.forcedPxRatio?this.getPixelRatio():t.forcedPxRatio,l=s.cy,c=s.data,d=c.canvasNeedsRedraw,u=s.textureOnViewport&&!e&&(s.pinching||s.hoverData.dragging||s.swipePanning||s.data.wheelZooming),h=void 0!==t.motionBlur?t.motionBlur:s.motionBlur,p=s.motionBlurPxRatio,g=l.hasCompoundNodes(),f=s.hoverData.draggingEles,m=!(!s.hoverData.selecting&&!s.touchData.selecting),_=h=h&&!e&&s.motionBlurEnabled&&!m;e||(s.prevPxRatio!==a&&(s.invalidateContainerClientCoordsCache(),s.matchCanvasSize(s.container),s.redrawHint("eles",!0),s.redrawHint("drag",!0)),s.prevPxRatio=a),!e&&s.motionBlurTimeout&&clearTimeout(s.motionBlurTimeout),h&&(null==s.mbFrames&&(s.mbFrames=0),s.mbFrames++,s.mbFrames<3&&(_=!1),s.mbFrames>s.minMbLowQualFrames&&(s.motionBlurPxRatio=s.mbPxRBlurry)),s.clearingMotionBlur&&(s.motionBlurPxRatio=1),s.textureDrawLastFrame&&!u&&(d[s.NODE]=!0,d[s.SELECT_BOX]=!0);var v=l.style(),y=l.zoom(),b=void 0!==o?o:y,E=l.pan(),T={x:E.x,y:E.y},R={zoom:y,pan:{x:E.x,y:E.y}},C=s.prevViewport;void 0===C||R.zoom!==C.zoom||R.pan.x!==C.pan.x||R.pan.y!==C.pan.y||f&&!g||(s.motionBlurPxRatio=1),r&&(T=r),b*=a,T.x*=a,T.y*=a;var x=s.getCachedZSortedEles();function S(t,e,n,i,o){var r=t.globalCompositeOperation;t.globalCompositeOperation="destination-out",s.colorFillStyle(t,255,255,255,s.motionBlurTransparency),t.fillRect(e,n,i,o),t.globalCompositeOperation=r}function I(t,i){var a,l,d,u;s.clearingMotionBlur||t!==c.bufferContexts[s.MOTIONBLUR_BUFFER_NODE]&&t!==c.bufferContexts[s.MOTIONBLUR_BUFFER_DRAG]?(a=T,l=b,d=s.canvasWidth,u=s.canvasHeight):(a={x:E.x*p,y:E.y*p},l=y*p,d=s.canvasWidth*p,u=s.canvasHeight*p),t.setTransform(1,0,0,1,0,0),"motionBlur"===i?S(t,0,0,d,u):e||void 0!==i&&!i||t.clearRect(0,0,d,u),n||(t.translate(a.x,a.y),t.scale(l,l)),r&&t.translate(r.x,r.y),o&&t.scale(o,o)}if(u||(s.textureDrawLastFrame=!1),u){if(s.textureDrawLastFrame=!0,!s.textureCache){s.textureCache={},s.textureCache.bb=l.mutableElements().boundingBox(),s.textureCache.texture=s.data.bufferCanvases[s.TEXTURE_BUFFER];var O=s.data.bufferContexts[s.TEXTURE_BUFFER];O.setTransform(1,0,0,1,0,0),O.clearRect(0,0,s.canvasWidth*s.textureMult,s.canvasHeight*s.textureMult),s.render({forcedContext:O,drawOnlyNodeLayer:!0,forcedPxRatio:a*s.textureMult}),(R=s.textureCache.viewport={zoom:l.zoom(),pan:l.pan(),width:s.canvasWidth,height:s.canvasHeight}).mpan={x:(0-R.pan.x)/R.zoom,y:(0-R.pan.y)/R.zoom}}d[s.DRAG]=!1,d[s.NODE]=!1;var k=c.contexts[s.NODE],w=s.textureCache.texture;R=s.textureCache.viewport;k.setTransform(1,0,0,1,0,0),h?S(k,0,0,R.width,R.height):k.clearRect(0,0,R.width,R.height);var A=v.core("outside-texture-bg-color").value,D=v.core("outside-texture-bg-opacity").value;s.colorFillStyle(k,A[0],A[1],A[2],D),k.fillRect(0,0,R.width,R.height);y=l.zoom();I(k,!1),k.clearRect(R.mpan.x,R.mpan.y,R.width/R.zoom/a,R.height/R.zoom/a),k.drawImage(w,R.mpan.x,R.mpan.y,R.width/R.zoom/a,R.height/R.zoom/a)}else s.textureOnViewport&&!e&&(s.textureCache=null);var N=l.extent(),L=s.pinching||s.hoverData.dragging||s.swipePanning||s.data.wheelZooming||s.hoverData.draggingEles||s.cy.animated(),P=s.hideEdgesOnViewport&&L,M=[];if(M[s.NODE]=!d[s.NODE]&&h&&!s.clearedForMotionBlur[s.NODE]||s.clearingMotionBlur,M[s.NODE]&&(s.clearedForMotionBlur[s.NODE]=!0),M[s.DRAG]=!d[s.DRAG]&&h&&!s.clearedForMotionBlur[s.DRAG]||s.clearingMotionBlur,M[s.DRAG]&&(s.clearedForMotionBlur[s.DRAG]=!0),d[s.NODE]||n||i||M[s.NODE]){var B=h&&!M[s.NODE]&&1!==p;I(k=e||(B?s.data.bufferContexts[s.MOTIONBLUR_BUFFER_NODE]:c.contexts[s.NODE]),h&&!B?"motionBlur":void 0),P?s.drawCachedNodes(k,x.nondrag,a,N):s.drawLayeredElements(k,x.nondrag,a,N),s.debug&&s.drawDebugPoints(k,x.nondrag),n||h||(d[s.NODE]=!1)}if(!i&&(d[s.DRAG]||n||M[s.DRAG])){B=h&&!M[s.DRAG]&&1!==p;I(k=e||(B?s.data.bufferContexts[s.MOTIONBLUR_BUFFER_DRAG]:c.contexts[s.DRAG]),h&&!B?"motionBlur":void 0),P?s.drawCachedNodes(k,x.drag,a,N):s.drawCachedElements(k,x.drag,a,N),s.debug&&s.drawDebugPoints(k,x.drag),n||h||(d[s.DRAG]=!1)}if(s.showFps||!i&&d[s.SELECT_BOX]&&!n){if(I(k=e||c.contexts[s.SELECT_BOX]),1==s.selection[4]&&(s.hoverData.selecting||s.touchData.selecting)){y=s.cy.zoom();var F=v.core("selection-box-border-width").value/y;k.lineWidth=F,k.fillStyle="rgba("+v.core("selection-box-color").value[0]+","+v.core("selection-box-color").value[1]+","+v.core("selection-box-color").value[2]+","+v.core("selection-box-opacity").value+")",k.fillRect(s.selection[0],s.selection[1],s.selection[2]-s.selection[0],s.selection[3]-s.selection[1]),F>0&&(k.strokeStyle="rgba("+v.core("selection-box-border-color").value[0]+","+v.core("selection-box-border-color").value[1]+","+v.core("selection-box-border-color").value[2]+","+v.core("selection-box-opacity").value+")",k.strokeRect(s.selection[0],s.selection[1],s.selection[2]-s.selection[0],s.selection[3]-s.selection[1]))}if(c.bgActivePosistion&&!s.hoverData.selecting){y=s.cy.zoom();var H=c.bgActivePosistion;k.fillStyle="rgba("+v.core("active-bg-color").value[0]+","+v.core("active-bg-color").value[1]+","+v.core("active-bg-color").value[2]+","+v.core("active-bg-opacity").value+")",k.beginPath(),k.arc(H.x,H.y,v.core("active-bg-size").pfValue/y,0,2*Math.PI),k.fill()}var U=s.lastRedrawTime;if(s.showFps&&U){U=Math.round(U);var V=Math.round(1e3/U);k.setTransform(1,0,0,1,0,0),k.fillStyle="rgba(255, 0, 0, 0.75)",k.strokeStyle="rgba(255, 0, 0, 0.75)",k.lineWidth=1,k.fillText("1 frame = "+U+" ms = "+V+" fps",0,20);k.strokeRect(0,30,250,20),k.fillRect(0,30,250*Math.min(V/60,1),20)}n||(d[s.SELECT_BOX]=!1)}if(h&&1!==p){var G=c.contexts[s.NODE],W=s.data.bufferCanvases[s.MOTIONBLUR_BUFFER_NODE],z=c.contexts[s.DRAG],X=s.data.bufferCanvases[s.MOTIONBLUR_BUFFER_DRAG],j=function(t,e,n){t.setTransform(1,0,0,1,0,0),n||!_?t.clearRect(0,0,s.canvasWidth,s.canvasHeight):S(t,0,0,s.canvasWidth,s.canvasHeight);var i=p;t.drawImage(e,0,0,s.canvasWidth*i,s.canvasHeight*i,0,0,s.canvasWidth,s.canvasHeight)};(d[s.NODE]||M[s.NODE])&&(j(G,W,M[s.NODE]),d[s.NODE]=!1),(d[s.DRAG]||M[s.DRAG])&&(j(z,X,M[s.DRAG]),d[s.DRAG]=!1)}s.prevViewport=R,s.clearingMotionBlur&&(s.clearingMotionBlur=!1,s.motionBlurCleared=!0,s.motionBlur=!0),h&&(s.motionBlurTimeout=setTimeout((function(){s.motionBlurTimeout=null,s.clearedForMotionBlur[s.NODE]=!1,s.clearedForMotionBlur[s.DRAG]=!1,s.motionBlur=!1,s.clearingMotionBlur=!u,s.mbFrames=0,d[s.NODE]=!0,d[s.DRAG]=!0,s.redraw()}),100)),e||l.emit("render")};for(var $x={drawPolygonPath:function(t,e,n,i,o,r){var s=i/2,a=o/2;t.beginPath&&t.beginPath(),t.moveTo(e+s*r[0],n+a*r[1]);for(var l=1;l<r.length/2;l++)t.lineTo(e+s*r[2*l],n+a*r[2*l+1]);t.closePath()},drawRoundPolygonPath:function(t,e,n,i,o,r){var s=i/2,a=o/2,l=Ky(i,o);t.beginPath&&t.beginPath();for(var c=0;c<r.length/4;c++){var d,u=void 0;u=0===c?r.length-2:4*c-2,d=4*c+2;var h=e+s*r[4*c],p=n+a*r[4*c+1],g=-r[u]*r[d]-r[u+1]*r[d+1],f=l/Math.tan(Math.acos(g)/2),m=h-f*r[u],_=p-f*r[u+1],v=h+f*r[d],y=p+f*r[d+1];0===c?t.moveTo(m,_):t.lineTo(m,_),t.arcTo(h,p,v,y,l)}t.closePath()},drawRoundRectanglePath:function(t,e,n,i,o){var r=i/2,s=o/2,a=Yy(i,o);t.beginPath&&t.beginPath(),t.moveTo(e,n-s),t.arcTo(e+r,n-s,e+r,n,a),t.arcTo(e+r,n+s,e,n+s,a),t.arcTo(e-r,n+s,e-r,n,a),t.arcTo(e-r,n-s,e,n-s,a),t.lineTo(e,n-s),t.closePath()},drawBottomRoundRectanglePath:function(t,e,n,i,o){var r=i/2,s=o/2,a=Yy(i,o);t.beginPath&&t.beginPath(),t.moveTo(e,n-s),t.lineTo(e+r,n-s),t.lineTo(e+r,n),t.arcTo(e+r,n+s,e,n+s,a),t.arcTo(e-r,n+s,e-r,n,a),t.lineTo(e-r,n-s),t.lineTo(e,n-s),t.closePath()},drawCutRectanglePath:function(t,e,n,i,o){var r=i/2,s=o/2;t.beginPath&&t.beginPath(),t.moveTo(e-r+8,n-s),t.lineTo(e+r-8,n-s),t.lineTo(e+r,n-s+8),t.lineTo(e+r,n+s-8),t.lineTo(e+r-8,n+s),t.lineTo(e-r+8,n+s),t.lineTo(e-r,n+s-8),t.lineTo(e-r,n-s+8),t.closePath()},drawBarrelPath:function(t,e,n,i,o){var r=i/2,s=o/2,a=e-r,l=e+r,c=n-s,d=n+s,u=$y(i,o),h=u.widthOffset,p=u.heightOffset,g=u.ctrlPtOffsetPct*h;t.beginPath&&t.beginPath(),t.moveTo(a,c+p),t.lineTo(a,d-p),t.quadraticCurveTo(a+g,d,a+h,d),t.lineTo(l-h,d),t.quadraticCurveTo(l-g,d,l,d-p),t.lineTo(l,c+p),t.quadraticCurveTo(l-g,c,l-h,c),t.lineTo(a+h,c),t.quadraticCurveTo(a+g,c,a,c+p),t.closePath()}},Jx=Math.sin(0),qx=Math.cos(0),Zx={},Qx={},tS=Math.PI/40,eS=0*Math.PI;eS<2*Math.PI;eS+=tS)Zx[eS]=Math.sin(eS),Qx[eS]=Math.cos(eS);$x.drawEllipsePath=function(t,e,n,i,o){if(t.beginPath&&t.beginPath(),t.ellipse)t.ellipse(e,n,i/2,o/2,0,0,2*Math.PI);else for(var r,s,a=i/2,l=o/2,c=0*Math.PI;c<2*Math.PI;c+=tS)r=e-a*Zx[c]*Jx+a*Qx[c]*qx,s=n+l*Qx[c]*Jx+l*Zx[c]*qx,0===c?t.moveTo(r,s):t.lineTo(r,s);t.closePath()};var nS={};function iS(t){var e=t.indexOf(",");return t.substr(e+1)}function oS(t,e,n){var i=function(){return e.toDataURL(n,t.quality)};switch(t.output){case"blob-promise":return new aE((function(i,o){try{e.toBlob((function(t){null!=t?i(t):o(new Error("`canvas.toBlob()` sent a null value in its callback"))}),n,t.quality)}catch(t){o(t)}}));case"blob":return function(t,e){for(var n=atob(t),i=new ArrayBuffer(n.length),o=new Uint8Array(i),r=0;r<n.length;r++)o[r]=n.charCodeAt(r);return new Blob([i],{type:e})}(iS(i()),n);case"base64":return iS(i());case"base64uri":default:return i()}}nS.createBuffer=function(t,e){var n=document.createElement("canvas");return n.width=t,n.height=e,[n,n.getContext("2d")]},nS.bufferCanvasImage=function(t){var e=this.cy,n=e.mutableElements().boundingBox(),i=this.findContainerClientCoords(),o=t.full?Math.ceil(n.w):i[2],r=t.full?Math.ceil(n.h):i[3],s=W_(t.maxWidth)||W_(t.maxHeight),a=this.getPixelRatio(),l=1;if(void 0!==t.scale)o*=t.scale,r*=t.scale,l=t.scale;else if(s){var c=1/0,d=1/0;W_(t.maxWidth)&&(c=l*t.maxWidth/o),W_(t.maxHeight)&&(d=l*t.maxHeight/r),o*=l=Math.min(c,d),r*=l}s||(o*=a,r*=a,l*=a);var u=document.createElement("canvas");u.width=o,u.height=r,u.style.width=o+"px",u.style.height=r+"px";var h=u.getContext("2d");if(o>0&&r>0){h.clearRect(0,0,o,r),h.globalCompositeOperation="source-over";var p=this.getCachedZSortedEles();if(t.full)h.translate(-n.x1*l,-n.y1*l),h.scale(l,l),this.drawElements(h,p),h.scale(1/l,1/l),h.translate(n.x1*l,n.y1*l);else{var g=e.pan(),f={x:g.x*l,y:g.y*l};l*=e.zoom(),h.translate(f.x,f.y),h.scale(l,l),this.drawElements(h,p),h.scale(1/l,1/l),h.translate(-f.x,-f.y)}t.bg&&(h.globalCompositeOperation="destination-over",h.fillStyle=t.bg,h.rect(0,0,o,r),h.fill())}return u},nS.png=function(t){return oS(t,this.bufferCanvasImage(t),"image/png")},nS.jpg=function(t){return oS(t,this.bufferCanvasImage(t),"image/jpeg")};var rS={nodeShapeImpl:function(t,e,n,i,o,r,s){switch(t){case"ellipse":return this.drawEllipsePath(e,n,i,o,r);case"polygon":return this.drawPolygonPath(e,n,i,o,r,s);case"round-polygon":return this.drawRoundPolygonPath(e,n,i,o,r,s);case"roundrectangle":case"round-rectangle":return this.drawRoundRectanglePath(e,n,i,o,r);case"cutrectangle":case"cut-rectangle":return this.drawCutRectanglePath(e,n,i,o,r);case"bottomroundrectangle":case"bottom-round-rectangle":return this.drawBottomRoundRectanglePath(e,n,i,o,r);case"barrel":return this.drawBarrelPath(e,n,i,o,r)}}},sS=lS,aS=lS.prototype;function lS(t){var e=this;e.data={canvases:new Array(aS.CANVAS_LAYERS),contexts:new Array(aS.CANVAS_LAYERS),canvasNeedsRedraw:new Array(aS.CANVAS_LAYERS),bufferCanvases:new Array(aS.BUFFER_COUNT),bufferContexts:new Array(aS.CANVAS_LAYERS)};var n="-webkit-tap-highlight-color",i="rgba(0,0,0,0)";e.data.canvasContainer=document.createElement("div");var o=e.data.canvasContainer.style;e.data.canvasContainer.style[n]=i,o.position="relative",o.zIndex="0",o.overflow="hidden";var r=t.cy.container();r.appendChild(e.data.canvasContainer),r.style[n]=i;var s={"-webkit-user-select":"none","-moz-user-select":"-moz-none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","outline-style":"none"};N_&&N_.userAgent.match(/msie|trident|edge/i)&&(s["-ms-touch-action"]="none",s["touch-action"]="none");for(var a=0;a<aS.CANVAS_LAYERS;a++){var l=e.data.canvases[a]=document.createElement("canvas");e.data.contexts[a]=l.getContext("2d"),Object.keys(s).forEach((function(t){l.style[t]=s[t]})),l.style.position="absolute",l.setAttribute("data-id","layer"+a),l.style.zIndex=String(aS.CANVAS_LAYERS-a),e.data.canvasContainer.appendChild(l),e.data.canvasNeedsRedraw[a]=!1}e.data.topCanvas=e.data.canvases[0],e.data.canvases[aS.NODE].setAttribute("data-id","layer"+aS.NODE+"-node"),e.data.canvases[aS.SELECT_BOX].setAttribute("data-id","layer"+aS.SELECT_BOX+"-selectbox"),e.data.canvases[aS.DRAG].setAttribute("data-id","layer"+aS.DRAG+"-drag");for(a=0;a<aS.BUFFER_COUNT;a++)e.data.bufferCanvases[a]=document.createElement("canvas"),e.data.bufferContexts[a]=e.data.bufferCanvases[a].getContext("2d"),e.data.bufferCanvases[a].style.position="absolute",e.data.bufferCanvases[a].setAttribute("data-id","buffer"+a),e.data.bufferCanvases[a].style.zIndex=String(-a-1),e.data.bufferCanvases[a].style.visibility="hidden";e.pathsEnabled=!0;var c=Ey(),d=function(t){return{x:-t.w/2,y:-t.h/2}},u=function(t){return t.boundingBox(),t[0]._private.bodyBounds},h=function(t){return t.boundingBox(),t[0]._private.labelBounds.main||c},p=function(t){return t.boundingBox(),t[0]._private.labelBounds.source||c},g=function(t){return t.boundingBox(),t[0]._private.labelBounds.target||c},f=function(t,e){return e},m=function(t,e,n){var i=t?t+"-":"";return{x:e.x+n.pstyle(i+"text-margin-x").pfValue,y:e.y+n.pstyle(i+"text-margin-y").pfValue}},_=function(t,e,n){var i=t[0]._private.rscratch;return{x:i[e],y:i[n]}},v=e.data.eleTxrCache=new Rx(e,{getKey:function(t){return t[0]._private.nodeKey},doesEleInvalidateKey:function(t){var e=t[0]._private;return!(e.oldBackgroundTimestamp===e.backgroundTimestamp)},drawElement:function(t,n,i,o,r){return e.drawElement(t,n,i,!1,!1,r)},getBoundingBox:u,getRotationPoint:function(t){return{x:((e=u(t)).x1+e.x2)/2,y:(e.y1+e.y2)/2};var e},getRotationOffset:function(t){return d(u(t))},allowEdgeTxrCaching:!1,allowParentTxrCaching:!1}),y=e.data.lblTxrCache=new Rx(e,{getKey:function(t){return t[0]._private.labelStyleKey},drawElement:function(t,n,i,o,r){return e.drawElementText(t,n,i,o,"main",r)},getBoundingBox:h,getRotationPoint:function(t){return m("",_(t,"labelX","labelY"),t)},getRotationOffset:function(t){var e=h(t),n=d(h(t));if(t.isNode()){switch(t.pstyle("text-halign").value){case"left":n.x=-e.w;break;case"right":n.x=0}switch(t.pstyle("text-valign").value){case"top":n.y=-e.h;break;case"bottom":n.y=0}}return n},isVisible:f}),b=e.data.slbTxrCache=new Rx(e,{getKey:function(t){return t[0]._private.sourceLabelStyleKey},drawElement:function(t,n,i,o,r){return e.drawElementText(t,n,i,o,"source",r)},getBoundingBox:p,getRotationPoint:function(t){return m("source",_(t,"sourceLabelX","sourceLabelY"),t)},getRotationOffset:function(t){return d(p(t))},isVisible:f}),E=e.data.tlbTxrCache=new Rx(e,{getKey:function(t){return t[0]._private.targetLabelStyleKey},drawElement:function(t,n,i,o,r){return e.drawElementText(t,n,i,o,"target",r)},getBoundingBox:g,getRotationPoint:function(t){return m("target",_(t,"targetLabelX","targetLabelY"),t)},getRotationOffset:function(t){return d(g(t))},isVisible:f}),T=e.data.lyrTxrCache=new xx(e);e.onUpdateEleCalcs((function(t,e){v.invalidateElements(e),y.invalidateElements(e),b.invalidateElements(e),E.invalidateElements(e),T.invalidateElements(e);for(var n=0;n<e.length;n++){var i=e[n]._private;i.oldBackgroundTimestamp=i.backgroundTimestamp}}));var R=function(t){for(var e=0;e<t.length;e++)T.enqueueElementRefinement(t[e].ele)};v.onDequeue(R),y.onDequeue(R),b.onDequeue(R),E.onDequeue(R)}aS.CANVAS_LAYERS=3,aS.SELECT_BOX=0,aS.DRAG=1,aS.NODE=2,aS.BUFFER_COUNT=3,aS.TEXTURE_BUFFER=0,aS.MOTIONBLUR_BUFFER_NODE=1,aS.MOTIONBLUR_BUFFER_DRAG=2,aS.redrawHint=function(t,e){var n=this;switch(t){case"eles":n.data.canvasNeedsRedraw[aS.NODE]=e;break;case"drag":n.data.canvasNeedsRedraw[aS.DRAG]=e;break;case"select":n.data.canvasNeedsRedraw[aS.SELECT_BOX]=e}};var cS="undefined"!=typeof Path2D;aS.path2dEnabled=function(t){if(void 0===t)return this.pathsEnabled;this.pathsEnabled=!!t},aS.usePaths=function(){return cS&&this.pathsEnabled},aS.setImgSmoothing=function(t,e){null!=t.imageSmoothingEnabled?t.imageSmoothingEnabled=e:(t.webkitImageSmoothingEnabled=e,t.mozImageSmoothingEnabled=e,t.msImageSmoothingEnabled=e)},aS.getImgSmoothing=function(t){return null!=t.imageSmoothingEnabled?t.imageSmoothingEnabled:t.webkitImageSmoothingEnabled||t.mozImageSmoothingEnabled||t.msImageSmoothingEnabled},aS.makeOffscreenCanvas=function(t,e){var n;return"undefined"!==("undefined"==typeof OffscreenCanvas?"undefined":S_(OffscreenCanvas))?n=new OffscreenCanvas(t,e):((n=document.createElement("canvas")).width=t,n.height=e),n},[wx,Mx,Wx,zx,Xx,Yx,Kx,$x,nS,rS].forEach((function(t){rv(aS,t)}));var dS=[{type:"layout",extensions:jC},{type:"renderer",extensions:[{name:"null",impl:YC},{name:"base",impl:_x},{name:"canvas",impl:sS}]}],uS={},hS={};function pS(t,e,n){var i=n,o=function(n){Dv("Can not register `"+e+"` for `"+t+"` since `"+n+"` already exists in the prototype and can not be overridden")};if("core"===t){if(sC.prototype[e])return o(e);sC.prototype[e]=n}else if("collection"===t){if(CR.prototype[e])return o(e);CR.prototype[e]=n}else if("layout"===t){for(var r=function(t){this.options=t,n.call(this,t),G_(this._private)||(this._private={}),this._private.cy=t.cy,this._private.listeners=[],this.createEmitter()},s=r.prototype=Object.create(n.prototype),a=[],l=0;l<a.length;l++){var c=a[l];s[c]=s[c]||function(){return this}}s.start&&!s.run?s.run=function(){return this.start(),this}:!s.start&&s.run&&(s.start=function(){return this.run(),this});var d=n.prototype.stop;s.stop=function(){var t=this.options;if(t&&t.animate){var e=this.animations;if(e)for(var n=0;n<e.length;n++)e[n].stop()}return d?d.call(this):this.emit("layoutstop"),this},s.destroy||(s.destroy=function(){return this}),s.cy=function(){return this._private.cy};var u=function(t){return t._private.cy},h={addEventFields:function(t,e){e.layout=t,e.cy=u(t),e.target=t},bubble:function(){return!0},parent:function(t){return u(t)}};rv(s,{createEmitter:function(){return this._private.emitter=new GT(h,this),this},emitter:function(){return this._private.emitter},on:function(t,e){return this.emitter().on(t,e),this},one:function(t,e){return this.emitter().one(t,e),this},once:function(t,e){return this.emitter().one(t,e),this},removeListener:function(t,e){return this.emitter().removeListener(t,e),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},emit:function(t,e){return this.emitter().emit(t,e),this}}),dE.eventAliasesOn(s),i=r}else if("renderer"===t&&"null"!==e&&"base"!==e){var p=gS("renderer","base"),g=p.prototype,f=n,m=n.prototype,_=function(){p.apply(this,arguments),f.apply(this,arguments)},v=_.prototype;for(var y in g){var b=g[y];if(null!=m[y])return o(y);v[y]=b}for(var E in m)v[E]=m[E];g.clientFunctions.forEach((function(t){v[t]=v[t]||function(){Dv("Renderer does not implement `renderer."+t+"()` on its prototype")}})),i=_}return lv({map:uS,keys:[t,e],value:i})}function gS(t,e){return cv({map:uS,keys:[t,e]})}function fS(t,e,n,i,o){return lv({map:hS,keys:[t,e,n,i],value:o})}function mS(t,e,n,i){return cv({map:hS,keys:[t,e,n,i]})}var _S=function(){return 2===arguments.length?gS.apply(null,arguments):3===arguments.length?pS.apply(null,arguments):4===arguments.length?mS.apply(null,arguments):5===arguments.length?fS.apply(null,arguments):void Dv("Invalid extension access syntax")};sC.prototype.extension=_S,dS.forEach((function(t){t.extensions.forEach((function(e){pS(t.type,e.name,e.impl)}))}));var vS=function t(){if(!(this instanceof t))return new t;this.length=0},yS=vS.prototype;yS.instanceString=function(){return"stylesheet"},yS.selector=function(t){return this[this.length++]={selector:t,properties:[]},this},yS.css=function(t,e){var n=this.length-1;if(H_(t))this[n].properties.push({name:t,value:e});else if(G_(t))for(var i=t,o=Object.keys(i),r=0;r<o.length;r++){var s=o[r],a=i[s];if(null!=a){var l=eC.properties[s]||eC.properties[tv(s)];if(null!=l){var c=l.name,d=a;this[n].properties.push({name:c,value:d})}}}return this},yS.style=yS.css,yS.generateStyle=function(t){var e=new eC(t);return this.appendToStyle(e)},yS.appendToStyle=function(t){for(var e=0;e<this.length;e++){var n=this[e],i=n.selector,o=n.properties;t.selector(i);for(var r=0;r<o.length;r++){var s=o[r];t.css(s.name,s.value)}}return t};var bS=function(t){return void 0===t&&(t={}),G_(t)?new sC(t):H_(t)?_S.apply(_S,arguments):void 0};bS.use=function(t){var e=Array.prototype.slice.call(arguments,1);return e.unshift(bS),t.apply(null,e),this},bS.warnings=function(t){return Nv(t)},bS.version="3.18.1",bS.stylesheet=bS.Stylesheet=vS;var ES=bS;class TS extends Lm{constructor(){super(...arguments),this.workflowsToDisplay=[ys.GENESIS,ys.CALL_ZOME,ys.INCOMING_DHT_OPS,ys.INTEGRATE_DHT_OPS,ys.PRODUCE_DHT_OPS,ys.PUBLISH_DHT_OPS,ys.APP_VALIDATION,ys.SYS_VALIDATION],this.workflowDelay=1e3,this.hideErrors=!1,this.stepByStep=!1,this._onPause=!1,this._callZomeTasks=[],this._runningTasks={},this._errors=[]}observedCells(){return[this.cell]}onNewObservedCell(t){return[t.workflowExecutor.before((async t=>{this.workflowsToDisplay.includes(t.type)&&(t.type===ys.CALL_ZOME?this._callZomeTasks.push(t):(this._runningTasks[t.type]||(this._runningTasks[t.type]=0),this._runningTasks[t.type]+=1),this.requestUpdate(),this.stepByStep?(this.dispatchEvent(new CustomEvent("execution-paused",{detail:{paused:!0},composed:!0,bubbles:!0})),await new Promise((t=>this._resumeObservable.subscribe((()=>t(null))))),this.dispatchEvent(new CustomEvent("execution-paused",{detail:{paused:!1},composed:!0,bubbles:!0}))):await ia(this.workflowDelay))})),t.workflowExecutor.success((async t=>{t.type===ys.CALL_ZOME?this._callZomeTasks=this._callZomeTasks.filter((e=>e!==t)):this._runningTasks[t.type]&&(this._runningTasks[t.type]-=1,0===this._runningTasks[t.type]&&delete this._runningTasks[t.type]),this.requestUpdate()})),t.workflowExecutor.error((async(t,e)=>{if(t.type===ys.CALL_ZOME?this._callZomeTasks=this._callZomeTasks.filter((e=>e!==t)):this._runningTasks[t.type]&&(this._runningTasks[t.type]-=1,0===this._runningTasks[t.type]&&delete this._runningTasks[t.type]),!this.hideErrors){const n={task:t,error:e};this._errors.push(n),this.requestUpdate(),this.stepByStep?(this.dispatchEvent(new CustomEvent("execution-paused",{detail:{paused:!0},composed:!0,bubbles:!0})),await new Promise((t=>this._resumeObservable.subscribe((()=>t(null))))),this.dispatchEvent(new CustomEvent("execution-paused",{detail:{paused:!1},composed:!0,bubbles:!0}))):await ia(this.workflowDelay);const i=this._errors.findIndex((t=>t===n));this._errors.splice(i,1)}this.requestUpdate()}))]}sortTasks(t){return t.sort(((t,e)=>bs(t[0])-bs(e[0])))}showTasks(){return 0!==Object.keys(this._runningTasks).length||0!==this._errors.length||0!==this._callZomeTasks.length}render(){if(!this.showTasks())return F(Pf||(Pf=km``));const t=this.sortTasks(Object.entries(this._runningTasks));return F(Mf||(Mf=km` <mwc-card class="tasks-card"> <mwc-list style="max-height:300px;overflow-y:auto;width:200px"> ${0} ${0} ${0} </mwc-list> ${0} </mwc-card> `),this._callZomeTasks.map((t=>F(Bf||(Bf=km` <mwc-list-item twoline graphic="icon" style="--mdc-list-item-graphic-margin:4px"> <mwc-icon slot="graphic" style="color:green">call_made</mwc-icon> <span>${0}</span> <span slot="secondary">Zome: ${0}</span> </mwc-list-item> `),t.details.fnName,t.details.zome))),this._errors.map((t=>F(Ff||(Ff=km` <mwc-list-item twoline graphic="icon" style="--mdc-list-item-graphic-margin:4px"> <mwc-icon slot="graphic" style="color:red">error_outline</mwc-icon> <span> ${0} </span> <span slot="secondary"> ${0}</span> </mwc-list-item> `),t.error.message,t.task.type===ys.CALL_ZOME?`${t.task.details.fnName} in ${t.task.details.zome}`:t.task.type))),t.map((([t,e])=>F(Hf||(Hf=km` <mwc-list-item twoline graphic="icon" style="--mdc-list-item-graphic-margin:4px"> <mwc-icon slot="graphic">miscellaneous_services</mwc-icon> <span> ${0} ${0} </span> <span slot="secondary">Cell Workflow</span> </mwc-list-item> `),e>1?e+"x":"",t))),this.stepByStep?F(Uf||(Uf=km``)):F(Vf||(Vf=km` <mwc-linear-progress indeterminate></mwc-linear-progress> `)))}static get styles(){return[Pm,st(Gf||(Gf=km`.tasks-card{width:auto}`))]}static get scopedElements(){return{"mwc-card":ld,"mwc-list":_u,"mwc-icon":ul,"mwc-list-item":Rd,"mwc-linear-progress":ap}}}wm([J({type:Object}),Am("design:type",Ys)],TS.prototype,"cell",void 0),wm([J({type:Array}),Am("design:type",Array)],TS.prototype,"workflowsToDisplay",void 0),wm([J({type:Number}),Am("design:type",Number)],TS.prototype,"workflowDelay",void 0),wm([J({type:Boolean,attribute:"hide-errors"}),Am("design:type",Object)],TS.prototype,"hideErrors",void 0),wm([J({type:Boolean}),Am("design:type",Boolean)],TS.prototype,"stepByStep",void 0),wm([J({type:Array}),Am("design:type",Array)],TS.prototype,"_callZomeTasks",void 0),wm([J({type:Object}),Am("design:type",Object)],TS.prototype,"_runningTasks",void 0),wm([J({type:Object}),Am("design:type",Array)],TS.prototype,"_errors",void 0);class RS extends Lm{renderHelpDialog(){return F(Wf||(Wf=km` <mwc-dialog id="help-dialog" .heading="${0}"> <slot></slot> <mwc-button slot="primaryAction" dialogAction="cancel"> Got it! </mwc-button> </mwc-dialog> `),this.heading)}render(){return F(zf||(zf=km` ${0} <mwc-icon-button icon="help_outline" @click="${0}"></mwc-icon-button> `),this.renderHelpDialog(),(()=>this._helpDialog.show()))}static get scopedElements(){return{"mwc-icon-button":en,"mwc-button":bl,"mwc-dialog":qu}}}function CS(t){const e={},n=[];for(const i of t){const t=i.agentPubKey,o=i.p2p.getNeighbors();for(const i of o)e[i]&&e[i][t]||n.push({data:{id:`${t}->${i}`,source:t,target:i},classes:["neighbor-edge"]}),e[t]||(e[t]={}),e[t][i]=!0;for(const e of i.p2p.farKnownPeers)n.push({data:{id:`${t}->${e}`,source:t,target:e},classes:["far-neighbor-edge"]})}return n}wm([J({type:String}),Am("design:type",String)],RS.prototype,"heading",void 0),wm([Z("#help-dialog"),Am("design:type",qu)],RS.prototype,"_helpDialog",void 0);const xS={name:"circle",startAngle:2*Math.PI,ready:t=>{t.cy.resize()}};class SS extends Lm{constructor(){super(...arguments),this.animationDelay=2e3,this.workflowsToDisplay=[ys.CALL_ZOME,ys.APP_VALIDATION],this.networkRequestsToDisplay=[Ks.PUBLISH_REQUEST,Ks.CALL_REMOTE],this.hideTimeController=!1,this.stepByStep=!1,this._resumeObservable=new Gp,this._onPause=!1,this._neighborEdges=[]}async firstUpdated(){window.addEventListener("scroll",(()=>{this._cy.resize(),this.requestUpdate()})),this._cy=ES({container:this._graph,boxSelectionEnabled:!1,autoungrabify:!0,userPanningEnabled:!1,userZoomingEnabled:!1,layout:xS,style:"\n  node {\n    background-color: lightblue;\n    border-color: black;\n    border-width: 2px;\n    label: data(label);\n    font-size: 20px;\n    width: 50px;\n    height: 50px;\n  }\n  \n  .selected {\n    border-width: 4px;\n    border-color: black;\n    border-style: solid;\n  }\n\n  .highlighted {\n    background-color: yellow;\n  }\n\n  edge {\n    width: 1;\n  }\n\n  .network-request {\n    target-arrow-shape: triangle;\n    label: data(label);\n  }\n\n  .neighbor-edge {\n    line-style: dotted;\n  }\n\n  .far-neighbor-edge {\n    line-style: dotted;\n    opacity: 0.2;\n  }\n\n  .network-request {\n    width: 10px;\n    height: 10px;\n    background-color: grey;\n    border-width: 0px;\n  }\n"}),this._cy.on("tap","node",(t=>{this.updatePlayground({activeAgentPubKey:t.target.id()})}));let t=!1;this._cy.on("render",(()=>{0!==this._cy.width()&&(t||(t=!0,setTimeout((()=>{this.setupGraphNodes()}))))}))}highlightNodesWithEntry(){const t=Bm(this.activeDna,this.conductors);if(t.forEach((t=>this._cy.getElementById(t.agentPubKey).removeClass("highlighted"))),this.activeHash){const e=function(t,e){return Mr(t)===Sr.ENTRY?e.filter((e=>{return n=e.getState(),i=t,void 0!==n.metadata.system_meta[i];var n,i})):e.filter((e=>{return n=e.getState(),i=t,"StoreElement"===n.metadata.misc_meta[i];var n,i}))}(this.activeHash,t);for(const t of e)this._cy.getElementById(t.agentPubKey).addClass("highlighted")}}observedCells(){return Bm(this.activeDna,this.conductors)}onNewObservedCell(t){return[t.p2p.networkRequestsExecutor.before((async t=>{if(this.requestUpdate(),!this.networkRequestsToDisplay.includes(t.type))return;if(t.toAgent===t.fromAgent)return;const e=this._cy.getElementById(t.fromAgent);if(!e.position())return;const n=this._cy.getElementById(t.toAgent),i=e.position(),o=n.position();let r=t.type;if(t.type===Ks.PUBLISH_REQUEST){const e=t.details.dhtOps;r=`Publish: ${qo(Object.values(e).map((t=>t.type))).join(", ")}`}const s=this._cy.add([{group:"nodes",data:{networkRequest:t,label:r},position:{x:i.x+1,y:i.y+1},classes:["network-request"]}]);if(this.stepByStep){const t={x:(o.x-i.x)/2+i.x,y:(o.y-i.y)/2+i.y};s.animate({position:t,duration:this.animationDelay/2}),await ia(this.animationDelay/2),this._onPause=!0,await new Promise((t=>this._resumeObservable.subscribe((()=>t(null))))),this._onPause=!1,s.animate({position:o,duration:this.animationDelay/2}),await ia(this.animationDelay/2)}else s.animate({position:n.position(),duration:this.animationDelay}),await ia(this.animationDelay);this._cy.remove(s)}))]}onCellsChanged(){this.setupGraphNodes()}setupGraphNodes(){const t=this._observedCells.sort(((t,e)=>Nr(t.agentPubKey)-Nr(e.agentPubKey))).map((t=>({data:{id:t.agentPubKey,label:`${t.agentPubKey.substr(0,10)}...`},classes:["cell"]})));this._layout&&this._layout.stop(),this._cy.remove("node"),this._cy.remove("edge"),this._cy.add(t);const e=CS(this._observedCells);this._cy.add(e),this._layout=this._cy.elements().makeLayout(xS),this._layout.run(),this._cy.fit(t,t.length<3?170:0),this._cy.center()}updated(t){super.updated(t);const e=CS(this._observedCells);this._neighborEdges.length!=e.length&&(this._neighborEdges=e,this._cy.add(e)),this.observedCells().forEach((t=>this._cy.getElementById(t.agentPubKey).removeClass("selected"))),this._cy.getElementById(this.activeAgentPubKey).addClass("selected"),this.highlightNodesWithEntry(),t.has("_onPause")&&this._cy.style().selector(".cell").style({opacity:this._onPause?.4:1})}renderTimeController(){return this.hideTimeController?F(Xf||(Xf=km``)):F(jf||(jf=km` <div class="row center-content"> ${0} <span class="vertical-divider" style="margin:0 16px;margin-right:24px"></span> <mwc-formfield label="Step By Step" style="margin-right:16px"> <mwc-switch id="step-by-step-switch" .checked="${0}" @change="${0}"></mwc-switch> </mwc-formfield> </div> `),this.stepByStep?F(Yf||(Yf=km` <mwc-icon-button .disabled="${0}" icon="play_arrow" style="${0}" @click="${0}"></mwc-icon-button> `),!this._onPause,qt({"background-color":this._onPause?"#dbdbdb":"white","border-radius":"50%"}),(()=>this._resumeObservable.next())):F(Kf||(Kf=km` <mwc-slider style="margin-right:16px" .value="${0}" pin .min="${0}" .max="${0}" @change="${0}"></mwc-slider> <mwc-icon style="margin:0 8px">speed</mwc-icon> `),7e3-this.animationDelay,1e3,7e3,(t=>this.animationDelay=7e3-t.target.value)),this.stepByStep,(t=>{this.stepByStep=t.target.checked,this._onPause&&this._resumeObservable.next()}))}renderHelp(){return F($f||($f=km` <holochain-playground-help-button heading="DHT Cells" class="block-help"> <span> This is a visual interactive representation of a holochain <a href="https://developer.holochain.org/docs/concepts/4_public_data_on_the_dht/" target="_blank">DHT</a>, with ${0} nodes. <br> <br> In the DHT, all nodes have a <strong>public and private key</strong>. The public key is visible and shared througout the network, but private keys never leave their nodes. This public key is of 256 bits an it's actually the node's ID, which you can see labeled besides the nodes (encoded in base58 strings). <br> <br> If you pay attention, you will see that <strong>all nodes in the DHT are ordered alphabetically</strong>. This is because the nodes organize themselves in neighborhoods: they are more connected with the nodes that are closest to their ID, and less connected with the nodes that are far. </span> </holochain-playground-help-button> `),this.conductors.length)}renderTasksTooltips(){if(!this._cy||!this._observedCells)return F(Jf||(Jf=km``));const t=this._cy.nodes().map((t=>{const e=t.id();return{cell:this._observedCells.find((t=>t.agentPubKey===e)),position:t.renderedPosition()}}));return F(qf||(qf=km`${0}`),t.map((({cell:t,position:e})=>{const n=this._cy.width()/2>e.x,i=this._cy.height()/2>e.y,o=e.x+(n?-250:50),r=e.y+(i?-50:50);return F(Zf||(Zf=km`<holochain-playground-cell-tasks .workflowsToDisplay="${0}" .workflowDelay="${0}" .cell="${0}" style="${0}" .stepByStep="${0}" ._onPause="${0}" ._resumeObservable="${0}" @execution-paused="${0}"> </holochain-playground-cell-tasks>`),this.workflowsToDisplay,this.animationDelay,t,qt({top:`${r}px`,left:`${o}px`,position:"absolute","z-index":"3"}),this.stepByStep,this._onPause,this._resumeObservable,(t=>this._onPause=t.detail.paused))})))}renderCopyButton(){return F(Qf||(Qf=km``))}renderBottomToolbar(){const t=Object.values(ys),e=Object.values(Ks);return F(tm||(tm=km` <div class="row center-content" style="margin:16px;position:relative"> <mwc-button label="Visible Worfklows" style="--mdc-theme-primary:rgba(0,0,0,0.7)" icon="arrow_drop_down" id="active-workflows-button" trailingIcon @click="${0}"></mwc-button> <mwc-menu corner="BOTTOM_END" multi activatable id="active-workflows-menu" .anchor="${0}" @selected="${0}"> ${0} </mwc-menu> <mwc-button label="Visible Network Requests" style="--mdc-theme-primary:rgba(0,0,0,0.7)" icon="arrow_drop_down" id="network-requests-button" trailingIcon @click="${0}"></mwc-button> <mwc-menu corner="BOTTOM_END" multi activatable id="network-requests-menu" .anchor="${0}" @selected="${0}"> ${0} </mwc-menu> <span style="flex:1"></span> ${0} </div> `),(()=>this._activeWorkflowsMenu.show()),this._activeWorkflowsButton,(e=>this.workflowsToDisplay=[...e.detail.index].map((e=>t[e]))),t.map((t=>F(em||(em=km` <mwc-list-item graphic="icon" .selected="${0}" .activated="${0}"> ${0} ${0} </mwc-list-item> `),this.workflowsToDisplay.includes(t),this.workflowsToDisplay.includes(t),this.workflowsToDisplay.includes(t)?F(nm||(nm=km` <mwc-icon slot="graphic">check</mwc-icon> `)):F(im||(im=km``)),t))),(()=>this._networkRequestsMenu.show()),this._networkRequestsButton,(t=>this.networkRequestsToDisplay=[...t.detail.index].map((t=>e[t]))),e.map((t=>F(om||(om=km` <mwc-list-item graphic="icon" .selected="${0}" .activated="${0}"> ${0} ${0} </mwc-list-item> `),this.networkRequestsToDisplay.includes(t),this.networkRequestsToDisplay.includes(t),this.networkRequestsToDisplay.includes(t)?F(rm||(rm=km` <mwc-icon slot="graphic">check</mwc-icon> `)):F(sm||(sm=km``)),t))),this.renderTimeController())}render(){return F(am||(am=km` <mwc-card class="block-card" style="position:relative"> ${0} ${0} ${0} <div class="column fill"> <span class="block-title" style="margin:16px">DHT Cells</span> <div id="graph" class="fill" style="${0}"></div> ${0} </div> </mwc-card> `),this.renderHelp(),this.renderTasksTooltips(),this.renderCopyButton(),qt({"background-color":this._onPause?"#dbdbdba0":"white"}),this.renderBottomToolbar())}static get styles(){return[Pm,st(lm||(lm=km`:host{display:flex}`))]}static get scopedElements(){return{"mwc-card":ld,"mwc-menu-surface":hh,"mwc-button":bl,"mwc-icon":ul,"mwc-menu":ig,"mwc-list-item":Rd,"mwc-slider":Wh,"mwc-switch":ep,"mwc-formfield":vp,"mwc-icon-button":en,"holochain-playground-help-button":RS,"holochain-playground-cell-tasks":TS}}}wm([J({type:Number}),Am("design:type",Number)],SS.prototype,"animationDelay",void 0),wm([J({type:Array}),Am("design:type",Array)],SS.prototype,"workflowsToDisplay",void 0),wm([J({type:Array}),Am("design:type",Array)],SS.prototype,"networkRequestsToDisplay",void 0),wm([J({type:Boolean,attribute:"hide-time-controller"}),Am("design:type",Boolean)],SS.prototype,"hideTimeController",void 0),wm([J({type:Boolean,attribute:"step-by-step"}),Am("design:type",Object)],SS.prototype,"stepByStep",void 0),wm([Z("#graph"),Am("design:type",Object)],SS.prototype,"_graph",void 0),wm([Z("#active-workflows-button"),Am("design:type",bl)],SS.prototype,"_activeWorkflowsButton",void 0),wm([Z("#active-workflows-menu"),Am("design:type",ig)],SS.prototype,"_activeWorkflowsMenu",void 0),wm([Z("#network-requests-button"),Am("design:type",bl)],SS.prototype,"_networkRequestsButton",void 0),wm([Z("#network-requests-menu"),Am("design:type",ig)],SS.prototype,"_networkRequestsMenu",void 0),wm([J({type:Boolean}),Am("design:type",Object)],SS.prototype,"_onPause",void 0);class IS extends Lm{constructor(){super(...arguments),this.processing=!1}static get styles(){return Pm}get activeCell(){return Fm(this.activeDna,this.activeAgentPubKey,this.conductors)||this.allCells[0]}get allCells(){return Bm(this.activeDna,this.conductors)}renderStatsHelp(){return F(cm||(cm=km` <mwc-dialog id="stats-help" heading="DHT Statistics Help"> <span> This panel contains statistics for the current state of the DHT. <br> <br> Having a redundancy factor of ${0}, it will <strong> replicate every DHT Op in the ${0} nodes that are closest to its neighborhood </strong>. <br> <br> The number of <strong>DHT Ops (DHT Operation Transforms) is a measure of the load that the DHT has to hold</strong>. A DHT Op is the command that a node receives to indicate it has to change something in its shard of the DHT. Example of DHT Ops are "StoreEntry", "RegisterAddLink". </span> <mwc-button slot="primaryAction" dialogAction="cancel"> Got it! </mwc-button> </mwc-dialog> `),Hm(this.activeCell),Hm(this.activeCell))}async republish(){const t=parseInt(this.nNodes.value),e=this.allCells.length;parseInt(this.rFactor.value),this.activeDna;let n=this.conductors;if(t>e){const i=t-e;n=await ra(i,n,na())}else if(t<e){const i=e-t,o=t=>Math.max(...Mm(this.activeDna,t).map((t=>t.getState().sourceChain.length)));n=n.sort(((t,e)=>o(t)-o(e))),n.splice(0,i)}this.processing=!1}updateDHTStats(){this.processing=!0,this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout((()=>{this.republish()}),400)}render(){return F(dm||(dm=km` ${0} <div class="column" style="position:relative"> <div style="padding:16px"> <span class="title">Global DHT Stats</span> <mwc-icon-button style="position:absolute;right:8px;top:8px" icon="help_outline" @click="${0}"></mwc-icon-button> <div class="row center-content"> <div class="row center-content" style="padding-right:16px"> <span style="margin-right:8px">Number of nodes: </span><mwc-textfield id="number-of-nodes" min="1" max="50" outlined type="number" style="width:5em" .disabled="${0}" @change="${0}" .value="${0}"></mwc-textfield> </div> <div class="row center-content" style="padding-right:24px"> <span style="margin-right:8px">Redundancy factor: </span><mwc-textfield id="r-factor" min="1" max="50" outlined type="number" .disabled="${0}" style="width:5em" @change="${0}" .value="${0}"></mwc-textfield> </div> <div class="column fill"> <span style="margin-bottom:2px">Unique DHT Ops: <strong>${0}</strong></span> <span style="margin-bottom:2px">Median DHT Ops per node: <strong>${0}</strong></span> <span>Global DHT Ops: <strong>${0}</strong></span> </div> </div> </div> ${0} </div> `),this.renderStatsHelp(),(()=>this.statsHelp.open=!0),void 0!==this.conductorsUrls,(()=>this.updateDHTStats()),this.allCells.length.toString(),void 0!==this.conductorsUrls,(()=>this.updateDHTStats()),Hm(this.activeCell).toString(),function(t){const e={};for(const n of t)for(const t of Object.keys(n.getState().integratedDHTOps))e[t]={};return Object.keys(e).length}(this.allCells),function(t){const e=[];for(const n of t)e.push(Object.keys(n.getState().integratedDHTOps).length);e.sort();const n=Math.floor(e.length/2);return e.sort(((t,e)=>t-e))[n]}(this.allCells),function(t){let e=0;for(const n of t)e+=Object.keys(n.getState().integratedDHTOps).length;return e}(this.allCells),this.processing?F(um||(um=km`<mwc-linear-progress indeterminate></mwc-linear-progress>`)):F(hm||(hm=km``)))}static get scopedElements(){return{"mwc-linear-progress":ap,"mwc-textfield":sl,"mwc-icon-button":en,"mwc-dialog":qu}}}function OS(t,e,n){const i={},o={},r={};for(const e of t){const t=e.getState();for(const n of Wr(t)){i[n]=Gr(t,n),o[n]||(o[n]=[]),o[n].push(zr(t,n));const s=i[n].headers[0];s&&s.header.content.entry_type&&(r[n]=ls(e,s.header.content.entry_type))}}const s=function(t,e){return t.sort(((t,n)=>function(t,e,n){const i=Object.values(t[e].headers).sort(wS),o=Object.values(t[n].headers).sort(wS);return i.length>0?En(i[0].header.content.timestamp):0-o.length>0?En(o[0].header.content.timestamp):0}(e,t,n)))}(Object.keys(i),i),a=[],l=[],c={};for(const t of s){const s=i[t],d=s.entry,u=s.headers[0],h=r[t];if(c[h]||(c[h]=0),!n.includes(h)){if(l.push({data:{id:t,data:d,label:`${h}${c[h]}`},classes:[h]}),e){const e=e_(d.content);if("object"==typeof e){const n=Object.keys(d.content);for(const i of n){const n=`${t}:${i}`;l.push({data:{id:n,parent:t}}),l.push({data:{id:`${n}:key`,label:i,parent:n}}),l.push({data:{id:`${n}:value`,label:e[i],parent:n}})}}else l.push({data:{id:`${t}:content`,label:e,parent:t}})}if(as(u.header.content.entry_type)){const e=kS(Object.keys(i),d.content);for(const i of e)n.includes(r[i.target])||a.push({data:{id:`${t}->${i.target}`,source:t,target:i.target,label:i.label},classes:["implicit"]})}const p=o[t];if(p){const e=Yr(p);for(const i of e){const e=i.tag&&"string"!=typeof i.tag?JSON.stringify(i.tag):i.tag,o=i.target;if(!n.includes(r[o])){const n={data:{id:`${t}->${o}`,source:t,target:o},classes:["explicit"]};e&&(n.data.label=e),a.push(n)}}}const g=s.headers.filter((e=>e.header.content.original_header_address&&e.header.content.original_entry_address===t));for(const e of g){const n=e.header.content.entry_hash;a.push({data:{id:`${t}-updated-by-${n}`,source:t,target:n,label:"updated by"},classes:["update-edge"]})}const f=l.find((e=>e.data.id===t));s.updates.length>0&&f.classes.push("updated"),s.deletes.length>0&&f.classes.push("deleted")}c[h]+=1}return{entries:[...l,...a],entryTypes:Object.keys(c)}}function kS(t,e){if(!e)return[];if("string"==typeof e)return t.includes(e)?[{label:void 0,target:e}]:[];if(Array.isArray(e)&&e.length>0&&"string"==typeof e[0])return e.filter((e=>t.includes(e))).map((t=>({target:t,label:void 0})));if("object"==typeof e){const n=Object.entries(e).map((([e,n])=>{const i=kS(t,n);for(const t of i)t.label||(t.label=e);return i}));return[].concat(...n)}return[]}function wS(t,e){return En(t.header.content.timestamp)-En(e.header.content.timestamp)}wm([Z("#stats-help"),Am("design:type",qu)],IS.prototype,"statsHelp",void 0),wm([Z("#number-of-nodes"),Am("design:type",sl)],IS.prototype,"nNodes",void 0),wm([Z("#r-factor"),Am("design:type",sl)],IS.prototype,"rFactor",void 0),wm([J({type:Boolean}),Am("design:type",Boolean)],IS.prototype,"processing",void 0);var AS=r_((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(t,e,n){this.source=t,this.target=e,this.type=n};e.PowerEdge=n;var i=function(){function t(t,e,n,i){var o=this;if(this.linkAccessor=n,this.modules=new Array(t),this.roots=[],i)this.initModulesFromGroup(i);else{this.roots.push(new s);for(var a=0;a<t;++a)this.roots[0].add(this.modules[a]=new r(a))}this.R=e.length,e.forEach((function(t){var e=o.modules[n.getSourceIndex(t)],i=o.modules[n.getTargetIndex(t)],r=n.getType(t);e.outgoing.add(r,i),i.incoming.add(r,e)}))}return t.prototype.initModulesFromGroup=function(t){var e=new s;this.roots.push(e);for(var n=0;n<t.leaves.length;++n){var i=t.leaves[n],o=new r(i.id);this.modules[i.id]=o,e.add(o)}if(t.groups)for(var l=0;l<t.groups.length;++l){var c=t.groups[l],d={};for(var u in c)"leaves"!==u&&"groups"!==u&&c.hasOwnProperty(u)&&(d[u]=c[u]);e.add(new r(-1-l,new a,new a,this.initModulesFromGroup(c),d))}return e},t.prototype.merge=function(t,e,n){void 0===n&&(n=0);var i=t.incoming.intersection(e.incoming),o=t.outgoing.intersection(e.outgoing),a=new s;a.add(t),a.add(e);var l=new r(this.modules.length,o,i,a);this.modules.push(l);var c=function(n,i,o){n.forAll((function(n,r){n.forAll((function(n){var s=n[i];s.add(r,l),s.remove(r,t),s.remove(r,e),t[o].remove(r,n),e[o].remove(r,n)}))}))};return c(o,"incoming","outgoing"),c(i,"outgoing","incoming"),this.R-=i.count()+o.count(),this.roots[n].remove(t),this.roots[n].remove(e),this.roots[n].add(l),l},t.prototype.rootMerges=function(t){void 0===t&&(t=0);for(var e=this.roots[t].modules(),n=e.length,i=new Array(n*(n-1)),o=0,r=0,s=n-1;r<s;++r)for(var a=r+1;a<n;++a){var l=e[r],c=e[a];i[o]={id:o,nEdges:this.nEdges(l,c),a:l,b:c},o++}return i},t.prototype.greedyMerge=function(){for(var t=0;t<this.roots.length;++t)if(!(this.roots[t].modules().length<2)){var e=this.rootMerges(t).sort((function(t,e){return t.nEdges==e.nEdges?t.id-e.id:t.nEdges-e.nEdges}))[0];if(!(e.nEdges>=this.R))return this.merge(e.a,e.b,t),!0}},t.prototype.nEdges=function(t,e){var n=t.incoming.intersection(e.incoming),i=t.outgoing.intersection(e.outgoing);return this.R-n.count()-i.count()},t.prototype.getGroupHierarchy=function(t){var e=this,i=[];return o(this.roots[0],{},i),this.allEdges().forEach((function(o){var r=e.modules[o.source],s=e.modules[o.target];t.push(new n(void 0===r.gid?o.source:i[r.gid],void 0===s.gid?o.target:i[s.gid],o.type))})),i},t.prototype.allEdges=function(){var e=[];return t.getEdges(this.roots[0],e),e},t.getEdges=function(e,n){e.forAll((function(e){e.getEdges(n),t.getEdges(e.children,n)}))},t}();function o(t,e,n){t.forAll((function(t){if(t.isLeaf())e.leaves||(e.leaves=[]),e.leaves.push(t.id);else{var i=e;if(t.gid=n.length,!t.isIsland()||t.isPredefined()){if(i={id:t.gid},t.isPredefined())for(var r in t.definition)i[r]=t.definition[r];e.groups||(e.groups=[]),e.groups.push(t.gid),n.push(i)}o(t.children,i,n)}}))}e.Configuration=i;var r=function(){function t(t,e,n,i,o){void 0===e&&(e=new a),void 0===n&&(n=new a),void 0===i&&(i=new s),this.id=t,this.outgoing=e,this.incoming=n,this.children=i,this.definition=o}return t.prototype.getEdges=function(t){var e=this;this.outgoing.forAll((function(i,o){i.forAll((function(i){t.push(new n(e.id,i.id,o))}))}))},t.prototype.isLeaf=function(){return 0===this.children.count()},t.prototype.isIsland=function(){return 0===this.outgoing.count()&&0===this.incoming.count()},t.prototype.isPredefined=function(){return void 0!==this.definition},t}();e.Module=r;var s=function(){function t(){this.table={}}return t.prototype.count=function(){return Object.keys(this.table).length},t.prototype.intersection=function(e){var n=new t;return n.table=function(t,e){var n={};for(var i in t)i in e&&(n[i]=t[i]);return n}(this.table,e.table),n},t.prototype.intersectionCount=function(t){return this.intersection(t).count()},t.prototype.contains=function(t){return t in this.table},t.prototype.add=function(t){this.table[t.id]=t},t.prototype.remove=function(t){delete this.table[t.id]},t.prototype.forAll=function(t){for(var e in this.table)t(this.table[e])},t.prototype.modules=function(){var t=[];return this.forAll((function(e){e.isPredefined()||t.push(e)})),t},t}();e.ModuleSet=s;var a=function(){function t(){this.sets={},this.n=0}return t.prototype.count=function(){return this.n},t.prototype.contains=function(t){var e=!1;return this.forAllModules((function(n){e||n.id!=t||(e=!0)})),e},t.prototype.add=function(t,e){(t in this.sets?this.sets[t]:this.sets[t]=new s).add(e),++this.n},t.prototype.remove=function(t,e){var n=this.sets[t];n.remove(e),0===n.count()&&delete this.sets[t],--this.n},t.prototype.forAll=function(t){for(var e in this.sets)t(this.sets[e],Number(e))},t.prototype.forAllModules=function(t){this.forAll((function(e,n){return e.forAll(t)}))},t.prototype.intersection=function(e){var n=new t;return this.forAll((function(t,i){if(i in e.sets){var o=t.intersection(e.sets[i]),r=o.count();r>0&&(n.sets[i]=o,n.n+=r)}})),n},t}();e.LinkSets=a,e.getGroups=function(t,e,n,o){for(var r=t.length,s=new i(r,e,n,o);s.greedyMerge(););var a=[],l=s.getGroupHierarchy(a);return a.forEach((function(e){var n=function(n){var i=e[n];"number"==typeof i&&(e[n]=t[i])};n("source"),n("target")})),{groups:l,powerEdges:a}}})),DS=r_((function(t,e){function n(t,e){var n={};for(var i in t)n[i]={};for(var i in e)n[i]={};return Object.keys(n).length}function i(t,e){var n=0;for(var i in t)void 0!==e[i]&&++n;return n}function o(t,e,n,i){var o=function(t,e){var n={},i=function(t,e){void 0===n[t]&&(n[t]={}),n[t][e]={}};return t.forEach((function(t){var n=e.getSourceIndex(t),o=e.getTargetIndex(t);i(n,o),i(o,n)})),n}(t,i);t.forEach((function(t){var r=o[i.getSourceIndex(t)],s=o[i.getTargetIndex(t)];i.setLength(t,1+e*n(r,s))}))}function r(t,e,n){var i=[],o=0,r=[],s=[];function a(t){t.index=t.lowlink=o++,r.push(t),t.onStack=!0;for(var e=0,n=t.out;e<n.length;e++){var i=n[e];void 0===i.index?(a(i),t.lowlink=Math.min(t.lowlink,i.lowlink)):i.onStack&&(t.lowlink=Math.min(t.lowlink,i.index))}if(t.lowlink===t.index){for(var l=[];r.length&&((i=r.pop()).onStack=!1,l.push(i),i!==t););s.push(l.map((function(t){return t.id})))}}for(var l=0;l<t;l++)i.push({id:l,out:[]});for(var c=0,d=e;c<d.length;c++){var u=d[c],h=i[n.getSourceIndex(u)],p=i[n.getTargetIndex(u)];h.out.push(p)}for(var g=0,f=i;g<f.length;g++){var m=f[g];void 0===m.index&&a(m)}return s}Object.defineProperty(e,"__esModule",{value:!0}),e.symmetricDiffLinkLengths=function(t,e,r){void 0===r&&(r=1),o(t,r,(function(t,e){return Math.sqrt(n(t,e)-i(t,e))}),e)},e.jaccardLinkLengths=function(t,e,r){void 0===r&&(r=1),o(t,r,(function(t,e){return Math.min(Object.keys(t).length,Object.keys(e).length)<1.1?0:i(t,e)/n(t,e)}),e)},e.generateDirectedEdgeConstraints=function(t,e,n,i){var o=r(t,e,i),s={};o.forEach((function(t,e){return t.forEach((function(t){return s[t]=e}))}));var a=[];return e.forEach((function(t){var e=i.getSourceIndex(t),o=i.getTargetIndex(t);s[e]!==s[o]&&a.push({axis:n,left:e,right:o,gap:i.getMinSeparation(t)})})),a},e.stronglyConnectedComponents=r})),NS=r_((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){this.locks={}}return t.prototype.add=function(t,e){this.locks[t]=e},t.prototype.clear=function(){this.locks={}},t.prototype.isEmpty=function(){for(var t in this.locks)return!1;return!0},t.prototype.apply=function(t){for(var e in this.locks)t(Number(e),this.locks[e])},t}();e.Locks=n;var i=function(){function t(t,e,i){void 0===i&&(i=null),this.D=e,this.G=i,this.threshold=1e-4,this.numGridSnapNodes=0,this.snapGridSize=100,this.snapStrength=1e3,this.scaleSnapByMaxH=!1,this.random=new o,this.project=null,this.x=t,this.k=t.length;var r=this.n=t[0].length;this.H=new Array(this.k),this.g=new Array(this.k),this.Hd=new Array(this.k),this.a=new Array(this.k),this.b=new Array(this.k),this.c=new Array(this.k),this.d=new Array(this.k),this.e=new Array(this.k),this.ia=new Array(this.k),this.ib=new Array(this.k),this.xtmp=new Array(this.k),this.locks=new n,this.minD=Number.MAX_VALUE;for(var s,a=r;a--;)for(s=r;--s>a;){var l=e[a][s];l>0&&l<this.minD&&(this.minD=l)}for(this.minD===Number.MAX_VALUE&&(this.minD=1),a=this.k;a--;){for(this.g[a]=new Array(r),this.H[a]=new Array(r),s=r;s--;)this.H[a][s]=new Array(r);this.Hd[a]=new Array(r),this.a[a]=new Array(r),this.b[a]=new Array(r),this.c[a]=new Array(r),this.d[a]=new Array(r),this.e[a]=new Array(r),this.ia[a]=new Array(r),this.ib[a]=new Array(r),this.xtmp[a]=new Array(r)}}return t.createSquareMatrix=function(t,e){for(var n=new Array(t),i=0;i<t;++i){n[i]=new Array(t);for(var o=0;o<t;++o)n[i][o]=e(i,o)}return n},t.prototype.offsetDir=function(){for(var t=this,e=new Array(this.k),n=0,i=0;i<this.k;++i){var o=e[i]=this.random.getNextBetween(.01,1)-.5;n+=o*o}return n=Math.sqrt(n),e.map((function(e){return e*(t.minD/n)}))},t.prototype.computeDerivatives=function(t){var e=this,n=this.n;if(!(n<1)){for(var i,o=new Array(this.k),r=new Array(this.k),s=new Array(this.k),a=0,l=0;l<n;++l){for(i=0;i<this.k;++i)s[i]=this.g[i][l]=0;for(var c=0;c<n;++c)if(l!==c){for(var d=n;d--;){var u=0;for(i=0;i<this.k;++i){var h=o[i]=t[i][l]-t[i][c];u+=r[i]=h*h}if(u>1e-9)break;var p=this.offsetDir();for(i=0;i<this.k;++i)t[i][c]+=p[i]}var g=Math.sqrt(u),f=this.D[l][c],m=null!=this.G?this.G[l][c]:1;if(m>1&&g>f||!isFinite(f))for(i=0;i<this.k;++i)this.H[i][l][c]=0;else{m>1&&(m=1);var _=f*f,v=2*m*(g-f)/(_*g),y=g*g*g,b=2*-m/(_*y);for(isFinite(v)||console.log(v),i=0;i<this.k;++i)this.g[i][l]+=o[i]*v,s[i]-=this.H[i][l][c]=b*(y+f*(r[i]-u)+g*u)}}for(i=0;i<this.k;++i)a=Math.max(a,this.H[i][l][l]=s[i])}var E=this.snapGridSize/2,T=this.snapGridSize,R=this.snapStrength/(E*E),C=this.numGridSnapNodes;for(l=0;l<C;++l)for(i=0;i<this.k;++i){var x=this.x[i][l],S=x/T,I=S%1,O=S-I;-E<(h=Math.abs(I)<=.5?x-O*T:x>0?x-(O+1)*T:x-(O-1)*T)&&h<=E&&(this.scaleSnapByMaxH?(this.g[i][l]+=a*R*h,this.H[i][l][l]+=a*R):(this.g[i][l]+=R*h,this.H[i][l][l]+=R))}this.locks.isEmpty()||this.locks.apply((function(n,o){for(i=0;i<e.k;++i)e.H[i][n][n]+=a,e.g[i][n]-=a*(o[i]-t[i][n])}))}},t.dotProd=function(t,e){for(var n=0,i=t.length;i--;)n+=t[i]*e[i];return n},t.rightMultiply=function(e,n,i){for(var o=e.length;o--;)i[o]=t.dotProd(e[o],n)},t.prototype.computeStepSize=function(e){for(var n=0,i=0,o=0;o<this.k;++o)n+=t.dotProd(this.g[o],e[o]),t.rightMultiply(this.H[o],e[o],this.Hd[o]),i+=t.dotProd(e[o],this.Hd[o]);return 0!==i&&isFinite(i)?1*n/i:0},t.prototype.reduceStress=function(){this.computeDerivatives(this.x);for(var t=this.computeStepSize(this.g),e=0;e<this.k;++e)this.takeDescentStep(this.x[e],this.g[e],t);return this.computeStress()},t.copy=function(t,e){for(var n=t.length,i=e[0].length,o=0;o<n;++o)for(var r=0;r<i;++r)e[o][r]=t[o][r]},t.prototype.stepAndProject=function(e,n,i,o){t.copy(e,n),this.takeDescentStep(n[0],i[0],o),this.project&&this.project[0](e[0],e[1],n[0]),this.takeDescentStep(n[1],i[1],o),this.project&&this.project[1](n[0],e[1],n[1]);for(var r=2;r<this.k;r++)this.takeDescentStep(n[r],i[r],o)},t.mApply=function(t,e,n){for(var i=t;i-- >0;)for(var o=e;o-- >0;)n(i,o)},t.prototype.matrixApply=function(e){t.mApply(this.k,this.n,e)},t.prototype.computeNextPosition=function(t,e){var n=this;this.computeDerivatives(t);var i=this.computeStepSize(this.g);if(this.stepAndProject(t,e,this.g,i),this.project){this.matrixApply((function(i,o){return n.e[i][o]=t[i][o]-e[i][o]}));var o=this.computeStepSize(this.e);o=Math.max(.2,Math.min(o,1)),this.stepAndProject(t,e,this.e,o)}},t.prototype.run=function(t){for(var e=Number.MAX_VALUE,n=!1;!n&&t-- >0;){var i=this.rungeKutta();n=Math.abs(e/i-1)<this.threshold,e=i}return e},t.prototype.rungeKutta=function(){var e=this;this.computeNextPosition(this.x,this.a),t.mid(this.x,this.a,this.ia),this.computeNextPosition(this.ia,this.b),t.mid(this.x,this.b,this.ib),this.computeNextPosition(this.ib,this.c),this.computeNextPosition(this.c,this.d);var n=0;return this.matrixApply((function(t,i){var o=(e.a[t][i]+2*e.b[t][i]+2*e.c[t][i]+e.d[t][i])/6,r=e.x[t][i]-o;n+=r*r,e.x[t][i]=o})),n},t.mid=function(e,n,i){t.mApply(e.length,e[0].length,(function(t,o){return i[t][o]=e[t][o]+(n[t][o]-e[t][o])/2}))},t.prototype.takeDescentStep=function(t,e,n){for(var i=0;i<this.n;++i)t[i]=t[i]-n*e[i]},t.prototype.computeStress=function(){for(var t=0,e=0,n=this.n-1;e<n;++e)for(var i=e+1,o=this.n;i<o;++i){for(var r=0,s=0;s<this.k;++s){var a=this.x[s][e]-this.x[s][i];r+=a*a}r=Math.sqrt(r);var l=this.D[e][i];if(isFinite(l)){var c=l-r;t+=c*c/(l*l)}}return t},t.zeroDistance=1e-10,t}();e.Descent=i;var o=function(){function t(t){void 0===t&&(t=1),this.seed=t,this.a=214013,this.c=2531011,this.m=2147483648,this.range=32767}return t.prototype.getNext=function(){return this.seed=(this.seed*this.a+this.c)%this.m,(this.seed>>16)/this.range},t.prototype.getNextBetween=function(t,e){return t+this.getNext()*(e-t)},t}();e.PseudoRandom=o})),LS=r_((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){this.scale=t,this.AB=0,this.AD=0,this.A2=0}return t.prototype.addVariable=function(t){var e=this.scale/t.scale,n=t.offset/t.scale,i=t.weight;this.AB+=i*e*n,this.AD+=i*e*t.desiredPosition,this.A2+=i*e*e},t.prototype.getPosn=function(){return(this.AD-this.AB)/this.A2},t}();e.PositionStats=n;var i=function(){function t(t,e,n,i){void 0===i&&(i=!1),this.left=t,this.right=e,this.gap=n,this.equality=i,this.active=!1,this.unsatisfiable=!1,this.left=t,this.right=e,this.gap=n,this.equality=i}return t.prototype.slack=function(){return this.unsatisfiable?Number.MAX_VALUE:this.right.scale*this.right.position()-this.gap-this.left.scale*this.left.position()},t}();e.Constraint=i;var o=function(){function t(t,e,n){void 0===e&&(e=1),void 0===n&&(n=1),this.desiredPosition=t,this.weight=e,this.scale=n,this.offset=0}return t.prototype.dfdv=function(){return 2*this.weight*(this.position()-this.desiredPosition)},t.prototype.position=function(){return(this.block.ps.scale*this.block.posn+this.offset)/this.scale},t.prototype.visitNeighbours=function(t,e){var n=function(n,i){return n.active&&t!==i&&e(n,i)};this.cOut.forEach((function(t){return n(t,t.right)})),this.cIn.forEach((function(t){return n(t,t.left)}))},t}();e.Variable=o;var r=function(){function t(t){this.vars=[],t.offset=0,this.ps=new n(t.scale),this.addVariable(t)}return t.prototype.addVariable=function(t){t.block=this,this.vars.push(t),this.ps.addVariable(t),this.posn=this.ps.getPosn()},t.prototype.updateWeightedPosition=function(){this.ps.AB=this.ps.AD=this.ps.A2=0;for(var t=0,e=this.vars.length;t<e;++t)this.ps.addVariable(this.vars[t]);this.posn=this.ps.getPosn()},t.prototype.compute_lm=function(t,e,n){var i=this,o=t.dfdv();return t.visitNeighbours(e,(function(e,r){var s=i.compute_lm(r,t,n);r===e.right?(o+=s*e.left.scale,e.lm=s):(o+=s*e.right.scale,e.lm=-s),n(e)})),o/t.scale},t.prototype.populateSplitBlock=function(t,e){var n=this;t.visitNeighbours(e,(function(e,i){i.offset=t.offset+(i===e.right?e.gap:-e.gap),n.addVariable(i),n.populateSplitBlock(i,t)}))},t.prototype.traverse=function(t,e,n,i){var o=this;void 0===n&&(n=this.vars[0]),void 0===i&&(i=null),n.visitNeighbours(i,(function(i,r){e.push(t(i)),o.traverse(t,e,r,n)}))},t.prototype.findMinLM=function(){var t=null;return this.compute_lm(this.vars[0],null,(function(e){!e.equality&&(null===t||e.lm<t.lm)&&(t=e)})),t},t.prototype.findMinLMBetween=function(t,e){this.compute_lm(t,null,(function(){}));var n=null;return this.findPath(t,null,e,(function(t,e){!t.equality&&t.right===e&&(null===n||t.lm<n.lm)&&(n=t)})),n},t.prototype.findPath=function(t,e,n,i){var o=this,r=!1;return t.visitNeighbours(e,(function(e,s){r||s!==n&&!o.findPath(s,t,n,i)||(r=!0,i(e,s))})),r},t.prototype.isActiveDirectedPathBetween=function(t,e){if(t===e)return!0;for(var n=t.cOut.length;n--;){var i=t.cOut[n];if(i.active&&this.isActiveDirectedPathBetween(i.right,e))return!0}return!1},t.split=function(e){return e.active=!1,[t.createSplitBlock(e.left),t.createSplitBlock(e.right)]},t.createSplitBlock=function(e){var n=new t(e);return n.populateSplitBlock(e,null),n},t.prototype.splitBetween=function(e,n){var i=this.findMinLMBetween(e,n);if(null!==i){var o=t.split(i);return{constraint:i,lb:o[0],rb:o[1]}}return null},t.prototype.mergeAcross=function(t,e,n){e.active=!0;for(var i=0,o=t.vars.length;i<o;++i){var r=t.vars[i];r.offset+=n,this.addVariable(r)}this.posn=this.ps.getPosn()},t.prototype.cost=function(){for(var t=0,e=this.vars.length;e--;){var n=this.vars[e],i=n.position()-n.desiredPosition;t+=i*i*n.weight}return t},t}();e.Block=r;var s=function(){function t(t){this.vs=t;var e=t.length;for(this.list=new Array(e);e--;){var n=new r(t[e]);this.list[e]=n,n.blockInd=e}}return t.prototype.cost=function(){for(var t=0,e=this.list.length;e--;)t+=this.list[e].cost();return t},t.prototype.insert=function(t){t.blockInd=this.list.length,this.list.push(t)},t.prototype.remove=function(t){var e=this.list.length-1,n=this.list[e];this.list.length=e,t!==n&&(this.list[t.blockInd]=n,n.blockInd=t.blockInd)},t.prototype.merge=function(t){var e=t.left.block,n=t.right.block,i=t.right.offset-t.left.offset-t.gap;e.vars.length<n.vars.length?(n.mergeAcross(e,t,i),this.remove(e)):(e.mergeAcross(n,t,-i),this.remove(n))},t.prototype.forEach=function(t){this.list.forEach(t)},t.prototype.updateBlockPositions=function(){this.list.forEach((function(t){return t.updateWeightedPosition()}))},t.prototype.split=function(t){var e=this;this.updateBlockPositions(),this.list.forEach((function(n){var i=n.findMinLM();null!==i&&i.lm<a.LAGRANGIAN_TOLERANCE&&(n=i.left.block,r.split(i).forEach((function(t){return e.insert(t)})),e.remove(n),t.push(i))}))},t}();e.Blocks=s;var a=function(){function t(t,e){this.vs=t,this.cs=e,this.vs=t,t.forEach((function(t){t.cIn=[],t.cOut=[]})),this.cs=e,e.forEach((function(t){t.left.cOut.push(t),t.right.cIn.push(t)})),this.inactive=e.map((function(t){return t.active=!1,t})),this.bs=null}return t.prototype.cost=function(){return this.bs.cost()},t.prototype.setStartingPositions=function(t){this.inactive=this.cs.map((function(t){return t.active=!1,t})),this.bs=new s(this.vs),this.bs.forEach((function(e,n){return e.posn=t[n]}))},t.prototype.setDesiredPositions=function(t){this.vs.forEach((function(e,n){return e.desiredPosition=t[n]}))},t.prototype.mostViolated=function(){for(var e=Number.MAX_VALUE,n=null,i=this.inactive,o=i.length,r=o,s=0;s<o;++s){var a=i[s];if(!a.unsatisfiable){var l=a.slack();if((a.equality||l<e)&&(e=l,n=a,r=s,a.equality))break}}return r!==o&&(e<t.ZERO_UPPERBOUND&&!n.active||n.equality)&&(i[r]=i[o-1],i.length=o-1),n},t.prototype.satisfy=function(){null==this.bs&&(this.bs=new s(this.vs)),this.bs.split(this.inactive);for(var e=null;(e=this.mostViolated())&&(e.equality||e.slack()<t.ZERO_UPPERBOUND&&!e.active);){var n=e.left.block;if(n!==e.right.block)this.bs.merge(e);else{if(n.isActiveDirectedPathBetween(e.right,e.left)){e.unsatisfiable=!0;continue}var i=n.splitBetween(e.left,e.right);if(null===i){e.unsatisfiable=!0;continue}this.bs.insert(i.lb),this.bs.insert(i.rb),this.bs.remove(n),this.inactive.push(i.constraint),e.slack()>=0?this.inactive.push(e):this.bs.merge(e)}}},t.prototype.solve=function(){this.satisfy();for(var t=Number.MAX_VALUE,e=this.bs.cost();Math.abs(t-e)>1e-4;)this.satisfy(),t=e,e=this.bs.cost();return e},t.LAGRANGIAN_TOLERANCE=-1e-4,t.ZERO_UPPERBOUND=-1e-10,t}();e.Solver=a,e.removeOverlapInOneDimension=function(t,e,n){for(var r=t.map((function(t){return new o(t.desiredCenter)})),s=[],l=t.length,c=0;c<l-1;c++){var d=t[c],u=t[c+1];s.push(new i(r[c],r[c+1],(d.size+u.size)/2))}var h=r[0],p=r[l-1],g=t[0].size/2,f=t[l-1].size/2,m=null,_=null;return e&&(m=new o(e,1e3*h.weight),r.push(m),s.push(new i(m,h,g))),n&&(_=new o(n,1e3*p.weight),r.push(_),s.push(new i(p,_,f))),new a(r,s).solve(),{newCenters:r.slice(0,t.length).map((function(t){return t.position()})),lowerBound:m?m.position():h.position()-g,upperBound:_?_.position():p.position()+f}}})),PS=r_((function(t,e){var n=o_&&o_.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){this.findIter=function(t){for(var e=this._root,n=this.iterator();null!==e;){var i=this._comparator(t,e.data);if(0===i)return n._cursor=e,n;n._ancestors.push(e),e=e.get_child(i>0)}return null}}return t.prototype.clear=function(){this._root=null,this.size=0},t.prototype.find=function(t){for(var e=this._root;null!==e;){var n=this._comparator(t,e.data);if(0===n)return e.data;e=e.get_child(n>0)}return null},t.prototype.lowerBound=function(t){return this._bound(t,this._comparator)},t.prototype.upperBound=function(t){var e=this._comparator;return this._bound(t,(function(t,n){return e(n,t)}))},t.prototype.min=function(){var t=this._root;if(null===t)return null;for(;null!==t.left;)t=t.left;return t.data},t.prototype.max=function(){var t=this._root;if(null===t)return null;for(;null!==t.right;)t=t.right;return t.data},t.prototype.iterator=function(){return new o(this)},t.prototype.each=function(t){for(var e,n=this.iterator();null!==(e=n.next());)t(e)},t.prototype.reach=function(t){for(var e,n=this.iterator();null!==(e=n.prev());)t(e)},t.prototype._bound=function(t,e){for(var n=this._root,i=this.iterator();null!==n;){var o=this._comparator(t,n.data);if(0===o)return i._cursor=n,i;i._ancestors.push(n),n=n.get_child(o>0)}for(var r=i._ancestors.length-1;r>=0;--r)if(e(t,(n=i._ancestors[r]).data)>0)return i._cursor=n,i._ancestors.length=r,i;return i._ancestors.length=0,i},t}();e.TreeBase=i;var o=function(){function t(t){this._tree=t,this._ancestors=[],this._cursor=null}return t.prototype.data=function(){return null!==this._cursor?this._cursor.data:null},t.prototype.next=function(){if(null===this._cursor){var t=this._tree._root;null!==t&&this._minNode(t)}else{var e;if(null===this._cursor.right)do{if(e=this._cursor,!this._ancestors.length){this._cursor=null;break}this._cursor=this._ancestors.pop()}while(this._cursor.right===e);else this._ancestors.push(this._cursor),this._minNode(this._cursor.right)}return null!==this._cursor?this._cursor.data:null},t.prototype.prev=function(){if(null===this._cursor){var t=this._tree._root;null!==t&&this._maxNode(t)}else{var e;if(null===this._cursor.left)do{if(e=this._cursor,!this._ancestors.length){this._cursor=null;break}this._cursor=this._ancestors.pop()}while(this._cursor.left===e);else this._ancestors.push(this._cursor),this._maxNode(this._cursor.left)}return null!==this._cursor?this._cursor.data:null},t.prototype._minNode=function(t){for(;null!==t.left;)this._ancestors.push(t),t=t.left;this._cursor=t},t.prototype._maxNode=function(t){for(;null!==t.right;)this._ancestors.push(t),t=t.right;this._cursor=t},t}();e.Iterator=o;var r=function(){function t(t){this.data=t,this.left=null,this.right=null,this.red=!0}return t.prototype.get_child=function(t){return t?this.right:this.left},t.prototype.set_child=function(t,e){t?this.right=e:this.left=e},t}(),s=function(t){function e(e){var n=t.call(this)||this;return n._root=null,n._comparator=e,n.size=0,n}return n(e,t),e.prototype.insert=function(t){var n=!1;if(null===this._root)this._root=new r(t),n=!0,this.size++;else{var i=new r(void 0),o=!1,s=!1,a=null,l=i,c=null,d=this._root;for(l.right=this._root;;){if(null===d?(d=new r(t),c.set_child(o,d),n=!0,this.size++):e.is_red(d.left)&&e.is_red(d.right)&&(d.red=!0,d.left.red=!1,d.right.red=!1),e.is_red(d)&&e.is_red(c)){var u=l.right===a;d===c.get_child(s)?l.set_child(u,e.single_rotate(a,!s)):l.set_child(u,e.double_rotate(a,!s))}var h=this._comparator(d.data,t);if(0===h)break;s=o,o=h<0,null!==a&&(l=a),a=c,c=d,d=d.get_child(o)}this._root=i.right}return this._root.red=!1,n},e.prototype.remove=function(t){if(null===this._root)return!1;var n=new r(void 0),i=n;i.right=this._root;for(var o=null,s=null,a=null,l=!0;null!==i.get_child(l);){var c=l;s=o,o=i,i=i.get_child(l);var d=this._comparator(t,i.data);if(l=d>0,0===d&&(a=i),!e.is_red(i)&&!e.is_red(i.get_child(l)))if(e.is_red(i.get_child(!l))){var u=e.single_rotate(i,l);o.set_child(c,u),o=u}else if(!e.is_red(i.get_child(!l))){var h=o.get_child(!c);if(null!==h)if(e.is_red(h.get_child(!c))||e.is_red(h.get_child(c))){var p=s.right===o;e.is_red(h.get_child(c))?s.set_child(p,e.double_rotate(o,c)):e.is_red(h.get_child(!c))&&s.set_child(p,e.single_rotate(o,c));var g=s.get_child(p);g.red=!0,i.red=!0,g.left.red=!1,g.right.red=!1}else o.red=!1,h.red=!0,i.red=!0}}return null!==a&&(a.data=i.data,o.set_child(o.right===i,i.get_child(null===i.left)),this.size--),this._root=n.right,null!==this._root&&(this._root.red=!1),null!==a},e.is_red=function(t){return null!==t&&t.red},e.single_rotate=function(t,e){var n=t.get_child(!e);return t.set_child(!e,n.get_child(e)),n.set_child(e,t),t.red=!0,n.red=!1,n},e.double_rotate=function(t,n){return t.set_child(!n,e.single_rotate(t.get_child(!n),!n)),e.single_rotate(t,n)},e}(i);e.RBTree=s})),MS=r_((function(t,e){var n=o_&&o_.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();function i(t){return t.bounds=void 0!==t.leaves?t.leaves.reduce((function(t,e){return e.bounds.union(t)}),o.empty()):o.empty(),void 0!==t.groups&&(t.bounds=t.groups.reduce((function(t,e){return i(e).union(t)}),t.bounds)),t.bounds=t.bounds.inflate(t.padding),t.bounds}Object.defineProperty(e,"__esModule",{value:!0}),e.computeGroupBounds=i;var o=function(){function t(t,e,n,i){this.x=t,this.X=e,this.y=n,this.Y=i}return t.empty=function(){return new t(Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY)},t.prototype.cx=function(){return(this.x+this.X)/2},t.prototype.cy=function(){return(this.y+this.Y)/2},t.prototype.overlapX=function(t){var e=this.cx(),n=t.cx();return e<=n&&t.x<this.X?this.X-t.x:n<=e&&this.x<t.X?t.X-this.x:0},t.prototype.overlapY=function(t){var e=this.cy(),n=t.cy();return e<=n&&t.y<this.Y?this.Y-t.y:n<=e&&this.y<t.Y?t.Y-this.y:0},t.prototype.setXCentre=function(t){var e=t-this.cx();this.x+=e,this.X+=e},t.prototype.setYCentre=function(t){var e=t-this.cy();this.y+=e,this.Y+=e},t.prototype.width=function(){return this.X-this.x},t.prototype.height=function(){return this.Y-this.y},t.prototype.union=function(e){return new t(Math.min(this.x,e.x),Math.max(this.X,e.X),Math.min(this.y,e.y),Math.max(this.Y,e.Y))},t.prototype.lineIntersections=function(e,n,i,o){for(var r=[[this.x,this.y,this.X,this.y],[this.X,this.y,this.X,this.Y],[this.X,this.Y,this.x,this.Y],[this.x,this.Y,this.x,this.y]],s=[],a=0;a<4;++a){var l=t.lineIntersection(e,n,i,o,r[a][0],r[a][1],r[a][2],r[a][3]);null!==l&&s.push({x:l.x,y:l.y})}return s},t.prototype.rayIntersection=function(t,e){var n=this.lineIntersections(this.cx(),this.cy(),t,e);return n.length>0?n[0]:null},t.prototype.vertices=function(){return[{x:this.x,y:this.y},{x:this.X,y:this.y},{x:this.X,y:this.Y},{x:this.x,y:this.Y}]},t.lineIntersection=function(t,e,n,i,o,r,s,a){var l=n-t,c=s-o,d=i-e,u=a-r,h=u*l-c*d;if(0==h)return null;var p=t-o,g=e-r,f=(c*g-u*p)/h,m=(l*g-d*p)/h;return f>=0&&f<=1&&m>=0&&m<=1?{x:t+f*l,y:e+f*d}:null},t.prototype.inflate=function(e){return new t(this.x-e,this.X+e,this.y-e,this.Y+e)},t}();e.Rectangle=o,e.makeEdgeBetween=function(t,e,n){var i=t.rayIntersection(e.cx(),e.cy())||{x:t.cx(),y:t.cy()},o=e.rayIntersection(t.cx(),t.cy())||{x:e.cx(),y:e.cy()},r=o.x-i.x,s=o.y-i.y,a=Math.sqrt(r*r+s*s),l=a-n;return{sourceIntersection:i,targetIntersection:o,arrowStart:{x:i.x+l*r/a,y:i.y+l*s/a}}},e.makeEdgeTo=function(t,e,n){var i=e.rayIntersection(t.x,t.y);i||(i={x:e.cx(),y:e.cy()});var o=i.x-t.x,r=i.y-t.y,s=Math.sqrt(o*o+r*r);return{x:i.x-n*o/s,y:i.y-n*r/s}};var r=function(t,e,n){this.v=t,this.r=e,this.pos=n,this.prev=l(),this.next=l()},s=function(t,e,n){this.isOpen=t,this.v=e,this.pos=n};function a(t,e){return t.pos>e.pos?1:t.pos<e.pos||t.isOpen?-1:e.isOpen?1:0}function l(){return new PS.RBTree((function(t,e){return t.pos-e.pos}))}var c={getCentre:function(t){return t.cx()},getOpen:function(t){return t.y},getClose:function(t){return t.Y},getSize:function(t){return t.width()},makeRect:function(t,e,n,i){return new o(n-i/2,n+i/2,t,e)},findNeighbours:function(t,e){var n=function(n,i){for(var o,r=e.findIter(t);null!==(o=r[n]());){var s=o.r.overlapX(t.r);if((s<=0||s<=o.r.overlapY(t.r))&&(t[n].insert(o),o[i].insert(t)),s<=0)break}};n("next","prev"),n("prev","next")}},d={getCentre:function(t){return t.cy()},getOpen:function(t){return t.x},getClose:function(t){return t.X},getSize:function(t){return t.height()},makeRect:function(t,e,n,i){return new o(t,e,n-i/2,n+i/2)},findNeighbours:function(t,e){var n=function(n,i){var o=e.findIter(t)[n]();null!==o&&o.r.overlapX(t.r)>0&&(t[n].insert(o),o[i].insert(t))};n("next","prev"),n("prev","next")}};function u(t,e,n,i){void 0===i&&(i=!1);var o=t.padding,r=void 0!==t.groups?t.groups.length:0,s=void 0!==t.leaves?t.leaves.length:0,a=r?t.groups.reduce((function(t,i){return t.concat(u(i,e,n,!0))}),[]):[],l=(i?2:0)+s+r,c=new Array(l),d=new Array(l),p=0,g=function(t,e){d[p]=t,c[p++]=e};if(i){var f=t.bounds,m=e.getCentre(f),_=e.getSize(f)/2,v=e.getOpen(f),y=e.getClose(f),b=m-_+o/2,E=m+_-o/2;t.minVar.desiredPosition=b,g(e.makeRect(v,y,b,o),t.minVar),t.maxVar.desiredPosition=E,g(e.makeRect(v,y,E,o),t.maxVar)}s&&t.leaves.forEach((function(t){return g(t.bounds,t.variable)})),r&&t.groups.forEach((function(t){var n=t.bounds;g(e.makeRect(e.getOpen(n),e.getClose(n),e.getCentre(n),e.getSize(n)),t.minVar)}));var T=h(d,c,e,n);return r&&(c.forEach((function(t){t.cOut=[],t.cIn=[]})),T.forEach((function(t){t.left.cOut.push(t),t.right.cIn.push(t)})),t.groups.forEach((function(t){var n=(t.padding-e.getSize(t.bounds))/2;t.minVar.cIn.forEach((function(t){return t.gap+=n})),t.minVar.cOut.forEach((function(e){e.left=t.maxVar,e.gap+=n}))}))),a.concat(T)}function h(t,e,n,i){var o,c=t.length,d=2*c;console.assert(e.length>=c);var u=new Array(d);for(o=0;o<c;++o){var h=t[o],p=new r(e[o],h,n.getCentre(h));u[o]=new s(!0,p,n.getOpen(h)),u[o+c]=new s(!1,p,n.getClose(h))}u.sort(a);var g=new Array,f=l();for(o=0;o<d;++o){var m=u[o];p=m.v;if(m.isOpen)f.insert(p),n.findNeighbours(p,f);else{f.remove(p);var _=function(t,e){var o=(n.getSize(t.r)+n.getSize(e.r))/2+i;g.push(new LS.Constraint(t.v,e.v,o))},v=function(t,e,n){for(var i,o=p[t].iterator();null!==(i=o[t]());)n(i,p),i[e].remove(p)};v("prev","next",(function(t,e){return _(t,e)})),v("next","prev",(function(t,e){return _(e,t)}))}}return console.assert(0===f.size),g}function p(t,e){return h(t,e,c,1e-6)}function g(t,e){return h(t,e,d,1e-6)}function f(t){return u(t,c,1e-6)}function m(t){return u(t,d,1e-6)}e.generateXConstraints=p,e.generateYConstraints=g,e.generateXGroupConstraints=f,e.generateYGroupConstraints=m,e.removeOverlaps=function(t){var e=t.map((function(t){return new LS.Variable(t.cx())})),n=p(t,e),i=new LS.Solver(e,n);i.solve(),e.forEach((function(e,n){return t[n].setXCentre(e.position())})),e=t.map((function(t){return new LS.Variable(t.cy())})),n=g(t,e),(i=new LS.Solver(e,n)).solve(),e.forEach((function(e,n){return t[n].setYCentre(e.position())}))};var _=function(t){function e(e,n){var i=t.call(this,0,n)||this;return i.index=e,i}return n(e,t),e}(LS.Variable);e.IndexedVariable=_;var v=function(){function t(t,e,n,r,s){var a=this;if(void 0===n&&(n=null),void 0===r&&(r=null),void 0===s&&(s=!1),this.nodes=t,this.groups=e,this.rootGroup=n,this.avoidOverlaps=s,this.variables=t.map((function(t,e){return t.variable=new _(e,1)})),r&&this.createConstraints(r),s&&n&&void 0!==n.groups){t.forEach((function(t){if(t.width&&t.height){var e=t.width/2,n=t.height/2;t.bounds=new o(t.x-e,t.x+e,t.y-n,t.y+n)}else t.bounds=new o(t.x,t.x,t.y,t.y)})),i(n);var l=t.length;e.forEach((function(t){a.variables[l]=t.minVar=new _(l++,void 0!==t.stiffness?t.stiffness:.01),a.variables[l]=t.maxVar=new _(l++,void 0!==t.stiffness?t.stiffness:.01)}))}}return t.prototype.createSeparation=function(t){return new LS.Constraint(this.nodes[t.left].variable,this.nodes[t.right].variable,t.gap,void 0!==t.equality&&t.equality)},t.prototype.makeFeasible=function(t){var e=this;if(this.avoidOverlaps){var n="x",i="width";"x"===t.axis&&(n="y",i="height");var o=t.offsets.map((function(t){return e.nodes[t.node]})).sort((function(t,e){return t[n]-e[n]})),r=null;o.forEach((function(t){if(r){var e=r[n]+r[i];e>t[n]&&(t[n]=e)}r=t}))}},t.prototype.createAlignment=function(t){var e=this,n=this.nodes[t.offsets[0].node].variable;this.makeFeasible(t);var i="x"===t.axis?this.xConstraints:this.yConstraints;t.offsets.slice(1).forEach((function(t){var o=e.nodes[t.node].variable;i.push(new LS.Constraint(n,o,t.offset,!0))}))},t.prototype.createConstraints=function(t){var e=this,n=function(t){return void 0===t.type||"separation"===t.type};this.xConstraints=t.filter((function(t){return"x"===t.axis&&n(t)})).map((function(t){return e.createSeparation(t)})),this.yConstraints=t.filter((function(t){return"y"===t.axis&&n(t)})).map((function(t){return e.createSeparation(t)})),t.filter((function(t){return"alignment"===t.type})).forEach((function(t){return e.createAlignment(t)}))},t.prototype.setupVariablesAndBounds=function(t,e,n,i){this.nodes.forEach((function(r,s){r.fixed?(r.variable.weight=r.fixedWeight?r.fixedWeight:1e3,n[s]=i(r)):r.variable.weight=1;var a=(r.width||0)/2,l=(r.height||0)/2,c=t[s],d=e[s];r.bounds=new o(c-a,c+a,d-l,d+l)}))},t.prototype.xProject=function(t,e,n){(this.rootGroup||this.avoidOverlaps||this.xConstraints)&&this.project(t,e,t,n,(function(t){return t.px}),this.xConstraints,f,(function(t){return t.bounds.setXCentre(n[t.variable.index]=t.variable.position())}),(function(t){var e=n[t.minVar.index]=t.minVar.position(),i=n[t.maxVar.index]=t.maxVar.position(),o=t.padding/2;t.bounds.x=e-o,t.bounds.X=i+o}))},t.prototype.yProject=function(t,e,n){(this.rootGroup||this.yConstraints)&&this.project(t,e,e,n,(function(t){return t.py}),this.yConstraints,m,(function(t){return t.bounds.setYCentre(n[t.variable.index]=t.variable.position())}),(function(t){var e=n[t.minVar.index]=t.minVar.position(),i=n[t.maxVar.index]=t.maxVar.position(),o=t.padding/2;t.bounds.y=e-o,t.bounds.Y=i+o}))},t.prototype.projectFunctions=function(){var t=this;return[function(e,n,i){return t.xProject(e,n,i)},function(e,n,i){return t.yProject(e,n,i)}]},t.prototype.project=function(t,e,n,o,r,s,a,l,c){this.setupVariablesAndBounds(t,e,o,r),this.rootGroup&&this.avoidOverlaps&&(i(this.rootGroup),s=s.concat(a(this.rootGroup))),this.solve(this.variables,s,n,o),this.nodes.forEach(l),this.rootGroup&&this.avoidOverlaps&&(this.groups.forEach(c),i(this.rootGroup))},t.prototype.solve=function(t,e,n,i){var o=new LS.Solver(t,e);o.setStartingPositions(n),o.setDesiredPositions(i),o.solve()},t}();e.Projection=v})),BS=r_((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t){this.elem=t,this.subheaps=[]}return t.prototype.toString=function(t){for(var e="",n=!1,i=0;i<this.subheaps.length;++i){var o=this.subheaps[i];o.elem?(n&&(e+=","),e+=o.toString(t),n=!0):n=!1}return""!==e&&(e="("+e+")"),(this.elem?t(this.elem):"")+e},t.prototype.forEach=function(t){this.empty()||(t(this.elem,this),this.subheaps.forEach((function(e){return e.forEach(t)})))},t.prototype.count=function(){return this.empty()?0:1+this.subheaps.reduce((function(t,e){return t+e.count()}),0)},t.prototype.min=function(){return this.elem},t.prototype.empty=function(){return null==this.elem},t.prototype.contains=function(t){if(this===t)return!0;for(var e=0;e<this.subheaps.length;e++)if(this.subheaps[e].contains(t))return!0;return!1},t.prototype.isHeap=function(t){var e=this;return this.subheaps.every((function(n){return t(e.elem,n.elem)&&n.isHeap(t)}))},t.prototype.insert=function(e,n){return this.merge(new t(e),n)},t.prototype.merge=function(t,e){return this.empty()?t:t.empty()?this:e(this.elem,t.elem)?(this.subheaps.push(t),this):(t.subheaps.push(this),t)},t.prototype.removeMin=function(t){return this.empty()?null:this.mergePairs(t)},t.prototype.mergePairs=function(e){if(0==this.subheaps.length)return new t(null);if(1==this.subheaps.length)return this.subheaps[0];var n=this.subheaps.pop().merge(this.subheaps.pop(),e),i=this.mergePairs(e);return n.merge(i,e)},t.prototype.decreaseKey=function(e,n,i,o){var r=e.removeMin(o);e.elem=r.elem,e.subheaps=r.subheaps,null!==i&&null!==r.elem&&i(e.elem,e);var s=new t(n);return null!==i&&i(n,s),this.merge(s,o)},t}();e.PairingHeap=n;var i=function(){function t(t){this.lessThan=t}return t.prototype.top=function(){return this.empty()?null:this.root.elem},t.prototype.push=function(){for(var t,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];for(var o,r=0;o=e[r];++r)t=new n(o),this.root=this.empty()?t:this.root.merge(t,this.lessThan);return t},t.prototype.empty=function(){return!this.root||!this.root.elem},t.prototype.isHeap=function(){return this.root.isHeap(this.lessThan)},t.prototype.forEach=function(t){this.root.forEach(t)},t.prototype.pop=function(){if(this.empty())return null;var t=this.root.min();return this.root=this.root.removeMin(this.lessThan),t},t.prototype.reduceKey=function(t,e,n){void 0===n&&(n=null),this.root=this.root.decreaseKey(t,e,n,this.lessThan)},t.prototype.toString=function(t){return this.root.toString(t)},t.prototype.count=function(){return this.root.count()},t}();e.PriorityQueue=i})),FS=r_((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(t,e){this.id=t,this.distance=e},i=function(t){this.id=t,this.neighbours=[]},o=function(t,e,n){this.node=t,this.prev=e,this.d=n},r=function(){function t(t,e,o,r,s){this.n=t,this.es=e,this.neighbours=new Array(this.n);for(var a=this.n;a--;)this.neighbours[a]=new i(a);for(a=this.es.length;a--;){var l=this.es[a],c=o(l),d=r(l),u=s(l);this.neighbours[c].neighbours.push(new n(d,u)),this.neighbours[d].neighbours.push(new n(c,u))}}return t.prototype.DistanceMatrix=function(){for(var t=new Array(this.n),e=0;e<this.n;++e)t[e]=this.dijkstraNeighbours(e);return t},t.prototype.DistancesFromNode=function(t){return this.dijkstraNeighbours(t)},t.prototype.PathFromNodeToNode=function(t,e){return this.dijkstraNeighbours(t,e)},t.prototype.PathFromNodeToNodeWithPrevCost=function(t,e,n){var i=new BS.PriorityQueue((function(t,e){return t.d<=e.d})),r=this.neighbours[t],s=new o(r,null,0),a={};for(i.push(s);!i.empty()&&(r=(s=i.pop()).node).id!==e;)for(var l=r.neighbours.length;l--;){var c=r.neighbours[l],d=this.neighbours[c.id];if(!s.prev||d.id!==s.prev.node.id){var u=d.id+","+r.id;if(!(u in a&&a[u]<=s.d)){var h=s.prev?n(s.prev.node.id,r.id,d.id):0,p=s.d+c.distance+h;a[u]=p,i.push(new o(d,s,p))}}}for(var g=[];s.prev;)s=s.prev,g.push(s.node.id);return g},t.prototype.dijkstraNeighbours=function(t,e){void 0===e&&(e=-1);for(var n=new BS.PriorityQueue((function(t,e){return t.d<=e.d})),i=this.neighbours.length,o=new Array(i);i--;){var r=this.neighbours[i];r.d=i===t?0:Number.POSITIVE_INFINITY,r.q=n.push(r)}for(;!n.empty();){var s=n.pop();if(o[s.id]=s.d,s.id===e){for(var a=[],l=s;void 0!==l.prev;)a.push(l.prev.id),l=l.prev;return a}for(i=s.neighbours.length;i--;){var c=s.neighbours[i],d=(l=this.neighbours[c.id],s.d+c.distance);s.d!==Number.MAX_VALUE&&l.d>d&&(l.d=d,l.prev=s,n.reduceKey(l.q,l,(function(t,e){return t.q=e})))}}return o},t}();e.Calculator=r})),HS=r_((function(t,e){var n=o_&&o_.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=function(){};e.Point=i;var o=function(t,e,n,i){this.x1=t,this.y1=e,this.x2=n,this.y2=i};e.LineSegment=o;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(i);function s(t,e,n){return(e.x-t.x)*(n.y-t.y)-(n.x-t.x)*(e.y-t.y)}function a(t,e,n){return s(t,e,n)>0}function l(t,e,n){return s(t,e,n)<0}function c(t,e){var n,i,o,r,s=e.length-1;if(l(t,e[1],e[0])&&!a(t,e[s-1],e[0]))return 0;for(n=0,i=s;;){if(i-n==1)return a(t,e[n],e[i])?n:i;if((r=l(t,e[(o=Math.floor((n+i)/2))+1],e[o]))&&!a(t,e[o-1],e[o]))return o;a(t,e[n+1],e[n])?r||a(t,e[n],e[o])?i=o:n=o:r&&l(t,e[n],e[o])?i=o:n=o}}function d(t,e){var n,i,o,r,s=e.length-1;if(a(t,e[s-1],e[0])&&!l(t,e[1],e[0]))return 0;for(n=0,i=s;;){if(i-n==1)return l(t,e[n],e[i])?n:i;if(r=l(t,e[(o=Math.floor((n+i)/2))+1],e[o]),a(t,e[o-1],e[o])&&!r)return o;l(t,e[n+1],e[n])?r?l(t,e[n],e[o])?i=o:n=o:i=o:r?n=o:a(t,e[n],e[o])?i=o:n=o}}function u(t,e,n,i,o,r){var s,a;a=i(t[s=n(e[0],t)],e);for(var l=!1;!l;){for(l=!0;s===t.length-1&&(s=0),!o(e[a],t[s],t[s+1]);)++s;for(;0===a&&(a=e.length-1),!r(t[s],e[a],e[a-1]);)--a,l=!1}return{t1:s,t2:a}}function h(t,e){return u(t,e,c,d,a,l)}e.PolyPoint=r,e.isLeft=s,e.ConvexHull=function(t){var e,n=t.slice(0).sort((function(t,e){return t.x!==e.x?e.x-t.x:e.y-t.y})),i=t.length,o=n[0].x;for(e=1;e<i&&n[e].x===o;++e);var r=e-1,a=[];if(a.push(n[0]),r===i-1)n[r].y!==n[0].y&&a.push(n[r]);else{var l,c=i-1,d=n[i-1].x;for(e=i-2;e>=0&&n[e].x===d;e--);for(l=e+1,e=r;++e<=l;)if(!(s(n[0],n[l],n[e])>=0&&e<l)){for(;a.length>1&&!(s(a[a.length-2],a[a.length-1],n[e])>0);)a.length-=1;0!=e&&a.push(n[e])}c!=l&&a.push(n[c]);var u=a.length;for(e=l;--e>=r;)if(!(s(n[c],n[r],n[e])>=0&&e>r)){for(;a.length>u&&!(s(a[a.length-2],a[a.length-1],n[e])>0);)a.length-=1;0!=e&&a.push(n[e])}}return a},e.clockwiseRadialSweep=function(t,e,n){e.slice(0).sort((function(e,n){return Math.atan2(e.y-t.y,e.x-t.x)-Math.atan2(n.y-t.y,n.x-t.x)})).forEach(n)},e.tangent_PolyPolyC=u,e.LRtangent_PolyPolyC=function(t,e){var n=h(e,t);return{t1:n.t2,t2:n.t1}},e.RLtangent_PolyPolyC=h,e.LLtangent_PolyPolyC=function(t,e){return u(t,e,d,d,l,l)},e.RRtangent_PolyPolyC=function(t,e){return u(t,e,c,c,a,a)};var p=function(t,e){this.t1=t,this.t2=e};e.BiTangent=p;var g=function(){};e.BiTangents=g;var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(i);e.TVGPoint=f;var m=function(t,e,n,i){this.id=t,this.polyid=e,this.polyvertid=n,this.p=i,i.vv=this};e.VisibilityVertex=m;var _=function(){function t(t,e){this.source=t,this.target=e}return t.prototype.length=function(){var t=this.source.p.x-this.target.p.x,e=this.source.p.y-this.target.p.y;return Math.sqrt(t*t+e*e)},t}();e.VisibilityEdge=_;var v=function(){function t(t,e){if(this.P=t,this.V=[],this.E=[],e)this.V=e.V.slice(0),this.E=e.E.slice(0);else{for(var n=t.length,i=0;i<n;i++){for(var o=t[i],r=0;r<o.length;++r){var s=o[r],a=new m(this.V.length,i,r,s);this.V.push(a),r>0&&this.E.push(new _(o[r-1].vv,a))}o.length>1&&this.E.push(new _(o[0].vv,o[o.length-1].vv))}for(i=0;i<n-1;i++){var l=t[i];for(r=i+1;r<n;r++){var c=t[r],d=b(l,c);for(var u in d){var h=d[u],p=l[h.t1],g=c[h.t2];this.addEdgeIfVisible(p,g,i,r)}}}}}return t.prototype.addEdgeIfVisible=function(t,e,n,i){this.intersectsPolys(new o(t.x,t.y,e.x,e.y),n,i)||this.E.push(new _(t.vv,e.vv))},t.prototype.addPoint=function(t,e){var n,i,o,r=this.P.length;this.V.push(new m(this.V.length,r,0,t));for(var s=0;s<r;++s)if(s!==e){var a=this.P[s],l=(n=t,o=void 0,(o=(i=a).slice(0)).push(i[0]),{rtan:c(n,o),ltan:d(n,o)});this.addEdgeIfVisible(t,a[l.ltan],e,s),this.addEdgeIfVisible(t,a[l.rtan],e,s)}return t.vv},t.prototype.intersectsPolys=function(t,e,n){for(var i=0,o=this.P.length;i<o;++i)if(i!=e&&i!=n&&y(t,this.P[i]).length>0)return!0;return!1},t}();function y(t,e){for(var n=[],i=1,o=e.length;i<o;++i){var r=MS.Rectangle.lineIntersection(t.x1,t.y1,t.x2,t.y2,e[i-1].x,e[i-1].y,e[i].x,e[i].y);r&&n.push(r)}return n}function b(t,e){for(var n=t.length-1,i=e.length-1,o=new g,r=0;r<n;++r)for(var a=0;a<i;++a){var l=t[0==r?n-1:r-1],c=t[r],d=t[r+1],u=e[0==a?i-1:a-1],h=e[a],f=e[a+1],m=s(l,c,h),_=s(c,u,h),v=s(c,h,f),y=s(u,h,c),b=s(h,l,c),E=s(h,c,d);m>=0&&_>=0&&v<0&&y>=0&&b>=0&&E<0?o.ll=new p(r,a):m<=0&&_<=0&&v>0&&y<=0&&b<=0&&E>0?o.rr=new p(r,a):m<=0&&_>0&&v<=0&&y>=0&&b<0&&E>=0?o.rl=new p(r,a):m>=0&&_<0&&v>=0&&y<=0&&b>0&&E<=0&&(o.lr=new p(r,a))}return o}function E(t,e){return!t.every((function(t){return!function(t,e){for(var n=1,i=e.length;n<i;++n)if(l(e[n-1],e[n],t))return!1;return!0}(t,e)}))}e.TangentVisibilityGraph=v,e.tangents=b,e.polysOverlap=function(t,e){if(E(t,e))return!0;if(E(e,t))return!0;for(var n=1,i=t.length;n<i;++n){var r=t[n],s=t[n-1];if(y(new o(s.x,s.y,r.x,r.y),e).length>0)return!0}return!1}})),US=r_((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=10,i=(1+Math.sqrt(5))/2,o=1e-4;e.applyPacking=function(t,e,r,s,a,l){void 0===a&&(a=1),void 0===l&&(l=!0);var c=e,d=r,u=(a=void 0!==a?a:1,s=void 0!==s?s:0,0),h=0,p=0,g=0,f=[];function m(t,e){f=[],u=0,h=0,g=0;for(var n=0;n<t.length;n++){_(t[n],e)}return Math.abs(u/h-a)}function _(t,e){for(var i=void 0,r=0;r<f.length;r++)if(f[r].space_left>=t.height&&f[r].x+f[r].width+t.width+n-e<=o){i=f[r];break}f.push(t),void 0!==i?(t.x=i.x+i.width+n,t.y=i.bottom,t.space_left=t.height,t.bottom=t.y,i.space_left-=t.height+n,i.bottom+=t.height+n):(t.y=g,g+=t.height+n,t.x=0,t.bottom=t.y,t.space_left=t.height),t.y+t.height-h>-o&&(h=t.y+t.height-0),t.x+t.width-u>-o&&(u=t.x+t.width-0)}0!=t.length&&(function(t){t.forEach((function(t){!function(t){var e=Number.MAX_VALUE,n=Number.MAX_VALUE,i=0,o=0;t.array.forEach((function(t){var r=void 0!==t.width?t.width:s,a=void 0!==t.height?t.height:s;r/=2,a/=2,i=Math.max(t.x+r,i),e=Math.min(t.x-r,e),o=Math.max(t.y+a,o),n=Math.min(t.y-a,n)})),t.width=i-e,t.height=o-n}(t)}))}(t),function(t,e){var r=Number.POSITIVE_INFINITY,s=0;t.sort((function(t,e){return e.height-t.height})),p=t.reduce((function(t,e){return t.width<e.width?t.width:e.width}));var a=_=p,l=v=function(t){var e=0;return t.forEach((function(t){return e+=t.width+n})),e}(t),c=0,d=Number.MAX_VALUE,u=Number.MAX_VALUE,h=-1,g=Number.MAX_VALUE,f=Number.MAX_VALUE;for(;g>p||f>o;){if(1!=h){var _=l-(l-a)/i;d=m(t,_)}if(0!=h){var v=a+(l-a)/i;u=m(t,v)}if(g=Math.abs(_-v),f=Math.abs(d-u),d<r&&(r=d,s=_),u<r&&(r=u,s=v),d>u?(a=_,_=v,d=u,h=1):(l=v,v=_,u=d,h=0),c++>100)break}m(t,s)}(t),l&&function(t){t.forEach((function(t){var e={x:0,y:0};t.array.forEach((function(t){e.x+=t.x,e.y+=t.y})),e.x/=t.array.length,e.y/=t.array.length;var n={x:e.x-t.width/2,y:e.y-t.height/2},i={x:t.x-n.x+c/2-u/2,y:t.y-n.y+d/2-h/2};t.array.forEach((function(t){t.x+=i.x,t.y+=i.y}))}))}(t))},e.separateGraphs=function(t,e){for(var n={},i={},o=[],r=0,s=0;s<e.length;s++){var a=e[s],l=a.source,c=a.target;i[l.index]?i[l.index].push(c):i[l.index]=[c],i[c.index]?i[c.index].push(l):i[c.index]=[l]}for(s=0;s<t.length;s++){var d=t[s];n[d.index]||u(d,!0)}function u(t,e){if(void 0===n[t.index]){e&&(r++,o.push({array:[]})),n[t.index]=r,o[r-1].array.push(t);var s=i[t.index];if(s)for(var a=0;a<s.length;a++)u(s[a],!1)}}return o}})),VS=r_((function(t,e){var n;function i(t){return void 0!==t.leaves||void 0!==t.groups}Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.start=0]="start",t[t.tick=1]="tick",t[t.end=2]="end"}(n=e.EventType||(e.EventType={}));var o=function(){function t(){var e=this;this._canvasSize=[1,1],this._linkDistance=20,this._defaultNodeSize=10,this._linkLengthCalculator=null,this._linkType=null,this._avoidOverlaps=!1,this._handleDisconnected=!0,this._running=!1,this._nodes=[],this._groups=[],this._rootGroup=null,this._links=[],this._constraints=[],this._distanceMatrix=null,this._descent=null,this._directedLinkConstraints=null,this._threshold=.01,this._visibilityGraph=null,this._groupCompactness=1e-6,this.event=null,this.linkAccessor={getSourceIndex:t.getSourceIndex,getTargetIndex:t.getTargetIndex,setLength:t.setLinkLength,getType:function(t){return"function"==typeof e._linkType?e._linkType(t):0}}}return t.prototype.on=function(t,e){return this.event||(this.event={}),"string"==typeof t?this.event[n[t]]=e:this.event[t]=e,this},t.prototype.trigger=function(t){this.event&&void 0!==this.event[t.type]&&this.event[t.type](t)},t.prototype.kick=function(){for(;!this.tick(););},t.prototype.tick=function(){if(this._alpha<this._threshold)return this._running=!1,this.trigger({type:n.end,alpha:this._alpha=0,stress:this._lastStress}),!0;var t,e,i=this._nodes.length;for(this._links.length,this._descent.locks.clear(),e=0;e<i;++e)if((t=this._nodes[e]).fixed){void 0!==t.px&&void 0!==t.py||(t.px=t.x,t.py=t.y);var o=[t.px,t.py];this._descent.locks.add(e,o)}var r=this._descent.rungeKutta();return 0===r?this._alpha=0:void 0!==this._lastStress&&(this._alpha=r),this._lastStress=r,this.updateNodePositions(),this.trigger({type:n.tick,alpha:this._alpha,stress:this._lastStress}),!1},t.prototype.updateNodePositions=function(){for(var t,e=this._descent.x[0],n=this._descent.x[1],i=this._nodes.length;i--;)(t=this._nodes[i]).x=e[i],t.y=n[i]},t.prototype.nodes=function(t){if(!t){if(0===this._nodes.length&&this._links.length>0){var e=0;this._links.forEach((function(t){e=Math.max(e,t.source,t.target)})),this._nodes=new Array(++e);for(var n=0;n<e;++n)this._nodes[n]={}}return this._nodes}return this._nodes=t,this},t.prototype.groups=function(t){var e=this;return t?(this._groups=t,this._rootGroup={},this._groups.forEach((function(t){void 0===t.padding&&(t.padding=1),void 0!==t.leaves&&t.leaves.forEach((function(n,i){"number"==typeof n&&((t.leaves[i]=e._nodes[n]).parent=t)})),void 0!==t.groups&&t.groups.forEach((function(n,i){"number"==typeof n&&((t.groups[i]=e._groups[n]).parent=t)}))})),this._rootGroup.leaves=this._nodes.filter((function(t){return void 0===t.parent})),this._rootGroup.groups=this._groups.filter((function(t){return void 0===t.parent})),this):this._groups},t.prototype.powerGraphGroups=function(t){var e=AS.getGroups(this._nodes,this._links,this.linkAccessor,this._rootGroup);return this.groups(e.groups),t(e),this},t.prototype.avoidOverlaps=function(t){return arguments.length?(this._avoidOverlaps=t,this):this._avoidOverlaps},t.prototype.handleDisconnected=function(t){return arguments.length?(this._handleDisconnected=t,this):this._handleDisconnected},t.prototype.flowLayout=function(t,e){return arguments.length||(t="y"),this._directedLinkConstraints={axis:t,getMinSeparation:"number"==typeof e?function(){return e}:e},this},t.prototype.links=function(t){return arguments.length?(this._links=t,this):this._links},t.prototype.constraints=function(t){return arguments.length?(this._constraints=t,this):this._constraints},t.prototype.distanceMatrix=function(t){return arguments.length?(this._distanceMatrix=t,this):this._distanceMatrix},t.prototype.size=function(t){return t?(this._canvasSize=t,this):this._canvasSize},t.prototype.defaultNodeSize=function(t){return t?(this._defaultNodeSize=t,this):this._defaultNodeSize},t.prototype.groupCompactness=function(t){return t?(this._groupCompactness=t,this):this._groupCompactness},t.prototype.linkDistance=function(t){return t?(this._linkDistance="function"==typeof t?t:+t,this._linkLengthCalculator=null,this):this._linkDistance},t.prototype.linkType=function(t){return this._linkType=t,this},t.prototype.convergenceThreshold=function(t){return t?(this._threshold="function"==typeof t?t:+t,this):this._threshold},t.prototype.alpha=function(t){return arguments.length?(t=+t,this._alpha?this._alpha=t>0?t:0:t>0&&(this._running||(this._running=!0,this.trigger({type:n.start,alpha:this._alpha=t}),this.kick())),this):this._alpha},t.prototype.getLinkLength=function(t){return"function"==typeof this._linkDistance?+this._linkDistance(t):this._linkDistance},t.setLinkLength=function(t,e){t.length=e},t.prototype.getLinkType=function(t){return"function"==typeof this._linkType?this._linkType(t):0},t.prototype.symmetricDiffLinkLengths=function(t,e){var n=this;return void 0===e&&(e=1),this.linkDistance((function(e){return t*e.length})),this._linkLengthCalculator=function(){return DS.symmetricDiffLinkLengths(n._links,n.linkAccessor,e)},this},t.prototype.jaccardLinkLengths=function(t,e){var n=this;return void 0===e&&(e=1),this.linkDistance((function(e){return t*e.length})),this._linkLengthCalculator=function(){return DS.jaccardLinkLengths(n._links,n.linkAccessor,e)},this},t.prototype.start=function(e,n,i,o,r,s){var a=this;void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===r&&(r=!0),void 0===s&&(s=!0);var l=this.nodes().length,c=l+2*this._groups.length;this._links.length;var d,u=this._canvasSize[0],h=this._canvasSize[1],p=new Array(c),g=new Array(c),f=null,m=this._avoidOverlaps;this._nodes.forEach((function(t,e){t.index=e,void 0===t.x&&(t.x=u/2,t.y=h/2),p[e]=t.x,g[e]=t.y})),this._linkLengthCalculator&&this._linkLengthCalculator(),this._distanceMatrix?d=this._distanceMatrix:(d=new FS.Calculator(c,this._links,t.getSourceIndex,t.getTargetIndex,(function(t){return a.getLinkLength(t)})).DistanceMatrix(),f=NS.Descent.createSquareMatrix(c,(function(){return 2})),this._links.forEach((function(t){"number"==typeof t.source&&(t.source=a._nodes[t.source]),"number"==typeof t.target&&(t.target=a._nodes[t.target])})),this._links.forEach((function(e){var n=t.getSourceIndex(e),i=t.getTargetIndex(e);f[n][i]=f[i][n]=e.weight||1})));var _=NS.Descent.createSquareMatrix(c,(function(t,e){return d[t][e]}));if(this._rootGroup&&void 0!==this._rootGroup.groups){var v=l;this._groups.forEach((function(t){!function(t,e,n,i){f[t][e]=f[e][t]=n,_[t][e]=_[e][t]=i}(v,v+1,a._groupCompactness,.1),p[v]=0,g[v++]=0,p[v]=0,g[v++]=0}))}else this._rootGroup={leaves:this._nodes,groups:[]};var y=this._constraints||[];this._directedLinkConstraints&&(this.linkAccessor.getMinSeparation=this._directedLinkConstraints.getMinSeparation,y=y.concat(DS.generateDirectedEdgeConstraints(l,this._links,this._directedLinkConstraints.axis,this.linkAccessor))),this.avoidOverlaps(!1),this._descent=new NS.Descent([p,g],_),this._descent.locks.clear();for(v=0;v<l;++v){var b=this._nodes[v];if(b.fixed){b.px=b.x,b.py=b.y;var E=[b.x,b.y];this._descent.locks.add(v,E)}}if(this._descent.threshold=this._threshold,this.initialLayout(e,p,g),y.length>0&&(this._descent.project=new MS.Projection(this._nodes,this._groups,this._rootGroup,y).projectFunctions()),this._descent.run(n),this.separateOverlappingComponents(u,h,s),this.avoidOverlaps(m),m&&(this._nodes.forEach((function(t,e){t.x=p[e],t.y=g[e]})),this._descent.project=new MS.Projection(this._nodes,this._groups,this._rootGroup,y,!0).projectFunctions(),this._nodes.forEach((function(t,e){p[e]=t.x,g[e]=t.y}))),this._descent.G=f,this._descent.run(i),o){this._descent.snapStrength=1e3,this._descent.snapGridSize=this._nodes[0].width,this._descent.numGridSnapNodes=l,this._descent.scaleSnapByMaxH=l!=c;var T=NS.Descent.createSquareMatrix(c,(function(t,e){return t>=l||e>=l?f[t][e]:0}));this._descent.G=T,this._descent.run(o)}return this.updateNodePositions(),this.separateOverlappingComponents(u,h,s),r?this.resume():this},t.prototype.initialLayout=function(e,n,i){if(this._groups.length>0&&e>0){var o=this._nodes.length,r=this._links.map((function(t){return{source:t.source.index,target:t.target.index}})),s=this._nodes.map((function(t){return{index:t.index}}));this._groups.forEach((function(t,e){s.push({index:t.index=o+e})})),this._groups.forEach((function(t,e){void 0!==t.leaves&&t.leaves.forEach((function(e){return r.push({source:t.index,target:e.index})})),void 0!==t.groups&&t.groups.forEach((function(e){return r.push({source:t.index,target:e.index})}))})),(new t).size(this.size()).nodes(s).links(r).avoidOverlaps(!1).linkDistance(this.linkDistance()).symmetricDiffLinkLengths(5).convergenceThreshold(1e-4).start(e,0,0,0,!1),this._nodes.forEach((function(t){n[t.index]=s[t.index].x,i[t.index]=s[t.index].y}))}else this._descent.run(e)},t.prototype.separateOverlappingComponents=function(t,e,n){var i=this;if(void 0===n&&(n=!0),!this._distanceMatrix&&this._handleDisconnected){var o=this._descent.x[0],r=this._descent.x[1];this._nodes.forEach((function(t,e){t.x=o[e],t.y=r[e]}));var s=US.separateGraphs(this._nodes,this._links);US.applyPacking(s,t,e,this._defaultNodeSize,1,n),this._nodes.forEach((function(t,e){i._descent.x[0][e]=t.x,i._descent.x[1][e]=t.y,t.bounds&&(t.bounds.setXCentre(t.x),t.bounds.setYCentre(t.y))}))}},t.prototype.resume=function(){return this.alpha(.1)},t.prototype.stop=function(){return this.alpha(0)},t.prototype.prepareEdgeRouting=function(t){void 0===t&&(t=0),this._visibilityGraph=new HS.TangentVisibilityGraph(this._nodes.map((function(e){return e.bounds.inflate(-t).vertices()})))},t.prototype.routeEdge=function(t,e,n){void 0===e&&(e=5);var i=[],o=new HS.TangentVisibilityGraph(this._visibilityGraph.P,{V:this._visibilityGraph.V,E:this._visibilityGraph.E}),r={x:t.source.x,y:t.source.y},s={x:t.target.x,y:t.target.y},a=o.addPoint(r,t.source.index),l=o.addPoint(s,t.target.index);o.addEdgeIfVisible(r,s,t.source.index,t.target.index),void 0!==n&&n(o);var c=new FS.Calculator(o.V.length,o.E,(function(t){return t.source.id}),(function(t){return t.target.id}),(function(t){return t.length()})).PathFromNodeToNode(a.id,l.id);if(1===c.length||c.length===o.V.length){var d=MS.makeEdgeBetween(t.source.innerBounds,t.target.innerBounds,e);i=[d.sourceIntersection,d.arrowStart]}else{for(var u=c.length-2,h=o.V[c[u]].p,p=o.V[c[0]].p,g=(i=[t.source.innerBounds.rayIntersection(h.x,h.y)],u);g>=0;--g)i.push(o.V[c[g]].p);i.push(MS.makeEdgeTo(p,t.target.innerBounds,e))}return i},t.getSourceIndex=function(t){return"number"==typeof t.source?t.source:t.source.index},t.getTargetIndex=function(t){return"number"==typeof t.target?t.target:t.target.index},t.linkId=function(e){return t.getSourceIndex(e)+"-"+t.getTargetIndex(e)},t.dragStart=function(e){i(e)?t.storeOffset(e,t.dragOrigin(e)):(t.stopNode(e),e.fixed|=2)},t.stopNode=function(t){t.px=t.x,t.py=t.y},t.storeOffset=function(e,n){void 0!==e.leaves&&e.leaves.forEach((function(e){e.fixed|=2,t.stopNode(e),e._dragGroupOffsetX=e.x-n.x,e._dragGroupOffsetY=e.y-n.y})),void 0!==e.groups&&e.groups.forEach((function(e){return t.storeOffset(e,n)}))},t.dragOrigin=function(t){return i(t)?{x:t.bounds.cx(),y:t.bounds.cy()}:t},t.drag=function(e,n){i(e)?(void 0!==e.leaves&&e.leaves.forEach((function(t){e.bounds.setXCentre(n.x),e.bounds.setYCentre(n.y),t.px=t._dragGroupOffsetX+n.x,t.py=t._dragGroupOffsetY+n.y})),void 0!==e.groups&&e.groups.forEach((function(e){return t.drag(e,n)}))):(e.px=n.x,e.py=n.y)},t.dragEnd=function(e){i(e)?(void 0!==e.leaves&&e.leaves.forEach((function(e){t.dragEnd(e),delete e._dragGroupOffsetX,delete e._dragGroupOffsetY})),void 0!==e.groups&&e.groups.forEach(t.dragEnd)):e.fixed&=-7},t.mouseOver=function(t){t.fixed|=4,t.px=t.x,t.py=t.y},t.mouseOut=function(t){t.fixed&=-5},t}();e.Layout=o})),GS=r_((function(t,e){var n=o_&&o_.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(e){var n=t.call(this)||this,i=e;return i.trigger&&(n.trigger=i.trigger),i.kick&&(n.kick=i.kick),i.drag&&(n.drag=i.drag),i.on&&(n.on=i.on),n.dragstart=n.dragStart=VS.Layout.dragStart,n.dragend=n.dragEnd=VS.Layout.dragEnd,n}return n(e,t),e.prototype.trigger=function(t){},e.prototype.kick=function(){},e.prototype.drag=function(){},e.prototype.on=function(t,e){return this},e}(VS.Layout);e.LayoutAdaptor=i,e.adaptor=function(t){return new i(t)}})),WS=r_((function(t,e){var n=o_&&o_.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(){var e=t.call(this)||this;e.event=d3.dispatch(VS.EventType[VS.EventType.start],VS.EventType[VS.EventType.tick],VS.EventType[VS.EventType.end]);var n=e;return e.drag=function(){if(!t)var t=d3.behavior.drag().origin(VS.Layout.dragOrigin).on("dragstart.d3adaptor",VS.Layout.dragStart).on("drag.d3adaptor",(function(t){VS.Layout.drag(t,d3.event),n.resume()})).on("dragend.d3adaptor",VS.Layout.dragEnd);if(!arguments.length)return t;this.call(t)},e}return n(e,t),e.prototype.trigger=function(t){var e={type:VS.EventType[t.type],alpha:t.alpha,stress:t.stress};this.event[e.type](e)},e.prototype.kick=function(){var e=this;d3.timer((function(){return t.prototype.tick.call(e)}))},e.prototype.on=function(t,e){return"string"==typeof t?this.event.on(t,e):this.event.on(VS.EventType[t],e),this},e}(VS.Layout);e.D3StyleLayoutAdaptor=i,e.d3adaptor=function(){return new i}})),zS=r_((function(t,e){var n=o_&&o_.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(e){var n=t.call(this)||this;n.d3Context=e,n.event=e.dispatch(VS.EventType[VS.EventType.start],VS.EventType[VS.EventType.tick],VS.EventType[VS.EventType.end]);var i=n;return n.drag=function(){if(!t)var t=e.drag().subject(VS.Layout.dragOrigin).on("start.d3adaptor",VS.Layout.dragStart).on("drag.d3adaptor",(function(t){VS.Layout.drag(t,e.event),i.resume()})).on("end.d3adaptor",VS.Layout.dragEnd);if(!arguments.length)return t;arguments[0].call(t)},n}return n(e,t),e.prototype.trigger=function(t){var e={type:VS.EventType[t.type],alpha:t.alpha,stress:t.stress};this.event.call(e.type,e)},e.prototype.kick=function(){var e=this,n=this.d3Context.timer((function(){return t.prototype.tick.call(e)&&n.stop()}))},e.prototype.on=function(t,e){return"string"==typeof t?this.event.on(t,e):this.event.on(VS.EventType[t],e),this},e}(VS.Layout);e.D3StyleLayoutAdaptor=i})),XS=r_((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.d3adaptor=function(t){return!t||function(t){var e=/^3\./;return t.version&&null!==t.version.match(e)}(t)?new WS.D3StyleLayoutAdaptor:new zS.D3StyleLayoutAdaptor(t)}})),jS=r_((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(t,e,n){this.id=t,this.rect=e,this.children=n,this.leaf=void 0===n||0===n.length};e.NodeWrapper=n;var i=function(t,e,n,i,o){void 0===i&&(i=null),void 0===o&&(o=null),this.id=t,this.x=e,this.y=n,this.node=i,this.line=o};e.Vert=i;var o=function(){function t(e,n){this.s=e,this.t=n;var i=t.findMatch(e,n),o=n.slice(0).reverse(),r=t.findMatch(e,o);i.length>=r.length?(this.length=i.length,this.si=i.si,this.ti=i.ti,this.reversed=!1):(this.length=r.length,this.si=r.si,this.ti=n.length-r.ti-r.length,this.reversed=!0)}return t.findMatch=function(t,e){for(var n=t.length,i=e.length,o={length:0,si:-1,ti:-1},r=new Array(n),s=0;s<n;s++){r[s]=new Array(i);for(var a=0;a<i;a++)if(t[s]===e[a]){var l=r[s][a]=0===s||0===a?1:r[s-1][a-1]+1;l>o.length&&(o.length=l,o.si=s-l+1,o.ti=a-l+1)}else r[s][a]=0}return o},t.prototype.getSequence=function(){return this.length>=0?this.s.slice(this.si,this.si+this.length):[]},t}();e.LongestCommonSubsequence=o;var r=function(){function t(t,e,o){var r=this;void 0===o&&(o=12),this.originalnodes=t,this.groupPadding=o,this.leaves=null,this.nodes=t.map((function(t,i){return new n(i,e.getBounds(t),e.getChildren(t))})),this.leaves=this.nodes.filter((function(t){return t.leaf})),this.groups=this.nodes.filter((function(t){return!t.leaf})),this.cols=this.getGridLines("x"),this.rows=this.getGridLines("y"),this.groups.forEach((function(t){return t.children.forEach((function(e){return r.nodes[e].parent=t}))})),this.root={children:[]},this.nodes.forEach((function(t){void 0===t.parent&&(t.parent=r.root,r.root.children.push(t.id)),t.ports=[]})),this.backToFront=this.nodes.slice(0),this.backToFront.sort((function(t,e){return r.getDepth(t)-r.getDepth(e)})),this.backToFront.slice(0).reverse().filter((function(t){return!t.leaf})).forEach((function(t){var e=MS.Rectangle.empty();t.children.forEach((function(t){return e=e.union(r.nodes[t].rect)})),t.rect=e.inflate(r.groupPadding)}));var s=this.midPoints(this.cols.map((function(t){return t.pos}))),a=this.midPoints(this.rows.map((function(t){return t.pos}))),l=s[0],c=s[s.length-1],d=a[0],u=a[a.length-1],h=this.rows.map((function(t){return{x1:l,x2:c,y1:t.pos,y2:t.pos}})).concat(a.map((function(t){return{x1:l,x2:c,y1:t,y2:t}}))),p=this.cols.map((function(t){return{x1:t.pos,x2:t.pos,y1:d,y2:u}})).concat(s.map((function(t){return{x1:t,x2:t,y1:d,y2:u}}))),g=h.concat(p);g.forEach((function(t){return t.verts=[]})),this.verts=[],this.edges=[],h.forEach((function(t){return p.forEach((function(e){var n=new i(r.verts.length,e.x1,t.y1);t.verts.push(n),e.verts.push(n),r.verts.push(n);for(var o=r.backToFront.length;o-- >0;){var s=r.backToFront[o],a=s.rect,l=Math.abs(n.x-a.cx()),c=Math.abs(n.y-a.cy());if(l<a.width()/2&&c<a.height()/2){n.node=s;break}}}))})),g.forEach((function(t,e){r.nodes.forEach((function(e,n){e.rect.lineIntersections(t.x1,t.y1,t.x2,t.y2).forEach((function(n,o){var s=new i(r.verts.length,n.x,n.y,e,t);r.verts.push(s),t.verts.push(s),e.ports.push(s)}))}));var n=Math.abs(t.y1-t.y2)<.1,o=function(t,e){return n?e.x-t.x:e.y-t.y};t.verts.sort(o);for(var s=1;s<t.verts.length;s++){var a=t.verts[s-1],l=t.verts[s];a.node&&a.node===l.node&&a.node.leaf||r.edges.push({source:a.id,target:l.id,length:Math.abs(o(a,l))})}}))}return t.prototype.avg=function(t){return t.reduce((function(t,e){return t+e}))/t.length},t.prototype.getGridLines=function(t){for(var e=[],n=this.leaves.slice(0,this.leaves.length);n.length>0;){var i=n.filter((function(e){return e.rect["overlap"+t.toUpperCase()](n[0].rect)})),o={nodes:i,pos:this.avg(i.map((function(e){return e.rect["c"+t]()})))};e.push(o),o.nodes.forEach((function(t){return n.splice(n.indexOf(t),1)}))}return e.sort((function(t,e){return t.pos-e.pos})),e},t.prototype.getDepth=function(t){for(var e=0;t.parent!==this.root;)e++,t=t.parent;return e},t.prototype.midPoints=function(t){for(var e=t[1]-t[0],n=[t[0]-e/2],i=1;i<t.length;i++)n.push((t[i]+t[i-1])/2);return n.push(t[t.length-1]+e/2),n},t.prototype.findLineage=function(t){var e=[t];do{t=t.parent,e.push(t)}while(t!==this.root);return e.reverse()},t.prototype.findAncestorPathBetween=function(t,e){for(var n=this.findLineage(t),i=this.findLineage(e),o=0;n[o]===i[o];)o++;return{commonAncestor:n[o-1],lineages:n.slice(o).concat(i.slice(o))}},t.prototype.siblingObstacles=function(t,e){var n=this,i=this.findAncestorPathBetween(t,e),o={};i.lineages.forEach((function(t){return o[t.id]={}}));var r=i.commonAncestor.children.filter((function(t){return!(t in o)}));return i.lineages.filter((function(t){return t.parent!==i.commonAncestor})).forEach((function(t){return r=r.concat(t.parent.children.filter((function(e){return e!==t.id})))})),r.map((function(t){return n.nodes[t]}))},t.getSegmentSets=function(t,e,n){for(var i=[],o=0;o<t.length;o++)for(var r=t[o],s=0;s<r.length;s++){(u=r[s]).edgeid=o,u.i=s;var a=u[1][e]-u[0][e];Math.abs(a)<.1&&i.push(u)}i.sort((function(t,n){return t[0][e]-n[0][e]}));for(var l=[],c=null,d=0;d<i.length;d++){var u=i[d];(!c||Math.abs(u[0][e]-c.pos)>.1)&&(c={pos:u[0][e],segments:[]},l.push(c)),c.segments.push(u)}return l},t.nudgeSegs=function(t,e,n,i,o,r){var s=i.length;if(!(s<=1)){for(var a=i.map((function(e){return new LS.Variable(e[0][t])})),l=[],c=0;c<s;c++)for(var d=0;d<s;d++)if(c!==d){var u=i[c],h=i[d],p=u.edgeid,g=h.edgeid,f=-1,m=-1;"x"==t?o(p,g)&&(u[0][e]<u[1][e]?(f=d,m=c):(f=c,m=d)):o(p,g)&&(u[0][e]<u[1][e]?(f=c,m=d):(f=d,m=c)),f>=0&&l.push(new LS.Constraint(a[f],a[m],r))}new LS.Solver(a,l).solve(),a.forEach((function(e,o){var r=i[o],s=e.position();r[0][t]=r[1][t]=s;var a=n[r.edgeid];r.i>0&&(a[r.i-1][1][t]=s),r.i<a.length-1&&(a[r.i+1][0][t]=s)}))}},t.nudgeSegments=function(e,n,i,o,r){for(var s=t.getSegmentSets(e,n,i),a=0;a<s.length;a++){for(var l=s[a],c=[],d=0;d<l.segments.length;d++){var u=l.segments[d];c.push({type:0,s:u,pos:Math.min(u[0][i],u[1][i])}),c.push({type:1,s:u,pos:Math.max(u[0][i],u[1][i])})}c.sort((function(t,e){return t.pos-e.pos+t.type-e.type}));var h=[],p=0;c.forEach((function(s){0===s.type?(h.push(s.s),p++):p--,0==p&&(t.nudgeSegs(n,i,e,h,o,r),h=[])}))}},t.prototype.routeEdges=function(e,n,i,o){var r=this,s=e.map((function(t){return r.route(i(t),o(t))})),a=t.orderEdges(s),l=s.map((function(e){return t.makeSegments(e)}));return t.nudgeSegments(l,"x","y",a,n),t.nudgeSegments(l,"y","x",a,n),t.unreverseEdges(l,s),l},t.unreverseEdges=function(t,e){t.forEach((function(t,n){e[n].reversed&&(t.reverse(),t.forEach((function(t){t.reverse()})))}))},t.angleBetween2Lines=function(t,e){var n=Math.atan2(t[0].y-t[1].y,t[0].x-t[1].x),i=Math.atan2(e[0].y-e[1].y,e[0].x-e[1].x),o=n-i;return(o>Math.PI||o<-Math.PI)&&(o=i-n),o},t.isLeft=function(t,e,n){return(e.x-t.x)*(n.y-t.y)-(e.y-t.y)*(n.x-t.x)<=0},t.getOrder=function(t){for(var e={},n=0;n<t.length;n++){var i=t[n];void 0===e[i.l]&&(e[i.l]={}),e[i.l][i.r]=!0}return function(t,n){return void 0!==e[t]&&e[t][n]}},t.orderEdges=function(e){for(var n=[],i=0;i<e.length-1;i++)for(var r=i+1;r<e.length;r++){var s,a,l,c=e[i],d=e[r],u=new o(c,d);0!==u.length&&(u.reversed&&(d.reverse(),d.reversed=!0,u=new o(c,d)),(u.si<=0||u.ti<=0)&&(u.si+u.length>=c.length||u.ti+u.length>=d.length)?n.push({l:i,r:r}):(u.si+u.length>=c.length||u.ti+u.length>=d.length?(s=c[u.si+1],l=c[u.si-1],a=d[u.ti-1]):(s=c[u.si+u.length-2],a=c[u.si+u.length],l=d[u.ti+u.length]),t.isLeft(s,a,l)?n.push({l:r,r:i}):n.push({l:i,r:r})))}return t.getOrder(n)},t.makeSegments=function(t){function e(t){return{x:t.x,y:t.y}}for(var n=function(t,e,n){return Math.abs((e.x-t.x)*(n.y-t.y)-(e.y-t.y)*(n.x-t.x))<.001},i=[],o=e(t[0]),r=1;r<t.length;r++){var s=e(t[r]),a=r<t.length-1?t[r+1]:null;a&&n(o,s,a)||(i.push([o,s]),o=s)}return i},t.prototype.route=function(t,e){var n=this,i=this.nodes[t],o=this.nodes[e];this.obstacles=this.siblingObstacles(i,o);var r={};this.obstacles.forEach((function(t){return r[t.id]=t})),this.passableEdges=this.edges.filter((function(t){var e=n.verts[t.source],i=n.verts[t.target];return!(e.node&&e.node.id in r||i.node&&i.node.id in r)}));for(var s=1;s<i.ports.length;s++){var a=i.ports[0].id,l=i.ports[s].id;this.passableEdges.push({source:a,target:l,length:0})}for(s=1;s<o.ports.length;s++){a=o.ports[0].id,l=o.ports[s].id;this.passableEdges.push({source:a,target:l,length:0})}var c=new FS.Calculator(this.verts.length,this.passableEdges,(function(t){return t.source}),(function(t){return t.target}),(function(t){return t.length})).PathFromNodeToNodeWithPrevCost(i.ports[0].id,o.ports[0].id,(function(t,e,r){var s=n.verts[t],a=n.verts[e],l=n.verts[r],c=Math.abs(l.x-s.x),d=Math.abs(l.y-s.y);return s.node===i&&s.node===a.node||a.node===o&&a.node===l.node?0:c>1&&d>1?1e3:0})).reverse().map((function(t){return n.verts[t]}));return c.push(this.nodes[o.id].ports[0]),c.filter((function(t,e){return!(e<c.length-1&&c[e+1].node===i&&t.node===i||e>0&&t.node===o&&c[e-1].node===o)}))},t.getRoutePath=function(e,n,i,o){var r={routepath:"M "+e[0][0].x+" "+e[0][0].y+" ",arrowpath:""};if(e.length>1)for(var s=0;s<e.length;s++){var a=(b=e[s])[1].x,l=b[1].y,c=a-b[0].x,d=l-b[0].y;if(s<e.length-1){Math.abs(c)>0?a-=c/Math.abs(c)*n:l-=d/Math.abs(d)*n,r.routepath+="L "+a+" "+l+" ";var u=e[s+1],h=u[0].x,p=u[0].y;c=u[1].x-h,d=u[1].y-p;var g,f,m=t.angleBetween2Lines(b,u)<0?1:0;Math.abs(c)>0?(g=h+c/Math.abs(c)*n,f=p):(g=h,f=p+d/Math.abs(d)*n);var _=Math.abs(g-a),v=Math.abs(f-l);r.routepath+="A "+_+" "+v+" 0 0 "+m+" "+g+" "+f+" "}else{var y=[a,l];Math.abs(c)>0?(E=[a-=c/Math.abs(c)*o,l+i],T=[a,l-i]):(E=[a+i,l-=d/Math.abs(d)*o],T=[a-i,l]),r.routepath+="L "+a+" "+l+" ",o>0&&(r.arrowpath="M "+y[0]+" "+y[1]+" L "+E[0]+" "+E[1]+" L "+T[0]+" "+T[1])}}else{var b,E,T;a=(b=e[0])[1].x,l=b[1].y,c=a-b[0].x,d=l-b[0].y,y=[a,l];Math.abs(c)>0?(E=[a-=c/Math.abs(c)*o,l+i],T=[a,l-i]):(E=[a+i,l-=d/Math.abs(d)*o],T=[a-i,l]),r.routepath+="L "+a+" "+l+" ",o>0&&(r.arrowpath="M "+y[0]+" "+y[1]+" L "+E[0]+" "+E[1]+" L "+T[0]+" "+T[1])}return r},t}();e.GridRouter=r})),YS=r_((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this.source=t,this.target=e}return t.prototype.actualLength=function(t){var e=this;return Math.sqrt(t.reduce((function(t,n){var i=n[e.target]-n[e.source];return t+i*i}),0))},t}();e.Link3D=n;var i=function(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.x=t,this.y=e,this.z=n};e.Node3D=i;var o=function(){function t(e,n,i){var o=this;void 0===i&&(i=1),this.nodes=e,this.links=n,this.idealLinkLength=i,this.constraints=null,this.useJaccardLinkLengths=!0,this.result=new Array(t.k);for(var r=0;r<t.k;++r)this.result[r]=new Array(e.length);e.forEach((function(e,n){for(var i=0,r=t.dims;i<r.length;i++){var s=r[i];void 0===e[s]&&(e[s]=Math.random())}o.result[0][n]=e.x,o.result[1][n]=e.y,o.result[2][n]=e.z}))}return t.prototype.linkLength=function(t){return t.actualLength(this.result)},t.prototype.start=function(t){var e=this;void 0===t&&(t=100);var n=this.nodes.length,i=new r;this.useJaccardLinkLengths&&DS.jaccardLinkLengths(this.links,i,1.5),this.links.forEach((function(t){return t.length*=e.idealLinkLength}));var o=new FS.Calculator(n,this.links,(function(t){return t.source}),(function(t){return t.target}),(function(t){return t.length})).DistanceMatrix(),s=NS.Descent.createSquareMatrix(n,(function(t,e){return o[t][e]})),a=NS.Descent.createSquareMatrix(n,(function(){return 2}));this.links.forEach((function(t){var e=t.source,n=t.target;return a[e][n]=a[n][e]=1})),this.descent=new NS.Descent(this.result,s),this.descent.threshold=.001,this.descent.G=a,this.constraints&&(this.descent.project=new MS.Projection(this.nodes,null,null,this.constraints).projectFunctions());for(var l=0;l<this.nodes.length;l++){var c=this.nodes[l];c.fixed&&this.descent.locks.add(l,[c.x,c.y,c.z])}return this.descent.run(t),this},t.prototype.tick=function(){this.descent.locks.clear();for(var t=0;t<this.nodes.length;t++){var e=this.nodes[t];e.fixed&&this.descent.locks.add(t,[e.x,e.y,e.z])}return this.descent.rungeKutta()},t.dims=["x","y","z"],t.k=t.dims.length,t}();e.Layout3D=o;var r=function(){function t(){}return t.prototype.getSourceIndex=function(t){return t.source},t.prototype.getTargetIndex=function(t){return t.target},t.prototype.getLength=function(t){return t.length},t.prototype.setLength=function(t,e){t.length=e},t}()})),KS=r_((function(t,e){function n(t,e,n,i){t.forEach((function(t){t.routerNode={name:t.name,bounds:t.bounds.inflate(-n)}})),e.forEach((function(e){e.routerNode={bounds:e.bounds.inflate(-i),children:(void 0!==e.groups?e.groups.map((function(e){return t.length+e.id})):[]).concat(void 0!==e.leaves?e.leaves.map((function(t){return t.index})):[])}}));var o=t.concat(e).map((function(t,e){return t.routerNode.id=e,t.routerNode}));return new jS.GridRouter(o,{getChildren:function(t){return t.children},getBounds:function(t){return t.bounds}},n-i)}Object.defineProperty(e,"__esModule",{value:!0}),e.gridify=function(t,e,i,o){return t.cola.start(0,0,0,10,!1),n(t.cola.nodes(),t.cola.groups(),i,o).routeEdges(t.powerGraph.powerEdges,e,(function(t){return t.source.routerNode.id}),(function(t){return t.target.routerNode.id}))},e.powerGraphGridLayout=function(t,e,n){var i;t.nodes.forEach((function(t,e){return t.index=e})),(new VS.Layout).avoidOverlaps(!1).nodes(t.nodes).links(t.links).powerGraphGroups((function(t){(i=t).groups.forEach((function(t){return t.padding=n}))}));var o=t.nodes.length,r=[],s=t.nodes.slice(0);return s.forEach((function(t,e){return t.index=e})),i.groups.forEach((function(t){var e=t.index=t.id+o;s.push(t),void 0!==t.leaves&&t.leaves.forEach((function(t){return r.push({source:e,target:t.index})})),void 0!==t.groups&&t.groups.forEach((function(t){return r.push({source:e,target:t.id+o})}))})),i.powerEdges.forEach((function(t){r.push({source:t.source.index,target:t.target.index})})),(new VS.Layout).size(e).nodes(s).links(r).avoidOverlaps(!1).linkDistance(30).symmetricDiffLinkLengths(5).convergenceThreshold(1e-4).start(100,0,0,0,!1),{cola:(new VS.Layout).convergenceThreshold(.001).size(e).avoidOverlaps(!0).nodes(t.nodes).links(t.links).groupCompactness(1e-4).linkDistance(30).symmetricDiffLinkLengths(5).powerGraphGroups((function(t){(i=t).groups.forEach((function(t){t.padding=n}))})).start(50,0,100,0,!1),powerGraph:i}}})),$S=r_((function(t,e){function n(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),n(GS),n(XS),n(NS),n(HS),n(jS),n(US),n(VS),n(YS),n(DS),n(AS),n(BS),n(PS),n(MS),n(FS),n(LS),n(KS)})),JS=r_((function(t,e){var n;n=function(t){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.i=function(t){return t},n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=3)}([function(t,e,n){var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=n(1),r=n(2),s=n(5)||("undefined"!=typeof window?window.cola:null),a=n(4),l=function(t){return(void 0===t?"undefined":i(t))===i(0)},c=function(){},d=function(t,e){var n;return null!=(n=t)&&(void 0===n?"undefined":i(n))===i((function(){}))?t.apply(e,[e]):t};function u(t){this.options=o({},r,t)}u.prototype.run=function(){var t=this,e=this.options;t.manuallyStopped=!1;var n=e.cy,o=e.eles,r=o.nodes(),u=o.edges(),h=!1,p=r.filter((function(t){return t.isParent()})),g=r.subtract(p),f=e.boundingBox||{x1:0,y1:0,w:n.width(),h:n.height()};void 0===f.x2&&(f.x2=f.x1+f.w),void 0===f.w&&(f.w=f.x2-f.x1),void 0===f.y2&&(f.y2=f.y1+f.h),void 0===f.h&&(f.h=f.y2-f.y1);var m=function(){for(var t=0;t<r.length;t++){var i=r[t],o=i.layoutDimensions(e),s=i.scratch("cola");if(!s.updatedDims){var a=d(e.nodeSpacing,i);s.width=o.w+2*a,s.height=o.h+2*a}}r.positions((function(t){var e=t.scratch().cola,n=void 0;return!t.grabbed()&&g.contains(t)&&(n={x:f.x1+e.x,y:f.y1+e.y},l(n.x)&&l(n.y)||(n=void 0)),n})),r.updateCompoundBounds(),h||(v(),h=!0),e.fit&&n.fit(e.padding)},_=function(){e.ungrabifyWhileSimulating&&E.grabify(),n.off("destroy",T),r.off("grab free position",R),r.off("lock unlock",C),t.one("layoutstop",e.stop),t.trigger({type:"layoutstop",layout:t})},v=function(){t.one("layoutready",e.ready),t.trigger({type:"layoutready",layout:t})},y=e.refresh;y=e.refresh<0?1:Math.max(1,y);var b=t.adaptor=s.adaptor({trigger:function(t){var n=s.EventType?s.EventType.tick:null,i=s.EventType?s.EventType.end:null;switch(t.type){case"tick":case n:e.animate&&m();break;case"end":case i:m(),e.infinite||_()}},kick:function(){var n=!0,i=function(){if(t.manuallyStopped)return _(),!0;var i=b.tick();return e.infinite||n||b.convergenceThreshold(e.convergenceThreshold),n=!1,i&&e.infinite&&b.resume(),i};if(e.animate)a((function t(){(function(){for(var t=void 0,e=0;e<y&&!t;e++)t=t||i();return t})()||a(t)}));else for(;!i(););},on:c,drag:c});t.adaptor=b;var E=r.filter(":grabbable");e.ungrabifyWhileSimulating&&E.ungrabify();var T=void 0;n.one("destroy",T=function(){t.stop()});var R=void 0;r.on("grab free position",R=function(t){var e=this,n=e.scratch().cola,i=e.position();if(t.cyTarget===e||t.target===e)switch(t.type){case"grab":b.dragstart(n);break;case"free":b.dragend(n);break;case"position":n.px===i.x-f.x1&&n.py===i.y-f.y1||(n.px=i.x-f.x1,n.py=i.y-f.y1)}});var C=void 0;r.on("lock unlock",C=function(){var t=this,e=t.scratch().cola;e.fixed=t.locked(),t.locked()?b.dragstart(e):b.dragend(e)}),b.nodes(g.map((function(t,n){var i=d(e.nodeSpacing,t),o=t.position(),r=t.layoutDimensions(e);return t.scratch().cola={x:e.randomize&&!t.locked()||void 0===o.x?Math.round(Math.random()*f.w):o.x,y:e.randomize&&!t.locked()||void 0===o.y?Math.round(Math.random()*f.h):o.y,width:r.w+2*i,height:r.h+2*i,index:n,fixed:t.locked()}})));var x=[];e.alignment&&(e.alignment.vertical&&e.alignment.vertical.forEach((function(t){var e=[];t.forEach((function(t){var n=t.node.scratch().cola.index;e.push({node:n,offset:t.offset?t.offset:0})})),x.push({type:"alignment",axis:"x",offsets:e})})),e.alignment.horizontal&&e.alignment.horizontal.forEach((function(t){var e=[];t.forEach((function(t){var n=t.node.scratch().cola.index;e.push({node:n,offset:t.offset?t.offset:0})})),x.push({type:"alignment",axis:"y",offsets:e})}))),e.gapInequalities&&e.gapInequalities.forEach((function(t){var e=t.left.scratch().cola.index,n=t.right.scratch().cola.index;x.push({axis:t.axis,left:e,right:n,gap:t.gap,equality:t.equality})})),x.length>0&&b.constraints(x),b.groups(p.map((function(t,n){var i=d(e.nodeSpacing,t),o=function(e){return parseFloat(t.style("padding-"+e))},r=o("left")+i,s=o("right")+i,a=o("top")+i,l=o("bottom")+i;return t.scratch().cola={index:n,padding:Math.max(r,s,a,l),leaves:t.children().intersection(g).map((function(t){return t[0].scratch().cola.index})),fixed:t.locked()},t})).map((function(t){return t.scratch().cola.groups=t.children().intersection(p).map((function(t){return t.scratch().cola.index})),t.scratch().cola})));var S,I=void 0,O=void 0;if(null!=e.edgeLength?(I=e.edgeLength,O="linkDistance"):null!=e.edgeSymDiffLength?(I=e.edgeSymDiffLength,O="symmetricDiffLinkLengths"):null!=e.edgeJaccardLength?(I=e.edgeJaccardLength,O="jaccardLinkLengths"):(I=100,O="linkDistance"),b.links(u.stdFilter((function(t){return g.contains(t.source())&&g.contains(t.target())})).map((function(t){var e=t.scratch().cola={source:t.source()[0].scratch().cola.index,target:t.target()[0].scratch().cola.index};return null!=I&&(e.calcLength=d(I,t)),e}))),b.size([f.w,f.h]),null!=I&&b[O]((function(t){return t.calcLength})),e.flow){var k=void 0;(void 0===(S=e.flow)?"undefined":i(S))===i("")?k={axis:e.flow,minSeparation:50}:l(e.flow)?k={axis:"y",minSeparation:e.flow}:function(t){return null!=t&&(void 0===t?"undefined":i(t))===i({})}(e.flow)?((k=e.flow).axis=k.axis||"y",k.minSeparation=null!=k.minSeparation?k.minSeparation:50):k={axis:"y",minSeparation:50},b.flowLayout(k.axis,k.minSeparation)}return t.trigger({type:"layoutstart",layout:t}),b.avoidOverlaps(e.avoidOverlap).handleDisconnected(e.handleDisconnected).start(e.unconstrIter,e.userConstIter,e.allConstIter),e.infinite||setTimeout((function(){t.manuallyStopped||b.stop()}),e.maxSimulationTime),this},u.prototype.stop=function(){return this.adaptor&&(this.manuallyStopped=!0,this.adaptor.stop()),this},t.exports=u},function(t,e,n){t.exports=null!=Object.assign?Object.assign.bind(Object):function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return n.filter((function(t){return null!=t})).forEach((function(e){Object.keys(e).forEach((function(n){return t[n]=e[n]}))})),t}},function(t,e,n){var i={animate:!0,refresh:1,maxSimulationTime:4e3,ungrabifyWhileSimulating:!1,fit:!0,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,ready:function(){},stop:function(){},randomize:!1,avoidOverlap:!0,handleDisconnected:!0,convergenceThreshold:.01,nodeSpacing:function(t){return 10},flow:void 0,alignment:void 0,gapInequalities:void 0,edgeLength:void 0,edgeSymDiffLength:void 0,edgeJaccardLength:void 0,unconstrIter:void 0,userConstIter:void 0,allConstIter:void 0,infinite:!1};t.exports=i},function(t,e,n){var i=n(0),o=function(t){t&&t("layout","cola",i)};"undefined"!=typeof cytoscape&&o(cytoscape),t.exports=o},function(t,e,n){var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=void 0;o="undefined"!==("undefined"==typeof window?"undefined":i(window))?window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return setTimeout(t,16)}:function(t){t()},t.exports=o},function(e,n){e.exports=t}])},t.exports=n($S)}));ES.use(JS);const qS={name:"cola",animate:!0,ready:t=>{t.cy.fit(),t.cy.center()}};class ZS extends Lm{constructor(){super(...arguments),this.hideFilter=!1,this.showEntryContents=!1,this.excludedEntryTypes=[],this.lastEntriesIds=[],this.ready=!1,this._entryTypes=[]}firstUpdated(){window.addEventListener("scroll",(()=>{this.cy.resize()})),this.cy=ES({container:this.entryGraph,boxSelectionEnabled:!1,autoungrabify:!1,userZoomingEnabled:!0,userPanningEnabled:!0,layout:qS,style:"\nnode {\n  background-color: grey;\n  font-size: 10px;\n  width: 16px;\n  label: data(label);\n  height: 16px;\n  shape: round-rectangle;\n}\n\nnode > node {\n  height: 1px;\n}\n\nedge {\n  width: 2;\n  target-arrow-shape: triangle;\n  curve-style: bezier;\n}\n\nedge[label] {\n  label: data(label);\n  font-size: 7px;\n  text-rotation: autorotate;\n  text-margin-x: 0px;\n  text-margin-y: -5px;\n  text-valign: top;\n  text-halign: center;        \n}\n\n.selected {\n  border-width: 1px;\n  border-color: black;\n  border-style: solid;\n}\n\n.AgentId {\n  background-color: lime;\n}\n.Create {\n  background-color: blue;\n}\n.Delete {\n  background-color: red;\n}\n.Update {\n  background-color: cyan;\n}\n.CreateLink {\n  background-color: purple;\n}\n.DeleteLink {\n  background-color: purple;\n}\n\n.implicit {\n  width: 1;\n  line-style: dotted;\n}\n\n.update-edge {\n  width: 1;\n  line-style: dashed;\n}\n.updated {\n  opacity: 0.5;\n}\n.deleted {\n  opacity: 0.3 !important;\n}\n"}),this.cy.on("tap","node",(t=>{const e=t.target.id();this.updatePlayground({activeHash:e})})),this.cy.ready((t=>{setTimeout((()=>{this.ready=!0,this.updatedGraph()}),500)}))}updated(t){super.updated(t),this.updatedGraph()}observedCells(){return Bm(this.activeDna,this.conductors)}updatedGraph(){if(0===this.entryGraph.getBoundingClientRect().width||!this.ready)return null;const t=Bm(this.activeDna,this.conductors),{entries:e,entryTypes:n}=OS(t,this.showEntryContents,this.excludedEntryTypes);$o(this.lastEntriesIds,e.map((t=>t.data.id)))||(this.layout&&this.layout.stop(),this.cy.remove("node"),this.cy.add(e),this.layout=this.cy.elements().makeLayout(qS),this.layout.run(),this._entryTypes=n),this.lastEntriesIds=e.map((t=>t.data.id)),this.cy.filter("node").removeClass("selected");const i=this.cy.getElementById(this.activeHash);i&&i.addClass("selected")}static get styles(){return[Pm,st(pm||(pm=km`:host{display:flex}`))]}renderHelp(){return F(gm||(gm=km` <holochain-playground-help-button heading="Entry Graph" class="block-help"> <span> This graph contains a <strong>high-level view of all the entries</strong> that are present in the DHT. Every object you see represents an entry, and the relationships between them are links. <br> <br> Dashed relationships are embedded references, and solid relationships are normal holochain links. The tag of the holochain links appears as the label. </span> </holochain-playground-help-button>`))}renderFilter(){return F(fm||(fm=km` <div class="row" style="align-items:center;justify-content:start;position:relative"> <mwc-formfield label="Show Entry Contents" style="margin-right:16px"> <mwc-checkbox checked="checked" @change="${0}"></mwc-checkbox></mwc-formfield> <span class="vertical-divider"></span> <mwc-button label="Visible entries" style="--mdc-theme-primary:rgba(0,0,0,0.7);margin-left:16px" icon="arrow_drop_down" id="visible-entries-button" trailingIcon @click="${0}"></mwc-button> <mwc-menu corner="BOTTOM_END" multi activatable id="visible-entries-menu" .anchor="${0}" @selected="${0}"> ${0} </mwc-menu> </div>`),(t=>this.showEntryContents=t.target.checked),(()=>this._visibleEntriesMenu.show()),this._visibleEntriesButton,(t=>{const e=[...t.detail.index];this.excludedEntryTypes=this._entryTypes.filter(((t,n)=>!e.includes(n)))}),this._entryTypes.map((t=>F(mm||(mm=km` <mwc-list-item graphic="icon" .selected="${0}" .activated="${0}"> ${0} ${0} </mwc-list-item> `),!this.excludedEntryTypes.includes(t),!this.excludedEntryTypes.includes(t),this.excludedEntryTypes.includes(t)?F(vm||(vm=km``)):F(_m||(_m=km` <mwc-icon slot="graphic">check</mwc-icon> `)),t))))}render(){return F(ym||(ym=km` <mwc-card class="block-card"> <div class="column fill" style="margin:16px"> <span class="block-title">Entry Graph</span> <div id="entry-graph" class="fill"></div> ${0} ${0} </div> </mwc-card> `),this.renderHelp(),this.hideFilter?F(bm||(bm=km``)):this.renderFilter())}static get scopedElements(){return{"mwc-checkbox":dg,"mwc-formfield":vp,"mwc-icon-button":en,"mwc-card":ld,"mwc-menu":ig,"mwc-icon":ul,"mwc-list-item":Rd,"mwc-button":bl,"holochain-playground-help-button":RS}}}wm([J({type:Boolean,attribute:"hide-filter"}),Am("design:type",Boolean)],ZS.prototype,"hideFilter",void 0),wm([J({type:Boolean,attribute:"show-entry-contents"}),Am("design:type",Boolean)],ZS.prototype,"showEntryContents",void 0),wm([J({type:Array}),Am("design:type",Array)],ZS.prototype,"excludedEntryTypes",void 0),wm([Z("#entry-graph"),Am("design:type",HTMLElement)],ZS.prototype,"entryGraph",void 0),wm([J({type:Array}),Am("design:type",Object)],ZS.prototype,"_entryTypes",void 0),wm([Z("#visible-entries-button"),Am("design:type",bl)],ZS.prototype,"_visibleEntriesButton",void 0),wm([Z("#visible-entries-menu"),Am("design:type",ig)],ZS.prototype,"_visibleEntriesMenu",void 0);var QS=function(){this.__data__=[],this.size=0};var tI=function(t,e){return t===e||t!=t&&e!=e};var eI=function(t,e){for(var n=t.length;n--;)if(tI(t[n][0],e))return n;return-1},nI=Array.prototype.splice;var iI=function(t){var e=this.__data__,n=eI(e,t);return!(n<0)&&(n==e.length-1?e.pop():nI.call(e,n,1),--this.size,!0)};var oI=function(t){var e=this.__data__,n=eI(e,t);return n<0?void 0:e[n][1]};var rI=function(t){return eI(this.__data__,t)>-1};var sI=function(t,e){var n=this.__data__,i=eI(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this};function aI(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}aI.prototype.clear=QS,aI.prototype.delete=iI,aI.prototype.get=oI,aI.prototype.has=rI,aI.prototype.set=sI;var lI=aI;var cI=function(){this.__data__=new lI,this.size=0};var dI=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n};var uI=function(t){return this.__data__.get(t)};var hI=function(t){return this.__data__.has(t)},pI="object"==typeof o_&&o_&&o_.Object===Object&&o_,gI="object"==typeof self&&self&&self.Object===Object&&self,fI=pI||gI||Function("return this")(),mI=fI.Symbol,_I=Object.prototype,vI=_I.hasOwnProperty,yI=_I.toString,bI=mI?mI.toStringTag:void 0;var EI=function(t){var e=vI.call(t,bI),n=t[bI];try{t[bI]=void 0;var i=!0}catch(t){}var o=yI.call(t);return i&&(e?t[bI]=n:delete t[bI]),o},TI=Object.prototype.toString;var RI=function(t){return TI.call(t)},CI=mI?mI.toStringTag:void 0;var xI=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":CI&&CI in Object(t)?EI(t):RI(t)};var SI=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)};var II=function(t){if(!SI(t))return!1;var e=xI(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},OI=fI["__core-js_shared__"],kI=function(){var t=/[^.]+$/.exec(OI&&OI.keys&&OI.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();var wI=function(t){return!!kI&&kI in t},AI=Function.prototype.toString;var DI=function(t){if(null!=t){try{return AI.call(t)}catch(t){}try{return t+""}catch(t){}}return""},NI=/^\[object .+?Constructor\]$/,LI=Function.prototype,PI=Object.prototype,MI=LI.toString,BI=PI.hasOwnProperty,FI=RegExp("^"+MI.call(BI).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var HI=function(t){return!(!SI(t)||wI(t))&&(II(t)?FI:NI).test(DI(t))};var UI=function(t,e){return null==t?void 0:t[e]};var VI=function(t,e){var n=UI(t,e);return HI(n)?n:void 0},GI=VI(fI,"Map"),WI=VI(Object,"create");var zI=function(){this.__data__=WI?WI(null):{},this.size=0};var XI=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},jI=Object.prototype.hasOwnProperty;var YI=function(t){var e=this.__data__;if(WI){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return jI.call(e,t)?e[t]:void 0},KI=Object.prototype.hasOwnProperty;var $I=function(t){var e=this.__data__;return WI?void 0!==e[t]:KI.call(e,t)};var JI=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=WI&&void 0===e?"__lodash_hash_undefined__":e,this};function qI(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}qI.prototype.clear=zI,qI.prototype.delete=XI,qI.prototype.get=YI,qI.prototype.has=$I,qI.prototype.set=JI;var ZI=qI;var QI=function(){this.size=0,this.__data__={hash:new ZI,map:new(GI||lI),string:new ZI}};var tO=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var eO=function(t,e){var n=t.__data__;return tO(e)?n["string"==typeof e?"string":"hash"]:n.map};var nO=function(t){var e=eO(this,t).delete(t);return this.size-=e?1:0,e};var iO=function(t){return eO(this,t).get(t)};var oO=function(t){return eO(this,t).has(t)};var rO=function(t,e){var n=eO(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this};function sO(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}sO.prototype.clear=QI,sO.prototype.delete=nO,sO.prototype.get=iO,sO.prototype.has=oO,sO.prototype.set=rO;var aO=sO;var lO=function(t,e){var n=this.__data__;if(n instanceof lI){var i=n.__data__;if(!GI||i.length<199)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new aO(i)}return n.set(t,e),this.size=n.size,this};function cO(t){var e=this.__data__=new lI(t);this.size=e.size}cO.prototype.clear=cI,cO.prototype.delete=dI,cO.prototype.get=uI,cO.prototype.has=hI,cO.prototype.set=lO;var dO=cO;var uO=function(t,e){for(var n=-1,i=null==t?0:t.length;++n<i&&!1!==e(t[n],n,t););return t},hO=function(){try{var t=VI(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();var pO=function(t,e,n){"__proto__"==e&&hO?hO(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n},gO=Object.prototype.hasOwnProperty;var fO=function(t,e,n){var i=t[e];gO.call(t,e)&&tI(i,n)&&(void 0!==n||e in t)||pO(t,e,n)};var mO=function(t,e,n,i){var o=!n;n||(n={});for(var r=-1,s=e.length;++r<s;){var a=e[r],l=i?i(n[a],t[a],a,n,t):void 0;void 0===l&&(l=t[a]),o?pO(n,a,l):fO(n,a,l)}return n};var _O=function(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i};var vO=function(t){return null!=t&&"object"==typeof t};var yO=function(t){return vO(t)&&"[object Arguments]"==xI(t)},bO=Object.prototype,EO=bO.hasOwnProperty,TO=bO.propertyIsEnumerable,RO=yO(function(){return arguments}())?yO:function(t){return vO(t)&&EO.call(t,"callee")&&!TO.call(t,"callee")},CO=Array.isArray;var xO=function(){return!1},SO=r_((function(t,e){var n=e&&!e.nodeType&&e,i=n&&t&&!t.nodeType&&t,o=i&&i.exports===n?fI.Buffer:void 0,r=(o?o.isBuffer:void 0)||xO;t.exports=r})),IO=/^(?:0|[1-9]\d*)$/;var OO=function(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&IO.test(t))&&t>-1&&t%1==0&&t<e};var kO=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},wO={};wO["[object Float32Array]"]=wO["[object Float64Array]"]=wO["[object Int8Array]"]=wO["[object Int16Array]"]=wO["[object Int32Array]"]=wO["[object Uint8Array]"]=wO["[object Uint8ClampedArray]"]=wO["[object Uint16Array]"]=wO["[object Uint32Array]"]=!0,wO["[object Arguments]"]=wO["[object Array]"]=wO["[object ArrayBuffer]"]=wO["[object Boolean]"]=wO["[object DataView]"]=wO["[object Date]"]=wO["[object Error]"]=wO["[object Function]"]=wO["[object Map]"]=wO["[object Number]"]=wO["[object Object]"]=wO["[object RegExp]"]=wO["[object Set]"]=wO["[object String]"]=wO["[object WeakMap]"]=!1;var AO=function(t){return vO(t)&&kO(t.length)&&!!wO[xI(t)]};var DO=function(t){return function(e){return t(e)}},NO=r_((function(t,e){var n=e&&!e.nodeType&&e,i=n&&t&&!t.nodeType&&t,o=i&&i.exports===n&&pI.process,r=function(){try{var t=i&&i.require&&i.require("util").types;return t||o&&o.binding&&o.binding("util")}catch(t){}}();t.exports=r})),LO=NO&&NO.isTypedArray,PO=LO?DO(LO):AO,MO=Object.prototype.hasOwnProperty;var BO=function(t,e){var n=CO(t),i=!n&&RO(t),o=!n&&!i&&SO(t),r=!n&&!i&&!o&&PO(t),s=n||i||o||r,a=s?_O(t.length,String):[],l=a.length;for(var c in t)!e&&!MO.call(t,c)||s&&("length"==c||o&&("offset"==c||"parent"==c)||r&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||OO(c,l))||a.push(c);return a},FO=Object.prototype;var HO=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||FO)};var UO=function(t,e){return function(n){return t(e(n))}},VO=UO(Object.keys,Object),GO=Object.prototype.hasOwnProperty;var WO=function(t){if(!HO(t))return VO(t);var e=[];for(var n in Object(t))GO.call(t,n)&&"constructor"!=n&&e.push(n);return e};var zO=function(t){return null!=t&&kO(t.length)&&!II(t)};var XO=function(t){return zO(t)?BO(t):WO(t)};var jO=function(t,e){return t&&mO(e,XO(e),t)};var YO=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e},KO=Object.prototype.hasOwnProperty;var $O=function(t){if(!SI(t))return YO(t);var e=HO(t),n=[];for(var i in t)("constructor"!=i||!e&&KO.call(t,i))&&n.push(i);return n};var JO=function(t){return zO(t)?BO(t,!0):$O(t)};var qO=function(t,e){return t&&mO(e,JO(e),t)},ZO=r_((function(t,e){var n=e&&!e.nodeType&&e,i=n&&t&&!t.nodeType&&t,o=i&&i.exports===n?fI.Buffer:void 0,r=o?o.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var n=t.length,i=r?r(n):new t.constructor(n);return t.copy(i),i}}));var QO=function(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e};var tk=function(t,e){for(var n=-1,i=null==t?0:t.length,o=0,r=[];++n<i;){var s=t[n];e(s,n,t)&&(r[o++]=s)}return r};var ek=function(){return[]},nk=Object.prototype.propertyIsEnumerable,ik=Object.getOwnPropertySymbols,ok=ik?function(t){return null==t?[]:(t=Object(t),tk(ik(t),(function(e){return nk.call(t,e)})))}:ek;var rk=function(t,e){return mO(t,ok(t),e)};var sk=function(t,e){for(var n=-1,i=e.length,o=t.length;++n<i;)t[o+n]=e[n];return t},ak=UO(Object.getPrototypeOf,Object),lk=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)sk(e,ok(t)),t=ak(t);return e}:ek;var ck=function(t,e){return mO(t,lk(t),e)};var dk=function(t,e,n){var i=e(t);return CO(t)?i:sk(i,n(t))};var uk=function(t){return dk(t,XO,ok)};var hk=function(t){return dk(t,JO,lk)},pk=VI(fI,"DataView"),gk=VI(fI,"Promise"),fk=VI(fI,"Set"),mk=VI(fI,"WeakMap"),_k=DI(pk),vk=DI(GI),yk=DI(gk),bk=DI(fk),Ek=DI(mk),Tk=xI;(pk&&"[object DataView]"!=Tk(new pk(new ArrayBuffer(1)))||GI&&"[object Map]"!=Tk(new GI)||gk&&"[object Promise]"!=Tk(gk.resolve())||fk&&"[object Set]"!=Tk(new fk)||mk&&"[object WeakMap]"!=Tk(new mk))&&(Tk=function(t){var e=xI(t),n="[object Object]"==e?t.constructor:void 0,i=n?DI(n):"";if(i)switch(i){case _k:return"[object DataView]";case vk:return"[object Map]";case yk:return"[object Promise]";case bk:return"[object Set]";case Ek:return"[object WeakMap]"}return e});var Rk=Tk,Ck=Object.prototype.hasOwnProperty;var xk=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&Ck.call(t,"index")&&(n.index=t.index,n.input=t.input),n},Sk=fI.Uint8Array;var Ik=function(t){var e=new t.constructor(t.byteLength);return new Sk(e).set(new Sk(t)),e};var Ok=function(t,e){var n=e?Ik(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)},kk=/\w*$/;var wk=function(t){var e=new t.constructor(t.source,kk.exec(t));return e.lastIndex=t.lastIndex,e},Ak=mI?mI.prototype:void 0,Dk=Ak?Ak.valueOf:void 0;var Nk=function(t){return Dk?Object(Dk.call(t)):{}};var Lk=function(t,e){var n=e?Ik(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)};var Pk=function(t,e,n){var i=t.constructor;switch(e){case"[object ArrayBuffer]":return Ik(t);case"[object Boolean]":case"[object Date]":return new i(+t);case"[object DataView]":return Ok(t,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Lk(t,n);case"[object Map]":return new i;case"[object Number]":case"[object String]":return new i(t);case"[object RegExp]":return wk(t);case"[object Set]":return new i;case"[object Symbol]":return Nk(t)}},Mk=Object.create,Bk=function(){function t(){}return function(e){if(!SI(e))return{};if(Mk)return Mk(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();var Fk=function(t){return"function"!=typeof t.constructor||HO(t)?{}:Bk(ak(t))};var Hk=function(t){return vO(t)&&"[object Map]"==Rk(t)},Uk=NO&&NO.isMap,Vk=Uk?DO(Uk):Hk;var Gk=function(t){return vO(t)&&"[object Set]"==Rk(t)},Wk=NO&&NO.isSet,zk=Wk?DO(Wk):Gk,Xk={};Xk["[object Arguments]"]=Xk["[object Array]"]=Xk["[object ArrayBuffer]"]=Xk["[object DataView]"]=Xk["[object Boolean]"]=Xk["[object Date]"]=Xk["[object Float32Array]"]=Xk["[object Float64Array]"]=Xk["[object Int8Array]"]=Xk["[object Int16Array]"]=Xk["[object Int32Array]"]=Xk["[object Map]"]=Xk["[object Number]"]=Xk["[object Object]"]=Xk["[object RegExp]"]=Xk["[object Set]"]=Xk["[object String]"]=Xk["[object Symbol]"]=Xk["[object Uint8Array]"]=Xk["[object Uint8ClampedArray]"]=Xk["[object Uint16Array]"]=Xk["[object Uint32Array]"]=!0,Xk["[object Error]"]=Xk["[object Function]"]=Xk["[object WeakMap]"]=!1;var jk=function t(e,n,i,o,r,s){var a,l=1&n,c=2&n,d=4&n;if(i&&(a=r?i(e,o,r,s):i(e)),void 0!==a)return a;if(!SI(e))return e;var u=CO(e);if(u){if(a=xk(e),!l)return QO(e,a)}else{var h=Rk(e),p="[object Function]"==h||"[object GeneratorFunction]"==h;if(SO(e))return ZO(e,l);if("[object Object]"==h||"[object Arguments]"==h||p&&!r){if(a=c||p?{}:Fk(e),!l)return c?ck(e,qO(a,e)):rk(e,jO(a,e))}else{if(!Xk[h])return r?e:{};a=Pk(e,h,l)}}s||(s=new dO);var g=s.get(e);if(g)return g;s.set(e,a),zk(e)?e.forEach((function(o){a.add(t(o,n,i,o,e,s))})):Vk(e)&&e.forEach((function(o,r){a.set(r,t(o,n,i,r,e,s))}));var f=u?void 0:(d?c?hk:uk:c?JO:XO)(e);return uO(f||e,(function(o,r){f&&(o=e[r=o]),fO(a,r,t(o,n,i,r,e,s))})),a};var Yk=function(t){return jk(t,4)};var Kk=function(t){return function(){return t}};var $k=function(t){return function(e,n,i){for(var o=-1,r=Object(e),s=i(e),a=s.length;a--;){var l=s[t?a:++o];if(!1===n(r[l],l,r))break}return e}}();var Jk=function(t,e){return t&&$k(t,e,XO)};var qk=function(t,e){return function(n,i){if(null==n)return n;if(!zO(n))return t(n,i);for(var o=n.length,r=e?o:-1,s=Object(n);(e?r--:++r<o)&&!1!==i(s[r],r,s););return n}}(Jk);var Zk=function(t){return t};var Qk=function(t){return"function"==typeof t?t:Zk};var tw=function(t,e){return(CO(t)?uO:qk)(t,Qk(e))},ew=tw;var nw=function(t,e){var n=[];return qk(t,(function(t,i,o){e(t,i,o)&&n.push(t)})),n};var iw=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this};var ow=function(t){return this.__data__.has(t)};function rw(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new aO;++e<n;)this.add(t[e])}rw.prototype.add=rw.prototype.push=iw,rw.prototype.has=ow;var sw=rw;var aw=function(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1};var lw=function(t,e){return t.has(e)};var cw=function(t,e,n,i,o,r){var s=1&n,a=t.length,l=e.length;if(a!=l&&!(s&&l>a))return!1;var c=r.get(t),d=r.get(e);if(c&&d)return c==e&&d==t;var u=-1,h=!0,p=2&n?new sw:void 0;for(r.set(t,e),r.set(e,t);++u<a;){var g=t[u],f=e[u];if(i)var m=s?i(f,g,u,e,t,r):i(g,f,u,t,e,r);if(void 0!==m){if(m)continue;h=!1;break}if(p){if(!aw(e,(function(t,e){if(!lw(p,e)&&(g===t||o(g,t,n,i,r)))return p.push(e)}))){h=!1;break}}else if(g!==f&&!o(g,f,n,i,r)){h=!1;break}}return r.delete(t),r.delete(e),h};var dw=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t,i){n[++e]=[i,t]})),n};var uw=function(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n},hw=mI?mI.prototype:void 0,pw=hw?hw.valueOf:void 0;var gw=function(t,e,n,i,o,r,s){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!r(new Sk(t),new Sk(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return tI(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var a=dw;case"[object Set]":var l=1&i;if(a||(a=uw),t.size!=e.size&&!l)return!1;var c=s.get(t);if(c)return c==e;i|=2,s.set(t,e);var d=cw(a(t),a(e),i,o,r,s);return s.delete(t),d;case"[object Symbol]":if(pw)return pw.call(t)==pw.call(e)}return!1},fw=Object.prototype.hasOwnProperty;var mw=function(t,e,n,i,o,r){var s=1&n,a=uk(t),l=a.length;if(l!=uk(e).length&&!s)return!1;for(var c=l;c--;){var d=a[c];if(!(s?d in e:fw.call(e,d)))return!1}var u=r.get(t),h=r.get(e);if(u&&h)return u==e&&h==t;var p=!0;r.set(t,e),r.set(e,t);for(var g=s;++c<l;){var f=t[d=a[c]],m=e[d];if(i)var _=s?i(m,f,d,e,t,r):i(f,m,d,t,e,r);if(!(void 0===_?f===m||o(f,m,n,i,r):_)){p=!1;break}g||(g="constructor"==d)}if(p&&!g){var v=t.constructor,y=e.constructor;v==y||!("constructor"in t)||!("constructor"in e)||"function"==typeof v&&v instanceof v&&"function"==typeof y&&y instanceof y||(p=!1)}return r.delete(t),r.delete(e),p},_w=Object.prototype.hasOwnProperty;var vw=function(t,e,n,i,o,r){var s=CO(t),a=CO(e),l=s?"[object Array]":Rk(t),c=a?"[object Array]":Rk(e),d="[object Object]"==(l="[object Arguments]"==l?"[object Object]":l),u="[object Object]"==(c="[object Arguments]"==c?"[object Object]":c),h=l==c;if(h&&SO(t)){if(!SO(e))return!1;s=!0,d=!1}if(h&&!d)return r||(r=new dO),s||PO(t)?cw(t,e,n,i,o,r):gw(t,e,l,n,i,o,r);if(!(1&n)){var p=d&&_w.call(t,"__wrapped__"),g=u&&_w.call(e,"__wrapped__");if(p||g){var f=p?t.value():t,m=g?e.value():e;return r||(r=new dO),o(f,m,n,i,r)}}return!!h&&(r||(r=new dO),mw(t,e,n,i,o,r))};var yw=function t(e,n,i,o,r){return e===n||(null==e||null==n||!vO(e)&&!vO(n)?e!=e&&n!=n:vw(e,n,i,o,t,r))};var bw=function(t,e,n,i){var o=n.length,r=o,s=!i;if(null==t)return!r;for(t=Object(t);o--;){var a=n[o];if(s&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++o<r;){var l=(a=n[o])[0],c=t[l],d=a[1];if(s&&a[2]){if(void 0===c&&!(l in t))return!1}else{var u=new dO;if(i)var h=i(c,d,l,t,e,u);if(!(void 0===h?yw(d,c,3,i,u):h))return!1}}return!0};var Ew=function(t){return t==t&&!SI(t)};var Tw=function(t){for(var e=XO(t),n=e.length;n--;){var i=e[n],o=t[i];e[n]=[i,o,Ew(o)]}return e};var Rw=function(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in Object(n)))}};var Cw=function(t){var e=Tw(t);return 1==e.length&&e[0][2]?Rw(e[0][0],e[0][1]):function(n){return n===t||bw(n,t,e)}};var xw=function(t){return"symbol"==typeof t||vO(t)&&"[object Symbol]"==xI(t)},Sw=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Iw=/^\w*$/;var Ow=function(t,e){if(CO(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!xw(t))||(Iw.test(t)||!Sw.test(t)||null!=e&&t in Object(e))};function kw(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var i=arguments,o=e?e.apply(this,i):i[0],r=n.cache;if(r.has(o))return r.get(o);var s=t.apply(this,i);return n.cache=r.set(o,s)||r,s};return n.cache=new(kw.Cache||aO),n}kw.Cache=aO;var ww=kw;var Aw=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Dw=/\\(\\)?/g,Nw=function(t){var e=ww(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Aw,(function(t,n,i,o){e.push(i?o.replace(Dw,"$1"):n||t)})),e}));var Lw=function(t,e){for(var n=-1,i=null==t?0:t.length,o=Array(i);++n<i;)o[n]=e(t[n],n,t);return o},Pw=mI?mI.prototype:void 0,Mw=Pw?Pw.toString:void 0;var Bw=function t(e){if("string"==typeof e)return e;if(CO(e))return Lw(e,t)+"";if(xw(e))return Mw?Mw.call(e):"";var n=e+"";return"0"==n&&1/e==-Infinity?"-0":n};var Fw=function(t){return null==t?"":Bw(t)};var Hw=function(t,e){return CO(t)?t:Ow(t,e)?[t]:Nw(Fw(t))};var Uw=function(t){if("string"==typeof t||xw(t))return t;var e=t+"";return"0"==e&&1/t==-Infinity?"-0":e};var Vw=function(t,e){for(var n=0,i=(e=Hw(e,t)).length;null!=t&&n<i;)t=t[Uw(e[n++])];return n&&n==i?t:void 0};var Gw=function(t,e,n){var i=null==t?void 0:Vw(t,e);return void 0===i?n:i};var Ww=function(t,e){return null!=t&&e in Object(t)};var zw=function(t,e,n){for(var i=-1,o=(e=Hw(e,t)).length,r=!1;++i<o;){var s=Uw(e[i]);if(!(r=null!=t&&n(t,s)))break;t=t[s]}return r||++i!=o?r:!!(o=null==t?0:t.length)&&kO(o)&&OO(s,o)&&(CO(t)||RO(t))};var Xw=function(t,e){return null!=t&&zw(t,e,Ww)};var jw=function(t,e){return Ow(t)&&Ew(e)?Rw(Uw(t),e):function(n){var i=Gw(n,t);return void 0===i&&i===e?Xw(n,t):yw(e,i,3)}};var Yw=function(t){return function(e){return null==e?void 0:e[t]}};var Kw=function(t){return function(e){return Vw(e,t)}};var $w=function(t){return Ow(t)?Yw(Uw(t)):Kw(t)};var Jw=function(t){return"function"==typeof t?t:null==t?Zk:"object"==typeof t?CO(t)?jw(t[0],t[1]):Cw(t):$w(t)};var qw=function(t,e){return(CO(t)?tk:nw)(t,Jw(e))},Zw=Object.prototype.hasOwnProperty;var Qw=function(t,e){return null!=t&&Zw.call(t,e)};var tA=function(t,e){return null!=t&&zw(t,e,Qw)},eA=Object.prototype.hasOwnProperty;var nA=function(t){if(null==t)return!0;if(zO(t)&&(CO(t)||"string"==typeof t||"function"==typeof t.splice||SO(t)||PO(t)||RO(t)))return!t.length;var e=Rk(t);if("[object Map]"==e||"[object Set]"==e)return!t.size;if(HO(t))return!WO(t).length;for(var n in t)if(eA.call(t,n))return!1;return!0};var iA=function(t){return void 0===t};var oA=function(t,e){var n=-1,i=zO(t)?Array(t.length):[];return qk(t,(function(t,o,r){i[++n]=e(t,o,r)})),i};var rA=function(t,e){return(CO(t)?Lw:oA)(t,Jw(e))};var sA=function(t,e,n,i){var o=-1,r=null==t?0:t.length;for(i&&r&&(n=t[++o]);++o<r;)n=e(n,t[o],o,t);return n};var aA=function(t,e,n,i,o){return o(t,(function(t,o,r){n=i?(i=!1,t):e(n,t,o,r)})),n};var lA=function(t,e,n){var i=CO(t)?sA:aA,o=arguments.length<3;return i(t,Jw(e),n,o,qk)};var cA=function(t){return"string"==typeof t||!CO(t)&&vO(t)&&"[object String]"==xI(t)},dA=Yw("length"),uA=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var hA=function(t){return uA.test(t)},pA="[\\ud800-\\udfff]",gA="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",fA="\\ud83c[\\udffb-\\udfff]",mA="[^\\ud800-\\udfff]",_A="(?:\\ud83c[\\udde6-\\uddff]){2}",vA="[\\ud800-\\udbff][\\udc00-\\udfff]",yA="(?:"+gA+"|"+fA+")"+"?",bA="[\\ufe0e\\ufe0f]?"+yA+("(?:\\u200d(?:"+[mA,_A,vA].join("|")+")[\\ufe0e\\ufe0f]?"+yA+")*"),EA="(?:"+[mA+gA+"?",gA,_A,vA,pA].join("|")+")",TA=RegExp(fA+"(?="+fA+")|"+EA+bA,"g");var RA=function(t){for(var e=TA.lastIndex=0;TA.test(t);)++e;return e};var CA=function(t){return hA(t)?RA(t):dA(t)};var xA=function(t){if(null==t)return 0;if(zO(t))return cA(t)?CA(t):t.length;var e=Rk(t);return"[object Map]"==e||"[object Set]"==e?t.size:WO(t).length};var SA=function(t,e,n){var i=CO(t),o=i||SO(t)||PO(t);if(e=Jw(e),null==n){var r=t&&t.constructor;n=o?i?new r:[]:SI(t)&&II(r)?Bk(ak(t)):{}}return(o?uO:Jk)(t,(function(t,i,o){return e(n,t,i,o)})),n},IA=mI?mI.isConcatSpreadable:void 0;var OA=function(t){return CO(t)||RO(t)||!!(IA&&t&&t[IA])};var kA=function t(e,n,i,o,r){var s=-1,a=e.length;for(i||(i=OA),r||(r=[]);++s<a;){var l=e[s];n>0&&i(l)?n>1?t(l,n-1,i,o,r):sk(r,l):o||(r[r.length]=l)}return r};var wA=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)},AA=Math.max;var DA=function(t,e,n){return e=AA(void 0===e?t.length-1:e,0),function(){for(var i=arguments,o=-1,r=AA(i.length-e,0),s=Array(r);++o<r;)s[o]=i[e+o];o=-1;for(var a=Array(e+1);++o<e;)a[o]=i[o];return a[e]=n(s),wA(t,this,a)}},NA=hO?function(t,e){return hO(t,"toString",{configurable:!0,enumerable:!1,value:Kk(e),writable:!0})}:Zk,LA=Date.now;var PA=function(t){var e=0,n=0;return function(){var i=LA(),o=16-(i-n);if(n=i,o>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(NA);var MA=function(t,e){return PA(DA(t,e,Zk),t+"")};var BA=function(t,e,n,i){for(var o=t.length,r=n+(i?1:-1);i?r--:++r<o;)if(e(t[r],r,t))return r;return-1};var FA=function(t){return t!=t};var HA=function(t,e,n){for(var i=n-1,o=t.length;++i<o;)if(t[i]===e)return i;return-1};var UA=function(t,e,n){return e==e?HA(t,e,n):BA(t,FA,n)};var VA=function(t,e){return!!(null==t?0:t.length)&&UA(t,e,0)>-1};var GA=function(t,e,n){for(var i=-1,o=null==t?0:t.length;++i<o;)if(n(e,t[i]))return!0;return!1};var WA=function(){},zA=fk&&1/uw(new fk([,-0]))[1]==1/0?function(t){return new fk(t)}:WA;var XA=function(t,e,n){var i=-1,o=VA,r=t.length,s=!0,a=[],l=a;if(n)s=!1,o=GA;else if(r>=200){var c=e?null:zA(t);if(c)return uw(c);s=!1,o=lw,l=new sw}else l=e?[]:a;t:for(;++i<r;){var d=t[i],u=e?e(d):d;if(d=n||0!==d?d:0,s&&u==u){for(var h=l.length;h--;)if(l[h]===u)continue t;e&&l.push(u),a.push(d)}else o(l,u,n)||(l!==a&&l.push(u),a.push(d))}return a};var jA=function(t){return vO(t)&&zO(t)},YA=MA((function(t){return XA(kA(t,1,jA,!0))}));var KA=function(t,e){return Lw(e,(function(e){return t[e]}))};var $A,JA=function(t){return null==t?[]:KA(t,XO(t))};try{$A={clone:Yk,constant:Kk,each:ew,filter:qw,has:tA,isArray:CO,isEmpty:nA,isFunction:II,isUndefined:iA,keys:XO,map:rA,reduce:lA,size:xA,transform:SA,union:YA,values:JA}}catch(t){}$A||($A=window._);var qA=$A,ZA=QA;function QA(t){this._isDirected=!qA.has(t,"directed")||t.directed,this._isMultigraph=!!qA.has(t,"multigraph")&&t.multigraph,this._isCompound=!!qA.has(t,"compound")&&t.compound,this._label=void 0,this._defaultNodeLabelFn=qA.constant(void 0),this._defaultEdgeLabelFn=qA.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children["\0"]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function tD(t,e){t[e]?t[e]++:t[e]=1}function eD(t,e){--t[e]||delete t[e]}function nD(t,e,n,i){var o=""+e,r=""+n;if(!t&&o>r){var s=o;o=r,r=s}return o+""+r+""+(qA.isUndefined(i)?"\0":i)}function iD(t,e,n,i){var o=""+e,r=""+n;if(!t&&o>r){var s=o;o=r,r=s}var a={v:o,w:r};return i&&(a.name=i),a}function oD(t,e){return nD(t,e.v,e.w,e.name)}QA.prototype._nodeCount=0,QA.prototype._edgeCount=0,QA.prototype.isDirected=function(){return this._isDirected},QA.prototype.isMultigraph=function(){return this._isMultigraph},QA.prototype.isCompound=function(){return this._isCompound},QA.prototype.setGraph=function(t){return this._label=t,this},QA.prototype.graph=function(){return this._label},QA.prototype.setDefaultNodeLabel=function(t){return qA.isFunction(t)||(t=qA.constant(t)),this._defaultNodeLabelFn=t,this},QA.prototype.nodeCount=function(){return this._nodeCount},QA.prototype.nodes=function(){return qA.keys(this._nodes)},QA.prototype.sources=function(){var t=this;return qA.filter(this.nodes(),(function(e){return qA.isEmpty(t._in[e])}))},QA.prototype.sinks=function(){var t=this;return qA.filter(this.nodes(),(function(e){return qA.isEmpty(t._out[e])}))},QA.prototype.setNodes=function(t,e){var n=arguments,i=this;return qA.each(t,(function(t){n.length>1?i.setNode(t,e):i.setNode(t)})),this},QA.prototype.setNode=function(t,e){return qA.has(this._nodes,t)?(arguments.length>1&&(this._nodes[t]=e),this):(this._nodes[t]=arguments.length>1?e:this._defaultNodeLabelFn(t),this._isCompound&&(this._parent[t]="\0",this._children[t]={},this._children["\0"][t]=!0),this._in[t]={},this._preds[t]={},this._out[t]={},this._sucs[t]={},++this._nodeCount,this)},QA.prototype.node=function(t){return this._nodes[t]},QA.prototype.hasNode=function(t){return qA.has(this._nodes,t)},QA.prototype.removeNode=function(t){var e=this;if(qA.has(this._nodes,t)){var n=function(t){e.removeEdge(e._edgeObjs[t])};delete this._nodes[t],this._isCompound&&(this._removeFromParentsChildList(t),delete this._parent[t],qA.each(this.children(t),(function(t){e.setParent(t)})),delete this._children[t]),qA.each(qA.keys(this._in[t]),n),delete this._in[t],delete this._preds[t],qA.each(qA.keys(this._out[t]),n),delete this._out[t],delete this._sucs[t],--this._nodeCount}return this},QA.prototype.setParent=function(t,e){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(qA.isUndefined(e))e="\0";else{for(var n=e+="";!qA.isUndefined(n);n=this.parent(n))if(n===t)throw new Error("Setting "+e+" as parent of "+t+" would create a cycle");this.setNode(e)}return this.setNode(t),this._removeFromParentsChildList(t),this._parent[t]=e,this._children[e][t]=!0,this},QA.prototype._removeFromParentsChildList=function(t){delete this._children[this._parent[t]][t]},QA.prototype.parent=function(t){if(this._isCompound){var e=this._parent[t];if("\0"!==e)return e}},QA.prototype.children=function(t){if(qA.isUndefined(t)&&(t="\0"),this._isCompound){var e=this._children[t];if(e)return qA.keys(e)}else{if("\0"===t)return this.nodes();if(this.hasNode(t))return[]}},QA.prototype.predecessors=function(t){var e=this._preds[t];if(e)return qA.keys(e)},QA.prototype.successors=function(t){var e=this._sucs[t];if(e)return qA.keys(e)},QA.prototype.neighbors=function(t){var e=this.predecessors(t);if(e)return qA.union(e,this.successors(t))},QA.prototype.isLeaf=function(t){return 0===(this.isDirected()?this.successors(t):this.neighbors(t)).length},QA.prototype.filterNodes=function(t){var e=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});e.setGraph(this.graph());var n=this;qA.each(this._nodes,(function(n,i){t(i)&&e.setNode(i,n)})),qA.each(this._edgeObjs,(function(t){e.hasNode(t.v)&&e.hasNode(t.w)&&e.setEdge(t,n.edge(t))}));var i={};function o(t){var r=n.parent(t);return void 0===r||e.hasNode(r)?(i[t]=r,r):r in i?i[r]:o(r)}return this._isCompound&&qA.each(e.nodes(),(function(t){e.setParent(t,o(t))})),e},QA.prototype.setDefaultEdgeLabel=function(t){return qA.isFunction(t)||(t=qA.constant(t)),this._defaultEdgeLabelFn=t,this},QA.prototype.edgeCount=function(){return this._edgeCount},QA.prototype.edges=function(){return qA.values(this._edgeObjs)},QA.prototype.setPath=function(t,e){var n=this,i=arguments;return qA.reduce(t,(function(t,o){return i.length>1?n.setEdge(t,o,e):n.setEdge(t,o),o})),this},QA.prototype.setEdge=function(){var t,e,n,i,o=!1,r=arguments[0];"object"==typeof r&&null!==r&&"v"in r?(t=r.v,e=r.w,n=r.name,2===arguments.length&&(i=arguments[1],o=!0)):(t=r,e=arguments[1],n=arguments[3],arguments.length>2&&(i=arguments[2],o=!0)),t=""+t,e=""+e,qA.isUndefined(n)||(n=""+n);var s=nD(this._isDirected,t,e,n);if(qA.has(this._edgeLabels,s))return o&&(this._edgeLabels[s]=i),this;if(!qA.isUndefined(n)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(t),this.setNode(e),this._edgeLabels[s]=o?i:this._defaultEdgeLabelFn(t,e,n);var a=iD(this._isDirected,t,e,n);return t=a.v,e=a.w,Object.freeze(a),this._edgeObjs[s]=a,tD(this._preds[e],t),tD(this._sucs[t],e),this._in[e][s]=a,this._out[t][s]=a,this._edgeCount++,this},QA.prototype.edge=function(t,e,n){var i=1===arguments.length?oD(this._isDirected,arguments[0]):nD(this._isDirected,t,e,n);return this._edgeLabels[i]},QA.prototype.hasEdge=function(t,e,n){var i=1===arguments.length?oD(this._isDirected,arguments[0]):nD(this._isDirected,t,e,n);return qA.has(this._edgeLabels,i)},QA.prototype.removeEdge=function(t,e,n){var i=1===arguments.length?oD(this._isDirected,arguments[0]):nD(this._isDirected,t,e,n),o=this._edgeObjs[i];return o&&(t=o.v,e=o.w,delete this._edgeLabels[i],delete this._edgeObjs[i],eD(this._preds[e],t),eD(this._sucs[t],e),delete this._in[e][i],delete this._out[t][i],this._edgeCount--),this},QA.prototype.inEdges=function(t,e){var n=this._in[t];if(n){var i=qA.values(n);return e?qA.filter(i,(function(t){return t.v===e})):i}},QA.prototype.outEdges=function(t,e){var n=this._out[t];if(n){var i=qA.values(n);return e?qA.filter(i,(function(t){return t.w===e})):i}},QA.prototype.nodeEdges=function(t,e){var n=this.inEdges(t,e);if(n)return n.concat(this.outEdges(t,e))};var rD={Graph:ZA,version:"2.1.8"},sD={write:function(t){var e={options:{directed:t.isDirected(),multigraph:t.isMultigraph(),compound:t.isCompound()},nodes:aD(t),edges:lD(t)};qA.isUndefined(t.graph())||(e.value=qA.clone(t.graph()));return e},read:function(t){var e=new ZA(t.options).setGraph(t.value);return qA.each(t.nodes,(function(t){e.setNode(t.v,t.value),t.parent&&e.setParent(t.v,t.parent)})),qA.each(t.edges,(function(t){e.setEdge({v:t.v,w:t.w,name:t.name},t.value)})),e}};function aD(t){return qA.map(t.nodes(),(function(e){var n=t.node(e),i=t.parent(e),o={v:e};return qA.isUndefined(n)||(o.value=n),qA.isUndefined(i)||(o.parent=i),o}))}function lD(t){return qA.map(t.edges(),(function(e){var n=t.edge(e),i={v:e.v,w:e.w};return qA.isUndefined(e.name)||(i.name=e.name),qA.isUndefined(n)||(i.value=n),i}))}var cD=function(t){var e,n={},i=[];function o(i){qA.has(n,i)||(n[i]=!0,e.push(i),qA.each(t.successors(i),o),qA.each(t.predecessors(i),o))}return qA.each(t.nodes(),(function(t){e=[],o(t),e.length&&i.push(e)})),i};var dD=uD;function uD(){this._arr=[],this._keyIndices={}}uD.prototype.size=function(){return this._arr.length},uD.prototype.keys=function(){return this._arr.map((function(t){return t.key}))},uD.prototype.has=function(t){return qA.has(this._keyIndices,t)},uD.prototype.priority=function(t){var e=this._keyIndices[t];if(void 0!==e)return this._arr[e].priority},uD.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},uD.prototype.add=function(t,e){var n=this._keyIndices;if(t=String(t),!qA.has(n,t)){var i=this._arr,o=i.length;return n[t]=o,i.push({key:t,priority:e}),this._decrease(o),!0}return!1},uD.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key},uD.prototype.decrease=function(t,e){var n=this._keyIndices[t];if(e>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[n].priority+" New: "+e);this._arr[n].priority=e,this._decrease(n)},uD.prototype._heapify=function(t){var e=this._arr,n=2*t,i=n+1,o=t;n<e.length&&(o=e[n].priority<e[o].priority?n:o,i<e.length&&(o=e[i].priority<e[o].priority?i:o),o!==t&&(this._swap(t,o),this._heapify(o)))},uD.prototype._decrease=function(t){for(var e,n=this._arr,i=n[t].priority;0!==t&&!(n[e=t>>1].priority<i);)this._swap(t,e),t=e},uD.prototype._swap=function(t,e){var n=this._arr,i=this._keyIndices,o=n[t],r=n[e];n[t]=r,n[e]=o,i[r.key]=t,i[o.key]=e};var hD=function(t,e,n,i){return function(t,e,n,i){var o,r,s={},a=new dD,l=function(t){var e=t.v!==o?t.v:t.w,i=s[e],l=n(t),c=r.distance+l;if(l<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+t+" Weight: "+l);c<i.distance&&(i.distance=c,i.predecessor=o,a.decrease(e,c))};t.nodes().forEach((function(t){var n=t===e?0:Number.POSITIVE_INFINITY;s[t]={distance:n},a.add(t,n)}));for(;a.size()>0&&(o=a.removeMin(),(r=s[o]).distance!==Number.POSITIVE_INFINITY);)i(o).forEach(l);return s}(t,String(e),n||pD,i||function(e){return t.outEdges(e)})},pD=qA.constant(1);var gD=function(t,e,n){return qA.transform(t.nodes(),(function(i,o){i[o]=hD(t,o,e,n)}),{})};var fD=function(t){var e=0,n=[],i={},o=[];function r(s){var a=i[s]={onStack:!0,lowlink:e,index:e++};if(n.push(s),t.successors(s).forEach((function(t){qA.has(i,t)?i[t].onStack&&(a.lowlink=Math.min(a.lowlink,i[t].index)):(r(t),a.lowlink=Math.min(a.lowlink,i[t].lowlink))})),a.lowlink===a.index){var l,c=[];do{l=n.pop(),i[l].onStack=!1,c.push(l)}while(s!==l);o.push(c)}}return t.nodes().forEach((function(t){qA.has(i,t)||r(t)})),o};var mD=function(t){return qA.filter(fD(t),(function(e){return e.length>1||1===e.length&&t.hasEdge(e[0],e[0])}))};var _D=function(t,e,n){return function(t,e,n){var i={},o=t.nodes();return o.forEach((function(t){i[t]={},i[t][t]={distance:0},o.forEach((function(e){t!==e&&(i[t][e]={distance:Number.POSITIVE_INFINITY})})),n(t).forEach((function(n){var o=n.v===t?n.w:n.v,r=e(n);i[t][o]={distance:r,predecessor:t}}))})),o.forEach((function(t){var e=i[t];o.forEach((function(n){var r=i[n];o.forEach((function(n){var i=r[t],o=e[n],s=r[n],a=i.distance+o.distance;a<s.distance&&(s.distance=a,s.predecessor=o.predecessor)}))}))})),i}(t,e||vD,n||function(e){return t.outEdges(e)})},vD=qA.constant(1);var yD=bD;function bD(t){var e={},n={},i=[];if(qA.each(t.sinks(),(function o(r){if(qA.has(n,r))throw new ED;qA.has(e,r)||(n[r]=!0,e[r]=!0,qA.each(t.predecessors(r),o),delete n[r],i.push(r))})),qA.size(e)!==t.nodeCount())throw new ED;return i}function ED(){}bD.CycleException=ED,ED.prototype=new Error;var TD=function(t,e,n){qA.isArray(e)||(e=[e]);var i=(t.isDirected()?t.successors:t.neighbors).bind(t),o=[],r={};return qA.each(e,(function(e){if(!t.hasNode(e))throw new Error("Graph does not have node: "+e);RD(t,e,"post"===n,r,i,o)})),o};function RD(t,e,n,i,o,r){qA.has(i,e)||(i[e]=!0,n||r.push(e),qA.each(o(e),(function(e){RD(t,e,n,i,o,r)})),n&&r.push(e))}var CD,xD={Graph:rD.Graph,json:sD,alg:{components:cD,dijkstra:hD,dijkstraAll:gD,findCycles:mD,floydWarshall:_D,isAcyclic:function(t){try{yD(t)}catch(t){if(t instanceof yD.CycleException)return!1;throw t}return!0},postorder:function(t,e){return TD(t,e,"post")},preorder:function(t,e){return TD(t,e,"pre")},prim:function(t,e){var n,i=new ZA,o={},r=new dD;function s(t){var i=t.v===n?t.w:t.v,s=r.priority(i);if(void 0!==s){var a=e(t);a<s&&(o[i]=n,r.decrease(i,a))}}if(0===t.nodeCount())return i;qA.each(t.nodes(),(function(t){r.add(t,Number.POSITIVE_INFINITY),i.setNode(t)})),r.decrease(t.nodes()[0],0);var a=!1;for(;r.size()>0;){if(n=r.removeMin(),qA.has(o,n))i.setEdge(n,o[n]);else{if(a)throw new Error("Input graph is not connected: "+t);a=!0}t.nodeEdges(n).forEach(s)}return i},tarjan:fD,topsort:yD},version:rD.version};try{CD=xD}catch(t){}CD||(CD=window.graphlib);var SD=CD;var ID=function(t){return jk(t,5)};var OD=function(t,e,n){if(!SI(n))return!1;var i=typeof e;return!!("number"==i?zO(n)&&OO(e,n.length):"string"==i&&e in n)&&tI(n[e],t)},kD=Object.prototype,wD=kD.hasOwnProperty,AD=MA((function(t,e){t=Object(t);var n=-1,i=e.length,o=i>2?e[2]:void 0;for(o&&OD(e[0],e[1],o)&&(i=1);++n<i;)for(var r=e[n],s=JO(r),a=-1,l=s.length;++a<l;){var c=s[a],d=t[c];(void 0===d||tI(d,kD[c])&&!wD.call(t,c))&&(t[c]=r[c])}return t}));var DD=function(t){return function(e,n,i){var o=Object(e);if(!zO(e)){var r=Jw(n);e=XO(e),n=function(t){return r(o[t],t,o)}}var s=t(e,n,i);return s>-1?o[r?e[s]:s]:void 0}},ND=/\s/;var LD=function(t){for(var e=t.length;e--&&ND.test(t.charAt(e)););return e},PD=/^\s+/;var MD=function(t){return t?t.slice(0,LD(t)+1).replace(PD,""):t},BD=/^[-+]0x[0-9a-f]+$/i,FD=/^0b[01]+$/i,HD=/^0o[0-7]+$/i,UD=parseInt;var VD=function(t){if("number"==typeof t)return t;if(xw(t))return NaN;if(SI(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=SI(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=MD(t);var n=FD.test(t);return n||HD.test(t)?UD(t.slice(2),n?2:8):BD.test(t)?NaN:+t};var GD=function(t){return t?Infinity===(t=VD(t))||-Infinity===t?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0};var WD=function(t){var e=GD(t),n=e%1;return e==e?n?e-n:e:0},zD=Math.max;var XD=DD((function(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var o=null==n?0:WD(n);return o<0&&(o=zD(i+o,0)),BA(t,Jw(e),o)}));var jD=function(t){return(null==t?0:t.length)?kA(t,1):[]};var YD=function(t,e){return null==t?t:$k(t,Qk(e),JO)};var KD=function(t){var e=null==t?0:t.length;return e?t[e-1]:void 0};var $D=function(t,e){var n={};return e=Jw(e),Jk(t,(function(t,i,o){pO(n,i,e(t,i,o))})),n};var JD=function(t,e,n){for(var i=-1,o=t.length;++i<o;){var r=t[i],s=e(r);if(null!=s&&(void 0===a?s==s&&!xw(s):n(s,a)))var a=s,l=r}return l};var qD=function(t,e){return t>e};var ZD=function(t){return t&&t.length?JD(t,Zk,qD):void 0};var QD=function(t,e,n){(void 0!==n&&!tI(t[e],n)||void 0===n&&!(e in t))&&pO(t,e,n)},tN=Function.prototype,eN=Object.prototype,nN=tN.toString,iN=eN.hasOwnProperty,oN=nN.call(Object);var rN=function(t){if(!vO(t)||"[object Object]"!=xI(t))return!1;var e=ak(t);if(null===e)return!0;var n=iN.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&nN.call(n)==oN};var sN=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]};var aN=function(t){return mO(t,JO(t))};var lN=function(t,e,n,i,o,r,s){var a=sN(t,n),l=sN(e,n),c=s.get(l);if(c)QD(t,n,c);else{var d=r?r(a,l,n+"",t,e,s):void 0,u=void 0===d;if(u){var h=CO(l),p=!h&&SO(l),g=!h&&!p&&PO(l);d=l,h||p||g?CO(a)?d=a:jA(a)?d=QO(a):p?(u=!1,d=ZO(l,!0)):g?(u=!1,d=Lk(l,!0)):d=[]:rN(l)||RO(l)?(d=a,RO(a)?d=aN(a):SI(a)&&!II(a)||(d=Fk(l))):u=!1}u&&(s.set(l,d),o(d,l,i,r,s),s.delete(l)),QD(t,n,d)}};var cN=function t(e,n,i,o,r){e!==n&&$k(n,(function(s,a){if(r||(r=new dO),SI(s))lN(e,n,a,i,t,o,r);else{var l=o?o(sN(e,a),s,a+"",e,n,r):void 0;void 0===l&&(l=s),QD(e,a,l)}}),JO)};var dN=function(t){return MA((function(e,n){var i=-1,o=n.length,r=o>1?n[o-1]:void 0,s=o>2?n[2]:void 0;for(r=t.length>3&&"function"==typeof r?(o--,r):void 0,s&&OD(n[0],n[1],s)&&(r=o<3?void 0:r,o=1),e=Object(e);++i<o;){var a=n[i];a&&t(e,a,i,r)}return e}))}((function(t,e,n){cN(t,e,n)}));var uN=function(t,e){return t<e};var hN=function(t){return t&&t.length?JD(t,Zk,uN):void 0};var pN=function(t,e){return t&&t.length?JD(t,Jw(e),uN):void 0},gN=function(){return fI.Date.now()};var fN=function(t,e,n,i){if(!SI(t))return t;for(var o=-1,r=(e=Hw(e,t)).length,s=r-1,a=t;null!=a&&++o<r;){var l=Uw(e[o]),c=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return t;if(o!=s){var d=a[l];void 0===(c=i?i(d,l,a):void 0)&&(c=SI(d)?d:OO(e[o+1])?[]:{})}fO(a,l,c),a=a[l]}return t};var mN=function(t,e,n){for(var i=-1,o=e.length,r={};++i<o;){var s=e[i],a=Vw(t,s);n(a,s)&&fN(r,Hw(s,t),a)}return r};var _N=function(t,e){return mN(t,e,(function(e,n){return Xw(t,n)}))};var vN=function(t){return PA(DA(t,void 0,jD),t+"")}((function(t,e){return null==t?{}:_N(t,e)})),yN=Math.ceil,bN=Math.max;var EN=function(t,e,n,i){for(var o=-1,r=bN(yN((e-t)/(n||1)),0),s=Array(r);r--;)s[i?r:++o]=t,t+=n;return s};var TN=function(t){return function(e,n,i){return i&&"number"!=typeof i&&OD(e,n,i)&&(n=i=void 0),e=GD(e),void 0===n?(n=e,e=0):n=GD(n),i=void 0===i?e<n?1:-1:GD(i),EN(e,n,i,t)}}();var RN=function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t};var CN=function(t,e){if(t!==e){var n=void 0!==t,i=null===t,o=t==t,r=xw(t),s=void 0!==e,a=null===e,l=e==e,c=xw(e);if(!a&&!c&&!r&&t>e||r&&s&&l&&!a&&!c||i&&s&&l||!n&&l||!o)return 1;if(!i&&!r&&!c&&t<e||c&&n&&o&&!i&&!r||a&&n&&o||!s&&o||!l)return-1}return 0};var xN=function(t,e,n){for(var i=-1,o=t.criteria,r=e.criteria,s=o.length,a=n.length;++i<s;){var l=CN(o[i],r[i]);if(l)return i>=a?l:l*("desc"==n[i]?-1:1)}return t.index-e.index};var SN=function(t,e,n){e=e.length?Lw(e,(function(t){return CO(t)?function(e){return Vw(e,1===t.length?t[0]:t)}:t})):[Zk];var i=-1;e=Lw(e,DO(Jw));var o=oA(t,(function(t,n,o){return{criteria:Lw(e,(function(e){return e(t)})),index:++i,value:t}}));return RN(o,(function(t,e){return xN(t,e,n)}))},IN=MA((function(t,e){if(null==t)return[];var n=e.length;return n>1&&OD(t,e[0],e[1])?e=[]:n>2&&OD(e[0],e[1],e[2])&&(e=[e[0]]),SN(t,kA(e,1),[])})),ON=0;var kN=function(t){var e=++ON;return Fw(t)+e};var wN=function(t,e,n){for(var i=-1,o=t.length,r=e.length,s={};++i<o;){var a=i<r?e[i]:void 0;n(s,t[i],a)}return s};var AN,DN=function(t,e){return wN(t||[],e||[],fO)};try{AN={cloneDeep:ID,constant:Kk,defaults:AD,each:ew,filter:qw,find:XD,flatten:jD,forEach:tw,forIn:YD,has:tA,isUndefined:iA,last:KD,map:rA,mapValues:$D,max:ZD,merge:dN,min:hN,minBy:pN,now:gN,pick:vN,range:TN,reduce:lA,sortBy:IN,uniqueId:kN,values:JA,zipObject:DN}}catch(t){}AN||(AN=window._);var NN=AN,LN=PN;function PN(){var t={};t._next=t._prev=t,this._sentinel=t}function MN(t){t._prev._next=t._next,t._next._prev=t._prev,delete t._next,delete t._prev}function BN(t,e){if("_next"!==t&&"_prev"!==t)return e}PN.prototype.dequeue=function(){var t=this._sentinel,e=t._prev;if(e!==t)return MN(e),e},PN.prototype.enqueue=function(t){var e=this._sentinel;t._prev&&t._next&&MN(t),t._next=e._next,e._next._prev=t,e._next=t,t._prev=e},PN.prototype.toString=function(){for(var t=[],e=this._sentinel,n=e._prev;n!==e;)t.push(JSON.stringify(n,BN)),n=n._prev;return"["+t.join(", ")+"]"};var FN=SD.Graph,HN=function(t,e){if(t.nodeCount()<=1)return[];var n=function(t,e){var n=new FN,i=0,o=0;NN.forEach(t.nodes(),(function(t){n.setNode(t,{v:t,in:0,out:0})})),NN.forEach(t.edges(),(function(t){var r=n.edge(t.v,t.w)||0,s=e(t),a=r+s;n.setEdge(t.v,t.w,a),o=Math.max(o,n.node(t.v).out+=s),i=Math.max(i,n.node(t.w).in+=s)}));var r=NN.range(o+i+3).map((function(){return new LN})),s=i+1;return NN.forEach(n.nodes(),(function(t){GN(r,s,n.node(t))})),{graph:n,buckets:r,zeroIdx:s}}(t,e||UN),i=function(t,e,n){var i,o=[],r=e[e.length-1],s=e[0];for(;t.nodeCount();){for(;i=s.dequeue();)VN(t,e,n,i);for(;i=r.dequeue();)VN(t,e,n,i);if(t.nodeCount())for(var a=e.length-2;a>0;--a)if(i=e[a].dequeue()){o=o.concat(VN(t,e,n,i,!0));break}}return o}(n.graph,n.buckets,n.zeroIdx);return NN.flatten(NN.map(i,(function(e){return t.outEdges(e.v,e.w)})),!0)},UN=NN.constant(1);function VN(t,e,n,i,o){var r=o?[]:void 0;return NN.forEach(t.inEdges(i.v),(function(i){var s=t.edge(i),a=t.node(i.v);o&&r.push({v:i.v,w:i.w}),a.out-=s,GN(e,n,a)})),NN.forEach(t.outEdges(i.v),(function(i){var o=t.edge(i),r=i.w,s=t.node(r);s.in-=o,GN(e,n,s)})),t.removeNode(i.v),r}function GN(t,e,n){n.out?n.in?t[n.out-n.in+e].enqueue(n):t[t.length-1].enqueue(n):t[0].enqueue(n)}var WN={run:function(t){var e="greedy"===t.graph().acyclicer?HN(t,function(t){return function(e){return t.edge(e).weight}}(t)):function(t){var e=[],n={},i={};function o(r){NN.has(i,r)||(i[r]=!0,n[r]=!0,NN.forEach(t.outEdges(r),(function(t){NN.has(n,t.w)?e.push(t):o(t.w)})),delete n[r])}return NN.forEach(t.nodes(),o),e}(t);NN.forEach(e,(function(e){var n=t.edge(e);t.removeEdge(e),n.forwardName=e.name,n.reversed=!0,t.setEdge(e.w,e.v,n,NN.uniqueId("rev"))}))},undo:function(t){NN.forEach(t.edges(),(function(e){var n=t.edge(e);if(n.reversed){t.removeEdge(e);var i=n.forwardName;delete n.reversed,delete n.forwardName,t.setEdge(e.w,e.v,n,i)}}))}};var zN=SD.Graph,XN={addDummyNode:jN,simplify:function(t){var e=(new zN).setGraph(t.graph());return NN.forEach(t.nodes(),(function(n){e.setNode(n,t.node(n))})),NN.forEach(t.edges(),(function(n){var i=e.edge(n.v,n.w)||{weight:0,minlen:1},o=t.edge(n);e.setEdge(n.v,n.w,{weight:i.weight+o.weight,minlen:Math.max(i.minlen,o.minlen)})})),e},asNonCompoundGraph:function(t){var e=new zN({multigraph:t.isMultigraph()}).setGraph(t.graph());return NN.forEach(t.nodes(),(function(n){t.children(n).length||e.setNode(n,t.node(n))})),NN.forEach(t.edges(),(function(n){e.setEdge(n,t.edge(n))})),e},successorWeights:function(t){var e=NN.map(t.nodes(),(function(e){var n={};return NN.forEach(t.outEdges(e),(function(e){n[e.w]=(n[e.w]||0)+t.edge(e).weight})),n}));return NN.zipObject(t.nodes(),e)},predecessorWeights:function(t){var e=NN.map(t.nodes(),(function(e){var n={};return NN.forEach(t.inEdges(e),(function(e){n[e.v]=(n[e.v]||0)+t.edge(e).weight})),n}));return NN.zipObject(t.nodes(),e)},intersectRect:function(t,e){var n,i,o=t.x,r=t.y,s=e.x-o,a=e.y-r,l=t.width/2,c=t.height/2;if(!s&&!a)throw new Error("Not possible to find intersection inside of the rectangle");Math.abs(a)*l>Math.abs(s)*c?(a<0&&(c=-c),n=c*s/a,i=c):(s<0&&(l=-l),n=l,i=l*a/s);return{x:o+n,y:r+i}},buildLayerMatrix:function(t){var e=NN.map(NN.range(YN(t)+1),(function(){return[]}));return NN.forEach(t.nodes(),(function(n){var i=t.node(n),o=i.rank;NN.isUndefined(o)||(e[o][i.order]=n)})),e},normalizeRanks:function(t){var e=NN.min(NN.map(t.nodes(),(function(e){return t.node(e).rank})));NN.forEach(t.nodes(),(function(n){var i=t.node(n);NN.has(i,"rank")&&(i.rank-=e)}))},removeEmptyRanks:function(t){var e=NN.min(NN.map(t.nodes(),(function(e){return t.node(e).rank}))),n=[];NN.forEach(t.nodes(),(function(i){var o=t.node(i).rank-e;n[o]||(n[o]=[]),n[o].push(i)}));var i=0,o=t.graph().nodeRankFactor;NN.forEach(n,(function(e,n){NN.isUndefined(e)&&n%o!=0?--i:i&&NN.forEach(e,(function(e){t.node(e).rank+=i}))}))},addBorderNode:function(t,e,n,i){var o={width:0,height:0};arguments.length>=4&&(o.rank=n,o.order=i);return jN(t,"border",o,e)},maxRank:YN,partition:function(t,e){var n={lhs:[],rhs:[]};return NN.forEach(t,(function(t){e(t)?n.lhs.push(t):n.rhs.push(t)})),n},time:function(t,e){var n=NN.now();try{return e()}finally{console.log(t+" time: "+(NN.now()-n)+"ms")}},notime:function(t,e){return e()}};function jN(t,e,n,i){var o;do{o=NN.uniqueId(i)}while(t.hasNode(o));return n.dummy=e,t.setNode(o,n),o}function YN(t){return NN.max(NN.map(t.nodes(),(function(e){var n=t.node(e).rank;if(!NN.isUndefined(n))return n})))}var KN={run:function(t){t.graph().dummyChains=[],NN.forEach(t.edges(),(function(e){!function(t,e){var n,i,o,r=e.v,s=t.node(r).rank,a=e.w,l=t.node(a).rank,c=e.name,d=t.edge(e),u=d.labelRank;if(l===s+1)return;for(t.removeEdge(e),o=0,++s;s<l;++o,++s)d.points=[],i={width:0,height:0,edgeLabel:d,edgeObj:e,rank:s},n=XN.addDummyNode(t,"edge",i,"_d"),s===u&&(i.width=d.width,i.height=d.height,i.dummy="edge-label",i.labelpos=d.labelpos),t.setEdge(r,n,{weight:d.weight},c),0===o&&t.graph().dummyChains.push(n),r=n;t.setEdge(r,a,{weight:d.weight},c)}(t,e)}))},undo:function(t){NN.forEach(t.graph().dummyChains,(function(e){var n,i=t.node(e),o=i.edgeLabel;for(t.setEdge(i.edgeObj,o);i.dummy;)n=t.successors(e)[0],t.removeNode(e),o.points.push({x:i.x,y:i.y}),"edge-label"===i.dummy&&(o.x=i.x,o.y=i.y,o.width=i.width,o.height=i.height),e=n,i=t.node(e)}))}};var $N=function(t){var e={};NN.forEach(t.sources(),(function n(i){var o=t.node(i);if(NN.has(e,i))return o.rank;e[i]=!0;var r=NN.min(NN.map(t.outEdges(i),(function(e){return n(e.w)-t.edge(e).minlen})));return r!==Number.POSITIVE_INFINITY&&null!=r||(r=0),o.rank=r}))},JN=function(t,e){return t.node(e.w).rank-t.node(e.v).rank-t.edge(e).minlen};var qN=SD.Graph,ZN=JN,QN=function(t){var e,n,i=new qN({directed:!1}),o=t.nodes()[0],r=t.nodeCount();i.setNode(o,{});for(;tL(i,t)<r;)e=eL(i,t),n=i.hasNode(e.v)?ZN(t,e):-ZN(t,e),nL(i,t,n);return i};function tL(t,e){return NN.forEach(t.nodes(),(function n(i){NN.forEach(e.nodeEdges(i),(function(o){var r=o.v,s=i===r?o.w:r;t.hasNode(s)||ZN(e,o)||(t.setNode(s,{}),t.setEdge(i,s,{}),n(s))}))})),t.nodeCount()}function eL(t,e){return NN.minBy(e.edges(),(function(n){if(t.hasNode(n.v)!==t.hasNode(n.w))return ZN(e,n)}))}function nL(t,e,n){NN.forEach(t.nodes(),(function(t){e.node(t).rank+=n}))}var iL=JN,oL=$N,rL=SD.alg.preorder,sL=SD.alg.postorder,aL=XN.simplify,lL=cL;function cL(t){t=aL(t),oL(t);var e,n=QN(t);for(hL(n),dL(n,t);e=gL(n);)mL(n,t,e,fL(n,t,e))}function dL(t,e){var n=sL(t,t.nodes());n=n.slice(0,n.length-1),NN.forEach(n,(function(n){!function(t,e,n){var i=t.node(n).parent;t.edge(n,i).cutvalue=uL(t,e,n)}(t,e,n)}))}function uL(t,e,n){var i=t.node(n).parent,o=!0,r=e.edge(n,i),s=0;return r||(o=!1,r=e.edge(i,n)),s=r.weight,NN.forEach(e.nodeEdges(n),(function(r){var a=r.v===n,l=a?r.w:r.v;if(l!==i){var c=a===o,d=e.edge(r).weight;if(s+=c?d:-d,function(t,e,n){return t.hasEdge(e,n)}(t,n,l)){var u=t.edge(n,l).cutvalue;s+=c?-u:u}}})),s}function hL(t,e){arguments.length<2&&(e=t.nodes()[0]),pL(t,{},1,e)}function pL(t,e,n,i,o){var r=n,s=t.node(i);return e[i]=!0,NN.forEach(t.neighbors(i),(function(o){NN.has(e,o)||(n=pL(t,e,n,o,i))})),s.low=r,s.lim=n++,o?s.parent=o:delete s.parent,n}function gL(t){return NN.find(t.edges(),(function(e){return t.edge(e).cutvalue<0}))}function fL(t,e,n){var i=n.v,o=n.w;e.hasEdge(i,o)||(i=n.w,o=n.v);var r=t.node(i),s=t.node(o),a=r,l=!1;r.lim>s.lim&&(a=s,l=!0);var c=NN.filter(e.edges(),(function(e){return l===_L(t,t.node(e.v),a)&&l!==_L(t,t.node(e.w),a)}));return NN.minBy(c,(function(t){return iL(e,t)}))}function mL(t,e,n,i){var o=n.v,r=n.w;t.removeEdge(o,r),t.setEdge(i.v,i.w,{}),hL(t),dL(t,e),function(t,e){var n=NN.find(t.nodes(),(function(t){return!e.node(t).parent})),i=rL(t,n);i=i.slice(1),NN.forEach(i,(function(n){var i=t.node(n).parent,o=e.edge(n,i),r=!1;o||(o=e.edge(i,n),r=!0),e.node(n).rank=e.node(i).rank+(r?o.minlen:-o.minlen)}))}(t,e)}function _L(t,e,n){return n.low<=e.lim&&e.lim<=n.lim}cL.initLowLimValues=hL,cL.initCutValues=dL,cL.calcCutValue=uL,cL.leaveEdge=gL,cL.enterEdge=fL,cL.exchangeEdges=mL;var vL=$N,yL=function(t){switch(t.graph().ranker){case"network-simplex":EL(t);break;case"tight-tree":!function(t){vL(t),QN(t)}(t);break;case"longest-path":bL(t);break;default:EL(t)}};var bL=vL;function EL(t){lL(t)}var TL=function(t){var e=function(t){var e={},n=0;function i(o){var r=n;NN.forEach(t.children(o),i),e[o]={low:r,lim:n++}}return NN.forEach(t.children(),i),e}(t);NN.forEach(t.graph().dummyChains,(function(n){for(var i=t.node(n),o=i.edgeObj,r=function(t,e,n,i){var o,r,s=[],a=[],l=Math.min(e[n].low,e[i].low),c=Math.max(e[n].lim,e[i].lim);o=n;do{o=t.parent(o),s.push(o)}while(o&&(e[o].low>l||c>e[o].lim));r=o,o=i;for(;(o=t.parent(o))!==r;)a.push(o);return{path:s.concat(a.reverse()),lca:r}}(t,e,o.v,o.w),s=r.path,a=r.lca,l=0,c=s[l],d=!0;n!==o.w;){if(i=t.node(n),d){for(;(c=s[l])!==a&&t.node(c).maxRank<i.rank;)l++;c===a&&(d=!1)}if(!d){for(;l<s.length-1&&t.node(c=s[l+1]).minRank<=i.rank;)l++;c=s[l]}t.setParent(n,c),n=t.successors(n)[0]}}))};var RL={run:function(t){var e=XN.addDummyNode(t,"root",{},"_root"),n=function(t){var e={};function n(i,o){var r=t.children(i);r&&r.length&&NN.forEach(r,(function(t){n(t,o+1)})),e[i]=o}return NN.forEach(t.children(),(function(t){n(t,1)})),e}(t),i=NN.max(NN.values(n))-1,o=2*i+1;t.graph().nestingRoot=e,NN.forEach(t.edges(),(function(e){t.edge(e).minlen*=o}));var r=function(t){return NN.reduce(t.edges(),(function(e,n){return e+t.edge(n).weight}),0)}(t)+1;NN.forEach(t.children(),(function(s){CL(t,e,o,r,i,n,s)})),t.graph().nodeRankFactor=o},cleanup:function(t){var e=t.graph();t.removeNode(e.nestingRoot),delete e.nestingRoot,NN.forEach(t.edges(),(function(e){t.edge(e).nestingEdge&&t.removeEdge(e)}))}};function CL(t,e,n,i,o,r,s){var a=t.children(s);if(a.length){var l=XN.addBorderNode(t,"_bt"),c=XN.addBorderNode(t,"_bb"),d=t.node(s);t.setParent(l,s),d.borderTop=l,t.setParent(c,s),d.borderBottom=c,NN.forEach(a,(function(a){CL(t,e,n,i,o,r,a);var d=t.node(a),u=d.borderTop?d.borderTop:a,h=d.borderBottom?d.borderBottom:a,p=d.borderTop?i:2*i,g=u!==h?1:o-r[s]+1;t.setEdge(l,u,{weight:p,minlen:g,nestingEdge:!0}),t.setEdge(h,c,{weight:p,minlen:g,nestingEdge:!0})})),t.parent(s)||t.setEdge(e,l,{weight:0,minlen:o+r[s]})}else s!==e&&t.setEdge(e,s,{weight:0,minlen:n})}var xL=function(t){NN.forEach(t.children(),(function e(n){var i=t.children(n),o=t.node(n);if(i.length&&NN.forEach(i,e),NN.has(o,"minRank")){o.borderLeft=[],o.borderRight=[];for(var r=o.minRank,s=o.maxRank+1;r<s;++r)SL(t,"borderLeft","_bl",n,o,r),SL(t,"borderRight","_br",n,o,r)}}))};function SL(t,e,n,i,o,r){var s={width:0,height:0,rank:r,borderType:e},a=o[e][r-1],l=XN.addDummyNode(t,"border",s,n);o[e][r]=l,t.setParent(l,i),a&&t.setEdge(a,l,{weight:1})}var IL={adjust:function(t){var e=t.graph().rankdir.toLowerCase();"lr"!==e&&"rl"!==e||OL(t)},undo:function(t){var e=t.graph().rankdir.toLowerCase();"bt"!==e&&"rl"!==e||function(t){NN.forEach(t.nodes(),(function(e){wL(t.node(e))})),NN.forEach(t.edges(),(function(e){var n=t.edge(e);NN.forEach(n.points,wL),NN.has(n,"y")&&wL(n)}))}(t);"lr"!==e&&"rl"!==e||(!function(t){NN.forEach(t.nodes(),(function(e){AL(t.node(e))})),NN.forEach(t.edges(),(function(e){var n=t.edge(e);NN.forEach(n.points,AL),NN.has(n,"x")&&AL(n)}))}(t),OL(t))}};function OL(t){NN.forEach(t.nodes(),(function(e){kL(t.node(e))})),NN.forEach(t.edges(),(function(e){kL(t.edge(e))}))}function kL(t){var e=t.width;t.width=t.height,t.height=e}function wL(t){t.y=-t.y}function AL(t){var e=t.x;t.x=t.y,t.y=e}var DL=function(t){var e={},n=NN.filter(t.nodes(),(function(e){return!t.children(e).length})),i=NN.max(NN.map(n,(function(e){return t.node(e).rank}))),o=NN.map(NN.range(i+1),(function(){return[]}));function r(n){if(!NN.has(e,n)){e[n]=!0;var i=t.node(n);o[i.rank].push(n),NN.forEach(t.successors(n),r)}}var s=NN.sortBy(n,(function(e){return t.node(e).rank}));return NN.forEach(s,r),o};var NL=function(t,e){for(var n=0,i=1;i<e.length;++i)n+=LL(t,e[i-1],e[i]);return n};function LL(t,e,n){for(var i=NN.zipObject(n,NN.map(n,(function(t,e){return e}))),o=NN.flatten(NN.map(e,(function(e){return NN.sortBy(NN.map(t.outEdges(e),(function(e){return{pos:i[e.w],weight:t.edge(e).weight}})),"pos")})),!0),r=1;r<n.length;)r<<=1;var s=2*r-1;r-=1;var a=NN.map(new Array(s),(function(){return 0})),l=0;return NN.forEach(o.forEach((function(t){var e=t.pos+r;a[e]+=t.weight;for(var n=0;e>0;)e%2&&(n+=a[e+1]),a[e=e-1>>1]+=t.weight;l+=t.weight*n}))),l}var PL=function(t,e){return NN.map(e,(function(e){var n=t.inEdges(e);if(n.length){var i=NN.reduce(n,(function(e,n){var i=t.edge(n),o=t.node(n.v);return{sum:e.sum+i.weight*o.order,weight:e.weight+i.weight}}),{sum:0,weight:0});return{v:e,barycenter:i.sum/i.weight,weight:i.weight}}return{v:e}}))};var ML=function(t,e){var n={};return NN.forEach(t,(function(t,e){var i=n[t.v]={indegree:0,in:[],out:[],vs:[t.v],i:e};NN.isUndefined(t.barycenter)||(i.barycenter=t.barycenter,i.weight=t.weight)})),NN.forEach(e.edges(),(function(t){var e=n[t.v],i=n[t.w];NN.isUndefined(e)||NN.isUndefined(i)||(i.indegree++,e.out.push(n[t.w]))})),function(t){var e=[];function n(t){return function(e){e.merged||(NN.isUndefined(e.barycenter)||NN.isUndefined(t.barycenter)||e.barycenter>=t.barycenter)&&function(t,e){var n=0,i=0;t.weight&&(n+=t.barycenter*t.weight,i+=t.weight);e.weight&&(n+=e.barycenter*e.weight,i+=e.weight);t.vs=e.vs.concat(t.vs),t.barycenter=n/i,t.weight=i,t.i=Math.min(e.i,t.i),e.merged=!0}(t,e)}}function i(e){return function(n){n.in.push(e),0==--n.indegree&&t.push(n)}}for(;t.length;){var o=t.pop();e.push(o),NN.forEach(o.in.reverse(),n(o)),NN.forEach(o.out,i(o))}return NN.map(NN.filter(e,(function(t){return!t.merged})),(function(t){return NN.pick(t,["vs","i","barycenter","weight"])}))}(NN.filter(n,(function(t){return!t.indegree})))};var BL=function(t,e){var n=XN.partition(t,(function(t){return NN.has(t,"barycenter")})),i=n.lhs,o=NN.sortBy(n.rhs,(function(t){return-t.i})),r=[],s=0,a=0,l=0;i.sort((c=!!e,function(t,e){return t.barycenter<e.barycenter?-1:t.barycenter>e.barycenter?1:c?e.i-t.i:t.i-e.i})),l=FL(r,o,l),NN.forEach(i,(function(t){l+=t.vs.length,r.push(t.vs),s+=t.barycenter*t.weight,a+=t.weight,l=FL(r,o,l)}));var c;var d={vs:NN.flatten(r,!0)};a&&(d.barycenter=s/a,d.weight=a);return d};function FL(t,e,n){for(var i;e.length&&(i=NN.last(e)).i<=n;)e.pop(),t.push(i.vs),n++;return n}var HL=function t(e,n,i,o){var r=e.children(n),s=e.node(n),a=s?s.borderLeft:void 0,l=s?s.borderRight:void 0,c={};a&&(r=NN.filter(r,(function(t){return t!==a&&t!==l})));var d=PL(e,r);NN.forEach(d,(function(n){if(e.children(n.v).length){var r=t(e,n.v,i,o);c[n.v]=r,NN.has(r,"barycenter")&&(s=n,a=r,NN.isUndefined(s.barycenter)?(s.barycenter=a.barycenter,s.weight=a.weight):(s.barycenter=(s.barycenter*s.weight+a.barycenter*a.weight)/(s.weight+a.weight),s.weight+=a.weight))}var s,a}));var u=ML(d,i);!function(t,e){NN.forEach(t,(function(t){t.vs=NN.flatten(t.vs.map((function(t){return e[t]?e[t].vs:t})),!0)}))}(u,c);var h=BL(u,o);if(a&&(h.vs=NN.flatten([a,h.vs,l],!0),e.predecessors(a).length)){var p=e.node(e.predecessors(a)[0]),g=e.node(e.predecessors(l)[0]);NN.has(h,"barycenter")||(h.barycenter=0,h.weight=0),h.barycenter=(h.barycenter*h.weight+p.order+g.order)/(h.weight+2),h.weight+=2}return h};var UL=SD.Graph,VL=function(t,e,n){var i=function(t){var e;for(;t.hasNode(e=NN.uniqueId("_root")););return e}(t),o=new UL({compound:!0}).setGraph({root:i}).setDefaultNodeLabel((function(e){return t.node(e)}));return NN.forEach(t.nodes(),(function(r){var s=t.node(r),a=t.parent(r);(s.rank===e||s.minRank<=e&&e<=s.maxRank)&&(o.setNode(r),o.setParent(r,a||i),NN.forEach(t[n](r),(function(e){var n=e.v===r?e.w:e.v,i=o.edge(n,r),s=NN.isUndefined(i)?0:i.weight;o.setEdge(n,r,{weight:t.edge(e).weight+s})})),NN.has(s,"minRank")&&o.setNode(r,{borderLeft:s.borderLeft[e],borderRight:s.borderRight[e]}))})),o};var GL=function(t,e,n){var i,o={};NN.forEach(n,(function(n){for(var r,s,a=t.parent(n);a;){if((r=t.parent(a))?(s=o[r],o[r]=a):(s=i,i=a),s&&s!==a)return void e.setEdge(s,a);a=r}}))};var WL=SD.Graph,zL=function(t){var e=XN.maxRank(t),n=XL(t,NN.range(1,e+1),"inEdges"),i=XL(t,NN.range(e-1,-1,-1),"outEdges"),o=DL(t);YL(t,o);for(var r,s=Number.POSITIVE_INFINITY,a=0,l=0;l<4;++a,++l){jL(a%2?n:i,a%4>=2),o=XN.buildLayerMatrix(t);var c=NL(t,o);c<s&&(l=0,r=NN.cloneDeep(o),s=c)}YL(t,r)};function XL(t,e,n){return NN.map(e,(function(e){return VL(t,e,n)}))}function jL(t,e){var n=new WL;NN.forEach(t,(function(t){var i=t.graph().root,o=HL(t,i,n,e);NN.forEach(o.vs,(function(e,n){t.node(e).order=n})),GL(t,n,o.vs)}))}function YL(t,e){NN.forEach(e,(function(e){NN.forEach(e,(function(e,n){t.node(e).order=n}))}))}var KL=SD.Graph,$L=function(t){var e,n=XN.buildLayerMatrix(t),i=NN.merge(JL(t,n),qL(t,n)),o={};NN.forEach(["u","d"],(function(r){e="u"===r?n:NN.values(n).reverse(),NN.forEach(["l","r"],(function(n){"r"===n&&(e=NN.map(e,(function(t){return NN.values(t).reverse()})));var s=("u"===r?t.predecessors:t.successors).bind(t),a=tP(t,e,i,s),l=eP(t,e,a.root,a.align,"r"===n);"r"===n&&(l=NN.mapValues(l,(function(t){return-t}))),o[r+n]=l}))}));var r=nP(t,o);return iP(o,r),oP(o,t.graph().align)};function JL(t,e){var n={};return NN.reduce(e,(function(e,i){var o=0,r=0,s=e.length,a=NN.last(i);return NN.forEach(i,(function(e,l){var c=function(t,e){if(t.node(e).dummy)return NN.find(t.predecessors(e),(function(e){return t.node(e).dummy}))}(t,e),d=c?t.node(c).order:s;(c||e===a)&&(NN.forEach(i.slice(r,l+1),(function(e){NN.forEach(t.predecessors(e),(function(i){var r=t.node(i),s=r.order;!(s<o||d<s)||r.dummy&&t.node(e).dummy||ZL(n,i,e)}))})),r=l+1,o=d)})),i})),n}function qL(t,e){var n={};function i(e,i,o,r,s){var a;NN.forEach(NN.range(i,o),(function(i){a=e[i],t.node(a).dummy&&NN.forEach(t.predecessors(a),(function(e){var i=t.node(e);i.dummy&&(i.order<r||i.order>s)&&ZL(n,e,a)}))}))}return NN.reduce(e,(function(e,n){var o,r=-1,s=0;return NN.forEach(n,(function(a,l){if("border"===t.node(a).dummy){var c=t.predecessors(a);c.length&&(o=t.node(c[0]).order,i(n,s,l,r,o),s=l,r=o)}i(n,s,n.length,o,e.length)})),n})),n}function ZL(t,e,n){if(e>n){var i=e;e=n,n=i}var o=t[e];o||(t[e]=o={}),o[n]=!0}function QL(t,e,n){if(e>n){var i=e;e=n,n=i}return NN.has(t[e],n)}function tP(t,e,n,i){var o={},r={},s={};return NN.forEach(e,(function(t){NN.forEach(t,(function(t,e){o[t]=t,r[t]=t,s[t]=e}))})),NN.forEach(e,(function(t){var e=-1;NN.forEach(t,(function(t){var a=i(t);if(a.length)for(var l=((a=NN.sortBy(a,(function(t){return s[t]}))).length-1)/2,c=Math.floor(l),d=Math.ceil(l);c<=d;++c){var u=a[c];r[t]===t&&e<s[u]&&!QL(n,t,u)&&(r[u]=t,r[t]=o[t]=o[u],e=s[u])}}))})),{root:o,align:r}}function eP(t,e,n,i,o){var r={},s=function(t,e,n,i){var o=new KL,r=t.graph(),s=function(t,e,n){return function(i,o,r){var s,a=i.node(o),l=i.node(r),c=0;if(c+=a.width/2,NN.has(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":s=-a.width/2;break;case"r":s=a.width/2}if(s&&(c+=n?s:-s),s=0,c+=(a.dummy?e:t)/2,c+=(l.dummy?e:t)/2,c+=l.width/2,NN.has(l,"labelpos"))switch(l.labelpos.toLowerCase()){case"l":s=l.width/2;break;case"r":s=-l.width/2}return s&&(c+=n?s:-s),s=0,c}}(r.nodesep,r.edgesep,i);return NN.forEach(e,(function(e){var i;NN.forEach(e,(function(e){var r=n[e];if(o.setNode(r),i){var a=n[i],l=o.edge(a,r);o.setEdge(a,r,Math.max(s(t,e,i),l||0))}i=e}))})),o}(t,e,n,o),a=o?"borderLeft":"borderRight";function l(t,e){for(var n=s.nodes(),i=n.pop(),o={};i;)o[i]?t(i):(o[i]=!0,n.push(i),n=n.concat(e(i))),i=n.pop()}return l((function(t){r[t]=s.inEdges(t).reduce((function(t,e){return Math.max(t,r[e.v]+s.edge(e))}),0)}),s.predecessors.bind(s)),l((function(e){var n=s.outEdges(e).reduce((function(t,e){return Math.min(t,r[e.w]-s.edge(e))}),Number.POSITIVE_INFINITY),i=t.node(e);n!==Number.POSITIVE_INFINITY&&i.borderType!==a&&(r[e]=Math.max(r[e],n))}),s.successors.bind(s)),NN.forEach(i,(function(t){r[t]=r[n[t]]})),r}function nP(t,e){return NN.minBy(NN.values(e),(function(e){var n=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return NN.forIn(e,(function(e,o){var r=function(t,e){return t.node(e).width}(t,o)/2;n=Math.max(e+r,n),i=Math.min(e-r,i)})),n-i}))}function iP(t,e){var n=NN.values(e),i=NN.min(n),o=NN.max(n);NN.forEach(["u","d"],(function(n){NN.forEach(["l","r"],(function(r){var s,a=n+r,l=t[a];if(l!==e){var c=NN.values(l);(s="l"===r?i-NN.min(c):o-NN.max(c))&&(t[a]=NN.mapValues(l,(function(t){return t+s})))}}))}))}function oP(t,e){return NN.mapValues(t.ul,(function(n,i){if(e)return t[e.toLowerCase()][i];var o=NN.sortBy(NN.map(t,i));return(o[1]+o[2])/2}))}var rP=$L,sP=function(t){(function(t){var e=XN.buildLayerMatrix(t),n=t.graph().ranksep,i=0;NN.forEach(e,(function(e){var o=NN.max(NN.map(e,(function(e){return t.node(e).height})));NN.forEach(e,(function(e){t.node(e).y=i+o/2})),i+=o+n}))})(t=XN.asNonCompoundGraph(t)),NN.forEach(rP(t),(function(e,n){t.node(n).x=e}))};var aP=XN.normalizeRanks,lP=XN.removeEmptyRanks,cP=XN,dP=SD.Graph,uP=function(t,e){var n=e&&e.debugTiming?cP.time:cP.notime;n("layout",(function(){var e=n("  buildLayoutGraph",(function(){return function(t){var e=new dP({multigraph:!0,compound:!0}),n=EP(t.graph());return e.setGraph(NN.merge({},pP,bP(n,hP),NN.pick(n,gP))),NN.forEach(t.nodes(),(function(n){var i=EP(t.node(n));e.setNode(n,NN.defaults(bP(i,fP),mP)),e.setParent(n,t.parent(n))})),NN.forEach(t.edges(),(function(n){var i=EP(t.edge(n));e.setEdge(n,NN.merge({},vP,bP(i,_P),NN.pick(i,yP)))})),e}(t)}));n("  runLayout",(function(){!function(t,e){e("    makeSpaceForEdgeLabels",(function(){!function(t){var e=t.graph();e.ranksep/=2,NN.forEach(t.edges(),(function(n){var i=t.edge(n);i.minlen*=2,"c"!==i.labelpos.toLowerCase()&&("TB"===e.rankdir||"BT"===e.rankdir?i.width+=i.labeloffset:i.height+=i.labeloffset)}))}(t)})),e("    removeSelfEdges",(function(){!function(t){NN.forEach(t.edges(),(function(e){if(e.v===e.w){var n=t.node(e.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:e,label:t.edge(e)}),t.removeEdge(e)}}))}(t)})),e("    acyclic",(function(){WN.run(t)})),e("    nestingGraph.run",(function(){RL.run(t)})),e("    rank",(function(){yL(cP.asNonCompoundGraph(t))})),e("    injectEdgeLabelProxies",(function(){!function(t){NN.forEach(t.edges(),(function(e){var n=t.edge(e);if(n.width&&n.height){var i=t.node(e.v),o={rank:(t.node(e.w).rank-i.rank)/2+i.rank,e:e};cP.addDummyNode(t,"edge-proxy",o,"_ep")}}))}(t)})),e("    removeEmptyRanks",(function(){lP(t)})),e("    nestingGraph.cleanup",(function(){RL.cleanup(t)})),e("    normalizeRanks",(function(){aP(t)})),e("    assignRankMinMax",(function(){!function(t){var e=0;NN.forEach(t.nodes(),(function(n){var i=t.node(n);i.borderTop&&(i.minRank=t.node(i.borderTop).rank,i.maxRank=t.node(i.borderBottom).rank,e=NN.max(e,i.maxRank))})),t.graph().maxRank=e}(t)})),e("    removeEdgeLabelProxies",(function(){!function(t){NN.forEach(t.nodes(),(function(e){var n=t.node(e);"edge-proxy"===n.dummy&&(t.edge(n.e).labelRank=n.rank,t.removeNode(e))}))}(t)})),e("    normalize.run",(function(){KN.run(t)})),e("    parentDummyChains",(function(){TL(t)})),e("    addBorderSegments",(function(){xL(t)})),e("    order",(function(){zL(t)})),e("    insertSelfEdges",(function(){!function(t){var e=cP.buildLayerMatrix(t);NN.forEach(e,(function(e){var n=0;NN.forEach(e,(function(e,i){var o=t.node(e);o.order=i+n,NN.forEach(o.selfEdges,(function(e){cP.addDummyNode(t,"selfedge",{width:e.label.width,height:e.label.height,rank:o.rank,order:i+ ++n,e:e.e,label:e.label},"_se")})),delete o.selfEdges}))}))}(t)})),e("    adjustCoordinateSystem",(function(){IL.adjust(t)})),e("    position",(function(){sP(t)})),e("    positionSelfEdges",(function(){!function(t){NN.forEach(t.nodes(),(function(e){var n=t.node(e);if("selfedge"===n.dummy){var i=t.node(n.e.v),o=i.x+i.width/2,r=i.y,s=n.x-o,a=i.height/2;t.setEdge(n.e,n.label),t.removeNode(e),n.label.points=[{x:o+2*s/3,y:r-a},{x:o+5*s/6,y:r-a},{x:o+s,y:r},{x:o+5*s/6,y:r+a},{x:o+2*s/3,y:r+a}],n.label.x=n.x,n.label.y=n.y}}))}(t)})),e("    removeBorderNodes",(function(){!function(t){NN.forEach(t.nodes(),(function(e){if(t.children(e).length){var n=t.node(e),i=t.node(n.borderTop),o=t.node(n.borderBottom),r=t.node(NN.last(n.borderLeft)),s=t.node(NN.last(n.borderRight));n.width=Math.abs(s.x-r.x),n.height=Math.abs(o.y-i.y),n.x=r.x+n.width/2,n.y=i.y+n.height/2}})),NN.forEach(t.nodes(),(function(e){"border"===t.node(e).dummy&&t.removeNode(e)}))}(t)})),e("    normalize.undo",(function(){KN.undo(t)})),e("    fixupEdgeLabelCoords",(function(){!function(t){NN.forEach(t.edges(),(function(e){var n=t.edge(e);if(NN.has(n,"x"))switch("l"!==n.labelpos&&"r"!==n.labelpos||(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset}}))}(t)})),e("    undoCoordinateSystem",(function(){IL.undo(t)})),e("    translateGraph",(function(){!function(t){var e=Number.POSITIVE_INFINITY,n=0,i=Number.POSITIVE_INFINITY,o=0,r=t.graph(),s=r.marginx||0,a=r.marginy||0;function l(t){var r=t.x,s=t.y,a=t.width,l=t.height;e=Math.min(e,r-a/2),n=Math.max(n,r+a/2),i=Math.min(i,s-l/2),o=Math.max(o,s+l/2)}NN.forEach(t.nodes(),(function(e){l(t.node(e))})),NN.forEach(t.edges(),(function(e){var n=t.edge(e);NN.has(n,"x")&&l(n)})),e-=s,i-=a,NN.forEach(t.nodes(),(function(n){var o=t.node(n);o.x-=e,o.y-=i})),NN.forEach(t.edges(),(function(n){var o=t.edge(n);NN.forEach(o.points,(function(t){t.x-=e,t.y-=i})),NN.has(o,"x")&&(o.x-=e),NN.has(o,"y")&&(o.y-=i)})),r.width=n-e+s,r.height=o-i+a}(t)})),e("    assignNodeIntersects",(function(){!function(t){NN.forEach(t.edges(),(function(e){var n,i,o=t.edge(e),r=t.node(e.v),s=t.node(e.w);o.points?(n=o.points[0],i=o.points[o.points.length-1]):(o.points=[],n=s,i=r),o.points.unshift(cP.intersectRect(r,n)),o.points.push(cP.intersectRect(s,i))}))}(t)})),e("    reversePoints",(function(){!function(t){NN.forEach(t.edges(),(function(e){var n=t.edge(e);n.reversed&&n.points.reverse()}))}(t)})),e("    acyclic.undo",(function(){WN.undo(t)}))}(e,n)})),n("  updateInputGraph",(function(){!function(t,e){NN.forEach(t.nodes(),(function(n){var i=t.node(n),o=e.node(n);i&&(i.x=o.x,i.y=o.y,e.children(n).length&&(i.width=o.width,i.height=o.height))})),NN.forEach(t.edges(),(function(n){var i=t.edge(n),o=e.edge(n);i.points=o.points,NN.has(o,"x")&&(i.x=o.x,i.y=o.y)})),t.graph().width=e.graph().width,t.graph().height=e.graph().height}(t,e)}))}))};var hP=["nodesep","edgesep","ranksep","marginx","marginy"],pP={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},gP=["acyclicer","ranker","rankdir","align"],fP=["width","height"],mP={width:0,height:0},_P=["minlen","weight","width","height","labeloffset"],vP={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},yP=["labelpos"];function bP(t,e){return NN.mapValues(NN.pick(t,e),Number)}function EP(t){var e={};return NN.forEach(t,(function(t,n){e[n.toLowerCase()]=t})),e}var TP=SD.Graph;var RP={graphlib:SD,layout:uP,debug:{debugOrdering:function(t){var e=XN.buildLayerMatrix(t),n=new TP({compound:!0,multigraph:!0}).setGraph({});return NN.forEach(t.nodes(),(function(e){n.setNode(e,{label:e}),n.setParent(e,"layer"+t.node(e).rank)})),NN.forEach(t.edges(),(function(t){n.setEdge(t.v,t.w,{},t.name)})),NN.forEach(e,(function(t,e){var i="layer"+e;n.setNode(i,{rank:"same"}),NN.reduce(t,(function(t,e){return n.setEdge(t,e,{style:"invis"}),e}))})),n}},util:{time:XN.time,notime:XN.notime},version:"0.8.5"},CP=r_((function(t,e){var n;n=function(t){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){var i=n(1),o=function(t){t&&t("layout","dagre",i)};"undefined"!=typeof cytoscape&&o(cytoscape),t.exports=o},function(t,e,n){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o=n(2),r=n(3),s=n(4);function a(t){this.options=r({},o,t)}a.prototype.run=function(){var t=this.options,e=t.cy,n=t.eles,o=function(t,e){return"function"==typeof e?e.apply(t,[t]):e},r=t.boundingBox||{x1:0,y1:0,w:e.width(),h:e.height()};void 0===r.x2&&(r.x2=r.x1+r.w),void 0===r.w&&(r.w=r.x2-r.x1),void 0===r.y2&&(r.y2=r.y1+r.h),void 0===r.h&&(r.h=r.y2-r.y1);var a=new s.graphlib.Graph({multigraph:!0,compound:!0}),l={},c=function(t,e){null!=e&&(l[t]=e)};c("nodesep",t.nodeSep),c("edgesep",t.edgeSep),c("ranksep",t.rankSep),c("rankdir",t.rankDir),c("ranker",t.ranker),a.setGraph(l),a.setDefaultEdgeLabel((function(){return{}})),a.setDefaultNodeLabel((function(){return{}}));for(var d=n.nodes(),u=0;u<d.length;u++){var h=d[u],p=h.layoutDimensions(t);a.setNode(h.id(),{width:p.w,height:p.h,name:h.id()})}for(var g=0;g<d.length;g++){var f=d[g];f.isChild()&&a.setParent(f.id(),f.parent().id())}for(var m=n.edges().stdFilter((function(t){return!t.source().isParent()&&!t.target().isParent()})),_=0;_<m.length;_++){var v=m[_];a.setEdge(v.source().id(),v.target().id(),{minlen:o(v,t.minLen),weight:o(v,t.edgeWeight),name:v.id()},v.id())}s.layout(a);for(var y,b=a.nodes(),E=0;E<b.length;E++){var T=b[E],R=a.node(T);e.getElementById(T).scratch().dagre=R}return t.boundingBox?(y={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0},d.forEach((function(t){var e=t.scratch().dagre;y.x1=Math.min(y.x1,e.x),y.x2=Math.max(y.x2,e.x),y.y1=Math.min(y.y1,e.y),y.y2=Math.max(y.y2,e.y)})),y.w=y.x2-y.x1,y.h=y.y2-y.y1):y=r,d.layoutPositions(this,t,(function(e){var n=(e="object"===i(e)?e:this).scratch().dagre;return function(e){if(t.boundingBox){var n=0===y.w?0:(e.x-y.x1)/y.w,i=0===y.h?0:(e.y-y.y1)/y.h;return{x:r.x1+n*r.w,y:r.y1+i*r.h}}return e}({x:n.x,y:n.y})})),this},t.exports=a},function(t,e){var n={nodeSep:void 0,edgeSep:void 0,rankSep:void 0,rankDir:void 0,ranker:void 0,minLen:function(t){return 1},edgeWeight:function(t){return 1},fit:!0,padding:30,spacingFactor:void 0,nodeDimensionsIncludeLabels:!1,animate:!1,animateFilter:function(t,e){return!0},animationDuration:500,animationEasing:void 0,boundingBox:void 0,transform:function(t,e){return e},ready:function(){},stop:function(){}};t.exports=n},function(t,e){t.exports=null!=Object.assign?Object.assign.bind(Object):function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return n.forEach((function(e){Object.keys(e).forEach((function(n){return t[n]=e[n]}))})),t}},function(e,n){e.exports=t}])},t.exports=n(RP)}));ES.use(CP);wm([Z("#source-chain-graph"),Am("design:type",HTMLElement)],class extends Lm{constructor(){super(...arguments),this.nodes=[]}static get styles(){return[Pm,st(Em||(Em=km`:host{display:flex}#source-chain-graph{width:100%;height:100%}`))]}get activeCell(){return Fm(this.activeDna,this.activeAgentPubKey,this.conductors)}firstUpdated(){window.addEventListener("scroll",(()=>{this.cy.resize()})),this.cy=ES({container:this.graph,layout:{name:"dagre"},autoungrabify:!0,userZoomingEnabled:!0,userPanningEnabled:!0,style:"\nnode {\n  width: 30px;\n  height: 30px;\n  font-size: 10px;\n  label: data(label);\n  background-color: grey;\n  text-halign: right;\n  text-valign: center;\n  text-margin-x: 4px;\n}\n\n.header {\n  text-margin-x: -5px;\n  text-halign: left;\n  shape: round-rectangle;\n}\n\nedge {\n  width: 4;\n  target-arrow-shape: triangle;\n  curve-style: bezier;\n  line-style: dotted;\n}\n\n.selected {\n  border-width: 4px;\n  border-color: black;\n  border-style: solid;\n}\n\n.Dna {\n  background-color: green;\n}\n.AgentValidationPkg {\n  background-color: lime;\n}\n.Create {\n  background-color: blue;\n}\n.Delete {\n  background-color: red;\n}\n.Update {\n  background-color: cyan;\n}\n.CreateLink {\n  background-color: purple;\n}\n.DeleteLink {\n  background-color: purple;\n}\n"}),this.cy.on("tap","node",(t=>{let e=t.target.id();e.includes(":")&&(e=e.split(":")[1]),this.updatePlayground({activeHash:e})}));let t=!1;this.cy.on("render",(()=>{0!==this.cy.width()&&(t||(t=!0,setTimeout((()=>{this.setupGraph()}))))})),this.requestUpdate()}observedCells(){return[this.activeCell]}setupGraph(){this.cy.remove("node"),this.cy.add(this.nodes);const t=this.nodes.slice(0,7);this.cy.fit(t),this.cy.center(t),this.cy.resize(),this.cy.layout({name:"dagre"}).run()}updated(t){super.updated(t);const e=function(t){if(!t)return[];const e=[],n=t.getState(),i=n.sourceChain;for(const t of i){const i=n.CAS[t];if(e.push({data:{id:t,data:i,label:i.header.content.type},classes:["header",i.header.content.type]}),i.header.content.prev_header){const n=i.header.content.prev_header;e.push({data:{id:`${t}->${n}`,source:t,target:n}})}}for(const o of i){const i=o,r=n.CAS[i];if(r.header.content.entry_hash){const o=r.header.content,s=o.entry_hash,a=`${i}:${s}`,l=n.CAS[s],c=ls(t,o.entry_type);e.push({data:{id:a,data:l,label:c},classes:[c]}),e.push({data:{id:`${i}->${a}`,source:i,target:a}})}}return e}(this.activeCell);if($o(e,this.nodes)||(this.nodes=e,this.setupGraph()),t.has("activeHash")){this.cy.filter("node").removeClass("selected");const t=this.cy.nodes();for(const e of t){const t=e.id();(t===this.activeHash||t.includes(`:${this.activeHash}`))&&e.addClass("selected")}}}renderHelp(){return F(Tm||(Tm=km` <holochain-playground-help-button heading="Source-Chain" class="block-help"> <span> This graph displays the source chain of the selected cell. On the top-left sequence, you can see the hash-chain of headers. On the bottom-right sequence, you can see the entries associated with each header. Links between headers <br> <br> Dashed relationships are embedded references: the headers contain the hash of the last header, and also the entry hash if they have an entry. </span> </holochain-playground-help-button>`))}render(){return F(Rm||(Rm=km` <mwc-card class="block-card"> <div class="column fill"> <span class="block-title" style="margin:16px">Source chain</span> ${0} ${0} <div style="${0}" class="fill" id="source-chain-graph"></div> </div> </mwc-card> `),this.renderHelp(),this.activeCell?F(Cm||(Cm=km``)):F(xm||(xm=km` <div style="flex:1" class="center-content placeholder"> <span>Select a cell to display its source chain</span> </div> `)),qt({display:this.activeCell?"":"none"}))}static get scopedElements(){return{"mwc-card":ld,"holochain-playground-help-button":RS}}}.prototype,"graph",void 0);var xP="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function SP(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach((function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})})),e}function IP(t){var e={exports:{}};return t(e,e.exports),e.exports}exports.DOMException=require("domexception"),exports.NamedNodeMap=require("./generated/NamedNodeMap").interface,exports.Attr=require("./generated/Attr").interface,exports.Node=require("./generated/Node").interface,exports.Element=require("./generated/Element").interface,exports.DocumentFragment=require("./generated/DocumentFragment").interface,exports.Document=exports.HTMLDocument=require("./generated/Document").interface,exports.XMLDocument=require("./generated/XMLDocument").interface,exports.CharacterData=require("./generated/CharacterData").interface,exports.Text=require("./generated/Text").interface,exports.CDATASection=require("./generated/CDATASection").interface,exports.ProcessingInstruction=require("./generated/ProcessingInstruction").interface,exports.Comment=require("./generated/Comment").interface,exports.DocumentType=require("./generated/DocumentType").interface,exports.DOMImplementation=require("./generated/DOMImplementation").interface,exports.NodeList=require("./generated/NodeList").interface,exports.HTMLCollection=require("./generated/HTMLCollection").interface,exports.HTMLOptionsCollection=require("./generated/HTMLOptionsCollection").interface,exports.DOMStringMap=require("./generated/DOMStringMap").interface,exports.DOMTokenList=require("./generated/DOMTokenList").interface,exports.SVGAnimatedString=require("./generated/SVGAnimatedString").interface,exports.SVGNumber=require("./generated/SVGNumber").interface,exports.SVGStringList=require("./generated/SVGStringList").interface,exports.Event=require("./generated/Event").interface,exports.CloseEvent=require("./generated/CloseEvent").interface,exports.CustomEvent=require("./generated/CustomEvent").interface,exports.MessageEvent=require("./generated/MessageEvent").interface,exports.ErrorEvent=require("./generated/ErrorEvent").interface,exports.HashChangeEvent=require("./generated/HashChangeEvent").interface,exports.InputEvent=require("./generated/InputEvent").interface,exports.FocusEvent=require("./generated/FocusEvent").interface,exports.PopStateEvent=require("./generated/PopStateEvent").interface,exports.UIEvent=require("./generated/UIEvent").interface,exports.MouseEvent=require("./generated/MouseEvent").interface,exports.KeyboardEvent=require("./generated/KeyboardEvent").interface,exports.TouchEvent=require("./generated/TouchEvent").interface,exports.PageTransitionEvent=require("./generated/PageTransitionEvent").interface,exports.ProgressEvent=require("./generated/ProgressEvent").interface,exports.StorageEvent=require("./generated/StorageEvent").interface,exports.CompositionEvent=require("./generated/CompositionEvent").interface,exports.WheelEvent=require("./generated/WheelEvent").interface,exports.EventTarget=require("./generated/EventTarget").interface,exports.BarProp=require("./generated/BarProp").interface,exports.External=require("./generated/External").interface,exports.Location=require("./generated/Location").interface,exports.History=require("./generated/History").interface,exports.Screen=require("./generated/Screen").interface,exports.Performance=require("./generated/Performance").interface,exports.PluginArray=require("./generated/PluginArray").interface,exports.MimeTypeArray=require("./generated/MimeTypeArray").interface,exports.Plugin=require("./generated/Plugin").interface,exports.MimeType=require("./generated/MimeType").interface,exports.Blob=require("./generated/Blob").interface,exports.File=require("./generated/File").interface,exports.FileList=require("./generated/FileList").interface,exports.ValidityState=require("./generated/ValidityState").interface,exports.DOMParser=require("./generated/DOMParser").interface,exports.XMLSerializer=require("w3c-xmlserializer/lib/XMLSerializer").interface,exports.FormData=require("./generated/FormData").interface,exports.XMLHttpRequestEventTarget=require("./generated/XMLHttpRequestEventTarget").interface,exports.XMLHttpRequestUpload=require("./generated/XMLHttpRequestUpload").interface,exports.NodeIterator=require("./generated/NodeIterator").interface,exports.TreeWalker=require("./generated/TreeWalker").interface,exports.Storage=require("./generated/Storage").interface,exports.ShadowRoot=require("./generated/ShadowRoot").interface,exports.MutationObserver=require("./generated/MutationObserver").interface,exports.MutationRecord=require("./generated/MutationRecord").interface,require("./register-elements")(exports),require("../level2/style").addToCore(exports),require("../level3/xpath")(exports),require("./node-filter")(exports),exports.URL=require("whatwg-url").URL,exports.URLSearchParams=require("whatwg-url").URLSearchParams,exports.Headers=require("./generated/Headers").interface;var OP=Object.freeze({__proto__:null}),kP=IP((function(t,e){var n;t.exports=((n={constants:{},LINE_MODE_MULTIPLIER:40,PAGE_MODE_MULTIPLIER:125,DRAG_RADIUS:5,FLYOUT_DRAG_RADIUS:10,SNAP_RADIUS:28}).CONNECTING_SNAP_RADIUS=n.SNAP_RADIUS,n.CURRENT_CONNECTION_PREFERENCE=8,n.BUMP_DELAY=250,n.BUMP_RANDOMNESS=10,n.COLLAPSE_CHARS=30,n.LONGPRESS=750,n.SOUND_LIMIT=100,n.DRAG_STACK=!0,n.HSV_SATURATION=.45,n.HSV_VALUE=.65,n.SPRITE={width:96,height:124,url:"sprites.png"},n.INPUT_VALUE=1,n.OUTPUT_VALUE=2,n.NEXT_STATEMENT=3,n.PREVIOUS_STATEMENT=4,n.DUMMY_INPUT=5,n.ALIGN_LEFT=-1,n.ALIGN_CENTRE=0,n.ALIGN_RIGHT=1,n.DRAG_NONE=0,n.DRAG_STICKY=1,n.DRAG_BEGIN=1,n.DRAG_FREE=2,n.OPPOSITE_TYPE=[],n.OPPOSITE_TYPE[n.INPUT_VALUE]=n.OUTPUT_VALUE,n.OPPOSITE_TYPE[n.OUTPUT_VALUE]=n.INPUT_VALUE,n.OPPOSITE_TYPE[n.NEXT_STATEMENT]=n.PREVIOUS_STATEMENT,n.OPPOSITE_TYPE[n.PREVIOUS_STATEMENT]=n.NEXT_STATEMENT,n.TOOLBOX_AT_TOP=0,n.TOOLBOX_AT_BOTTOM=1,n.TOOLBOX_AT_LEFT=2,n.TOOLBOX_AT_RIGHT=3,n.DELETE_AREA_NONE=null,n.DELETE_AREA_TRASH=1,n.DELETE_AREA_TOOLBOX=2,n.VARIABLE_CATEGORY_NAME="VARIABLE",n.VARIABLE_DYNAMIC_CATEGORY_NAME="VARIABLE_DYNAMIC",n.PROCEDURE_CATEGORY_NAME="PROCEDURE",n.RENAME_VARIABLE_ID="RENAME_VARIABLE_ID",n.DELETE_VARIABLE_ID="DELETE_VARIABLE_ID",n.registry={},n.registry.typeMap_={},n.registry.DEFAULT="default",n.registry.Type=function(t){this.name_=t},n.registry.Type.prototype.toString=function(){return this.name_},n.registry.Type.CONNECTION_CHECKER=new n.registry.Type("connectionChecker"),n.registry.Type.EVENT=new n.registry.Type("event"),n.registry.Type.FIELD=new n.registry.Type("field"),n.registry.Type.RENDERER=new n.registry.Type("renderer"),n.registry.Type.TOOLBOX=new n.registry.Type("toolbox"),n.registry.Type.THEME=new n.registry.Type("theme"),n.registry.Type.TOOLBOX_ITEM=new n.registry.Type("toolboxItem"),n.registry.Type.FLYOUTS_VERTICAL_TOOLBOX=new n.registry.Type("flyoutsVerticalToolbox"),n.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX=new n.registry.Type("flyoutsHorizontalToolbox"),n.registry.register=function(t,e,i,o){if(!(t instanceof n.registry.Type)&&"string"!=typeof t||""==String(t).trim())throw Error('Invalid type "'+t+'". The type must be a non-empty string or a Blockly.registry.Type.');if(t=String(t).toLowerCase(),"string"!=typeof e||""==e.trim())throw Error('Invalid name "'+e+'". The name must be a non-empty string.');if(e=e.toLowerCase(),!i)throw Error("Can not register a null value");var r=n.registry.typeMap_[t];if(r||(r=n.registry.typeMap_[t]={}),n.registry.validate_(t,i),!o&&r[e])throw Error('Name "'+e+'" with type "'+t+'" already registered.');r[e]=i},n.registry.validate_=function(t,e){switch(t){case String(n.registry.Type.FIELD):if("function"!=typeof e.fromJson)throw Error('Type "'+t+'" must have a fromJson function')}},n.registry.unregister=function(t,e){t=String(t).toLowerCase(),e=e.toLowerCase();var i=n.registry.typeMap_[t];i?i[e]?delete n.registry.typeMap_[t][e]:console.warn('No name "'+e+'" with type "'+t+'" found'):console.warn('No type "'+t+'" found')},n.registry.getItem_=function(t,e){t=String(t).toLowerCase(),e=e.toLowerCase();var i=n.registry.typeMap_[t];return i?i[e]?i[e]:(console.warn('No name "'+e+'" with type "'+t+'" found'),null):(console.warn('No type "'+t+'" found'),null)},n.registry.hasItem=function(t,e){return t=String(t).toLowerCase(),e=e.toLowerCase(),!!(t=n.registry.typeMap_[t])&&!!t[e]},n.registry.getClass=function(t,e){return n.registry.getItem_(t,e)},n.registry.getObject=function(t,e){return n.registry.getItem_(t,e)},n.registry.getClassFromOptions=function(t,e){return"function"==typeof(e=e.plugins[t.toString()]||n.registry.DEFAULT)?e:n.registry.getClass(t,e)},n.utils={},n.utils.global=function(){return"object"==typeof self?self:"object"==typeof window?window:"object"==typeof xP?xP:this}(),n.Msg={},n.utils.global.Blockly||(n.utils.global.Blockly={}),n.utils.global.Blockly.Msg||(n.utils.global.Blockly.Msg=n.Msg),n.utils.colour={},n.utils.colour.parse=function(t){t=String(t).toLowerCase().trim();var e=n.utils.colour.names[t];if(e)return e;if(e="#"==(e="0x"==t.substring(0,2)?"#"+t.substring(2):t)[0]?e:"#"+e,/^#[0-9a-f]{6}$/.test(e))return e;if(/^#[0-9a-f]{3}$/.test(e))return["#",e[1],e[1],e[2],e[2],e[3],e[3]].join("");var i=t.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return i&&(t=Number(i[1]),e=Number(i[2]),i=Number(i[3]),0<=t&&256>t&&0<=e&&256>e&&0<=i&&256>i)?n.utils.colour.rgbToHex(t,e,i):null},n.utils.colour.rgbToHex=function(t,e,n){return e=t<<16|e<<8|n,16>t?"#"+(16777216|e).toString(16).substr(1):"#"+e.toString(16)},n.utils.colour.hexToRgb=function(t){return(t=n.utils.colour.parse(t))?[(t=parseInt(t.substr(1),16))>>16,t>>8&255,255&t]:[0,0,0]},n.utils.colour.hsvToHex=function(t,e,i){var o=0,r=0,s=0;if(0==e)s=r=o=i;else{var a=Math.floor(t/60),l=t/60-a;t=i*(1-e);var c=i*(1-e*l);switch(e=i*(1-e*(1-l)),a){case 1:o=c,r=i,s=t;break;case 2:o=t,r=i,s=e;break;case 3:o=t,r=c,s=i;break;case 4:o=e,r=t,s=i;break;case 5:o=i,r=t,s=c;break;case 6:case 0:o=i,r=e,s=t}}return n.utils.colour.rgbToHex(Math.floor(o),Math.floor(r),Math.floor(s))},n.utils.colour.blend=function(t,e,i){return(t=n.utils.colour.parse(t))&&(e=n.utils.colour.parse(e))?(t=n.utils.colour.hexToRgb(t),e=n.utils.colour.hexToRgb(e),n.utils.colour.rgbToHex(Math.round(e[0]+i*(t[0]-e[0])),Math.round(e[1]+i*(t[1]-e[1])),Math.round(e[2]+i*(t[2]-e[2])))):null},n.utils.colour.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},n.utils.Coordinate=function(t,e){this.x=t,this.y=e},n.utils.Coordinate.equals=function(t,e){return t==e||!(!t||!e)&&t.x==e.x&&t.y==e.y},n.utils.Coordinate.distance=function(t,e){var n=t.x-e.x;return t=t.y-e.y,Math.sqrt(n*n+t*t)},n.utils.Coordinate.magnitude=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},n.utils.Coordinate.difference=function(t,e){return new n.utils.Coordinate(t.x-e.x,t.y-e.y)},n.utils.Coordinate.sum=function(t,e){return new n.utils.Coordinate(t.x+e.x,t.y+e.y)},n.utils.Coordinate.prototype.scale=function(t){return this.x*=t,this.y*=t,this},n.utils.Coordinate.prototype.translate=function(t,e){return this.x+=t,this.y+=e,this},n.utils.Rect=function(t,e,n,i){this.top=t,this.bottom=e,this.left=n,this.right=i},n.utils.Rect.prototype.contains=function(t,e){return t>=this.left&&t<=this.right&&e>=this.top&&e<=this.bottom},n.utils.string={},n.utils.string.startsWith=function(t,e){return 0==t.lastIndexOf(e,0)},n.utils.string.shortestStringLength=function(t){return t.length?t.reduce((function(t,e){return t.length<e.length?t:e})).length:0},n.utils.string.commonWordPrefix=function(t,e){if(!t.length)return 0;if(1==t.length)return t[0].length;var i=0;e=e||n.utils.string.shortestStringLength(t);for(var o=0;o<e;o++){for(var r=t[0][o],s=1;s<t.length;s++)if(r!=t[s][o])return i;" "==r&&(i=o+1)}for(s=1;s<t.length;s++)if((r=t[s][o])&&" "!=r)return i;return e},n.utils.string.commonWordSuffix=function(t,e){if(!t.length)return 0;if(1==t.length)return t[0].length;var i=0;e=e||n.utils.string.shortestStringLength(t);for(var o=0;o<e;o++){for(var r=t[0].substr(-o-1,1),s=1;s<t.length;s++)if(r!=t[s].substr(-o-1,1))return i;" "==r&&(i=o+1)}for(s=1;s<t.length;s++)if((r=t[s].charAt(t[s].length-o-1))&&" "!=r)return i;return e},n.utils.string.wrap=function(t,e){t=t.split("\n");for(var i=0;i<t.length;i++)t[i]=n.utils.string.wrapLine_(t[i],e);return t.join("\n")},n.utils.string.wrapLine_=function(t,e){if(t.length<=e)return t;for(var i=t.trim().split(/\s+/),o=0;o<i.length;o++)i[o].length>e&&(e=i[o].length);o=-1/0;var r=1;do{var s=o,a=t;t=[];var l=i.length/r,c=1;for(o=0;o<i.length-1;o++)c<(o+1.5)/l?(c++,t[o]=!0):t[o]=!1;t=n.utils.string.wrapMutate_(i,t,e),o=n.utils.string.wrapScore_(i,t,e),t=n.utils.string.wrapToText_(i,t),r++}while(o>s);return a},n.utils.string.wrapScore_=function(t,e,n){for(var i=[0],o=[],r=0;r<t.length;r++)i[i.length-1]+=t[r].length,!0===e[r]?(i.push(0),o.push(t[r].charAt(t[r].length-1))):!1===e[r]&&i[i.length-1]++;for(t=Math.max.apply(Math,i),r=e=0;r<i.length;r++)e-=2*Math.pow(Math.abs(n-i[r]),1.5),e-=Math.pow(t-i[r],1.5),-1!=".?!".indexOf(o[r])?e+=n/3:-1!=",;)]}".indexOf(o[r])&&(e+=n/4);return 1<i.length&&i[i.length-1]<=i[i.length-2]&&(e+=.5),e},n.utils.string.wrapMutate_=function(t,e,i){for(var o,r=n.utils.string.wrapScore_(t,e,i),s=0;s<e.length-1;s++)if(e[s]!=e[s+1]){var a=[].concat(e);a[s]=!a[s],a[s+1]=!a[s+1];var l=n.utils.string.wrapScore_(t,a,i);l>r&&(r=l,o=a)}return o?n.utils.string.wrapMutate_(t,o,i):e},n.utils.string.wrapToText_=function(t,e){for(var n=[],i=0;i<t.length;i++)n.push(t[i]),void 0!==e[i]&&n.push(e[i]?"\n":" ");return n.join("")},n.utils.Size=function(t,e){this.width=t,this.height=e},n.utils.Size.equals=function(t,e){return t==e||!(!t||!e)&&t.width==e.width&&t.height==e.height},n.utils.style={},n.utils.style.getSize=function(t){if("none"!=n.utils.style.getStyle_(t,"display"))return n.utils.style.getSizeWithDisplay_(t);var e=t.style,i=e.display,o=e.visibility,r=e.position;e.visibility="hidden",e.position="absolute",e.display="inline";var s=t.offsetWidth;return t=t.offsetHeight,e.display=i,e.position=r,e.visibility=o,new n.utils.Size(s,t)},n.utils.style.getSizeWithDisplay_=function(t){return new n.utils.Size(t.offsetWidth,t.offsetHeight)},n.utils.style.getStyle_=function(t,e){return n.utils.style.getComputedStyle(t,e)||n.utils.style.getCascadedStyle(t,e)||t.style&&t.style[e]},n.utils.style.getComputedStyle=function(t,e){return document.defaultView&&document.defaultView.getComputedStyle&&(t=document.defaultView.getComputedStyle(t,null))&&(t[e]||t.getPropertyValue(e))||""},n.utils.style.getCascadedStyle=function(t,e){return t.currentStyle?t.currentStyle[e]:null},n.utils.style.getPageOffset=function(t){var e=new n.utils.Coordinate(0,0);t=t.getBoundingClientRect();var i=document.documentElement;return i=new n.utils.Coordinate(window.pageXOffset||i.scrollLeft,window.pageYOffset||i.scrollTop),e.x=t.left+i.x,e.y=t.top+i.y,e},n.utils.style.getViewportPageOffset=function(){var t=document.body,e=document.documentElement;return new n.utils.Coordinate(t.scrollLeft||e.scrollLeft,t.scrollTop||e.scrollTop)},n.utils.style.setElementShown=function(t,e){t.style.display=e?"":"none"},n.utils.style.isRightToLeft=function(t){return"rtl"==n.utils.style.getStyle_(t,"direction")},n.utils.style.getBorderBox=function(t){var e=n.utils.style.getComputedStyle(t,"borderLeftWidth"),i=n.utils.style.getComputedStyle(t,"borderRightWidth"),o=n.utils.style.getComputedStyle(t,"borderTopWidth");return t=n.utils.style.getComputedStyle(t,"borderBottomWidth"),{top:parseFloat(o),right:parseFloat(i),bottom:parseFloat(t),left:parseFloat(e)}},n.utils.style.scrollIntoContainerView=function(t,e,i){t=n.utils.style.getContainerOffsetToScrollInto(t,e,i),e.scrollLeft=t.x,e.scrollTop=t.y},n.utils.style.getContainerOffsetToScrollInto=function(t,e,i){var o=n.utils.style.getPageOffset(t),r=n.utils.style.getPageOffset(e),s=n.utils.style.getBorderBox(e),a=o.x-r.x-s.left;return o=o.y-r.y-s.top,r=n.utils.style.getSizeWithDisplay_(t),t=e.clientWidth-r.width,r=e.clientHeight-r.height,s=e.scrollLeft,e=e.scrollTop,i?(s+=a-t/2,e+=o-r/2):(s+=Math.min(a,Math.max(a-t,0)),e+=Math.min(o,Math.max(o-r,0))),new n.utils.Coordinate(s,e)},n.utils.userAgent={},function(t){function e(t){return-1!=i.indexOf(t.toUpperCase())}n.utils.userAgent.raw=t;var i=n.utils.userAgent.raw.toUpperCase();n.utils.userAgent.IE=e("Trident")||e("MSIE"),n.utils.userAgent.EDGE=e("Edge"),n.utils.userAgent.JAVA_FX=e("JavaFX"),n.utils.userAgent.CHROME=(e("Chrome")||e("CriOS"))&&!n.utils.userAgent.EDGE,n.utils.userAgent.WEBKIT=e("WebKit")&&!n.utils.userAgent.EDGE,n.utils.userAgent.GECKO=e("Gecko")&&!n.utils.userAgent.WEBKIT&&!n.utils.userAgent.IE&&!n.utils.userAgent.EDGE,n.utils.userAgent.ANDROID=e("Android"),n.utils.userAgent.IPAD=e("iPad"),n.utils.userAgent.IPOD=e("iPod"),n.utils.userAgent.IPHONE=e("iPhone")&&!n.utils.userAgent.IPAD&&!n.utils.userAgent.IPOD,n.utils.userAgent.MAC=e("Macintosh"),n.utils.userAgent.TABLET=n.utils.userAgent.IPAD||n.utils.userAgent.ANDROID&&!e("Mobile")||e("Silk"),n.utils.userAgent.MOBILE=!n.utils.userAgent.TABLET&&(n.utils.userAgent.IPOD||n.utils.userAgent.IPHONE||n.utils.userAgent.ANDROID||e("IEMobile"))}(n.utils.global.navigator&&n.utils.global.navigator.userAgent||""),n.utils.noEvent=function(t){t.preventDefault(),t.stopPropagation()},n.utils.isTargetInput=function(t){return"textarea"==t.target.type||"text"==t.target.type||"number"==t.target.type||"email"==t.target.type||"password"==t.target.type||"search"==t.target.type||"tel"==t.target.type||"url"==t.target.type||t.target.isContentEditable||t.target.dataset&&"true"==t.target.dataset.isTextInput},n.utils.getRelativeXY=function(t){var e=new n.utils.Coordinate(0,0),i=t.getAttribute("x");return i&&(e.x=parseInt(i,10)),(i=t.getAttribute("y"))&&(e.y=parseInt(i,10)),(i=(i=t.getAttribute("transform"))&&i.match(n.utils.getRelativeXY.XY_REGEX_))&&(e.x+=Number(i[1]),i[3]&&(e.y+=Number(i[3]))),(t=t.getAttribute("style"))&&-1<t.indexOf("translate")&&(t=t.match(n.utils.getRelativeXY.XY_STYLE_REGEX_))&&(e.x+=Number(t[1]),t[3]&&(e.y+=Number(t[3]))),e},n.utils.getInjectionDivXY_=function(t){for(var e=0,i=0;t;){var o=n.utils.getRelativeXY(t);if(e+=o.x,i+=o.y,-1!=(" "+(t.getAttribute("class")||"")+" ").indexOf(" injectionDiv "))break;t=t.parentNode}return new n.utils.Coordinate(e,i)},n.utils.getRelativeXY.XY_REGEX_=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,n.utils.getRelativeXY.XY_STYLE_REGEX_=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,n.utils.isRightButton=function(t){return!(!t.ctrlKey||!n.utils.userAgent.MAC)||2==t.button},n.utils.mouseToSvg=function(t,e,n){var i=e.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,n||(n=e.getScreenCTM().inverse()),i.matrixTransform(n)},n.utils.getScrollDeltaPixels=function(t){switch(t.deltaMode){default:return{x:t.deltaX,y:t.deltaY};case 1:return{x:t.deltaX*n.LINE_MODE_MULTIPLIER,y:t.deltaY*n.LINE_MODE_MULTIPLIER};case 2:return{x:t.deltaX*n.PAGE_MODE_MULTIPLIER,y:t.deltaY*n.PAGE_MODE_MULTIPLIER}}},n.utils.tokenizeInterpolation=function(t){return n.utils.tokenizeInterpolation_(t,!0)},n.utils.replaceMessageReferences=function(t){return"string"!=typeof t?t:(t=n.utils.tokenizeInterpolation_(t,!1)).length?String(t[0]):""},n.utils.checkMessageReferences=function(t){for(var e=!0,i=n.Msg,o=t.match(/%{BKY_[A-Z]\w*}/gi),r=0;r<o.length;r++)null==i[o[r].toUpperCase().slice(6,-1)]&&(console.warn("No message string for "+o[r]+" in "+t),e=!1);return e},n.utils.tokenizeInterpolation_=function(t,e){var i=[],o=t.split("");o.push("");var r=0;t=[];for(var s=null,a=0;a<o.length;a++){var l=o[a];0==r?"%"==l?((l=t.join(""))&&i.push(l),t.length=0,r=1):t.push(l):1==r?"%"==l?(t.push(l),r=0):e&&"0"<=l&&"9">=l?(r=2,s=l,(l=t.join(""))&&i.push(l),t.length=0):"{"==l?r=3:(t.push("%",l),r=0):2==r?"0"<=l&&"9">=l?s+=l:(i.push(parseInt(s,10)),a--,r=0):3==r&&(""==l?(t.splice(0,0,"%{"),a--,r=0):"}"!=l?t.push(l):(r=t.join(""),/[A-Z]\w*/i.test(r)?(l=r.toUpperCase(),(l=n.utils.string.startsWith(l,"BKY_")?l.substring(4):null)&&l in n.Msg?"string"==typeof(r=n.Msg[l])?Array.prototype.push.apply(i,n.utils.tokenizeInterpolation_(r,e)):e?i.push(String(r)):i.push(r):i.push("%{"+r+"}")):i.push("%{"+r+"}"),r=t.length=0))}for((l=t.join(""))&&i.push(l),e=[],a=t.length=0;a<i.length;++a)"string"==typeof i[a]?t.push(i[a]):((l=t.join(""))&&e.push(l),t.length=0,e.push(i[a]));return(l=t.join(""))&&e.push(l),t.length=0,e},n.utils.genUid=function(){for(var t=n.utils.genUid.soup_.length,e=[],i=0;20>i;i++)e[i]=n.utils.genUid.soup_.charAt(Math.random()*t);return e.join("")},n.utils.genUid.soup_="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n.utils.is3dSupported=function(){if(void 0!==n.utils.is3dSupported.cached_)return n.utils.is3dSupported.cached_;if(!n.utils.global.getComputedStyle)return!1;var t=document.createElement("p"),e="none",i={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};for(var o in document.body.insertBefore(t,null),i)if(void 0!==t.style[o]){if(t.style[o]="translate3d(1px,1px,1px)",!(e=n.utils.global.getComputedStyle(t)))return document.body.removeChild(t),!1;e=e.getPropertyValue(i[o])}return document.body.removeChild(t),n.utils.is3dSupported.cached_="none"!==e,n.utils.is3dSupported.cached_},n.utils.runAfterPageLoad=function(t){if("object"!=typeof document)throw Error("Blockly.utils.runAfterPageLoad() requires browser document.");if("complete"==document.readyState)t();else var e=setInterval((function(){"complete"==document.readyState&&(clearInterval(e),t())}),10)},n.utils.getViewportBBox=function(){var t=n.utils.style.getViewportPageOffset();return new n.utils.Rect(t.y,document.documentElement.clientHeight+t.y,t.x,document.documentElement.clientWidth+t.x)},n.utils.arrayRemove=function(t,e){return-1!=(e=t.indexOf(e))&&(t.splice(e,1),!0)},n.utils.getDocumentScroll=function(){var t=document.documentElement,e=window;return n.utils.userAgent.IE&&e.pageYOffset!=t.scrollTop?new n.utils.Coordinate(t.scrollLeft,t.scrollTop):new n.utils.Coordinate(e.pageXOffset||t.scrollLeft,e.pageYOffset||t.scrollTop)},n.utils.getBlockTypeCounts=function(t,e){var n=Object.create(null),i=t.getDescendants(!0);for(e&&(t=t.getNextBlock())&&(t=i.indexOf(t),i.splice(t,i.length-t)),t=0;e=i[t];t++)n[e.type]?n[e.type]++:n[e.type]=1;return n},n.utils.screenToWsCoordinates=function(t,e){var i=e.x;e=e.y;var o=t.getInjectionDiv().getBoundingClientRect();return i=new n.utils.Coordinate(i-o.left,e-o.top),e=t.getOriginOffsetInPixels(),n.utils.Coordinate.difference(i,e).scale(1/t.scale)},n.utils.parseBlockColour=function(t){var e="string"==typeof t?n.utils.replaceMessageReferences(t):t,i=Number(e);if(!isNaN(i)&&0<=i&&360>=i)return{hue:i,hex:n.utils.colour.hsvToHex(i,n.HSV_SATURATION,255*n.HSV_VALUE)};if(i=n.utils.colour.parse(e))return{hue:null,hex:i};throw i='Invalid colour: "'+e+'"',t!=e&&(i+=' (from "'+t+'")'),Error(i)},n.Events={},n.Events.group_="",n.Events.recordUndo=!0,n.Events.disabled_=0,n.Events.CREATE="create",n.Events.BLOCK_CREATE=n.Events.CREATE,n.Events.DELETE="delete",n.Events.BLOCK_DELETE=n.Events.DELETE,n.Events.CHANGE="change",n.Events.BLOCK_CHANGE=n.Events.CHANGE,n.Events.MOVE="move",n.Events.BLOCK_MOVE=n.Events.MOVE,n.Events.VAR_CREATE="var_create",n.Events.VAR_DELETE="var_delete",n.Events.VAR_RENAME="var_rename",n.Events.UI="ui",n.Events.BLOCK_DRAG="drag",n.Events.SELECTED="selected",n.Events.CLICK="click",n.Events.MARKER_MOVE="marker_move",n.Events.BUBBLE_OPEN="bubble_open",n.Events.TRASHCAN_OPEN="trashcan_open",n.Events.TOOLBOX_ITEM_SELECT="toolbox_item_select",n.Events.THEME_CHANGE="theme_change",n.Events.VIEWPORT_CHANGE="viewport_change",n.Events.COMMENT_CREATE="comment_create",n.Events.COMMENT_DELETE="comment_delete",n.Events.COMMENT_CHANGE="comment_change",n.Events.COMMENT_MOVE="comment_move",n.Events.FINISHED_LOADING="finished_loading",n.Events.BUMP_EVENTS=[n.Events.BLOCK_CREATE,n.Events.BLOCK_MOVE,n.Events.COMMENT_CREATE,n.Events.COMMENT_MOVE],n.Events.FIRE_QUEUE_=[],n.Events.fire=function(t){n.Events.isEnabled()&&(n.Events.FIRE_QUEUE_.length||setTimeout(n.Events.fireNow_,0),n.Events.FIRE_QUEUE_.push(t))},n.Events.fireNow_=function(){for(var t,e=n.Events.filter(n.Events.FIRE_QUEUE_,!0),i=n.Events.FIRE_QUEUE_.length=0;t=e[i];i++)if(t.workspaceId){var o=n.Workspace.getById(t.workspaceId);o&&o.fireChangeListener(t)}},n.Events.filter=function(t,e){t=t.slice(),e||t.reverse();for(var i,o=[],r=Object.create(null),s=0;i=t[s];s++)if(!i.isNull()){var a=[i.isUiEvent?n.Events.UI:i.type,i.blockId,i.workspaceId].join(" "),l=r[a],c=l?l.event:null;l?i.type==n.Events.MOVE&&l.index==s-1?(c.newParentId=i.newParentId,c.newInputName=i.newInputName,c.newCoordinate=i.newCoordinate,l.index=s):i.type==n.Events.CHANGE&&i.element==c.element&&i.name==c.name?c.newValue=i.newValue:i.type==n.Events.CLICK&&c.type==n.Events.BUBBLE_OPEN||(r[a]={event:i,index:s},o.push(i)):(r[a]={event:i,index:s},o.push(i))}for(t=o.filter((function(t){return!t.isNull()})),e||t.reverse(),s=1;i=t[s];s++)i.type==n.Events.CHANGE&&"mutation"==i.element&&t.unshift(t.splice(s,1)[0]);return t},n.Events.clearPendingUndo=function(){for(var t,e=0;t=n.Events.FIRE_QUEUE_[e];e++)t.recordUndo=!1},n.Events.disable=function(){n.Events.disabled_++},n.Events.enable=function(){n.Events.disabled_--},n.Events.isEnabled=function(){return 0==n.Events.disabled_},n.Events.getGroup=function(){return n.Events.group_},n.Events.setGroup=function(t){n.Events.group_="boolean"==typeof t?t?n.utils.genUid():"":t},n.Events.getDescendantIds=function(t){var e=[];t=t.getDescendants(!1);for(var n,i=0;n=t[i];i++)e[i]=n.id;return e},n.Events.fromJson=function(t,e){var i=n.registry.getClass(n.registry.Type.EVENT,t.type);if(!i)throw Error("Unknown event type.");return(i=new i).fromJson(t),i.workspaceId=e.id,i},n.Events.disableOrphans=function(t){if((t.type==n.Events.MOVE||t.type==n.Events.CREATE)&&t.workspaceId){var e=n.Workspace.getById(t.workspaceId),i=e.getBlockById(t.blockId);if(i){t=n.Events.recordUndo;try{n.Events.recordUndo=!1;var o=i.getParent();if(o&&o.isEnabled()){var r,s=i.getDescendants(!1);for(e=0;r=s[e];e++)r.setEnabled(!0)}else if((i.outputConnection||i.previousConnection)&&!e.isDragging())do{i.setEnabled(!1),i=i.getNextBlock()}while(i)}finally{n.Events.recordUndo=t}}}},n.Events.Abstract=function(){this.isBlank=null,this.workspaceId=void 0,this.group=n.Events.getGroup(),this.recordUndo=n.Events.recordUndo},n.Events.Abstract.prototype.isUiEvent=!1,n.Events.Abstract.prototype.toJson=function(){var t={type:this.type};return this.group&&(t.group=this.group),t},n.Events.Abstract.prototype.fromJson=function(t){this.isBlank=!1,this.group=t.group},n.Events.Abstract.prototype.isNull=function(){return!1},n.Events.Abstract.prototype.run=function(t){},n.Events.Abstract.prototype.getEventWorkspace_=function(){if(this.workspaceId)var t=n.Workspace.getById(this.workspaceId);if(!t)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return t},n.utils.object={},n.utils.object.inherits=function(t,e){t.superClass_=e.prototype,t.prototype=Object.create(e.prototype),t.prototype.constructor=t},n.utils.object.mixin=function(t,e){for(var n in e)t[n]=e[n]},n.utils.object.deepMerge=function(t,e){for(var i in e)t[i]=null!=e[i]&&"object"==typeof e[i]?n.utils.object.deepMerge(t[i]||Object.create(null),e[i]):e[i];return t},n.utils.object.values=function(t){return Object.values?Object.values(t):Object.keys(t).map((function(e){return t[e]}))},n.Events.UiBase=function(t){n.Events.UiBase.superClass_.constructor.call(this),this.isBlank=void 0===t,this.workspaceId=t||"",this.recordUndo=!1},n.utils.object.inherits(n.Events.UiBase,n.Events.Abstract),n.Events.UiBase.prototype.isUiEvent=!0,n.Events.Ui=function(t,e,i,o){n.Events.Ui.superClass_.constructor.call(this,t?t.workspace.id:void 0),this.blockId=t?t.id:null,this.element=void 0===e?"":e,this.oldValue=void 0===i?"":i,this.newValue=void 0===o?"":o},n.utils.object.inherits(n.Events.Ui,n.Events.UiBase),n.Events.Ui.prototype.type=n.Events.UI,n.Events.Ui.prototype.toJson=function(){var t=n.Events.Ui.superClass_.toJson.call(this);return t.element=this.element,void 0!==this.newValue&&(t.newValue=this.newValue),this.blockId&&(t.blockId=this.blockId),t},n.Events.Ui.prototype.fromJson=function(t){n.Events.Ui.superClass_.fromJson.call(this,t),this.element=t.element,this.newValue=t.newValue,this.blockId=t.blockId},n.registry.register(n.registry.Type.EVENT,n.Events.UI,n.Events.Ui),n.utils.Svg=function(t){this.tagName_=t},n.utils.Svg.prototype.toString=function(){return this.tagName_},n.utils.Svg.ANIMATE=new n.utils.Svg("animate"),n.utils.Svg.CIRCLE=new n.utils.Svg("circle"),n.utils.Svg.CLIPPATH=new n.utils.Svg("clipPath"),n.utils.Svg.DEFS=new n.utils.Svg("defs"),n.utils.Svg.FECOMPOSITE=new n.utils.Svg("feComposite"),n.utils.Svg.FECOMPONENTTRANSFER=new n.utils.Svg("feComponentTransfer"),n.utils.Svg.FEFLOOD=new n.utils.Svg("feFlood"),n.utils.Svg.FEFUNCA=new n.utils.Svg("feFuncA"),n.utils.Svg.FEGAUSSIANBLUR=new n.utils.Svg("feGaussianBlur"),n.utils.Svg.FEPOINTLIGHT=new n.utils.Svg("fePointLight"),n.utils.Svg.FESPECULARLIGHTING=new n.utils.Svg("feSpecularLighting"),n.utils.Svg.FILTER=new n.utils.Svg("filter"),n.utils.Svg.FOREIGNOBJECT=new n.utils.Svg("foreignObject"),n.utils.Svg.G=new n.utils.Svg("g"),n.utils.Svg.IMAGE=new n.utils.Svg("image"),n.utils.Svg.LINE=new n.utils.Svg("line"),n.utils.Svg.PATH=new n.utils.Svg("path"),n.utils.Svg.PATTERN=new n.utils.Svg("pattern"),n.utils.Svg.POLYGON=new n.utils.Svg("polygon"),n.utils.Svg.RECT=new n.utils.Svg("rect"),n.utils.Svg.SVG=new n.utils.Svg("svg"),n.utils.Svg.TEXT=new n.utils.Svg("text"),n.utils.Svg.TSPAN=new n.utils.Svg("tspan"),n.utils.dom={},n.utils.dom.SVG_NS="http://www.w3.org/2000/svg",n.utils.dom.HTML_NS="http://www.w3.org/1999/xhtml",n.utils.dom.XLINK_NS="http://www.w3.org/1999/xlink",n.utils.dom.NodeType={ELEMENT_NODE:1,TEXT_NODE:3,COMMENT_NODE:8,DOCUMENT_POSITION_CONTAINED_BY:16},n.utils.dom.cacheWidths_=null,n.utils.dom.cacheReference_=0,n.utils.dom.canvasContext_=null,n.utils.dom.createSvgElement=function(t,e,i){for(var o in t=document.createElementNS(n.utils.dom.SVG_NS,String(t)),e)t.setAttribute(o,e[o]);return document.body.runtimeStyle&&(t.runtimeStyle=t.currentStyle=t.style),i&&i.appendChild(t),t},n.utils.dom.addClass=function(t,e){var n=t.getAttribute("class")||"";return-1==(" "+n+" ").indexOf(" "+e+" ")&&(n&&(n+=" "),t.setAttribute("class",n+e),!0)},n.utils.dom.removeClasses=function(t,e){e=e.split(" ");for(var i=0;i<e.length;i++)n.utils.dom.removeClass(t,e[i])},n.utils.dom.removeClass=function(t,e){var n=t.getAttribute("class");if(-1==(" "+n+" ").indexOf(" "+e+" "))return!1;n=n.split(/\s+/);for(var i=0;i<n.length;i++)n[i]&&n[i]!=e||(n.splice(i,1),i--);return n.length?t.setAttribute("class",n.join(" ")):t.removeAttribute("class"),!0},n.utils.dom.hasClass=function(t,e){return-1!=(" "+t.getAttribute("class")+" ").indexOf(" "+e+" ")},n.utils.dom.removeNode=function(t){return t&&t.parentNode?t.parentNode.removeChild(t):null},n.utils.dom.insertAfter=function(t,e){var n=e.nextSibling;if(!(e=e.parentNode))throw Error("Reference node has no parent.");n?e.insertBefore(t,n):e.appendChild(t)},n.utils.dom.containsNode=function(t,e){return!!(t.compareDocumentPosition(e)&n.utils.dom.NodeType.DOCUMENT_POSITION_CONTAINED_BY)},n.utils.dom.setCssTransform=function(t,e){t.style.transform=e,t.style["-webkit-transform"]=e},n.utils.dom.startTextWidthCache=function(){n.utils.dom.cacheReference_++,n.utils.dom.cacheWidths_||(n.utils.dom.cacheWidths_={})},n.utils.dom.stopTextWidthCache=function(){n.utils.dom.cacheReference_--,n.utils.dom.cacheReference_||(n.utils.dom.cacheWidths_=null)},n.utils.dom.getTextWidth=function(t){var e,i=t.textContent+"\n"+t.className.baseVal;if(n.utils.dom.cacheWidths_&&(e=n.utils.dom.cacheWidths_[i]))return e;try{e=n.utils.userAgent.IE||n.utils.userAgent.EDGE?t.getBBox().width:t.getComputedTextLength()}catch(e){return 8*t.textContent.length}return n.utils.dom.cacheWidths_&&(n.utils.dom.cacheWidths_[i]=e),e},n.utils.dom.getFastTextWidth=function(t,e,i,o){return n.utils.dom.getFastTextWidthWithSizeString(t,e+"pt",i,o)},n.utils.dom.getFastTextWidthWithSizeString=function(t,e,i,o){var r,s=t.textContent;return t=s+"\n"+t.className.baseVal,n.utils.dom.cacheWidths_&&(r=n.utils.dom.cacheWidths_[t])||(n.utils.dom.canvasContext_||((r=document.createElement("canvas")).className="blocklyComputeCanvas",n.shadowRoot?n.shadowRoot.appendChild(r):document.body.appendChild(r),n.utils.dom.canvasContext_=r.getContext("2d")),n.utils.dom.canvasContext_.font=i+" "+e+" "+o,r=n.utils.dom.canvasContext_.measureText(s).width,n.utils.dom.cacheWidths_&&(n.utils.dom.cacheWidths_[t]=r)),r},n.utils.dom.measureFontMetrics=function(t,e,n,i){var o=document.createElement("span");o.style.font=n+" "+e+" "+i,o.textContent=t,(t=document.createElement("div")).style.width="1px",t.style.height="0px",(e=document.createElement("div")).setAttribute("style","position: fixed; top: 0; left: 0; display: flex;"),e.appendChild(o),e.appendChild(t),document.body.appendChild(e);try{n={},e.style.alignItems="baseline",n.baseline=t.offsetTop-o.offsetTop,e.style.alignItems="flex-end",n.height=t.offsetTop-o.offsetTop}finally{document.body.removeChild(e)}return n},n.BlockDragSurfaceSvg=function(t){this.container_=t,this.createDom()},n.BlockDragSurfaceSvg.prototype.SVG_=null,n.BlockDragSurfaceSvg.prototype.dragGroup_=null,n.BlockDragSurfaceSvg.prototype.container_=null,n.BlockDragSurfaceSvg.prototype.scale_=1,n.BlockDragSurfaceSvg.prototype.surfaceXY_=null,n.BlockDragSurfaceSvg.prototype.createDom=function(){this.SVG_||(this.SVG_=n.utils.dom.createSvgElement(n.utils.Svg.SVG,{xmlns:n.utils.dom.SVG_NS,"xmlns:html":n.utils.dom.HTML_NS,"xmlns:xlink":n.utils.dom.XLINK_NS,version:"1.1",class:"blocklyBlockDragSurface"},this.container_),this.dragGroup_=n.utils.dom.createSvgElement(n.utils.Svg.G,{},this.SVG_))},n.BlockDragSurfaceSvg.prototype.setBlocksAndShow=function(t){if(this.dragGroup_.childNodes.length)throw Error("Already dragging a block.");this.dragGroup_.appendChild(t),this.SVG_.style.display="block",this.surfaceXY_=new n.utils.Coordinate(0,0)},n.BlockDragSurfaceSvg.prototype.translateAndScaleGroup=function(t,e,n){this.scale_=n,t=t.toFixed(0),e=e.toFixed(0),this.dragGroup_.setAttribute("transform","translate("+t+","+e+") scale("+n+")")},n.BlockDragSurfaceSvg.prototype.translateSurfaceInternal_=function(){var t=this.surfaceXY_.x,e=this.surfaceXY_.y;t=t.toFixed(0),e=e.toFixed(0),this.SVG_.style.display="block",n.utils.dom.setCssTransform(this.SVG_,"translate3d("+t+"px, "+e+"px, 0px)")},n.BlockDragSurfaceSvg.prototype.translateSurface=function(t,e){this.surfaceXY_=new n.utils.Coordinate(t*this.scale_,e*this.scale_),this.translateSurfaceInternal_()},n.BlockDragSurfaceSvg.prototype.getSurfaceTranslation=function(){var t=n.utils.getRelativeXY(this.SVG_);return new n.utils.Coordinate(t.x/this.scale_,t.y/this.scale_)},n.BlockDragSurfaceSvg.prototype.getGroup=function(){return this.dragGroup_},n.BlockDragSurfaceSvg.prototype.getCurrentBlock=function(){return this.dragGroup_.firstChild},n.BlockDragSurfaceSvg.prototype.clearAndHide=function(t){if(t?t.appendChild(this.getCurrentBlock()):this.dragGroup_.removeChild(this.getCurrentBlock()),this.SVG_.style.display="none",this.dragGroup_.childNodes.length)throw Error("Drag group was not cleared.");this.surfaceXY_=null},n.Css={},n.Css.injected_=!1,n.Css.register=function(t){if(n.Css.injected_)throw Error("CSS already injected");Array.prototype.push.apply(n.Css.CONTENT,t),t.length=0},n.Css.inject=function(t,e){if(!n.Css.injected_){n.Css.injected_=!0;var i=n.Css.CONTENT.join("\n");n.Css.CONTENT.length=0,t&&(t=e.replace(/[\\/]$/,""),i=i.replace(/<<<PATH>>>/g,t),(t=document.createElement("style")).id="blockly-common-style",i=document.createTextNode(i),t.appendChild(i),n.shadowRoot?n.shadowRoot.appendChild(t):document.head.insertBefore(t,document.head.firstChild))}},n.Css.CONTENT=[".blocklySvg {","background-color: #fff;","outline: none;","overflow: hidden;","position: absolute;","display: block;","}",".blocklyWidgetDiv {","display: none;","position: absolute;","z-index: 99999;","}",".injectionDiv {","height: 100%;","position: relative;","overflow: hidden;","touch-action: none;","}",".blocklyNonSelectable {","user-select: none;","-ms-user-select: none;","-webkit-user-select: none;","}",".blocklyWsDragSurface {","display: none;","position: absolute;","top: 0;","left: 0;","}",".blocklyWsDragSurface.blocklyOverflowVisible {","overflow: visible;","}",".blocklyBlockDragSurface {","display: none;","position: absolute;","top: 0;","left: 0;","right: 0;","bottom: 0;","overflow: visible !important;","z-index: 50;","}",".blocklyBlockCanvas.blocklyCanvasTransitioning,",".blocklyBubbleCanvas.blocklyCanvasTransitioning {","transition: transform .5s;","}",".blocklyTooltipDiv {","background-color: #ffffc7;","border: 1px solid #ddc;","box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);","color: #000;","display: none;","font: 9pt sans-serif;","opacity: .9;","padding: 2px;","position: absolute;","z-index: 100000;","}",".blocklyDropDownDiv {","position: absolute;","left: 0;","top: 0;","z-index: 1000;","display: none;","border: 1px solid;","border-color: #dadce0;","background-color: #fff;","border-radius: 2px;","padding: 4px;","box-shadow: 0 0 3px 1px rgba(0,0,0,.3);","}",".blocklyDropDownDiv.blocklyFocused {","box-shadow: 0 0 6px 1px rgba(0,0,0,.3);","}",".blocklyDropDownContent {","max-height: 300px;","overflow: auto;","overflow-x: hidden;","position: relative;","}",".blocklyDropDownArrow {","position: absolute;","left: 0;","top: 0;","width: 16px;","height: 16px;","z-index: -1;","background-color: inherit;","border-color: inherit;","}",".blocklyDropDownButton {","display: inline-block;","float: left;","padding: 0;","margin: 4px;","border-radius: 4px;","outline: none;","border: 1px solid;","transition: box-shadow .1s;","cursor: pointer;","}",".blocklyArrowTop {","border-top: 1px solid;","border-left: 1px solid;","border-top-left-radius: 4px;","border-color: inherit;","}",".blocklyArrowBottom {","border-bottom: 1px solid;","border-right: 1px solid;","border-bottom-right-radius: 4px;","border-color: inherit;","}",".blocklyResizeSE {","cursor: se-resize;","fill: #aaa;","}",".blocklyResizeSW {","cursor: sw-resize;","fill: #aaa;","}",".blocklyResizeLine {","stroke: #515A5A;","stroke-width: 1;","}",".blocklyHighlightedConnectionPath {","fill: none;","stroke: #fc3;","stroke-width: 4px;","}",".blocklyPathLight {","fill: none;","stroke-linecap: round;","stroke-width: 1;","}",".blocklySelected>.blocklyPathLight {","display: none;","}",".blocklyDraggable {",'cursor: url("<<<PATH>>>/handopen.cur"), auto;',"cursor: grab;","cursor: -webkit-grab;","}",".blocklyDragging {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyDraggable:active {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyBlockDragSurface .blocklyDraggable {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyDragging.blocklyDraggingDelete {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyDragging>.blocklyPath,",".blocklyDragging>.blocklyPathLight {","fill-opacity: .8;","stroke-opacity: .8;","}",".blocklyDragging>.blocklyPathDark {","display: none;","}",".blocklyDisabled>.blocklyPath {","fill-opacity: .5;","stroke-opacity: .5;","}",".blocklyDisabled>.blocklyPathLight,",".blocklyDisabled>.blocklyPathDark {","display: none;","}",".blocklyInsertionMarker>.blocklyPath,",".blocklyInsertionMarker>.blocklyPathLight,",".blocklyInsertionMarker>.blocklyPathDark {","fill-opacity: .2;","stroke: none;","}",".blocklyMultilineText {","font-family: monospace;","}",".blocklyNonEditableText>text {","pointer-events: none;","}",".blocklyFlyout {","position: absolute;","z-index: 20;","}",".blocklyText text {","cursor: default;","}",".blocklySvg text,",".blocklyBlockDragSurface text {","user-select: none;","-ms-user-select: none;","-webkit-user-select: none;","cursor: inherit;","}",".blocklyHidden {","display: none;","}",".blocklyFieldDropdown:not(.blocklyHidden) {","display: block;","}",".blocklyIconGroup {","cursor: default;","}",".blocklyIconGroup:not(:hover),",".blocklyIconGroupReadonly {","opacity: .6;","}",".blocklyIconShape {","fill: #00f;","stroke: #fff;","stroke-width: 1px;","}",".blocklyIconSymbol {","fill: #fff;","}",".blocklyMinimalBody {","margin: 0;","padding: 0;","}",".blocklyHtmlInput {","border: none;","border-radius: 4px;","height: 100%;","margin: 0;","outline: none;","padding: 0;","width: 100%;","text-align: center;","display: block;","box-sizing: border-box;","}",".blocklyHtmlInput::-ms-clear {","display: none;","}",".blocklyMainBackground {","stroke-width: 1;","stroke: #c6c6c6;","}",".blocklyMutatorBackground {","fill: #fff;","stroke: #ddd;","stroke-width: 1;","}",".blocklyFlyoutBackground {","fill: #ddd;","fill-opacity: .8;","}",".blocklyMainWorkspaceScrollbar {","z-index: 20;","}",".blocklyFlyoutScrollbar {","z-index: 30;","}",".blocklyScrollbarHorizontal,",".blocklyScrollbarVertical {","position: absolute;","outline: none;","}",".blocklyScrollbarBackground {","opacity: 0;","}",".blocklyScrollbarHandle {","fill: #ccc;","}",".blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,",".blocklyScrollbarHandle:hover {","fill: #bbb;","}",".blocklyFlyout .blocklyScrollbarHandle {","fill: #bbb;","}",".blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,",".blocklyFlyout .blocklyScrollbarHandle:hover {","fill: #aaa;","}",".blocklyInvalidInput {","background: #faa;","}",".blocklyVerticalMarker {","stroke-width: 3px;","fill: rgba(255,255,255,.5);","pointer-events: none;","}",".blocklyComputeCanvas {","position: absolute;","width: 0;","height: 0;","}",".blocklyNoPointerEvents {","pointer-events: none;","}",".blocklyContextMenu {","border-radius: 4px;","max-height: 100%;","}",".blocklyDropdownMenu {","border-radius: 2px;","padding: 0 !important;","}",".blocklyDropdownMenu .blocklyMenuItem {","padding-left: 28px;","}",".blocklyDropdownMenu .blocklyMenuItemRtl {","padding-left: 5px;","padding-right: 28px;","}",".blocklyWidgetDiv .blocklyMenu {","background: #fff;","border: 1px solid transparent;","box-shadow: 0 0 3px 1px rgba(0,0,0,.3);","font: normal 13px Arial, sans-serif;","margin: 0;","outline: none;","padding: 4px 0;","position: absolute;","overflow-y: auto;","overflow-x: hidden;","max-height: 100%;","z-index: 20000;","}",".blocklyWidgetDiv .blocklyMenu.blocklyFocused {","box-shadow: 0 0 6px 1px rgba(0,0,0,.3);","}",".blocklyDropDownDiv .blocklyMenu {","background: inherit;","border: inherit;",'font: normal 13px "Helvetica Neue", Helvetica, sans-serif;',"outline: none;","position: relative;","z-index: 20000;","}",".blocklyMenuItem {","border: none;","color: #000;","cursor: pointer;","list-style: none;","margin: 0;","min-width: 7em;","padding: 6px 15px;","white-space: nowrap;","}",".blocklyMenuItemDisabled {","color: #ccc;","cursor: inherit;","}",".blocklyMenuItemHighlight {","background-color: rgba(0,0,0,.1);","}",".blocklyMenuItemCheckbox {","height: 16px;","position: absolute;","width: 16px;","}",".blocklyMenuItemSelected .blocklyMenuItemCheckbox {","background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;","float: left;","margin-left: -24px;","position: static;","}",".blocklyMenuItemRtl .blocklyMenuItemCheckbox {","float: right;","margin-right: -24px;","}"],n.utils.math={},n.utils.math.toRadians=function(t){return t*Math.PI/180},n.utils.math.toDegrees=function(t){return 180*t/Math.PI},n.utils.math.clamp=function(t,e,n){if(n<t){var i=n;n=t,t=i}return Math.max(t,Math.min(e,n))},n.DropDownDiv=function(){},n.DropDownDiv.boundsElement_=null,n.DropDownDiv.owner_=null,n.DropDownDiv.positionToField_=null,n.DropDownDiv.ARROW_SIZE=16,n.DropDownDiv.BORDER_SIZE=1,n.DropDownDiv.ARROW_HORIZONTAL_PADDING=12,n.DropDownDiv.PADDING_Y=16,n.DropDownDiv.ANIMATION_TIME=.25,n.DropDownDiv.animateOutTimer_=null,n.DropDownDiv.onHide_=null,n.DropDownDiv.rendererClassName_="",n.DropDownDiv.themeClassName_="",n.DropDownDiv.createDom=function(){if(!n.DropDownDiv.DIV_){var t=document.createElement("div");t.className="blocklyDropDownDiv",(n.parentContainer||n.shadowRoot||document.body).appendChild(t),n.DropDownDiv.DIV_=t;var e=document.createElement("div");e.className="blocklyDropDownContent",t.appendChild(e),n.DropDownDiv.content_=e,(e=document.createElement("div")).className="blocklyDropDownArrow",t.appendChild(e),n.DropDownDiv.arrow_=e,n.DropDownDiv.DIV_.style.opacity=0,n.DropDownDiv.DIV_.style.transition="transform "+n.DropDownDiv.ANIMATION_TIME+"s, opacity "+n.DropDownDiv.ANIMATION_TIME+"s",t.addEventListener("focusin",(function(){n.utils.dom.addClass(t,"blocklyFocused")})),t.addEventListener("focusout",(function(){n.utils.dom.removeClass(t,"blocklyFocused")}))}},n.DropDownDiv.setBoundsElement=function(t){n.DropDownDiv.boundsElement_=t},n.DropDownDiv.getContentDiv=function(){return n.DropDownDiv.content_},n.DropDownDiv.clearContent=function(){n.DropDownDiv.content_.textContent="",n.DropDownDiv.content_.style.width=""},n.DropDownDiv.setColour=function(t,e){n.DropDownDiv.DIV_.style.backgroundColor=t,n.DropDownDiv.DIV_.style.borderColor=e},n.DropDownDiv.showPositionedByBlock=function(t,e,i,o){return n.DropDownDiv.showPositionedByRect_(n.DropDownDiv.getScaledBboxOfBlock_(e),t,i,o)},n.DropDownDiv.showPositionedByField=function(t,e,i){return n.DropDownDiv.positionToField_=!0,n.DropDownDiv.showPositionedByRect_(n.DropDownDiv.getScaledBboxOfField_(t),t,e,i)},n.DropDownDiv.getScaledBboxOfBlock_=function(t){var e=t.getSvgRoot(),i=e.getBBox(),o=t.workspace.scale;return t=i.height*o,i=i.width*o,e=n.utils.style.getPageOffset(e),new n.utils.Rect(e.y,e.y+t,e.x,e.x+i)},n.DropDownDiv.getScaledBboxOfField_=function(t){return t=t.getScaledBBox(),new n.utils.Rect(t.top,t.bottom,t.left,t.right)},n.DropDownDiv.showPositionedByRect_=function(t,e,i,o){var r=t.left+(t.right-t.left)/2,s=t.bottom;t=t.top,o&&(t+=o);for(var a=(o=e.getSourceBlock()).workspace;a.options.parentWorkspace;)a=a.options.parentWorkspace;return n.DropDownDiv.setBoundsElement(a.getParentSvg().parentNode),n.DropDownDiv.show(e,o.RTL,r,s,r,t,i)},n.DropDownDiv.show=function(t,e,i,o,r,s,a){return n.DropDownDiv.owner_=t,n.DropDownDiv.onHide_=a||null,(t=n.DropDownDiv.DIV_).style.direction=e?"rtl":"ltr",e=n.getMainWorkspace(),n.DropDownDiv.rendererClassName_=e.getRenderer().getClassName(),n.DropDownDiv.themeClassName_=e.getTheme().getClassName(),n.utils.dom.addClass(t,n.DropDownDiv.rendererClassName_),n.utils.dom.addClass(t,n.DropDownDiv.themeClassName_),n.DropDownDiv.positionInternal_(i,o,r,s)},n.DropDownDiv.getBoundsInfo_=function(){var t=n.utils.style.getPageOffset(n.DropDownDiv.boundsElement_),e=n.utils.style.getSize(n.DropDownDiv.boundsElement_);return{left:t.x,right:t.x+e.width,top:t.y,bottom:t.y+e.height,width:e.width,height:e.height}},n.DropDownDiv.getPositionMetrics_=function(t,e,i,o){var r=n.DropDownDiv.getBoundsInfo_(),s=n.utils.style.getSize(n.DropDownDiv.DIV_);return e+s.height<r.bottom?n.DropDownDiv.getPositionBelowMetrics_(t,e,r,s):o-s.height>r.top?n.DropDownDiv.getPositionAboveMetrics_(i,o,r,s):e+s.height<document.documentElement.clientHeight?n.DropDownDiv.getPositionBelowMetrics_(t,e,r,s):o-s.height>document.documentElement.clientTop?n.DropDownDiv.getPositionAboveMetrics_(i,o,r,s):n.DropDownDiv.getPositionTopOfPageMetrics_(t,r,s)},n.DropDownDiv.getPositionBelowMetrics_=function(t,e,i,o){return{initialX:(t=n.DropDownDiv.getPositionX(t,i.left,i.right,o.width)).divX,initialY:e,finalX:t.divX,finalY:e+n.DropDownDiv.PADDING_Y,arrowX:t.arrowX,arrowY:-(n.DropDownDiv.ARROW_SIZE/2+n.DropDownDiv.BORDER_SIZE),arrowAtTop:!0,arrowVisible:!0}},n.DropDownDiv.getPositionAboveMetrics_=function(t,e,i,o){return{initialX:(t=n.DropDownDiv.getPositionX(t,i.left,i.right,o.width)).divX,initialY:e-o.height,finalX:t.divX,finalY:e-o.height-n.DropDownDiv.PADDING_Y,arrowX:t.arrowX,arrowY:o.height-2*n.DropDownDiv.BORDER_SIZE-n.DropDownDiv.ARROW_SIZE/2,arrowAtTop:!1,arrowVisible:!0}},n.DropDownDiv.getPositionTopOfPageMetrics_=function(t,e,i){return{initialX:(t=n.DropDownDiv.getPositionX(t,e.left,e.right,i.width)).divX,initialY:0,finalX:t.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:!1}},n.DropDownDiv.getPositionX=function(t,e,i,o){var r=t;return t=n.utils.math.clamp(e,t-o/2,i-o),r-=n.DropDownDiv.ARROW_SIZE/2,e=n.DropDownDiv.ARROW_HORIZONTAL_PADDING,{arrowX:o=n.utils.math.clamp(e,r-t,o-e-n.DropDownDiv.ARROW_SIZE),divX:t}},n.DropDownDiv.isVisible=function(){return!!n.DropDownDiv.owner_},n.DropDownDiv.hideIfOwner=function(t,e){return n.DropDownDiv.owner_===t&&(e?n.DropDownDiv.hideWithoutAnimation():n.DropDownDiv.hide(),!0)},n.DropDownDiv.hide=function(){var t=n.DropDownDiv.DIV_;t.style.transform="translate(0, 0)",t.style.opacity=0,n.DropDownDiv.animateOutTimer_=setTimeout((function(){n.DropDownDiv.hideWithoutAnimation()}),1e3*n.DropDownDiv.ANIMATION_TIME),n.DropDownDiv.onHide_&&(n.DropDownDiv.onHide_(),n.DropDownDiv.onHide_=null)},n.DropDownDiv.hideWithoutAnimation=function(){if(n.DropDownDiv.isVisible()){n.DropDownDiv.animateOutTimer_&&clearTimeout(n.DropDownDiv.animateOutTimer_);var t=n.DropDownDiv.DIV_;t.style.transform="",t.style.left="",t.style.top="",t.style.opacity=0,t.style.display="none",t.style.backgroundColor="",t.style.borderColor="",n.DropDownDiv.onHide_&&(n.DropDownDiv.onHide_(),n.DropDownDiv.onHide_=null),n.DropDownDiv.clearContent(),n.DropDownDiv.owner_=null,n.DropDownDiv.rendererClassName_&&(n.utils.dom.removeClass(t,n.DropDownDiv.rendererClassName_),n.DropDownDiv.rendererClassName_=""),n.DropDownDiv.themeClassName_&&(n.utils.dom.removeClass(t,n.DropDownDiv.themeClassName_),n.DropDownDiv.themeClassName_=""),n.getMainWorkspace().markFocused()}},n.DropDownDiv.positionInternal_=function(t,e,i,o){(t=n.DropDownDiv.getPositionMetrics_(t,e,i,o)).arrowVisible?(n.DropDownDiv.arrow_.style.display="",n.DropDownDiv.arrow_.style.transform="translate("+t.arrowX+"px,"+t.arrowY+"px) rotate(45deg)",n.DropDownDiv.arrow_.setAttribute("class",t.arrowAtTop?"blocklyDropDownArrow blocklyArrowTop":"blocklyDropDownArrow blocklyArrowBottom")):n.DropDownDiv.arrow_.style.display="none",e=Math.floor(t.initialX),i=Math.floor(t.initialY),o=Math.floor(t.finalX);var r=Math.floor(t.finalY),s=n.DropDownDiv.DIV_;return s.style.left=e+"px",s.style.top=i+"px",s.style.display="block",s.style.opacity=1,s.style.transform="translate("+(o-e)+"px,"+(r-i)+"px)",!!t.arrowAtTop},n.DropDownDiv.repositionForWindowResize=function(){if(n.DropDownDiv.owner_){var t=n.DropDownDiv.owner_,e=t.getSourceBlock();e=(t=n.DropDownDiv.positionToField_?n.DropDownDiv.getScaledBboxOfField_(t):n.DropDownDiv.getScaledBboxOfBlock_(e)).left+(t.right-t.left)/2,n.DropDownDiv.positionInternal_(e,t.bottom,e,t.top)}else n.DropDownDiv.hide()},n.Grid=function(t,e){this.gridPattern_=t,this.spacing_=e.spacing,this.length_=e.length,this.line2_=(this.line1_=t.firstChild)&&this.line1_.nextSibling,this.snapToGrid_=e.snap},n.Grid.prototype.scale_=1,n.Grid.prototype.dispose=function(){this.gridPattern_=null},n.Grid.prototype.shouldSnap=function(){return this.snapToGrid_},n.Grid.prototype.getSpacing=function(){return this.spacing_},n.Grid.prototype.getPatternId=function(){return this.gridPattern_.id},n.Grid.prototype.update=function(t){this.scale_=t;var e=this.spacing_*t||100;this.gridPattern_.setAttribute("width",e),this.gridPattern_.setAttribute("height",e);var n=(e=Math.floor(this.spacing_/2)+.5)-this.length_/2,i=e+this.length_/2;e*=t,n*=t,i*=t,this.setLineAttributes_(this.line1_,t,n,i,e,e),this.setLineAttributes_(this.line2_,t,e,e,n,i)},n.Grid.prototype.setLineAttributes_=function(t,e,n,i,o,r){t&&(t.setAttribute("stroke-width",e),t.setAttribute("x1",n),t.setAttribute("y1",o),t.setAttribute("x2",i),t.setAttribute("y2",r))},n.Grid.prototype.moveTo=function(t,e){this.gridPattern_.setAttribute("x",t),this.gridPattern_.setAttribute("y",e),(n.utils.userAgent.IE||n.utils.userAgent.EDGE)&&this.update(this.scale_)},n.Grid.createDom=function(t,e,i){return t=n.utils.dom.createSvgElement(n.utils.Svg.PATTERN,{id:"blocklyGridPattern"+t,patternUnits:"userSpaceOnUse"},i),0<e.length&&0<e.spacing?(n.utils.dom.createSvgElement(n.utils.Svg.LINE,{stroke:e.colour},t),1<e.length&&n.utils.dom.createSvgElement(n.utils.Svg.LINE,{stroke:e.colour},t)):n.utils.dom.createSvgElement(n.utils.Svg.LINE,{},t),t},n.Theme=function(t,e,i,o){this.name=t,this.blockStyles=e||Object.create(null),this.categoryStyles=i||Object.create(null),this.componentStyles=o||Object.create(null),this.fontStyle=Object.create(null),this.startHats=null,n.registry.register(n.registry.Type.THEME,t,this)},n.Theme.prototype.getClassName=function(){return this.name+"-theme"},n.Theme.prototype.setBlockStyle=function(t,e){this.blockStyles[t]=e},n.Theme.prototype.setCategoryStyle=function(t,e){this.categoryStyles[t]=e},n.Theme.prototype.getComponentStyle=function(t){return(t=this.componentStyles[t])&&"string"==typeof t&&this.getComponentStyle(t)?this.getComponentStyle(t):t?String(t):null},n.Theme.prototype.setComponentStyle=function(t,e){this.componentStyles[t]=e},n.Theme.prototype.setFontStyle=function(t){this.fontStyle=t},n.Theme.prototype.setStartHats=function(t){this.startHats=t},n.Theme.defineTheme=function(t,e){var i=new n.Theme(t),o=e.base;return o&&("string"==typeof o&&(o=n.registry.getObject(n.registry.Type.THEME,o)),o instanceof n.Theme&&(n.utils.object.deepMerge(i,o),i.name=t)),n.utils.object.deepMerge(i.blockStyles,e.blockStyles),n.utils.object.deepMerge(i.categoryStyles,e.categoryStyles),n.utils.object.deepMerge(i.componentStyles,e.componentStyles),n.utils.object.deepMerge(i.fontStyle,e.fontStyle),null!=e.startHats&&(i.startHats=e.startHats),i},n.Themes={},n.Themes.Classic={},n.Themes.Classic.defaultBlockStyles={colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},n.Themes.Classic.categoryStyles={colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}},n.Themes.Classic=new n.Theme("classic",n.Themes.Classic.defaultBlockStyles,n.Themes.Classic.categoryStyles),n.utils.IdGenerator={},n.utils.IdGenerator.nextId_=0,n.utils.IdGenerator.getNextUniqueId=function(){return"blockly-"+(n.utils.IdGenerator.nextId_++).toString(36)},n.utils.Metrics=function(){},n.utils.toolbox={},n.utils.toolbox.CATEGORY_TOOLBOX_KIND="categoryToolbox",n.utils.toolbox.FLYOUT_TOOLBOX_KIND="flyoutToolbox",n.utils.toolbox.Position={TOP:n.TOOLBOX_AT_TOP,BOTTOM:n.TOOLBOX_AT_BOTTOM,LEFT:n.TOOLBOX_AT_LEFT,RIGHT:n.TOOLBOX_AT_RIGHT},n.utils.toolbox.convertToolboxDefToJson=function(t){return t?((t instanceof Element||"string"==typeof t)&&(t=n.utils.toolbox.parseToolboxTree(t),t=n.utils.toolbox.convertToToolboxJson_(t)),n.utils.toolbox.validateToolbox_(t),t):null},n.utils.toolbox.validateToolbox_=function(t){var e=t.kind;if(t=t.contents,e&&e!=n.utils.toolbox.FLYOUT_TOOLBOX_KIND&&e!=n.utils.toolbox.CATEGORY_TOOLBOX_KIND)throw Error("Invalid toolbox kind "+e+". Please supply either "+n.utils.toolbox.FLYOUT_TOOLBOX_KIND+" or "+n.utils.toolbox.CATEGORY_TOOLBOX_KIND);if(!t)throw Error("Toolbox must have a contents attribute.")},n.utils.toolbox.convertFlyoutDefToJsonArray=function(t){return t?t.contents?t.contents:Array.isArray(t)&&0<t.length&&!t[0].nodeType?t:n.utils.toolbox.xmlToJsonArray_(t):[]},n.utils.toolbox.hasCategories=function(t){if(!t)return!1;var e=t.kind;return e?e==n.utils.toolbox.CATEGORY_TOOLBOX_KIND:!!t.contents.filter((function(t){return"CATEGORY"==t.kind.toUpperCase()})).length},n.utils.toolbox.isCategoryCollapsible=function(t){return!(!t||!t.contents||!t.contents.filter((function(t){return"CATEGORY"==t.kind.toUpperCase()})).length)},n.utils.toolbox.convertToToolboxJson_=function(t){var e={contents:n.utils.toolbox.xmlToJsonArray_(t)};return t instanceof Node&&n.utils.toolbox.addAttributes_(t,e),e},n.utils.toolbox.xmlToJsonArray_=function(t){var e,i=[],o=t.childNodes;for(o||(o=t),t=0;e=o[t];t++)if(e.tagName){var r={},s=e.tagName.toUpperCase();r.kind=s,"BLOCK"==s?r.blockxml=e:e.childNodes&&0<e.childNodes.length&&(r.contents=n.utils.toolbox.xmlToJsonArray_(e)),n.utils.toolbox.addAttributes_(e,r),i.push(r)}return i},n.utils.toolbox.addAttributes_=function(t,e){for(var n=0;n<t.attributes.length;n++){var i=t.attributes[n];-1<i.nodeName.indexOf("css-")?(e.cssconfig=e.cssconfig||{},e.cssconfig[i.nodeName.replace("css-","")]=i.value):e[i.nodeName]=i.value}},n.utils.toolbox.parseToolboxTree=function(t){if(t){if("string"!=typeof t&&(n.utils.userAgent.IE&&t.outerHTML?t=t.outerHTML:t instanceof Element||(t=null)),"string"==typeof t&&"xml"!=(t=n.Xml.textToDom(t)).nodeName.toLowerCase())throw TypeError("Toolbox should be an <xml> document.")}else t=null;return t},n.utils.xml={},n.utils.xml.NAME_SPACE="https://developers.google.com/blockly/xml",n.utils.xml.document=function(){return document},n.utils.xml.createElement=function(t){return n.utils.xml.document().createElementNS(n.utils.xml.NAME_SPACE,t)},n.utils.xml.createTextNode=function(t){return n.utils.xml.document().createTextNode(t)},n.utils.xml.textToDomDocument=function(t){return(new DOMParser).parseFromString(t,"text/xml")},n.utils.xml.domToText=function(t){return(new XMLSerializer).serializeToString(t)},n.Events.BlockBase=function(t){n.Events.BlockBase.superClass_.constructor.call(this),this.blockId=(this.isBlank=void 0===t)?"":t.id,this.workspaceId=this.isBlank?"":t.workspace.id},n.utils.object.inherits(n.Events.BlockBase,n.Events.Abstract),n.Events.BlockBase.prototype.toJson=function(){var t=n.Events.BlockBase.superClass_.toJson.call(this);return t.blockId=this.blockId,t},n.Events.BlockBase.prototype.fromJson=function(t){n.Events.BlockBase.superClass_.fromJson.call(this,t),this.blockId=t.blockId},n.Events.Change=function(t,e,i,o,r){n.Events.Change.superClass_.constructor.call(this,t),t&&(this.element=void 0===e?"":e,this.name=void 0===i?"":i,this.oldValue=void 0===o?"":o,this.newValue=void 0===r?"":r)},n.utils.object.inherits(n.Events.Change,n.Events.BlockBase),n.Events.BlockChange=n.Events.Change,n.Events.Change.prototype.type=n.Events.CHANGE,n.Events.Change.prototype.toJson=function(){var t=n.Events.Change.superClass_.toJson.call(this);return t.element=this.element,this.name&&(t.name=this.name),t.oldValue=this.oldValue,t.newValue=this.newValue,t},n.Events.Change.prototype.fromJson=function(t){n.Events.Change.superClass_.fromJson.call(this,t),this.element=t.element,this.name=t.name,this.oldValue=t.oldValue,this.newValue=t.newValue},n.Events.Change.prototype.isNull=function(){return this.oldValue==this.newValue},n.Events.Change.prototype.run=function(t){var e=this.getEventWorkspace_().getBlockById(this.blockId);if(e)switch(e.mutator&&e.mutator.setVisible(!1),t=t?this.newValue:this.oldValue,this.element){case"field":(e=e.getField(this.name))?e.setValue(t):console.warn("Can't set non-existent field: "+this.name);break;case"comment":e.setCommentText(t||null);break;case"collapsed":e.setCollapsed(!!t);break;case"disabled":e.setEnabled(!t);break;case"inline":e.setInputsInline(!!t);break;case"mutation":var i="";if(e.mutationToDom&&(i=(i=e.mutationToDom())&&n.Xml.domToText(i)),e.domToMutation){var o=n.Xml.textToDom(t||"<mutation/>");e.domToMutation(o)}n.Events.fire(new n.Events.Change(e,"mutation",null,i,t));break;default:console.warn("Unknown change type: "+this.element)}else console.warn("Can't change non-existent block: "+this.blockId)},n.Events.Create=function(t){n.Events.Create.superClass_.constructor.call(this,t),t&&(t.isShadow()&&(this.recordUndo=!1),this.xml=t.workspace.rendered?n.Xml.blockToDomWithXY(t):n.Xml.blockToDom(t),this.ids=n.Events.getDescendantIds(t))},n.utils.object.inherits(n.Events.Create,n.Events.BlockBase),n.Events.BlockCreate=n.Events.Create,n.Events.Create.prototype.type=n.Events.CREATE,n.Events.Create.prototype.toJson=function(){var t=n.Events.Create.superClass_.toJson.call(this);return t.xml=n.Xml.domToText(this.xml),t.ids=this.ids,this.recordUndo||(t.recordUndo=this.recordUndo),t},n.Events.Create.prototype.fromJson=function(t){n.Events.Create.superClass_.fromJson.call(this,t),this.xml=n.Xml.textToDom(t.xml),this.ids=t.ids,void 0!==t.recordUndo&&(this.recordUndo=t.recordUndo)},n.Events.Create.prototype.run=function(t){var e=this.getEventWorkspace_();if(t)(t=n.utils.xml.createElement("xml")).appendChild(this.xml),n.Xml.domToWorkspace(t,e);else{t=0;for(var i;i=this.ids[t];t++){var o=e.getBlockById(i);o?o.dispose(!1):i==this.blockId&&console.warn("Can't uncreate non-existent block: "+i)}}},n.Events.Delete=function(t){if(n.Events.Delete.superClass_.constructor.call(this,t),t){if(t.getParent())throw Error("Connected blocks cannot be deleted.");t.isShadow()&&(this.recordUndo=!1),this.oldXml=t.workspace.rendered?n.Xml.blockToDomWithXY(t):n.Xml.blockToDom(t),this.ids=n.Events.getDescendantIds(t)}},n.utils.object.inherits(n.Events.Delete,n.Events.BlockBase),n.Events.BlockDelete=n.Events.Delete,n.Events.Delete.prototype.type=n.Events.DELETE,n.Events.Delete.prototype.toJson=function(){var t=n.Events.Delete.superClass_.toJson.call(this);return t.oldXml=n.Xml.domToText(this.oldXml),t.ids=this.ids,this.recordUndo||(t.recordUndo=this.recordUndo),t},n.Events.Delete.prototype.fromJson=function(t){n.Events.Delete.superClass_.fromJson.call(this,t),this.oldXml=n.Xml.textToDom(t.oldXml),this.ids=t.ids,void 0!==t.recordUndo&&(this.recordUndo=t.recordUndo)},n.Events.Delete.prototype.run=function(t){var e=this.getEventWorkspace_();if(t){t=0;for(var i;i=this.ids[t];t++){var o=e.getBlockById(i);o?o.dispose(!1):i==this.blockId&&console.warn("Can't delete non-existent block: "+i)}}else(t=n.utils.xml.createElement("xml")).appendChild(this.oldXml),n.Xml.domToWorkspace(t,e)},n.Events.Move=function(t){n.Events.Move.superClass_.constructor.call(this,t),t&&(t.isShadow()&&(this.recordUndo=!1),t=this.currentLocation_(),this.oldParentId=t.parentId,this.oldInputName=t.inputName,this.oldCoordinate=t.coordinate)},n.utils.object.inherits(n.Events.Move,n.Events.BlockBase),n.Events.BlockMove=n.Events.Move,n.Events.Move.prototype.type=n.Events.MOVE,n.Events.Move.prototype.toJson=function(){var t=n.Events.Move.superClass_.toJson.call(this);return this.newParentId&&(t.newParentId=this.newParentId),this.newInputName&&(t.newInputName=this.newInputName),this.newCoordinate&&(t.newCoordinate=Math.round(this.newCoordinate.x)+","+Math.round(this.newCoordinate.y)),this.recordUndo||(t.recordUndo=this.recordUndo),t},n.Events.Move.prototype.fromJson=function(t){if(n.Events.Move.superClass_.fromJson.call(this,t),this.newParentId=t.newParentId,this.newInputName=t.newInputName,t.newCoordinate){var e=t.newCoordinate.split(",");this.newCoordinate=new n.utils.Coordinate(Number(e[0]),Number(e[1]))}void 0!==t.recordUndo&&(this.recordUndo=t.recordUndo)},n.Events.Move.prototype.recordNew=function(){var t=this.currentLocation_();this.newParentId=t.parentId,this.newInputName=t.inputName,this.newCoordinate=t.coordinate},n.Events.Move.prototype.currentLocation_=function(){var t=this.getEventWorkspace_().getBlockById(this.blockId),e={},n=t.getParent();return n?(e.parentId=n.id,(t=n.getInputWithBlock(t))&&(e.inputName=t.name)):e.coordinate=t.getRelativeToSurfaceXY(),e},n.Events.Move.prototype.isNull=function(){return this.oldParentId==this.newParentId&&this.oldInputName==this.newInputName&&n.utils.Coordinate.equals(this.oldCoordinate,this.newCoordinate)},n.Events.Move.prototype.run=function(t){var e=this.getEventWorkspace_(),i=e.getBlockById(this.blockId);if(i){var o=t?this.newParentId:this.oldParentId,r=t?this.newInputName:this.oldInputName;t=t?this.newCoordinate:this.oldCoordinate;var s=null;if(o&&!(s=e.getBlockById(o)))return void console.warn("Can't connect to non-existent block: "+o);if(i.getParent()&&i.unplug(),t)r=i.getRelativeToSurfaceXY(),i.moveBy(t.x-r.x,t.y-r.y);else{if(i=i.outputConnection||i.previousConnection,r){if(e=s.getInput(r))var a=e.connection}else i.type==n.PREVIOUS_STATEMENT&&(a=s.nextConnection);a?i.connect(a):console.warn("Can't connect to non-existent input: "+r)}}else console.warn("Can't move non-existent block: "+this.blockId)},n.registry.register(n.registry.Type.EVENT,n.Events.CREATE,n.Events.Create),n.registry.register(n.registry.Type.EVENT,n.Events.DELETE,n.Events.Delete),n.registry.register(n.registry.Type.EVENT,n.Events.CHANGE,n.Events.Change),n.registry.register(n.registry.Type.EVENT,n.Events.MOVE,n.Events.Move),n.Events.FinishedLoading=function(t){this.isBlank=void 0===t,this.workspaceId=t?t.id:"",this.group=n.Events.getGroup(),this.recordUndo=!1},n.utils.object.inherits(n.Events.FinishedLoading,n.Events.Abstract),n.Events.FinishedLoading.prototype.type=n.Events.FINISHED_LOADING,n.Events.FinishedLoading.prototype.toJson=function(){var t={type:this.type};return this.group&&(t.group=this.group),this.workspaceId&&(t.workspaceId=this.workspaceId),t},n.Events.FinishedLoading.prototype.fromJson=function(t){this.isBlank=!1,this.workspaceId=t.workspaceId,this.group=t.group},n.registry.register(n.registry.Type.EVENT,n.Events.FINISHED_LOADING,n.Events.FinishedLoading),n.Events.VarBase=function(t){n.Events.VarBase.superClass_.constructor.call(this),this.varId=(this.isBlank=void 0===t)?"":t.getId(),this.workspaceId=this.isBlank?"":t.workspace.id},n.utils.object.inherits(n.Events.VarBase,n.Events.Abstract),n.Events.VarBase.prototype.toJson=function(){var t=n.Events.VarBase.superClass_.toJson.call(this);return t.varId=this.varId,t},n.Events.VarBase.prototype.fromJson=function(t){n.Events.VarBase.superClass_.toJson.call(this),this.varId=t.varId},n.Events.VarCreate=function(t){n.Events.VarCreate.superClass_.constructor.call(this,t),t&&(this.varType=t.type,this.varName=t.name)},n.utils.object.inherits(n.Events.VarCreate,n.Events.VarBase),n.Events.VarCreate.prototype.type=n.Events.VAR_CREATE,n.Events.VarCreate.prototype.toJson=function(){var t=n.Events.VarCreate.superClass_.toJson.call(this);return t.varType=this.varType,t.varName=this.varName,t},n.Events.VarCreate.prototype.fromJson=function(t){n.Events.VarCreate.superClass_.fromJson.call(this,t),this.varType=t.varType,this.varName=t.varName},n.Events.VarCreate.prototype.run=function(t){var e=this.getEventWorkspace_();t?e.createVariable(this.varName,this.varType,this.varId):e.deleteVariableById(this.varId)},n.Events.VarDelete=function(t){n.Events.VarDelete.superClass_.constructor.call(this,t),t&&(this.varType=t.type,this.varName=t.name)},n.utils.object.inherits(n.Events.VarDelete,n.Events.VarBase),n.Events.VarDelete.prototype.type=n.Events.VAR_DELETE,n.Events.VarDelete.prototype.toJson=function(){var t=n.Events.VarDelete.superClass_.toJson.call(this);return t.varType=this.varType,t.varName=this.varName,t},n.Events.VarDelete.prototype.fromJson=function(t){n.Events.VarDelete.superClass_.fromJson.call(this,t),this.varType=t.varType,this.varName=t.varName},n.Events.VarDelete.prototype.run=function(t){var e=this.getEventWorkspace_();t?e.deleteVariableById(this.varId):e.createVariable(this.varName,this.varType,this.varId)},n.Events.VarRename=function(t,e){n.Events.VarRename.superClass_.constructor.call(this,t),t&&(this.oldName=t.name,this.newName=void 0===e?"":e)},n.utils.object.inherits(n.Events.VarRename,n.Events.VarBase),n.Events.VarRename.prototype.type=n.Events.VAR_RENAME,n.Events.VarRename.prototype.toJson=function(){var t=n.Events.VarRename.superClass_.toJson.call(this);return t.oldName=this.oldName,t.newName=this.newName,t},n.Events.VarRename.prototype.fromJson=function(t){n.Events.VarRename.superClass_.fromJson.call(this,t),this.oldName=t.oldName,this.newName=t.newName},n.Events.VarRename.prototype.run=function(t){var e=this.getEventWorkspace_();t?e.renameVariableById(this.varId,this.newName):e.renameVariableById(this.varId,this.oldName)},n.registry.register(n.registry.Type.EVENT,n.Events.VAR_CREATE,n.Events.VarCreate),n.registry.register(n.registry.Type.EVENT,n.Events.VAR_DELETE,n.Events.VarDelete),n.registry.register(n.registry.Type.EVENT,n.Events.VAR_RENAME,n.Events.VarRename),n.Xml={},n.Xml.workspaceToDom=function(t,e){var i=n.utils.xml.createElement("xml"),o=n.Xml.variablesToDom(n.Variables.allUsedVarModels(t));o.hasChildNodes()&&i.appendChild(o);var r,s=t.getTopComments(!0);for(o=0;r=s[o];o++)i.appendChild(r.toXmlWithXY(e));for(t=t.getTopBlocks(!0),o=0;s=t[o];o++)i.appendChild(n.Xml.blockToDomWithXY(s,e));return i},n.Xml.variablesToDom=function(t){for(var e,i=n.utils.xml.createElement("variables"),o=0;e=t[o];o++){var r=n.utils.xml.createElement("variable");r.appendChild(n.utils.xml.createTextNode(e.name)),e.type&&r.setAttribute("type",e.type),r.id=e.getId(),i.appendChild(r)}return i},n.Xml.blockToDomWithXY=function(t,e){if(t.isInsertionMarker()&&!(t=t.getChildren(!1)[0]))return new DocumentFragment;var i;t.workspace.RTL&&(i=t.workspace.getWidth()),e=n.Xml.blockToDom(t,e);var o=t.getRelativeToSurfaceXY();return e.setAttribute("x",Math.round(t.workspace.RTL?i-o.x:o.x)),e.setAttribute("y",Math.round(o.y)),e},n.Xml.fieldToDom_=function(t){if(t.isSerializable()){var e=n.utils.xml.createElement("field");return e.setAttribute("name",t.name||""),t.toXml(e)}return null},n.Xml.allFieldsToDom_=function(t,e){for(var i,o=0;i=t.inputList[o];o++)for(var r,s=0;r=i.fieldRow[s];s++)(r=n.Xml.fieldToDom_(r))&&e.appendChild(r)},n.Xml.blockToDom=function(t,e){if(t.isInsertionMarker())return(t=t.getChildren(!1)[0])?n.Xml.blockToDom(t):new DocumentFragment;var i=n.utils.xml.createElement(t.isShadow()?"shadow":"block");if(i.setAttribute("type",t.type),e||i.setAttribute("id",t.id),t.mutationToDom){var o=t.mutationToDom();o&&(o.hasChildNodes()||o.hasAttributes())&&i.appendChild(o)}if(n.Xml.allFieldsToDom_(t,i),o=t.getCommentText()){var r=t.commentModel.size,s=t.commentModel.pinned,a=n.utils.xml.createElement("comment");a.appendChild(n.utils.xml.createTextNode(o)),a.setAttribute("pinned",s),a.setAttribute("h",r.height),a.setAttribute("w",r.width),i.appendChild(a)}for(t.data&&((o=n.utils.xml.createElement("data")).appendChild(n.utils.xml.createTextNode(t.data)),i.appendChild(o)),o=0;r=t.inputList[o];o++){var l;if(s=!0,r.type!=n.DUMMY_INPUT){var c=r.connection.targetBlock();r.type==n.INPUT_VALUE?l=n.utils.xml.createElement("value"):r.type==n.NEXT_STATEMENT&&(l=n.utils.xml.createElement("statement")),!(a=r.connection.getShadowDom())||c&&c.isShadow()||l.appendChild(n.Xml.cloneShadow_(a,e)),c&&(a=n.Xml.blockToDom(c,e)).nodeType==n.utils.dom.NodeType.ELEMENT_NODE&&(l.appendChild(a),s=!1),l.setAttribute("name",r.name),s||i.appendChild(l)}}return null!=t.inputsInline&&t.inputsInline!=t.inputsInlineDefault&&i.setAttribute("inline",t.inputsInline),t.isCollapsed()&&i.setAttribute("collapsed",!0),t.isEnabled()||i.setAttribute("disabled",!0),t.isDeletable()||t.isShadow()||i.setAttribute("deletable",!1),t.isMovable()||t.isShadow()||i.setAttribute("movable",!1),t.isEditable()||i.setAttribute("editable",!1),(o=t.getNextBlock())&&(a=n.Xml.blockToDom(o,e)).nodeType==n.utils.dom.NodeType.ELEMENT_NODE&&((l=n.utils.xml.createElement("next")).appendChild(a),i.appendChild(l)),!(a=t.nextConnection&&t.nextConnection.getShadowDom())||o&&o.isShadow()||l.appendChild(n.Xml.cloneShadow_(a,e)),i},n.Xml.cloneShadow_=function(t,e){for(var i,o=t=t.cloneNode(!0);o;)if(e&&"shadow"==o.nodeName&&o.removeAttribute("id"),o.firstChild)o=o.firstChild;else{for(;o&&!o.nextSibling;)i=o,o=o.parentNode,i.nodeType==n.utils.dom.NodeType.TEXT_NODE&&""==i.data.trim()&&o.firstChild!=i&&n.utils.dom.removeNode(i);o&&(i=o,o=o.nextSibling,i.nodeType==n.utils.dom.NodeType.TEXT_NODE&&""==i.data.trim()&&n.utils.dom.removeNode(i))}return t},n.Xml.domToText=function(t){return n.utils.xml.domToText(t).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},n.Xml.domToPrettyText=function(t){t=n.Xml.domToText(t).split("<");for(var e="",i=1;i<t.length;i++){var o=t[i];"/"==o[0]&&(e=e.substring(2)),t[i]=e+"<"+o,"/"!=o[0]&&"/>"!=o.slice(-2)&&(e+="  ")}return(t=(t=t.join("\n")).replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>")).replace(/^\n/,"")},n.Xml.textToDom=function(t){var e=n.utils.xml.textToDomDocument(t);if(!e||!e.documentElement||e.getElementsByTagName("parsererror").length)throw Error("textToDom was unable to parse: "+t);return e.documentElement},n.Xml.clearWorkspaceAndLoadFromXml=function(t,e){return e.setResizesEnabled(!1),e.clear(),t=n.Xml.domToWorkspace(t,e),e.setResizesEnabled(!0),t},n.Xml.domToWorkspace=function(t,e){if(t instanceof n.Workspace){var i=t;t=e,e=i,console.warn("Deprecated call to Blockly.Xml.domToWorkspace, swap the arguments.")}var o;e.RTL&&(o=e.getWidth()),i=[],n.utils.dom.startTextWidthCache();var r=n.Events.getGroup();r||n.Events.setGroup(!0),e.setResizesEnabled&&e.setResizesEnabled(!1);var s=!0;try{for(var a,l=0;a=t.childNodes[l];l++){var c=a.nodeName.toLowerCase(),d=a;if("block"==c||"shadow"==c&&!n.Events.recordUndo){var u=n.Xml.domToBlock(d,e);i.push(u.id);var h=d.hasAttribute("x")?parseInt(d.getAttribute("x"),10):10,p=d.hasAttribute("y")?parseInt(d.getAttribute("y"),10):10;isNaN(h)||isNaN(p)||u.moveBy(e.RTL?o-h:h,p),s=!1}else{if("shadow"==c)throw TypeError("Shadow block cannot be a top-level block.");if("comment"==c)e.rendered?n.WorkspaceCommentSvg?n.WorkspaceCommentSvg.fromXml(d,e,o):console.warn("Missing require for Blockly.WorkspaceCommentSvg, ignoring workspace comment."):n.WorkspaceComment?n.WorkspaceComment.fromXml(d,e):console.warn("Missing require for Blockly.WorkspaceComment, ignoring workspace comment.");else if("variables"==c){if(!s)throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");n.Xml.domToVariables(d,e),s=!1}}}}finally{r||n.Events.setGroup(!1),n.utils.dom.stopTextWidthCache()}return e.setResizesEnabled&&e.setResizesEnabled(!0),n.Events.fire(new n.Events.FinishedLoading(e)),i},n.Xml.appendDomToWorkspace=function(t,e){var i;if(Object.prototype.hasOwnProperty.call(e,"scale")&&(i=e.getBlocksBoundingBox()),t=n.Xml.domToWorkspace(t,e),i&&i.top!=i.bottom){var o=i.bottom,r=e.RTL?i.right:i.left,s=1/0,a=-1/0,l=1/0;for(i=0;i<t.length;i++){var c=e.getBlockById(t[i]).getRelativeToSurfaceXY();c.y<l&&(l=c.y),c.x<s&&(s=c.x),c.x>a&&(a=c.x)}for(o=o-l+10,r=e.RTL?r-a:r-s,i=0;i<t.length;i++)e.getBlockById(t[i]).moveBy(r,o)}return t},n.Xml.domToBlock=function(t,e){if(t instanceof n.Workspace){var i=t;t=e,e=i,console.warn("Deprecated call to Blockly.Xml.domToBlock, swap the arguments.")}n.Events.disable(),i=e.getAllVariables();try{var o=n.Xml.domToBlockHeadless_(t,e),r=o.getDescendants(!1);if(e.rendered){o.setConnectionTracking(!1);for(var s=r.length-1;0<=s;s--)r[s].initSvg();for(s=r.length-1;0<=s;s--)r[s].render(!1);setTimeout((function(){o.disposed||o.setConnectionTracking(!0)}),1),o.updateDisabled(),e.resizeContents()}else for(s=r.length-1;0<=s;s--)r[s].initModel()}finally{n.Events.enable()}if(n.Events.isEnabled()){for(t=n.Variables.getAddedVariables(e,i),s=0;s<t.length;s++)n.Events.fire(new n.Events.VarCreate(t[s]));n.Events.fire(new n.Events.BlockCreate(o))}return o},n.Xml.domToVariables=function(t,e){for(var i,o=0;i=t.childNodes[o];o++)if(i.nodeType==n.utils.dom.NodeType.ELEMENT_NODE){var r=i.getAttribute("type"),s=i.getAttribute("id");e.createVariable(i.textContent,r,s)}},n.Xml.domToBlockHeadless_=function(t,e){var i=null,o=t.getAttribute("type");if(!o)throw TypeError("Block type unspecified: "+t.outerHTML);var r=t.getAttribute("id");i=e.newBlock(o,r);var s,a=null;for(r=0;s=t.childNodes[r];r++)if(s.nodeType!=n.utils.dom.NodeType.TEXT_NODE){for(var l,c=a=null,d=0;l=s.childNodes[d];d++)l.nodeType==n.utils.dom.NodeType.ELEMENT_NODE&&("block"==l.nodeName.toLowerCase()?a=l:"shadow"==l.nodeName.toLowerCase()&&(c=l));d=!1;var u=s.getAttribute("name");switch(l=s,s.nodeName.toLowerCase()){case"mutation":i.domToMutation&&(i.domToMutation(l),i.initSvg&&(d=!0));break;case"comment":if(!n.Comment){console.warn("Missing require for Blockly.Comment, ignoring block comment.");break}c=l.textContent,a="true"==l.getAttribute("pinned"),s=parseInt(l.getAttribute("w"),10),l=parseInt(l.getAttribute("h"),10),i.setCommentText(c),i.commentModel.pinned=a,isNaN(s)||isNaN(l)||(i.commentModel.size=new n.utils.Size(s,l)),a&&i.getCommentIcon&&!i.isInFlyout&&setTimeout((function(){i.getCommentIcon().setVisible(!0)}),1);break;case"data":i.data=s.textContent;break;case"title":case"field":n.Xml.domToField_(i,u,l);break;case"value":case"statement":if(!(l=i.getInput(u))){console.warn("Ignoring non-existent input "+u+" in block "+o);break}if(a)if((a=n.Xml.domToBlockHeadless_(a,e)).outputConnection)l.connection.connect(a.outputConnection);else{if(!a.previousConnection)throw TypeError("Child block does not have output or previous statement.");l.connection.connect(a.previousConnection)}c&&l.connection.setShadowDom(c);break;case"next":if(a){if(!i.nextConnection)throw TypeError("Next statement does not exist.");if(i.nextConnection.isConnected())throw TypeError("Next statement is already connected.");if(!(a=n.Xml.domToBlockHeadless_(a,e)).previousConnection)throw TypeError("Next block does not have previous statement.");i.nextConnection.connect(a.previousConnection)}c&&i.nextConnection&&i.nextConnection.setShadowDom(c);break;default:console.warn("Ignoring unknown tag: "+s.nodeName)}}if(d&&i.initSvg(),(r=t.getAttribute("inline"))&&i.setInputsInline("true"==r),(r=t.getAttribute("disabled"))&&i.setEnabled("true"!=r&&"disabled"!=r),(r=t.getAttribute("deletable"))&&i.setDeletable("true"==r),(r=t.getAttribute("movable"))&&i.setMovable("true"==r),(r=t.getAttribute("editable"))&&i.setEditable("true"==r),(r=t.getAttribute("collapsed"))&&i.setCollapsed("true"==r),"shadow"==t.nodeName.toLowerCase()){for(t=i.getChildren(!1),r=0;e=t[r];r++)if(!e.isShadow())throw TypeError("Shadow block not allowed non-shadow child.");if(i.getVarModels().length)throw TypeError("Shadow blocks cannot have variable references.");i.setShadow(!0)}return i},n.Xml.domToField_=function(t,e,n){var i=t.getField(e);i?i.fromXml(n):console.warn("Ignoring non-existent field "+e+" in block "+t.type)},n.Xml.deleteNext=function(t){for(var e,n=0;e=t.childNodes[n];n++)if("next"==e.nodeName.toLowerCase()){t.removeChild(e);break}},n.Options=function(t){var e=!!t.readOnly;if(e)var i=null,o=!1,r=!1,s=!1,a=!1,l=!1,c=!1;else{i=n.utils.toolbox.convertToolboxDefToJson(t.toolbox),o=n.utils.toolbox.hasCategories(i),void 0===(r=t.trashcan)&&(r=o);var d=t.maxTrashcanContents;r?void 0===d&&(d=32):d=0,void 0===(s=t.collapse)&&(s=o),void 0===(a=t.comments)&&(a=o),void 0===(l=t.disable)&&(l=o),void 0===(c=t.sounds)&&(c=!0)}var u=!!t.rtl,h=t.horizontalLayout;void 0===h&&(h=!1);var p=t.toolboxPosition;p="end"!==p,p=h?p?n.utils.toolbox.Position.TOP:n.utils.toolbox.Position.BOTTOM:p==u?n.utils.toolbox.Position.RIGHT:n.utils.toolbox.Position.LEFT;var g=t.css;void 0===g&&(g=!0);var f="https://blockly-demo.appspot.com/static/media/";t.media?f=t.media:t.path&&(f=t.path+"media/");var m=void 0===t.oneBasedIndex||!!t.oneBasedIndex,_=t.renderer||"geras",v=t.plugins||{};this.RTL=u,this.oneBasedIndex=m,this.collapse=s,this.comments=a,this.disable=l,this.readOnly=e,this.maxBlocks=t.maxBlocks||1/0,this.maxInstances=t.maxInstances,this.pathToMedia=f,this.hasCategories=o,this.moveOptions=n.Options.parseMoveOptions_(t,o),this.hasScrollbars=this.moveOptions.scrollbars,this.hasTrashcan=r,this.maxTrashcanContents=d,this.hasSounds=c,this.hasCss=g,this.horizontalLayout=h,this.languageTree=i,this.gridOptions=n.Options.parseGridOptions_(t),this.zoomOptions=n.Options.parseZoomOptions_(t),this.toolboxPosition=p,this.theme=n.Options.parseThemeOptions_(t),this.renderer=_,this.rendererOverrides=t.rendererOverrides,this.gridPattern=null,this.parentWorkspace=t.parentWorkspace,this.plugins=v},n.BlocklyOptions=function(){},n.Options.parseMoveOptions_=function(t,e){var n=t.move||{},i={};return i.scrollbars=void 0===n.scrollbars&&void 0===t.scrollbars?e:!!n.scrollbars||!!t.scrollbars,i.wheel=!(!i.scrollbars||void 0===n.wheel||!n.wheel),i.drag=!(!i.scrollbars||void 0!==n.drag&&!n.drag),i},n.Options.parseZoomOptions_=function(t){t=t.zoom||{};var e={};return e.controls=void 0!==t.controls&&!!t.controls,e.wheel=void 0!==t.wheel&&!!t.wheel,e.startScale=void 0===t.startScale?1:Number(t.startScale),e.maxScale=void 0===t.maxScale?3:Number(t.maxScale),e.minScale=void 0===t.minScale?.3:Number(t.minScale),e.scaleSpeed=void 0===t.scaleSpeed?1.2:Number(t.scaleSpeed),e.pinch=void 0===t.pinch?e.wheel||e.controls:!!t.pinch,e},n.Options.parseGridOptions_=function(t){t=t.grid||{};var e={};return e.spacing=Number(t.spacing)||0,e.colour=t.colour||"#888",e.length=void 0===t.length?1:Number(t.length),e.snap=0<e.spacing&&!!t.snap,e},n.Options.parseThemeOptions_=function(t){return"string"==typeof(t=t.theme||n.Themes.Classic)?n.registry.getObject(n.registry.Type.THEME,t):t instanceof n.Theme?t:n.Theme.defineTheme(t.name||"builtin"+n.utils.IdGenerator.getNextUniqueId(),t)},n.Options.parseToolboxTree=function(t){return n.utils.deprecation.warn("Blockly.Options.parseToolboxTree","September 2020","September 2021","Blockly.utils.toolbox.parseToolboxTree"),n.utils.toolbox.parseToolboxTree(t)},n.Touch={},n.Touch.TOUCH_ENABLED="ontouchstart"in n.utils.global||!!(n.utils.global.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!n.utils.global.navigator||!n.utils.global.navigator.maxTouchPoints&&!n.utils.global.navigator.msMaxTouchPoints),n.Touch.touchIdentifier_=null,n.Touch.TOUCH_MAP={},n.utils.global.PointerEvent?n.Touch.TOUCH_MAP={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]}:n.Touch.TOUCH_ENABLED&&(n.Touch.TOUCH_MAP={mousedown:["touchstart"],mousemove:["touchmove"],mouseup:["touchend","touchcancel"]}),n.longPid_=0,n.longStart=function(t,e){n.longStop_(),t.changedTouches&&1!=t.changedTouches.length||(n.longPid_=setTimeout((function(){t.changedTouches&&(t.button=2,t.clientX=t.changedTouches[0].clientX,t.clientY=t.changedTouches[0].clientY),e&&e.handleRightClick(t)}),n.LONGPRESS))},n.longStop_=function(){n.longPid_&&(clearTimeout(n.longPid_),n.longPid_=0)},n.Touch.clearTouchIdentifier=function(){n.Touch.touchIdentifier_=null},n.Touch.shouldHandleEvent=function(t){return!n.Touch.isMouseOrTouchEvent(t)||n.Touch.checkTouchIdentifier(t)},n.Touch.getTouchIdentifierFromEvent=function(t){return null!=t.pointerId?t.pointerId:t.changedTouches&&t.changedTouches[0]&&void 0!==t.changedTouches[0].identifier&&null!==t.changedTouches[0].identifier?t.changedTouches[0].identifier:"mouse"},n.Touch.checkTouchIdentifier=function(t){var e=n.Touch.getTouchIdentifierFromEvent(t);return void 0!==n.Touch.touchIdentifier_&&null!==n.Touch.touchIdentifier_?n.Touch.touchIdentifier_==e:("mousedown"==t.type||"touchstart"==t.type||"pointerdown"==t.type)&&(n.Touch.touchIdentifier_=e,!0)},n.Touch.setClientFromTouch=function(t){if(n.utils.string.startsWith(t.type,"touch")){var e=t.changedTouches[0];t.clientX=e.clientX,t.clientY=e.clientY}},n.Touch.isMouseOrTouchEvent=function(t){return n.utils.string.startsWith(t.type,"touch")||n.utils.string.startsWith(t.type,"mouse")||n.utils.string.startsWith(t.type,"pointer")},n.Touch.isTouchEvent=function(t){return n.utils.string.startsWith(t.type,"touch")||n.utils.string.startsWith(t.type,"pointer")},n.Touch.splitEventByTouches=function(t){var e=[];if(t.changedTouches)for(var n=0;n<t.changedTouches.length;n++)e[n]={type:t.type,changedTouches:[t.changedTouches[n]],target:t.target,stopPropagation:function(){t.stopPropagation()},preventDefault:function(){t.preventDefault()}};else e.push(t);return e},n.ScrollbarPair=function(t){this.workspace_=t,this.hScroll=new n.Scrollbar(t,!0,!0,"blocklyMainWorkspaceScrollbar"),this.vScroll=new n.Scrollbar(t,!1,!0,"blocklyMainWorkspaceScrollbar"),this.corner_=n.utils.dom.createSvgElement(n.utils.Svg.RECT,{height:n.Scrollbar.scrollbarThickness,width:n.Scrollbar.scrollbarThickness,class:"blocklyScrollbarBackground"},null),n.utils.dom.insertAfter(this.corner_,t.getBubbleCanvas()),this.oldHostMetrics_=null},n.ScrollbarPair.prototype.dispose=function(){n.utils.dom.removeNode(this.corner_),this.oldHostMetrics_=this.workspace_=this.corner_=null,this.hScroll.dispose(),this.hScroll=null,this.vScroll.dispose(),this.vScroll=null},n.ScrollbarPair.prototype.resize=function(){var t=this.workspace_.getMetrics();if(t){var e=!1,i=!1;if(this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth==t.viewWidth&&this.oldHostMetrics_.viewHeight==t.viewHeight&&this.oldHostMetrics_.absoluteTop==t.absoluteTop&&this.oldHostMetrics_.absoluteLeft==t.absoluteLeft?(this.oldHostMetrics_&&this.oldHostMetrics_.contentWidth==t.contentWidth&&this.oldHostMetrics_.viewLeft==t.viewLeft&&this.oldHostMetrics_.contentLeft==t.contentLeft||(e=!0),this.oldHostMetrics_&&this.oldHostMetrics_.contentHeight==t.contentHeight&&this.oldHostMetrics_.viewTop==t.viewTop&&this.oldHostMetrics_.contentTop==t.contentTop||(i=!0)):i=e=!0,e||i){try{n.Events.disable(),e&&this.hScroll.resize(t),i&&this.vScroll.resize(t)}finally{n.Events.enable()}this.workspace_.maybeFireViewportChangeEvent()}this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth==t.viewWidth&&this.oldHostMetrics_.absoluteLeft==t.absoluteLeft||this.corner_.setAttribute("x",this.vScroll.position.x),this.oldHostMetrics_&&this.oldHostMetrics_.viewHeight==t.viewHeight&&this.oldHostMetrics_.absoluteTop==t.absoluteTop||this.corner_.setAttribute("y",this.hScroll.position.y),this.oldHostMetrics_=t}},n.ScrollbarPair.prototype.set=function(t,e){var n={};t*=this.hScroll.ratio,e*=this.vScroll.ratio;var i=this.vScroll.scrollViewSize_;n.x=this.getRatio_(t,this.hScroll.scrollViewSize_),n.y=this.getRatio_(e,i),this.workspace_.setMetrics(n),this.hScroll.setHandlePosition(t),this.vScroll.setHandlePosition(e)},n.ScrollbarPair.prototype.getRatio_=function(t,e){return t/=e,isNaN(t)?0:t},n.Scrollbar=function(t,e,i,o){this.workspace_=t,this.pair_=i||!1,this.horizontal_=e,this.ratio=this.oldHostMetrics_=null,this.createDom_(o),this.position=new n.utils.Coordinate(0,0),t=n.Scrollbar.scrollbarThickness,e?(this.svgBackground_.setAttribute("height",t),this.outerSvg_.setAttribute("height",t),this.svgHandle_.setAttribute("height",t-5),this.svgHandle_.setAttribute("y",2.5),this.lengthAttribute_="width",this.positionAttribute_="x"):(this.svgBackground_.setAttribute("width",t),this.outerSvg_.setAttribute("width",t),this.svgHandle_.setAttribute("width",t-5),this.svgHandle_.setAttribute("x",2.5),this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=n.bindEventWithChecks_(this.svgBackground_,"mousedown",this,this.onMouseDownBar_),this.onMouseDownHandleWrapper_=n.bindEventWithChecks_(this.svgHandle_,"mousedown",this,this.onMouseDownHandle_)},n.Scrollbar.prototype.origin_=new n.utils.Coordinate(0,0),n.Scrollbar.prototype.startDragMouse_=0,n.Scrollbar.prototype.scrollViewSize_=0,n.Scrollbar.prototype.handleLength_=0,n.Scrollbar.prototype.handlePosition_=0,n.Scrollbar.prototype.isVisible_=!0,n.Scrollbar.prototype.containerVisible_=!0,n.Scrollbar.scrollbarThickness=15,n.Touch.TOUCH_ENABLED&&(n.Scrollbar.scrollbarThickness=25),n.Scrollbar.metricsAreEquivalent_=function(t,e){return!(!t||!e||t.viewWidth!=e.viewWidth||t.viewHeight!=e.viewHeight||t.viewLeft!=e.viewLeft||t.viewTop!=e.viewTop||t.absoluteTop!=e.absoluteTop||t.absoluteLeft!=e.absoluteLeft||t.contentWidth!=e.contentWidth||t.contentHeight!=e.contentHeight||t.contentLeft!=e.contentLeft||t.contentTop!=e.contentTop)},n.Scrollbar.prototype.dispose=function(){this.cleanUp_(),n.unbindEvent_(this.onMouseDownBarWrapper_),this.onMouseDownBarWrapper_=null,n.unbindEvent_(this.onMouseDownHandleWrapper_),this.onMouseDownHandleWrapper_=null,n.utils.dom.removeNode(this.outerSvg_),this.svgBackground_=this.svgGroup_=this.outerSvg_=null,this.svgHandle_&&(this.workspace_.getThemeManager().unsubscribe(this.svgHandle_),this.svgHandle_=null),this.workspace_=null},n.Scrollbar.prototype.setHandleLength_=function(t){this.handleLength_=t,this.svgHandle_.setAttribute(this.lengthAttribute_,this.handleLength_)},n.Scrollbar.prototype.setHandlePosition=function(t){this.handlePosition_=t,this.svgHandle_.setAttribute(this.positionAttribute_,this.handlePosition_)},n.Scrollbar.prototype.setScrollViewSize_=function(t){this.scrollViewSize_=t,this.outerSvg_.setAttribute(this.lengthAttribute_,this.scrollViewSize_),this.svgBackground_.setAttribute(this.lengthAttribute_,this.scrollViewSize_)},n.ScrollbarPair.prototype.setContainerVisible=function(t){this.hScroll.setContainerVisible(t),this.vScroll.setContainerVisible(t)},n.Scrollbar.prototype.setPosition=function(t,e){this.position.x=t,this.position.y=e,n.utils.dom.setCssTransform(this.outerSvg_,"translate("+(this.position.x+this.origin_.x)+"px,"+(this.position.y+this.origin_.y)+"px)")},n.Scrollbar.prototype.resize=function(t){(t||(t=this.workspace_.getMetrics()))&&(n.Scrollbar.metricsAreEquivalent_(t,this.oldHostMetrics_)||(this.oldHostMetrics_=t,this.horizontal_?this.resizeHorizontal_(t):this.resizeVertical_(t),this.onScroll_()))},n.Scrollbar.prototype.resizeHorizontal_=function(t){this.resizeViewHorizontal(t)},n.Scrollbar.prototype.resizeViewHorizontal=function(t){var e=t.viewWidth-1;this.pair_&&(e-=n.Scrollbar.scrollbarThickness),this.setScrollViewSize_(Math.max(0,e)),e=t.absoluteLeft+.5,this.pair_&&this.workspace_.RTL&&(e+=n.Scrollbar.scrollbarThickness),this.setPosition(e,t.absoluteTop+t.viewHeight-n.Scrollbar.scrollbarThickness-.5),this.resizeContentHorizontal(t)},n.Scrollbar.prototype.resizeContentHorizontal=function(t){this.pair_||this.setVisible(this.scrollViewSize_<t.contentWidth),this.ratio=this.scrollViewSize_/t.contentWidth,(-1/0==this.ratio||1/0==this.ratio||isNaN(this.ratio))&&(this.ratio=0),this.setHandleLength_(Math.max(0,t.viewWidth*this.ratio)),this.setHandlePosition(this.constrainHandle_((t.viewLeft-t.contentLeft)*this.ratio))},n.Scrollbar.prototype.resizeVertical_=function(t){this.resizeViewVertical(t)},n.Scrollbar.prototype.resizeViewVertical=function(t){var e=t.viewHeight-1;this.pair_&&(e-=n.Scrollbar.scrollbarThickness),this.setScrollViewSize_(Math.max(0,e)),e=t.absoluteLeft+.5,this.workspace_.RTL||(e+=t.viewWidth-n.Scrollbar.scrollbarThickness-1),this.setPosition(e,t.absoluteTop+.5),this.resizeContentVertical(t)},n.Scrollbar.prototype.resizeContentVertical=function(t){this.pair_||this.setVisible(this.scrollViewSize_<t.contentHeight),this.ratio=this.scrollViewSize_/t.contentHeight,(-1/0==this.ratio||1/0==this.ratio||isNaN(this.ratio))&&(this.ratio=0),this.setHandleLength_(Math.max(0,t.viewHeight*this.ratio)),this.setHandlePosition(this.constrainHandle_((t.viewTop-t.contentTop)*this.ratio))},n.Scrollbar.prototype.createDom_=function(t){var e="blocklyScrollbar"+(this.horizontal_?"Horizontal":"Vertical");t&&(e+=" "+t),this.outerSvg_=n.utils.dom.createSvgElement(n.utils.Svg.SVG,{class:e},null),this.svgGroup_=n.utils.dom.createSvgElement(n.utils.Svg.G,{},this.outerSvg_),this.svgBackground_=n.utils.dom.createSvgElement(n.utils.Svg.RECT,{class:"blocklyScrollbarBackground"},this.svgGroup_),t=Math.floor((n.Scrollbar.scrollbarThickness-5)/2),this.svgHandle_=n.utils.dom.createSvgElement(n.utils.Svg.RECT,{class:"blocklyScrollbarHandle",rx:t,ry:t},this.svgGroup_),this.workspace_.getThemeManager().subscribe(this.svgHandle_,"scrollbarColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgHandle_,"scrollbarOpacity","fill-opacity"),n.utils.dom.insertAfter(this.outerSvg_,this.workspace_.getParentSvg())},n.Scrollbar.prototype.isVisible=function(){return this.isVisible_},n.Scrollbar.prototype.setContainerVisible=function(t){var e=t!=this.containerVisible_;this.containerVisible_=t,e&&this.updateDisplay_()},n.Scrollbar.prototype.setVisible=function(t){var e=t!=this.isVisible();if(this.pair_)throw Error("Unable to toggle visibility of paired scrollbars.");this.isVisible_=t,e&&this.updateDisplay_()},n.Scrollbar.prototype.updateDisplay_=function(){this.containerVisible_&&this.isVisible()?this.outerSvg_.setAttribute("display","block"):this.outerSvg_.setAttribute("display","none")},n.Scrollbar.prototype.onMouseDownBar_=function(t){if(this.workspace_.markFocused(),n.Touch.clearTouchIdentifier(),this.cleanUp_(),n.utils.isRightButton(t))t.stopPropagation();else{var e=n.utils.mouseToSvg(t,this.workspace_.getParentSvg(),this.workspace_.getInverseScreenCTM());e=this.horizontal_?e.x:e.y;var i=n.utils.getInjectionDivXY_(this.svgHandle_);i=this.horizontal_?i.x:i.y;var o=this.handlePosition_,r=.95*this.handleLength_;e<=i?o-=r:e>=i+this.handleLength_&&(o+=r),this.setHandlePosition(this.constrainHandle_(o)),this.onScroll_(),t.stopPropagation(),t.preventDefault()}},n.Scrollbar.prototype.onMouseDownHandle_=function(t){this.workspace_.markFocused(),this.cleanUp_(),n.utils.isRightButton(t)?t.stopPropagation():(this.startDragHandle=this.handlePosition_,this.workspace_.setupDragSurface(),this.startDragMouse_=this.horizontal_?t.clientX:t.clientY,n.Scrollbar.onMouseUpWrapper_=n.bindEventWithChecks_(document,"mouseup",this,this.onMouseUpHandle_),n.Scrollbar.onMouseMoveWrapper_=n.bindEventWithChecks_(document,"mousemove",this,this.onMouseMoveHandle_),t.stopPropagation(),t.preventDefault())},n.Scrollbar.prototype.onMouseMoveHandle_=function(t){this.setHandlePosition(this.constrainHandle_(this.startDragHandle+((this.horizontal_?t.clientX:t.clientY)-this.startDragMouse_))),this.onScroll_()},n.Scrollbar.prototype.onMouseUpHandle_=function(){this.workspace_.resetDragSurface(),n.Touch.clearTouchIdentifier(),this.cleanUp_()},n.Scrollbar.prototype.cleanUp_=function(){n.hideChaff(!0),n.Scrollbar.onMouseUpWrapper_&&(n.unbindEvent_(n.Scrollbar.onMouseUpWrapper_),n.Scrollbar.onMouseUpWrapper_=null),n.Scrollbar.onMouseMoveWrapper_&&(n.unbindEvent_(n.Scrollbar.onMouseMoveWrapper_),n.Scrollbar.onMouseMoveWrapper_=null)},n.Scrollbar.prototype.constrainHandle_=function(t){return 0>=t||isNaN(t)||this.scrollViewSize_<this.handleLength_?0:Math.min(t,this.scrollViewSize_-this.handleLength_)},n.Scrollbar.prototype.onScroll_=function(){var t=this.handlePosition_/this.scrollViewSize_;isNaN(t)&&(t=0);var e={};this.horizontal_?e.x=t:e.y=t,this.workspace_.setMetrics(e)},n.Scrollbar.prototype.set=function(t){this.setHandlePosition(this.constrainHandle_(t*this.ratio)),this.onScroll_()},n.Scrollbar.prototype.setOrigin=function(t,e){this.origin_=new n.utils.Coordinate(t,e)},n.Tooltip={},n.Tooltip.visible=!1,n.Tooltip.blocked_=!1,n.Tooltip.LIMIT=50,n.Tooltip.mouseOutPid_=0,n.Tooltip.showPid_=0,n.Tooltip.lastX_=0,n.Tooltip.lastY_=0,n.Tooltip.element_=null,n.Tooltip.poisonedElement_=null,n.Tooltip.OFFSET_X=0,n.Tooltip.OFFSET_Y=10,n.Tooltip.RADIUS_OK=10,n.Tooltip.HOVER_MS=750,n.Tooltip.MARGINS=5,n.Tooltip.DIV=null,n.Tooltip.getTooltipOfObject=function(t){if(t=n.Tooltip.getTargetObject_(t)){for(t=t.tooltip;"function"==typeof t;)t=t();if("string"!=typeof t)throw Error("Tooltip function must return a string.");return t}return""},n.Tooltip.getTargetObject_=function(t){for(;t&&t.tooltip;){if("string"==typeof t.tooltip||"function"==typeof t.tooltip)return t;t=t.tooltip}return null},n.Tooltip.createDom=function(){n.Tooltip.DIV||(n.Tooltip.DIV=document.createElement("div"),n.Tooltip.DIV.className="blocklyTooltipDiv",(n.parentContainer||document.body).appendChild(n.Tooltip.DIV))},n.Tooltip.bindMouseEvents=function(t){t.mouseOverWrapper_=n.bindEvent_(t,"mouseover",null,n.Tooltip.onMouseOver_),t.mouseOutWrapper_=n.bindEvent_(t,"mouseout",null,n.Tooltip.onMouseOut_),t.addEventListener("mousemove",n.Tooltip.onMouseMove_,!1)},n.Tooltip.unbindMouseEvents=function(t){t&&(n.unbindEvent_(t.mouseOverWrapper_),n.unbindEvent_(t.mouseOutWrapper_),t.removeEventListener("mousemove",n.Tooltip.onMouseMove_))},n.Tooltip.onMouseOver_=function(t){n.Tooltip.blocked_||(t=n.Tooltip.getTargetObject_(t.currentTarget),n.Tooltip.element_!=t&&(n.Tooltip.hide(),n.Tooltip.poisonedElement_=null,n.Tooltip.element_=t),clearTimeout(n.Tooltip.mouseOutPid_))},n.Tooltip.onMouseOut_=function(t){n.Tooltip.blocked_||(n.Tooltip.mouseOutPid_=setTimeout((function(){n.Tooltip.element_=null,n.Tooltip.poisonedElement_=null,n.Tooltip.hide()}),1),clearTimeout(n.Tooltip.showPid_))},n.Tooltip.onMouseMove_=function(t){if(n.Tooltip.element_&&n.Tooltip.element_.tooltip&&!n.Tooltip.blocked_)if(n.Tooltip.visible){var e=n.Tooltip.lastX_-t.pageX;t=n.Tooltip.lastY_-t.pageY,Math.sqrt(e*e+t*t)>n.Tooltip.RADIUS_OK&&n.Tooltip.hide()}else n.Tooltip.poisonedElement_!=n.Tooltip.element_&&(clearTimeout(n.Tooltip.showPid_),n.Tooltip.lastX_=t.pageX,n.Tooltip.lastY_=t.pageY,n.Tooltip.showPid_=setTimeout(n.Tooltip.show_,n.Tooltip.HOVER_MS))},n.Tooltip.dispose=function(){n.Tooltip.element_=null,n.Tooltip.poisonedElement_=null,n.Tooltip.hide()},n.Tooltip.hide=function(){n.Tooltip.visible&&(n.Tooltip.visible=!1,n.Tooltip.DIV&&(n.Tooltip.DIV.style.display="none")),n.Tooltip.showPid_&&clearTimeout(n.Tooltip.showPid_)},n.Tooltip.block=function(){n.Tooltip.hide(),n.Tooltip.blocked_=!0},n.Tooltip.unblock=function(){n.Tooltip.blocked_=!1},n.Tooltip.show_=function(){if(!n.Tooltip.blocked_&&(n.Tooltip.poisonedElement_=n.Tooltip.element_,n.Tooltip.DIV)){n.Tooltip.DIV.textContent="";var t=n.Tooltip.getTooltipOfObject(n.Tooltip.element_);t=(t=n.utils.string.wrap(t,n.Tooltip.LIMIT)).split("\n");for(var e=0;e<t.length;e++){var i=document.createElement("div");i.appendChild(document.createTextNode(t[e])),n.Tooltip.DIV.appendChild(i)}t=n.Tooltip.element_.RTL,e=document.documentElement.clientWidth,i=document.documentElement.clientHeight,n.Tooltip.DIV.style.direction=t?"rtl":"ltr",n.Tooltip.DIV.style.display="block",n.Tooltip.visible=!0;var o=n.Tooltip.lastX_;o=t?o-(n.Tooltip.OFFSET_X+n.Tooltip.DIV.offsetWidth):o+n.Tooltip.OFFSET_X;var r=n.Tooltip.lastY_+n.Tooltip.OFFSET_Y;r+n.Tooltip.DIV.offsetHeight>i+window.scrollY&&(r-=n.Tooltip.DIV.offsetHeight+2*n.Tooltip.OFFSET_Y),t?o=Math.max(n.Tooltip.MARGINS-window.scrollX,o):o+n.Tooltip.DIV.offsetWidth>e+window.scrollX-2*n.Tooltip.MARGINS&&(o=e-n.Tooltip.DIV.offsetWidth-2*n.Tooltip.MARGINS),n.Tooltip.DIV.style.top=r+"px",n.Tooltip.DIV.style.left=o+"px"}},n.WorkspaceDragSurfaceSvg=function(t){this.container_=t,this.createDom()},n.WorkspaceDragSurfaceSvg.prototype.SVG_=null,n.WorkspaceDragSurfaceSvg.prototype.container_=null,n.WorkspaceDragSurfaceSvg.prototype.createDom=function(){this.SVG_||(this.SVG_=n.utils.dom.createSvgElement(n.utils.Svg.SVG,{xmlns:n.utils.dom.SVG_NS,"xmlns:html":n.utils.dom.HTML_NS,"xmlns:xlink":n.utils.dom.XLINK_NS,version:"1.1",class:"blocklyWsDragSurface blocklyOverflowVisible"},null),this.container_.appendChild(this.SVG_))},n.WorkspaceDragSurfaceSvg.prototype.translateSurface=function(t,e){t=t.toFixed(0),e=e.toFixed(0),this.SVG_.style.display="block",n.utils.dom.setCssTransform(this.SVG_,"translate3d("+t+"px, "+e+"px, 0px)")},n.WorkspaceDragSurfaceSvg.prototype.getSurfaceTranslation=function(){return n.utils.getRelativeXY(this.SVG_)},n.WorkspaceDragSurfaceSvg.prototype.clearAndHide=function(t){if(!t)throw Error("Couldn't clear and hide the drag surface: missing new surface.");var e=this.SVG_.childNodes[0],i=this.SVG_.childNodes[1];if(!(e&&i&&n.utils.dom.hasClass(e,"blocklyBlockCanvas")&&n.utils.dom.hasClass(i,"blocklyBubbleCanvas")))throw Error("Couldn't clear and hide the drag surface. A node was missing.");if(null!=this.previousSibling_?n.utils.dom.insertAfter(e,this.previousSibling_):t.insertBefore(e,t.firstChild),n.utils.dom.insertAfter(i,e),this.SVG_.style.display="none",this.SVG_.childNodes.length)throw Error("Drag surface was not cleared.");n.utils.dom.setCssTransform(this.SVG_,""),this.previousSibling_=null},n.WorkspaceDragSurfaceSvg.prototype.setContentsAndShow=function(t,e,n,i,o,r){if(this.SVG_.childNodes.length)throw Error("Already dragging a block.");this.previousSibling_=n,t.setAttribute("transform","translate(0, 0) scale("+r+")"),e.setAttribute("transform","translate(0, 0) scale("+r+")"),this.SVG_.setAttribute("width",i),this.SVG_.setAttribute("height",o),this.SVG_.appendChild(t),this.SVG_.appendChild(e),this.SVG_.style.display="block"},n.ASTNode=function(t,e,i){if(!e)throw Error("Cannot create a node without a location.");this.type_=t,this.isConnection_=n.ASTNode.isConnectionType_(t),this.location_=e,this.wsCoordinate_=null,this.processParams_(i||null)},n.ASTNode.types={FIELD:"field",BLOCK:"block",INPUT:"input",OUTPUT:"output",NEXT:"next",PREVIOUS:"previous",STACK:"stack",WORKSPACE:"workspace"},n.ASTNode.NAVIGATE_ALL_FIELDS=!1,n.ASTNode.DEFAULT_OFFSET_Y=-20,n.ASTNode.isConnectionType_=function(t){switch(t){case n.ASTNode.types.PREVIOUS:case n.ASTNode.types.NEXT:case n.ASTNode.types.INPUT:case n.ASTNode.types.OUTPUT:return!0}return!1},n.ASTNode.createFieldNode=function(t){return t?new n.ASTNode(n.ASTNode.types.FIELD,t):null},n.ASTNode.createConnectionNode=function(t){return t?t.type==n.INPUT_VALUE||t.type==n.NEXT_STATEMENT&&t.getParentInput()?n.ASTNode.createInputNode(t.getParentInput()):t.type==n.NEXT_STATEMENT?new n.ASTNode(n.ASTNode.types.NEXT,t):t.type==n.OUTPUT_VALUE?new n.ASTNode(n.ASTNode.types.OUTPUT,t):t.type==n.PREVIOUS_STATEMENT?new n.ASTNode(n.ASTNode.types.PREVIOUS,t):null:null},n.ASTNode.createInputNode=function(t){return t&&t.connection?new n.ASTNode(n.ASTNode.types.INPUT,t.connection):null},n.ASTNode.createBlockNode=function(t){return t?new n.ASTNode(n.ASTNode.types.BLOCK,t):null},n.ASTNode.createStackNode=function(t){return t?new n.ASTNode(n.ASTNode.types.STACK,t):null},n.ASTNode.createWorkspaceNode=function(t,e){return e&&t?new n.ASTNode(n.ASTNode.types.WORKSPACE,t,{wsCoordinate:e}):null},n.ASTNode.createTopNode=function(t){var e=t.previousConnection||t.outputConnection;return e?n.ASTNode.createConnectionNode(e):n.ASTNode.createBlockNode(t)},n.ASTNode.prototype.processParams_=function(t){t&&t.wsCoordinate&&(this.wsCoordinate_=t.wsCoordinate)},n.ASTNode.prototype.getLocation=function(){return this.location_},n.ASTNode.prototype.getType=function(){return this.type_},n.ASTNode.prototype.getWsCoordinate=function(){return this.wsCoordinate_},n.ASTNode.prototype.isConnection=function(){return this.isConnection_},n.ASTNode.prototype.findNextForInput_=function(){var t,e=this.location_.getParentInput(),i=e.getSourceBlock();for(e=i.inputList.indexOf(e)+1;t=i.inputList[e];e++){for(var o,r=t.fieldRow,s=0;o=r[s];s++)if(o.isClickable()||n.ASTNode.NAVIGATE_ALL_FIELDS)return n.ASTNode.createFieldNode(o);if(t.connection)return n.ASTNode.createInputNode(t)}return null},n.ASTNode.prototype.findNextForField_=function(){var t=this.location_,e=t.getParentInput(),i=t.getSourceBlock(),o=i.inputList.indexOf(e);for(t=e.fieldRow.indexOf(t)+1;e=i.inputList[o];o++){for(var r=e.fieldRow;t<r.length;){if(r[t].isClickable()||n.ASTNode.NAVIGATE_ALL_FIELDS)return n.ASTNode.createFieldNode(r[t]);t++}if(t=0,e.connection)return n.ASTNode.createInputNode(e)}return null},n.ASTNode.prototype.findPrevForInput_=function(){for(var t,e=this.location_.getParentInput(),i=e.getSourceBlock(),o=i.inputList.indexOf(e);t=i.inputList[o];o--){if(t.connection&&t!==e)return n.ASTNode.createInputNode(t);for(var r,s=(t=t.fieldRow).length-1;r=t[s];s--)if(r.isClickable()||n.ASTNode.NAVIGATE_ALL_FIELDS)return n.ASTNode.createFieldNode(r)}return null},n.ASTNode.prototype.findPrevForField_=function(){var t,e=this.location_,i=e.getParentInput(),o=e.getSourceBlock(),r=o.inputList.indexOf(i);for(e=i.fieldRow.indexOf(e)-1;t=o.inputList[r];r--){if(t.connection&&t!==i)return n.ASTNode.createInputNode(t);for(t=t.fieldRow;-1<e;){if(t[e].isClickable()||n.ASTNode.NAVIGATE_ALL_FIELDS)return n.ASTNode.createFieldNode(t[e]);e--}0<=r-1&&(e=o.inputList[r-1].fieldRow.length-1)}return null},n.ASTNode.prototype.navigateBetweenStacks_=function(t){var e=this.getLocation();if(e instanceof n.Block||(e=e.getSourceBlock()),!e||!e.workspace)return null;var i=e.getRootBlock();e=i.workspace.getTopBlocks(!0);for(var o,r=0;o=e[r];r++)if(i.id==o.id)return-1==(t=r+(t?1:-1))||t==e.length?null:n.ASTNode.createStackNode(e[t]);throw Error("Couldn't find "+(t?"next":"previous")+" stack?!")},n.ASTNode.prototype.findTopASTNodeForBlock_=function(t){var e=t.previousConnection||t.outputConnection;return e?n.ASTNode.createConnectionNode(e):n.ASTNode.createBlockNode(t)},n.ASTNode.prototype.getOutAstNodeForBlock_=function(t){if(!t)return null;var e=(t=t.getTopStackBlock()).previousConnection||t.outputConnection;return e&&e.targetConnection&&e.targetConnection.getParentInput()?n.ASTNode.createInputNode(e.targetConnection.getParentInput()):n.ASTNode.createStackNode(t)},n.ASTNode.prototype.findFirstFieldOrInput_=function(t){t=t.inputList;for(var e,i=0;e=t[i];i++){for(var o,r=e.fieldRow,s=0;o=r[s];s++)if(o.isClickable()||n.ASTNode.NAVIGATE_ALL_FIELDS)return n.ASTNode.createFieldNode(o);if(e.connection)return n.ASTNode.createInputNode(e)}return null},n.ASTNode.prototype.getSourceBlock=function(){return this.getType()===n.ASTNode.types.BLOCK||this.getType()===n.ASTNode.types.STACK?this.getLocation():this.getType()===n.ASTNode.types.WORKSPACE?null:this.getLocation().getSourceBlock()},n.ASTNode.prototype.next=function(){switch(this.type_){case n.ASTNode.types.STACK:return this.navigateBetweenStacks_(!0);case n.ASTNode.types.OUTPUT:var t=this.location_;return n.ASTNode.createBlockNode(t.getSourceBlock());case n.ASTNode.types.FIELD:return this.findNextForField_();case n.ASTNode.types.INPUT:return this.findNextForInput_();case n.ASTNode.types.BLOCK:return n.ASTNode.createConnectionNode(this.location_.nextConnection);case n.ASTNode.types.PREVIOUS:return t=this.location_,n.ASTNode.createBlockNode(t.getSourceBlock());case n.ASTNode.types.NEXT:return t=this.location_,n.ASTNode.createConnectionNode(t.targetConnection)}return null},n.ASTNode.prototype.in=function(){switch(this.type_){case n.ASTNode.types.WORKSPACE:var t=this.location_.getTopBlocks(!0);if(0<t.length)return n.ASTNode.createStackNode(t[0]);break;case n.ASTNode.types.STACK:return t=this.location_,this.findTopASTNodeForBlock_(t);case n.ASTNode.types.BLOCK:return t=this.location_,this.findFirstFieldOrInput_(t);case n.ASTNode.types.INPUT:return n.ASTNode.createConnectionNode(this.location_.targetConnection)}return null},n.ASTNode.prototype.prev=function(){switch(this.type_){case n.ASTNode.types.STACK:return this.navigateBetweenStacks_(!1);case n.ASTNode.types.FIELD:return this.findPrevForField_();case n.ASTNode.types.INPUT:return this.findPrevForInput_();case n.ASTNode.types.BLOCK:var t=this.location_;return n.ASTNode.createConnectionNode(t.previousConnection||t.outputConnection);case n.ASTNode.types.PREVIOUS:if((t=(t=this.location_).targetConnection)&&!t.getParentInput())return n.ASTNode.createConnectionNode(t);break;case n.ASTNode.types.NEXT:return t=this.location_,n.ASTNode.createBlockNode(t.getSourceBlock())}return null},n.ASTNode.prototype.out=function(){switch(this.type_){case n.ASTNode.types.STACK:var t=this.location_,e=t.getRelativeToSurfaceXY();return e=new n.utils.Coordinate(e.x,e.y+n.ASTNode.DEFAULT_OFFSET_Y),n.ASTNode.createWorkspaceNode(t.workspace,e);case n.ASTNode.types.OUTPUT:return(e=(t=this.location_).targetConnection)?n.ASTNode.createConnectionNode(e):n.ASTNode.createStackNode(t.getSourceBlock());case n.ASTNode.types.FIELD:return n.ASTNode.createBlockNode(this.location_.getSourceBlock());case n.ASTNode.types.INPUT:return t=this.location_,n.ASTNode.createBlockNode(t.getSourceBlock());case n.ASTNode.types.BLOCK:return t=this.location_,this.getOutAstNodeForBlock_(t);case n.ASTNode.types.PREVIOUS:case n.ASTNode.types.NEXT:return t=this.location_,this.getOutAstNodeForBlock_(t.getSourceBlock())}return null},n.Blocks=Object.create(null),n.utils.deprecation={},n.utils.deprecation.warn=function(t,e,n,i){t=t+" was deprecated on "+e+" and will be deleted on "+n+".",i&&(t+="\nUse "+i+" instead."),console.warn(t)},n.Connection=function(t,e){this.sourceBlock_=t,this.type=e},n.Connection.CAN_CONNECT=0,n.Connection.REASON_SELF_CONNECTION=1,n.Connection.REASON_WRONG_TYPE=2,n.Connection.REASON_TARGET_NULL=3,n.Connection.REASON_CHECKS_FAILED=4,n.Connection.REASON_DIFFERENT_WORKSPACES=5,n.Connection.REASON_SHADOW_PARENT=6,n.Connection.REASON_DRAG_CHECKS_FAILED=7,n.Connection.prototype.targetConnection=null,n.Connection.prototype.disposed=!1,n.Connection.prototype.check_=null,n.Connection.prototype.shadowDom_=null,n.Connection.prototype.x=0,n.Connection.prototype.y=0,n.Connection.prototype.connect_=function(t){var e,i=this,o=i.getSourceBlock(),r=t.getSourceBlock();if(t.isConnected()&&t.disconnect(),i.isConnected()){var s=i.targetBlock(),a=i.getShadowDom();if(i.shadowDom_=null,s.isShadow())a=n.Xml.blockToDom(s),s.dispose(!1),s=null;else if(i.type==n.INPUT_VALUE){if(!s.outputConnection)throw Error("Orphan block does not have an output connection.");var l=n.Connection.lastConnectionInRow(r,s);l&&(s.outputConnection.connect(l),s=null)}else if(i.type==n.NEXT_STATEMENT){if(!s.previousConnection)throw Error("Orphan block does not have a previous connection.");for(l=r;l.nextConnection;){var c=l.getNextBlock();if(!c||c.isShadow()){s.workspace.connectionChecker.canConnect(s.previousConnection,l.nextConnection,!1)&&(l.nextConnection.connect(s.previousConnection),s=null);break}l=c}}if(s&&(i.disconnect(),n.Events.recordUndo)){var d=n.Events.getGroup();setTimeout((function(){s.workspace&&!s.getParent()&&(n.Events.setGroup(d),s.outputConnection?s.outputConnection.onFailedConnect(i):s.previousConnection&&s.previousConnection.onFailedConnect(i),n.Events.setGroup(!1))}),n.BUMP_DELAY)}i.shadowDom_=a}n.Events.isEnabled()&&(e=new n.Events.BlockMove(r)),n.Connection.connectReciprocally_(i,t),r.setParent(o),e&&(e.recordNew(),n.Events.fire(e))},n.Connection.prototype.dispose=function(){if(this.isConnected()){this.setShadowDom(null);var t=this.targetBlock();t&&t.unplug()}this.disposed=!0},n.Connection.prototype.getSourceBlock=function(){return this.sourceBlock_},n.Connection.prototype.isSuperior=function(){return this.type==n.INPUT_VALUE||this.type==n.NEXT_STATEMENT},n.Connection.prototype.isConnected=function(){return!!this.targetConnection},n.Connection.prototype.canConnectWithReason=function(t){return n.utils.deprecation.warn("Connection.prototype.canConnectWithReason","July 2020","July 2021","the workspace's connection checker"),this.getConnectionChecker().canConnectWithReason(this,t,!1)},n.Connection.prototype.checkConnection=function(t){n.utils.deprecation.warn("Connection.prototype.checkConnection","July 2020","July 2021","the workspace's connection checker");var e=this.getConnectionChecker(),i=e.canConnectWithReason(this,t,!1);if(i!=n.Connection.CAN_CONNECT)throw Error(e.getErrorMessage(i,this,t))},n.Connection.prototype.getConnectionChecker=function(){return this.sourceBlock_.workspace.connectionChecker},n.Connection.prototype.isConnectionAllowed=function(t){return n.utils.deprecation.warn("Connection.prototype.isConnectionAllowed","July 2020","July 2021","the workspace's connection checker"),this.getConnectionChecker().canConnect(this,t,!0)},n.Connection.prototype.onFailedConnect=function(t){},n.Connection.prototype.connect=function(t){if(this.targetConnection!=t&&this.getConnectionChecker().canConnect(this,t,!1)){var e=n.Events.getGroup();e||n.Events.setGroup(!0),this.isSuperior()?this.connect_(t):t.connect_(this),e||n.Events.setGroup(!1)}},n.Connection.connectReciprocally_=function(t,e){if(!t||!e)throw Error("Cannot connect null connections.");t.targetConnection=e,e.targetConnection=t},n.Connection.singleConnection_=function(t,e){var i=null;e=e.outputConnection;for(var o=0;o<t.inputList.length;o++){var r=t.inputList[o].connection,s=e.getConnectionChecker();if(r&&r.type==n.INPUT_VALUE&&s.canConnect(e,r,!1)){if(i)return null;i=r}}return i},n.Connection.lastConnectionInRow=function(t,e){for(var i;i=n.Connection.singleConnection_(t,e);)if(!(t=i.targetBlock())||t.isShadow())return i;return null},n.Connection.prototype.disconnect=function(){var t=this.targetConnection;if(!t)throw Error("Source connection not connected.");if(t.targetConnection!=this)throw Error("Target connection not connected to source connection.");if(this.isSuperior()){var e=this.sourceBlock_,i=t.getSourceBlock();t=this}else e=t.getSourceBlock(),i=this.sourceBlock_;var o=n.Events.getGroup();o||n.Events.setGroup(!0),this.disconnectInternal_(e,i),i.isShadow()||t.respawnShadow_(),o||n.Events.setGroup(!1)},n.Connection.prototype.disconnectInternal_=function(t,e){var i;n.Events.isEnabled()&&(i=new n.Events.BlockMove(e)),this.targetConnection=this.targetConnection.targetConnection=null,e.setParent(null),i&&(i.recordNew(),n.Events.fire(i))},n.Connection.prototype.respawnShadow_=function(){var t=this.getSourceBlock(),e=this.getShadowDom();if(t.workspace&&e)if((t=n.Xml.domToBlock(e,t.workspace)).outputConnection)this.connect(t.outputConnection);else{if(!t.previousConnection)throw Error("Child block does not have output or previous statement.");this.connect(t.previousConnection)}},n.Connection.prototype.targetBlock=function(){return this.isConnected()?this.targetConnection.getSourceBlock():null},n.Connection.prototype.checkType=function(t){return n.utils.deprecation.warn("Connection.prototype.checkType","October 2019","January 2021","the workspace's connection checker"),this.getConnectionChecker().canConnect(this,t,!1)},n.Connection.prototype.checkType_=function(t){return n.utils.deprecation.warn("Connection.prototype.checkType_","October 2019","January 2021","the workspace's connection checker"),this.checkType(t)},n.Connection.prototype.onCheckChanged_=function(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()},n.Connection.prototype.setCheck=function(t){return t?(Array.isArray(t)||(t=[t]),this.check_=t,this.onCheckChanged_()):this.check_=null,this},n.Connection.prototype.getCheck=function(){return this.check_},n.Connection.prototype.setShadowDom=function(t){this.shadowDom_=t,(t=this.targetBlock())?t.isShadow()&&(t.dispose(!1),this.respawnShadow_()):this.respawnShadow_()},n.Connection.prototype.getShadowDom=function(){return this.shadowDom_},n.Connection.prototype.neighbours=function(t){return[]},n.Connection.prototype.getParentInput=function(){for(var t=null,e=this.sourceBlock_,n=e.inputList,i=0;i<e.inputList.length;i++)if(n[i].connection===this){t=n[i];break}return t},n.Connection.prototype.toString=function(){var t=this.sourceBlock_;if(!t)return"Orphan Connection";if(t.outputConnection==this)var e="Output Connection of ";else if(t.previousConnection==this)e="Previous Connection of ";else if(t.nextConnection==this)e="Next Connection of ";else{e=null;for(var n,i=0;n=t.inputList[i];i++)if(n.connection==this){e=n;break}if(!e)return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection";e='Input "'+e.name+'" connection on '}return e+t.toDevString()},n.Extensions={},n.Extensions.ALL_={},n.Extensions.register=function(t,e){if("string"!=typeof t||""==t.trim())throw Error('Error: Invalid extension name "'+t+'"');if(n.Extensions.ALL_[t])throw Error('Error: Extension "'+t+'" is already registered.');if("function"!=typeof e)throw Error('Error: Extension "'+t+'" must be a function');n.Extensions.ALL_[t]=e},n.Extensions.registerMixin=function(t,e){if(!e||"object"!=typeof e)throw Error('Error: Mixin "'+t+'" must be a object');n.Extensions.register(t,(function(){this.mixin(e)}))},n.Extensions.registerMutator=function(t,e,i,o){var r='Error when registering mutator "'+t+'": ';n.Extensions.checkHasFunction_(r,e.domToMutation,"domToMutation"),n.Extensions.checkHasFunction_(r,e.mutationToDom,"mutationToDom");var s=n.Extensions.checkMutatorDialog_(e,r);if(i&&"function"!=typeof i)throw Error('Extension "'+t+'" is not a function');n.Extensions.register(t,(function(){if(s){if(!n.Mutator)throw Error(r+"Missing require for Blockly.Mutator");this.setMutator(new n.Mutator(o||[]))}this.mixin(e),i&&i.apply(this)}))},n.Extensions.unregister=function(t){n.Extensions.ALL_[t]?delete n.Extensions.ALL_[t]:console.warn('No extension mapping for name "'+t+'" found to unregister')},n.Extensions.apply=function(t,e,i){var o=n.Extensions.ALL_[t];if("function"!=typeof o)throw Error('Error: Extension "'+t+'" not found.');if(i)n.Extensions.checkNoMutatorProperties_(t,e);else var r=n.Extensions.getMutatorProperties_(e);if(o.apply(e),i)n.Extensions.checkBlockHasMutatorProperties_('Error after applying mutator "'+t+'": ',e);else if(!n.Extensions.mutatorPropertiesMatch_(r,e))throw Error('Error when applying extension "'+t+'": mutation properties changed when applying a non-mutator extension.')},n.Extensions.checkHasFunction_=function(t,e,n){if(!e)throw Error(t+'missing required property "'+n+'"');if("function"!=typeof e)throw Error(t+'" required property "'+n+'" must be a function')},n.Extensions.checkNoMutatorProperties_=function(t,e){if(n.Extensions.getMutatorProperties_(e).length)throw Error('Error: tried to apply mutation "'+t+'" to a block that already has mutator functions.  Block id: '+e.id)},n.Extensions.checkMutatorDialog_=function(t,e){var n=void 0!==t.compose,i=void 0!==t.decompose;if(n&&i){if("function"!=typeof t.compose)throw Error(e+"compose must be a function.");if("function"!=typeof t.decompose)throw Error(e+"decompose must be a function.");return!0}if(n||i)throw Error(e+'Must have both or neither of "compose" and "decompose"');return!1},n.Extensions.checkBlockHasMutatorProperties_=function(t,e){if("function"!=typeof e.domToMutation)throw Error(t+'Applying a mutator didn\'t add "domToMutation"');if("function"!=typeof e.mutationToDom)throw Error(t+'Applying a mutator didn\'t add "mutationToDom"');n.Extensions.checkMutatorDialog_(e,t)},n.Extensions.getMutatorProperties_=function(t){var e=[];return void 0!==t.domToMutation&&e.push(t.domToMutation),void 0!==t.mutationToDom&&e.push(t.mutationToDom),void 0!==t.compose&&e.push(t.compose),void 0!==t.decompose&&e.push(t.decompose),e},n.Extensions.mutatorPropertiesMatch_=function(t,e){if((e=n.Extensions.getMutatorProperties_(e)).length!=t.length)return!1;for(var i=0;i<e.length;i++)if(t[i]!=e[i])return!1;return!0},n.Extensions.buildTooltipForDropdown=function(t,e){var i=[];return"object"==typeof document&&n.utils.runAfterPageLoad((function(){for(var t in e)n.utils.checkMessageReferences(e[t])})),function(){this.type&&-1==i.indexOf(this.type)&&(n.Extensions.checkDropdownOptionsInTable_(this,t,e),i.push(this.type)),this.setTooltip(function(){var o=String(this.getFieldValue(t)),r=e[o];return null==r?-1==i.indexOf(this.type)&&(o="No tooltip mapping for value "+o+" of field "+t,null!=this.type&&(o+=" of block type "+this.type),console.warn(o+".")):r=n.utils.replaceMessageReferences(r),r}.bind(this))}},n.Extensions.checkDropdownOptionsInTable_=function(t,e,n){var i=t.getField(e);if(!i.isOptionListDynamic()){i=i.getOptions();for(var o=0;o<i.length;++o){var r=i[o][1];null==n[r]&&console.warn("No tooltip mapping for value "+r+" of field "+e+" of block type "+t.type)}}},n.Extensions.buildTooltipWithFieldText=function(t,e){return"object"==typeof document&&n.utils.runAfterPageLoad((function(){n.utils.checkMessageReferences(t)})),function(){this.setTooltip(function(){var i=this.getField(e);return n.utils.replaceMessageReferences(t).replace("%1",i?i.getText():"")}.bind(this))}},n.Extensions.extensionParentTooltip_=function(){this.tooltipWhenNotConnected_=this.tooltip,this.setTooltip(function(){var t=this.getParent();return t&&t.getInputsInline()&&t.tooltip||this.tooltipWhenNotConnected_}.bind(this))},n.Extensions.register("parent_tooltip_when_inline",n.Extensions.extensionParentTooltip_),n.fieldRegistry={},n.fieldRegistry.register=function(t,e){n.registry.register(n.registry.Type.FIELD,t,e)},n.fieldRegistry.unregister=function(t){n.registry.unregister(n.registry.Type.FIELD,t)},n.fieldRegistry.fromJson=function(t){var e=n.registry.getObject(n.registry.Type.FIELD,t.type);return e?e.fromJson(t):(console.warn("Blockly could not create a field of type "+t.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null)},n.blockAnimations={},n.blockAnimations.disconnectPid_=0,n.blockAnimations.disconnectGroup_=null,n.blockAnimations.disposeUiEffect=function(t){var e=t.workspace,i=t.getSvgRoot();e.getAudioManager().play("delete"),t=e.getSvgXY(i),(i=i.cloneNode(!0)).translateX_=t.x,i.translateY_=t.y,i.setAttribute("transform","translate("+t.x+","+t.y+")"),e.getParentSvg().appendChild(i),i.bBox_=i.getBBox(),n.blockAnimations.disposeUiStep_(i,e.RTL,new Date,e.scale)},n.blockAnimations.disposeUiStep_=function(t,e,i,o){var r=(new Date-i)/150;1<r?n.utils.dom.removeNode(t):(t.setAttribute("transform","translate("+(t.translateX_+(e?-1:1)*t.bBox_.width*o/2*r)+","+(t.translateY_+t.bBox_.height*o*r)+") scale("+(1-r)*o+")"),setTimeout(n.blockAnimations.disposeUiStep_,10,t,e,i,o))},n.blockAnimations.connectionUiEffect=function(t){var e=t.workspace,i=e.scale;if(e.getAudioManager().play("click"),!(1>i)){var o=e.getSvgXY(t.getSvgRoot());t.outputConnection?(o.x+=(t.RTL?3:-3)*i,o.y+=13*i):t.previousConnection&&(o.x+=(t.RTL?-23:23)*i,o.y+=3*i),t=n.utils.dom.createSvgElement(n.utils.Svg.CIRCLE,{cx:o.x,cy:o.y,r:0,fill:"none",stroke:"#888","stroke-width":10},e.getParentSvg()),n.blockAnimations.connectionUiStep_(t,new Date,i)}},n.blockAnimations.connectionUiStep_=function(t,e,i){var o=(new Date-e)/150;1<o?n.utils.dom.removeNode(t):(t.setAttribute("r",25*o*i),t.style.opacity=1-o,n.blockAnimations.disconnectPid_=setTimeout(n.blockAnimations.connectionUiStep_,10,t,e,i))},n.blockAnimations.disconnectUiEffect=function(t){if(t.workspace.getAudioManager().play("disconnect"),!(1>t.workspace.scale)){var e=t.getHeightWidth().height;e=Math.atan(10/e)/Math.PI*180,t.RTL||(e*=-1),n.blockAnimations.disconnectUiStep_(t.getSvgRoot(),e,new Date)}},n.blockAnimations.disconnectUiStep_=function(t,e,i){var o=(new Date-i)/200;1<o?t.skew_="":(t.skew_="skewX("+Math.round(Math.sin(o*Math.PI*3)*(1-o)*e)+")",n.blockAnimations.disconnectGroup_=t,n.blockAnimations.disconnectPid_=setTimeout(n.blockAnimations.disconnectUiStep_,10,t,e,i)),t.setAttribute("transform",t.translate_+t.skew_)},n.blockAnimations.disconnectUiStop=function(){if(n.blockAnimations.disconnectGroup_){clearTimeout(n.blockAnimations.disconnectPid_);var t=n.blockAnimations.disconnectGroup_;t.skew_="",t.setAttribute("transform",t.translate_),n.blockAnimations.disconnectGroup_=null}},n.Events.BlockDrag=function(t,e,i){n.Events.BlockDrag.superClass_.constructor.call(this,t?t.workspace.id:void 0),this.blockId=t?t.id:null,this.isStart=e,this.blocks=i},n.utils.object.inherits(n.Events.BlockDrag,n.Events.UiBase),n.Events.BlockDrag.prototype.type=n.Events.BLOCK_DRAG,n.Events.BlockDrag.prototype.toJson=function(){var t=n.Events.BlockDrag.superClass_.toJson.call(this);return t.isStart=this.isStart,t.blockId=this.blockId,t.blocks=this.blocks,t},n.Events.BlockDrag.prototype.fromJson=function(t){n.Events.BlockDrag.superClass_.fromJson.call(this,t),this.isStart=t.isStart,this.blockId=t.blockId,this.blocks=t.blocks},n.registry.register(n.registry.Type.EVENT,n.Events.BLOCK_DRAG,n.Events.BlockDrag),n.InsertionMarkerManager=function(t){this.topBlock_=n.selected=t,this.workspace_=t.workspace,this.lastMarker_=this.lastOnStack_=null,this.firstMarker_=this.createMarkerBlock_(this.topBlock_),this.localConnection_=this.closestConnection_=null,this.wouldDeleteBlock_=!1,this.fadedBlock_=this.highlightedBlock_=this.markerConnection_=null,this.availableConnections_=this.initAvailableConnections_()},n.InsertionMarkerManager.PREVIEW_TYPE={INSERTION_MARKER:0,INPUT_OUTLINE:1,REPLACEMENT_FADE:2},n.InsertionMarkerManager.prototype.dispose=function(){this.availableConnections_.length=0,n.Events.disable();try{this.firstMarker_&&this.firstMarker_.dispose(),this.lastMarker_&&this.lastMarker_.dispose()}finally{n.Events.enable()}},n.InsertionMarkerManager.prototype.updateAvailableConnections=function(){this.availableConnections_=this.initAvailableConnections_()},n.InsertionMarkerManager.prototype.wouldDeleteBlock=function(){return this.wouldDeleteBlock_},n.InsertionMarkerManager.prototype.wouldConnectBlock=function(){return!!this.closestConnection_},n.InsertionMarkerManager.prototype.applyConnections=function(){if(this.closestConnection_&&(n.Events.disable(),this.hidePreview_(),n.Events.enable(),this.localConnection_.connect(this.closestConnection_),this.topBlock_.rendered)){var t=this.localConnection_.isSuperior()?this.closestConnection_:this.localConnection_;n.blockAnimations.connectionUiEffect(t.getSourceBlock()),this.topBlock_.getRootBlock().bringToFront()}},n.InsertionMarkerManager.prototype.update=function(t,e){var i=this.getCandidate_(t);((this.wouldDeleteBlock_=this.shouldDelete_(i,e))||this.shouldUpdatePreviews_(i,t))&&(n.Events.disable(),this.maybeHidePreview_(i),this.maybeShowPreview_(i),n.Events.enable())},n.InsertionMarkerManager.prototype.createMarkerBlock_=function(t){var e=t.type;n.Events.disable();try{var i=this.workspace_.newBlock(e);if(i.setInsertionMarker(!0),t.mutationToDom){var o=t.mutationToDom();o&&i.domToMutation(o)}for(e=0;e<t.inputList.length;e++){var r=t.inputList[e];if(r.name!=n.Block.COLLAPSED_INPUT_NAME){var s=i.inputList[e];for(o=0;o<r.fieldRow.length;o++)s.fieldRow[o].setValue(r.fieldRow[o].getValue())}}i.setCollapsed(t.isCollapsed()),i.setInputsInline(t.getInputsInline()),i.initSvg(),i.getSvgRoot().setAttribute("visibility","hidden")}finally{n.Events.enable()}return i},n.InsertionMarkerManager.prototype.initAvailableConnections_=function(){var t=this.topBlock_.getConnections_(!1),e=this.topBlock_.lastConnectionInStack();if(e&&e!=this.topBlock_.nextConnection){if(t.push(e),this.lastOnStack_=e,this.lastMarker_){n.Events.disable();try{this.lastMarker_.dispose()}finally{n.Events.enable()}}this.lastMarker_=this.createMarkerBlock_(e.getSourceBlock())}return t},n.InsertionMarkerManager.prototype.shouldUpdatePreviews_=function(t,e){var i=t.local,o=t.closest;return t=t.radius,i&&o?this.localConnection_&&this.closestConnection_?!(this.closestConnection_==o&&this.localConnection_==i||(i=this.localConnection_.x+e.x-this.closestConnection_.x,e=this.localConnection_.y+e.y-this.closestConnection_.y,e=Math.sqrt(i*i+e*e),o&&t>e-n.CURRENT_CONNECTION_PREFERENCE)):!this.localConnection_&&!this.closestConnection_||(console.error("Only one of localConnection_ and closestConnection_ was set."),console.error("Returning true from shouldUpdatePreviews, but it's not clear why."),!0):!(!this.localConnection_||!this.closestConnection_)},n.InsertionMarkerManager.prototype.getCandidate_=function(t){for(var e=this.getStartRadius_(),n=null,i=null,o=0;o<this.availableConnections_.length;o++){var r=this.availableConnections_[o],s=r.closest(e,t);s.connection&&(n=s.connection,i=r,e=s.radius)}return{closest:n,local:i,radius:e}},n.InsertionMarkerManager.prototype.getStartRadius_=function(){return this.closestConnection_&&this.localConnection_?n.CONNECTING_SNAP_RADIUS:n.SNAP_RADIUS},n.InsertionMarkerManager.prototype.shouldDelete_=function(t,e){return t=t&&!!t.closest&&e!=n.DELETE_AREA_TOOLBOX,!!e&&!this.topBlock_.getParent()&&this.topBlock_.isDeletable()&&!t},n.InsertionMarkerManager.prototype.maybeShowPreview_=function(t){if(!this.wouldDeleteBlock_){var e=t.closest;t=t.local,e&&(e==this.closestConnection_||e.getSourceBlock().isInsertionMarker()?console.log("Trying to connect to an insertion marker"):(this.closestConnection_=e,this.localConnection_=t,this.showPreview_()))}},n.InsertionMarkerManager.prototype.showPreview_=function(){var t=this.closestConnection_,e=this.workspace_.getRenderer();switch(e.getConnectionPreviewMethod(t,this.localConnection_,this.topBlock_)){case n.InsertionMarkerManager.PREVIEW_TYPE.INPUT_OUTLINE:this.showInsertionInputOutline_();break;case n.InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER:this.showInsertionMarker_();break;case n.InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE:this.showReplacementFade_()}t&&e.shouldHighlightConnection(t)&&t.highlight()},n.InsertionMarkerManager.prototype.maybeHidePreview_=function(t){if(t.closest){var e=this.closestConnection_!=t.closest;t=this.localConnection_!=t.local,this.closestConnection_&&this.localConnection_&&(e||t||this.wouldDeleteBlock_)&&this.hidePreview_()}else this.hidePreview_();this.localConnection_=this.closestConnection_=this.markerConnection_=null},n.InsertionMarkerManager.prototype.hidePreview_=function(){this.closestConnection_&&this.closestConnection_.targetBlock()&&this.workspace_.getRenderer().shouldHighlightConnection(this.closestConnection_)&&this.closestConnection_.unhighlight(),this.fadedBlock_?this.hideReplacementFade_():this.highlightedBlock_?this.hideInsertionInputOutline_():this.markerConnection_&&this.hideInsertionMarker_()},n.InsertionMarkerManager.prototype.showInsertionMarker_=function(){var t=this.localConnection_,e=this.closestConnection_,n=this.lastOnStack_&&t==this.lastOnStack_?this.lastMarker_:this.firstMarker_;if((t=n.getMatchingConnection(t.getSourceBlock(),t))==this.markerConnection_)throw Error("Made it to showInsertionMarker_ even though the marker isn't changing");n.render(),n.rendered=!0,n.getSvgRoot().setAttribute("visibility","visible"),t&&e&&n.positionNearConnection(t,e),e&&t.connect(e),this.markerConnection_=t},n.InsertionMarkerManager.prototype.hideInsertionMarker_=function(){if(this.markerConnection_){var t=this.markerConnection_,e=t.getSourceBlock(),i=e.nextConnection,o=e.previousConnection,r=e.outputConnection;if(r=t.type==n.INPUT_VALUE&&!(r&&r.targetConnection),!(t!=i||o&&o.targetConnection)||r?t.targetBlock().unplug(!1):t.type==n.NEXT_STATEMENT&&t!=i?((i=t.targetConnection).getSourceBlock().unplug(!1),o=o?o.targetConnection:null,e.unplug(!0),o&&o.connect(i)):e.unplug(!0),t.targetConnection)throw Error("markerConnection_ still connected at the end of disconnectInsertionMarker");this.markerConnection_=null,e.getSvgRoot().setAttribute("visibility","hidden")}else console.log("No insertion marker connection to disconnect")},n.InsertionMarkerManager.prototype.showInsertionInputOutline_=function(){var t=this.closestConnection_;this.highlightedBlock_=t.getSourceBlock(),this.highlightedBlock_.highlightShapeForInput(t,!0)},n.InsertionMarkerManager.prototype.hideInsertionInputOutline_=function(){this.highlightedBlock_.highlightShapeForInput(this.closestConnection_,!1),this.highlightedBlock_=null},n.InsertionMarkerManager.prototype.showReplacementFade_=function(){this.fadedBlock_=this.closestConnection_.targetBlock(),this.fadedBlock_.fadeForReplacement(!0)},n.InsertionMarkerManager.prototype.hideReplacementFade_=function(){this.fadedBlock_.fadeForReplacement(!1),this.fadedBlock_=null},n.InsertionMarkerManager.prototype.getInsertionMarkers=function(){var t=[];return this.firstMarker_&&t.push(this.firstMarker_),this.lastMarker_&&t.push(this.lastMarker_),t},n.BlockDragger=function(t,e){this.draggingBlock_=t,this.workspace_=e,this.draggedConnectionManager_=new n.InsertionMarkerManager(this.draggingBlock_),this.deleteArea_=null,this.wouldDeleteBlock_=!1,this.startXY_=this.draggingBlock_.getRelativeToSurfaceXY(),this.dragIconData_=n.BlockDragger.initIconData_(t)},n.BlockDragger.prototype.dispose=function(){this.dragIconData_.length=0,this.draggedConnectionManager_&&this.draggedConnectionManager_.dispose()},n.BlockDragger.initIconData_=function(t){var e=[];t=t.getDescendants(!1);for(var n,i=0;n=t[i];i++){n=n.getIcons();for(var o=0;o<n.length;o++){var r={location:n[o].getIconLocation(),icon:n[o]};e.push(r)}}return e},n.BlockDragger.prototype.startBlockDrag=function(t,e){n.Events.getGroup()||n.Events.setGroup(!0),this.fireDragStartEvent_(),this.workspace_.isMutator&&this.draggingBlock_.bringToFront(),n.utils.dom.startTextWidthCache(),this.workspace_.setResizesEnabled(!1),n.blockAnimations.disconnectUiStop(),(this.draggingBlock_.getParent()||e&&this.draggingBlock_.nextConnection&&this.draggingBlock_.nextConnection.targetBlock())&&(this.draggingBlock_.unplug(e),t=this.pixelsToWorkspaceUnits_(t),t=n.utils.Coordinate.sum(this.startXY_,t),this.draggingBlock_.translate(t.x,t.y),n.blockAnimations.disconnectUiEffect(this.draggingBlock_),this.draggedConnectionManager_.updateAvailableConnections()),this.draggingBlock_.setDragging(!0),this.draggingBlock_.moveToDragSurface(),(t=this.workspace_.getToolbox())&&"function"==typeof t.addStyle&&(e=this.draggingBlock_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab",t.addStyle(e))},n.BlockDragger.prototype.fireDragStartEvent_=function(){var t=new n.Events.BlockDrag(this.draggingBlock_,!0,this.draggingBlock_.getDescendants(!1));n.Events.fire(t)},n.BlockDragger.prototype.dragBlock=function(t,e){e=this.pixelsToWorkspaceUnits_(e);var i=n.utils.Coordinate.sum(this.startXY_,e);this.draggingBlock_.moveDuringDrag(i),this.dragIcons_(e),this.deleteArea_=this.workspace_.isDeleteArea(t),this.draggedConnectionManager_.update(e,this.deleteArea_),this.updateCursorDuringBlockDrag_()},n.BlockDragger.prototype.endBlockDrag=function(t,e){this.dragBlock(t,e),this.dragIconData_=[],this.fireDragEndEvent_(),n.utils.dom.stopTextWidthCache(),n.blockAnimations.disconnectUiStop(),t=this.pixelsToWorkspaceUnits_(e),e=n.utils.Coordinate.sum(this.startXY_,t),this.draggingBlock_.moveOffDragSurface(e),this.maybeDeleteBlock_()||(this.draggingBlock_.moveConnections(t.x,t.y),this.draggingBlock_.setDragging(!1),this.fireMoveEvent_(),this.draggedConnectionManager_.wouldConnectBlock()?this.draggedConnectionManager_.applyConnections():this.draggingBlock_.render(),this.draggingBlock_.scheduleSnapAndBump()),this.workspace_.setResizesEnabled(!0),(t=this.workspace_.getToolbox())&&"function"==typeof t.removeStyle&&(e=this.draggingBlock_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab",t.removeStyle(e)),n.Events.setGroup(!1)},n.BlockDragger.prototype.fireDragEndEvent_=function(){var t=new n.Events.BlockDrag(this.draggingBlock_,!1,this.draggingBlock_.getDescendants(!1));n.Events.fire(t)},n.BlockDragger.prototype.fireMoveEvent_=function(){var t=new n.Events.BlockMove(this.draggingBlock_);t.oldCoordinate=this.startXY_,t.recordNew(),n.Events.fire(t)},n.BlockDragger.prototype.maybeDeleteBlock_=function(){var t=this.workspace_.trashcan;return this.wouldDeleteBlock_?(t&&setTimeout(t.closeLid.bind(t),100),this.fireMoveEvent_(),this.draggingBlock_.dispose(!1,!0),n.draggingConnections=[]):t&&t.closeLid(),this.wouldDeleteBlock_},n.BlockDragger.prototype.updateCursorDuringBlockDrag_=function(){this.wouldDeleteBlock_=this.draggedConnectionManager_.wouldDeleteBlock();var t=this.workspace_.trashcan;this.wouldDeleteBlock_?(this.draggingBlock_.setDeleteStyle(!0),this.deleteArea_==n.DELETE_AREA_TRASH&&t&&t.setLidOpen(!0)):(this.draggingBlock_.setDeleteStyle(!1),t&&t.setLidOpen(!1))},n.BlockDragger.prototype.pixelsToWorkspaceUnits_=function(t){return t=new n.utils.Coordinate(t.x/this.workspace_.scale,t.y/this.workspace_.scale),this.workspace_.isMutator&&t.scale(1/this.workspace_.options.parentWorkspace.scale),t},n.BlockDragger.prototype.dragIcons_=function(t){for(var e=0;e<this.dragIconData_.length;e++){var i=this.dragIconData_[e];i.icon.setIconLocation(n.utils.Coordinate.sum(i.location,t))}},n.BlockDragger.prototype.getInsertionMarkers=function(){return this.draggedConnectionManager_&&this.draggedConnectionManager_.getInsertionMarkers?this.draggedConnectionManager_.getInsertionMarkers():[]},n.ConnectionChecker=function(){},n.ConnectionChecker.prototype.canConnect=function(t,e,i,o){return this.canConnectWithReason(t,e,i,o)==n.Connection.CAN_CONNECT},n.ConnectionChecker.prototype.canConnectWithReason=function(t,e,i,o){var r=this.doSafetyChecks(t,e);return r!=n.Connection.CAN_CONNECT?r:this.doTypeChecks(t,e)?i&&!this.doDragChecks(t,e,o||0)?n.Connection.REASON_DRAG_CHECKS_FAILED:n.Connection.CAN_CONNECT:n.Connection.REASON_CHECKS_FAILED},n.ConnectionChecker.prototype.getErrorMessage=function(t,e,i){switch(t){case n.Connection.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case n.Connection.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case n.Connection.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case n.Connection.REASON_TARGET_NULL:return"Target connection is null.";case n.Connection.REASON_CHECKS_FAILED:return"Connection checks failed. "+e+" expected "+e.getCheck()+", found "+i.getCheck();case n.Connection.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case n.Connection.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";default:return"Unknown connection failure: this should never happen!"}},n.ConnectionChecker.prototype.doSafetyChecks=function(t,e){if(!t||!e)return n.Connection.REASON_TARGET_NULL;if(t.isSuperior())var i=t.getSourceBlock(),o=e.getSourceBlock();else o=t.getSourceBlock(),i=e.getSourceBlock();return i==o?n.Connection.REASON_SELF_CONNECTION:e.type!=n.OPPOSITE_TYPE[t.type]?n.Connection.REASON_WRONG_TYPE:i.workspace!==o.workspace?n.Connection.REASON_DIFFERENT_WORKSPACES:i.isShadow()&&!o.isShadow()?n.Connection.REASON_SHADOW_PARENT:n.Connection.CAN_CONNECT},n.ConnectionChecker.prototype.doTypeChecks=function(t,e){if(t=t.getCheck(),e=e.getCheck(),!t||!e)return!0;for(var n=0;n<t.length;n++)if(-1!=e.indexOf(t[n]))return!0;return!1},n.ConnectionChecker.prototype.doDragChecks=function(t,e,i){if(t.distanceFrom(e)>i||e.getSourceBlock().isInsertionMarker())return!1;switch(e.type){case n.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(t,e);case n.OUTPUT_VALUE:if(e.isConnected()&&!e.targetBlock().isInsertionMarker()||t.isConnected())return!1;break;case n.INPUT_VALUE:if(e.isConnected()&&!e.targetBlock().isMovable()&&!e.targetBlock().isShadow())return!1;break;case n.NEXT_STATEMENT:if(e.isConnected()&&!t.getSourceBlock().nextConnection&&!e.targetBlock().isShadow()&&e.targetBlock().nextConnection)return!1;break;default:return!1}return-1==n.draggingConnections.indexOf(e)},n.ConnectionChecker.prototype.canConnectToPrevious_=function(t,e){return!(t.targetConnection||-1!=n.draggingConnections.indexOf(e)||e.targetConnection&&(!(t=e.targetBlock()).isInsertionMarker()||t.getPreviousBlock()))},n.registry.register(n.registry.Type.CONNECTION_CHECKER,n.registry.DEFAULT,n.ConnectionChecker),n.VariableMap=function(t){this.variableMap_=Object.create(null),this.workspace=t},n.VariableMap.prototype.clear=function(){this.variableMap_=Object.create(null)},n.VariableMap.prototype.renameVariable=function(t,e){var i=this.getVariable(e,t.type),o=this.workspace.getAllBlocks(!1);n.Events.setGroup(!0);try{i&&i.getId()!=t.getId()?this.renameVariableWithConflict_(t,e,i,o):this.renameVariableAndUses_(t,e,o)}finally{n.Events.setGroup(!1)}},n.VariableMap.prototype.renameVariableById=function(t,e){var n=this.getVariableById(t);if(!n)throw Error("Tried to rename a variable that didn't exist. ID: "+t);this.renameVariable(n,e)},n.VariableMap.prototype.renameVariableAndUses_=function(t,e,i){for(n.Events.fire(new n.Events.VarRename(t,e)),t.name=e,e=0;e<i.length;e++)i[e].updateVarName(t)},n.VariableMap.prototype.renameVariableWithConflict_=function(t,e,i,o){var r=t.type;for(e!=i.name&&this.renameVariableAndUses_(i,e,o),e=0;e<o.length;e++)o[e].renameVarById(t.getId(),i.getId());n.Events.fire(new n.Events.VarDelete(t)),t=this.getVariablesOfType(r).indexOf(t),this.variableMap_[r].splice(t,1)},n.VariableMap.prototype.createVariable=function(t,e,i){var o=this.getVariable(t,e);if(o){if(i&&o.getId()!=i)throw Error('Variable "'+t+'" is already in use and its id is "'+o.getId()+'" which conflicts with the passed in id, "'+i+'".');return o}if(i&&this.getVariableById(i))throw Error('Variable id, "'+i+'", is already in use.');return o=i||n.utils.genUid(),e=e||"",o=new n.VariableModel(this.workspace,t,e,o),(t=this.variableMap_[e]||[]).push(o),delete this.variableMap_[e],this.variableMap_[e]=t,o},n.VariableMap.prototype.deleteVariable=function(t){for(var e,i=this.variableMap_[t.type],o=0;e=i[o];o++)if(e.getId()==t.getId()){i.splice(o,1),n.Events.fire(new n.Events.VarDelete(t));break}},n.VariableMap.prototype.deleteVariableById=function(t){var e=this.getVariableById(t);if(e){var i,o=e.name,r=this.getVariableUsesById(t);for(t=0;i=r[t];t++)if("procedures_defnoreturn"==i.type||"procedures_defreturn"==i.type)return t=i.getFieldValue("NAME"),o=n.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",o).replace("%2",t),void n.alert(o);var s=this;1<r.length?(o=n.Msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(r.length)).replace("%2",o),n.confirm(o,(function(t){t&&e&&s.deleteVariableInternal(e,r)}))):s.deleteVariableInternal(e,r)}else console.warn("Can't delete non-existent variable: "+t)},n.VariableMap.prototype.deleteVariableInternal=function(t,e){var i=n.Events.getGroup();i||n.Events.setGroup(!0);try{for(var o=0;o<e.length;o++)e[o].dispose(!0);this.deleteVariable(t)}finally{i||n.Events.setGroup(!1)}},n.VariableMap.prototype.getVariable=function(t,e){if(e=this.variableMap_[e||""])for(var i,o=0;i=e[o];o++)if(n.Names.equals(i.name,t))return i;return null},n.VariableMap.prototype.getVariableById=function(t){for(var e=Object.keys(this.variableMap_),n=0;n<e.length;n++)for(var i,o=e[n],r=0;i=this.variableMap_[o][r];r++)if(i.getId()==t)return i;return null},n.VariableMap.prototype.getVariablesOfType=function(t){return(t=this.variableMap_[t||""])?t.slice():[]},n.VariableMap.prototype.getVariableTypes=function(t){var e={};n.utils.object.mixin(e,this.variableMap_),t&&t.getPotentialVariableMap()&&n.utils.object.mixin(e,t.getPotentialVariableMap().variableMap_),t=Object.keys(e),e=!1;for(var i=0;i<t.length;i++)""==t[i]&&(e=!0);return e||t.push(""),t},n.VariableMap.prototype.getAllVariables=function(){var t,e=[];for(t in this.variableMap_)e=e.concat(this.variableMap_[t]);return e},n.VariableMap.prototype.getAllVariableNames=function(){var t,e=[];for(t in this.variableMap_)for(var n,i=this.variableMap_[t],o=0;n=i[o];o++)e.push(n.name);return e},n.VariableMap.prototype.getVariableUsesById=function(t){for(var e=[],n=this.workspace.getAllBlocks(!1),i=0;i<n.length;i++){var o=n[i].getVarModels();if(o)for(var r=0;r<o.length;r++)o[r].getId()==t&&e.push(n[i])}return e},n.Workspace=function(t){this.id=n.utils.genUid(),n.Workspace.WorkspaceDB_[this.id]=this,this.options=t||new n.Options({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new(n.registry.getClassFromOptions(n.registry.Type.CONNECTION_CHECKER,this.options))(this),this.topBlocks_=[],this.topComments_=[],this.commentDB_=Object.create(null),this.listeners_=[],this.undoStack_=[],this.redoStack_=[],this.blockDB_=Object.create(null),this.typedBlocksDB_=Object.create(null),this.variableMap_=new n.VariableMap(this),this.potentialVariableMap_=null},n.Workspace.prototype.rendered=!1,n.Workspace.prototype.isClearing=!1,n.Workspace.prototype.MAX_UNDO=1024,n.Workspace.prototype.connectionDBList=null,n.Workspace.prototype.dispose=function(){this.listeners_.length=0,this.clear(),delete n.Workspace.WorkspaceDB_[this.id]},n.Workspace.SCAN_ANGLE=3,n.Workspace.prototype.sortObjects_=function(t,e){return t=t.getRelativeToSurfaceXY(),e=e.getRelativeToSurfaceXY(),t.y+n.Workspace.prototype.sortObjects_.offset*t.x-(e.y+n.Workspace.prototype.sortObjects_.offset*e.x)},n.Workspace.prototype.addTopBlock=function(t){this.topBlocks_.push(t)},n.Workspace.prototype.removeTopBlock=function(t){if(!n.utils.arrayRemove(this.topBlocks_,t))throw Error("Block not present in workspace's list of top-most blocks.")},n.Workspace.prototype.getTopBlocks=function(t){var e=[].concat(this.topBlocks_);return t&&1<e.length&&(this.sortObjects_.offset=Math.sin(n.utils.math.toRadians(n.Workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),e.sort(this.sortObjects_)),e},n.Workspace.prototype.addTypedBlock=function(t){this.typedBlocksDB_[t.type]||(this.typedBlocksDB_[t.type]=[]),this.typedBlocksDB_[t.type].push(t)},n.Workspace.prototype.removeTypedBlock=function(t){this.typedBlocksDB_[t.type].splice(this.typedBlocksDB_[t.type].indexOf(t),1),this.typedBlocksDB_[t.type].length||delete this.typedBlocksDB_[t.type]},n.Workspace.prototype.getBlocksByType=function(t,e){return this.typedBlocksDB_[t]?(t=this.typedBlocksDB_[t].slice(0),e&&1<t.length&&(this.sortObjects_.offset=Math.sin(n.utils.math.toRadians(n.Workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),t.sort(this.sortObjects_)),t):[]},n.Workspace.prototype.addTopComment=function(t){this.topComments_.push(t),this.commentDB_[t.id]&&console.warn('Overriding an existing comment on this workspace, with id "'+t.id+'"'),this.commentDB_[t.id]=t},n.Workspace.prototype.removeTopComment=function(t){if(!n.utils.arrayRemove(this.topComments_,t))throw Error("Comment not present in workspace's list of top-most comments.");delete this.commentDB_[t.id]},n.Workspace.prototype.getTopComments=function(t){var e=[].concat(this.topComments_);return t&&1<e.length&&(this.sortObjects_.offset=Math.sin(n.utils.math.toRadians(n.Workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),e.sort(this.sortObjects_)),e},n.Workspace.prototype.getAllBlocks=function(t){if(t){t=this.getTopBlocks(!0);for(var e=[],n=0;n<t.length;n++)e.push.apply(e,t[n].getDescendants(!0))}else for(e=this.getTopBlocks(!1),n=0;n<e.length;n++)e.push.apply(e,e[n].getChildren(!1));return e.filter((function(t){return!t.isInsertionMarker()}))},n.Workspace.prototype.clear=function(){this.isClearing=!0;try{var t=n.Events.getGroup();for(t||n.Events.setGroup(!0);this.topBlocks_.length;)this.topBlocks_[0].dispose(!1);for(;this.topComments_.length;)this.topComments_[this.topComments_.length-1].dispose(!1);t||n.Events.setGroup(!1),this.variableMap_.clear(),this.potentialVariableMap_&&this.potentialVariableMap_.clear()}finally{this.isClearing=!1}},n.Workspace.prototype.renameVariableById=function(t,e){this.variableMap_.renameVariableById(t,e)},n.Workspace.prototype.createVariable=function(t,e,n){return this.variableMap_.createVariable(t,e,n)},n.Workspace.prototype.getVariableUsesById=function(t){return this.variableMap_.getVariableUsesById(t)},n.Workspace.prototype.deleteVariableById=function(t){this.variableMap_.deleteVariableById(t)},n.Workspace.prototype.getVariable=function(t,e){return this.variableMap_.getVariable(t,e)},n.Workspace.prototype.getVariableById=function(t){return this.variableMap_.getVariableById(t)},n.Workspace.prototype.getVariablesOfType=function(t){return this.variableMap_.getVariablesOfType(t)},n.Workspace.prototype.getVariableTypes=function(){return this.variableMap_.getVariableTypes(this)},n.Workspace.prototype.getAllVariables=function(){return this.variableMap_.getAllVariables()},n.Workspace.prototype.getAllVariableNames=function(){return this.variableMap_.getAllVariableNames()},n.Workspace.prototype.getWidth=function(){return 0},n.Workspace.prototype.newBlock=function(t,e){return new n.Block(this,t,e)},n.Workspace.prototype.remainingCapacity=function(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(!1).length},n.Workspace.prototype.remainingCapacityOfType=function(t){return this.options.maxInstances?(void 0!==this.options.maxInstances[t]?this.options.maxInstances[t]:1/0)-this.getBlocksByType(t,!1).length:1/0},n.Workspace.prototype.isCapacityAvailable=function(t){if(!this.hasBlockLimits())return!0;var e,n=0;for(e in t){if(t[e]>this.remainingCapacityOfType(e))return!1;n+=t[e]}return!(n>this.remainingCapacity())},n.Workspace.prototype.hasBlockLimits=function(){return 1/0!=this.options.maxBlocks||!!this.options.maxInstances},n.Workspace.prototype.getUndoStack=function(){return this.undoStack_},n.Workspace.prototype.getRedoStack=function(){return this.redoStack_},n.Workspace.prototype.undo=function(t){var e=t?this.redoStack_:this.undoStack_,i=t?this.undoStack_:this.redoStack_,o=e.pop();if(o){for(var r=[o];e.length&&o.group&&o.group==e[e.length-1].group;)r.push(e.pop());for(e=0;o=r[e];e++)i.push(o);r=n.Events.filter(r,t),n.Events.recordUndo=!1;try{for(e=0;o=r[e];e++)o.run(t)}finally{n.Events.recordUndo=!0}}},n.Workspace.prototype.clearUndo=function(){this.undoStack_.length=0,this.redoStack_.length=0,n.Events.clearPendingUndo()},n.Workspace.prototype.addChangeListener=function(t){return this.listeners_.push(t),t},n.Workspace.prototype.removeChangeListener=function(t){n.utils.arrayRemove(this.listeners_,t)},n.Workspace.prototype.fireChangeListener=function(t){if(t.recordUndo)for(this.undoStack_.push(t),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&0<=this.MAX_UNDO;)this.undoStack_.shift();for(var e,n=0;e=this.listeners_[n];n++)e(t)},n.Workspace.prototype.getBlockById=function(t){return this.blockDB_[t]||null},n.Workspace.prototype.setBlockById=function(t,e){this.blockDB_[t]=e},n.Workspace.prototype.removeBlockById=function(t){delete this.blockDB_[t]},n.Workspace.prototype.getCommentById=function(t){return this.commentDB_[t]||null},n.Workspace.prototype.allInputsFilled=function(t){for(var e,n=this.getTopBlocks(!1),i=0;e=n[i];i++)if(!e.allInputsFilled(t))return!1;return!0},n.Workspace.prototype.getPotentialVariableMap=function(){return this.potentialVariableMap_},n.Workspace.prototype.createPotentialVariableMap=function(){this.potentialVariableMap_=new n.VariableMap(this)},n.Workspace.prototype.getVariableMap=function(){return this.variableMap_},n.Workspace.prototype.setVariableMap=function(t){this.variableMap_=t},n.Workspace.WorkspaceDB_=Object.create(null),n.Workspace.getById=function(t){return n.Workspace.WorkspaceDB_[t]||null},n.Workspace.getAll=function(){var t,e=[];for(t in n.Workspace.WorkspaceDB_)e.push(n.Workspace.WorkspaceDB_[t]);return e},n.Bubble=function(t,e,i,o,r,s){this.workspace_=t,this.content_=e,this.shape_=i,this.onMouseDownResizeWrapper_=this.onMouseDownBubbleWrapper_=this.moveCallback_=this.resizeCallback_=null,this.disposed=!1,i=n.Bubble.ARROW_ANGLE,this.workspace_.RTL&&(i=-i),this.arrow_radians_=n.utils.math.toRadians(i),t.getBubbleCanvas().appendChild(this.createDom_(e,!(!r||!s))),this.setAnchorLocation(o),r&&s||(r=(t=this.content_.getBBox()).width+2*n.Bubble.BORDER_WIDTH,s=t.height+2*n.Bubble.BORDER_WIDTH),this.setBubbleSize(r,s),this.positionBubble_(),this.renderArrow_(),this.rendered_=!0},n.Bubble.BORDER_WIDTH=6,n.Bubble.ARROW_THICKNESS=5,n.Bubble.ARROW_ANGLE=20,n.Bubble.ARROW_BEND=4,n.Bubble.ANCHOR_RADIUS=8,n.Bubble.onMouseUpWrapper_=null,n.Bubble.onMouseMoveWrapper_=null,n.Bubble.unbindDragEvents_=function(){n.Bubble.onMouseUpWrapper_&&(n.unbindEvent_(n.Bubble.onMouseUpWrapper_),n.Bubble.onMouseUpWrapper_=null),n.Bubble.onMouseMoveWrapper_&&(n.unbindEvent_(n.Bubble.onMouseMoveWrapper_),n.Bubble.onMouseMoveWrapper_=null)},n.Bubble.bubbleMouseUp_=function(t){n.Touch.clearTouchIdentifier(),n.Bubble.unbindDragEvents_()},n.Bubble.prototype.rendered_=!1,n.Bubble.prototype.anchorXY_=null,n.Bubble.prototype.relativeLeft_=0,n.Bubble.prototype.relativeTop_=0,n.Bubble.prototype.width_=0,n.Bubble.prototype.height_=0,n.Bubble.prototype.autoLayout_=!0,n.Bubble.prototype.createDom_=function(t,e){this.bubbleGroup_=n.utils.dom.createSvgElement(n.utils.Svg.G,{},null);var i={filter:"url(#"+this.workspace_.getRenderer().getConstants().embossFilterId+")"};return n.utils.userAgent.JAVA_FX&&(i={}),i=n.utils.dom.createSvgElement(n.utils.Svg.G,i,this.bubbleGroup_),this.bubbleArrow_=n.utils.dom.createSvgElement(n.utils.Svg.PATH,{},i),this.bubbleBack_=n.utils.dom.createSvgElement(n.utils.Svg.RECT,{class:"blocklyDraggable",x:0,y:0,rx:n.Bubble.BORDER_WIDTH,ry:n.Bubble.BORDER_WIDTH},i),e?(this.resizeGroup_=n.utils.dom.createSvgElement(n.utils.Svg.G,{class:this.workspace_.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.bubbleGroup_),e=2*n.Bubble.BORDER_WIDTH,n.utils.dom.createSvgElement(n.utils.Svg.POLYGON,{points:"0,x x,x x,0".replace(/x/g,e.toString())},this.resizeGroup_),n.utils.dom.createSvgElement(n.utils.Svg.LINE,{class:"blocklyResizeLine",x1:e/3,y1:e-1,x2:e-1,y2:e/3},this.resizeGroup_),n.utils.dom.createSvgElement(n.utils.Svg.LINE,{class:"blocklyResizeLine",x1:2*e/3,y1:e-1,x2:e-1,y2:2*e/3},this.resizeGroup_)):this.resizeGroup_=null,this.workspace_.options.readOnly||(this.onMouseDownBubbleWrapper_=n.bindEventWithChecks_(this.bubbleBack_,"mousedown",this,this.bubbleMouseDown_),this.resizeGroup_&&(this.onMouseDownResizeWrapper_=n.bindEventWithChecks_(this.resizeGroup_,"mousedown",this,this.resizeMouseDown_))),this.bubbleGroup_.appendChild(t),this.bubbleGroup_},n.Bubble.prototype.getSvgRoot=function(){return this.bubbleGroup_},n.Bubble.prototype.setSvgId=function(t){this.bubbleGroup_.dataset&&(this.bubbleGroup_.dataset.blockId=t)},n.Bubble.prototype.bubbleMouseDown_=function(t){var e=this.workspace_.getGesture(t);e&&e.handleBubbleStart(t,this)},n.Bubble.prototype.showContextMenu=function(t){},n.Bubble.prototype.isDeletable=function(){return!1},n.Bubble.prototype.setDeleteStyle=function(t){},n.Bubble.prototype.resizeMouseDown_=function(t){this.promote(),n.Bubble.unbindDragEvents_(),n.utils.isRightButton(t)||(this.workspace_.startDrag(t,new n.utils.Coordinate(this.workspace_.RTL?-this.width_:this.width_,this.height_)),n.Bubble.onMouseUpWrapper_=n.bindEventWithChecks_(document,"mouseup",this,n.Bubble.bubbleMouseUp_),n.Bubble.onMouseMoveWrapper_=n.bindEventWithChecks_(document,"mousemove",this,this.resizeMouseMove_),n.hideChaff()),t.stopPropagation()},n.Bubble.prototype.resizeMouseMove_=function(t){this.autoLayout_=!1,t=this.workspace_.moveDrag(t),this.setBubbleSize(this.workspace_.RTL?-t.x:t.x,t.y),this.workspace_.RTL&&this.positionBubble_()},n.Bubble.prototype.registerResizeEvent=function(t){this.resizeCallback_=t},n.Bubble.prototype.registerMoveEvent=function(t){this.moveCallback_=t},n.Bubble.prototype.promote=function(){var t=this.bubbleGroup_.parentNode;return t.lastChild!==this.bubbleGroup_&&(t.appendChild(this.bubbleGroup_),!0)},n.Bubble.prototype.setAnchorLocation=function(t){this.anchorXY_=t,this.rendered_&&this.positionBubble_()},n.Bubble.prototype.layoutBubble_=function(){var t=this.workspace_.getMetrics();t.viewLeft/=this.workspace_.scale,t.viewWidth/=this.workspace_.scale,t.viewTop/=this.workspace_.scale,t.viewHeight/=this.workspace_.scale;var e=this.getOptimalRelativeLeft_(t),n=this.getOptimalRelativeTop_(t),i=this.shape_.getBBox(),o={x:e,y:-this.height_-this.workspace_.getRenderer().getConstants().MIN_BLOCK_HEIGHT},r={x:-this.width_-30,y:n};n={x:i.width,y:n};var s={x:e,y:i.height};e=i.width<i.height?n:s,i=i.width<i.height?s:n,n=this.getOverlap_(o,t),s=this.getOverlap_(r,t);var a=this.getOverlap_(e,t);t=this.getOverlap_(i,t),n==(t=Math.max(n,s,a,t))?(this.relativeLeft_=o.x,this.relativeTop_=o.y):s==t?(this.relativeLeft_=r.x,this.relativeTop_=r.y):a==t?(this.relativeLeft_=e.x,this.relativeTop_=e.y):(this.relativeLeft_=i.x,this.relativeTop_=i.y)},n.Bubble.prototype.getOverlap_=function(t,e){var n=this.workspace_.RTL?this.anchorXY_.x-t.x-this.width_:t.x+this.anchorXY_.x;return t=t.y+this.anchorXY_.y,Math.max(0,Math.min(1,(Math.min(n+this.width_,e.viewLeft+e.viewWidth)-Math.max(n,e.viewLeft))*(Math.min(t+this.height_,e.viewTop+e.viewHeight)-Math.max(t,e.viewTop))/(this.width_*this.height_)))},n.Bubble.prototype.getOptimalRelativeLeft_=function(t){var e=-this.width_/4;if(this.width_>t.viewWidth)return e;if(this.workspace_.RTL)var i=this.anchorXY_.x-e,o=i-this.width_,r=t.viewLeft+t.viewWidth,s=t.viewLeft+n.Scrollbar.scrollbarThickness/this.workspace_.scale;else i=(o=e+this.anchorXY_.x)+this.width_,s=t.viewLeft,r=t.viewLeft+t.viewWidth-n.Scrollbar.scrollbarThickness/this.workspace_.scale;return this.workspace_.RTL?o<s?e=-(s-this.anchorXY_.x+this.width_):i>r&&(e=-(r-this.anchorXY_.x)):o<s?e=s-this.anchorXY_.x:i>r&&(e=r-this.anchorXY_.x-this.width_),e},n.Bubble.prototype.getOptimalRelativeTop_=function(t){var e=-this.height_/4;if(this.height_>t.viewHeight)return e;var i=this.anchorXY_.y+e,o=i+this.height_,r=t.viewTop;t=t.viewTop+t.viewHeight-n.Scrollbar.scrollbarThickness/this.workspace_.scale;var s=this.anchorXY_.y;return i<r?e=r-s:o>t&&(e=t-s-this.height_),e},n.Bubble.prototype.positionBubble_=function(){var t=this.anchorXY_.x;t=this.workspace_.RTL?t-(this.relativeLeft_+this.width_):t+this.relativeLeft_,this.moveTo(t,this.relativeTop_+this.anchorXY_.y)},n.Bubble.prototype.moveTo=function(t,e){this.bubbleGroup_.setAttribute("transform","translate("+t+","+e+")")},n.Bubble.prototype.setDragging=function(t){!t&&this.moveCallback_&&this.moveCallback_()},n.Bubble.prototype.getBubbleSize=function(){return new n.utils.Size(this.width_,this.height_)},n.Bubble.prototype.setBubbleSize=function(t,e){var i=2*n.Bubble.BORDER_WIDTH;t=Math.max(t,i+45),e=Math.max(e,i+20),this.width_=t,this.height_=e,this.bubbleBack_.setAttribute("width",t),this.bubbleBack_.setAttribute("height",e),this.resizeGroup_&&(this.workspace_.RTL?this.resizeGroup_.setAttribute("transform","translate("+2*n.Bubble.BORDER_WIDTH+","+(e-i)+") scale(-1 1)"):this.resizeGroup_.setAttribute("transform","translate("+(t-i)+","+(e-i)+")")),this.autoLayout_&&this.layoutBubble_(),this.positionBubble_(),this.renderArrow_(),this.resizeCallback_&&this.resizeCallback_()},n.Bubble.prototype.renderArrow_=function(){var t=[],e=this.width_/2,i=this.height_/2,o=-this.relativeLeft_,r=-this.relativeTop_;if(e==o&&i==r)t.push("M "+e+","+i);else{r-=i,o-=e,this.workspace_.RTL&&(o*=-1);var s=Math.sqrt(r*r+o*o),a=Math.acos(o/s);0>r&&(a=2*Math.PI-a);var l=a+Math.PI/2;l>2*Math.PI&&(l-=2*Math.PI);var c=Math.sin(l),d=Math.cos(l),u=this.getBubbleSize();l=(u.width+u.height)/n.Bubble.ARROW_THICKNESS,l=Math.min(l,u.width,u.height)/4,o=e+(u=1-n.Bubble.ANCHOR_RADIUS/s)*o,r=i+u*r,u=e+l*d;var h=i+l*c;e-=l*d,i-=l*c,(c=a+this.arrow_radians_)>2*Math.PI&&(c-=2*Math.PI),a=Math.sin(c)*s/n.Bubble.ARROW_BEND,s=Math.cos(c)*s/n.Bubble.ARROW_BEND,t.push("M"+u+","+h),t.push("C"+(u+s)+","+(h+a)+" "+o+","+r+" "+o+","+r),t.push("C"+o+","+r+" "+(e+s)+","+(i+a)+" "+e+","+i)}t.push("z"),this.bubbleArrow_.setAttribute("d",t.join(" "))},n.Bubble.prototype.setColour=function(t){this.bubbleBack_.setAttribute("fill",t),this.bubbleArrow_.setAttribute("fill",t)},n.Bubble.prototype.dispose=function(){this.onMouseDownBubbleWrapper_&&n.unbindEvent_(this.onMouseDownBubbleWrapper_),this.onMouseDownResizeWrapper_&&n.unbindEvent_(this.onMouseDownResizeWrapper_),n.Bubble.unbindDragEvents_(),n.utils.dom.removeNode(this.bubbleGroup_),this.disposed=!0},n.Bubble.prototype.moveDuringDrag=function(t,e){t?t.translateSurface(e.x,e.y):this.moveTo(e.x,e.y),this.relativeLeft_=this.workspace_.RTL?this.anchorXY_.x-e.x-this.width_:e.x-this.anchorXY_.x,this.relativeTop_=e.y-this.anchorXY_.y,this.renderArrow_()},n.Bubble.prototype.getRelativeToSurfaceXY=function(){return new n.utils.Coordinate(this.workspace_.RTL?-this.relativeLeft_+this.anchorXY_.x-this.width_:this.anchorXY_.x+this.relativeLeft_,this.anchorXY_.y+this.relativeTop_)},n.Bubble.prototype.setAutoLayout=function(t){this.autoLayout_=t},n.Bubble.textToDom=function(t){var e=n.utils.dom.createSvgElement(n.utils.Svg.TEXT,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",y:n.Bubble.BORDER_WIDTH},null);t=t.split("\n");for(var i=0;i<t.length;i++){var o=n.utils.dom.createSvgElement(n.utils.Svg.TSPAN,{dy:"1em",x:n.Bubble.BORDER_WIDTH},e),r=document.createTextNode(t[i]);o.appendChild(r)}return e},n.Bubble.createNonEditableBubble=function(t,e,i){if((i=new n.Bubble(e.workspace,t,e.pathObject.svgPath,i,null,null)).setSvgId(e.id),e.RTL){e=t.getBBox().width;for(var o,r=0;o=t.childNodes[r];r++)o.setAttribute("text-anchor","end"),o.setAttribute("x",e+n.Bubble.BORDER_WIDTH)}return i},n.Events.CommentBase=function(t){this.commentId=(this.isBlank=void 0===t)?"":t.id,this.workspaceId=this.isBlank?"":t.workspace.id,this.group=n.Events.getGroup(),this.recordUndo=n.Events.recordUndo},n.utils.object.inherits(n.Events.CommentBase,n.Events.Abstract),n.Events.CommentBase.prototype.toJson=function(){var t=n.Events.CommentBase.superClass_.toJson.call(this);return this.commentId&&(t.commentId=this.commentId),t},n.Events.CommentBase.prototype.fromJson=function(t){n.Events.CommentBase.superClass_.fromJson.call(this,t),this.commentId=t.commentId},n.Events.CommentChange=function(t,e,i){n.Events.CommentChange.superClass_.constructor.call(this,t),t&&(this.oldContents_=void 0===e?"":e,this.newContents_=void 0===i?"":i)},n.utils.object.inherits(n.Events.CommentChange,n.Events.CommentBase),n.Events.CommentChange.prototype.type=n.Events.COMMENT_CHANGE,n.Events.CommentChange.prototype.toJson=function(){var t=n.Events.CommentChange.superClass_.toJson.call(this);return t.newContents=this.newContents_,t},n.Events.CommentChange.prototype.fromJson=function(t){n.Events.CommentChange.superClass_.fromJson.call(this,t),this.newContents_=t.newValue},n.Events.CommentChange.prototype.isNull=function(){return this.oldContents_==this.newContents_},n.Events.CommentChange.prototype.run=function(t){var e=this.getEventWorkspace_().getCommentById(this.commentId);e?e.setContent(t?this.newContents_:this.oldContents_):console.warn("Can't change non-existent comment: "+this.commentId)},n.Events.CommentCreate=function(t){n.Events.CommentCreate.superClass_.constructor.call(this,t),t&&(this.xml=t.toXmlWithXY())},n.utils.object.inherits(n.Events.CommentCreate,n.Events.CommentBase),n.Events.CommentCreate.prototype.type=n.Events.COMMENT_CREATE,n.Events.CommentCreate.prototype.toJson=function(){var t=n.Events.CommentCreate.superClass_.toJson.call(this);return t.xml=n.Xml.domToText(this.xml),t},n.Events.CommentCreate.prototype.fromJson=function(t){n.Events.CommentCreate.superClass_.fromJson.call(this,t),this.xml=n.Xml.textToDom(t.xml)},n.Events.CommentCreate.prototype.run=function(t){n.Events.CommentCreateDeleteHelper(this,t)},n.Events.CommentCreateDeleteHelper=function(t,e){var i=t.getEventWorkspace_();e?((e=n.utils.xml.createElement("xml")).appendChild(t.xml),n.Xml.domToWorkspace(e,i)):(i=i.getCommentById(t.commentId))?i.dispose(!1,!1):console.warn("Can't uncreate non-existent comment: "+t.commentId)},n.Events.CommentDelete=function(t){n.Events.CommentDelete.superClass_.constructor.call(this,t),t&&(this.xml=t.toXmlWithXY())},n.utils.object.inherits(n.Events.CommentDelete,n.Events.CommentBase),n.Events.CommentDelete.prototype.type=n.Events.COMMENT_DELETE,n.Events.CommentDelete.prototype.toJson=function(){return n.Events.CommentDelete.superClass_.toJson.call(this)},n.Events.CommentDelete.prototype.fromJson=function(t){n.Events.CommentDelete.superClass_.fromJson.call(this,t)},n.Events.CommentDelete.prototype.run=function(t){n.Events.CommentCreateDeleteHelper(this,!t)},n.Events.CommentMove=function(t){n.Events.CommentMove.superClass_.constructor.call(this,t),t&&(this.comment_=t,this.oldCoordinate_=t.getXY(),this.newCoordinate_=null)},n.utils.object.inherits(n.Events.CommentMove,n.Events.CommentBase),n.Events.CommentMove.prototype.recordNew=function(){if(!this.comment_)throw Error("Tried to record the new position of a comment on the same event twice.");this.newCoordinate_=this.comment_.getXY(),this.comment_=null},n.Events.CommentMove.prototype.type=n.Events.COMMENT_MOVE,n.Events.CommentMove.prototype.setOldCoordinate=function(t){this.oldCoordinate_=t},n.Events.CommentMove.prototype.toJson=function(){var t=n.Events.CommentMove.superClass_.toJson.call(this);return this.newCoordinate_&&(t.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y)),t},n.Events.CommentMove.prototype.fromJson=function(t){n.Events.CommentMove.superClass_.fromJson.call(this,t),t.newCoordinate&&(t=t.newCoordinate.split(","),this.newCoordinate_=new n.utils.Coordinate(Number(t[0]),Number(t[1])))},n.Events.CommentMove.prototype.isNull=function(){return n.utils.Coordinate.equals(this.oldCoordinate_,this.newCoordinate_)},n.Events.CommentMove.prototype.run=function(t){var e=this.getEventWorkspace_().getCommentById(this.commentId);if(e){t=t?this.newCoordinate_:this.oldCoordinate_;var n=e.getXY();e.moveBy(t.x-n.x,t.y-n.y)}else console.warn("Can't move non-existent comment: "+this.commentId)},n.registry.register(n.registry.Type.EVENT,n.Events.COMMENT_CREATE,n.Events.CommentCreate),n.registry.register(n.registry.Type.EVENT,n.Events.COMMENT_CHANGE,n.Events.CommentChange),n.registry.register(n.registry.Type.EVENT,n.Events.COMMENT_MOVE,n.Events.CommentMove),n.registry.register(n.registry.Type.EVENT,n.Events.COMMENT_DELETE,n.Events.CommentDelete),n.BubbleDragger=function(t,e){this.draggingBubble_=t,this.workspace_=e,this.deleteArea_=null,this.wouldDeleteBubble_=!1,this.startXY_=this.draggingBubble_.getRelativeToSurfaceXY(),this.dragSurface_=n.utils.is3dSupported()&&e.getBlockDragSurface()?e.getBlockDragSurface():null},n.BubbleDragger.prototype.dispose=function(){this.dragSurface_=this.workspace_=this.draggingBubble_=null},n.BubbleDragger.prototype.startBubbleDrag=function(){n.Events.getGroup()||n.Events.setGroup(!0),this.workspace_.setResizesEnabled(!1),this.draggingBubble_.setAutoLayout(!1),this.dragSurface_&&this.moveToDragSurface_(),this.draggingBubble_.setDragging&&this.draggingBubble_.setDragging(!0);var t=this.workspace_.getToolbox();if(t&&"function"==typeof t.addStyle){var e=this.draggingBubble_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab";t.addStyle(e)}},n.BubbleDragger.prototype.dragBubble=function(t,e){e=this.pixelsToWorkspaceUnits_(e),e=n.utils.Coordinate.sum(this.startXY_,e),this.draggingBubble_.moveDuringDrag(this.dragSurface_,e),this.draggingBubble_.isDeletable()&&(this.deleteArea_=this.workspace_.isDeleteArea(t),this.updateCursorDuringBubbleDrag_())},n.BubbleDragger.prototype.maybeDeleteBubble_=function(){var t=this.workspace_.trashcan;return this.wouldDeleteBubble_?(t&&setTimeout(t.closeLid.bind(t),100),this.fireMoveEvent_(),this.draggingBubble_.dispose(!1,!0)):t&&t.closeLid(),this.wouldDeleteBubble_},n.BubbleDragger.prototype.updateCursorDuringBubbleDrag_=function(){this.wouldDeleteBubble_=this.deleteArea_!=n.DELETE_AREA_NONE;var t=this.workspace_.trashcan;this.wouldDeleteBubble_?(this.draggingBubble_.setDeleteStyle(!0),this.deleteArea_==n.DELETE_AREA_TRASH&&t&&t.setLidOpen(!0)):(this.draggingBubble_.setDeleteStyle(!1),t&&t.setLidOpen(!1))},n.BubbleDragger.prototype.endBubbleDrag=function(t,e){this.dragBubble(t,e),t=this.pixelsToWorkspaceUnits_(e),t=n.utils.Coordinate.sum(this.startXY_,t),this.draggingBubble_.moveTo(t.x,t.y),this.maybeDeleteBubble_()||(this.dragSurface_&&this.dragSurface_.clearAndHide(this.workspace_.getBubbleCanvas()),this.draggingBubble_.setDragging&&this.draggingBubble_.setDragging(!1),this.fireMoveEvent_()),this.workspace_.setResizesEnabled(!0),(t=this.workspace_.getToolbox())&&"function"==typeof t.removeStyle&&(e=this.draggingBubble_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab",t.removeStyle(e)),n.Events.setGroup(!1)},n.BubbleDragger.prototype.fireMoveEvent_=function(){if(this.draggingBubble_.isComment){var t=new n.Events.CommentMove(this.draggingBubble_);t.setOldCoordinate(this.startXY_),t.recordNew(),n.Events.fire(t)}},n.BubbleDragger.prototype.pixelsToWorkspaceUnits_=function(t){return t=new n.utils.Coordinate(t.x/this.workspace_.scale,t.y/this.workspace_.scale),this.workspace_.isMutator&&t.scale(1/this.workspace_.options.parentWorkspace.scale),t},n.BubbleDragger.prototype.moveToDragSurface_=function(){this.draggingBubble_.moveTo(0,0),this.dragSurface_.translateSurface(this.startXY_.x,this.startXY_.y),this.dragSurface_.setBlocksAndShow(this.draggingBubble_.getSvgRoot())},n.Events.Click=function(t,e,i){n.Events.Click.superClass_.constructor.call(this,t?t.workspace.id:e),this.blockId=t?t.id:null,this.targetType=i},n.utils.object.inherits(n.Events.Click,n.Events.UiBase),n.Events.Click.prototype.type=n.Events.CLICK,n.Events.Click.prototype.toJson=function(){var t=n.Events.Click.superClass_.toJson.call(this);return t.targetType=this.targetType,this.blockId&&(t.blockId=this.blockId),t},n.Events.Click.prototype.fromJson=function(t){n.Events.Click.superClass_.fromJson.call(this,t),this.targetType=t.targetType,this.blockId=t.blockId},n.registry.register(n.registry.Type.EVENT,n.Events.CLICK,n.Events.Click),n.WorkspaceDragger=function(t){this.workspace_=t,this.startScrollXY_=new n.utils.Coordinate(t.scrollX,t.scrollY)},n.WorkspaceDragger.prototype.dispose=function(){this.workspace_=null},n.WorkspaceDragger.prototype.startDrag=function(){n.selected&&n.selected.unselect(),this.workspace_.setupDragSurface()},n.WorkspaceDragger.prototype.endDrag=function(t){this.drag(t),this.workspace_.resetDragSurface()},n.WorkspaceDragger.prototype.drag=function(t){t=n.utils.Coordinate.sum(this.startScrollXY_,t),this.workspace_.scroll(t.x,t.y)},n.FlyoutDragger=function(t){n.FlyoutDragger.superClass_.constructor.call(this,t.getWorkspace()),this.scrollbar_=t.scrollbar,this.horizontalLayout_=t.horizontalLayout},n.utils.object.inherits(n.FlyoutDragger,n.WorkspaceDragger),n.FlyoutDragger.prototype.drag=function(t){t=n.utils.Coordinate.sum(this.startScrollXY_,t),this.horizontalLayout_?this.scrollbar_.set(-t.x):this.scrollbar_.set(-t.y)},n.navigation={},n.navigation.loggingCallback=null,n.navigation.STATE_FLYOUT=1,n.navigation.STATE_WS=2,n.navigation.STATE_TOOLBOX=3,n.navigation.WS_MOVE_DISTANCE=40,n.navigation.currentState_=n.navigation.STATE_WS,n.navigation.actionNames={PREVIOUS:"previous",NEXT:"next",IN:"in",OUT:"out",INSERT:"insert",MARK:"mark",DISCONNECT:"disconnect",TOOLBOX:"toolbox",EXIT:"exit",TOGGLE_KEYBOARD_NAV:"toggle_keyboard_nav",MOVE_WS_CURSOR_UP:"move workspace cursor up",MOVE_WS_CURSOR_DOWN:"move workspace cursor down",MOVE_WS_CURSOR_LEFT:"move workspace cursor left",MOVE_WS_CURSOR_RIGHT:"move workspace cursor right"},n.navigation.MARKER_NAME="local_marker_1",n.navigation.getMarker=function(){return n.navigation.getNavigationWorkspace().getMarker(n.navigation.MARKER_NAME)},n.navigation.getNavigationWorkspace=function(){return n.getMainWorkspace()},n.navigation.focusToolbox_=function(t){(t=t.getToolbox())&&(n.navigation.currentState_=n.navigation.STATE_TOOLBOX,n.navigation.resetFlyout_(!1),n.navigation.getMarker().getCurNode()||n.navigation.markAtCursor_(),t.getSelectedItem()||t.selectItemByPosition(0))},n.navigation.focusFlyout_=function(t){n.navigation.currentState_=n.navigation.STATE_FLYOUT;var e=t.getToolbox();t=e?e.getFlyout():t.getFlyout(),n.navigation.getMarker().getCurNode()||n.navigation.markAtCursor_(),t&&t.getWorkspace()&&0<(t=t.getWorkspace().getTopBlocks(!0)).length&&(t=t[0],t=n.ASTNode.createStackNode(t),n.navigation.getFlyoutCursor_().setCurNode(t))},n.navigation.focusWorkspace_=function(t){n.hideChaff();var e=t.getCursor(),i=!!t.getToolbox(),o=t.getTopBlocks(!0);n.navigation.resetFlyout_(i),n.navigation.currentState_=n.navigation.STATE_WS,0<o.length?e.setCurNode(n.ASTNode.createTopNode(o[0])):(i=new n.utils.Coordinate(100,100),t=n.ASTNode.createWorkspaceNode(t,i),e.setCurNode(t))},n.navigation.getFlyoutCursor_=function(){var t=n.navigation.getNavigationWorkspace(),e=null;return t.rendered&&(e=(t=(e=t.getToolbox())?e.getFlyout():t.getFlyout())?t.getWorkspace().getCursor():null),e},n.navigation.insertFromFlyout=function(t){var e=t.getFlyout();if(e&&e.isVisible()){var i=n.navigation.getFlyoutCursor_().getCurNode().getLocation();i.isEnabled()?((e=e.createBlock(i)).render(),e.setConnectionTracking(!0),t.getCursor().setCurNode(n.ASTNode.createBlockNode(e)),n.navigation.modify_()||n.navigation.warn_("Something went wrong while inserting a block from the flyout."),n.navigation.focusWorkspace_(t),t.getCursor().setCurNode(n.ASTNode.createTopNode(e)),n.navigation.removeMark_()):n.navigation.warn_("Can't insert a disabled block.")}else n.navigation.warn_("Trying to insert from the flyout when the flyout does not  exist or is not visible")},n.navigation.resetFlyout_=function(t){n.navigation.getFlyoutCursor_()&&(n.navigation.getFlyoutCursor_().hide(),t&&n.navigation.getNavigationWorkspace().getFlyout().hide())},n.navigation.modifyWarn_=function(){var t=n.navigation.getMarker().getCurNode(),e=n.navigation.getNavigationWorkspace().getCursor().getCurNode();return t?e?(t=t.getType(),e=e.getType(),t==n.ASTNode.types.FIELD?(n.navigation.warn_("Should not have been able to mark a field."),!1):t==n.ASTNode.types.BLOCK?(n.navigation.warn_("Should not have been able to mark a block."),!1):t==n.ASTNode.types.STACK?(n.navigation.warn_("Should not have been able to mark a stack."),!1):e==n.ASTNode.types.FIELD?(n.navigation.warn_("Cannot attach a field to anything else."),!1):e!=n.ASTNode.types.WORKSPACE||(n.navigation.warn_("Cannot attach a workspace to anything else."),!1)):(n.navigation.warn_("Cannot insert with no cursor node."),!1):(n.navigation.warn_("Cannot insert with no marked node."),!1)},n.navigation.moveBlockToWorkspace_=function(t,e){return!!t&&(t.isShadow()?(n.navigation.warn_("Cannot move a shadow block to the workspace."),!1):(t.getParent()&&t.unplug(!1),t.moveTo(e.getWsCoordinate()),!0))},n.navigation.modify_=function(){var t=n.navigation.getMarker().getCurNode(),e=n.navigation.getNavigationWorkspace().getCursor().getCurNode();if(!n.navigation.modifyWarn_())return!1;var i=t.getType(),o=e.getType(),r=e.getLocation(),s=t.getLocation();return t.isConnection()&&e.isConnection()?n.navigation.connect_(r,s):!t.isConnection()||o!=n.ASTNode.types.BLOCK&&o!=n.ASTNode.types.STACK?i==n.ASTNode.types.WORKSPACE?(e=e?e.getSourceBlock():null,n.navigation.moveBlockToWorkspace_(e,t)):(n.navigation.warn_("Unexpected state in Blockly.navigation.modify_."),!1):n.navigation.insertBlock(r,s)},n.navigation.disconnectChild_=function(t,e){var i=t.getSourceBlock(),o=e.getSourceBlock();i.getRootBlock()==o.getRootBlock()&&(-1<i.getDescendants(!1).indexOf(o)?n.navigation.getInferiorConnection_(e).disconnect():n.navigation.getInferiorConnection_(t).disconnect())},n.navigation.moveAndConnect_=function(t,e){if(!t||!e)return!1;var i=t.getSourceBlock();return!!t.getConnectionChecker().canConnect(t,e,!1)&&(n.navigation.disconnectChild_(t,e),e.isSuperior()||i.getRootBlock().positionNearConnection(t,e),e.connect(t),!0)},n.navigation.getInferiorConnection_=function(t){var e=t.getSourceBlock();return t.isSuperior()?e.previousConnection?e.previousConnection:e.outputConnection?e.outputConnection:null:t},n.navigation.getSuperiorConnection_=function(t){return t.isSuperior()?t:t.targetConnection?t.targetConnection:null},n.navigation.connect_=function(t,e){if(!t||!e)return!1;var i=n.navigation.getInferiorConnection_(t),o=n.navigation.getSuperiorConnection_(e),r=n.navigation.getSuperiorConnection_(t),s=n.navigation.getInferiorConnection_(e);return!!(i&&o&&n.navigation.moveAndConnect_(i,o)||r&&s&&n.navigation.moveAndConnect_(r,s)||n.navigation.moveAndConnect_(t,e))||(o=(i=t.getConnectionChecker()).canConnectWithReason(t,e,!1),n.navigation.warn_("Connection failed with error: "+i.getErrorMessage(o,t,e)),!1)},n.navigation.insertBlock=function(t,e){switch(e.type){case n.PREVIOUS_STATEMENT:if(n.navigation.connect_(t.nextConnection,e))return!0;break;case n.NEXT_STATEMENT:if(n.navigation.connect_(t.previousConnection,e))return!0;break;case n.INPUT_VALUE:if(n.navigation.connect_(t.outputConnection,e))return!0;break;case n.OUTPUT_VALUE:for(var i=0;i<t.inputList.length;i++){var o=t.inputList[i].connection;if(o&&o.type===n.INPUT_VALUE&&n.navigation.connect_(o,e))return!0}if(t.outputConnection&&n.navigation.connect_(t.outputConnection,e))return!0}return n.navigation.warn_("This block can not be inserted at the marked location."),!1},n.navigation.disconnectBlocks_=function(t){var e=t.getCursor().getCurNode();if(e.isConnection()){var i=e.getLocation();i.isConnected()?(e=i.isSuperior()?i:i.targetConnection,(i=i.isSuperior()?i.targetConnection:i).getSourceBlock().isShadow()?n.navigation.log_("Cannot disconnect a shadow block"):(e.disconnect(),i.bumpAwayFrom(e),e.getSourceBlock().getRootBlock().bringToFront(),e=n.ASTNode.createConnectionNode(e),t.getCursor().setCurNode(e))):n.navigation.log_("Cannot disconnect unconnected connection")}else n.navigation.log_("Cannot disconnect blocks when the cursor is not on a connection")},n.navigation.markAtCursor_=function(){n.navigation.getMarker().setCurNode(n.navigation.getNavigationWorkspace().getCursor().getCurNode())},n.navigation.removeMark_=function(){var t=n.navigation.getMarker();t.setCurNode(null),t.hide()},n.navigation.setState=function(t){n.navigation.currentState_=t},n.navigation.moveCursorOnBlockDelete=function(t){var e=n.navigation.getNavigationWorkspace();if(e&&(e=e.getCursor())){var i=e.getCurNode();(i=i?i.getSourceBlock():null)===t?i.getParent()?(t=i.previousConnection||i.outputConnection)&&e.setCurNode(n.ASTNode.createConnectionNode(t.targetConnection)):e.setCurNode(n.ASTNode.createWorkspaceNode(i.workspace,i.getRelativeToSurfaceXY())):i&&-1<t.getChildren(!1).indexOf(i)&&e.setCurNode(n.ASTNode.createWorkspaceNode(i.workspace,i.getRelativeToSurfaceXY()))}},n.navigation.moveCursorOnBlockMutation=function(t){var e=n.navigation.getNavigationWorkspace().getCursor();if(e){var i=e.getCurNode();(i=i?i.getSourceBlock():null)===t&&e.setCurNode(n.ASTNode.createBlockNode(i))}},n.navigation.enableKeyboardAccessibility=function(){var t=n.navigation.getNavigationWorkspace();t.keyboardAccessibilityMode||(t.keyboardAccessibilityMode=!0,n.navigation.focusWorkspace_(t))},n.navigation.disableKeyboardAccessibility=function(){var t=n.navigation.getNavigationWorkspace();t.keyboardAccessibilityMode&&(t.keyboardAccessibilityMode=!1,t.getCursor().hide(),n.navigation.getMarker().hide(),n.navigation.getFlyoutCursor_()&&n.navigation.getFlyoutCursor_().hide())},n.navigation.log_=function(t){n.navigation.loggingCallback?n.navigation.loggingCallback("log",t):console.log(t)},n.navigation.warn_=function(t){n.navigation.loggingCallback?n.navigation.loggingCallback("warn",t):console.warn(t)},n.navigation.error_=function(t){n.navigation.loggingCallback?n.navigation.loggingCallback("error",t):console.error(t)},n.navigation.moveWSCursor_=function(t,e,i){var o=t.getCursor(),r=t.getCursor().getCurNode();return r.getType()===n.ASTNode.types.WORKSPACE&&(r=r.getWsCoordinate(),o.setCurNode(n.ASTNode.createWorkspaceNode(t,new n.utils.Coordinate(e*n.navigation.WS_MOVE_DISTANCE+r.x,i*n.navigation.WS_MOVE_DISTANCE+r.y))),!0)},n.navigation.handleEnterForWS_=function(t){var e=(t=t.getCursor().getCurNode()).getType();e==n.ASTNode.types.FIELD?t.getLocation().showEditor():t.isConnection()||e==n.ASTNode.types.WORKSPACE?n.navigation.markAtCursor_():e==n.ASTNode.types.BLOCK?n.navigation.warn_("Cannot mark a block."):e==n.ASTNode.types.STACK&&n.navigation.warn_("Cannot mark a stack.")},n.navigation.registerPrevious=function(){var t={name:n.navigation.actionNames.PREVIOUS,preconditionFn:function(t){return t.keyboardAccessibilityMode},callback:function(t,e,i){switch(e=t.getToolbox(),n.navigation.currentState_){case n.navigation.STATE_WS:return t.getCursor().onBlocklyAction(i);case n.navigation.STATE_FLYOUT:return!(!(t=e?e.getFlyout():t.getFlyout())||!t.onBlocklyAction(i));case n.navigation.STATE_TOOLBOX:return!(!e||"function"!=typeof e.onBlocklyAction)&&e.onBlocklyAction(i);default:return!1}}};n.ShortcutRegistry.registry.register(t),n.ShortcutRegistry.registry.addKeyMapping(n.utils.KeyCodes.W,t.name)},n.navigation.registerOut=function(){var t={name:n.navigation.actionNames.OUT,preconditionFn:function(t){return t.keyboardAccessibilityMode},callback:function(t,e,i){switch(n.navigation.currentState_){case n.navigation.STATE_WS:return t.getCursor().onBlocklyAction(i);case n.navigation.STATE_FLYOUT:return n.navigation.focusToolbox_(t),!0;case n.navigation.STATE_TOOLBOX:return!(!(t=t.getToolbox())||"function"!=typeof t.onBlocklyAction)&&t.onBlocklyAction(i);default:return!1}}};n.ShortcutRegistry.registry.register(t),n.ShortcutRegistry.registry.addKeyMapping(n.utils.KeyCodes.A,t.name)},n.navigation.registerNext=function(){var t={name:n.navigation.actionNames.NEXT,preconditionFn:function(t){return t.keyboardAccessibilityMode},callback:function(t,e,i){switch(e=t.getToolbox(),n.navigation.currentState_){case n.navigation.STATE_WS:return t.getCursor().onBlocklyAction(i);case n.navigation.STATE_FLYOUT:return!(!(t=e?e.getFlyout():t.getFlyout())||!t.onBlocklyAction(i));case n.navigation.STATE_TOOLBOX:return!(!e||"function"!=typeof e.onBlocklyAction)&&e.onBlocklyAction(i);default:return!1}}};n.ShortcutRegistry.registry.register(t),n.ShortcutRegistry.registry.addKeyMapping(n.utils.KeyCodes.S,t.name)},n.navigation.registerIn=function(){var t={name:n.navigation.actionNames.IN,preconditionFn:function(t){return t.keyboardAccessibilityMode},callback:function(t,e,i){switch(n.navigation.currentState_){case n.navigation.STATE_WS:return t.getCursor().onBlocklyAction(i);case n.navigation.STATE_TOOLBOX:return(e=t.getToolbox())&&"function"==typeof e.onBlocklyAction&&e.onBlocklyAction(i)||n.navigation.focusFlyout_(t),!0;default:return!1}}};n.ShortcutRegistry.registry.register(t),n.ShortcutRegistry.registry.addKeyMapping(n.utils.KeyCodes.D,t.name)},n.navigation.registerInsert=function(){var t={name:n.navigation.actionNames.INSERT,preconditionFn:function(t){return t.keyboardAccessibilityMode&&!t.options.readOnly},callback:function(){switch(n.navigation.currentState_){case n.navigation.STATE_WS:return n.navigation.modify_();default:return!1}}};n.ShortcutRegistry.registry.register(t),n.ShortcutRegistry.registry.addKeyMapping(n.utils.KeyCodes.I,t.name)},n.navigation.registerMark=function(){var t={name:n.navigation.actionNames.MARK,preconditionFn:function(t){return t.keyboardAccessibilityMode&&!t.options.readOnly},callback:function(t){switch(n.navigation.currentState_){case n.navigation.STATE_WS:return n.navigation.handleEnterForWS_(t),!0;case n.navigation.STATE_FLYOUT:return n.navigation.insertFromFlyout(t),!0;default:return!1}}};n.ShortcutRegistry.registry.register(t),n.ShortcutRegistry.registry.addKeyMapping(n.utils.KeyCodes.ENTER,t.name)},n.navigation.registerDisconnect=function(){var t={name:n.navigation.actionNames.DISCONNECT,preconditionFn:function(t){return t.keyboardAccessibilityMode&&!t.options.readOnly},callback:function(t){switch(n.navigation.currentState_){case n.navigation.STATE_WS:return n.navigation.disconnectBlocks_(t),!0;default:return!1}}};n.ShortcutRegistry.registry.register(t),n.ShortcutRegistry.registry.addKeyMapping(n.utils.KeyCodes.X,t.name)},n.navigation.registerToolboxFocus=function(){var t={name:n.navigation.actionNames.TOOLBOX,preconditionFn:function(t){return t.keyboardAccessibilityMode&&!t.options.readOnly},callback:function(t){switch(n.navigation.currentState_){case n.navigation.STATE_WS:return t.getToolbox()?n.navigation.focusToolbox_(t):n.navigation.focusFlyout_(t),!0;default:return!1}}};n.ShortcutRegistry.registry.register(t),n.ShortcutRegistry.registry.addKeyMapping(n.utils.KeyCodes.T,t.name)},n.navigation.registerExit=function(){var t={name:n.navigation.actionNames.EXIT,preconditionFn:function(t){return t.keyboardAccessibilityMode},callback:function(t){switch(n.navigation.currentState_){case n.navigation.STATE_FLYOUT:case n.navigation.STATE_TOOLBOX:return n.navigation.focusWorkspace_(t),!0;default:return!1}}};n.ShortcutRegistry.registry.register(t,!0),n.ShortcutRegistry.registry.addKeyMapping(n.utils.KeyCodes.ESC,t.name,!0),n.ShortcutRegistry.registry.addKeyMapping(n.utils.KeyCodes.E,t.name,!0)},n.navigation.registerToggleKeyboardNav=function(){var t={name:n.navigation.actionNames.TOGGLE_KEYBOARD_NAV,callback:function(t){return t.keyboardAccessibilityMode?n.navigation.disableKeyboardAccessibility():n.navigation.enableKeyboardAccessibility(),!0}};n.ShortcutRegistry.registry.register(t);var e=n.ShortcutRegistry.registry.createSerializedKey(n.utils.KeyCodes.K,[n.utils.KeyCodes.CTRL,n.utils.KeyCodes.SHIFT]);n.ShortcutRegistry.registry.addKeyMapping(e,t.name)},n.navigation.registerWorkspaceMoveLeft=function(){var t={name:n.navigation.actionNames.MOVE_WS_CURSOR_LEFT,preconditionFn:function(t){return t.keyboardAccessibilityMode&&!t.options.readOnly},callback:function(t){return n.navigation.moveWSCursor_(t,-1,0)}};n.ShortcutRegistry.registry.register(t);var e=n.ShortcutRegistry.registry.createSerializedKey(n.utils.KeyCodes.A,[n.utils.KeyCodes.SHIFT]);n.ShortcutRegistry.registry.addKeyMapping(e,t.name)},n.navigation.registerWorkspaceMoveRight=function(){var t={name:n.navigation.actionNames.MOVE_WS_CURSOR_RIGHT,preconditionFn:function(t){return t.keyboardAccessibilityMode&&!t.options.readOnly},callback:function(t){return n.navigation.moveWSCursor_(t,1,0)}};n.ShortcutRegistry.registry.register(t);var e=n.ShortcutRegistry.registry.createSerializedKey(n.utils.KeyCodes.D,[n.utils.KeyCodes.SHIFT]);n.ShortcutRegistry.registry.addKeyMapping(e,t.name)},n.navigation.registerWorkspaceMoveUp=function(){var t={name:n.navigation.actionNames.MOVE_WS_CURSOR_UP,preconditionFn:function(t){return t.keyboardAccessibilityMode&&!t.options.readOnly},callback:function(t){return n.navigation.moveWSCursor_(t,0,-1)}};n.ShortcutRegistry.registry.register(t);var e=n.ShortcutRegistry.registry.createSerializedKey(n.utils.KeyCodes.W,[n.utils.KeyCodes.SHIFT]);n.ShortcutRegistry.registry.addKeyMapping(e,t.name)},n.navigation.registerWorkspaceMoveDown=function(){var t={name:n.navigation.actionNames.MOVE_WS_CURSOR_DOWN,preconditionFn:function(t){return t.keyboardAccessibilityMode&&!t.options.readOnly},callback:function(t){return n.navigation.moveWSCursor_(t,0,1)}};n.ShortcutRegistry.registry.register(t);var e=n.ShortcutRegistry.registry.createSerializedKey(n.utils.KeyCodes.S,[n.utils.KeyCodes.SHIFT]);n.ShortcutRegistry.registry.addKeyMapping(e,t.name)},n.navigation.registerNavigationShortcuts=function(){n.navigation.registerIn(),n.navigation.registerNext(),n.navigation.registerOut(),n.navigation.registerPrevious(),n.navigation.registerWorkspaceMoveDown(),n.navigation.registerWorkspaceMoveLeft(),n.navigation.registerWorkspaceMoveRight(),n.navigation.registerWorkspaceMoveUp(),n.navigation.registerDisconnect(),n.navigation.registerExit(),n.navigation.registerInsert(),n.navigation.registerMark(),n.navigation.registerToggleKeyboardNav(),n.navigation.registerToolboxFocus()},n.Gesture=function(t,e){this.mouseDownXY_=null,this.currentDragDeltaXY_=new n.utils.Coordinate(0,0),this.startWorkspace_=this.targetBlock_=this.startBlock_=this.startField_=this.startBubble_=null,this.creatorWorkspace_=e,this.isDraggingBubble_=this.isDraggingBlock_=this.isDraggingWorkspace_=this.hasExceededDragRadius_=!1,this.mostRecentEvent_=t,this.flyout_=this.workspaceDragger_=this.blockDragger_=this.bubbleDragger_=this.onUpWrapper_=this.onMoveWrapper_=null,this.isEnding_=this.hasStarted_=this.calledUpdateIsDragging_=!1,this.healStack_=!n.DRAG_STACK},n.Gesture.prototype.dispose=function(){n.Touch.clearTouchIdentifier(),n.Tooltip.unblock(),this.creatorWorkspace_.clearGesture(),this.onMoveWrapper_&&n.unbindEvent_(this.onMoveWrapper_),this.onUpWrapper_&&n.unbindEvent_(this.onUpWrapper_),this.blockDragger_&&this.blockDragger_.dispose(),this.workspaceDragger_&&this.workspaceDragger_.dispose(),this.bubbleDragger_&&this.bubbleDragger_.dispose()},n.Gesture.prototype.updateFromEvent_=function(t){var e=new n.utils.Coordinate(t.clientX,t.clientY);this.updateDragDelta_(e)&&(this.updateIsDragging_(),n.longStop_()),this.mostRecentEvent_=t},n.Gesture.prototype.updateDragDelta_=function(t){return this.currentDragDeltaXY_=n.utils.Coordinate.difference(t,this.mouseDownXY_),!this.hasExceededDragRadius_&&(this.hasExceededDragRadius_=n.utils.Coordinate.magnitude(this.currentDragDeltaXY_)>(this.flyout_?n.FLYOUT_DRAG_RADIUS:n.DRAG_RADIUS))},n.Gesture.prototype.updateIsDraggingFromFlyout_=function(){return!(!this.targetBlock_||!this.flyout_.isBlockCreatable_(this.targetBlock_)||this.flyout_.isScrollable()&&!this.flyout_.isDragTowardWorkspace(this.currentDragDeltaXY_)||(this.startWorkspace_=this.flyout_.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),n.Events.getGroup()||n.Events.setGroup(!0),this.startBlock_=null,this.targetBlock_=this.flyout_.createBlock(this.targetBlock_),this.targetBlock_.select(),0))},n.Gesture.prototype.updateIsDraggingBubble_=function(){return!!this.startBubble_&&(this.isDraggingBubble_=!0,this.startDraggingBubble_(),!0)},n.Gesture.prototype.updateIsDraggingBlock_=function(){return!!this.targetBlock_&&(this.flyout_?this.isDraggingBlock_=this.updateIsDraggingFromFlyout_():this.targetBlock_.isMovable()&&(this.isDraggingBlock_=!0),!!this.isDraggingBlock_&&(this.startDraggingBlock_(),!0))},n.Gesture.prototype.updateIsDraggingWorkspace_=function(){(this.flyout_?this.flyout_.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.workspaceDragger_=this.flyout_?new n.FlyoutDragger(this.flyout_):new n.WorkspaceDragger(this.startWorkspace_),this.isDraggingWorkspace_=!0,this.workspaceDragger_.startDrag())},n.Gesture.prototype.updateIsDragging_=function(){if(this.calledUpdateIsDragging_)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging_=!0,this.updateIsDraggingBubble_()||this.updateIsDraggingBlock_()||this.updateIsDraggingWorkspace_()},n.Gesture.prototype.startDraggingBlock_=function(){this.blockDragger_=new n.BlockDragger(this.targetBlock_,this.startWorkspace_),this.blockDragger_.startBlockDrag(this.currentDragDeltaXY_,this.healStack_),this.blockDragger_.dragBlock(this.mostRecentEvent_,this.currentDragDeltaXY_)},n.Gesture.prototype.startDraggingBubble_=function(){this.bubbleDragger_=new n.BubbleDragger(this.startBubble_,this.startWorkspace_),this.bubbleDragger_.startBubbleDrag(),this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_)},n.Gesture.prototype.doStart=function(t){n.utils.isTargetInput(t)?this.cancel():(this.hasStarted_=!0,n.blockAnimations.disconnectUiStop(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),n.hideChaff(!!this.flyout_),this.startWorkspace_.markFocused(),this.mostRecentEvent_=t,n.Tooltip.block(),this.targetBlock_&&(!this.targetBlock_.isInFlyout&&t.shiftKey&&this.targetBlock_.workspace.keyboardAccessibilityMode?this.creatorWorkspace_.getCursor().setCurNode(n.ASTNode.createTopNode(this.targetBlock_)):this.targetBlock_.select()),n.utils.isRightButton(t)?this.handleRightClick(t):("touchstart"!=t.type.toLowerCase()&&"pointerdown"!=t.type.toLowerCase()||"mouse"==t.pointerType||n.longStart(t,this),this.mouseDownXY_=new n.utils.Coordinate(t.clientX,t.clientY),this.healStack_=t.altKey||t.ctrlKey||t.metaKey,this.bindMouseEvents(t)))},n.Gesture.prototype.bindMouseEvents=function(t){this.onMoveWrapper_=n.bindEventWithChecks_(document,"mousemove",null,this.handleMove.bind(this)),this.onUpWrapper_=n.bindEventWithChecks_(document,"mouseup",null,this.handleUp.bind(this)),t.preventDefault(),t.stopPropagation()},n.Gesture.prototype.handleMove=function(t){this.updateFromEvent_(t),this.isDraggingWorkspace_?this.workspaceDragger_.drag(this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.dragBlock(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingBubble_&&this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_),t.preventDefault(),t.stopPropagation()},n.Gesture.prototype.handleUp=function(t){this.updateFromEvent_(t),n.longStop_(),this.isEnding_?console.log("Trying to end a gesture recursively."):(this.isEnding_=!0,this.isDraggingBubble_?this.bubbleDragger_.endBubbleDrag(t,this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.endBlockDrag(t,this.currentDragDeltaXY_):this.isDraggingWorkspace_?this.workspaceDragger_.endDrag(this.currentDragDeltaXY_):this.isBubbleClick_()?this.doBubbleClick_():this.isFieldClick_()?this.doFieldClick_():this.isBlockClick_()?this.doBlockClick_():this.isWorkspaceClick_()&&this.doWorkspaceClick_(t),t.preventDefault(),t.stopPropagation(),this.dispose())},n.Gesture.prototype.cancel=function(){this.isEnding_||(n.longStop_(),this.isDraggingBubble_?this.bubbleDragger_.endBubbleDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.endBlockDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingWorkspace_&&this.workspaceDragger_.endDrag(this.currentDragDeltaXY_),this.dispose())},n.Gesture.prototype.handleRightClick=function(t){this.targetBlock_?(this.bringBlockToFront_(),n.hideChaff(!!this.flyout_),this.targetBlock_.showContextMenu(t)):this.startBubble_?this.startBubble_.showContextMenu(t):this.startWorkspace_&&!this.flyout_&&(n.hideChaff(),this.startWorkspace_.showContextMenu(t)),t.preventDefault(),t.stopPropagation(),this.dispose()},n.Gesture.prototype.handleWsStart=function(t,e){if(this.hasStarted_)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace_(e),this.mostRecentEvent_=t,this.doStart(t),this.startWorkspace_.keyboardAccessibilityMode&&n.navigation.setState(n.navigation.STATE_WS)},n.Gesture.prototype.fireWorkspaceClick_=function(t){t=new n.Events.Click(null,t.id,"workspace"),n.Events.fire(t)},n.Gesture.prototype.handleFlyoutStart=function(t,e){if(this.hasStarted_)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout_(e),this.handleWsStart(t,e.getWorkspace())},n.Gesture.prototype.handleBlockStart=function(t,e){if(this.hasStarted_)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(e),this.mostRecentEvent_=t},n.Gesture.prototype.handleBubbleStart=function(t,e){if(this.hasStarted_)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(e),this.mostRecentEvent_=t},n.Gesture.prototype.doBubbleClick_=function(){this.startBubble_.setFocus&&this.startBubble_.setFocus(),this.startBubble_.select&&this.startBubble_.select()},n.Gesture.prototype.doFieldClick_=function(){this.startField_.showEditor(this.mostRecentEvent_),this.bringBlockToFront_()},n.Gesture.prototype.doBlockClick_=function(){if(this.flyout_&&this.flyout_.autoClose)this.targetBlock_.isEnabled()&&(n.Events.getGroup()||n.Events.setGroup(!0),this.flyout_.createBlock(this.targetBlock_).scheduleSnapAndBump());else{var t=new n.Events.Click(this.startBlock_,this.startWorkspace_.id,"block");n.Events.fire(t)}this.bringBlockToFront_(),n.Events.setGroup(!1)},n.Gesture.prototype.doWorkspaceClick_=function(t){var e=this.creatorWorkspace_;t.shiftKey&&e.keyboardAccessibilityMode?(t=new n.utils.Coordinate(t.clientX,t.clientY),t=n.utils.screenToWsCoordinates(e,t),t=n.ASTNode.createWorkspaceNode(e,t),e.getCursor().setCurNode(t)):n.selected&&n.selected.unselect(),this.fireWorkspaceClick_(this.startWorkspace_||e)},n.Gesture.prototype.bringBlockToFront_=function(){this.targetBlock_&&!this.flyout_&&this.targetBlock_.bringToFront()},n.Gesture.prototype.setStartField=function(t){if(this.hasStarted_)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField_||(this.startField_=t)},n.Gesture.prototype.setStartBubble=function(t){this.startBubble_||(this.startBubble_=t)},n.Gesture.prototype.setStartBlock=function(t){this.startBlock_||this.startBubble_||(this.startBlock_=t,t.isInFlyout&&t!=t.getRootBlock()?this.setTargetBlock_(t.getRootBlock()):this.setTargetBlock_(t))},n.Gesture.prototype.setTargetBlock_=function(t){t.isShadow()?this.setTargetBlock_(t.getParent()):this.targetBlock_=t},n.Gesture.prototype.setStartWorkspace_=function(t){this.startWorkspace_||(this.startWorkspace_=t)},n.Gesture.prototype.setStartFlyout_=function(t){this.flyout_||(this.flyout_=t)},n.Gesture.prototype.isBubbleClick_=function(){return!!this.startBubble_&&!this.hasExceededDragRadius_},n.Gesture.prototype.isBlockClick_=function(){return!!this.startBlock_&&!this.hasExceededDragRadius_&&!this.isFieldClick_()},n.Gesture.prototype.isFieldClick_=function(){return!!this.startField_&&this.startField_.isClickable()&&!this.hasExceededDragRadius_&&(!this.flyout_||!this.flyout_.autoClose)},n.Gesture.prototype.isWorkspaceClick_=function(){return!(this.startBlock_||this.startBubble_||this.startField_||this.hasExceededDragRadius_)},n.Gesture.prototype.isDragging=function(){return this.isDraggingWorkspace_||this.isDraggingBlock_||this.isDraggingBubble_},n.Gesture.prototype.hasStarted=function(){return this.hasStarted_},n.Gesture.prototype.getInsertionMarkers=function(){return this.blockDragger_?this.blockDragger_.getInsertionMarkers():[]},n.Gesture.inProgress=function(){for(var t,e=n.Workspace.getAll(),i=0;t=e[i];i++)if(t.currentGesture_)return!0;return!1},n.Field=function(t,e,i){this.value_=this.DEFAULT_VALUE,this.tooltip_=this.validator_=null,this.size_=new n.utils.Size(0,0),this.constants_=this.mouseDownWrapper_=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=this.markerSvg_=this.cursorSvg_=null,i&&this.configure_(i),this.setValue(t),e&&this.setValidator(e)},n.Field.prototype.DEFAULT_VALUE=null,n.Field.prototype.name=void 0,n.Field.prototype.disposed=!1,n.Field.prototype.maxDisplayLength=50,n.Field.prototype.sourceBlock_=null,n.Field.prototype.isDirty_=!0,n.Field.prototype.visible_=!0,n.Field.prototype.clickTarget_=null,n.Field.NBSP="Â ",n.Field.prototype.EDITABLE=!0,n.Field.prototype.SERIALIZABLE=!1,n.Field.prototype.configure_=function(t){var e=t.tooltip;"string"==typeof e&&(e=n.utils.replaceMessageReferences(t.tooltip)),e&&this.setTooltip(e)},n.Field.prototype.setSourceBlock=function(t){if(this.sourceBlock_)throw Error("Field already bound to a block.");this.sourceBlock_=t},n.Field.prototype.getConstants=function(){return!this.constants_&&this.sourceBlock_&&this.sourceBlock_.workspace&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_},n.Field.prototype.getSourceBlock=function(){return this.sourceBlock_},n.Field.prototype.init=function(){this.fieldGroup_||(this.fieldGroup_=n.utils.dom.createSvgElement(n.utils.Svg.G,{},null),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip_),this.bindEvents_(),this.initModel())},n.Field.prototype.initView=function(){this.createBorderRect_(),this.createTextElement_()},n.Field.prototype.initModel=function(){},n.Field.prototype.createBorderRect_=function(){this.borderRect_=n.utils.dom.createSvgElement(n.utils.Svg.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect",fill:"white"},this.fieldGroup_)},n.Field.prototype.createTextElement_=function(){this.textElement_=n.utils.dom.createSvgElement(n.utils.Svg.TEXT,{class:"blocklyText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)},n.Field.prototype.bindEvents_=function(){n.Tooltip.bindMouseEvents(this.getClickTarget_()),this.mouseDownWrapper_=n.bindEventWithChecks_(this.getClickTarget_(),"mousedown",this,this.onMouseDown_)},n.Field.prototype.fromXml=function(t){this.setValue(t.textContent)},n.Field.prototype.toXml=function(t){return t.textContent=this.getValue(),t},n.Field.prototype.dispose=function(){n.DropDownDiv.hideIfOwner(this),n.WidgetDiv.hideIfOwner(this),n.Tooltip.unbindMouseEvents(this.getClickTarget_()),this.mouseDownWrapper_&&n.unbindEvent_(this.mouseDownWrapper_),n.utils.dom.removeNode(this.fieldGroup_),this.disposed=!0},n.Field.prototype.updateEditable=function(){var t=this.fieldGroup_;this.EDITABLE&&t&&(this.sourceBlock_.isEditable()?(n.utils.dom.addClass(t,"blocklyEditableText"),n.utils.dom.removeClass(t,"blocklyNonEditableText"),t.style.cursor=this.CURSOR):(n.utils.dom.addClass(t,"blocklyNonEditableText"),n.utils.dom.removeClass(t,"blocklyEditableText"),t.style.cursor=""))},n.Field.prototype.isClickable=function(){return!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&!!this.showEditor_&&"function"==typeof this.showEditor_},n.Field.prototype.isCurrentlyEditable=function(){return this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()},n.Field.prototype.isSerializable=function(){var t=!1;return this.name&&(this.SERIALIZABLE?t=!0:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),t=!0)),t},n.Field.prototype.isVisible=function(){return this.visible_},n.Field.prototype.setVisible=function(t){if(this.visible_!=t){this.visible_=t;var e=this.getSvgRoot();e&&(e.style.display=t?"block":"none")}},n.Field.prototype.setValidator=function(t){this.validator_=t},n.Field.prototype.getValidator=function(){return this.validator_},n.Field.prototype.getSvgRoot=function(){return this.fieldGroup_},n.Field.prototype.applyColour=function(){},n.Field.prototype.render_=function(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()},n.Field.prototype.showEditor=function(t){this.isClickable()&&this.showEditor_(t)},n.Field.prototype.updateSize_=function(t){var e=this.getConstants(),i=2*(t=null!=t?t:this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0),o=e.FIELD_TEXT_HEIGHT,r=0;this.textElement_&&(i+=r=n.utils.dom.getFastTextWidth(this.textElement_,e.FIELD_TEXT_FONTSIZE,e.FIELD_TEXT_FONTWEIGHT,e.FIELD_TEXT_FONTFAMILY)),this.borderRect_&&(o=Math.max(o,e.FIELD_BORDER_RECT_HEIGHT)),this.size_.height=o,this.size_.width=i,this.positionTextElement_(t,r),this.positionBorderRect_()},n.Field.prototype.positionTextElement_=function(t,e){if(this.textElement_){var n=this.getConstants(),i=this.size_.height/2;this.textElement_.setAttribute("x",this.sourceBlock_.RTL?this.size_.width-e-t:t),this.textElement_.setAttribute("y",n.FIELD_TEXT_BASELINE_CENTER?i:i-n.FIELD_TEXT_HEIGHT/2+n.FIELD_TEXT_BASELINE)}},n.Field.prototype.positionBorderRect_=function(){this.borderRect_&&(this.borderRect_.setAttribute("width",this.size_.width),this.borderRect_.setAttribute("height",this.size_.height),this.borderRect_.setAttribute("rx",this.getConstants().FIELD_BORDER_RECT_RADIUS),this.borderRect_.setAttribute("ry",this.getConstants().FIELD_BORDER_RECT_RADIUS))},n.Field.prototype.getSize=function(){return this.isVisible()?(this.isDirty_?(this.render_(),this.isDirty_=!1):this.visible_&&0==this.size_.width&&(console.warn("Deprecated use of setting size_.width to 0 to rerender a field. Set field.isDirty_ to true instead."),this.render_()),this.size_):new n.utils.Size(0,0)},n.Field.prototype.getScaledBBox=function(){if(this.borderRect_)t=this.borderRect_.getBoundingClientRect(),i=n.utils.style.getPageOffset(this.borderRect_),o=t.width,t=t.height;else{var t=this.sourceBlock_.getHeightWidth(),e=this.sourceBlock_.workspace.scale,i=this.getAbsoluteXY_(),o=t.width*e;t=t.height*e,n.utils.userAgent.GECKO?(i.x+=1.5*e,i.y+=1.5*e):n.utils.userAgent.EDGE||n.utils.userAgent.IE||(i.x-=.5*e,i.y-=.5*e),o+=1*e,t+=1*e}return new n.utils.Rect(i.y,i.y+t,i.x,i.x+o)},n.Field.prototype.getDisplayText_=function(){var t=this.getText();return t?(t.length>this.maxDisplayLength&&(t=t.substring(0,this.maxDisplayLength-2)+"â€¦"),t=t.replace(/\s/g,n.Field.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(t+="â€"),t):n.Field.NBSP},n.Field.prototype.getText=function(){if(this.getText_){var t=this.getText_.call(this);if(null!==t)return String(t)}return String(this.getValue())},n.Field.prototype.markDirty=function(){this.isDirty_=!0,this.constants_=null},n.Field.prototype.forceRerender=function(){this.isDirty_=!0,this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours(),this.updateMarkers_())},n.Field.prototype.setValue=function(t){if(null!==t){var e=this.doClassValidation_(t);if(!((t=this.processValidation_(t,e))instanceof Error)){if((e=this.getValidator())&&(e=e.call(this,t),(t=this.processValidation_(t,e))instanceof Error))return;if(!(e=this.sourceBlock_)||!e.disposed){var i=this.getValue();i===t?this.doValueUpdate_(t):(e&&n.Events.isEnabled()&&n.Events.fire(new n.Events.BlockChange(e,"field",this.name||null,i,t)),this.doValueUpdate_(t),this.isDirty_&&this.forceRerender())}}}},n.Field.prototype.processValidation_=function(t,e){return null===e?(this.doValueInvalid_(t),this.isDirty_&&this.forceRerender(),Error()):(void 0!==e&&(t=e),t)},n.Field.prototype.getValue=function(){return this.value_},n.Field.prototype.doClassValidation_=function(t){return null==t?null:t},n.Field.prototype.doValueUpdate_=function(t){this.value_=t,this.isDirty_=!0},n.Field.prototype.doValueInvalid_=function(t){},n.Field.prototype.onMouseDown_=function(t){this.sourceBlock_&&this.sourceBlock_.workspace&&(t=this.sourceBlock_.workspace.getGesture(t))&&t.setStartField(this)},n.Field.prototype.setTooltip=function(t){t||""===t||(t=this.sourceBlock_);var e=this.getClickTarget_();e?e.tooltip=t:this.tooltip_=t},n.Field.prototype.getTooltip=function(){var t=this.getClickTarget_();return t?n.Tooltip.getTooltipOfObject(t):n.Tooltip.getTooltipOfObject({tooltip:this.tooltip_})},n.Field.prototype.getClickTarget_=function(){return this.clickTarget_||this.getSvgRoot()},n.Field.prototype.getAbsoluteXY_=function(){return n.utils.style.getPageOffset(this.getClickTarget_())},n.Field.prototype.referencesVariables=function(){return!1},n.Field.prototype.getParentInput=function(){for(var t=null,e=this.sourceBlock_,n=e.inputList,i=0;i<e.inputList.length;i++)for(var o=n[i],r=o.fieldRow,s=0;s<r.length;s++)if(r[s]===this){t=o;break}return t},n.Field.prototype.getFlipRtl=function(){return!1},n.Field.prototype.isTabNavigable=function(){return!1},n.Field.prototype.onBlocklyAction=function(t){return!1},n.Field.prototype.setCursorSvg=function(t){t?(this.fieldGroup_.appendChild(t),this.cursorSvg_=t):this.cursorSvg_=null},n.Field.prototype.setMarkerSvg=function(t){t?(this.fieldGroup_.appendChild(t),this.markerSvg_=t):this.markerSvg_=null},n.Field.prototype.updateMarkers_=function(){var t=this.sourceBlock_.workspace;t.keyboardAccessibilityMode&&this.cursorSvg_&&t.getCursor().draw(),t.keyboardAccessibilityMode&&this.markerSvg_&&t.getMarker(n.navigation.MARKER_NAME).draw()},n.FieldLabel=function(t,e,i){this.class_=null,n.FieldLabel.superClass_.constructor.call(this,t,null,i),i||(this.class_=e||null)},n.utils.object.inherits(n.FieldLabel,n.Field),n.FieldLabel.prototype.DEFAULT_VALUE="",n.FieldLabel.fromJson=function(t){var e=n.utils.replaceMessageReferences(t.text);return new n.FieldLabel(e,void 0,t)},n.FieldLabel.prototype.EDITABLE=!1,n.FieldLabel.prototype.configure_=function(t){n.FieldLabel.superClass_.configure_.call(this,t),this.class_=t.class},n.FieldLabel.prototype.initView=function(){this.createTextElement_(),this.class_&&n.utils.dom.addClass(this.textElement_,this.class_)},n.FieldLabel.prototype.doClassValidation_=function(t){return null==t?null:String(t)},n.FieldLabel.prototype.setClass=function(t){this.textElement_&&(this.class_&&n.utils.dom.removeClass(this.textElement_,this.class_),t&&n.utils.dom.addClass(this.textElement_,t)),this.class_=t},n.fieldRegistry.register("field_label",n.FieldLabel),n.Input=function(t,e,i,o){if(t!=n.DUMMY_INPUT&&!e)throw Error("Value inputs and statement inputs must have non-empty name.");this.type=t,this.name=e,this.sourceBlock_=i,this.connection=o,this.fieldRow=[]},n.Input.prototype.align=n.ALIGN_LEFT,n.Input.prototype.visible_=!0,n.Input.prototype.getSourceBlock=function(){return this.sourceBlock_},n.Input.prototype.appendField=function(t,e){return this.insertFieldAt(this.fieldRow.length,t,e),this},n.Input.prototype.insertFieldAt=function(t,e,i){if(0>t||t>this.fieldRow.length)throw Error("index "+t+" out of bounds.");return e||""==e&&i?("string"==typeof e&&(e=new n.FieldLabel(e)),e.setSourceBlock(this.sourceBlock_),this.sourceBlock_.rendered&&(e.init(),e.applyColour()),e.name=i,e.setVisible(this.isVisible()),(i=e).prefixField&&(t=this.insertFieldAt(t,i.prefixField)),this.fieldRow.splice(t,0,e),++t,i.suffixField&&(t=this.insertFieldAt(t,i.suffixField)),this.sourceBlock_.rendered&&(this.sourceBlock_=this.sourceBlock_,this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours()),t):t},n.Input.prototype.removeField=function(t,e){for(var n,i=0;n=this.fieldRow[i];i++)if(n.name===t)return n.dispose(),this.fieldRow.splice(i,1),this.sourceBlock_.rendered&&(this.sourceBlock_=this.sourceBlock_,this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours()),!0;if(e)return!1;throw Error('Field "'+t+'" not found.')},n.Input.prototype.isVisible=function(){return this.visible_},n.Input.prototype.setVisible=function(t){var e=[];if(this.visible_==t)return e;this.visible_=t;for(var n,i=0;n=this.fieldRow[i];i++)n.setVisible(t);return this.connection&&(this.connection=this.connection,t?e=this.connection.startTrackingAll():this.connection.stopTrackingAll(),i=this.connection.targetBlock())&&(i.getSvgRoot().style.display=t?"block":"none"),e},n.Input.prototype.markDirty=function(){for(var t,e=0;t=this.fieldRow[e];e++)t.markDirty()},n.Input.prototype.setCheck=function(t){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(t),this},n.Input.prototype.setAlign=function(t){return this.align=t,this.sourceBlock_.rendered&&(this.sourceBlock_=this.sourceBlock_,this.sourceBlock_.render()),this},n.Input.prototype.setShadowDom=function(t){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setShadowDom(t),this},n.Input.prototype.getShadowDom=function(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom()},n.Input.prototype.init=function(){if(this.sourceBlock_.workspace.rendered)for(var t=0;t<this.fieldRow.length;t++)this.fieldRow[t].init()},n.Input.prototype.dispose=function(){for(var t,e=0;t=this.fieldRow[e];e++)t.dispose();this.connection&&this.connection.dispose(),this.sourceBlock_=null},n.Block=function(t,e,i){if(n.Generator&&void 0!==n.Generator.prototype[e])throw Error('Block prototypeName "'+e+'" conflicts with Blockly.Generator members.');if(this.id=i&&!t.getBlockById(i)?i:n.utils.genUid(),t.setBlockById(this.id,this),this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.inputsInline=void 0,this.disabled=!1,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable_=this.movable_=this.deletable_=!0,this.collapsed_=this.isShadow_=!1,this.comment=this.outputShape_=null,this.commentModel={text:null,pinned:!1,size:new n.utils.Size(160,80)},this.xy_=new n.utils.Coordinate(0,0),this.workspace=t,this.isInFlyout=t.isFlyout,this.isInMutator=t.isMutator,this.RTL=t.RTL,this.isInsertionMarker_=!1,this.hat=void 0,this.rendered=null,this.statementInputCount=0,e){if(this.type=e,!(i=n.Blocks[e])||"object"!=typeof i)throw TypeError("Unknown block type: "+e);n.utils.object.mixin(this,i)}t.addTopBlock(this),t.addTypedBlock(this),(t=n.Events.getGroup())||n.Events.setGroup(!0),e=n.Events.recordUndo;try{"function"==typeof this.init&&(n.Events.recordUndo=!1,this.init(),n.Events.recordUndo=e),n.Events.isEnabled()&&n.Events.fire(new n.Events.BlockCreate(this))}finally{t||n.Events.setGroup(!1),n.Events.recordUndo=e}this.inputsInlineDefault=this.inputsInline,"function"==typeof this.onchange&&this.setOnChange(this.onchange)},n.Block.COLLAPSED_INPUT_NAME="_TEMP_COLLAPSED_INPUT",n.Block.COLLAPSED_FIELD_NAME="_TEMP_COLLAPSED_FIELD",n.Block.prototype.data=null,n.Block.prototype.disposed=!1,n.Block.prototype.hue_=null,n.Block.prototype.colour_="#000000",n.Block.prototype.styleName_=null,n.Block.prototype.dispose=function(t){if(this.workspace){this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.unplug(t),n.Events.isEnabled()&&n.Events.fire(new n.Events.BlockDelete(this)),n.Events.disable();try{this.workspace&&(this.workspace.removeTopBlock(this),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),this.workspace=null),n.selected==this&&(n.selected=null);for(var e=this.childBlocks_.length-1;0<=e;e--)this.childBlocks_[e].dispose(!1);e=0;for(var i;i=this.inputList[e];e++)i.dispose();this.inputList.length=0;var o,r=this.getConnections_(!0);for(e=0;o=r[e];e++)o.dispose()}finally{n.Events.enable(),this.disposed=!0}}},n.Block.prototype.initModel=function(){for(var t,e=0;t=this.inputList[e];e++)for(var n,i=0;n=t.fieldRow[i];i++)n.initModel&&n.initModel()},n.Block.prototype.unplug=function(t){this.outputConnection?this.unplugFromRow_(t):this.previousConnection&&this.unplugFromStack_(t)},n.Block.prototype.unplugFromRow_=function(t){var e=null;this.outputConnection.isConnected()&&(e=this.outputConnection.targetConnection,this.outputConnection.disconnect()),e&&t&&(t=this.getOnlyValueConnection_())&&t.isConnected()&&!t.targetBlock().isShadow()&&((t=t.targetConnection).disconnect(),this.workspace.connectionChecker.canConnect(t,e,!1)?e.connect(t):t.onFailedConnect(e))},n.Block.prototype.getOnlyValueConnection_=function(){for(var t=null,e=0;e<this.inputList.length;e++){var i=this.inputList[e].connection;if(i&&i.type==n.INPUT_VALUE&&i.targetConnection){if(t)return null;t=i}}return t},n.Block.prototype.unplugFromStack_=function(t){var e=null;this.previousConnection.isConnected()&&(e=this.previousConnection.targetConnection,this.previousConnection.disconnect());var n=this.getNextBlock();t&&n&&!n.isShadow()&&((t=this.nextConnection.targetConnection).disconnect(),e&&this.workspace.connectionChecker.canConnect(e,t,!1)&&e.connect(t))},n.Block.prototype.getConnections_=function(t){t=[],this.outputConnection&&t.push(this.outputConnection),this.previousConnection&&t.push(this.previousConnection),this.nextConnection&&t.push(this.nextConnection);for(var e,n=0;e=this.inputList[n];n++)e.connection&&t.push(e.connection);return t},n.Block.prototype.lastConnectionInStack=function(){for(var t=this.nextConnection;t;){var e=t.targetBlock();if(!e)return t;t=e.nextConnection}return null},n.Block.prototype.bumpNeighbours=function(){},n.Block.prototype.getParent=function(){return this.parentBlock_},n.Block.prototype.getInputWithBlock=function(t){for(var e,n=0;e=this.inputList[n];n++)if(e.connection&&e.connection.targetBlock()==t)return e;return null},n.Block.prototype.getSurroundParent=function(){var t=this;do{var e=t;if(!(t=t.getParent()))return null}while(t.getNextBlock()==e);return t},n.Block.prototype.getNextBlock=function(){return this.nextConnection&&this.nextConnection.targetBlock()},n.Block.prototype.getPreviousBlock=function(){return this.previousConnection&&this.previousConnection.targetBlock()},n.Block.prototype.getFirstStatementConnection=function(){for(var t,e=0;t=this.inputList[e];e++)if(t.connection&&t.connection.type==n.NEXT_STATEMENT)return t.connection;return null},n.Block.prototype.getRootBlock=function(){var t=this;do{var e=t;t=e.parentBlock_}while(t);return e},n.Block.prototype.getTopStackBlock=function(){var t=this;do{var e=t.getPreviousBlock()}while(e&&e.getNextBlock()==t&&(t=e));return t},n.Block.prototype.getChildren=function(t){if(!t)return this.childBlocks_;t=[];for(var e,n=0;e=this.inputList[n];n++)e.connection&&(e=e.connection.targetBlock())&&t.push(e);return(n=this.getNextBlock())&&t.push(n),t},n.Block.prototype.setParent=function(t){if(t!=this.parentBlock_){if(this.parentBlock_){if(n.utils.arrayRemove(this.parentBlock_.childBlocks_,this),this.previousConnection&&this.previousConnection.isConnected())throw Error("Still connected to previous block.");if(this.outputConnection&&this.outputConnection.isConnected())throw Error("Still connected to parent block.");this.parentBlock_=null}else this.workspace.removeTopBlock(this);(this.parentBlock_=t)?t.childBlocks_.push(this):this.workspace.addTopBlock(this)}},n.Block.prototype.getDescendants=function(t){for(var e,n=[this],i=this.getChildren(t),o=0;e=i[o];o++)n.push.apply(n,e.getDescendants(t));return n},n.Block.prototype.isDeletable=function(){return this.deletable_&&!this.isShadow_&&!(this.workspace&&this.workspace.options.readOnly)},n.Block.prototype.setDeletable=function(t){this.deletable_=t},n.Block.prototype.isMovable=function(){return this.movable_&&!this.isShadow_&&!(this.workspace&&this.workspace.options.readOnly)},n.Block.prototype.setMovable=function(t){this.movable_=t},n.Block.prototype.isDuplicatable=function(){return!this.workspace.hasBlockLimits()||this.workspace.isCapacityAvailable(n.utils.getBlockTypeCounts(this,!0))},n.Block.prototype.isShadow=function(){return this.isShadow_},n.Block.prototype.setShadow=function(t){this.isShadow_=t},n.Block.prototype.isInsertionMarker=function(){return this.isInsertionMarker_},n.Block.prototype.setInsertionMarker=function(t){this.isInsertionMarker_=t},n.Block.prototype.isEditable=function(){return this.editable_&&!(this.workspace&&this.workspace.options.readOnly)},n.Block.prototype.setEditable=function(t){this.editable_=t,t=0;for(var e;e=this.inputList[t];t++)for(var n,i=0;n=e.fieldRow[i];i++)n.updateEditable()},n.Block.prototype.isDisposed=function(){return this.disposed},n.Block.prototype.getMatchingConnection=function(t,e){var n=this.getConnections_(!0);if(t=t.getConnections_(!0),n.length!=t.length)throw Error("Connection lists did not match in length.");for(var i=0;i<t.length;i++)if(t[i]==e)return n[i];return null},n.Block.prototype.setHelpUrl=function(t){this.helpUrl=t},n.Block.prototype.setTooltip=function(t){this.tooltip=t},n.Block.prototype.getTooltip=function(){return n.Tooltip.getTooltipOfObject(this)},n.Block.prototype.getColour=function(){return this.colour_},n.Block.prototype.getStyleName=function(){return this.styleName_},n.Block.prototype.getHue=function(){return this.hue_},n.Block.prototype.setColour=function(t){t=n.utils.parseBlockColour(t),this.hue_=t.hue,this.colour_=t.hex},n.Block.prototype.setStyle=function(t){this.styleName_=t},n.Block.prototype.setOnChange=function(t){if(t&&"function"!=typeof t)throw Error("onchange must be a function.");this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),(this.onchange=t)&&(this.onchangeWrapper_=t.bind(this),this.workspace.addChangeListener(this.onchangeWrapper_))},n.Block.prototype.getField=function(t){for(var e,n=0;e=this.inputList[n];n++)for(var i,o=0;i=e.fieldRow[o];o++)if(i.name==t)return i;return null},n.Block.prototype.getVars=function(){for(var t,e=[],n=0;t=this.inputList[n];n++)for(var i,o=0;i=t.fieldRow[o];o++)i.referencesVariables()&&e.push(i.getValue());return e},n.Block.prototype.getVarModels=function(){for(var t,e=[],n=0;t=this.inputList[n];n++)for(var i,o=0;i=t.fieldRow[o];o++)i.referencesVariables()&&(i=this.workspace.getVariableById(i.getValue()))&&e.push(i);return e},n.Block.prototype.updateVarName=function(t){for(var e,n=0;e=this.inputList[n];n++)for(var i,o=0;i=e.fieldRow[o];o++)i.referencesVariables()&&t.getId()==i.getValue()&&i.refreshVariableName()},n.Block.prototype.renameVarById=function(t,e){for(var n,i=0;n=this.inputList[i];i++)for(var o,r=0;o=n.fieldRow[r];r++)o.referencesVariables()&&t==o.getValue()&&o.setValue(e)},n.Block.prototype.getFieldValue=function(t){return(t=this.getField(t))?t.getValue():null},n.Block.prototype.setFieldValue=function(t,e){var n=this.getField(e);if(!n)throw Error('Field "'+e+'" not found.');n.setValue(t)},n.Block.prototype.setPreviousStatement=function(t,e){if(t){if(void 0===e&&(e=null),!this.previousConnection){if(this.outputConnection)throw Error("Remove output connection prior to adding previous connection.");this.previousConnection=this.makeConnection_(n.PREVIOUS_STATEMENT)}this.previousConnection.setCheck(e)}else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}},n.Block.prototype.setNextStatement=function(t,e){if(t)void 0===e&&(e=null),this.nextConnection||(this.nextConnection=this.makeConnection_(n.NEXT_STATEMENT)),this.nextConnection.setCheck(e);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}},n.Block.prototype.setOutput=function(t,e){if(t){if(void 0===e&&(e=null),!this.outputConnection){if(this.previousConnection)throw Error("Remove previous connection prior to adding output connection.");this.outputConnection=this.makeConnection_(n.OUTPUT_VALUE)}this.outputConnection.setCheck(e)}else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}},n.Block.prototype.setInputsInline=function(t){this.inputsInline!=t&&(n.Events.fire(new n.Events.BlockChange(this,"inline",null,this.inputsInline,t)),this.inputsInline=t)},n.Block.prototype.getInputsInline=function(){if(null!=this.inputsInline)return this.inputsInline;for(var t=1;t<this.inputList.length;t++)if(this.inputList[t-1].type==n.DUMMY_INPUT&&this.inputList[t].type==n.DUMMY_INPUT)return!1;for(t=1;t<this.inputList.length;t++)if(this.inputList[t-1].type==n.INPUT_VALUE&&this.inputList[t].type==n.DUMMY_INPUT)return!0;return!1},n.Block.prototype.setOutputShape=function(t){this.outputShape_=t},n.Block.prototype.getOutputShape=function(){return this.outputShape_},n.Block.prototype.isEnabled=function(){return!this.disabled},n.Block.prototype.setEnabled=function(t){this.isEnabled()!=t&&(n.Events.fire(new n.Events.BlockChange(this,"disabled",null,this.disabled,!t)),this.disabled=!t)},n.Block.prototype.getInheritedDisabled=function(){for(var t=this.getSurroundParent();t;){if(t.disabled)return!0;t=t.getSurroundParent()}return!1},n.Block.prototype.isCollapsed=function(){return this.collapsed_},n.Block.prototype.setCollapsed=function(t){this.collapsed_!=t&&(n.Events.fire(new n.Events.BlockChange(this,"collapsed",null,this.collapsed_,t)),this.collapsed_=t)},n.Block.prototype.toString=function(t,e){function i(t){var e=t.getCheck();return!e&&t.targetConnection&&(e=t.targetConnection.getCheck()),!!e&&(-1!=e.indexOf("Boolean")||-1!=e.indexOf("Number"))}function o(){a&&a.getType()==l.getType()&&a.getLocation()==l.getLocation()&&(a=null)}var r=[];e=e||"?";var s=n.ASTNode.NAVIGATE_ALL_FIELDS;n.ASTNode.NAVIGATE_ALL_FIELDS=!0;for(var a=n.ASTNode.createBlockNode(this),l=a;a;){switch(a.getType()){case n.ASTNode.types.INPUT:var c=a.getLocation();a.in()?i(c)&&r.push("("):r.push(e);break;case n.ASTNode.types.FIELD:(c=a.getLocation()).name!=n.Block.COLLAPSED_FIELD_NAME&&r.push(c.getText())}if(!(a=(c=a).in()||c.next())){for(a=c.out(),o();a&&!a.next();)a=a.out(),o(),a&&a.getType()==n.ASTNode.types.INPUT&&i(a.getLocation())&&r.push(")");a&&(a=a.next())}}for(n.ASTNode.NAVIGATE_ALL_FIELDS=s,e=2,s=r.length;e<s;e++)"("==r[e-2]&&")"==r[e]&&(r[e-2]=r[e-1],r.splice(e-1,2),s-=2);return r=r.join(" ").replace(/(\() | (\))/gim,"$1$2").trim()||"???",t&&r.length>t&&(r=r.substring(0,t-3)+"..."),r},n.Block.prototype.appendValueInput=function(t){return this.appendInput_(n.INPUT_VALUE,t)},n.Block.prototype.appendStatementInput=function(t){return this.appendInput_(n.NEXT_STATEMENT,t)},n.Block.prototype.appendDummyInput=function(t){return this.appendInput_(n.DUMMY_INPUT,t||"")},n.Block.prototype.jsonInit=function(t){var e=t.type?'Block "'+t.type+'": ':"";if(t.output&&t.previousStatement)throw Error(e+"Must not have both an output and a previousStatement.");if(t.style&&t.style.hat&&(this.hat=t.style.hat,t.style=null),t.style&&t.colour)throw Error(e+"Must not have both a colour and a style.");t.style?this.jsonInitStyle_(t,e):this.jsonInitColour_(t,e);for(var i=0;void 0!==t["message"+i];)this.interpolate_(t["message"+i],t["args"+i]||[],t["lastDummyAlign"+i],e),i++;if(void 0!==t.inputsInline&&this.setInputsInline(t.inputsInline),void 0!==t.output&&this.setOutput(!0,t.output),void 0!==t.outputShape&&this.setOutputShape(t.outputShape),void 0!==t.previousStatement&&this.setPreviousStatement(!0,t.previousStatement),void 0!==t.nextStatement&&this.setNextStatement(!0,t.nextStatement),void 0!==t.tooltip&&(i=t.tooltip,i=n.utils.replaceMessageReferences(i),this.setTooltip(i)),void 0!==t.enableContextMenu&&(i=t.enableContextMenu,this.contextMenu=!!i),void 0!==t.helpUrl&&(i=t.helpUrl,i=n.utils.replaceMessageReferences(i),this.setHelpUrl(i)),"string"==typeof t.extensions&&(console.warn(e+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+t.type+"' block."),t.extensions=[t.extensions]),void 0!==t.mutator&&n.Extensions.apply(t.mutator,this,!0),Array.isArray(t.extensions))for(t=t.extensions,e=0;e<t.length;++e)n.Extensions.apply(t[e],this,!1)},n.Block.prototype.jsonInitColour_=function(t,e){if("colour"in t)if(void 0===t.colour)console.warn(e+"Undefined colour value.");else{t=t.colour;try{this.setColour(t)}catch(n){console.warn(e+"Illegal colour value: ",t)}}},n.Block.prototype.jsonInitStyle_=function(t,e){t=t.style;try{this.setStyle(t)}catch(n){console.warn(e+"Style does not exist: ",t)}},n.Block.prototype.mixin=function(t,e){if(void 0!==e&&"boolean"!=typeof e)throw Error("opt_disableCheck must be a boolean if provided");if(!e){for(var i in e=[],t)void 0!==this[i]&&e.push(i);if(e.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(e))}n.utils.object.mixin(this,t)},n.Block.prototype.interpolate_=function(t,e,i,o){var r=n.utils.tokenizeInterpolation(t),s=[],a=0;t=[];for(var l=0;l<r.length;l++){var c=r[l];if("number"==typeof c){if(0>=c||c>e.length)throw Error('Block "'+this.type+'": Message index %'+c+" out of range.");if(s[c])throw Error('Block "'+this.type+'": Message index %'+c+" duplicated.");s[c]=!0,a++,t.push(e[c-1])}else(c=c.trim())&&t.push(c)}if(a!=e.length)throw Error('Block "'+this.type+'": Message does not reference all '+e.length+" arg(s).");for(t.length&&("string"==typeof t[t.length-1]||n.utils.string.startsWith(t[t.length-1].type,"field_"))&&(l={type:"input_dummy"},i&&(l.align=i),t.push(l)),i={LEFT:n.ALIGN_LEFT,RIGHT:n.ALIGN_RIGHT,CENTRE:n.ALIGN_CENTRE,CENTER:n.ALIGN_CENTRE},e=[],l=0;l<t.length;l++)if("string"==typeof(s=t[l]))e.push([s,void 0]);else{r=a=null;do{if(c=!1,"string"==typeof s)a=new n.FieldLabel(s);else switch(s.type){case"input_value":r=this.appendValueInput(s.name);break;case"input_statement":r=this.appendStatementInput(s.name);break;case"input_dummy":r=this.appendDummyInput(s.name);break;default:!(a=n.fieldRegistry.fromJson(s))&&s.alt&&(s=s.alt,c=!0)}}while(c);if(a)e.push([a,s.name]);else if(r){for(s.check&&r.setCheck(s.check),s.align&&(void 0===(a=i[s.align.toUpperCase()])?console.warn(o+"Illegal align value: ",s.align):r.setAlign(a)),s=0;s<e.length;s++)r.appendField(e[s][0],e[s][1]);e.length=0}}},n.Block.prototype.appendInput_=function(t,e){var i=null;return t!=n.INPUT_VALUE&&t!=n.NEXT_STATEMENT||(i=this.makeConnection_(t)),t==n.NEXT_STATEMENT&&this.statementInputCount++,t=new n.Input(t,e,this,i),this.inputList.push(t),t},n.Block.prototype.moveInputBefore=function(t,e){if(t!=e){for(var n,i=-1,o=e?-1:this.inputList.length,r=0;n=this.inputList[r];r++)if(n.name==t){if(i=r,-1!=o)break}else if(e&&n.name==e&&(o=r,-1!=i))break;if(-1==i)throw Error('Named input "'+t+'" not found.');if(-1==o)throw Error('Reference input "'+e+'" not found.');this.moveNumberedInputBefore(i,o)}},n.Block.prototype.moveNumberedInputBefore=function(t,e){if(t==e)throw Error("Can't move input to itself.");if(t>=this.inputList.length)throw RangeError("Input index "+t+" out of bounds.");if(e>this.inputList.length)throw RangeError("Reference input "+e+" out of bounds.");var n=this.inputList[t];this.inputList.splice(t,1),t<e&&e--,this.inputList.splice(e,0,n)},n.Block.prototype.removeInput=function(t,e){for(var i,o=0;i=this.inputList[o];o++)if(i.name==t)return i.type==n.NEXT_STATEMENT&&this.statementInputCount--,i.dispose(),this.inputList.splice(o,1),!0;if(e)return!1;throw Error("Input not found: "+t)},n.Block.prototype.getInput=function(t){for(var e,n=0;e=this.inputList[n];n++)if(e.name==t)return e;return null},n.Block.prototype.getInputTargetBlock=function(t){return(t=this.getInput(t))&&t.connection&&t.connection.targetBlock()},n.Block.prototype.getCommentText=function(){return this.commentModel.text},n.Block.prototype.setCommentText=function(t){this.commentModel.text!=t&&(n.Events.fire(new n.Events.BlockChange(this,"comment",null,this.commentModel.text,t)),this.comment=this.commentModel.text=t)},n.Block.prototype.setWarningText=function(t,e){},n.Block.prototype.setMutator=function(t){},n.Block.prototype.getRelativeToSurfaceXY=function(){return this.xy_},n.Block.prototype.moveBy=function(t,e){if(this.parentBlock_)throw Error("Block has parent.");var i=new n.Events.BlockMove(this);this.xy_.translate(t,e),i.recordNew(),n.Events.fire(i)},n.Block.prototype.makeConnection_=function(t){return new n.Connection(this,t)},n.Block.prototype.allInputsFilled=function(t){if(void 0===t&&(t=!0),!t&&this.isShadow())return!1;for(var e,n=0;e=this.inputList[n];n++)if(e.connection&&(!(e=e.connection.targetBlock())||!e.allInputsFilled(t)))return!1;return!(n=this.getNextBlock())||n.allInputsFilled(t)},n.Block.prototype.toDevString=function(){var t=this.type?'"'+this.type+'" block':"Block";return this.id&&(t+=' (id="'+this.id+'")'),t},n.blockRendering={},n.blockRendering.IPathObject=function(t,e){},n.utils.aria={},n.utils.aria.ARIA_PREFIX_="aria-",n.utils.aria.ROLE_ATTRIBUTE_="role",n.utils.aria.Role={GRID:"grid",GRIDCELL:"gridcell",GROUP:"group",LISTBOX:"listbox",MENU:"menu",MENUITEM:"menuitem",MENUITEMCHECKBOX:"menuitemcheckbox",OPTION:"option",PRESENTATION:"presentation",ROW:"row",TREE:"tree",TREEITEM:"treeitem"},n.utils.aria.State={ACTIVEDESCENDANT:"activedescendant",COLCOUNT:"colcount",DISABLED:"disabled",EXPANDED:"expanded",INVALID:"invalid",LABEL:"label",LABELLEDBY:"labelledby",LEVEL:"level",ORIENTATION:"orientation",POSINSET:"posinset",ROWCOUNT:"rowcount",SELECTED:"selected",SETSIZE:"setsize",VALUEMAX:"valuemax",VALUEMIN:"valuemin"},n.utils.aria.setRole=function(t,e){t.setAttribute(n.utils.aria.ROLE_ATTRIBUTE_,e)},n.utils.aria.setState=function(t,e,i){Array.isArray(i)&&(i=i.join(" ")),t.setAttribute(n.utils.aria.ARIA_PREFIX_+e,i)},n.utils.KeyCodes={WIN_KEY_FF_LINUX:0,MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PLUS_SIGN:43,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,FF_SEMICOLON:59,FF_EQUALS:61,FF_DASH:173,FF_HASH:163,QUESTION_MARK:63,AT_SIGN:64,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLL_LOCK:145,FIRST_MEDIA_KEY:166,LAST_MEDIA_KEY:183,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,TILDE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,MAC_WK_CMD_LEFT:91,MAC_WK_CMD_RIGHT:93,WIN_IME:229,VK_NONAME:252,PHANTOM:255},n.Menu=function(){this.menuItems_=[],this.roleName_=this.element_=this.onKeyDownHandler_=this.mouseLeaveHandler_=this.mouseEnterHandler_=this.clickHandler_=this.mouseOverHandler_=this.highlightedItem_=this.openingCoords=null},n.Menu.prototype.addChild=function(t){this.menuItems_.push(t)},n.Menu.prototype.render=function(t){var e=document.createElement("div");e.className="blocklyMenu goog-menu blocklyNonSelectable",e.tabIndex=0,this.roleName_&&n.utils.aria.setRole(e,this.roleName_),this.element_=e;for(var i,o=0;i=this.menuItems_[o];o++)e.appendChild(i.createDom());this.mouseOverHandler_=n.bindEventWithChecks_(e,"mouseover",this,this.handleMouseOver_,!0),this.clickHandler_=n.bindEventWithChecks_(e,"click",this,this.handleClick_,!0),this.mouseEnterHandler_=n.bindEventWithChecks_(e,"mouseenter",this,this.handleMouseEnter_,!0),this.mouseLeaveHandler_=n.bindEventWithChecks_(e,"mouseleave",this,this.handleMouseLeave_,!0),this.onKeyDownHandler_=n.bindEventWithChecks_(e,"keydown",this,this.handleKeyEvent_),t.appendChild(e)},n.Menu.prototype.getElement=function(){return this.element_},n.Menu.prototype.focus=function(){var t=this.getElement();t&&(t.focus({preventScroll:!0}),n.utils.dom.addClass(t,"blocklyFocused"))},n.Menu.prototype.blur_=function(){var t=this.getElement();t&&(t.blur(),n.utils.dom.removeClass(t,"blocklyFocused"))},n.Menu.prototype.setRole=function(t){this.roleName_=t},n.Menu.prototype.dispose=function(){this.mouseOverHandler_&&(n.unbindEvent_(this.mouseOverHandler_),this.mouseOverHandler_=null),this.clickHandler_&&(n.unbindEvent_(this.clickHandler_),this.clickHandler_=null),this.mouseEnterHandler_&&(n.unbindEvent_(this.mouseEnterHandler_),this.mouseEnterHandler_=null),this.mouseLeaveHandler_&&(n.unbindEvent_(this.mouseLeaveHandler_),this.mouseLeaveHandler_=null),this.onKeyDownHandler_&&(n.unbindEvent_(this.onKeyDownHandler_),this.onKeyDownHandler_=null);for(var t,e=0;t=this.menuItems_[e];e++)t.dispose();this.element_=null},n.Menu.prototype.getMenuItem_=function(t){for(var e=this.getElement();t&&t!=e;){if(n.utils.dom.hasClass(t,"blocklyMenuItem"))for(var i,o=0;i=this.menuItems_[o];o++)if(i.getElement()==t)return i;t=t.parentElement}return null},n.Menu.prototype.setHighlighted=function(t){var e=this.highlightedItem_;e&&(e.setHighlighted(!1),this.highlightedItem_=null),t&&(t.setHighlighted(!0),this.highlightedItem_=t,e=this.getElement(),n.utils.style.scrollIntoContainerView(t.getElement(),e),n.utils.aria.setState(e,n.utils.aria.State.ACTIVEDESCENDANT,t.getId()))},n.Menu.prototype.highlightNext=function(){var t=this.menuItems_.indexOf(this.highlightedItem_);this.highlightHelper_(t,1)},n.Menu.prototype.highlightPrevious=function(){var t=this.menuItems_.indexOf(this.highlightedItem_);this.highlightHelper_(0>t?this.menuItems_.length:t,-1)},n.Menu.prototype.highlightFirst_=function(){this.highlightHelper_(-1,1)},n.Menu.prototype.highlightLast_=function(){this.highlightHelper_(this.menuItems_.length,-1)},n.Menu.prototype.highlightHelper_=function(t,e){t+=e;for(var n;n=this.menuItems_[t];){if(n.isEnabled()){this.setHighlighted(n);break}t+=e}},n.Menu.prototype.handleMouseOver_=function(t){(t=this.getMenuItem_(t.target))&&(t.isEnabled()?this.highlightedItem_!=t&&this.setHighlighted(t):this.setHighlighted(null))},n.Menu.prototype.handleClick_=function(t){var e=this.openingCoords;if(this.openingCoords=null,e&&"number"==typeof t.clientX){var i=new n.utils.Coordinate(t.clientX,t.clientY);if(1>n.utils.Coordinate.distance(e,i))return}(t=this.getMenuItem_(t.target))&&t.performAction()},n.Menu.prototype.handleMouseEnter_=function(t){this.focus()},n.Menu.prototype.handleMouseLeave_=function(t){this.getElement()&&(this.blur_(),this.setHighlighted(null))},n.Menu.prototype.handleKeyEvent_=function(t){if(this.menuItems_.length&&!(t.shiftKey||t.ctrlKey||t.metaKey||t.altKey)){var e=this.highlightedItem_;switch(t.keyCode){case n.utils.KeyCodes.ENTER:case n.utils.KeyCodes.SPACE:e&&e.performAction();break;case n.utils.KeyCodes.UP:this.highlightPrevious();break;case n.utils.KeyCodes.DOWN:this.highlightNext();break;case n.utils.KeyCodes.PAGE_UP:case n.utils.KeyCodes.HOME:this.highlightFirst_();break;case n.utils.KeyCodes.PAGE_DOWN:case n.utils.KeyCodes.END:this.highlightLast_();break;default:return}t.preventDefault(),t.stopPropagation()}},n.Menu.prototype.getSize=function(){var t=this.getElement(),e=n.utils.style.getSize(t);return e.height=t.scrollHeight,e},n.MenuItem=function(t,e){this.content_=t,this.value_=e,this.enabled_=!0,this.element_=null,this.rightToLeft_=!1,this.roleName_=null,this.highlight_=this.checked_=this.checkable_=!1,this.actionHandler_=null},n.MenuItem.prototype.createDom=function(){var t=document.createElement("div");t.id=n.utils.IdGenerator.getNextUniqueId(),this.element_=t,t.className="blocklyMenuItem goog-menuitem "+(this.enabled_?"":"blocklyMenuItemDisabled goog-menuitem-disabled ")+(this.checked_?"blocklyMenuItemSelected goog-option-selected ":"")+(this.highlight_?"blocklyMenuItemHighlight goog-menuitem-highlight ":"")+(this.rightToLeft_?"blocklyMenuItemRtl goog-menuitem-rtl ":"");var e=document.createElement("div");if(e.className="blocklyMenuItemContent goog-menuitem-content",this.checkable_){var i=document.createElement("div");i.className="blocklyMenuItemCheckbox goog-menuitem-checkbox",e.appendChild(i)}return i=this.content_,"string"==typeof this.content_&&(i=document.createTextNode(this.content_)),e.appendChild(i),t.appendChild(e),this.roleName_&&n.utils.aria.setRole(t,this.roleName_),n.utils.aria.setState(t,n.utils.aria.State.SELECTED,this.checkable_&&this.checked_||!1),n.utils.aria.setState(t,n.utils.aria.State.DISABLED,!this.enabled_),t},n.MenuItem.prototype.dispose=function(){this.element_=null},n.MenuItem.prototype.getElement=function(){return this.element_},n.MenuItem.prototype.getId=function(){return this.element_.id},n.MenuItem.prototype.getValue=function(){return this.value_},n.MenuItem.prototype.setRightToLeft=function(t){this.rightToLeft_=t},n.MenuItem.prototype.setRole=function(t){this.roleName_=t},n.MenuItem.prototype.setCheckable=function(t){this.checkable_=t},n.MenuItem.prototype.setChecked=function(t){this.checked_=t},n.MenuItem.prototype.setHighlighted=function(t){this.highlight_=t;var e=this.getElement();e&&this.isEnabled()&&(t?(n.utils.dom.addClass(e,"blocklyMenuItemHighlight"),n.utils.dom.addClass(e,"goog-menuitem-highlight")):(n.utils.dom.removeClass(e,"blocklyMenuItemHighlight"),n.utils.dom.removeClass(e,"goog-menuitem-highlight")))},n.MenuItem.prototype.isEnabled=function(){return this.enabled_},n.MenuItem.prototype.setEnabled=function(t){this.enabled_=t},n.MenuItem.prototype.performAction=function(){this.isEnabled()&&this.actionHandler_&&this.actionHandler_(this)},n.MenuItem.prototype.onAction=function(t,e){this.actionHandler_=t.bind(e)},n.ContextMenu={},n.ContextMenu.currentBlock=null,n.ContextMenu.menu_=null,n.ContextMenu.show=function(t,e,i){if(n.WidgetDiv.show(n.ContextMenu,i,n.ContextMenu.dispose),e.length){var o=n.ContextMenu.populate_(e,i);n.ContextMenu.menu_=o,n.ContextMenu.position_(o,t,i),setTimeout((function(){o.focus()}),1),n.ContextMenu.currentBlock=null}else n.ContextMenu.hide()},n.ContextMenu.populate_=function(t,e){var i=new n.Menu;i.setRole(n.utils.aria.Role.MENU);for(var o,r=0;o=t[r];r++){var s=new n.MenuItem(o.text);s.setRightToLeft(e),s.setRole(n.utils.aria.Role.MENUITEM),i.addChild(s),s.setEnabled(o.enabled),o.enabled&&s.onAction((function(t){n.ContextMenu.hide(),this.callback(this.scope)}),o)}return i},n.ContextMenu.position_=function(t,e,i){var o=n.utils.getViewportBBox();e=new n.utils.Rect(e.clientY+o.top,e.clientY+o.top,e.clientX+o.left,e.clientX+o.left),n.ContextMenu.createWidget_(t);var r=t.getSize();i&&(e.left+=r.width,e.right+=r.width,o.left+=r.width,o.right+=r.width),n.WidgetDiv.positionWithAnchor(o,e,r,i),t.focus()},n.ContextMenu.createWidget_=function(t){t.render(n.WidgetDiv.DIV);var e=t.getElement();n.utils.dom.addClass(e,"blocklyContextMenu"),n.bindEventWithChecks_(e,"contextmenu",null,n.utils.noEvent),t.focus()},n.ContextMenu.hide=function(){n.WidgetDiv.hideIfOwner(n.ContextMenu),n.ContextMenu.currentBlock=null},n.ContextMenu.dispose=function(){n.ContextMenu.menu_&&(n.ContextMenu.menu_.dispose(),n.ContextMenu.menu_=null)},n.ContextMenu.callbackFactory=function(t,e){return function(){n.Events.disable();try{var i=n.Xml.domToBlock(e,t.workspace),o=t.getRelativeToSurfaceXY();o.x=t.RTL?o.x-n.SNAP_RADIUS:o.x+n.SNAP_RADIUS,o.y+=2*n.SNAP_RADIUS,i.moveBy(o.x,o.y)}finally{n.Events.enable()}n.Events.isEnabled()&&!i.isShadow()&&n.Events.fire(new n.Events.BlockCreate(i)),i.select()}},n.ContextMenu.commentDeleteOption=function(t){return{text:n.Msg.REMOVE_COMMENT,enabled:!0,callback:function(){n.Events.setGroup(!0),t.dispose(!0,!0),n.Events.setGroup(!1)}}},n.ContextMenu.commentDuplicateOption=function(t){return{text:n.Msg.DUPLICATE_COMMENT,enabled:!0,callback:function(){n.duplicate(t)}}},n.ContextMenu.workspaceCommentOption=function(t,e){if(!n.WorkspaceCommentSvg)throw Error("Missing require for Blockly.WorkspaceCommentSvg");var i={enabled:!n.utils.userAgent.IE};return i.text=n.Msg.ADD_COMMENT,i.callback=function(){var i=new n.WorkspaceCommentSvg(t,n.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT,n.WorkspaceCommentSvg.DEFAULT_SIZE,n.WorkspaceCommentSvg.DEFAULT_SIZE),o=t.getInjectionDiv().getBoundingClientRect();o=new n.utils.Coordinate(e.clientX-o.left,e.clientY-o.top);var r=t.getOriginOffsetInPixels();(o=n.utils.Coordinate.difference(o,r)).scale(1/t.scale),i.moveBy(o.x,o.y),t.rendered&&(i.initSvg(),i.render(),i.select())},i},n.ContextMenuItems={},n.ContextMenuItems.registerUndo=function(){n.ContextMenuRegistry.registry.register({displayText:function(){return n.Msg.UNDO},preconditionFn:function(t){return 0<t.workspace.getUndoStack().length?"enabled":"disabled"},callback:function(t){t.workspace.undo(!1)},scopeType:n.ContextMenuRegistry.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1})},n.ContextMenuItems.registerRedo=function(){n.ContextMenuRegistry.registry.register({displayText:function(){return n.Msg.REDO},preconditionFn:function(t){return 0<t.workspace.getRedoStack().length?"enabled":"disabled"},callback:function(t){t.workspace.undo(!0)},scopeType:n.ContextMenuRegistry.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2})},n.ContextMenuItems.registerCleanup=function(){n.ContextMenuRegistry.registry.register({displayText:function(){return n.Msg.CLEAN_UP},preconditionFn:function(t){return t.workspace.isMovable()?1<t.workspace.getTopBlocks(!1).length?"enabled":"disabled":"hidden"},callback:function(t){t.workspace.cleanUp()},scopeType:n.ContextMenuRegistry.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3})},n.ContextMenuItems.toggleOption_=function(t,e){for(var n=0,i=0;i<e.length;i++)for(var o=e[i];o;)setTimeout(o.setCollapsed.bind(o,t),n),o=o.getNextBlock(),n+=10},n.ContextMenuItems.registerCollapse=function(){n.ContextMenuRegistry.registry.register({displayText:function(){return n.Msg.COLLAPSE_ALL},preconditionFn:function(t){if(t.workspace.options.collapse){t=t.workspace.getTopBlocks(!1);for(var e=0;e<t.length;e++)for(var n=t[e];n;){if(!n.isCollapsed())return"enabled";n=n.getNextBlock()}return"disabled"}return"hidden"},callback:function(t){n.ContextMenuItems.toggleOption_(!0,t.workspace.getTopBlocks(!0))},scopeType:n.ContextMenuRegistry.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4})},n.ContextMenuItems.registerExpand=function(){n.ContextMenuRegistry.registry.register({displayText:function(){return n.Msg.EXPAND_ALL},preconditionFn:function(t){if(t.workspace.options.collapse){t=t.workspace.getTopBlocks(!1);for(var e=0;e<t.length;e++)for(var n=t[e];n;){if(n.isCollapsed())return"enabled";n=n.getNextBlock()}return"disabled"}return"hidden"},callback:function(t){n.ContextMenuItems.toggleOption_(!1,t.workspace.getTopBlocks(!0))},scopeType:n.ContextMenuRegistry.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5})},n.ContextMenuItems.addDeletableBlocks_=function(t,e){if(t.isDeletable())Array.prototype.push.apply(e,t.getDescendants(!1));else{t=t.getChildren(!1);for(var i=0;i<t.length;i++)n.ContextMenuItems.addDeletableBlocks_(t[i],e)}},n.ContextMenuItems.getDeletableBlocks_=function(t){var e=[];t=t.getTopBlocks(!0);for(var i=0;i<t.length;i++)n.ContextMenuItems.addDeletableBlocks_(t[i],e);return e},n.ContextMenuItems.deleteNext_=function(t,e){n.Events.setGroup(e);var i=t.shift();i&&(i.workspace?(i.dispose(!1,!0),setTimeout(n.ContextMenuItems.deleteNext_,10,t,e)):n.ContextMenuItems.deleteNext_(t,e)),n.Events.setGroup(!1)},n.ContextMenuItems.registerDeleteAll=function(){n.ContextMenuRegistry.registry.register({displayText:function(t){if(t.workspace)return 1==(t=n.ContextMenuItems.getDeletableBlocks_(t.workspace).length)?n.Msg.DELETE_BLOCK:n.Msg.DELETE_X_BLOCKS.replace("%1",String(t))},preconditionFn:function(t){if(t.workspace)return 0<n.ContextMenuItems.getDeletableBlocks_(t.workspace).length?"enabled":"disabled"},callback:function(t){if(t.workspace){t.workspace.cancelCurrentGesture();var e=n.ContextMenuItems.getDeletableBlocks_(t.workspace),i=n.utils.genUid();2>e.length?n.ContextMenuItems.deleteNext_(e,i):n.confirm(n.Msg.DELETE_ALL_BLOCKS.replace("%1",e.length),(function(t){t&&n.ContextMenuItems.deleteNext_(e,i)}))}},scopeType:n.ContextMenuRegistry.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6})},n.ContextMenuItems.registerWorkspaceOptions_=function(){n.ContextMenuItems.registerUndo(),n.ContextMenuItems.registerRedo(),n.ContextMenuItems.registerCleanup(),n.ContextMenuItems.registerCollapse(),n.ContextMenuItems.registerExpand(),n.ContextMenuItems.registerDeleteAll()},n.ContextMenuItems.registerDuplicate=function(){n.ContextMenuRegistry.registry.register({displayText:function(){return n.Msg.DUPLICATE_BLOCK},preconditionFn:function(t){return!(t=t.block).isInFlyout&&t.isDeletable()&&t.isMovable()?t.isDuplicatable()?"enabled":"disabled":"hidden"},callback:function(t){t.block&&n.duplicate(t.block)},scopeType:n.ContextMenuRegistry.ScopeType.BLOCK,id:"blockDuplicate",weight:1})},n.ContextMenuItems.registerComment=function(){n.ContextMenuRegistry.registry.register({displayText:function(t){return t.block.getCommentIcon()?n.Msg.REMOVE_COMMENT:n.Msg.ADD_COMMENT},preconditionFn:function(t){return t=t.block,n.utils.userAgent.IE||t.isInFlyout||!t.workspace.options.comments||t.isCollapsed()||!t.isEditable()?"hidden":"enabled"},callback:function(t){(t=t.block).getCommentIcon()?t.setCommentText(null):t.setCommentText("")},scopeType:n.ContextMenuRegistry.ScopeType.BLOCK,id:"blockComment",weight:2})},n.ContextMenuItems.registerInline=function(){n.ContextMenuRegistry.registry.register({displayText:function(t){return t.block.getInputsInline()?n.Msg.EXTERNAL_INPUTS:n.Msg.INLINE_INPUTS},preconditionFn:function(t){if(!(t=t.block).isInFlyout&&t.isMovable()&&!t.isCollapsed())for(var e=1;e<t.inputList.length;e++)if(t.inputList[e-1].type!=n.NEXT_STATEMENT&&t.inputList[e].type!=n.NEXT_STATEMENT)return"enabled";return"hidden"},callback:function(t){t.block.setInputsInline(!t.block.getInputsInline())},scopeType:n.ContextMenuRegistry.ScopeType.BLOCK,id:"blockInline",weight:3})},n.ContextMenuItems.registerCollapseExpandBlock=function(){n.ContextMenuRegistry.registry.register({displayText:function(t){return t.block.isCollapsed()?n.Msg.EXPAND_BLOCK:n.Msg.COLLAPSE_BLOCK},preconditionFn:function(t){return!(t=t.block).isInFlyout&&t.isMovable()?"enabled":"hidden"},callback:function(t){t.block.setCollapsed(!t.block.isCollapsed())},scopeType:n.ContextMenuRegistry.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4})},n.ContextMenuItems.registerDisable=function(){n.ContextMenuRegistry.registry.register({displayText:function(t){return t.block.isEnabled()?n.Msg.DISABLE_BLOCK:n.Msg.ENABLE_BLOCK},preconditionFn:function(t){return!(t=t.block).isInFlyout&&t.workspace.options.disable&&t.isEditable()?t.getInheritedDisabled()?"disabled":"enabled":"hidden"},callback:function(t){t=t.block;var e=n.Events.getGroup();e||n.Events.setGroup(!0),t.setEnabled(!t.isEnabled()),e||n.Events.setGroup(!1)},scopeType:n.ContextMenuRegistry.ScopeType.BLOCK,id:"blockDisable",weight:5})},n.ContextMenuItems.registerDelete=function(){n.ContextMenuRegistry.registry.register({displayText:function(t){var e=t.block;return t=e.getDescendants(!1).length,(e=e.getNextBlock())&&(t-=e.getDescendants(!1).length),1==t?n.Msg.DELETE_BLOCK:n.Msg.DELETE_X_BLOCKS.replace("%1",String(t))},preconditionFn:function(t){return!t.block.isInFlyout&&t.block.isDeletable()?"enabled":"hidden"},callback:function(t){n.Events.setGroup(!0),t.block.dispose(!0,!0),n.Events.setGroup(!1)},scopeType:n.ContextMenuRegistry.ScopeType.BLOCK,id:"blockDelete",weight:6})},n.ContextMenuItems.registerHelp=function(){n.ContextMenuRegistry.registry.register({displayText:function(){return n.Msg.HELP},preconditionFn:function(t){return("function"==typeof(t=t.block).helpUrl?t.helpUrl():t.helpUrl)?"enabled":"hidden"},callback:function(t){t.block.showHelp()},scopeType:n.ContextMenuRegistry.ScopeType.BLOCK,id:"blockHelp",weight:7})},n.ContextMenuItems.registerBlockOptions_=function(){n.ContextMenuItems.registerDuplicate(),n.ContextMenuItems.registerComment(),n.ContextMenuItems.registerInline(),n.ContextMenuItems.registerCollapseExpandBlock(),n.ContextMenuItems.registerDisable(),n.ContextMenuItems.registerDelete(),n.ContextMenuItems.registerHelp()},n.ContextMenuItems.registerDefaultOptions=function(){n.ContextMenuItems.registerWorkspaceOptions_(),n.ContextMenuItems.registerBlockOptions_()},n.ContextMenuRegistry=function(){n.ContextMenuRegistry.registry=this,this.registry_={},n.ContextMenuItems.registerDefaultOptions()},n.ContextMenuRegistry.ScopeType={BLOCK:"block",WORKSPACE:"workspace"},n.ContextMenuRegistry.registry=null,n.ContextMenuRegistry.prototype.register=function(t){if(this.registry_[t.id])throw Error('Menu item with id "'+t.id+'" is already registered.');this.registry_[t.id]=t},n.ContextMenuRegistry.prototype.unregister=function(t){if(!this.registry_[t])throw Error('Menu item with id "'+t+'" not found.');delete this.registry_[t]},n.ContextMenuRegistry.prototype.getItem=function(t){return this.registry_[t]?this.registry_[t]:null},n.ContextMenuRegistry.prototype.getContextMenuOptions=function(t,e){var n=[],i=this.registry_;return Object.keys(i).forEach((function(o){if(o=i[o],t==o.scopeType){var r=o.preconditionFn(e);"hidden"!=r&&(o={text:"function"==typeof o.displayText?o.displayText(e):o.displayText,enabled:"enabled"==r,callback:o.callback,scope:e,weight:o.weight},n.push(o))}})),n.sort((function(t,e){return t.weight-e.weight})),n},new n.ContextMenuRegistry,n.Events.Selected=function(t,e,i){n.Events.Selected.superClass_.constructor.call(this,i),this.oldElementId=t,this.newElementId=e},n.utils.object.inherits(n.Events.Selected,n.Events.UiBase),n.Events.Selected.prototype.type=n.Events.SELECTED,n.Events.Selected.prototype.toJson=function(){var t=n.Events.Selected.superClass_.toJson.call(this);return t.oldElementId=this.oldElementId,t.newElementId=this.newElementId,t},n.Events.Selected.prototype.fromJson=function(t){n.Events.Selected.superClass_.fromJson.call(this,t),this.oldElementId=t.oldElementId,this.newElementId=t.newElementId},n.registry.register(n.registry.Type.EVENT,n.Events.SELECTED,n.Events.Selected),n.RenderedConnection=function(t,e){n.RenderedConnection.superClass_.constructor.call(this,t,e),this.db_=t.workspace.connectionDBList[e],this.dbOpposite_=t.workspace.connectionDBList[n.OPPOSITE_TYPE[e]],this.offsetInBlock_=new n.utils.Coordinate(0,0),this.trackedState_=n.RenderedConnection.TrackedState.WILL_TRACK,this.targetConnection=null},n.utils.object.inherits(n.RenderedConnection,n.Connection),n.RenderedConnection.TrackedState={WILL_TRACK:-1,UNTRACKED:0,TRACKED:1},n.RenderedConnection.prototype.dispose=function(){n.RenderedConnection.superClass_.dispose.call(this),this.trackedState_==n.RenderedConnection.TrackedState.TRACKED&&this.db_.removeConnection(this,this.y)},n.RenderedConnection.prototype.getSourceBlock=function(){return n.RenderedConnection.superClass_.getSourceBlock.call(this)},n.RenderedConnection.prototype.targetBlock=function(){return n.RenderedConnection.superClass_.targetBlock.call(this)},n.RenderedConnection.prototype.distanceFrom=function(t){var e=this.x-t.x;return t=this.y-t.y,Math.sqrt(e*e+t*t)},n.RenderedConnection.prototype.bumpAwayFrom=function(t){if(!this.sourceBlock_.workspace.isDragging()){var e=this.sourceBlock_.getRootBlock();if(!e.isInFlyout){var i=!1;if(!e.isMovable()){if(!(e=t.getSourceBlock().getRootBlock()).isMovable())return;t=this,i=!0}var o=n.selected==e;o||e.addSelect();var r=t.x+n.SNAP_RADIUS+Math.floor(Math.random()*n.BUMP_RANDOMNESS)-this.x,s=t.y+n.SNAP_RADIUS+Math.floor(Math.random()*n.BUMP_RANDOMNESS)-this.y;i&&(s=-s),e.RTL&&(r=t.x-n.SNAP_RADIUS-Math.floor(Math.random()*n.BUMP_RANDOMNESS)-this.x),e.moveBy(r,s),o||e.removeSelect()}}},n.RenderedConnection.prototype.moveTo=function(t,e){this.trackedState_==n.RenderedConnection.TrackedState.WILL_TRACK?(this.db_.addConnection(this,e),this.trackedState_=n.RenderedConnection.TrackedState.TRACKED):this.trackedState_==n.RenderedConnection.TrackedState.TRACKED&&(this.db_.removeConnection(this,this.y),this.db_.addConnection(this,e)),this.x=t,this.y=e},n.RenderedConnection.prototype.moveBy=function(t,e){this.moveTo(this.x+t,this.y+e)},n.RenderedConnection.prototype.moveToOffset=function(t){this.moveTo(t.x+this.offsetInBlock_.x,t.y+this.offsetInBlock_.y)},n.RenderedConnection.prototype.setOffsetInBlock=function(t,e){this.offsetInBlock_.x=t,this.offsetInBlock_.y=e},n.RenderedConnection.prototype.getOffsetInBlock=function(){return this.offsetInBlock_},n.RenderedConnection.prototype.tighten=function(){var t=this.targetConnection.x-this.x,e=this.targetConnection.y-this.y;if(0!=t||0!=e){var i=this.targetBlock(),o=i.getSvgRoot();if(!o)throw Error("block is not rendered.");o=n.utils.getRelativeXY(o),i.getSvgRoot().setAttribute("transform","translate("+(o.x-t)+","+(o.y-e)+")"),i.moveConnections(-t,-e)}},n.RenderedConnection.prototype.closest=function(t,e){return this.dbOpposite_.searchForClosest(this,t,e)},n.RenderedConnection.prototype.highlight=function(){var t=this.sourceBlock_.workspace.getRenderer().getConstants(),e=t.shapeFor(this);this.type==n.INPUT_VALUE||this.type==n.OUTPUT_VALUE?(t=t.TAB_OFFSET_FROM_TOP,e=n.utils.svgPaths.moveBy(0,-t)+n.utils.svgPaths.lineOnAxis("v",t)+e.pathDown+n.utils.svgPaths.lineOnAxis("v",t)):(t=t.NOTCH_OFFSET_LEFT-t.CORNER_RADIUS,e=n.utils.svgPaths.moveBy(-t,0)+n.utils.svgPaths.lineOnAxis("h",t)+e.pathLeft+n.utils.svgPaths.lineOnAxis("h",t)),t=this.sourceBlock_.getRelativeToSurfaceXY(),n.Connection.highlightedPath_=n.utils.dom.createSvgElement(n.utils.Svg.PATH,{class:"blocklyHighlightedConnectionPath",d:e,transform:"translate("+(this.x-t.x)+","+(this.y-t.y)+")"+(this.sourceBlock_.RTL?" scale(-1 1)":"")},this.sourceBlock_.getSvgRoot())},n.RenderedConnection.prototype.unhighlight=function(){n.utils.dom.removeNode(n.Connection.highlightedPath_),delete n.Connection.highlightedPath_},n.RenderedConnection.prototype.setTracking=function(t){t&&this.trackedState_==n.RenderedConnection.TrackedState.TRACKED||!t&&this.trackedState_==n.RenderedConnection.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(t?(this.db_.addConnection(this,this.y),this.trackedState_=n.RenderedConnection.TrackedState.TRACKED):(this.trackedState_==n.RenderedConnection.TrackedState.TRACKED&&this.db_.removeConnection(this,this.y),this.trackedState_=n.RenderedConnection.TrackedState.UNTRACKED))},n.RenderedConnection.prototype.stopTrackingAll=function(){if(this.setTracking(!1),this.targetConnection)for(var t=this.targetBlock().getDescendants(!1),e=0;e<t.length;e++){for(var n=t[e],i=n.getConnections_(!0),o=0;o<i.length;o++)i[o].setTracking(!1);for(n=n.getIcons(),o=0;o<n.length;o++)n[o].setVisible(!1)}},n.RenderedConnection.prototype.startTrackingAll=function(){this.setTracking(!0);var t=[];if(this.type!=n.INPUT_VALUE&&this.type!=n.NEXT_STATEMENT)return t;var e=this.targetBlock();if(e){if(e.isCollapsed()){var i=[];e.outputConnection&&i.push(e.outputConnection),e.nextConnection&&i.push(e.nextConnection),e.previousConnection&&i.push(e.previousConnection)}else i=e.getConnections_(!0);for(var o=0;o<i.length;o++)t.push.apply(t,i[o].startTrackingAll());t.length||(t[0]=e)}return t},n.RenderedConnection.prototype.isConnectionAllowed=function(t,e){return n.utils.deprecation.warn("RenderedConnection.prototype.isConnectionAllowed","July 2020","July 2021","Blockly.Workspace.prototype.getConnectionChecker().canConnect"),!(this.distanceFrom(t)>e)&&n.RenderedConnection.superClass_.isConnectionAllowed.call(this,t)},n.RenderedConnection.prototype.onFailedConnect=function(t){this.bumpAwayFrom(t)},n.RenderedConnection.prototype.disconnectInternal_=function(t,e){n.RenderedConnection.superClass_.disconnectInternal_.call(this,t,e),t.rendered&&t.render(),e.rendered&&(e.updateDisabled(),e.render(),e.getSvgRoot().style.display="block")},n.RenderedConnection.prototype.respawnShadow_=function(){n.RenderedConnection.superClass_.respawnShadow_.call(this);var t=this.targetBlock();t&&(t.initSvg(),t.render(!1),(t=this.getSourceBlock()).rendered&&t.render())},n.RenderedConnection.prototype.neighbours=function(t){return this.dbOpposite_.getNeighbours(this,t)},n.RenderedConnection.prototype.connect_=function(t){n.RenderedConnection.superClass_.connect_.call(this,t);var e=this.getSourceBlock();t=t.getSourceBlock();var i=e.rendered,o=t.rendered;i&&e.updateDisabled(),o&&t.updateDisabled(),i&&o&&(this.type==n.NEXT_STATEMENT||this.type==n.PREVIOUS_STATEMENT?t.render():e.render()),(e=e.getInputWithBlock(t))&&(e=e.isVisible(),t.getSvgRoot().style.display=e?"block":"none")},n.RenderedConnection.prototype.onCheckChanged_=function(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||((this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug(),this.sourceBlock_.bumpNeighbours())},n.Marker=function(){this.drawer_=this.curNode_=this.colour=null,this.type="marker"},n.Marker.prototype.setDrawer=function(t){this.drawer_=t},n.Marker.prototype.getDrawer=function(){return this.drawer_},n.Marker.prototype.getCurNode=function(){return this.curNode_},n.Marker.prototype.setCurNode=function(t){var e=this.curNode_;this.curNode_=t,this.drawer_&&this.drawer_.draw(e,this.curNode_)},n.Marker.prototype.draw=function(){this.drawer_&&this.drawer_.draw(this.curNode_,this.curNode_)},n.Marker.prototype.hide=function(){this.drawer_&&this.drawer_.hide()},n.Marker.prototype.dispose=function(){this.getDrawer()&&this.getDrawer().dispose()},n.Cursor=function(){n.Cursor.superClass_.constructor.call(this),this.type="cursor"},n.utils.object.inherits(n.Cursor,n.Marker),n.Cursor.prototype.next=function(){var t=this.getCurNode();if(!t)return null;for(t=t.next();t&&t.next()&&(t.getType()==n.ASTNode.types.NEXT||t.getType()==n.ASTNode.types.BLOCK);)t=t.next();return t&&this.setCurNode(t),t},n.Cursor.prototype.in=function(){var t=this.getCurNode();return t?(t.getType()!=n.ASTNode.types.PREVIOUS&&t.getType()!=n.ASTNode.types.OUTPUT||(t=t.next()),(t=t.in())&&this.setCurNode(t),t):null},n.Cursor.prototype.prev=function(){var t=this.getCurNode();if(!t)return null;for(t=t.prev();t&&t.prev()&&(t.getType()==n.ASTNode.types.NEXT||t.getType()==n.ASTNode.types.BLOCK);)t=t.prev();return t&&this.setCurNode(t),t},n.Cursor.prototype.out=function(){var t=this.getCurNode();return t?((t=t.out())&&t.getType()==n.ASTNode.types.BLOCK&&(t=t.prev()||t),t&&this.setCurNode(t),t):null},n.Cursor.prototype.onBlocklyAction=function(t){if(this.getCurNode()&&this.getCurNode().getType()===n.ASTNode.types.FIELD&&this.getCurNode().getLocation().onBlocklyAction(t))return!0;switch(t.name){case n.navigation.actionNames.PREVIOUS:return this.prev(),!0;case n.navigation.actionNames.OUT:return this.out(),!0;case n.navigation.actionNames.NEXT:return this.next(),!0;case n.navigation.actionNames.IN:return this.in(),!0;default:return!1}},n.BasicCursor=function(){n.BasicCursor.superClass_.constructor.call(this)},n.utils.object.inherits(n.BasicCursor,n.Cursor),n.BasicCursor.prototype.next=function(){var t=this.getCurNode();return t?((t=this.getNextNode_(t,this.validNode_))&&this.setCurNode(t),t):null},n.BasicCursor.prototype.in=function(){return this.next()},n.BasicCursor.prototype.prev=function(){var t=this.getCurNode();return t?((t=this.getPreviousNode_(t,this.validNode_))&&this.setCurNode(t),t):null},n.BasicCursor.prototype.out=function(){return this.prev()},n.BasicCursor.prototype.getNextNode_=function(t,e){if(!t)return null;var n=t.in()||t.next();return e(n)?n:n?this.getNextNode_(n,e):e(t=this.findSiblingOrParent_(t.out()))?t:t?this.getNextNode_(t,e):null},n.BasicCursor.prototype.getPreviousNode_=function(t,e){if(!t)return null;var n=t.prev();return e(n=n?this.getRightMostChild_(n):t.out())?n:n?this.getPreviousNode_(n,e):null},n.BasicCursor.prototype.validNode_=function(t){var e=!1;return(t=t&&t.getType())!=n.ASTNode.types.OUTPUT&&t!=n.ASTNode.types.INPUT&&t!=n.ASTNode.types.FIELD&&t!=n.ASTNode.types.NEXT&&t!=n.ASTNode.types.PREVIOUS&&t!=n.ASTNode.types.WORKSPACE||(e=!0),e},n.BasicCursor.prototype.findSiblingOrParent_=function(t){if(!t)return null;var e=t.next();return e||this.findSiblingOrParent_(t.out())},n.BasicCursor.prototype.getRightMostChild_=function(t){if(!t.in())return t;for(t=t.in();t.next();)t=t.next();return this.getRightMostChild_(t)},n.TabNavigateCursor=function(){n.TabNavigateCursor.superClass_.constructor.call(this)},n.utils.object.inherits(n.TabNavigateCursor,n.BasicCursor),n.TabNavigateCursor.prototype.validNode_=function(t){var e=!1,i=t&&t.getType();return t&&(t=t.getLocation(),i==n.ASTNode.types.FIELD&&t&&t.isTabNavigable()&&t.isClickable()&&(e=!0)),e},n.BlockSvg=function(t,e,i){this.svgGroup_=n.utils.dom.createSvgElement(n.utils.Svg.G,{},null),this.svgGroup_.translate_="",this.style=t.getRenderer().getConstants().getBlockStyle(null),this.pathObject=t.getRenderer().makePathObject(this.svgGroup_,this.style),this.renderIsInProgress_=this.rendered=!1,this.workspace=t,this.previousConnection=this.nextConnection=this.outputConnection=null,this.useDragSurface_=n.utils.is3dSupported()&&!!t.getBlockDragSurface();var o=this.pathObject.svgPath;o.tooltip=this,n.Tooltip.bindMouseEvents(o),n.BlockSvg.superClass_.constructor.call(this,t,e,i),this.svgGroup_.dataset?this.svgGroup_.dataset.id=this.id:n.utils.userAgent.IE&&this.svgGroup_.setAttribute("data-id",this.id)},n.utils.object.inherits(n.BlockSvg,n.Block),n.BlockSvg.prototype.height=0,n.BlockSvg.prototype.width=0,n.BlockSvg.prototype.warningTextDb_=null,n.BlockSvg.INLINE=-1,n.BlockSvg.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_",n.BlockSvg.prototype.initSvg=function(){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");for(var t,e=0;t=this.inputList[e];e++)t.init();for(t=this.getIcons(),e=0;e<t.length;e++)t[e].createIcon();this.applyColour(),this.pathObject.updateMovable(this.isMovable()),e=this.getSvgRoot(),this.workspace.options.readOnly||this.eventsInit_||!e||n.bindEventWithChecks_(e,"mousedown",this,this.onMouseDown_),this.eventsInit_=!0,e.parentNode||this.workspace.getCanvas().appendChild(e)},n.BlockSvg.prototype.getColourSecondary=function(){return this.style.colourSecondary},n.BlockSvg.prototype.getColourTertiary=function(){return this.style.colourTertiary},n.BlockSvg.prototype.getColourShadow=function(){return n.utils.deprecation.warn("BlockSvg.prototype.getColourShadow","January 2020","January 2021","style.colourSecondary"),this.getColourSecondary()},n.BlockSvg.prototype.getColourBorder=function(){return n.utils.deprecation.warn("BlockSvg.prototype.getColourBorder","January 2020","January 2021","style.colourTertiary"),{colourBorder:this.getColourTertiary(),colourLight:null,colourDark:null}},n.BlockSvg.prototype.select=function(){if(this.isShadow()&&this.getParent())this.getParent().select();else if(n.selected!=this){var t=null;if(n.selected){t=n.selected.id,n.Events.disable();try{n.selected.unselect()}finally{n.Events.enable()}}t=new n.Events.Selected(t,this.id,this.workspace.id),n.Events.fire(t),n.selected=this,this.addSelect()}},n.BlockSvg.prototype.unselect=function(){if(n.selected==this){var t=new n.Events.Selected(this.id,null,this.workspace.id);t.workspaceId=this.workspace.id,n.Events.fire(t),n.selected=null,this.removeSelect()}},n.BlockSvg.prototype.mutator=null,n.BlockSvg.prototype.comment=null,n.BlockSvg.prototype.commentIcon_=null,n.BlockSvg.prototype.warning=null,n.BlockSvg.prototype.getIcons=function(){var t=[];return this.mutator&&t.push(this.mutator),this.commentIcon_&&t.push(this.commentIcon_),this.warning&&t.push(this.warning),t},n.BlockSvg.prototype.setParent=function(t){var e=this.parentBlock_;if(t!=e){n.utils.dom.startTextWidthCache(),n.BlockSvg.superClass_.setParent.call(this,t),n.utils.dom.stopTextWidthCache();var i=this.getSvgRoot();if(!this.workspace.isClearing&&i){var o=this.getRelativeToSurfaceXY();t?(t.getSvgRoot().appendChild(i),t=this.getRelativeToSurfaceXY(),this.moveConnections(t.x-o.x,t.y-o.y)):e&&(this.workspace.getCanvas().appendChild(i),this.translate(o.x,o.y)),this.applyColour()}}},n.BlockSvg.prototype.getRelativeToSurfaceXY=function(){var t=0,e=0,i=this.useDragSurface_?this.workspace.getBlockDragSurface().getGroup():null,o=this.getSvgRoot();if(o)do{var r=n.utils.getRelativeXY(o);t+=r.x,e+=r.y,this.useDragSurface_&&this.workspace.getBlockDragSurface().getCurrentBlock()==o&&(t+=(r=this.workspace.getBlockDragSurface().getSurfaceTranslation()).x,e+=r.y),o=o.parentNode}while(o&&o!=this.workspace.getCanvas()&&o!=i);return new n.utils.Coordinate(t,e)},n.BlockSvg.prototype.moveBy=function(t,e){if(this.parentBlock_)throw Error("Block has parent.");var i=n.Events.isEnabled();if(i)var o=new n.Events.BlockMove(this);var r=this.getRelativeToSurfaceXY();this.translate(r.x+t,r.y+e),this.moveConnections(t,e),i&&(o.recordNew(),n.Events.fire(o)),this.workspace.resizeContents()},n.BlockSvg.prototype.translate=function(t,e){this.getSvgRoot().setAttribute("transform","translate("+t+","+e+")")},n.BlockSvg.prototype.moveToDragSurface=function(){if(this.useDragSurface_){var t=this.getRelativeToSurfaceXY();this.clearTransformAttributes_(),this.workspace.getBlockDragSurface().translateSurface(t.x,t.y),(t=this.getSvgRoot())&&this.workspace.getBlockDragSurface().setBlocksAndShow(t)}},n.BlockSvg.prototype.moveTo=function(t){var e=this.getRelativeToSurfaceXY();this.moveBy(t.x-e.x,t.y-e.y)},n.BlockSvg.prototype.moveOffDragSurface=function(t){this.useDragSurface_&&(this.translate(t.x,t.y),this.workspace.getBlockDragSurface().clearAndHide(this.workspace.getCanvas()))},n.BlockSvg.prototype.moveDuringDrag=function(t){this.useDragSurface_?this.workspace.getBlockDragSurface().translateSurface(t.x,t.y):(this.svgGroup_.translate_="translate("+t.x+","+t.y+")",this.svgGroup_.setAttribute("transform",this.svgGroup_.translate_+this.svgGroup_.skew_))},n.BlockSvg.prototype.clearTransformAttributes_=function(){this.getSvgRoot().removeAttribute("transform")},n.BlockSvg.prototype.snapToGrid=function(){if(this.workspace&&!this.workspace.isDragging()&&!this.getParent()&&!this.isInFlyout){var t=this.workspace.getGrid();if(t&&t.shouldSnap()){var e=t.getSpacing(),n=e/2,i=this.getRelativeToSurfaceXY();t=Math.round((i.x-n)/e)*e+n-i.x,e=Math.round((i.y-n)/e)*e+n-i.y,t=Math.round(t),e=Math.round(e),0==t&&0==e||this.moveBy(t,e)}}},n.BlockSvg.prototype.getBoundingRectangle=function(){var t=this.getRelativeToSurfaceXY(),e=this.getHeightWidth();if(this.RTL)var i=t.x-e.width,o=t.x;else i=t.x,o=t.x+e.width;return new n.utils.Rect(t.y,t.y+e.height,i,o)},n.BlockSvg.prototype.markDirty=function(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(var t,e=0;t=this.inputList[e];e++)t.markDirty()},n.BlockSvg.prototype.setCollapsed=function(t){this.collapsed_!=t&&(n.BlockSvg.superClass_.setCollapsed.call(this,t),t?this.rendered&&this.render():this.updateCollapsed_())},n.BlockSvg.prototype.updateCollapsed_=function(){for(var t,e=this.isCollapsed(),i=n.Block.COLLAPSED_INPUT_NAME,o=n.Block.COLLAPSED_FIELD_NAME,r=0;t=this.inputList[r];r++)t.name!=i&&t.setVisible(!e);if(e){for(t=this.getIcons(),r=0;e=t[r];r++)e.setVisible(!1);r=this.toString(n.COLLAPSE_CHARS),(t=this.getField(o))?t.setValue(r):(t=this.getInput(i)||this.appendDummyInput(i)).appendField(new n.FieldLabel(r),o)}else this.removeInput(i)},n.BlockSvg.prototype.tab=function(t,e){var i=new n.TabNavigateCursor;i.setCurNode(n.ASTNode.createFieldNode(t)),t=i.getCurNode(),i.onBlocklyAction({name:e?n.navigation.actionNames.NEXT:n.navigation.actionNames.PREVIOUS}),(e=i.getCurNode())&&e!==t&&(e.getLocation().showEditor(),this.workspace.keyboardAccessibilityMode&&this.workspace.getCursor().setCurNode(e))},n.BlockSvg.prototype.onMouseDown_=function(t){var e=this.workspace&&this.workspace.getGesture(t);e&&e.handleBlockStart(t,this)},n.BlockSvg.prototype.showHelp=function(){var t="function"==typeof this.helpUrl?this.helpUrl():this.helpUrl;t&&window.open(t)},n.BlockSvg.prototype.generateContextMenu=function(){if(this.workspace.options.readOnly||!this.contextMenu)return null;var t=n.ContextMenuRegistry.registry.getContextMenuOptions(n.ContextMenuRegistry.ScopeType.BLOCK,{block:this});return this.customContextMenu&&this.customContextMenu(t),t},n.BlockSvg.prototype.showContextMenu=function(t){var e=this.generateContextMenu();e&&e.length&&(n.ContextMenu.show(t,e,this.RTL),n.ContextMenu.currentBlock=this)},n.BlockSvg.prototype.moveConnections=function(t,e){if(this.rendered){for(var n=this.getConnections_(!1),i=0;i<n.length;i++)n[i].moveBy(t,e);for(n=this.getIcons(),i=0;i<n.length;i++)n[i].computeIconLocation();for(i=0;i<this.childBlocks_.length;i++)this.childBlocks_[i].moveConnections(t,e)}},n.BlockSvg.prototype.setDragging=function(t){if(t){var e=this.getSvgRoot();e.translate_="",e.skew_="",n.draggingConnections=n.draggingConnections.concat(this.getConnections_(!0)),n.utils.dom.addClass(this.svgGroup_,"blocklyDragging")}else n.draggingConnections=[],n.utils.dom.removeClass(this.svgGroup_,"blocklyDragging");for(e=0;e<this.childBlocks_.length;e++)this.childBlocks_[e].setDragging(t)},n.BlockSvg.prototype.setMovable=function(t){n.BlockSvg.superClass_.setMovable.call(this,t),this.pathObject.updateMovable(t)},n.BlockSvg.prototype.setEditable=function(t){n.BlockSvg.superClass_.setEditable.call(this,t),t=this.getIcons();for(var e=0;e<t.length;e++)t[e].updateEditable()},n.BlockSvg.prototype.setShadow=function(t){n.BlockSvg.superClass_.setShadow.call(this,t),this.applyColour()},n.BlockSvg.prototype.setInsertionMarker=function(t){this.isInsertionMarker_!=t&&(this.isInsertionMarker_=t)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(!0))},n.BlockSvg.prototype.getSvgRoot=function(){return this.svgGroup_},n.BlockSvg.prototype.dispose=function(t,e){if(this.workspace){n.Tooltip.dispose(),n.Tooltip.unbindMouseEvents(this.pathObject.svgPath),n.utils.dom.startTextWidthCache();var i=this.workspace;if(n.selected==this&&(this.unselect(),this.workspace.cancelCurrentGesture()),n.ContextMenu.currentBlock==this&&n.ContextMenu.hide(),this.workspace.keyboardAccessibilityMode&&n.navigation.moveCursorOnBlockDelete(this),e&&this.rendered&&(this.unplug(t),n.blockAnimations.disposeUiEffect(this)),this.rendered=!1,this.warningTextDb_){for(var o in this.warningTextDb_)clearTimeout(this.warningTextDb_[o]);this.warningTextDb_=null}for(e=this.getIcons(),o=0;o<e.length;o++)e[o].dispose();n.BlockSvg.superClass_.dispose.call(this,!!t),n.utils.dom.removeNode(this.svgGroup_),i.resizeContents(),this.svgGroup_=null,n.utils.dom.stopTextWidthCache()}},n.BlockSvg.prototype.toCopyData=function(){if(this.isInsertionMarker_)return null;var t=n.Xml.blockToDom(this,!0);n.Xml.deleteNext(t);var e=this.getRelativeToSurfaceXY();return t.setAttribute("x",this.RTL?-e.x:e.x),t.setAttribute("y",e.y),{xml:t,source:this.workspace,typeCounts:n.utils.getBlockTypeCounts(this,!0)}},n.BlockSvg.prototype.applyColour=function(){this.pathObject.applyColour(this);for(var t=this.getIcons(),e=0;e<t.length;e++)t[e].applyColour();for(t=0;e=this.inputList[t];t++)for(var n,i=0;n=e.fieldRow[i];i++)n.applyColour()},n.BlockSvg.prototype.updateDisabled=function(){var t=this.getChildren(!1);if(this.applyColour(),!this.isCollapsed())for(var e,n=0;e=t[n];n++)e.rendered&&e.updateDisabled()},n.BlockSvg.prototype.getCommentIcon=function(){return this.commentIcon_},n.BlockSvg.prototype.setCommentText=function(t){if(!n.Comment)throw Error("Missing require for Blockly.Comment");this.commentModel.text!=t&&(n.BlockSvg.superClass_.setCommentText.call(this,t),t=null!=t,!!this.commentIcon_==t?this.commentIcon_.updateText():(t?this.comment=this.commentIcon_=new n.Comment(this):(this.commentIcon_.dispose(),this.comment=this.commentIcon_=null),this.rendered&&(this.render(),this.bumpNeighbours())))},n.BlockSvg.prototype.setWarningText=function(t,e){if(!n.Warning)throw Error("Missing require for Blockly.Warning");this.warningTextDb_||(this.warningTextDb_=Object.create(null));var i=e||"";if(i)this.warningTextDb_[i]&&(clearTimeout(this.warningTextDb_[i]),delete this.warningTextDb_[i]);else for(var o in this.warningTextDb_)clearTimeout(this.warningTextDb_[o]),delete this.warningTextDb_[o];if(this.workspace.isDragging()){var r=this;this.warningTextDb_[i]=setTimeout((function(){r.workspace&&(delete r.warningTextDb_[i],r.setWarningText(t,i))}),100)}else{if(this.isInFlyout&&(t=null),e=!1,"string"==typeof t){o=this.getSurroundParent();for(var s=null;o;)o.isCollapsed()&&(s=o),o=o.getSurroundParent();s&&s.setWarningText(n.Msg.COLLAPSED_WARNINGS_WARNING,n.BlockSvg.COLLAPSED_WARNING_ID),this.warning||(this.warning=new n.Warning(this),e=!0),this.warning.setText(t,i)}else this.warning&&!i?(this.warning.dispose(),e=!0):this.warning&&(e=this.warning.getText(),this.warning.setText("",i),(o=this.warning.getText())||this.warning.dispose(),e=e!=o);e&&this.rendered&&(this.render(),this.bumpNeighbours())}},n.BlockSvg.prototype.setMutator=function(t){this.mutator&&this.mutator!==t&&this.mutator.dispose(),t&&(t.setBlock(this),this.mutator=t,t.createIcon()),this.rendered&&(this.render(),this.bumpNeighbours())},n.BlockSvg.prototype.setEnabled=function(t){this.isEnabled()!=t&&(n.BlockSvg.superClass_.setEnabled.call(this,t),this.rendered&&!this.getInheritedDisabled()&&this.updateDisabled())},n.BlockSvg.prototype.setHighlighted=function(t){this.rendered&&this.pathObject.updateHighlighted(t)},n.BlockSvg.prototype.addSelect=function(){this.pathObject.updateSelected(!0)},n.BlockSvg.prototype.removeSelect=function(){this.pathObject.updateSelected(!1)},n.BlockSvg.prototype.setDeleteStyle=function(t){this.pathObject.updateDraggingDelete(t)},n.BlockSvg.prototype.getColour=function(){return this.style.colourPrimary},n.BlockSvg.prototype.setColour=function(t){n.BlockSvg.superClass_.setColour.call(this,t),t=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_),this.pathObject.setStyle(t.style),this.style=t.style,this.styleName_=t.name,this.applyColour()},n.BlockSvg.prototype.setStyle=function(t){var e=this.workspace.getRenderer().getConstants().getBlockStyle(t);if(this.styleName_=t,!e)throw Error("Invalid style name: "+t);this.hat=e.hat,this.pathObject.setStyle(e),this.colour_=e.colourPrimary,this.style=e,this.applyColour()},n.BlockSvg.prototype.bringToFront=function(){var t=this;do{var e=t.getSvgRoot(),n=e.parentNode,i=n.childNodes;i[i.length-1]!==e&&n.appendChild(e),t=t.getParent()}while(t)},n.BlockSvg.prototype.setPreviousStatement=function(t,e){n.BlockSvg.superClass_.setPreviousStatement.call(this,t,e),this.rendered&&(this.render(),this.bumpNeighbours())},n.BlockSvg.prototype.setNextStatement=function(t,e){n.BlockSvg.superClass_.setNextStatement.call(this,t,e),this.rendered&&(this.render(),this.bumpNeighbours())},n.BlockSvg.prototype.setOutput=function(t,e){n.BlockSvg.superClass_.setOutput.call(this,t,e),this.rendered&&(this.render(),this.bumpNeighbours())},n.BlockSvg.prototype.setInputsInline=function(t){n.BlockSvg.superClass_.setInputsInline.call(this,t),this.rendered&&(this.render(),this.bumpNeighbours())},n.BlockSvg.prototype.removeInput=function(t,e){return t=n.BlockSvg.superClass_.removeInput.call(this,t,e),this.rendered&&(this.render(),this.bumpNeighbours()),t},n.BlockSvg.prototype.moveNumberedInputBefore=function(t,e){n.BlockSvg.superClass_.moveNumberedInputBefore.call(this,t,e),this.rendered&&(this.render(),this.bumpNeighbours())},n.BlockSvg.prototype.appendInput_=function(t,e){return t=n.BlockSvg.superClass_.appendInput_.call(this,t,e),this.rendered&&(this.render(),this.bumpNeighbours()),t},n.BlockSvg.prototype.setConnectionTracking=function(t){if(this.previousConnection&&this.previousConnection.setTracking(t),this.outputConnection&&this.outputConnection.setTracking(t),this.nextConnection){this.nextConnection.setTracking(t);var e=this.nextConnection.targetBlock();e&&e.setConnectionTracking(t)}if(!this.collapsed_)for(e=0;e<this.inputList.length;e++){var n=this.inputList[e].connection;n&&(n.setTracking(t),(n=n.targetBlock())&&n.setConnectionTracking(t))}},n.BlockSvg.prototype.getConnections_=function(t){var e=[];if((t||this.rendered)&&(this.outputConnection&&e.push(this.outputConnection),this.previousConnection&&e.push(this.previousConnection),this.nextConnection&&e.push(this.nextConnection),t||!this.collapsed_)){t=0;for(var n;n=this.inputList[t];t++)n.connection&&e.push(n.connection)}return e},n.BlockSvg.prototype.lastConnectionInStack=function(){return n.BlockSvg.superClass_.lastConnectionInStack.call(this)},n.BlockSvg.prototype.getMatchingConnection=function(t,e){return n.BlockSvg.superClass_.getMatchingConnection.call(this,t,e)},n.BlockSvg.prototype.makeConnection_=function(t){return new n.RenderedConnection(this,t)},n.BlockSvg.prototype.bumpNeighbours=function(){if(this.workspace&&!this.workspace.isDragging()){var t=this.getRootBlock();if(!t.isInFlyout)for(var e,i=this.getConnections_(!1),o=0;e=i[o];o++){e.isConnected()&&e.isSuperior()&&e.targetBlock().bumpNeighbours();for(var r,s=e.neighbours(n.SNAP_RADIUS),a=0;r=s[a];a++)e.isConnected()&&r.isConnected()||r.getSourceBlock().getRootBlock()!=t&&(e.isSuperior()?r.bumpAwayFrom(e):e.bumpAwayFrom(r))}}},n.BlockSvg.prototype.scheduleSnapAndBump=function(){var t=this,e=n.Events.getGroup();setTimeout((function(){n.Events.setGroup(e),t.snapToGrid(),n.Events.setGroup(!1)}),n.BUMP_DELAY/2),setTimeout((function(){n.Events.setGroup(e),t.bumpNeighbours(),n.Events.setGroup(!1)}),n.BUMP_DELAY)},n.BlockSvg.prototype.positionNearConnection=function(t,e){t.type!=n.NEXT_STATEMENT&&t.type!=n.INPUT_VALUE||this.moveBy(e.x-t.x,e.y-t.y)},n.BlockSvg.prototype.getParent=function(){return n.BlockSvg.superClass_.getParent.call(this)},n.BlockSvg.prototype.getRootBlock=function(){return n.BlockSvg.superClass_.getRootBlock.call(this)},n.BlockSvg.prototype.render=function(t){if(!this.renderIsInProgress_){this.renderIsInProgress_=!0;try{if(this.rendered=!0,n.utils.dom.startTextWidthCache(),this.isCollapsed()&&this.updateCollapsed_(),this.workspace.getRenderer().render(this),this.updateConnectionLocations_(),!1!==t){var e=this.getParent();e?e.render(!0):this.workspace.resizeContents()}n.utils.dom.stopTextWidthCache(),this.updateMarkers_()}finally{this.renderIsInProgress_=!1}}},n.BlockSvg.prototype.updateMarkers_=function(){this.workspace.keyboardAccessibilityMode&&this.pathObject.cursorSvg&&this.workspace.getCursor().draw(),this.workspace.keyboardAccessibilityMode&&this.pathObject.markerSvg&&this.workspace.getMarker(n.navigation.MARKER_NAME).draw()},n.BlockSvg.prototype.updateConnectionLocations_=function(){var t=this.getRelativeToSurfaceXY();this.previousConnection&&this.previousConnection.moveToOffset(t),this.outputConnection&&this.outputConnection.moveToOffset(t);for(var e=0;e<this.inputList.length;e++){var n=this.inputList[e].connection;n&&(n.moveToOffset(t),n.isConnected()&&n.tighten())}this.nextConnection&&(this.nextConnection.moveToOffset(t),this.nextConnection.isConnected()&&this.nextConnection.tighten())},n.BlockSvg.prototype.setCursorSvg=function(t){this.pathObject.setCursorSvg(t)},n.BlockSvg.prototype.setMarkerSvg=function(t){this.pathObject.setMarkerSvg(t)},n.BlockSvg.prototype.getHeightWidth=function(){var t=this.height,e=this.width,n=this.getNextBlock();if(n){n=n.getHeightWidth();var i=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;t+=n.height-i,e=Math.max(e,n.width)}return{height:t,width:e}},n.BlockSvg.prototype.fadeForReplacement=function(t){this.pathObject.updateReplacementFade(t)},n.BlockSvg.prototype.highlightShapeForInput=function(t,e){this.pathObject.updateShapeForInputHighlight(t,e)},n.blockRendering.useDebugger=!1,n.blockRendering.register=function(t,e){n.registry.register(n.registry.Type.RENDERER,t,e)},n.blockRendering.unregister=function(t){n.registry.unregister(n.registry.Type.RENDERER,t)},n.blockRendering.startDebugger=function(){n.blockRendering.useDebugger=!0},n.blockRendering.stopDebugger=function(){n.blockRendering.useDebugger=!1},n.blockRendering.init=function(t,e,i){return(t=new(n.registry.getClass(n.registry.Type.RENDERER,t))(t)).init(e,i),t},n.ConnectionDB=function(t){this.connections_=[],this.connectionChecker_=t},n.ConnectionDB.prototype.addConnection=function(t,e){e=this.calculateIndexForYPos_(e),this.connections_.splice(e,0,t)},n.ConnectionDB.prototype.findIndexOfConnection_=function(t,e){if(!this.connections_.length)return-1;var n=this.calculateIndexForYPos_(e);if(n>=this.connections_.length)return-1;e=t.y;for(var i=n;0<=i&&this.connections_[i].y==e;){if(this.connections_[i]==t)return i;i--}for(;n<this.connections_.length&&this.connections_[n].y==e;){if(this.connections_[n]==t)return n;n++}return-1},n.ConnectionDB.prototype.calculateIndexForYPos_=function(t){if(!this.connections_.length)return 0;for(var e=0,n=this.connections_.length;e<n;){var i=Math.floor((e+n)/2);if(this.connections_[i].y<t)e=i+1;else{if(!(this.connections_[i].y>t)){e=i;break}n=i}}return e},n.ConnectionDB.prototype.removeConnection=function(t,e){if(-1==(t=this.findIndexOfConnection_(t,e)))throw Error("Unable to find connection in connectionDB.");this.connections_.splice(t,1)},n.ConnectionDB.prototype.getNeighbours=function(t,e){function n(t){var n=o-i[t].x,s=r-i[t].y;return Math.sqrt(n*n+s*s)<=e&&l.push(i[t]),s<e}var i=this.connections_,o=t.x,r=t.y;t=0;for(var s=i.length-2,a=s;t<a;)i[a].y<r?t=a:s=a,a=Math.floor((t+s)/2);var l=[];if(s=t=a,i.length){for(;0<=t&&n(t);)t--;do{s++}while(s<i.length&&n(s))}return l},n.ConnectionDB.prototype.isInYRange_=function(t,e,n){return Math.abs(this.connections_[t].y-e)<=n},n.ConnectionDB.prototype.searchForClosest=function(t,e,n){if(!this.connections_.length)return{connection:null,radius:e};var i=t.y,o=t.x;t.x=o+n.x,t.y=i+n.y;var r=this.calculateIndexForYPos_(t.y);n=null;for(var s,a=e,l=r-1;0<=l&&this.isInYRange_(l,t.y,e);)s=this.connections_[l],this.connectionChecker_.canConnect(t,s,!0,a)&&(n=s,a=s.distanceFrom(t)),l--;for(;r<this.connections_.length&&this.isInYRange_(r,t.y,e);)s=this.connections_[r],this.connectionChecker_.canConnect(t,s,!0,a)&&(n=s,a=s.distanceFrom(t)),r++;return t.x=o,t.y=i,{connection:n,radius:a}},n.ConnectionDB.init=function(t){var e=[];return e[n.INPUT_VALUE]=new n.ConnectionDB(t),e[n.OUTPUT_VALUE]=new n.ConnectionDB(t),e[n.NEXT_STATEMENT]=new n.ConnectionDB(t),e[n.PREVIOUS_STATEMENT]=new n.ConnectionDB(t),e},n.Events.ThemeChange=function(t,e){n.Events.ThemeChange.superClass_.constructor.call(this,e),this.themeName=t},n.utils.object.inherits(n.Events.ThemeChange,n.Events.UiBase),n.Events.ThemeChange.prototype.type=n.Events.THEME_CHANGE,n.Events.ThemeChange.prototype.toJson=function(){var t=n.Events.ThemeChange.superClass_.toJson.call(this);return t.themeName=this.themeName,t},n.Events.ThemeChange.prototype.fromJson=function(t){n.Events.ThemeChange.superClass_.fromJson.call(this,t),this.themeName=t.themeName},n.registry.register(n.registry.Type.EVENT,n.Events.THEME_CHANGE,n.Events.ThemeChange),n.Events.ViewportChange=function(t,e,i,o){n.Events.ViewportChange.superClass_.constructor.call(this,o),this.viewTop=t,this.viewLeft=e,this.scale=i},n.utils.object.inherits(n.Events.ViewportChange,n.Events.UiBase),n.Events.ViewportChange.prototype.type=n.Events.VIEWPORT_CHANGE,n.Events.ViewportChange.prototype.toJson=function(){var t=n.Events.ViewportChange.superClass_.toJson.call(this);return t.viewTop=this.viewTop,t.viewLeft=this.viewLeft,t.scale=this.scale,t},n.Events.ViewportChange.prototype.fromJson=function(t){n.Events.ViewportChange.superClass_.fromJson.call(this,t),this.viewTop=t.viewTop,this.viewLeft=t.viewLeft,this.scale=t.scale},n.registry.register(n.registry.Type.EVENT,n.Events.VIEWPORT_CHANGE,n.Events.ViewportChange),n.MarkerManager=function(t){this.cursorSvg_=this.cursor_=null,this.markers_={},this.workspace_=t},n.MarkerManager.prototype.registerMarker=function(t,e){this.markers_[t]&&this.unregisterMarker(t),e.setDrawer(this.workspace_.getRenderer().makeMarkerDrawer(this.workspace_,e)),this.setMarkerSvg(e.getDrawer().createDom()),this.markers_[t]=e},n.MarkerManager.prototype.unregisterMarker=function(t){var e=this.markers_[t];if(!e)throw Error("Marker with id "+t+" does not exist. Can only unregistermarkers that exist.");e.dispose(),delete this.markers_[t]},n.MarkerManager.prototype.getCursor=function(){return this.cursor_},n.MarkerManager.prototype.getMarker=function(t){return this.markers_[t]},n.MarkerManager.prototype.setCursor=function(t){this.cursor_&&this.cursor_.getDrawer()&&this.cursor_.getDrawer().dispose(),(this.cursor_=t)&&(t=this.workspace_.getRenderer().makeMarkerDrawer(this.workspace_,this.cursor_),this.cursor_.setDrawer(t),this.setCursorSvg(this.cursor_.getDrawer().createDom()))},n.MarkerManager.prototype.setCursorSvg=function(t){t?(this.workspace_.getBlockCanvas().appendChild(t),this.cursorSvg_=t):this.cursorSvg_=null},n.MarkerManager.prototype.setMarkerSvg=function(t){t?this.workspace_.getBlockCanvas()&&(this.cursorSvg_?this.workspace_.getBlockCanvas().insertBefore(t,this.cursorSvg_):this.workspace_.getBlockCanvas().appendChild(t)):this.markerSvg_=null},n.MarkerManager.prototype.updateMarkers=function(){this.workspace_.keyboardAccessibilityMode&&this.cursorSvg_&&this.workspace_.getCursor().draw()},n.MarkerManager.prototype.dispose=function(){for(var t,e=Object.keys(this.markers_),n=0;t=e[n];n++)this.unregisterMarker(t);this.markers_=null,this.cursor_&&(this.cursor_.dispose(),this.cursor_=null)},n.ThemeManager=function(t,e){this.workspace_=t,this.theme_=e,this.subscribedWorkspaces_=[],this.componentDB_=Object.create(null)},n.ThemeManager.prototype.getTheme=function(){return this.theme_},n.ThemeManager.prototype.setTheme=function(t){var e,i=this.theme_;for(this.theme_=t,(t=this.workspace_.getInjectionDiv())&&(i&&n.utils.dom.removeClass(t,i.getClassName()),n.utils.dom.addClass(t,this.theme_.getClassName())),i=0;t=this.subscribedWorkspaces_[i];i++)t.refreshTheme();for(i=0,t=Object.keys(this.componentDB_);e=t[i];i++)for(var o,r=0;o=this.componentDB_[e][r];r++){var s=o.element;o=o.propertyName;var a=this.theme_&&this.theme_.getComponentStyle(e);s.style[o]=a||""}n.hideChaff()},n.ThemeManager.prototype.subscribeWorkspace=function(t){this.subscribedWorkspaces_.push(t)},n.ThemeManager.prototype.unsubscribeWorkspace=function(t){if(0>(t=this.subscribedWorkspaces_.indexOf(t)))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.");this.subscribedWorkspaces_.splice(t,1)},n.ThemeManager.prototype.subscribe=function(t,e,n){this.componentDB_[e]||(this.componentDB_[e]=[]),this.componentDB_[e].push({element:t,propertyName:n}),e=this.theme_&&this.theme_.getComponentStyle(e),t.style[n]=e||""},n.ThemeManager.prototype.unsubscribe=function(t){if(t)for(var e,n=Object.keys(this.componentDB_),i=0;e=n[i];i++){for(var o=this.componentDB_[e],r=o.length-1;0<=r;r--)o[r].element===t&&o.splice(r,1);this.componentDB_[e].length||delete this.componentDB_[e]}},n.ThemeManager.prototype.dispose=function(){this.componentDB_=this.subscribedWorkspaces_=this.theme_=this.owner_=null},n.TouchGesture=function(t,e){n.TouchGesture.superClass_.constructor.call(this,t,e),this.isMultiTouch_=!1,this.cachedPoints_=Object.create(null),this.startDistance_=this.previousScale_=0,this.isPinchZoomEnabled_=this.onStartWrapper_=null},n.utils.object.inherits(n.TouchGesture,n.Gesture),n.TouchGesture.ZOOM_IN_MULTIPLIER=5,n.TouchGesture.ZOOM_OUT_MULTIPLIER=6,n.TouchGesture.prototype.doStart=function(t){this.isPinchZoomEnabled_=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,n.TouchGesture.superClass_.doStart.call(this,t),!this.isEnding_&&n.Touch.isTouchEvent(t)&&this.handleTouchStart(t)},n.TouchGesture.prototype.bindMouseEvents=function(t){this.onStartWrapper_=n.bindEventWithChecks_(document,"mousedown",null,this.handleStart.bind(this),!0),this.onMoveWrapper_=n.bindEventWithChecks_(document,"mousemove",null,this.handleMove.bind(this),!0),this.onUpWrapper_=n.bindEventWithChecks_(document,"mouseup",null,this.handleUp.bind(this),!0),t.preventDefault(),t.stopPropagation()},n.TouchGesture.prototype.handleStart=function(t){!this.isDragging()&&n.Touch.isTouchEvent(t)&&(this.handleTouchStart(t),this.isMultiTouch()&&n.longStop_())},n.TouchGesture.prototype.handleMove=function(t){this.isDragging()?n.Touch.shouldHandleEvent(t)&&n.TouchGesture.superClass_.handleMove.call(this,t):this.isMultiTouch()?(n.Touch.isTouchEvent(t)&&this.handleTouchMove(t),n.longStop_()):n.TouchGesture.superClass_.handleMove.call(this,t)},n.TouchGesture.prototype.handleUp=function(t){n.Touch.isTouchEvent(t)&&!this.isDragging()&&this.handleTouchEnd(t),!this.isMultiTouch()||this.isDragging()?n.Touch.shouldHandleEvent(t)&&n.TouchGesture.superClass_.handleUp.call(this,t):(t.preventDefault(),t.stopPropagation(),this.dispose())},n.TouchGesture.prototype.isMultiTouch=function(){return this.isMultiTouch_},n.TouchGesture.prototype.dispose=function(){n.TouchGesture.superClass_.dispose.call(this),this.onStartWrapper_&&n.unbindEvent_(this.onStartWrapper_)},n.TouchGesture.prototype.handleTouchStart=function(t){var e=n.Touch.getTouchIdentifierFromEvent(t);this.cachedPoints_[e]=this.getTouchPoint(t),2==(e=Object.keys(this.cachedPoints_)).length&&(this.startDistance_=n.utils.Coordinate.distance(this.cachedPoints_[e[0]],this.cachedPoints_[e[1]]),this.isMultiTouch_=!0,t.preventDefault())},n.TouchGesture.prototype.handleTouchMove=function(t){var e=n.Touch.getTouchIdentifierFromEvent(t);this.cachedPoints_[e]=this.getTouchPoint(t),e=Object.keys(this.cachedPoints_),this.isPinchZoomEnabled_&&2===e.length?this.handlePinch_(t):n.TouchGesture.superClass_.handleMove.call(this,t)},n.TouchGesture.prototype.handlePinch_=function(t){var e=Object.keys(this.cachedPoints_);if(e=n.utils.Coordinate.distance(this.cachedPoints_[e[0]],this.cachedPoints_[e[1]])/this.startDistance_,0<this.previousScale_&&1/0>this.previousScale_){var i=e-this.previousScale_;i=0<i?i*n.TouchGesture.ZOOM_IN_MULTIPLIER:i*n.TouchGesture.ZOOM_OUT_MULTIPLIER;var o=this.startWorkspace_,r=n.utils.mouseToSvg(t,o.getParentSvg(),o.getInverseScreenCTM());o.zoom(r.x,r.y,i)}this.previousScale_=e,t.preventDefault()},n.TouchGesture.prototype.handleTouchEnd=function(t){t=n.Touch.getTouchIdentifierFromEvent(t),this.cachedPoints_[t]&&delete this.cachedPoints_[t],2>Object.keys(this.cachedPoints_).length&&(this.cachedPoints_=Object.create(null),this.previousScale_=0)},n.TouchGesture.prototype.getTouchPoint=function(t){return this.startWorkspace_?new n.utils.Coordinate(t.pageX?t.pageX:t.changedTouches[0].pageX,t.pageY?t.pageY:t.changedTouches[0].pageY):null},n.WorkspaceAudio=function(t){this.parentWorkspace_=t,this.SOUNDS_=Object.create(null)},n.WorkspaceAudio.prototype.lastSound_=null,n.WorkspaceAudio.prototype.dispose=function(){this.SOUNDS_=this.parentWorkspace_=null},n.WorkspaceAudio.prototype.load=function(t,e){if(t.length){try{var i=new n.utils.global.Audio}catch(t){return}for(var o,r=0;r<t.length;r++){var s=t[r],a=s.match(/\.(\w+)$/);if(a&&i.canPlayType("audio/"+a[1])){o=new n.utils.global.Audio(s);break}}o&&o.play&&(this.SOUNDS_[e]=o)}},n.WorkspaceAudio.prototype.preload=function(){for(var t in this.SOUNDS_){var e=this.SOUNDS_[t];e.volume=.01;var i=e.play();if(void 0!==i?i.then(e.pause).catch((function(){})):e.pause(),n.utils.userAgent.IPAD||n.utils.userAgent.IPHONE)break}},n.WorkspaceAudio.prototype.play=function(t,e){var i=this.SOUNDS_[t];i?(t=new Date,null!=this.lastSound_&&t-this.lastSound_<n.SOUND_LIMIT||(this.lastSound_=t,(i=n.utils.userAgent.IPAD||n.utils.userAgent.ANDROID?i:i.cloneNode()).volume=void 0===e?1:e,i.play())):this.parentWorkspace_&&this.parentWorkspace_.getAudioManager().play(t,e)},n.WorkspaceSvg=function(t,e,i){n.WorkspaceSvg.superClass_.constructor.call(this,t),this.getMetrics=t.getMetrics||n.WorkspaceSvg.getTopLevelWorkspaceMetrics_,this.setMetrics=t.setMetrics||n.WorkspaceSvg.setTopLevelWorkspaceMetrics_,this.connectionDBList=n.ConnectionDB.init(this.connectionChecker),e&&(this.blockDragSurface_=e),i&&(this.workspaceDragSurface_=i),this.useWorkspaceDragSurface_=!!this.workspaceDragSurface_&&n.utils.is3dSupported(),this.highlightedBlocks_=[],this.audioManager_=new n.WorkspaceAudio(t.parentWorkspace),this.grid_=this.options.gridPattern?new n.Grid(this.options.gridPattern,t.gridOptions):null,this.markerManager_=new n.MarkerManager(this),this.toolboxCategoryCallbacks_={},this.flyoutButtonCallbacks_={},n.Variables&&n.Variables.flyoutCategory&&this.registerToolboxCategoryCallback(n.VARIABLE_CATEGORY_NAME,n.Variables.flyoutCategory),n.VariablesDynamic&&n.VariablesDynamic.flyoutCategory&&this.registerToolboxCategoryCallback(n.VARIABLE_DYNAMIC_CATEGORY_NAME,n.VariablesDynamic.flyoutCategory),n.Procedures&&n.Procedures.flyoutCategory&&(this.registerToolboxCategoryCallback(n.PROCEDURE_CATEGORY_NAME,n.Procedures.flyoutCategory),this.addChangeListener(n.Procedures.mutatorOpenListener)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new n.ThemeManager(this,this.options.theme||n.Themes.Classic),this.themeManager_.subscribeWorkspace(this),this.renderer_=n.blockRendering.init(this.options.renderer||"geras",this.getTheme(),this.options.rendererOverrides),this.cachedParentSvg_=null,this.keyboardAccessibilityMode=!1,this.topBoundedElements_=[]},n.utils.object.inherits(n.WorkspaceSvg,n.Workspace),n.WorkspaceSvg.prototype.resizeHandlerWrapper_=null,n.WorkspaceSvg.prototype.rendered=!0,n.WorkspaceSvg.prototype.isVisible_=!0,n.WorkspaceSvg.prototype.isFlyout=!1,n.WorkspaceSvg.prototype.isMutator=!1,n.WorkspaceSvg.prototype.resizesEnabled_=!0,n.WorkspaceSvg.prototype.scrollX=0,n.WorkspaceSvg.prototype.scrollY=0,n.WorkspaceSvg.prototype.startScrollX=0,n.WorkspaceSvg.prototype.startScrollY=0,n.WorkspaceSvg.prototype.dragDeltaXY_=null,n.WorkspaceSvg.prototype.scale=1,n.WorkspaceSvg.prototype.oldScale_=1,n.WorkspaceSvg.prototype.oldTop_=0,n.WorkspaceSvg.prototype.oldLeft_=0,n.WorkspaceSvg.prototype.trashcan=null,n.WorkspaceSvg.prototype.scrollbar=null,n.WorkspaceSvg.prototype.flyout_=null,n.WorkspaceSvg.prototype.toolbox_=null,n.WorkspaceSvg.prototype.currentGesture_=null,n.WorkspaceSvg.prototype.blockDragSurface_=null,n.WorkspaceSvg.prototype.workspaceDragSurface_=null,n.WorkspaceSvg.prototype.useWorkspaceDragSurface_=!1,n.WorkspaceSvg.prototype.isDragSurfaceActive_=!1,n.WorkspaceSvg.prototype.injectionDiv_=null,n.WorkspaceSvg.prototype.lastRecordedPageScroll_=null,n.WorkspaceSvg.prototype.targetWorkspace=null,n.WorkspaceSvg.prototype.inverseScreenCTM_=null,n.WorkspaceSvg.prototype.inverseScreenCTMDirty_=!0,n.WorkspaceSvg.prototype.getMarkerManager=function(){return this.markerManager_},n.WorkspaceSvg.prototype.setCursorSvg=function(t){this.markerManager_.setCursorSvg(t)},n.WorkspaceSvg.prototype.setMarkerSvg=function(t){this.markerManager_.setMarkerSvg(t)},n.WorkspaceSvg.prototype.getMarker=function(t){return this.markerManager_?this.markerManager_.getMarker(t):null},n.WorkspaceSvg.prototype.getCursor=function(){return this.markerManager_?this.markerManager_.getCursor():null},n.WorkspaceSvg.prototype.getRenderer=function(){return this.renderer_},n.WorkspaceSvg.prototype.getThemeManager=function(){return this.themeManager_},n.WorkspaceSvg.prototype.getTheme=function(){return this.themeManager_.getTheme()},n.WorkspaceSvg.prototype.setTheme=function(t){t||(t=n.Themes.Classic),this.themeManager_.setTheme(t)},n.WorkspaceSvg.prototype.refreshTheme=function(){this.svgGroup_&&this.renderer_.refreshDom(this.svgGroup_,this.getTheme()),this.updateBlockStyles_(this.getAllBlocks(!1).filter((function(t){return void 0!==t.getStyleName()}))),this.refreshToolboxSelection(),this.toolbox_&&this.toolbox_.refreshTheme(),this.isVisible()&&this.setVisible(!0);var t=new n.Events.ThemeChange(this.getTheme().name,this.id);n.Events.fire(t)},n.WorkspaceSvg.prototype.updateBlockStyles_=function(t){for(var e,n=0;e=t[n];n++){var i=e.getStyleName();i&&(e.setStyle(i),e.mutator&&e.mutator.updateBlockStyle())}},n.WorkspaceSvg.prototype.getInverseScreenCTM=function(){if(this.inverseScreenCTMDirty_){var t=this.getParentSvg().getScreenCTM();t&&(this.inverseScreenCTM_=t.inverse(),this.inverseScreenCTMDirty_=!1)}return this.inverseScreenCTM_},n.WorkspaceSvg.prototype.updateInverseScreenCTM=function(){this.inverseScreenCTMDirty_=!0},n.WorkspaceSvg.prototype.isVisible=function(){return this.isVisible_},n.WorkspaceSvg.prototype.getSvgXY=function(t){var e=0,i=0,o=1;(n.utils.dom.containsNode(this.getCanvas(),t)||n.utils.dom.containsNode(this.getBubbleCanvas(),t))&&(o=this.scale);do{var r=n.utils.getRelativeXY(t);t!=this.getCanvas()&&t!=this.getBubbleCanvas()||(o=1),e+=r.x*o,i+=r.y*o,t=t.parentNode}while(t&&t!=this.getParentSvg());return new n.utils.Coordinate(e,i)},n.WorkspaceSvg.prototype.getOriginOffsetInPixels=function(){return n.utils.getInjectionDivXY_(this.getCanvas())},n.WorkspaceSvg.prototype.getInjectionDiv=function(){if(!this.injectionDiv_)for(var t=this.svgGroup_;t;){if(-1!=(" "+(t.getAttribute("class")||"")+" ").indexOf(" injectionDiv ")){this.injectionDiv_=t;break}t=t.parentNode}return this.injectionDiv_},n.WorkspaceSvg.prototype.getBlockCanvas=function(){return this.svgBlockCanvas_},n.WorkspaceSvg.prototype.setResizeHandlerWrapper=function(t){this.resizeHandlerWrapper_=t},n.WorkspaceSvg.prototype.createDom=function(t){if(this.svgGroup_=n.utils.dom.createSvgElement(n.utils.Svg.G,{class:"blocklyWorkspace"},null),t&&(this.svgBackground_=n.utils.dom.createSvgElement(n.utils.Svg.RECT,{height:"100%",width:"100%",class:t},this.svgGroup_),"blocklyMainBackground"==t&&this.grid_?this.svgBackground_.style.fill="url(#"+this.grid_.getPatternId()+")":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.svgBlockCanvas_=n.utils.dom.createSvgElement(n.utils.Svg.G,{class:"blocklyBlockCanvas"},this.svgGroup_),this.svgBubbleCanvas_=n.utils.dom.createSvgElement(n.utils.Svg.G,{class:"blocklyBubbleCanvas"},this.svgGroup_),this.isFlyout||(n.bindEventWithChecks_(this.svgGroup_,"mousedown",this,this.onMouseDown_,!1,!0),n.bindEventWithChecks_(this.svgGroup_,"wheel",this,this.onMouseWheel_)),this.options.hasCategories){if(!n.Toolbox)throw Error("Missing require for Blockly.Toolbox");this.toolbox_=new(n.registry.getClassFromOptions(n.registry.Type.TOOLBOX,this.options))(this)}return this.grid_&&this.grid_.update(this.scale),this.recordDeleteAreas(),this.markerManager_.setCursor(new n.Cursor),this.markerManager_.registerMarker(n.navigation.MARKER_NAME,new n.Marker),this.renderer_.createDom(this.svgGroup_,this.getTheme()),this.svgGroup_},n.WorkspaceSvg.prototype.dispose=function(){if(this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&(n.utils.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.svgBubbleCanvas_=this.svgBlockCanvas_=null,this.toolbox_&&(this.toolbox_.dispose(),this.toolbox_=null),this.flyout_&&(this.flyout_.dispose(),this.flyout_=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&(this.zoomControls_.dispose(),this.zoomControls_=null),this.audioManager_&&(this.audioManager_.dispose(),this.audioManager_=null),this.grid_&&(this.grid_.dispose(),this.grid_=null),this.renderer_.dispose(),this.markerManager_&&(this.markerManager_.dispose(),this.markerManager_=null),n.WorkspaceSvg.superClass_.dispose.call(this),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||(this.themeManager_.dispose(),this.themeManager_=null)),this.flyoutButtonCallbacks_=this.toolboxCategoryCallbacks_=this.connectionDBList=null,!this.options.parentWorkspace){var t=this.getParentSvg();t&&t.parentNode&&n.utils.dom.removeNode(t.parentNode)}this.resizeHandlerWrapper_&&(n.unbindEvent_(this.resizeHandlerWrapper_),this.resizeHandlerWrapper_=null)},n.WorkspaceSvg.prototype.newBlock=function(t,e){return new n.BlockSvg(this,t,e)},n.WorkspaceSvg.prototype.addTrashcan=function(){if(!n.Trashcan)throw Error("Missing require for Blockly.Trashcan");this.trashcan=new n.Trashcan(this);var t=this.trashcan.createDom();this.svgGroup_.insertBefore(t,this.svgBlockCanvas_)},n.WorkspaceSvg.prototype.addZoomControls=function(){if(!n.ZoomControls)throw Error("Missing require for Blockly.ZoomControls");this.zoomControls_=new n.ZoomControls(this);var t=this.zoomControls_.createDom();this.svgGroup_.appendChild(t)},n.WorkspaceSvg.prototype.addFlyout=function(t){var e=new n.Options({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides});if(e.toolboxPosition=this.options.toolboxPosition,this.horizontalLayout){if(!n.HorizontalFlyout)throw Error("Missing require for Blockly.HorizontalFlyout");this.flyout_=new n.HorizontalFlyout(e)}else{if(!n.VerticalFlyout)throw Error("Missing require for Blockly.VerticalFlyout");this.flyout_=new n.VerticalFlyout(e)}return this.flyout_.autoClose=!1,this.flyout_.getWorkspace().setVisible(!0),this.flyout_.createDom(t)},n.WorkspaceSvg.prototype.getFlyout=function(t){return this.flyout_||t?this.flyout_:this.toolbox_?this.toolbox_.getFlyout():null},n.WorkspaceSvg.prototype.getToolbox=function(){return this.toolbox_},n.WorkspaceSvg.prototype.updateScreenCalculations_=function(){this.updateInverseScreenCTM(),this.recordDeleteAreas()},n.WorkspaceSvg.prototype.resizeContents=function(){this.resizesEnabled_&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())},n.WorkspaceSvg.prototype.resize=function(){this.toolbox_&&this.toolbox_.position(),this.flyout_&&this.flyout_.position(),this.trashcan&&this.trashcan.position(),this.zoomControls_&&this.zoomControls_.position(),this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations_()},n.WorkspaceSvg.prototype.updateScreenCalculationsIfScrolled=function(){var t=n.utils.getDocumentScroll();n.utils.Coordinate.equals(this.lastRecordedPageScroll_,t)||(this.lastRecordedPageScroll_=t,this.updateScreenCalculations_())},n.WorkspaceSvg.prototype.getCanvas=function(){return this.svgBlockCanvas_},n.WorkspaceSvg.prototype.getBubbleCanvas=function(){return this.svgBubbleCanvas_},n.WorkspaceSvg.prototype.getParentSvg=function(){if(!this.cachedParentSvg_)for(var t=this.svgGroup_;t;){if("svg"==t.tagName){this.cachedParentSvg_=t;break}t=t.parentNode}return this.cachedParentSvg_},n.WorkspaceSvg.prototype.maybeFireViewportChangeEvent=function(){if(n.Events.isEnabled()){var t=this.scale,e=-this.scrollY,i=-this.scrollX;t==this.oldScale_&&1>Math.abs(e-this.oldTop_)&&1>Math.abs(i-this.oldLeft_)||(this.oldScale_=t,this.oldTop_=e,this.oldLeft_=i,t=new n.Events.ViewportChange(e,i,t,this.id),n.Events.fire(t))}},n.WorkspaceSvg.prototype.translate=function(t,e){if(this.useWorkspaceDragSurface_&&this.isDragSurfaceActive_)this.workspaceDragSurface_.translateSurface(t,e);else{var n="translate("+t+","+e+") scale("+this.scale+")";this.svgBlockCanvas_.setAttribute("transform",n),this.svgBubbleCanvas_.setAttribute("transform",n)}this.blockDragSurface_&&this.blockDragSurface_.translateAndScaleGroup(t,e,this.scale),this.grid_&&this.grid_.moveTo(t,e),this.maybeFireViewportChangeEvent()},n.WorkspaceSvg.prototype.resetDragSurface=function(){if(this.useWorkspaceDragSurface_){this.isDragSurfaceActive_=!1;var t=this.workspaceDragSurface_.getSurfaceTranslation();this.workspaceDragSurface_.clearAndHide(this.svgGroup_),t="translate("+t.x+","+t.y+") scale("+this.scale+")",this.svgBlockCanvas_.setAttribute("transform",t),this.svgBubbleCanvas_.setAttribute("transform",t)}},n.WorkspaceSvg.prototype.setupDragSurface=function(){if(this.useWorkspaceDragSurface_&&!this.isDragSurfaceActive_){this.isDragSurfaceActive_=!0;var t=this.svgBlockCanvas_.previousSibling,e=parseInt(this.getParentSvg().getAttribute("width"),10),i=parseInt(this.getParentSvg().getAttribute("height"),10),o=n.utils.getRelativeXY(this.getCanvas());this.workspaceDragSurface_.setContentsAndShow(this.getCanvas(),this.getBubbleCanvas(),t,e,i,this.scale),this.workspaceDragSurface_.translateSurface(o.x,o.y)}},n.WorkspaceSvg.prototype.getBlockDragSurface=function(){return this.blockDragSurface_},n.WorkspaceSvg.prototype.getWidth=function(){var t=this.getMetrics();return t?t.viewWidth/this.scale:0},n.WorkspaceSvg.prototype.setVisible=function(t){if(this.isVisible_=t,this.svgGroup_)if(this.scrollbar&&this.scrollbar.setContainerVisible(t),this.getFlyout()&&this.getFlyout().setContainerVisible(t),this.getParentSvg().style.display=t?"block":"none",this.toolbox_&&this.toolbox_.setVisible(t),t){for(var e=(t=this.getAllBlocks(!1)).length-1;0<=e;e--)t[e].markDirty();this.render(),this.toolbox_&&this.toolbox_.position()}else n.hideChaff(!0)},n.WorkspaceSvg.prototype.render=function(){for(var t=this.getAllBlocks(!1),e=t.length-1;0<=e;e--)t[e].render(!1);if(this.currentGesture_)for(t=this.currentGesture_.getInsertionMarkers(),e=0;e<t.length;e++)t[e].render(!1);this.markerManager_.updateMarkers()},n.WorkspaceSvg.prototype.highlightBlock=function(t,e){if(void 0===e){for(var i,o=0;i=this.highlightedBlocks_[o];o++)i.setHighlighted(!1);this.highlightedBlocks_.length=0}(i=t?this.getBlockById(t):null)&&((t=void 0===e||e)?-1==this.highlightedBlocks_.indexOf(i)&&this.highlightedBlocks_.push(i):n.utils.arrayRemove(this.highlightedBlocks_,i),i.setHighlighted(t))},n.WorkspaceSvg.prototype.paste=function(t){!this.rendered||!t.tagName||t.getElementsByTagName("block").length>=this.remainingCapacity()||(this.currentGesture_&&this.currentGesture_.cancel(),"comment"==t.tagName.toLowerCase()?this.pasteWorkspaceComment_(t):this.pasteBlock_(t))},n.WorkspaceSvg.prototype.pasteBlock_=function(t){n.Events.disable();try{var e=n.Xml.domToBlock(t,this),i=this.getMarker(n.navigation.MARKER_NAME).getCurNode();if(this.keyboardAccessibilityMode&&i&&i.isConnection()){var o=i.getLocation();return void n.navigation.insertBlock(e,o)}var r=parseInt(t.getAttribute("x"),10),s=parseInt(t.getAttribute("y"),10);if(!isNaN(r)&&!isNaN(s)){this.RTL&&(r=-r);do{t=!1;var a,l=this.getAllBlocks(!1);for(i=0;a=l[i];i++){var c=a.getRelativeToSurfaceXY();if(1>=Math.abs(r-c.x)&&1>=Math.abs(s-c.y)){t=!0;break}}if(!t){var d,u=e.getConnections_(!1);for(i=0;d=u[i];i++)if(d.closest(n.SNAP_RADIUS,new n.utils.Coordinate(r,s)).connection){t=!0;break}}t&&(r=this.RTL?r-n.SNAP_RADIUS:r+n.SNAP_RADIUS,s+=2*n.SNAP_RADIUS)}while(t);e.moveBy(r,s)}}finally{n.Events.enable()}n.Events.isEnabled()&&!e.isShadow()&&n.Events.fire(new n.Events.BlockCreate(e)),e.select()},n.WorkspaceSvg.prototype.pasteWorkspaceComment_=function(t){n.Events.disable();try{var e=n.WorkspaceCommentSvg.fromXml(t,this),i=parseInt(t.getAttribute("x"),10),o=parseInt(t.getAttribute("y"),10);isNaN(i)||isNaN(o)||(this.RTL&&(i=-i),e.moveBy(i+50,o+50))}finally{n.Events.enable()}n.Events.isEnabled()&&n.WorkspaceComment.fireCreateEvent(e),e.select()},n.WorkspaceSvg.prototype.refreshToolboxSelection=function(){var t=this.isFlyout?this.targetWorkspace:this;t&&!t.currentGesture_&&t.toolbox_&&t.toolbox_.getFlyout()&&t.toolbox_.refreshSelection()},n.WorkspaceSvg.prototype.renameVariableById=function(t,e){n.WorkspaceSvg.superClass_.renameVariableById.call(this,t,e),this.refreshToolboxSelection()},n.WorkspaceSvg.prototype.deleteVariableById=function(t){n.WorkspaceSvg.superClass_.deleteVariableById.call(this,t),this.refreshToolboxSelection()},n.WorkspaceSvg.prototype.createVariable=function(t,e,i){return t=n.WorkspaceSvg.superClass_.createVariable.call(this,t,e,i),this.refreshToolboxSelection(),t},n.WorkspaceSvg.prototype.recordDeleteAreas=function(){this.deleteAreaTrash_=this.trashcan&&this.svgGroup_.parentNode?this.trashcan.getClientRect():null,this.deleteAreaToolbox_=this.flyout_?this.flyout_.getClientRect():this.toolbox_&&"function"==typeof this.toolbox_.getClientRect?this.toolbox_.getClientRect():null},n.WorkspaceSvg.prototype.isDeleteArea=function(t){return this.deleteAreaTrash_&&this.deleteAreaTrash_.contains(t.clientX,t.clientY)?n.DELETE_AREA_TRASH:this.deleteAreaToolbox_&&this.deleteAreaToolbox_.contains(t.clientX,t.clientY)?n.DELETE_AREA_TOOLBOX:n.DELETE_AREA_NONE},n.WorkspaceSvg.prototype.onMouseDown_=function(t){var e=this.getGesture(t);e&&e.handleWsStart(t,this)},n.WorkspaceSvg.prototype.startDrag=function(t,e){(t=n.utils.mouseToSvg(t,this.getParentSvg(),this.getInverseScreenCTM())).x/=this.scale,t.y/=this.scale,this.dragDeltaXY_=n.utils.Coordinate.difference(e,t)},n.WorkspaceSvg.prototype.moveDrag=function(t){return(t=n.utils.mouseToSvg(t,this.getParentSvg(),this.getInverseScreenCTM())).x/=this.scale,t.y/=this.scale,n.utils.Coordinate.sum(this.dragDeltaXY_,t)},n.WorkspaceSvg.prototype.isDragging=function(){return null!=this.currentGesture_&&this.currentGesture_.isDragging()},n.WorkspaceSvg.prototype.isDraggable=function(){return this.options.moveOptions&&this.options.moveOptions.drag},n.WorkspaceSvg.prototype.isContentBounded=function(){return this.options.moveOptions&&this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.controls||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch},n.WorkspaceSvg.prototype.isMovable=function(){return this.options.moveOptions&&this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch},n.WorkspaceSvg.prototype.onMouseWheel_=function(t){if(n.Gesture.inProgress())t.preventDefault(),t.stopPropagation();else{var e=this.options.zoomOptions&&this.options.zoomOptions.wheel,i=this.options.moveOptions&&this.options.moveOptions.wheel;if(e||i){var o=n.utils.getScrollDeltaPixels(t);!e||!t.ctrlKey&&i?(e=this.scrollX-o.x,i=this.scrollY-o.y,t.shiftKey&&!o.x&&(e=this.scrollX-o.y,i=this.scrollY),this.scroll(e,i)):(o=-o.y/50,e=n.utils.mouseToSvg(t,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(e.x,e.y,o)),t.preventDefault()}}},n.WorkspaceSvg.prototype.getBlocksBoundingBox=function(){var t=this.getTopBoundedElements();if(!t.length)return new n.utils.Rect(0,0,0,0);for(var e=t[0].getBoundingRectangle(),i=1;i<t.length;i++){var o=t[i].getBoundingRectangle();o.top<e.top&&(e.top=o.top),o.bottom>e.bottom&&(e.bottom=o.bottom),o.left<e.left&&(e.left=o.left),o.right>e.right&&(e.right=o.right)}return e},n.WorkspaceSvg.prototype.cleanUp=function(){this.setResizesEnabled(!1),n.Events.setGroup(!0);for(var t,e=this.getTopBlocks(!0),i=0,o=0;t=e[o];o++)if(t.isMovable()){var r=t.getRelativeToSurfaceXY();t.moveBy(-r.x,i-r.y),t.snapToGrid(),i=t.getRelativeToSurfaceXY().y+t.getHeightWidth().height+this.renderer_.getConstants().MIN_BLOCK_HEIGHT}n.Events.setGroup(!1),this.setResizesEnabled(!0)},n.WorkspaceSvg.prototype.showContextMenu=function(t){if(!this.options.readOnly&&!this.isFlyout){var e=n.ContextMenuRegistry.registry.getContextMenuOptions(n.ContextMenuRegistry.ScopeType.WORKSPACE,{workspace:this});this.configureContextMenu&&this.configureContextMenu(e,t),n.ContextMenu.show(t,e,this.RTL)}},n.WorkspaceSvg.prototype.updateToolbox=function(t){if(t=n.utils.toolbox.convertToolboxDefToJson(t)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(n.utils.toolbox.hasCategories(t)){if(!this.toolbox_)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=t,this.toolbox_.render(t)}else{if(!this.flyout_)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=t,this.flyout_.show(t)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")},n.WorkspaceSvg.prototype.markFocused=function(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(n.mainWorkspace=this,this.setBrowserFocus())},n.WorkspaceSvg.prototype.setBrowserFocus=function(){document.activeElement&&document.activeElement.blur&&document.activeElement.blur();try{this.getParentSvg().focus({preventScroll:!0})}catch(t){try{this.getParentSvg().parentNode.setActive()}catch(t){this.getParentSvg().parentNode.focus({preventScroll:!0})}}},n.WorkspaceSvg.prototype.zoom=function(t,e,n){n=Math.pow(this.options.zoomOptions.scaleSpeed,n);var i=this.scale*n;if(this.scale!=i){i>this.options.zoomOptions.maxScale?n=this.options.zoomOptions.maxScale/this.scale:i<this.options.zoomOptions.minScale&&(n=this.options.zoomOptions.minScale/this.scale);var o=this.getCanvas().getCTM(),r=this.getParentSvg().createSVGPoint();r.x=t,r.y=e,t=(r=r.matrixTransform(o.inverse())).x,e=r.y,o=o.translate(t*(1-n),e*(1-n)).scale(n),this.scrollX=o.e,this.scrollY=o.f,this.setScale(i)}},n.WorkspaceSvg.prototype.zoomCenter=function(t){var e=this.getMetrics();if(this.flyout_){var n=e.svgWidth?e.svgWidth/2:0;e=e.svgHeight?e.svgHeight/2:0}else n=e.viewWidth/2+e.absoluteLeft,e=e.viewHeight/2+e.absoluteTop;this.zoom(n,e,t)},n.WorkspaceSvg.prototype.zoomToFit=function(){if(this.isMovable()){var t=this.getMetrics(),e=t.viewWidth;t=t.viewHeight;var i=this.getBlocksBoundingBox(),o=i.right-i.left;if(i=i.bottom-i.top,o){this.flyout_&&(this.horizontalLayout?(t+=this.flyout_.getHeight(),i+=this.flyout_.getHeight()/this.scale):(e+=this.flyout_.getWidth(),o+=this.flyout_.getWidth()/this.scale)),e/=o,t/=i,n.Events.disable();try{this.setScale(Math.min(e,t)),this.scrollCenter()}finally{n.Events.enable()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")},n.WorkspaceSvg.prototype.beginCanvasTransition=function(){n.utils.dom.addClass(this.svgBlockCanvas_,"blocklyCanvasTransitioning"),n.utils.dom.addClass(this.svgBubbleCanvas_,"blocklyCanvasTransitioning")},n.WorkspaceSvg.prototype.endCanvasTransition=function(){n.utils.dom.removeClass(this.svgBlockCanvas_,"blocklyCanvasTransitioning"),n.utils.dom.removeClass(this.svgBubbleCanvas_,"blocklyCanvasTransitioning")},n.WorkspaceSvg.prototype.scrollCenter=function(){if(this.isMovable()){var t=this.getMetrics(),e=(t.contentWidth-t.viewWidth)/2,n=(t.contentHeight-t.viewHeight)/2;e=-e-t.contentLeft,n=-n-t.contentTop,this.scroll(e,n)}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")},n.WorkspaceSvg.prototype.centerOnBlock=function(t){if(this.isMovable()){if(t=t?this.getBlockById(t):null){var e=t.getRelativeToSurfaceXY(),n=t.getHeightWidth(),i=this.scale;t=(e.x+(this.RTL?-1:1)*n.width/2)*i,e=(e.y+n.height/2)*i,n=this.getMetrics(),this.scroll(-(t-n.viewWidth/2),-(e-n.viewHeight/2))}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")},n.WorkspaceSvg.prototype.setScale=function(t){this.options.zoomOptions.maxScale&&t>this.options.zoomOptions.maxScale?t=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&t<this.options.zoomOptions.minScale&&(t=this.options.zoomOptions.minScale),this.scale=t,n.hideChaff(!1),this.flyout_&&(this.flyout_.reflow(),this.recordDeleteAreas()),this.grid_&&this.grid_.update(this.scale),t=this.getMetrics(),this.scrollX-=t.absoluteLeft,this.scrollY-=t.absoluteTop,t.viewLeft+=t.absoluteLeft,t.viewTop+=t.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout_?(this.scrollbar.hScroll.resizeViewHorizontal(t),this.scrollbar.vScroll.resizeViewVertical(t)):(this.scrollbar.hScroll.resizeContentHorizontal(t),this.scrollbar.vScroll.resizeContentVertical(t)))},n.WorkspaceSvg.prototype.getScale=function(){return this.options.parentWorkspace?this.options.parentWorkspace.getScale():this.scale},n.WorkspaceSvg.prototype.scroll=function(t,e){n.hideChaff(!0);var i=this.getMetrics(),o=i.contentWidth+i.contentLeft-i.viewWidth,r=i.contentHeight+i.contentTop-i.viewHeight;t=Math.min(t,-i.contentLeft),e=Math.min(e,-i.contentTop),t=Math.max(t,-o),e=Math.max(e,-r),this.scrollX=t,this.scrollY=e,this.scrollbar&&(this.scrollbar.hScroll.setHandlePosition(-(t+i.contentLeft)*this.scrollbar.hScroll.ratio),this.scrollbar.vScroll.setHandlePosition(-(e+i.contentTop)*this.scrollbar.vScroll.ratio)),t+=i.absoluteLeft,e+=i.absoluteTop,this.translate(t,e)},n.WorkspaceSvg.getDimensionsPx_=function(t){var e=0,i=0;return t&&(e=t.getWidth(),i=t.getHeight()),new n.utils.Size(e,i)},n.WorkspaceSvg.getContentDimensions_=function(t,e){return t.isContentBounded()?n.WorkspaceSvg.getContentDimensionsBounded_(t,e):n.WorkspaceSvg.getContentDimensionsExact_(t)},n.WorkspaceSvg.getContentDimensionsExact_=function(t){var e=t.getBlocksBoundingBox(),n=t.scale;t=e.top*n;var i=e.bottom*n,o=e.left*n;return{top:t,bottom:i,left:o,right:e=e.right*n,width:e-o,height:i-t}},n.WorkspaceSvg.getContentDimensionsBounded_=function(t,e){t=n.WorkspaceSvg.getContentDimensionsExact_(t);var i=e.width,o=i/2,r=(e=e.height)/2,s=Math.min(t.left-o,t.right-i),a=Math.min(t.top-r,t.bottom-e);return{left:s,top:a,height:Math.max(t.bottom+r,t.top+e)-a,width:Math.max(t.right+o,t.left+i)-s}},n.WorkspaceSvg.getTopLevelWorkspaceMetrics_=function(){var t=n.WorkspaceSvg.getDimensionsPx_(this.toolbox_),e=n.WorkspaceSvg.getDimensionsPx_(this.flyout_),i=n.svgSize(this.getParentSvg()),o={height:i.height,width:i.width};this.toolbox_?this.toolboxPosition==n.TOOLBOX_AT_TOP||this.toolboxPosition==n.TOOLBOX_AT_BOTTOM?o.height-=t.height:this.toolboxPosition!=n.TOOLBOX_AT_LEFT&&this.toolboxPosition!=n.TOOLBOX_AT_RIGHT||(o.width-=t.width):this.flyout_&&(this.toolboxPosition==n.TOOLBOX_AT_TOP||this.toolboxPosition==n.TOOLBOX_AT_BOTTOM?o.height-=e.height:this.toolboxPosition!=n.TOOLBOX_AT_LEFT&&this.toolboxPosition!=n.TOOLBOX_AT_RIGHT||(o.width-=e.width));var r=n.WorkspaceSvg.getContentDimensions_(this,o),s=0;this.toolbox_&&this.toolboxPosition==n.TOOLBOX_AT_LEFT?s=t.width:this.flyout_&&this.toolboxPosition==n.TOOLBOX_AT_LEFT&&(s=e.width);var a=0;return this.toolbox_&&this.toolboxPosition==n.TOOLBOX_AT_TOP?a=t.height:this.flyout_&&this.toolboxPosition==n.TOOLBOX_AT_TOP&&(a=e.height),{contentHeight:r.height,contentWidth:r.width,contentTop:r.top,contentLeft:r.left,viewHeight:o.height,viewWidth:o.width,viewTop:-this.scrollY,viewLeft:-this.scrollX,absoluteTop:a,absoluteLeft:s,svgHeight:i.height,svgWidth:i.width,toolboxWidth:t.width,toolboxHeight:t.height,toolboxPosition:this.toolboxPosition,flyoutWidth:e.width,flyoutHeight:e.height}},n.WorkspaceSvg.setTopLevelWorkspaceMetrics_=function(t){var e=this.getMetrics();"number"==typeof t.x&&(this.scrollX=-e.contentWidth*t.x-e.contentLeft),"number"==typeof t.y&&(this.scrollY=-e.contentHeight*t.y-e.contentTop),this.translate(this.scrollX+e.absoluteLeft,this.scrollY+e.absoluteTop)},n.WorkspaceSvg.prototype.getBlockById=function(t){return n.WorkspaceSvg.superClass_.getBlockById.call(this,t)},n.WorkspaceSvg.prototype.getTopBlocks=function(t){return n.WorkspaceSvg.superClass_.getTopBlocks.call(this,t)},n.WorkspaceSvg.prototype.addTopBlock=function(t){this.addTopBoundedElement(t),n.WorkspaceSvg.superClass_.addTopBlock.call(this,t)},n.WorkspaceSvg.prototype.removeTopBlock=function(t){this.removeTopBoundedElement(t),n.WorkspaceSvg.superClass_.removeTopBlock.call(this,t)},n.WorkspaceSvg.prototype.addTopComment=function(t){this.addTopBoundedElement(t),n.WorkspaceSvg.superClass_.addTopComment.call(this,t)},n.WorkspaceSvg.prototype.removeTopComment=function(t){this.removeTopBoundedElement(t),n.WorkspaceSvg.superClass_.removeTopComment.call(this,t)},n.WorkspaceSvg.prototype.addTopBoundedElement=function(t){this.topBoundedElements_.push(t)},n.WorkspaceSvg.prototype.removeTopBoundedElement=function(t){n.utils.arrayRemove(this.topBoundedElements_,t)},n.WorkspaceSvg.prototype.getTopBoundedElements=function(){return[].concat(this.topBoundedElements_)},n.WorkspaceSvg.prototype.setResizesEnabled=function(t){var e=!this.resizesEnabled_&&t;this.resizesEnabled_=t,e&&this.resizeContents()},n.WorkspaceSvg.prototype.clear=function(){this.setResizesEnabled(!1),n.WorkspaceSvg.superClass_.clear.call(this),this.topBoundedElements_=[],this.setResizesEnabled(!0)},n.WorkspaceSvg.prototype.registerButtonCallback=function(t,e){if("function"!=typeof e)throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks_[t]=e},n.WorkspaceSvg.prototype.getButtonCallback=function(t){return(t=this.flyoutButtonCallbacks_[t])?t:null},n.WorkspaceSvg.prototype.removeButtonCallback=function(t){this.flyoutButtonCallbacks_[t]=null},n.WorkspaceSvg.prototype.registerToolboxCategoryCallback=function(t,e){if("function"!=typeof e)throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks_[t]=e},n.WorkspaceSvg.prototype.getToolboxCategoryCallback=function(t){return this.toolboxCategoryCallbacks_[t]||null},n.WorkspaceSvg.prototype.removeToolboxCategoryCallback=function(t){this.toolboxCategoryCallbacks_[t]=null},n.WorkspaceSvg.prototype.getGesture=function(t){var e="mousedown"==t.type||"touchstart"==t.type||"pointerdown"==t.type,i=this.currentGesture_;return i?e&&i.hasStarted()?(console.warn("Tried to start the same gesture twice."),i.cancel(),null):i:e?this.currentGesture_=new n.TouchGesture(t,this):null},n.WorkspaceSvg.prototype.clearGesture=function(){this.currentGesture_=null},n.WorkspaceSvg.prototype.cancelCurrentGesture=function(){this.currentGesture_&&this.currentGesture_.cancel()},n.WorkspaceSvg.prototype.getAudioManager=function(){return this.audioManager_},n.WorkspaceSvg.prototype.getGrid=function(){return this.grid_},n.inject=function(t,e){if(n.checkBlockColourConstants(),n.shadowRoot=e.shadowRoot,n.parentContainer=e.shadowRoot,"string"==typeof t&&(t=document.getElementById(t)||document.querySelector(t)),!t||!n.utils.dom.containsNode(n.shadowRoot||document,t))throw Error("Error: container is not in current document.");e=new n.Options(e||{});var i=document.createElement("div");i.className="injectionDiv",i.tabIndex=0,n.utils.aria.setState(i,n.utils.aria.State.LABEL,n.Msg.WORKSPACE_ARIA_LABEL),t.appendChild(i),t=n.createDom_(i,e);var o=new n.BlockDragSurfaceSvg(i),r=new n.WorkspaceDragSurfaceSvg(i),s=n.createMainWorkspace_(t,e,o,r);return n.init_(s),n.mainWorkspace=s,n.svgResize(s),i.addEventListener("focusin",(function(){n.mainWorkspace=s})),s},n.createDom_=function(t,e){t.setAttribute("dir","LTR"),n.Css.inject(e.hasCss,e.pathToMedia),t=n.utils.dom.createSvgElement(n.utils.Svg.SVG,{xmlns:n.utils.dom.SVG_NS,"xmlns:html":n.utils.dom.HTML_NS,"xmlns:xlink":n.utils.dom.XLINK_NS,version:"1.1",class:"blocklySvg",tabindex:"0"},t);var i=n.utils.dom.createSvgElement(n.utils.Svg.DEFS,{},t),o=String(Math.random()).substring(2);return e.gridPattern=n.Grid.createDom(o,e.gridOptions,i),t},n.createMainWorkspace_=function(t,e,i,o){e.parentWorkspace=null;var r=new n.WorkspaceSvg(e,i,o);return e=r.options,r.scale=e.zoomOptions.startScale,t.appendChild(r.createDom("blocklyMainBackground")),n.utils.dom.addClass(r.getInjectionDiv(),r.getRenderer().getClassName()),n.utils.dom.addClass(r.getInjectionDiv(),r.getTheme().getClassName()),!e.hasCategories&&e.languageTree&&(i=r.addFlyout(n.utils.Svg.SVG),n.utils.dom.insertAfter(i,t)),e.hasTrashcan&&r.addTrashcan(),e.zoomOptions&&e.zoomOptions.controls&&r.addZoomControls(),r.getThemeManager().subscribe(t,"workspaceBackgroundColour","background-color"),r.translate(0,0),e.readOnly||r.isMovable()||r.addChangeListener((function(t){if(!r.isDragging()&&!r.isMovable()&&-1!=n.Events.BUMP_EVENTS.indexOf(t.type)){var e=Object.create(null),i=r.getMetrics(),o=r.scale;if(e.RTL=r.RTL,e.viewLeft=i.viewLeft/o,e.viewTop=i.viewTop/o,e.viewRight=(i.viewLeft+i.viewWidth)/o,e.viewBottom=(i.viewTop+i.viewHeight)/o,r.isContentBounded()?(i=r.getBlocksBoundingBox(),e.contentLeft=i.left,e.contentTop=i.top,e.contentRight=i.right,e.contentBottom=i.bottom):(e.contentLeft=i.contentLeft/o,e.contentTop=i.contentTop/o,e.contentRight=(i.contentLeft+i.contentWidth)/o,e.contentBottom=(i.contentTop+i.contentHeight)/o),e.contentTop<e.viewTop||e.contentBottom>e.viewBottom||e.contentLeft<e.viewLeft||e.contentRight>e.viewRight){switch(i=null,t&&(i=n.Events.getGroup(),n.Events.setGroup(t.group)),t.type){case n.Events.BLOCK_CREATE:case n.Events.BLOCK_MOVE:var s=r.getBlockById(t.blockId);s&&(s=s.getRootBlock());break;case n.Events.COMMENT_CREATE:case n.Events.COMMENT_MOVE:s=r.getCommentById(t.commentId)}if(s){(o=s.getBoundingRectangle()).height=o.bottom-o.top,o.width=o.right-o.left;var a=e.viewTop,l=e.viewBottom-o.height;l=Math.max(a,l),a=n.utils.math.clamp(a,o.top,l)-o.top,l=e.viewLeft;var c=e.viewRight-o.width;e.RTL?l=Math.min(c,l):c=Math.max(l,c),e=n.utils.math.clamp(l,o.left,c)-o.left,s.moveBy(e,a)}t&&(!t.group&&s&&console.warn("Moved object in bounds but there was no event group. This may break undo."),null!==i&&n.Events.setGroup(i))}}})),n.svgResize(r),n.WidgetDiv.createDom(),n.DropDownDiv.createDom(),n.Tooltip.createDom(),r},n.init_=function(t){var e=t.options,i=t.getParentSvg();if(n.bindEventWithChecks_(i.parentNode,"contextmenu",null,(function(t){n.utils.isTargetInput(t)||t.preventDefault()})),i=n.bindEventWithChecks_(window,"resize",null,(function(){n.hideChaff(!0),n.svgResize(t)})),t.setResizeHandlerWrapper(i),n.inject.bindDocumentEvents_(),e.languageTree){i=t.getToolbox();var o=t.getFlyout(!0);i?i.init():o&&(o.init(t),o.show(e.languageTree),"function"==typeof o.scrollToStart&&o.scrollToStart())}i=n.Scrollbar.scrollbarThickness,e.hasTrashcan&&(i=t.trashcan.init(i)),e.zoomOptions&&e.zoomOptions.controls&&t.zoomControls_.init(i),e.moveOptions&&e.moveOptions.scrollbars?(t.scrollbar=new n.ScrollbarPair(t),t.scrollbar.resize()):t.setMetrics({x:.5,y:.5}),e.hasSounds&&n.inject.loadSounds_(e.pathToMedia,t)},n.inject.bindDocumentEvents_=function(){n.documentEventsBound_||(n.bindEventWithChecks_(document,"scroll",null,(function(){for(var t,e=n.Workspace.getAll(),i=0;t=e[i];i++)t.updateInverseScreenCTM&&t.updateInverseScreenCTM()})),n.bindEventWithChecks_(document,"keydown",null,n.onKeyDown),n.bindEvent_(document,"touchend",null,n.longStop_),n.bindEvent_(document,"touchcancel",null,n.longStop_),n.utils.userAgent.IPAD&&n.bindEventWithChecks_(window,"orientationchange",document,(function(){n.svgResize(n.getMainWorkspace())}))),n.documentEventsBound_=!0},n.inject.loadSounds_=function(t,e){var i=e.getAudioManager();i.load([t+"click.mp3",t+"click.wav",t+"click.ogg"],"click"),i.load([t+"disconnect.wav",t+"disconnect.mp3",t+"disconnect.ogg"],"disconnect"),i.load([t+"delete.mp3",t+"delete.ogg",t+"delete.wav"],"delete");var o=[];t=function(){for(;o.length;)n.unbindEvent_(o.pop());i.preload()},o.push(n.bindEventWithChecks_(document,"mousemove",null,t,!0)),o.push(n.bindEventWithChecks_(document,"touchstart",null,t,!0))},n.Names=function(t,e){if(this.variablePrefix_=e||"",this.reservedDict_=Object.create(null),t)for(t=t.split(","),e=0;e<t.length;e++)this.reservedDict_[t[e]]=!0;this.reset()},n.Names.DEVELOPER_VARIABLE_TYPE="DEVELOPER_VARIABLE",n.Names.prototype.reset=function(){this.db_=Object.create(null),this.dbReverse_=Object.create(null),this.variableMap_=null},n.Names.prototype.setVariableMap=function(t){this.variableMap_=t},n.Names.prototype.getNameForUserVariable_=function(t){return this.variableMap_?(t=this.variableMap_.getVariableById(t))?t.name:null:(console.log("Deprecated call to Blockly.Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:\nBlockly.YourGeneratorName.variableDB_.setVariableMap(workspace.getVariableMap());"),null)},n.Names.prototype.getName=function(t,e){if(e==n.VARIABLE_CATEGORY_NAME){var i=this.getNameForUserVariable_(t);i&&(t=i)}i=t.toLowerCase()+"_"+e;var o=e==n.VARIABLE_CATEGORY_NAME||e==n.Names.DEVELOPER_VARIABLE_TYPE?this.variablePrefix_:"";return i in this.db_?o+this.db_[i]:(t=this.getDistinctName(t,e),this.db_[i]=t.substr(o.length),t)},n.Names.prototype.getDistinctName=function(t,e){t=this.safeName_(t);for(var i="";this.dbReverse_[t+i]||t+i in this.reservedDict_;)i=i?i+1:2;return t+=i,this.dbReverse_[t]=!0,(e==n.VARIABLE_CATEGORY_NAME||e==n.Names.DEVELOPER_VARIABLE_TYPE?this.variablePrefix_:"")+t},n.Names.prototype.safeName_=function(t){return t?(t=encodeURI(t.replace(/ /g,"_")).replace(/[^\w]/g,"_"),-1!="0123456789".indexOf(t[0])&&(t="my_"+t)):t=n.Msg.UNNAMED_KEY||"unnamed",t},n.Names.equals=function(t,e){return t.toLowerCase()==e.toLowerCase()},n.Procedures={},n.Procedures.NAME_TYPE=n.PROCEDURE_CATEGORY_NAME,n.Procedures.DEFAULT_ARG="x",n.Procedures.allProcedures=function(t){var e=t.getBlocksByType("procedures_defnoreturn",!1).map((function(t){return t.getProcedureDef()}));return t=t.getBlocksByType("procedures_defreturn",!1).map((function(t){return t.getProcedureDef()})),e.sort(n.Procedures.procTupleComparator_),t.sort(n.Procedures.procTupleComparator_),[e,t]},n.Procedures.procTupleComparator_=function(t,e){return t[0].toLowerCase().localeCompare(e[0].toLowerCase())},n.Procedures.findLegalName=function(t,e){if(e.isInFlyout)return t;for(t=t||n.Msg.UNNAMED_KEY||"unnamed";!n.Procedures.isLegalName_(t,e.workspace,e);){var i=t.match(/^(.*?)(\d+)$/);t=i?i[1]+(parseInt(i[2],10)+1):t+"2"}return t},n.Procedures.isLegalName_=function(t,e,i){return!n.Procedures.isNameUsed(t,e,i)},n.Procedures.isNameUsed=function(t,e,i){e=e.getAllBlocks(!1);for(var o=0;o<e.length;o++)if(e[o]!=i&&e[o].getProcedureDef){var r=e[o].getProcedureDef();if(n.Names.equals(r[0],t))return!0}return!1},n.Procedures.rename=function(t){t=t.trim();var e=n.Procedures.findLegalName(t,this.getSourceBlock()),i=this.getValue();if(i!=t&&i!=e){t=this.getSourceBlock().workspace.getAllBlocks(!1);for(var o=0;o<t.length;o++)t[o].renameProcedure&&t[o].renameProcedure(i,e)}return e},n.Procedures.flyoutCategory=function(t){function e(t,e){for(var o=0;o<t.length;o++){var r=t[o][0],s=t[o][1],a=n.utils.xml.createElement("block");a.setAttribute("type",e),a.setAttribute("gap",16);var l=n.utils.xml.createElement("mutation");for(l.setAttribute("name",r),a.appendChild(l),r=0;r<s.length;r++){var c=n.utils.xml.createElement("arg");c.setAttribute("name",s[r]),l.appendChild(c)}i.push(a)}}var i=[];if(n.Blocks.procedures_defnoreturn){var o=n.utils.xml.createElement("block");o.setAttribute("type","procedures_defnoreturn"),o.setAttribute("gap",16);var r=n.utils.xml.createElement("field");r.setAttribute("name","NAME"),r.appendChild(n.utils.xml.createTextNode(n.Msg.PROCEDURES_DEFNORETURN_PROCEDURE)),o.appendChild(r),i.push(o)}return n.Blocks.procedures_defreturn&&((o=n.utils.xml.createElement("block")).setAttribute("type","procedures_defreturn"),o.setAttribute("gap",16),(r=n.utils.xml.createElement("field")).setAttribute("name","NAME"),r.appendChild(n.utils.xml.createTextNode(n.Msg.PROCEDURES_DEFRETURN_PROCEDURE)),o.appendChild(r),i.push(o)),n.Blocks.procedures_ifreturn&&((o=n.utils.xml.createElement("block")).setAttribute("type","procedures_ifreturn"),o.setAttribute("gap",16),i.push(o)),i.length&&i[i.length-1].setAttribute("gap",24),e((t=n.Procedures.allProcedures(t))[0],"procedures_callnoreturn"),e(t[1],"procedures_callreturn"),i},n.Procedures.updateMutatorFlyout_=function(t){for(var e,i=[],o=t.getBlocksByType("procedures_mutatorarg",!1),r=0;e=o[r];r++)i.push(e.getFieldValue("NAME"));o=n.utils.xml.createElement("xml"),(r=n.utils.xml.createElement("block")).setAttribute("type","procedures_mutatorarg"),(e=n.utils.xml.createElement("field")).setAttribute("name","NAME"),i=n.Variables.generateUniqueNameFromOptions(n.Procedures.DEFAULT_ARG,i),i=n.utils.xml.createTextNode(i),e.appendChild(i),r.appendChild(e),o.appendChild(r),t.updateToolbox(o)},n.Procedures.mutatorOpenListener=function(t){if(t.type==n.Events.BUBBLE_OPEN&&"mutator"===t.bubbleType&&t.isOpen){var e=(t=n.Workspace.getById(t.workspaceId).getBlockById(t.blockId)).type;"procedures_defnoreturn"!=e&&"procedures_defreturn"!=e||(t=t.mutator.getWorkspace(),n.Procedures.updateMutatorFlyout_(t),t.addChangeListener(n.Procedures.mutatorChangeListener_))}},n.Procedures.mutatorChangeListener_=function(t){t.type!=n.Events.BLOCK_CREATE&&t.type!=n.Events.BLOCK_DELETE&&t.type!=n.Events.BLOCK_CHANGE||(t=n.Workspace.getById(t.workspaceId),n.Procedures.updateMutatorFlyout_(t))},n.Procedures.getCallers=function(t,e){var i=[];e=e.getAllBlocks(!1);for(var o=0;o<e.length;o++)if(e[o].getProcedureCall){var r=e[o].getProcedureCall();r&&n.Names.equals(r,t)&&i.push(e[o])}return i},n.Procedures.mutateCallers=function(t){var e,i=n.Events.recordUndo,o=t.getProcedureDef()[0],r=t.mutationToDom(!0);for(t=n.Procedures.getCallers(o,t.workspace),o=0;e=t[o];o++){var s=e.mutationToDom();s=s&&n.Xml.domToText(s),e.domToMutation(r);var a=e.mutationToDom();s!=(a=a&&n.Xml.domToText(a))&&(n.Events.recordUndo=!1,n.Events.fire(new n.Events.BlockChange(e,"mutation",null,s,a)),n.Events.recordUndo=i)}},n.Procedures.getDefinition=function(t,e){e=e.getTopBlocks(!1);for(var i=0;i<e.length;i++)if(e[i].getProcedureDef){var o=e[i].getProcedureDef();if(o&&n.Names.equals(o[0],t))return e[i]}return null},n.ShortcutItems={},n.ShortcutItems.names={ESCAPE:"escape",DELETE:"delete",COPY:"copy",CUT:"cut",PASTE:"paste",UNDO:"undo",REDO:"redo"},n.ShortcutItems.registerEscape=function(){var t={name:n.ShortcutItems.names.ESCAPE,preconditionFn:function(t){return!t.options.readOnly},callback:function(){return n.hideChaff(),!0}};n.ShortcutRegistry.registry.register(t),n.ShortcutRegistry.registry.addKeyMapping(n.utils.KeyCodes.ESC,t.name)},n.ShortcutItems.registerDelete=function(){var t={name:n.ShortcutItems.names.DELETE,preconditionFn:function(t){return!t.options.readOnly&&n.selected&&n.selected.isDeletable()},callback:function(t,e){return e.preventDefault(),!n.Gesture.inProgress()&&(n.deleteBlock(n.selected),!0)}};n.ShortcutRegistry.registry.register(t),n.ShortcutRegistry.registry.addKeyMapping(n.utils.KeyCodes.DELETE,t.name),n.ShortcutRegistry.registry.addKeyMapping(n.utils.KeyCodes.BACKSPACE,t.name)},n.ShortcutItems.registerCopy=function(){var t={name:n.ShortcutItems.names.COPY,preconditionFn:function(t){return!t.options.readOnly&&!n.Gesture.inProgress()&&n.selected&&n.selected.isDeletable()&&n.selected.isMovable()},callback:function(){return n.hideChaff(),n.copy(n.selected),!0}};n.ShortcutRegistry.registry.register(t);var e=n.ShortcutRegistry.registry.createSerializedKey(n.utils.KeyCodes.C,[n.utils.KeyCodes.CTRL]);n.ShortcutRegistry.registry.addKeyMapping(e,t.name),e=n.ShortcutRegistry.registry.createSerializedKey(n.utils.KeyCodes.C,[n.utils.KeyCodes.ALT]),n.ShortcutRegistry.registry.addKeyMapping(e,t.name),e=n.ShortcutRegistry.registry.createSerializedKey(n.utils.KeyCodes.C,[n.utils.KeyCodes.META]),n.ShortcutRegistry.registry.addKeyMapping(e,t.name)},n.ShortcutItems.registerCut=function(){var t={name:n.ShortcutItems.names.CUT,preconditionFn:function(t){return!t.options.readOnly&&!n.Gesture.inProgress()&&n.selected&&n.selected.isDeletable()&&n.selected.isMovable()&&!n.selected.workspace.isFlyout},callback:function(){return n.copy(n.selected),n.deleteBlock(n.selected),!0}};n.ShortcutRegistry.registry.register(t);var e=n.ShortcutRegistry.registry.createSerializedKey(n.utils.KeyCodes.X,[n.utils.KeyCodes.CTRL]);n.ShortcutRegistry.registry.addKeyMapping(e,t.name),e=n.ShortcutRegistry.registry.createSerializedKey(n.utils.KeyCodes.X,[n.utils.KeyCodes.ALT]),n.ShortcutRegistry.registry.addKeyMapping(e,t.name),e=n.ShortcutRegistry.registry.createSerializedKey(n.utils.KeyCodes.X,[n.utils.KeyCodes.META]),n.ShortcutRegistry.registry.addKeyMapping(e,t.name)},n.ShortcutItems.registerPaste=function(){var t={name:n.ShortcutItems.names.PASTE,preconditionFn:function(t){return!t.options.readOnly&&!n.Gesture.inProgress()},callback:function(){return n.paste()}};n.ShortcutRegistry.registry.register(t);var e=n.ShortcutRegistry.registry.createSerializedKey(n.utils.KeyCodes.V,[n.utils.KeyCodes.CTRL]);n.ShortcutRegistry.registry.addKeyMapping(e,t.name),e=n.ShortcutRegistry.registry.createSerializedKey(n.utils.KeyCodes.V,[n.utils.KeyCodes.ALT]),n.ShortcutRegistry.registry.addKeyMapping(e,t.name),e=n.ShortcutRegistry.registry.createSerializedKey(n.utils.KeyCodes.V,[n.utils.KeyCodes.META]),n.ShortcutRegistry.registry.addKeyMapping(e,t.name)},n.ShortcutItems.registerUndo=function(){var t={name:n.ShortcutItems.names.UNDO,preconditionFn:function(t){return!t.options.readOnly&&!n.Gesture.inProgress()},callback:function(t){return n.hideChaff(),t.undo(!1),!0}};n.ShortcutRegistry.registry.register(t);var e=n.ShortcutRegistry.registry.createSerializedKey(n.utils.KeyCodes.Z,[n.utils.KeyCodes.CTRL]);n.ShortcutRegistry.registry.addKeyMapping(e,t.name),e=n.ShortcutRegistry.registry.createSerializedKey(n.utils.KeyCodes.Z,[n.utils.KeyCodes.ALT]),n.ShortcutRegistry.registry.addKeyMapping(e,t.name),e=n.ShortcutRegistry.registry.createSerializedKey(n.utils.KeyCodes.Z,[n.utils.KeyCodes.META]),n.ShortcutRegistry.registry.addKeyMapping(e,t.name)},n.ShortcutItems.registerRedo=function(){var t={name:n.ShortcutItems.names.REDO,preconditionFn:function(t){return!n.Gesture.inProgress()&&!t.options.readOnly},callback:function(t){return n.hideChaff(),t.undo(!0),!0}};n.ShortcutRegistry.registry.register(t);var e=n.ShortcutRegistry.registry.createSerializedKey(n.utils.KeyCodes.Z,[n.utils.KeyCodes.SHIFT,n.utils.KeyCodes.CTRL]);n.ShortcutRegistry.registry.addKeyMapping(e,t.name),e=n.ShortcutRegistry.registry.createSerializedKey(n.utils.KeyCodes.Z,[n.utils.KeyCodes.SHIFT,n.utils.KeyCodes.ALT]),n.ShortcutRegistry.registry.addKeyMapping(e,t.name),e=n.ShortcutRegistry.registry.createSerializedKey(n.utils.KeyCodes.Z,[n.utils.KeyCodes.SHIFT,n.utils.KeyCodes.META]),n.ShortcutRegistry.registry.addKeyMapping(e,t.name),e=n.ShortcutRegistry.registry.createSerializedKey(n.utils.KeyCodes.Y,[n.utils.KeyCodes.CTRL]),n.ShortcutRegistry.registry.addKeyMapping(e,t.name)},n.ShortcutItems.registerDefaultShortcuts=function(){n.ShortcutItems.registerEscape(),n.ShortcutItems.registerDelete(),n.ShortcutItems.registerCopy(),n.ShortcutItems.registerCut(),n.ShortcutItems.registerPaste(),n.ShortcutItems.registerUndo(),n.ShortcutItems.registerRedo()},n.ShortcutRegistry=function(){n.ShortcutRegistry.registry=this,this.registry_=Object.create(null),this.keyMap_=Object.create(null),n.ShortcutItems.registerDefaultShortcuts(),n.navigation.registerNavigationShortcuts()},n.ShortcutRegistry.modifierKeys={Shift:n.utils.KeyCodes.SHIFT,Control:n.utils.KeyCodes.CTRL,Alt:n.utils.KeyCodes.ALT,Meta:n.utils.KeyCodes.META},n.ShortcutRegistry.prototype.register=function(t,e){if(this.registry_[t.name]&&!e)throw Error('Shortcut with name "'+t.name+'" already exists.');this.registry_[t.name]=t},n.ShortcutRegistry.prototype.unregister=function(t){return this.registry_[t]?(this.removeAllKeyMappings(t),delete this.registry_[t],!0):(console.warn('Keyboard shortcut with name "'+t+'" not found.'),!1)},n.ShortcutRegistry.prototype.addKeyMapping=function(t,e,n){var i=this.keyMap_[t];if(i&&!n)throw Error('Shortcut with name "'+e+'" collides with shortcuts '+i.toString());i&&n?i.unshift(e):this.keyMap_[t]=[e]},n.ShortcutRegistry.prototype.removeKeyMapping=function(t,e,n){var i=this.keyMap_[t];if(!i&&!n)return console.warn('No keyboard shortcut with name "'+e+'" registered with key code "'+t+'"'),!1;var o=i.indexOf(e);return-1<o?(i.splice(o,1),0==i.length&&delete this.keyMap_[t],!0):(n||console.warn('No keyboard shortcut with name "'+e+'" registered with key code "'+t+'"'),!1)},n.ShortcutRegistry.prototype.removeAllKeyMappings=function(t){for(var e in this.keyMap_)this.removeKeyMapping(e,t,!0)},n.ShortcutRegistry.prototype.setKeyMap=function(t){this.keyMap_=t},n.ShortcutRegistry.prototype.getKeyMap=function(){return n.utils.object.deepMerge(Object.create(null),this.keyMap_)},n.ShortcutRegistry.prototype.getRegistry=function(){return n.utils.object.deepMerge(Object.create(null),this.registry_)},n.ShortcutRegistry.prototype.onKeyDown=function(t,e){var n=this.serializeKeyEvent_(e);if(!(n=this.getShortcutNamesByKeyCode(n)))return!1;for(var i,o=0;i=n[o];o++)if((!(i=this.registry_[i]).preconditionFn||i.preconditionFn(t))&&i.callback&&i.callback(t,e,i))return!0;return!1},n.ShortcutRegistry.prototype.getShortcutNamesByKeyCode=function(t){return this.keyMap_[t]||[]},n.ShortcutRegistry.prototype.getKeyCodesByShortcutName=function(t){var e,n=[];for(e in this.keyMap_)-1<this.keyMap_[e].indexOf(t)&&n.push(e);return n},n.ShortcutRegistry.prototype.serializeKeyEvent_=function(t){var e,i="";for(e in n.ShortcutRegistry.modifierKeys)t.getModifierState(e)&&(""!=i&&(i+="+"),i+=e);return""!=i&&t.keyCode?i=i+"+"+t.keyCode:t.keyCode&&(i=t.keyCode.toString()),i},n.ShortcutRegistry.prototype.checkModifiers_=function(t){for(var e,i=n.utils.object.values(n.ShortcutRegistry.modifierKeys),o=0;e=t[o];o++)if(0>i.indexOf(e))throw Error(e+" is not a valid modifier key.")},n.ShortcutRegistry.prototype.createSerializedKey=function(t,e){var i="";if(e)for(var o in this.checkModifiers_(e),n.ShortcutRegistry.modifierKeys)-1<e.indexOf(n.ShortcutRegistry.modifierKeys[o])&&(""!=i&&(i+="+"),i+=o);return""!=i&&t?i=i+"+"+t:t&&(i=t.toString()),i},new n.ShortcutRegistry,n.VariableModel=function(t,e,i,o){this.workspace=t,this.name=e,this.type=i||"",this.id_=o||n.utils.genUid(),n.Events.fire(new n.Events.VarCreate(this))},n.VariableModel.prototype.getId=function(){return this.id_},n.VariableModel.compareByName=function(t,e){return(t=t.name.toLowerCase())<(e=e.name.toLowerCase())?-1:t==e?0:1},n.Variables={},n.Variables.NAME_TYPE=n.VARIABLE_CATEGORY_NAME,n.Variables.allUsedVarModels=function(t){var e=t.getAllBlocks(!1);t=Object.create(null);for(var n=0;n<e.length;n++){var i=e[n].getVarModels();if(i)for(var o=0;o<i.length;o++){var r=i[o],s=r.getId();s&&(t[s]=r)}}for(s in e=[],t)e.push(t[s]);return e},n.Variables.ALL_DEVELOPER_VARS_WARNINGS_BY_BLOCK_TYPE_={},n.Variables.allDeveloperVariables=function(t){t=t.getAllBlocks(!1);for(var e,i=Object.create(null),o=0;e=t[o];o++){var r=e.getDeveloperVariables;if(!r&&e.getDeveloperVars&&(r=e.getDeveloperVars,n.Variables.ALL_DEVELOPER_VARS_WARNINGS_BY_BLOCK_TYPE_[e.type]||(console.warn("Function getDeveloperVars() deprecated. Use getDeveloperVariables() (block type '"+e.type+"')"),n.Variables.ALL_DEVELOPER_VARS_WARNINGS_BY_BLOCK_TYPE_[e.type]=!0)),r)for(e=r(),r=0;r<e.length;r++)i[e[r]]=!0}return Object.keys(i)},n.Variables.flyoutCategory=function(t){var e=[],i=document.createElement("button");return i.setAttribute("text","%{BKY_NEW_VARIABLE}"),i.setAttribute("callbackKey","CREATE_VARIABLE"),t.registerButtonCallback("CREATE_VARIABLE",(function(t){n.Variables.createVariableButtonHandler(t.getTargetWorkspace())})),e.push(i),t=n.Variables.flyoutCategoryBlocks(t),e.concat(t)},n.Variables.flyoutCategoryBlocks=function(t){var e=[];if(0<(t=t.getVariablesOfType("")).length){var i=t[t.length-1];if(n.Blocks.variables_set){var o=n.utils.xml.createElement("block");o.setAttribute("type","variables_set"),o.setAttribute("gap",n.Blocks.math_change?8:24),o.appendChild(n.Variables.generateVariableFieldDom(i)),e.push(o)}if(n.Blocks.math_change&&((o=n.utils.xml.createElement("block")).setAttribute("type","math_change"),o.setAttribute("gap",n.Blocks.variables_get?20:8),o.appendChild(n.Variables.generateVariableFieldDom(i)),i=n.Xml.textToDom('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),o.appendChild(i),e.push(o)),n.Blocks.variables_get){t.sort(n.VariableModel.compareByName),i=0;for(var r;r=t[i];i++)(o=n.utils.xml.createElement("block")).setAttribute("type","variables_get"),o.setAttribute("gap",8),o.appendChild(n.Variables.generateVariableFieldDom(r)),e.push(o)}}return e},n.Variables.VAR_LETTER_OPTIONS="ijkmnopqrstuvwxyzabcdefgh",n.Variables.generateUniqueName=function(t){return n.Variables.generateUniqueNameFromOptions(n.Variables.VAR_LETTER_OPTIONS.charAt(0),t.getAllVariableNames())},n.Variables.generateUniqueNameFromOptions=function(t,e){if(!e.length)return t;for(var i=n.Variables.VAR_LETTER_OPTIONS,o="",r=i.indexOf(t);;){for(var s=!1,a=0;a<e.length;a++)if(e[a].toLowerCase()==t){s=!0;break}if(!s)return t;++r==i.length&&(r=0,o=Number(o)+1),t=i.charAt(r)+o}},n.Variables.createVariableButtonHandler=function(t,e,i){var o=i||"",r=function(i){n.Variables.promptName(n.Msg.NEW_VARIABLE_TITLE,i,(function(i){if(i){var s=n.Variables.nameUsedWithAnyType(i,t);if(s){if(s.type==o)var a=n.Msg.VARIABLE_ALREADY_EXISTS.replace("%1",s.name);else a=(a=n.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE).replace("%1",s.name).replace("%2",s.type);n.alert(a,(function(){r(i)}))}else t.createVariable(i,o),e&&e(i)}else e&&e(null)}))};r("")},n.Variables.createVariable=n.Variables.createVariableButtonHandler,n.Variables.renameVariable=function(t,e,i){var o=function(r){var s=n.Msg.RENAME_VARIABLE_TITLE.replace("%1",e.name);n.Variables.promptName(s,r,(function(r){if(r){var s=n.Variables.nameUsedWithOtherType_(r,e.type,t);s?(s=n.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",s.name).replace("%2",s.type),n.alert(s,(function(){o(r)}))):(t.renameVariableById(e.getId(),r),i&&i(r))}else i&&i(null)}))};o("")},n.Variables.promptName=function(t,e,i){n.prompt(t,e,(function(t){t&&((t=t.replace(/[\s\xa0]+/g," ").trim())==n.Msg.RENAME_VARIABLE||t==n.Msg.NEW_VARIABLE)&&(t=null),i(t)}))},n.Variables.nameUsedWithOtherType_=function(t,e,n){n=n.getVariableMap().getAllVariables(),t=t.toLowerCase();for(var i,o=0;i=n[o];o++)if(i.name.toLowerCase()==t&&i.type!=e)return i;return null},n.Variables.nameUsedWithAnyType=function(t,e){e=e.getVariableMap().getAllVariables(),t=t.toLowerCase();for(var n,i=0;n=e[i];i++)if(n.name.toLowerCase()==t)return n;return null},n.Variables.generateVariableFieldDom=function(t){var e=n.utils.xml.createElement("field");return e.setAttribute("name","VAR"),e.setAttribute("id",t.getId()),e.setAttribute("variabletype",t.type),t=n.utils.xml.createTextNode(t.name),e.appendChild(t),e},n.Variables.getOrCreateVariablePackage=function(t,e,i,o){var r=n.Variables.getVariable(t,e,i,o);return r||(r=n.Variables.createVariable_(t,e,i,o)),r},n.Variables.getVariable=function(t,e,n,i){var o=t.getPotentialVariableMap(),r=null;if(e&&(!(r=t.getVariableById(e))&&o&&(r=o.getVariableById(e)),r))return r;if(n){if(null==i)throw Error("Tried to look up a variable by name without a type");!(r=t.getVariable(n,i))&&o&&(r=o.getVariable(n,i))}return r},n.Variables.createVariable_=function(t,e,i,o){var r=t.getPotentialVariableMap();return i||(i=n.Variables.generateUniqueName(t.isFlyout?t.targetWorkspace:t)),r?r.createVariable(i,o,e):t.createVariable(i,o,e)},n.Variables.getAddedVariables=function(t,e){t=t.getAllVariables();var n=[];if(e.length!=t.length)for(var i=0;i<t.length;i++){var o=t[i];-1==e.indexOf(o)&&n.push(o)}return n},n.WidgetDiv={},n.WidgetDiv.owner_=null,n.WidgetDiv.dispose_=null,n.WidgetDiv.rendererClassName_="",n.WidgetDiv.themeClassName_="",n.WidgetDiv.createDom=function(){n.WidgetDiv.DIV||(n.WidgetDiv.DIV=document.createElement("div"),n.WidgetDiv.DIV.className="blocklyWidgetDiv",(n.parentContainer||document.body).appendChild(n.WidgetDiv.DIV))},n.WidgetDiv.show=function(t,e,i){n.WidgetDiv.hide(),n.WidgetDiv.owner_=t,n.WidgetDiv.dispose_=i,(t=n.WidgetDiv.DIV).style.direction=e?"rtl":"ltr",t.style.display="block",e=n.getMainWorkspace(),n.WidgetDiv.rendererClassName_=e.getRenderer().getClassName(),n.WidgetDiv.themeClassName_=e.getTheme().getClassName(),n.utils.dom.addClass(t,n.WidgetDiv.rendererClassName_),n.utils.dom.addClass(t,n.WidgetDiv.themeClassName_)},n.WidgetDiv.hide=function(){if(n.WidgetDiv.isVisible()){n.WidgetDiv.owner_=null;var t=n.WidgetDiv.DIV;t.style.display="none",t.style.left="",t.style.top="",n.WidgetDiv.dispose_&&n.WidgetDiv.dispose_(),n.WidgetDiv.dispose_=null,t.textContent="",n.WidgetDiv.rendererClassName_&&(n.utils.dom.removeClass(t,n.WidgetDiv.rendererClassName_),n.WidgetDiv.rendererClassName_=""),n.WidgetDiv.themeClassName_&&(n.utils.dom.removeClass(t,n.WidgetDiv.themeClassName_),n.WidgetDiv.themeClassName_=""),n.getMainWorkspace().markFocused()}},n.WidgetDiv.isVisible=function(){return!!n.WidgetDiv.owner_},n.WidgetDiv.hideIfOwner=function(t){n.WidgetDiv.owner_==t&&n.WidgetDiv.hide()},n.WidgetDiv.positionInternal_=function(t,e,i){n.WidgetDiv.DIV.style.left=t+"px",n.WidgetDiv.DIV.style.top=e+"px",n.WidgetDiv.DIV.style.height=i+"px"},n.WidgetDiv.positionWithAnchor=function(t,e,i,o){var r=n.WidgetDiv.calculateY_(t,e,i);t=n.WidgetDiv.calculateX_(t,e,i,o),0>r?n.WidgetDiv.positionInternal_(t,0,i.height+r):n.WidgetDiv.positionInternal_(t,r,i.height)},n.WidgetDiv.calculateX_=function(t,e,n,i){return i?(e=Math.max(e.right-n.width,t.left),Math.min(e,t.right-n.width)):(e=Math.min(e.left,t.right-n.width),Math.max(e,t.left))},n.WidgetDiv.calculateY_=function(t,e,n){return e.bottom+n.height>=t.bottom?e.top-n.height:e.bottom},n.VERSION="4.20201217.0",n.mainWorkspace=null,n.selected=null,n.draggingConnections=[],n.clipboardXml_=null,n.clipboardSource_=null,n.clipboardTypeCounts_=null,n.cache3dSupported_=null,n.parentContainer=null,n.svgSize=function(t){return new n.utils.Size(t.cachedWidth_,t.cachedHeight_)},n.resizeSvgContents=function(t){t.resizeContents()},n.svgResize=function(t){for(;t.options.parentWorkspace;)t=t.options.parentWorkspace;var e=t.getParentSvg(),n=e.parentNode;if(n){var i=n.offsetWidth;n=n.offsetHeight,e.cachedWidth_!=i&&(e.setAttribute("width",i+"px"),e.cachedWidth_=i),e.cachedHeight_!=n&&(e.setAttribute("height",n+"px"),e.cachedHeight_=n),t.resize()}},n.onKeyDown=function(t){var e=n.mainWorkspace;e&&!(n.utils.isTargetInput(t)||e.rendered&&!e.isVisible())&&n.ShortcutRegistry.registry.onKeyDown(e,t)},n.deleteBlock=function(t){t.workspace.isFlyout||(n.Events.setGroup(!0),n.hideChaff(),t.dispose(!0,!0),n.Events.setGroup(!1))},n.copy=function(t){(t=t.toCopyData())&&(n.clipboardXml_=t.xml,n.clipboardSource_=t.source,n.clipboardTypeCounts_=t.typeCounts)},n.paste=function(){if(!n.clipboardXml_)return!1;var t=n.clipboardSource_;return t.isFlyout&&(t=t.targetWorkspace),!(!n.clipboardTypeCounts_||!t.isCapacityAvailable(n.clipboardTypeCounts_)||(n.Events.setGroup(!0),t.paste(n.clipboardXml_),n.Events.setGroup(!1),0))},n.duplicate=function(t){var e=n.clipboardXml_,i=n.clipboardSource_;n.copy(t),t.workspace.paste(n.clipboardXml_),n.clipboardXml_=e,n.clipboardSource_=i},n.onContextMenu_=function(t){n.utils.isTargetInput(t)||t.preventDefault()},n.hideChaff=function(t){n.Tooltip.hide(),n.WidgetDiv.hide(),n.DropDownDiv.hideWithoutAnimation(),t||((t=n.getMainWorkspace()).trashcan&&t.trashcan.flyout&&t.trashcan.closeFlyout(),(t=t.getToolbox())&&t.getFlyout()&&t.getFlyout().autoClose&&t.clearSelection())},n.getMainWorkspace=function(){return n.mainWorkspace},n.alert=function(t,e){alert(t),e&&e()},n.confirm=function(t,e){e(confirm(t))},n.prompt=function(t,e,n){n(prompt(t,e))},n.jsonInitFactory_=function(t){return function(){this.jsonInit(t)}},n.defineBlocksWithJsonArray=function(t){for(var e=0;e<t.length;e++){var i=t[e];if(i){var o=i.type;null==o||""===o?console.warn("Block definition #"+e+" in JSON array is missing a type attribute. Skipping."):(n.Blocks[o]&&console.warn("Block definition #"+e+' in JSON array overwrites prior definition of "'+o+'".'),n.Blocks[o]={init:n.jsonInitFactory_(i)})}else console.warn("Block definition #"+e+" in JSON array is "+i+". Skipping.")}},n.bindEventWithChecks_=function(t,e,i,o,r,s){var a=!1,l=function(t){var e=!r;t=n.Touch.splitEventByTouches(t);for(var s,l=0;s=t[l];l++)e&&!n.Touch.shouldHandleEvent(s)||(n.Touch.setClientFromTouch(s),i?o.call(i,s):o(s),a=!0)},c=[];if(n.utils.global.PointerEvent&&e in n.Touch.TOUCH_MAP)for(var d,u=0;d=n.Touch.TOUCH_MAP[e][u];u++)t.addEventListener(d,l,!1),c.push([t,d,l]);else if(t.addEventListener(e,l,!1),c.push([t,e,l]),e in n.Touch.TOUCH_MAP){var h=function(t){l(t),a&&!s&&t.preventDefault()};for(u=0;d=n.Touch.TOUCH_MAP[e][u];u++)t.addEventListener(d,h,!1),c.push([t,d,h])}return c},n.bindEvent_=function(t,e,i,o){var r=function(t){i?o.call(i,t):o(t)},s=[];if(n.utils.global.PointerEvent&&e in n.Touch.TOUCH_MAP)for(var a,l=0;a=n.Touch.TOUCH_MAP[e][l];l++)t.addEventListener(a,r,!1),s.push([t,a,r]);else if(t.addEventListener(e,r,!1),s.push([t,e,r]),e in n.Touch.TOUCH_MAP){var c=function(t){if(t.changedTouches&&1==t.changedTouches.length){var e=t.changedTouches[0];t.clientX=e.clientX,t.clientY=e.clientY}r(t),t.preventDefault()};for(l=0;a=n.Touch.TOUCH_MAP[e][l];l++)t.addEventListener(a,c,!1),s.push([t,a,c])}return s},n.unbindEvent_=function(t){for(;t.length;){var e=t.pop(),n=e[2];e[0].removeEventListener(e[1],n,!1)}return n},n.isNumber=function(t){return/^\s*-?\d+(\.\d+)?\s*$/.test(t)},n.hueToHex=function(t){return n.utils.colour.hsvToHex(t,n.HSV_SATURATION,255*n.HSV_VALUE)},n.checkBlockColourConstants=function(){n.checkBlockColourConstant_("LOGIC_HUE",["Blocks","logic","HUE"],void 0),n.checkBlockColourConstant_("LOGIC_HUE",["Constants","Logic","HUE"],210),n.checkBlockColourConstant_("LOOPS_HUE",["Blocks","loops","HUE"],void 0),n.checkBlockColourConstant_("LOOPS_HUE",["Constants","Loops","HUE"],120),n.checkBlockColourConstant_("MATH_HUE",["Blocks","math","HUE"],void 0),n.checkBlockColourConstant_("MATH_HUE",["Constants","Math","HUE"],230),n.checkBlockColourConstant_("TEXTS_HUE",["Blocks","texts","HUE"],void 0),n.checkBlockColourConstant_("TEXTS_HUE",["Constants","Text","HUE"],160),n.checkBlockColourConstant_("LISTS_HUE",["Blocks","lists","HUE"],void 0),n.checkBlockColourConstant_("LISTS_HUE",["Constants","Lists","HUE"],260),n.checkBlockColourConstant_("COLOUR_HUE",["Blocks","colour","HUE"],void 0),n.checkBlockColourConstant_("COLOUR_HUE",["Constants","Colour","HUE"],20),n.checkBlockColourConstant_("VARIABLES_HUE",["Blocks","variables","HUE"],void 0),n.checkBlockColourConstant_("VARIABLES_HUE",["Constants","Variables","HUE"],330),n.checkBlockColourConstant_("VARIABLES_DYNAMIC_HUE",["Constants","VariablesDynamic","HUE"],310),n.checkBlockColourConstant_("PROCEDURES_HUE",["Blocks","procedures","HUE"],void 0)},n.checkBlockColourConstant_=function(t,e,i){for(var o="Blockly",r=n,s=0;s<e.length;++s)o+="."+e[s],r&&(r=r[e[s]]);r&&r!==i&&(t=(void 0===i?'%1 has been removed. Use Blockly.Msg["%2"].':'%1 is deprecated and unused. Override Blockly.Msg["%2"].').replace("%1",o).replace("%2",t),console.warn(t))},n.setParentContainer=function(t){n.parentContainer=t},n.Events.BubbleOpen=function(t,e,i){n.Events.BubbleOpen.superClass_.constructor.call(this,t?t.workspace.id:void 0),this.blockId=t?t.id:null,this.isOpen=e,this.bubbleType=i},n.utils.object.inherits(n.Events.BubbleOpen,n.Events.UiBase),n.Events.BubbleOpen.prototype.type=n.Events.BUBBLE_OPEN,n.Events.BubbleOpen.prototype.toJson=function(){var t=n.Events.BubbleOpen.superClass_.toJson.call(this);return t.isOpen=this.isOpen,t.bubbleType=this.bubbleType,t.blockId=this.blockId,t},n.Events.BubbleOpen.prototype.fromJson=function(t){n.Events.BubbleOpen.superClass_.fromJson.call(this,t),this.isOpen=t.isOpen,this.bubbleType=t.bubbleType,this.blockId=t.blockId},n.registry.register(n.registry.Type.EVENT,n.Events.BUBBLE_OPEN,n.Events.BubbleOpen),n.Icon=function(t){this.block_=t,this.iconGroup_=null},n.Icon.prototype.collapseHidden=!0,n.Icon.prototype.SIZE=17,n.Icon.prototype.bubble_=null,n.Icon.prototype.iconXY_=null,n.Icon.prototype.createIcon=function(){this.iconGroup_||(this.iconGroup_=n.utils.dom.createSvgElement(n.utils.Svg.G,{class:"blocklyIconGroup"},null),this.block_.isInFlyout&&n.utils.dom.addClass(this.iconGroup_,"blocklyIconGroupReadonly"),this.drawIcon_(this.iconGroup_),this.block_.getSvgRoot().appendChild(this.iconGroup_),n.bindEventWithChecks_(this.iconGroup_,"mouseup",this,this.iconClick_),this.updateEditable())},n.Icon.prototype.dispose=function(){n.utils.dom.removeNode(this.iconGroup_),this.iconGroup_=null,this.setVisible(!1),this.block_=null},n.Icon.prototype.updateEditable=function(){},n.Icon.prototype.isVisible=function(){return!!this.bubble_},n.Icon.prototype.iconClick_=function(t){this.block_.workspace.isDragging()||this.block_.isInFlyout||n.utils.isRightButton(t)||this.setVisible(!this.isVisible())},n.Icon.prototype.applyColour=function(){this.isVisible()&&this.bubble_.setColour(this.block_.style.colourPrimary)},n.Icon.prototype.setIconLocation=function(t){this.iconXY_=t,this.isVisible()&&this.bubble_.setAnchorLocation(t)},n.Icon.prototype.computeIconLocation=function(){var t=this.block_.getRelativeToSurfaceXY(),e=n.utils.getRelativeXY(this.iconGroup_);t=new n.utils.Coordinate(t.x+e.x+this.SIZE/2,t.y+e.y+this.SIZE/2),n.utils.Coordinate.equals(this.getIconLocation(),t)||this.setIconLocation(t)},n.Icon.prototype.getIconLocation=function(){return this.iconXY_},n.Icon.prototype.getCorrectedSize=function(){return new n.utils.Size(n.Icon.prototype.SIZE,n.Icon.prototype.SIZE-2)},n.Warning=function(t){n.Warning.superClass_.constructor.call(this,t),this.createIcon(),this.text_={}},n.utils.object.inherits(n.Warning,n.Icon),n.Warning.prototype.collapseHidden=!1,n.Warning.prototype.drawIcon_=function(t){n.utils.dom.createSvgElement(n.utils.Svg.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},t),n.utils.dom.createSvgElement(n.utils.Svg.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},t),n.utils.dom.createSvgElement(n.utils.Svg.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},t)},n.Warning.prototype.setVisible=function(t){t!=this.isVisible()&&(n.Events.fire(new n.Events.BubbleOpen(this.block_,t,"warning")),t?this.createBubble_():this.disposeBubble_())},n.Warning.prototype.createBubble_=function(){this.paragraphElement_=n.Bubble.textToDom(this.getText()),this.bubble_=n.Bubble.createNonEditableBubble(this.paragraphElement_,this.block_,this.iconXY_),this.applyColour()},n.Warning.prototype.disposeBubble_=function(){this.bubble_.dispose(),this.paragraphElement_=this.bubble_=null},n.Warning.prototype.setText=function(t,e){this.text_[e]!=t&&(t?this.text_[e]=t:delete this.text_[e],this.isVisible()&&(this.setVisible(!1),this.setVisible(!0)))},n.Warning.prototype.getText=function(){var t,e=[];for(t in this.text_)e.push(this.text_[t]);return e.join("\n")},n.Warning.prototype.dispose=function(){this.block_.warning=null,n.Icon.prototype.dispose.call(this)},n.Comment=function(t){n.Comment.superClass_.constructor.call(this,t),this.model_=t.commentModel,this.model_.text=this.model_.text||"",this.cachedText_="",this.onInputWrapper_=this.onChangeWrapper_=this.onWheelWrapper_=this.onMouseUpWrapper_=null,this.createIcon()},n.utils.object.inherits(n.Comment,n.Icon),n.Comment.prototype.drawIcon_=function(t){n.utils.dom.createSvgElement(n.utils.Svg.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},t),n.utils.dom.createSvgElement(n.utils.Svg.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},t),n.utils.dom.createSvgElement(n.utils.Svg.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},t)},n.Comment.prototype.createEditor_=function(){this.foreignObject_=n.utils.dom.createSvgElement(n.utils.Svg.FOREIGNOBJECT,{x:n.Bubble.BORDER_WIDTH,y:n.Bubble.BORDER_WIDTH},null);var t=document.createElementNS(n.utils.dom.HTML_NS,"body");t.setAttribute("xmlns",n.utils.dom.HTML_NS),t.className="blocklyMinimalBody";var e=this.textarea_=document.createElementNS(n.utils.dom.HTML_NS,"textarea");return e.className="blocklyCommentTextarea",e.setAttribute("dir",this.block_.RTL?"RTL":"LTR"),e.value=this.model_.text,this.resizeTextarea_(),t.appendChild(e),this.foreignObject_.appendChild(t),this.onMouseUpWrapper_=n.bindEventWithChecks_(e,"mouseup",this,this.startEdit_,!0,!0),this.onWheelWrapper_=n.bindEventWithChecks_(e,"wheel",this,(function(t){t.stopPropagation()})),this.onChangeWrapper_=n.bindEventWithChecks_(e,"change",this,(function(t){this.cachedText_!=this.model_.text&&n.Events.fire(new n.Events.BlockChange(this.block_,"comment",null,this.cachedText_,this.model_.text))})),this.onInputWrapper_=n.bindEventWithChecks_(e,"input",this,(function(t){this.model_.text=e.value})),setTimeout(e.focus.bind(e),0),this.foreignObject_},n.Comment.prototype.updateEditable=function(){n.Comment.superClass_.updateEditable.call(this),this.isVisible()&&(this.disposeBubble_(),this.createBubble_())},n.Comment.prototype.onBubbleResize_=function(){this.isVisible()&&(this.model_.size=this.bubble_.getBubbleSize(),this.resizeTextarea_())},n.Comment.prototype.resizeTextarea_=function(){var t=this.model_.size,e=2*n.Bubble.BORDER_WIDTH,i=t.width-e;t=t.height-e,this.foreignObject_.setAttribute("width",i),this.foreignObject_.setAttribute("height",t),this.textarea_.style.width=i-4+"px",this.textarea_.style.height=t-4+"px"},n.Comment.prototype.setVisible=function(t){t!=this.isVisible()&&(n.Events.fire(new n.Events.BubbleOpen(this.block_,t,"comment")),(this.model_.pinned=t)?this.createBubble_():this.disposeBubble_())},n.Comment.prototype.createBubble_=function(){!this.block_.isEditable()||n.utils.userAgent.IE?this.createNonEditableBubble_():this.createEditableBubble_()},n.Comment.prototype.createEditableBubble_=function(){this.bubble_=new n.Bubble(this.block_.workspace,this.createEditor_(),this.block_.pathObject.svgPath,this.iconXY_,this.model_.size.width,this.model_.size.height),this.bubble_.setSvgId(this.block_.id),this.bubble_.registerResizeEvent(this.onBubbleResize_.bind(this)),this.applyColour()},n.Comment.prototype.createNonEditableBubble_=function(){this.paragraphElement_=n.Bubble.textToDom(this.block_.getCommentText()),this.bubble_=n.Bubble.createNonEditableBubble(this.paragraphElement_,this.block_,this.iconXY_),this.applyColour()},n.Comment.prototype.disposeBubble_=function(){this.onMouseUpWrapper_&&(n.unbindEvent_(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onWheelWrapper_&&(n.unbindEvent_(this.onWheelWrapper_),this.onWheelWrapper_=null),this.onChangeWrapper_&&(n.unbindEvent_(this.onChangeWrapper_),this.onChangeWrapper_=null),this.onInputWrapper_&&(n.unbindEvent_(this.onInputWrapper_),this.onInputWrapper_=null),this.bubble_.dispose(),this.paragraphElement_=this.foreignObject_=this.textarea_=this.bubble_=null},n.Comment.prototype.startEdit_=function(t){this.bubble_.promote()&&this.textarea_.focus(),this.cachedText_=this.model_.text},n.Comment.prototype.getBubbleSize=function(){return this.model_.size},n.Comment.prototype.setBubbleSize=function(t,e){this.bubble_?this.bubble_.setBubbleSize(t,e):(this.model_.size.width=t,this.model_.size.height=e)},n.Comment.prototype.updateText=function(){this.textarea_?this.textarea_.value=this.model_.text:this.paragraphElement_&&(this.paragraphElement_.firstChild.textContent=this.model_.text)},n.Comment.prototype.dispose=function(){this.block_.comment=null,n.Icon.prototype.dispose.call(this)},n.Css.register(".blocklyCommentTextarea {,background-color: #fef49c;,border: 0;,outline: 0;,margin: 0;,padding: 3px;,resize: none;,display: block;,text-overflow: hidden;,}".split(",")),n.FlyoutCursor=function(){n.FlyoutCursor.superClass_.constructor.call(this)},n.utils.object.inherits(n.FlyoutCursor,n.Cursor),n.FlyoutCursor.prototype.onBlocklyAction=function(t){switch(t.name){case n.navigation.actionNames.PREVIOUS:return this.prev(),!0;case n.navigation.actionNames.NEXT:return this.next(),!0;default:return!1}},n.FlyoutCursor.prototype.next=function(){var t=this.getCurNode();return t?((t=t.next())&&this.setCurNode(t),t):null},n.FlyoutCursor.prototype.in=function(){return null},n.FlyoutCursor.prototype.prev=function(){var t=this.getCurNode();return t?((t=t.prev())&&this.setCurNode(t),t):null},n.FlyoutCursor.prototype.out=function(){return null},n.Flyout=function(t){t.getMetrics=this.getMetrics_.bind(this),t.setMetrics=this.setMetrics_.bind(this),this.workspace_=new n.WorkspaceSvg(t),this.workspace_.isFlyout=!0,this.workspace_.setVisible(this.isVisible_),this.RTL=!!t.RTL,this.horizontalLayout=!1,this.toolboxPosition_=t.toolboxPosition,this.eventWrappers_=[],this.mats_=[],this.buttons_=[],this.listeners_=[],this.permanentlyDisabled_=[],this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.targetWorkspace=null},n.Flyout.prototype.autoClose=!0,n.Flyout.prototype.isVisible_=!1,n.Flyout.prototype.containerVisible_=!0,n.Flyout.prototype.CORNER_RADIUS=8,n.Flyout.prototype.MARGIN=n.Flyout.prototype.CORNER_RADIUS,n.Flyout.prototype.GAP_X=3*n.Flyout.prototype.MARGIN,n.Flyout.prototype.GAP_Y=3*n.Flyout.prototype.MARGIN,n.Flyout.prototype.SCROLLBAR_PADDING=2,n.Flyout.prototype.width_=0,n.Flyout.prototype.height_=0,n.Flyout.prototype.dragAngleRange_=70,n.Flyout.prototype.createDom=function(t){return this.svgGroup_=n.utils.dom.createSvgElement(t,{class:"blocklyFlyout",style:"display: none"},null),this.svgBackground_=n.utils.dom.createSvgElement(n.utils.Svg.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.workspace_.getMarkerManager().setCursor(new n.FlyoutCursor),this.svgGroup_},n.Flyout.prototype.init=function(t){this.targetWorkspace=t,this.workspace_.targetWorkspace=t,this.scrollbar=new n.Scrollbar(this.workspace_,this.horizontalLayout,!1,"blocklyFlyoutScrollbar"),this.hide(),Array.prototype.push.apply(this.eventWrappers_,n.bindEventWithChecks_(this.svgGroup_,"wheel",this,this.wheel_)),this.autoClose||(this.filterWrapper_=this.filterForCapacity_.bind(this),this.targetWorkspace.addChangeListener(this.filterWrapper_)),Array.prototype.push.apply(this.eventWrappers_,n.bindEventWithChecks_(this.svgBackground_,"mousedown",this,this.onMouseDown_)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap()},n.Flyout.prototype.dispose=function(){this.hide(),n.unbindEvent_(this.eventWrappers_),this.filterWrapper_&&(this.targetWorkspace.removeChangeListener(this.filterWrapper_),this.filterWrapper_=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.targetWorkspace=null,this.workspace_.dispose(),this.workspace_=null),this.svgGroup_&&(n.utils.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.targetWorkspace=this.svgBackground_=null},n.Flyout.prototype.getWidth=function(){return this.width_},n.Flyout.prototype.getHeight=function(){return this.height_},n.Flyout.prototype.getWorkspace=function(){return this.workspace_},n.Flyout.prototype.isVisible=function(){return this.isVisible_},n.Flyout.prototype.setVisible=function(t){var e=t!=this.isVisible();this.isVisible_=t,e&&this.updateDisplay_()},n.Flyout.prototype.setContainerVisible=function(t){var e=t!=this.containerVisible_;this.containerVisible_=t,e&&this.updateDisplay_()},n.Flyout.prototype.updateDisplay_=function(){var t=!!this.containerVisible_&&this.isVisible();this.svgGroup_.style.display=t?"block":"none",this.scrollbar.setContainerVisible(t)},n.Flyout.prototype.positionAt_=function(t,e,i,o){this.svgGroup_.setAttribute("width",t),this.svgGroup_.setAttribute("height",e),"svg"==this.svgGroup_.tagName?n.utils.dom.setCssTransform(this.svgGroup_,"translate("+i+"px,"+o+"px)"):this.svgGroup_.setAttribute("transform","translate("+i+","+o+")"),this.scrollbar&&(this.scrollbar.setOrigin(i,o),this.scrollbar.resize(),this.scrollbar.setPosition(this.scrollbar.position.x,this.scrollbar.position.y))},n.Flyout.prototype.hide=function(){if(this.isVisible()){this.setVisible(!1);for(var t,e=0;t=this.listeners_[e];e++)n.unbindEvent_(t);this.listeners_.length=0,this.reflowWrapper_&&(this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowWrapper_=null)}},n.Flyout.prototype.show=function(t){this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks_(),"string"==typeof t&&(t=this.getDynamicCategoryContents_(t)),this.setVisible(!0),t=n.utils.toolbox.convertFlyoutDefToJsonArray(t),t=this.createFlyoutInfo_(t),this.layout_(t.contents,t.gaps),this.listeners_.push(n.bindEventWithChecks_(this.svgBackground_,"mouseover",this,(function(){for(var t,e=this.workspace_.getTopBlocks(!1),n=0;t=e[n];n++)t.removeSelect()}))),this.horizontalLayout?this.height_=0:this.width_=0,this.workspace_.setResizesEnabled(!0),this.reflow(),this.filterForCapacity_(),this.position(),this.reflowWrapper_=this.reflow.bind(this),this.workspace_.addChangeListener(this.reflowWrapper_)},n.Flyout.prototype.createFlyoutInfo_=function(t){var e=[],i=[];this.permanentlyDisabled_.length=0;for(var o,r=this.horizontalLayout?this.GAP_X:this.GAP_Y,s=0;o=t[s];s++)switch(o.custom&&(o=this.getDynamicCategoryContents_(o.custom),o=n.utils.toolbox.convertFlyoutDefToJsonArray(o),t.splice.apply(t,[s,1].concat(o)),o=t[s]),o.kind.toUpperCase()){case"BLOCK":var a=o,l=this.getBlockXml_(a);o=this.createBlock_(l),a=parseInt(a.gap||l.getAttribute("gap"),10),i.push(isNaN(a)?r:a),e.push({type:"block",block:o});break;case"SEP":this.addSeparatorGap_(o,i,r);break;case"LABEL":o=this.createButton_(o,!0),e.push({type:"button",button:o}),i.push(r);break;case"BUTTON":o=this.createButton_(o,!1),e.push({type:"button",button:o}),i.push(r)}return{contents:e,gaps:i}},n.Flyout.prototype.getDynamicCategoryContents_=function(t){if("function"!=typeof(t=this.workspace_.targetWorkspace.getToolboxCategoryCallback(t)))throw TypeError("Couldn't find a callback function when opening a toolbox category.");if(t=t(this.workspace_.targetWorkspace),!Array.isArray(t))throw new TypeError("Result of toolbox category callback must be an array.");return t},n.Flyout.prototype.createButton_=function(t,e){if(!n.FlyoutButton)throw Error("Missing require for Blockly.FlyoutButton");return new n.FlyoutButton(this.workspace_,this.targetWorkspace,t,e)},n.Flyout.prototype.createBlock_=function(t){return(t=n.Xml.domToBlock(t,this.workspace_)).isEnabled()||this.permanentlyDisabled_.push(t),t},n.Flyout.prototype.getBlockXml_=function(t){var e=null,i=t.blockxml;if(i&&"string"!=typeof i?e=i:i&&"string"==typeof i?(e=n.Xml.textToDom(i),t.blockxml=e):t.type&&((e=n.utils.xml.createElement("xml")).setAttribute("type",t.type),e.setAttribute("disabled",t.disabled),t.blockxml=e),!e)throw Error("Error: Invalid block definition. Block definition must have blockxml or type.");return e},n.Flyout.prototype.addSeparatorGap_=function(t,e,n){t=parseInt(t.gap,10),!isNaN(t)&&0<e.length?e[e.length-1]=t:e.push(n)},n.Flyout.prototype.clearOldBlocks_=function(){for(var t,e=this.workspace_.getTopBlocks(!1),i=0;t=e[i];i++)t.workspace==this.workspace_&&t.dispose(!1,!1);for(i=0;i<this.mats_.length;i++)(e=this.mats_[i])&&(n.Tooltip.unbindMouseEvents(e),n.utils.dom.removeNode(e));for(i=this.mats_.length=0;e=this.buttons_[i];i++)e.dispose();this.buttons_.length=0,this.workspace_.getPotentialVariableMap().clear()},n.Flyout.prototype.addBlockListeners_=function(t,e,i){this.listeners_.push(n.bindEventWithChecks_(t,"mousedown",null,this.blockMouseDown_(e))),this.listeners_.push(n.bindEventWithChecks_(i,"mousedown",null,this.blockMouseDown_(e))),this.listeners_.push(n.bindEvent_(t,"mouseenter",e,e.addSelect)),this.listeners_.push(n.bindEvent_(t,"mouseleave",e,e.removeSelect)),this.listeners_.push(n.bindEvent_(i,"mouseenter",e,e.addSelect)),this.listeners_.push(n.bindEvent_(i,"mouseleave",e,e.removeSelect))},n.Flyout.prototype.blockMouseDown_=function(t){var e=this;return function(n){var i=e.targetWorkspace.getGesture(n);i&&(i.setStartBlock(t),i.handleFlyoutStart(n,e))}},n.Flyout.prototype.onMouseDown_=function(t){var e=this.targetWorkspace.getGesture(t);e&&e.handleFlyoutStart(t,this)},n.Flyout.prototype.isBlockCreatable_=function(t){return t.isEnabled()},n.Flyout.prototype.createBlock=function(t){var e=null;n.Events.disable();var i=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(!1);try{e=this.placeNewBlock_(t)}finally{n.Events.enable()}if(n.hideChaff(),t=n.Variables.getAddedVariables(this.targetWorkspace,i),n.Events.isEnabled()){for(n.Events.setGroup(!0),i=0;i<t.length;i++)n.Events.fire(new n.Events.VarCreate(t[i]));n.Events.fire(new n.Events.Create(e))}return this.autoClose?this.hide():this.filterForCapacity_(),e},n.Flyout.prototype.initFlyoutButton_=function(t,e,i){var o=t.createDom();t.moveTo(e,i),t.show(),this.listeners_.push(n.bindEventWithChecks_(o,"mousedown",this,this.onMouseDown_)),this.buttons_.push(t)},n.Flyout.prototype.createRect_=function(t,e,i,o,r){return(e=n.utils.dom.createSvgElement(n.utils.Svg.RECT,{"fill-opacity":0,x:e,y:i,height:o.height,width:o.width},null)).tooltip=t,n.Tooltip.bindMouseEvents(e),this.workspace_.getCanvas().insertBefore(e,t.getSvgRoot()),t.flyoutRect_=e,this.mats_[r]=e},n.Flyout.prototype.moveRectToBlock_=function(t,e){var n=e.getHeightWidth();t.setAttribute("width",n.width),t.setAttribute("height",n.height),e=e.getRelativeToSurfaceXY(),t.setAttribute("y",e.y),t.setAttribute("x",this.RTL?e.x-n.width:e.x)},n.Flyout.prototype.filterForCapacity_=function(){for(var t,e=this.workspace_.getTopBlocks(!1),i=0;t=e[i];i++)if(-1==this.permanentlyDisabled_.indexOf(t))for(var o=this.targetWorkspace.isCapacityAvailable(n.utils.getBlockTypeCounts(t));t;)t.setEnabled(o),t=t.getNextBlock()},n.Flyout.prototype.reflow=function(){this.reflowWrapper_&&this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowInternal_(),this.reflowWrapper_&&this.workspace_.addChangeListener(this.reflowWrapper_)},n.Flyout.prototype.isScrollable=function(){return!!this.scrollbar&&this.scrollbar.isVisible()},n.Flyout.prototype.placeNewBlock_=function(t){var e=this.targetWorkspace;if(!t.getSvgRoot())throw Error("oldBlock is not rendered.");var i=n.Xml.blockToDom(t,!0);if(e.setResizesEnabled(!1),!(i=n.Xml.domToBlock(i,e)).getSvgRoot())throw Error("block is not rendered.");var o=e.getOriginOffsetInPixels(),r=this.workspace_.getOriginOffsetInPixels();return(t=t.getRelativeToSurfaceXY()).scale(this.workspace_.scale),t=n.utils.Coordinate.sum(r,t),(o=n.utils.Coordinate.difference(t,o)).scale(1/e.scale),i.moveBy(o.x,o.y),i},n.Flyout.prototype.onBlocklyAction=function(t){return this.workspace_.getCursor().onBlocklyAction(t)},n.HorizontalFlyout=function(t){n.HorizontalFlyout.superClass_.constructor.call(this,t),this.horizontalLayout=!0},n.utils.object.inherits(n.HorizontalFlyout,n.Flyout),n.HorizontalFlyout.prototype.getMetrics_=function(){if(!this.isVisible())return null;try{var t=this.workspace_.getCanvas().getBBox()}catch(e){t={height:0,y:0,width:0,x:0}}var e=this.SCROLLBAR_PADDING,i=this.SCROLLBAR_PADDING;this.toolboxPosition_==n.TOOLBOX_AT_BOTTOM&&(e=0);var o=this.height_;return this.toolboxPosition_==n.TOOLBOX_AT_TOP&&(o-=this.SCROLLBAR_PADDING),{contentHeight:(t.height+2*this.MARGIN)*this.workspace_.scale,contentWidth:(t.width+2*this.MARGIN)*this.workspace_.scale,contentTop:0,contentLeft:0,viewHeight:o,viewWidth:this.width_-2*this.SCROLLBAR_PADDING,viewTop:-this.workspace_.scrollY,viewLeft:-this.workspace_.scrollX,absoluteTop:e,absoluteLeft:i}},n.HorizontalFlyout.prototype.setMetrics_=function(t){var e=this.getMetrics_();e&&("number"==typeof t.x&&(this.workspace_.scrollX=-e.contentWidth*t.x),this.workspace_.translate(this.workspace_.scrollX+e.absoluteLeft,this.workspace_.scrollY+e.absoluteTop))},n.HorizontalFlyout.prototype.getX=function(){return 0},n.HorizontalFlyout.prototype.getY=function(){var t=this.targetWorkspace.getMetrics();return t?this.targetWorkspace.toolboxPosition==this.toolboxPosition_?t.toolboxHeight?this.toolboxPosition_==n.TOOLBOX_AT_TOP?t.toolboxHeight:t.viewHeight-this.height_:this.toolboxPosition_==n.TOOLBOX_AT_TOP?0:t.viewHeight:this.toolboxPosition_==n.TOOLBOX_AT_TOP?0:t.viewHeight+t.absoluteTop-this.height_:0},n.HorizontalFlyout.prototype.position=function(){if(this.isVisible()){var t=this.targetWorkspace.getMetrics();if(t){this.width_=t.viewWidth,this.setBackgroundPath_(t.viewWidth-2*this.CORNER_RADIUS,this.height_-this.CORNER_RADIUS),t=this.getX();var e=this.getY();this.positionAt_(this.width_,this.height_,t,e)}}},n.HorizontalFlyout.prototype.setBackgroundPath_=function(t,e){var i=this.toolboxPosition_==n.TOOLBOX_AT_TOP,o=["M 0,"+(i?0:this.CORNER_RADIUS)];i?(o.push("h",t+2*this.CORNER_RADIUS),o.push("v",e),o.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),o.push("h",-t),o.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(o.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),o.push("h",t),o.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),o.push("v",e),o.push("h",-t-2*this.CORNER_RADIUS)),o.push("z"),this.svgBackground_.setAttribute("d",o.join(" "))},n.HorizontalFlyout.prototype.scrollToStart=function(){this.scrollbar.set(this.RTL?1/0:0)},n.HorizontalFlyout.prototype.wheel_=function(t){var e=n.utils.getScrollDeltaPixels(t),i=e.x||e.y;i&&(i=(e=this.getMetrics_()).viewLeft+i,i=Math.min(i,e.contentWidth-e.viewWidth),i=Math.max(i,0),this.scrollbar.set(i),n.WidgetDiv.hide(),n.DropDownDiv.hideWithoutAnimation()),t.preventDefault(),t.stopPropagation()},n.HorizontalFlyout.prototype.layout_=function(t,e){this.workspace_.scale=this.targetWorkspace.scale;var n=this.MARGIN,i=n+this.tabWidth_;this.RTL&&(t=t.reverse());for(var o,r=0;o=t[r];r++)if("block"==o.type){for(var s,a=(o=o.block).getDescendants(!1),l=0;s=a[l];l++)s.isInFlyout=!0;o.render(),a=o.getSvgRoot(),l=o.getHeightWidth(),s=o.outputConnection?this.tabWidth_:0,s=this.RTL?i+l.width:i-s,o.moveBy(s,n),s=this.createRect_(o,s,n,l,r),i+=l.width+e[r],this.addBlockListeners_(a,o,s)}else"button"==o.type&&(this.initFlyoutButton_(o.button,i,n),i+=o.button.width+e[r])},n.HorizontalFlyout.prototype.isDragTowardWorkspace=function(t){t=Math.atan2(t.y,t.x)/Math.PI*180;var e=this.dragAngleRange_;return t<90+e&&t>90-e||t>-90-e&&t<-90+e},n.HorizontalFlyout.prototype.getClientRect=function(){if(!this.svgGroup_)return null;var t=this.svgGroup_.getBoundingClientRect(),e=t.top;return this.toolboxPosition_==n.TOOLBOX_AT_TOP?new n.utils.Rect(-1e9,e+t.height,-1e9,1e9):new n.utils.Rect(e,1e9,-1e9,1e9)},n.HorizontalFlyout.prototype.reflowInternal_=function(){this.workspace_.scale=this.targetWorkspace.scale;for(var t,e=0,i=this.workspace_.getTopBlocks(!1),o=0;t=i[o];o++)e=Math.max(e,t.getHeightWidth().height);if(e+=1.5*this.MARGIN,e*=this.workspace_.scale,e+=n.Scrollbar.scrollbarThickness,this.height_!=e){for(o=0;t=i[o];o++)t.flyoutRect_&&this.moveRectToBlock_(t.flyoutRect_,t);this.targetWorkspace.toolboxPosition!=this.toolboxPosition_||this.toolboxPosition_!=n.TOOLBOX_AT_TOP||this.targetWorkspace.getToolbox()||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+e),this.height_=e,this.position()}},n.registry.register(n.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,n.registry.DEFAULT,n.HorizontalFlyout),n.VerticalFlyout=function(t){n.VerticalFlyout.superClass_.constructor.call(this,t)},n.utils.object.inherits(n.VerticalFlyout,n.Flyout),n.VerticalFlyout.registryName="verticalFlyout",n.VerticalFlyout.prototype.getMetrics_=function(){if(!this.isVisible())return null;try{var t=this.workspace_.getCanvas().getBBox()}catch(e){t={height:0,y:0,width:0,x:0}}var e=this.SCROLLBAR_PADDING,n=this.height_-2*this.SCROLLBAR_PADDING,i=this.width_;return this.RTL||(i-=this.SCROLLBAR_PADDING),{contentHeight:t.height*this.workspace_.scale+2*this.MARGIN,contentWidth:t.width*this.workspace_.scale+2*this.MARGIN,contentTop:t.y,contentLeft:t.x,viewHeight:n,viewWidth:i,viewTop:-this.workspace_.scrollY+t.y,viewLeft:-this.workspace_.scrollX,absoluteTop:e,absoluteLeft:0}},n.VerticalFlyout.prototype.setMetrics_=function(t){var e=this.getMetrics_();e&&("number"==typeof t.y&&(this.workspace_.scrollY=-e.contentHeight*t.y),this.workspace_.translate(this.workspace_.scrollX+e.absoluteLeft,this.workspace_.scrollY+e.absoluteTop))},n.VerticalFlyout.prototype.getX=function(){var t=this.targetWorkspace.getMetrics();return t?this.targetWorkspace.toolboxPosition==this.toolboxPosition_?t.toolboxWidth?this.toolboxPosition_==n.TOOLBOX_AT_LEFT?t.toolboxWidth:t.viewWidth-this.width_:this.toolboxPosition_==n.TOOLBOX_AT_LEFT?0:t.viewWidth:this.toolboxPosition_==n.TOOLBOX_AT_LEFT?0:t.viewWidth+t.absoluteLeft-this.width_:0},n.VerticalFlyout.prototype.getY=function(){return 0},n.VerticalFlyout.prototype.position=function(){if(this.isVisible()){var t=this.targetWorkspace.getMetrics();if(t){this.height_=t.viewHeight,this.setBackgroundPath_(this.width_-this.CORNER_RADIUS,t.viewHeight-2*this.CORNER_RADIUS),t=this.getX();var e=this.getY();this.positionAt_(this.width_,this.height_,t,e)}}},n.VerticalFlyout.prototype.setBackgroundPath_=function(t,e){var i=this.toolboxPosition_==n.TOOLBOX_AT_RIGHT,o=t+this.CORNER_RADIUS;(o=["M "+(i?o:0)+",0"]).push("h",i?-t:t),o.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,i?0:1,i?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),o.push("v",Math.max(0,e)),o.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,i?0:1,i?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),o.push("h",i?t:-t),o.push("z"),this.svgBackground_.setAttribute("d",o.join(" "))},n.VerticalFlyout.prototype.scrollToStart=function(){this.scrollbar.set(0)},n.VerticalFlyout.prototype.wheel_=function(t){var e=n.utils.getScrollDeltaPixels(t);if(e.y){var i=this.getMetrics_();e=i.viewTop-i.contentTop+e.y,e=Math.min(e,i.contentHeight-i.viewHeight),e=Math.max(e,0),this.scrollbar.set(e),n.WidgetDiv.hide(),n.DropDownDiv.hideWithoutAnimation()}t.preventDefault(),t.stopPropagation()},n.VerticalFlyout.prototype.layout_=function(t,e){this.workspace_.scale=this.targetWorkspace.scale;for(var n,i=this.MARGIN,o=this.RTL?i:i+this.tabWidth_,r=0;n=t[r];r++)if("block"==n.type){for(var s,a=(n=n.block).getDescendants(!1),l=0;s=a[l];l++)s.isInFlyout=!0;n.render(),a=n.getSvgRoot(),l=n.getHeightWidth(),s=n.outputConnection?o-this.tabWidth_:o,n.moveBy(s,i),s=this.createRect_(n,this.RTL?s-l.width:s,i,l,r),this.addBlockListeners_(a,n,s),i+=l.height+e[r]}else"button"==n.type&&(this.initFlyoutButton_(n.button,o,i),i+=n.button.height+e[r])},n.VerticalFlyout.prototype.isDragTowardWorkspace=function(t){t=Math.atan2(t.y,t.x)/Math.PI*180;var e=this.dragAngleRange_;return t<e&&t>-e||t<-180+e||t>180-e},n.VerticalFlyout.prototype.getClientRect=function(){if(!this.svgGroup_)return null;var t=this.svgGroup_.getBoundingClientRect(),e=t.left;return this.toolboxPosition_==n.TOOLBOX_AT_LEFT?new n.utils.Rect(-1e9,1e9,-1e9,e+t.width):new n.utils.Rect(-1e9,1e9,e,1e9)},n.VerticalFlyout.prototype.reflowInternal_=function(){this.workspace_.scale=this.targetWorkspace.scale;for(var t,e=0,i=this.workspace_.getTopBlocks(!1),o=0;t=i[o];o++){var r=t.getHeightWidth().width;t.outputConnection&&(r-=this.tabWidth_),e=Math.max(e,r)}for(o=0;t=this.buttons_[o];o++)e=Math.max(e,t.width);if(e+=1.5*this.MARGIN+this.tabWidth_,e*=this.workspace_.scale,e+=n.Scrollbar.scrollbarThickness,this.width_!=e){for(o=0;t=i[o];o++){if(this.RTL){r=t.getRelativeToSurfaceXY().x;var s=e/this.workspace_.scale-this.MARGIN;t.outputConnection||(s-=this.tabWidth_),t.moveBy(s-r,0)}t.flyoutRect_&&this.moveRectToBlock_(t.flyoutRect_,t)}if(this.RTL)for(o=0;t=this.buttons_[o];o++)i=t.getPosition().y,t.moveTo(e/this.workspace_.scale-t.width-this.MARGIN-this.tabWidth_,i);this.targetWorkspace.toolboxPosition!=this.toolboxPosition_||this.toolboxPosition_!=n.TOOLBOX_AT_LEFT||this.targetWorkspace.getToolbox()||this.targetWorkspace.translate(this.targetWorkspace.scrollX+e,this.targetWorkspace.scrollY),this.width_=e,this.position()}},n.registry.register(n.registry.Type.FLYOUTS_VERTICAL_TOOLBOX,n.registry.DEFAULT,n.VerticalFlyout),n.FlyoutButton=function(t,e,i,o){this.workspace_=t,this.targetWorkspace_=e,this.text_=i.text,this.position_=new n.utils.Coordinate(0,0),this.isLabel_=o,this.callbackKey_=i.callbackKey||i.callbackkey,this.cssClass_=i["web-class"]||null,this.onMouseUpWrapper_=null,this.info=i},n.FlyoutButton.MARGIN_X=5,n.FlyoutButton.MARGIN_Y=2,n.FlyoutButton.prototype.width=0,n.FlyoutButton.prototype.height=0,n.FlyoutButton.prototype.createDom=function(){var t=this.isLabel_?"blocklyFlyoutLabel":"blocklyFlyoutButton";if(this.cssClass_&&(t+=" "+this.cssClass_),this.svgGroup_=n.utils.dom.createSvgElement(n.utils.Svg.G,{class:t},this.workspace_.getCanvas()),!this.isLabel_)var e=n.utils.dom.createSvgElement(n.utils.Svg.RECT,{class:"blocklyFlyoutButtonShadow",rx:4,ry:4,x:1,y:1},this.svgGroup_);t=n.utils.dom.createSvgElement(n.utils.Svg.RECT,{class:this.isLabel_?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:4,ry:4},this.svgGroup_);var i=n.utils.dom.createSvgElement(n.utils.Svg.TEXT,{class:this.isLabel_?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup_),o=n.utils.replaceMessageReferences(this.text_);this.workspace_.RTL&&(o+="â€"),i.textContent=o,this.isLabel_&&(this.svgText_=i,this.workspace_.getThemeManager().subscribe(this.svgText_,"flyoutForegroundColour","fill"));var r=n.utils.style.getComputedStyle(i,"fontSize"),s=n.utils.style.getComputedStyle(i,"fontWeight"),a=n.utils.style.getComputedStyle(i,"fontFamily");return this.width=n.utils.dom.getFastTextWidthWithSizeString(i,r,s,a),o=n.utils.dom.measureFontMetrics(o,r,s,a),this.height=o.height,this.isLabel_||(this.width+=2*n.FlyoutButton.MARGIN_X,this.height+=2*n.FlyoutButton.MARGIN_Y,e.setAttribute("width",this.width),e.setAttribute("height",this.height)),t.setAttribute("width",this.width),t.setAttribute("height",this.height),i.setAttribute("x",this.width/2),i.setAttribute("y",this.height/2-o.height/2+o.baseline),this.updateTransform_(),this.onMouseUpWrapper_=n.bindEventWithChecks_(this.svgGroup_,"mouseup",this,this.onMouseUp_),this.svgGroup_},n.FlyoutButton.prototype.show=function(){this.updateTransform_(),this.svgGroup_.setAttribute("display","block")},n.FlyoutButton.prototype.updateTransform_=function(){this.svgGroup_.setAttribute("transform","translate("+this.position_.x+","+this.position_.y+")")},n.FlyoutButton.prototype.moveTo=function(t,e){this.position_.x=t,this.position_.y=e,this.updateTransform_()},n.FlyoutButton.prototype.isLabel=function(){return this.isLabel_},n.FlyoutButton.prototype.getPosition=function(){return this.position_},n.FlyoutButton.prototype.getButtonText=function(){return this.text_},n.FlyoutButton.prototype.getTargetWorkspace=function(){return this.targetWorkspace_},n.FlyoutButton.prototype.dispose=function(){this.onMouseUpWrapper_&&n.unbindEvent_(this.onMouseUpWrapper_),this.svgGroup_&&n.utils.dom.removeNode(this.svgGroup_),this.svgText_&&this.workspace_.getThemeManager().unsubscribe(this.svgText_)},n.FlyoutButton.prototype.onMouseUp_=function(t){(t=this.targetWorkspace_.getGesture(t))&&t.cancel(),this.isLabel_&&this.callbackKey_?console.warn("Labels should not have callbacks. Label text: "+this.text_):this.isLabel_||this.callbackKey_&&this.targetWorkspace_.getButtonCallback(this.callbackKey_)?this.isLabel_||this.targetWorkspace_.getButtonCallback(this.callbackKey_)(this):console.warn("Buttons should have callbacks. Button text: "+this.text_)},n.Css.register(".blocklyFlyoutButton {,fill: #888;,cursor: default;,},.blocklyFlyoutButtonShadow {,fill: #666;,},.blocklyFlyoutButton:hover {,fill: #aaa;,},.blocklyFlyoutLabel {,cursor: default;,},.blocklyFlyoutLabelBackground {,opacity: 0;,}".split(",")),n.Generator=function(t){this.name_=t,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")},n.Generator.NAME_TYPE="generated_function",n.Generator.prototype.INFINITE_LOOP_TRAP=null,n.Generator.prototype.STATEMENT_PREFIX=null,n.Generator.prototype.STATEMENT_SUFFIX=null,n.Generator.prototype.INDENT="  ",n.Generator.prototype.COMMENT_WRAP=60,n.Generator.prototype.ORDER_OVERRIDES=[],n.Generator.prototype.isInitialized=null,n.Generator.prototype.workspaceToCode=function(t){t||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),t=n.getMainWorkspace());var e=[];this.init(t),t=t.getTopBlocks(!0);for(var i,o=0;i=t[o];o++){var r=this.blockToCode(i);Array.isArray(r)&&(r=r[0]),r&&(i.outputConnection&&(r=this.scrubNakedValue(r),this.STATEMENT_PREFIX&&!i.suppressPrefixSuffix&&(r=this.injectId(this.STATEMENT_PREFIX,i)+r),this.STATEMENT_SUFFIX&&!i.suppressPrefixSuffix&&(r+=this.injectId(this.STATEMENT_SUFFIX,i))),e.push(r))}return e=e.join("\n"),(e=(e=(e=this.finish(e)).replace(/^\s+\n/,"")).replace(/\n\s+$/,"\n")).replace(/[ \t]+\n/g,"\n")},n.Generator.prototype.prefixLines=function(t,e){return e+t.replace(/(?!\n$)\n/g,"\n"+e)},n.Generator.prototype.allNestedComments=function(t){var e=[];t=t.getDescendants(!0);for(var n=0;n<t.length;n++){var i=t[n].getCommentText();i&&e.push(i)}return e.length&&e.push(""),e.join("\n")},n.Generator.prototype.blockToCode=function(t,e){if(!1===this.isInitialized&&console.warn("Generator init was not called before blockToCode was called."),!t)return"";if(!t.isEnabled())return e?"":this.blockToCode(t.getNextBlock());if(t.isInsertionMarker())return e?"":this.blockToCode(t.getChildren(!1)[0]);var n=this[t.type];if("function"!=typeof n)throw Error('Language "'+this.name_+'" does not know how to generate  code for block type "'+t.type+'".');if(n=n.call(t,t),Array.isArray(n)){if(!t.outputConnection)throw TypeError("Expecting string from statement block: "+t.type);return[this.scrub_(t,n[0],e),n[1]]}if("string"==typeof n)return this.STATEMENT_PREFIX&&!t.suppressPrefixSuffix&&(n=this.injectId(this.STATEMENT_PREFIX,t)+n),this.STATEMENT_SUFFIX&&!t.suppressPrefixSuffix&&(n+=this.injectId(this.STATEMENT_SUFFIX,t)),this.scrub_(t,n,e);if(null===n)return"";throw SyntaxError("Invalid code generated: "+n)},n.Generator.prototype.valueToCode=function(t,e,n){if(isNaN(n))throw TypeError("Expecting valid order from block: "+t.type);var i=t.getInputTargetBlock(e);if(!i)return"";if(""===(e=this.blockToCode(i)))return"";if(!Array.isArray(e))throw TypeError("Expecting tuple from value block: "+i.type);if(t=e[0],e=e[1],isNaN(e))throw TypeError("Expecting valid order from value block: "+i.type);if(!t)return"";i=!1;var o=Math.floor(n),r=Math.floor(e);if(o<=r&&(o!=r||0!=o&&99!=o))for(i=!0,o=0;o<this.ORDER_OVERRIDES.length;o++)if(this.ORDER_OVERRIDES[o][0]==n&&this.ORDER_OVERRIDES[o][1]==e){i=!1;break}return i&&(t="("+t+")"),t},n.Generator.prototype.statementToCode=function(t,e){if(t=t.getInputTargetBlock(e),"string"!=typeof(e=this.blockToCode(t)))throw TypeError("Expecting code from statement block: "+(t&&t.type));return e&&(e=this.prefixLines(e,this.INDENT)),e},n.Generator.prototype.addLoopTrap=function(t,e){return this.INFINITE_LOOP_TRAP&&(t=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,e),this.INDENT)+t),this.STATEMENT_SUFFIX&&!e.suppressPrefixSuffix&&(t=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,e),this.INDENT)+t),this.STATEMENT_PREFIX&&!e.suppressPrefixSuffix&&(t+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,e),this.INDENT)),t},n.Generator.prototype.injectId=function(t,e){return e=e.id.replace(/\$/g,"$$$$"),t.replace(/%1/g,"'"+e+"'")},n.Generator.prototype.RESERVED_WORDS_="",n.Generator.prototype.addReservedWords=function(t){this.RESERVED_WORDS_+=t+","},n.Generator.prototype.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",n.Generator.prototype.provideFunction_=function(t,e){if(!this.definitions_[t]){var i,o=this.variableDB_.getDistinctName(t,n.PROCEDURE_CATEGORY_NAME);for(this.functionNames_[t]=o,e=e.join("\n").replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,o);i!=e;)i=e,e=e.replace(/^(( {2})*) {2}/gm,"$1\0");e=e.replace(/\0/g,this.INDENT),this.definitions_[t]=e}return this.functionNames_[t]},n.Generator.prototype.init=function(t){},n.Generator.prototype.scrub_=function(t,e,n){return e},n.Generator.prototype.finish=function(t){return t},n.Generator.prototype.scrubNakedValue=function(t){return t},n.ToolboxItem=function(t,e,i){this.id_=t.toolboxitemid||n.utils.IdGenerator.getNextUniqueId(),this.level_=(this.parent_=i||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=t,this.parentToolbox_=e,this.workspace_=this.parentToolbox_.getWorkspace()},n.ToolboxItem.prototype.init=function(){},n.ToolboxItem.prototype.getDiv=function(){return null},n.ToolboxItem.prototype.getId=function(){return this.id_},n.ToolboxItem.prototype.getParent=function(){return null},n.ToolboxItem.prototype.getLevel=function(){return this.level_},n.ToolboxItem.prototype.isSelectable=function(){return!1},n.ToolboxItem.prototype.isCollapsible=function(){return!1},n.ToolboxItem.prototype.dispose=function(){},n.ToolboxCategory=function(t,e,i){n.ToolboxCategory.superClass_.constructor.call(this,t,e,i),this.name_=n.utils.replaceMessageReferences(t.name),this.colour_=this.getColour_(t),this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.cssConfig_=this.makeDefaultCssConfig_(),n.utils.object.mixin(this.cssConfig_,t.cssconfig||t.cssConfig),this.isDisabled_=this.isHidden_=!1,this.flyoutItems_=[],this.parseContents_(t)},n.utils.object.inherits(n.ToolboxCategory,n.ToolboxItem),n.ToolboxCategory.registrationName="category",n.ToolboxCategory.nestedPadding=19,n.ToolboxCategory.borderWidth=8,n.ToolboxCategory.defaultBackgroundColour="#57e",n.ToolboxCategory.prototype.makeDefaultCssConfig_=function(){return{container:"blocklyToolboxCategory",row:"blocklyTreeRow",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyTreeIcon",label:"blocklyTreeLabel",contents:"blocklyToolboxContents",selected:"blocklyTreeSelected",openicon:"blocklyTreeIconOpen",closedicon:"blocklyTreeIconClosed"}},n.ToolboxCategory.prototype.parseContents_=function(t){var e=t.contents;if(t.custom)this.flyoutItems_=t.custom;else if(e){t=0;for(var n;n=e[t];t++)this.flyoutItems_.push(n)}},n.ToolboxCategory.prototype.init=function(){this.createDom_(),"true"==this.toolboxItemDef_.hidden&&this.hide()},n.ToolboxCategory.prototype.createDom_=function(){return this.htmlDiv_=this.createContainer_(),n.utils.aria.setRole(this.htmlDiv_,n.utils.aria.Role.TREEITEM),n.utils.aria.setState(this.htmlDiv_,n.utils.aria.State.SELECTED,!1),n.utils.aria.setState(this.htmlDiv_,n.utils.aria.State.LEVEL,this.level_),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),n.utils.aria.setRole(this.iconDom_,n.utils.aria.Role.PRESENTATION),this.rowContents_.appendChild(this.iconDom_),this.labelDom_=this.createLabelDom_(this.name_),this.rowContents_.appendChild(this.labelDom_),n.utils.aria.setState(this.htmlDiv_,n.utils.aria.State.LABELLEDBY,this.labelDom_.getAttribute("id")),this.addColourBorder_(this.colour_),this.htmlDiv_},n.ToolboxCategory.prototype.createContainer_=function(){var t=document.createElement("div");return n.utils.dom.addClass(t,this.cssConfig_.container),t},n.ToolboxCategory.prototype.createRowContainer_=function(){var t=document.createElement("div");n.utils.dom.addClass(t,this.cssConfig_.row);var e=n.ToolboxCategory.nestedPadding*this.getLevel();return e=e.toString()+"px",this.workspace_.RTL?t.style.paddingRight=e:t.style.paddingLeft=e,t},n.ToolboxCategory.prototype.createRowContentsContainer_=function(){var t=document.createElement("div");return n.utils.dom.addClass(t,this.cssConfig_.rowcontentcontainer),t},n.ToolboxCategory.prototype.createIconDom_=function(){var t=document.createElement("span");return this.parentToolbox_.isHorizontal()||n.utils.dom.addClass(t,this.cssConfig_.icon),t.style.display="inline-block",t},n.ToolboxCategory.prototype.createLabelDom_=function(t){var e=document.createElement("span");return e.setAttribute("id",this.getId()+".label"),e.textContent=t,n.utils.dom.addClass(e,this.cssConfig_.label),e},n.ToolboxCategory.prototype.refreshTheme=function(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)},n.ToolboxCategory.prototype.addColourBorder_=function(t){t&&(t=n.ToolboxCategory.borderWidth+"px solid "+(t||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=t:this.rowDiv_.style.borderLeft=t)},n.ToolboxCategory.prototype.getColour_=function(t){var e=t.categorystyle||t.categoryStyle;return(t=t.colour)&&e?(console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour'),""):e?this.getColourfromStyle_(e):this.parseColour_(t)},n.ToolboxCategory.prototype.getColourfromStyle_=function(t){var e=this.workspace_.getTheme();if(t&&e){if((e=e.categoryStyles[t])&&e.colour)return this.parseColour_(e.colour);console.warn('Style "'+t+'" must exist and contain a colour value')}return""},n.ToolboxCategory.prototype.getClickTarget=function(){return this.rowDiv_},n.ToolboxCategory.prototype.parseColour_=function(t){if(null==(t=n.utils.replaceMessageReferences(t))||""===t)return"";var e=Number(t);return isNaN(e)?(e=n.utils.colour.parse(t))?e:(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+t),""):n.hueToHex(e)},n.ToolboxCategory.prototype.openIcon_=function(t){t&&(n.utils.dom.removeClasses(t,this.cssConfig_.closedicon),n.utils.dom.addClass(t,this.cssConfig_.openicon))},n.ToolboxCategory.prototype.closeIcon_=function(t){t&&(n.utils.dom.removeClasses(t,this.cssConfig_.openicon),n.utils.dom.addClass(t,this.cssConfig_.closedicon))},n.ToolboxCategory.prototype.setVisible_=function(t){this.htmlDiv_.style.display=t?"block":"none",this.isHidden_=!t,this.parentToolbox_.getSelectedItem()==this&&this.parentToolbox_.clearSelection()},n.ToolboxCategory.prototype.hide=function(){this.setVisible_(!1)},n.ToolboxCategory.prototype.show=function(){this.setVisible_(!0)},n.ToolboxCategory.prototype.isVisible=function(){return!this.isHidden_&&this.allAncestorsExpanded_()},n.ToolboxCategory.prototype.allAncestorsExpanded_=function(){for(var t=this;t.getParent();)if(!(t=t.getParent()).isExpanded())return!1;return!0},n.ToolboxCategory.prototype.isSelectable=function(){return this.isVisible()&&!this.isDisabled_},n.ToolboxCategory.prototype.onClick=function(t){},n.ToolboxCategory.prototype.setSelected=function(t){if(t){var e=this.parseColour_(n.ToolboxCategory.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||e,n.utils.dom.addClass(this.rowDiv_,this.cssConfig_.selected)}else this.rowDiv_.style.backgroundColor="",n.utils.dom.removeClass(this.rowDiv_,this.cssConfig_.selected);n.utils.aria.setState(this.htmlDiv_,n.utils.aria.State.SELECTED,t)},n.ToolboxCategory.prototype.setDisabled=function(t){this.isDisabled_=t,this.getDiv().setAttribute("disabled",t),t?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")},n.ToolboxCategory.prototype.getName=function(){return this.name_},n.ToolboxCategory.prototype.getParent=function(){return this.parent_},n.ToolboxCategory.prototype.getDiv=function(){return this.htmlDiv_},n.ToolboxCategory.prototype.getContents=function(){return this.flyoutItems_},n.ToolboxCategory.prototype.updateFlyoutContents=function(t){this.flyoutItems_=[],"string"==typeof t?this.toolboxItemDef_.custom=t:(delete this.toolboxItemDef_.custom,this.toolboxItemDef_.contents=n.utils.toolbox.convertFlyoutDefToJsonArray(t)),this.parseContents_(this.toolboxItemDef_)},n.ToolboxCategory.prototype.dispose=function(){n.utils.dom.removeNode(this.htmlDiv_)},n.Css.register([".blocklyTreeRow:not(.blocklyTreeSelected):hover {","background-color: rgba(255, 255, 255, 0.2);","}",'.blocklyToolboxDiv[layout="h"] .blocklyToolboxCategory {',"margin: 1px 5px 1px 0;","}",'.blocklyToolboxDiv[dir="RTL"][layout="h"] .blocklyToolboxCategory {',"margin: 1px 0 1px 5px;","}",".blocklyTreeRow {","height: 22px;","line-height: 22px;","margin-bottom: 3px;","padding-right: 8px;","white-space: nowrap;","}",'.blocklyToolboxDiv[dir="RTL"] .blocklyTreeRow {',"margin-left: 8px;","padding-right: 0px","}",".blocklyTreeIcon {","background-image: url(<<<PATH>>>/sprites.png);","height: 16px;","vertical-align: middle;","visibility: hidden;","width: 16px;","}",".blocklyTreeIconClosed {","background-position: -32px -1px;","}",'.blocklyToolboxDiv[dir="RTL"] .blocklyTreeIconClosed {',"background-position: 0 -1px;","}",".blocklyTreeSelected>.blocklyTreeIconClosed {","background-position: -32px -17px;","}",'.blocklyToolboxDiv[dir="RTL"] .blocklyTreeSelected>.blocklyTreeIconClosed {',"background-position: 0 -17px;","}",".blocklyTreeIconOpen {","background-position: -16px -1px;","}",".blocklyTreeSelected>.blocklyTreeIconOpen {","background-position: -16px -17px;","}",".blocklyTreeLabel {","cursor: default;","font: 16px sans-serif;","padding: 0 3px;","vertical-align: middle;","}",".blocklyToolboxDelete .blocklyTreeLabel {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyTreeSelected .blocklyTreeLabel {","color: #fff;","}"]),n.registry.register(n.registry.Type.TOOLBOX_ITEM,n.ToolboxCategory.registrationName,n.ToolboxCategory),n.ToolboxSeparator=function(t,e){n.ToolboxSeparator.superClass_.constructor.call(this,t,e),this.cssConfig_={container:"blocklyTreeSeparator"},n.utils.object.mixin(this.cssConfig_,t.cssconfig||t.cssConfig)},n.utils.object.inherits(n.ToolboxSeparator,n.ToolboxItem),n.ToolboxSeparator.registrationName="sep",n.ToolboxSeparator.prototype.init=function(){this.createDom_()},n.ToolboxSeparator.prototype.createDom_=function(){var t=document.createElement("div");return n.utils.dom.addClass(t,this.cssConfig_.container),this.htmlDiv_=t},n.ToolboxSeparator.prototype.getDiv=function(){return this.htmlDiv_},n.ToolboxSeparator.prototype.dispose=function(){n.utils.dom.removeNode(this.htmlDiv_)},n.Css.register('.blocklyTreeSeparator {,border-bottom: solid #e5e5e5 1px;,height: 0;,margin: 5px 0;,},.blocklyToolboxDiv[layout="h"] .blocklyTreeSeparator {,border-right: solid #e5e5e5 1px;,border-bottom: none;,height: auto;,margin: 0 5px 0 5px;,padding: 5px 0;,width: 0;,}'.split(",")),n.registry.register(n.registry.Type.TOOLBOX_ITEM,n.ToolboxSeparator.registrationName,n.ToolboxSeparator),n.CollapsibleToolboxCategory=function(t,e,i){this.subcategoriesDiv_=null,this.expanded_=!1,this.toolboxItems_=[],n.CollapsibleToolboxCategory.superClass_.constructor.call(this,t,e,i)},n.utils.object.inherits(n.CollapsibleToolboxCategory,n.ToolboxCategory),n.CollapsibleToolboxCategory.registrationName="collapsibleCategory",n.CollapsibleToolboxCategory.prototype.makeDefaultCssConfig_=function(){var t=n.CollapsibleToolboxCategory.superClass_.makeDefaultCssConfig_.call(this);return t.contents="blocklyToolboxContents",t},n.CollapsibleToolboxCategory.prototype.parseContents_=function(t){var e=t.contents,i=!0;if(t.custom)this.flyoutItems_=t.custom;else if(e){t=0;for(var o;o=e[t];t++)!n.registry.hasItem(n.registry.Type.TOOLBOX_ITEM,o.kind)||o.kind.toLowerCase()==n.ToolboxSeparator.registrationName&&i?(this.flyoutItems_.push(o),i=!0):(this.createToolboxItem_(o),i=!1)}},n.CollapsibleToolboxCategory.prototype.createToolboxItem_=function(t){var e=t.kind;"CATEGORY"==e.toUpperCase()&&n.utils.toolbox.isCategoryCollapsible(t)&&(e=n.CollapsibleToolboxCategory.registrationName),t=new(n.registry.getClass(n.registry.Type.TOOLBOX_ITEM,e))(t,this.parentToolbox_,this),this.toolboxItems_.push(t)},n.CollapsibleToolboxCategory.prototype.init=function(){n.CollapsibleToolboxCategory.superClass_.init.call(this),this.setExpanded("true"==this.toolboxItemDef_.expanded||this.toolboxItemDef_.expanded)},n.CollapsibleToolboxCategory.prototype.createDom_=function(){n.CollapsibleToolboxCategory.superClass_.createDom_.call(this);var t=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(t),n.utils.aria.setRole(this.subcategoriesDiv_,n.utils.aria.Role.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.htmlDiv_},n.CollapsibleToolboxCategory.prototype.createIconDom_=function(){var t=document.createElement("span");return this.parentToolbox_.isHorizontal()||(n.utils.dom.addClass(t,this.cssConfig_.icon),t.style.visibility="visible"),t.style.display="inline-block",t},n.CollapsibleToolboxCategory.prototype.createSubCategoriesDom_=function(t){var e=document.createElement("div");n.utils.dom.addClass(e,this.cssConfig_.contents);for(var i=0;i<t.length;i++){var o=t[i];o.init();var r=o.getDiv();e.appendChild(r),o.getClickTarget&&o.getClickTarget().setAttribute("id",o.getId())}return e},n.CollapsibleToolboxCategory.prototype.setExpanded=function(t){this.expanded_!=t&&((this.expanded_=t)?(this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_)):(this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)),n.utils.aria.setState(this.htmlDiv_,n.utils.aria.State.EXPANDED,t),this.parentToolbox_.handleToolboxItemResize())},n.CollapsibleToolboxCategory.prototype.setVisible_=function(t){this.htmlDiv_.style.display=t?"block":"none";for(var e,n=0;e=this.getChildToolboxItems()[n];n++)e.setVisible_(t);this.isHidden_=!t,this.parentToolbox_.getSelectedItem()==this&&this.parentToolbox_.clearSelection()},n.CollapsibleToolboxCategory.prototype.isExpanded=function(){return this.expanded_},n.CollapsibleToolboxCategory.prototype.isCollapsible=function(){return!0},n.CollapsibleToolboxCategory.prototype.onClick=function(t){this.toggleExpanded()},n.CollapsibleToolboxCategory.prototype.toggleExpanded=function(){this.setExpanded(!this.expanded_)},n.CollapsibleToolboxCategory.prototype.getDiv=function(){return this.htmlDiv_},n.CollapsibleToolboxCategory.prototype.getChildToolboxItems=function(){return this.toolboxItems_},n.registry.register(n.registry.Type.TOOLBOX_ITEM,n.CollapsibleToolboxCategory.registrationName,n.CollapsibleToolboxCategory),n.Events.ToolboxItemSelect=function(t,e,i){n.Events.ToolboxItemSelect.superClass_.constructor.call(this,i),this.oldItem=t,this.newItem=e},n.utils.object.inherits(n.Events.ToolboxItemSelect,n.Events.UiBase),n.Events.ToolboxItemSelect.prototype.type=n.Events.TOOLBOX_ITEM_SELECT,n.Events.ToolboxItemSelect.prototype.toJson=function(){var t=n.Events.ToolboxItemSelect.superClass_.toJson.call(this);return t.oldItem=this.oldItem,t.newItem=this.newItem,t},n.Events.ToolboxItemSelect.prototype.fromJson=function(t){n.Events.ToolboxItemSelect.superClass_.fromJson.call(this,t),this.oldItem=t.oldItem,this.newItem=t.newItem},n.registry.register(n.registry.Type.EVENT,n.Events.TOOLBOX_ITEM_SELECT,n.Events.ToolboxItemSelect),n.Toolbox=function(t){this.workspace_=t,this.toolboxDef_=t.options.languageTree||{contents:[]},this.horizontalLayout_=t.options.horizontalLayout,this.contentsDiv_=this.HtmlDiv=null,this.contents_=[],this.height_=this.width_=0,this.RTL=t.options.RTL,this.flyout_=null,this.contentMap_={},this.toolboxPosition=t.options.toolboxPosition,this.previouslySelectedItem_=this.selectedItem_=null,this.boundEvents_=[]},n.Toolbox.prototype.init=function(){var t=this.workspace_,e=t.getParentSvg();this.flyout_=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_),n.utils.dom.insertAfter(this.flyout_.createDom("svg"),e),this.flyout_.init(t),this.render(this.toolboxDef_),(t=t.getThemeManager()).subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),t.subscribe(this.HtmlDiv,"toolboxForegroundColour","color")},n.Toolbox.prototype.createDom_=function(t){t=t.getParentSvg();var e=this.createContainer_();return this.contentsDiv_=this.createContentsContainer_(),this.contentsDiv_.tabIndex=0,n.utils.aria.setRole(this.contentsDiv_,n.utils.aria.Role.TREE),e.appendChild(this.contentsDiv_),t.parentNode.insertBefore(e,t),this.attachEvents_(e,this.contentsDiv_),e},n.Toolbox.prototype.createContainer_=function(){var t=document.createElement("div");return t.setAttribute("layout",this.isHorizontal()?"h":"v"),n.utils.dom.addClass(t,"blocklyToolboxDiv"),n.utils.dom.addClass(t,"blocklyNonSelectable"),t.setAttribute("dir",this.RTL?"RTL":"LTR"),t},n.Toolbox.prototype.createContentsContainer_=function(){var t=document.createElement("div");return n.utils.dom.addClass(t,"blocklyToolboxContents"),this.isHorizontal()&&(t.style.flexDirection="row"),t},n.Toolbox.prototype.attachEvents_=function(t,e){t=n.bindEventWithChecks_(t,"click",this,this.onClick_,!1,!0),this.boundEvents_.push(t),e=n.bindEventWithChecks_(e,"keydown",this,this.onKeyDown_,!1,!0),this.boundEvents_.push(e)},n.Toolbox.prototype.onClick_=function(t){if(n.utils.isRightButton(t)||t.target==this.HtmlDiv)n.hideChaff(!1);else{var e=t.target.getAttribute("id");e&&(e=this.getToolboxItemById(e)).isSelectable()&&(this.setSelectedItem(e),e.onClick(t)),n.hideChaff(!0)}n.Touch.clearTouchIdentifier()},n.Toolbox.prototype.onKeyDown_=function(t){var e=!1;switch(t.keyCode){case n.utils.KeyCodes.DOWN:e=this.selectNext_();break;case n.utils.KeyCodes.UP:e=this.selectPrevious_();break;case n.utils.KeyCodes.LEFT:e=this.selectParent_();break;case n.utils.KeyCodes.RIGHT:e=this.selectChild_();break;case n.utils.KeyCodes.ENTER:case n.utils.KeyCodes.SPACE:this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),e=!0);break;default:e=!1}!e&&this.selectedItem_&&this.selectedItem_.onKeyDown&&(e=this.selectedItem_.onKeyDown(t)),e&&t.preventDefault()},n.Toolbox.prototype.createFlyout_=function(){var t=this.workspace_,e=new n.Options({parentWorkspace:t,rtl:t.RTL,oneBasedIndex:t.options.oneBasedIndex,horizontalLayout:t.horizontalLayout,renderer:t.options.renderer,rendererOverrides:t.options.rendererOverrides});if(e.toolboxPosition=t.options.toolboxPosition,!(t=t.horizontalLayout?n.registry.getClassFromOptions(n.registry.Type.FLYOUTS_HORIZONTAL_TOOLBOX,t.options):n.registry.getClassFromOptions(n.registry.Type.FLYOUTS_VERTICAL_TOOLBOX,t.options)))throw Error("Blockly.VerticalFlyout, Blockly.HorizontalFlyout or your own custom flyout must be required.");return new t(e)},n.Toolbox.prototype.render=function(t){this.toolboxDef_=t;for(var e=0;e<this.contents_.length;e++){var n=this.contents_[e];n&&n.dispose()}this.contents_=[],this.contentMap_={},this.renderContents_(t.contents),this.position()},n.Toolbox.prototype.renderContents_=function(t){for(var e,n=document.createDocumentFragment(),i=0;e=t[i];i++)this.createToolboxItem_(e,n);this.contentsDiv_.appendChild(n)},n.Toolbox.prototype.createToolboxItem_=function(t,e){var i=t.kind;"CATEGORY"==i.toUpperCase()&&n.utils.toolbox.isCategoryCollapsible(t)&&(i=n.CollapsibleToolboxCategory.registrationName),(i=n.registry.getClass(n.registry.Type.TOOLBOX_ITEM,i.toLowerCase()))&&(t=new i(t,this),this.addToolboxItem_(t),t.init(),(i=t.getDiv())&&e.appendChild(i),t.getClickTarget&&t.getClickTarget().setAttribute("id",t.getId()))},n.Toolbox.prototype.addToolboxItem_=function(t){if(this.contents_.push(t),this.contentMap_[t.getId()]=t,t.isCollapsible())for(var e,n=0;e=t.getChildToolboxItems()[n];n++)this.addToolboxItem_(e)},n.Toolbox.prototype.getToolboxItems=function(){return this.contents_},n.Toolbox.prototype.addStyle=function(t){n.utils.dom.addClass(this.HtmlDiv,t)},n.Toolbox.prototype.removeStyle=function(t){n.utils.dom.removeClass(this.HtmlDiv,t)},n.Toolbox.prototype.getClientRect=function(){if(!this.HtmlDiv)return null;var t=this.HtmlDiv.getBoundingClientRect(),e=t.top,i=e+t.height,o=t.left;return t=o+t.width,this.toolboxPosition==n.utils.toolbox.Position.TOP?new n.utils.Rect(-1e7,i,-1e7,1e7):this.toolboxPosition==n.utils.toolbox.Position.BOTTOM?new n.utils.Rect(e,1e7,-1e7,1e7):this.toolboxPosition==n.utils.toolbox.Position.LEFT?new n.utils.Rect(-1e7,1e7,-1e7,t):new n.utils.Rect(-1e7,1e7,o,1e7)},n.Toolbox.prototype.getToolboxItemById=function(t){return this.contentMap_[t]},n.Toolbox.prototype.getWidth=function(){return this.width_},n.Toolbox.prototype.getHeight=function(){return this.height_},n.Toolbox.prototype.getFlyout=function(){return this.flyout_},n.Toolbox.prototype.getWorkspace=function(){return this.workspace_},n.Toolbox.prototype.getSelectedItem=function(){return this.selectedItem_},n.Toolbox.prototype.getPreviouslySelectedItem=function(){return this.previouslySelectedItem_},n.Toolbox.prototype.isHorizontal=function(){return this.horizontalLayout_},n.Toolbox.prototype.position=function(){var t=this.HtmlDiv;t&&(this.horizontalLayout_?(t.style.left="0",t.style.height="auto",t.style.width="100%",this.height_=t.offsetHeight,this.toolboxPosition==n.TOOLBOX_AT_TOP?t.style.top="0":t.style.bottom="0"):(this.toolboxPosition==n.TOOLBOX_AT_RIGHT?t.style.right="0":t.style.left="0",t.style.height="100%",this.width_=t.offsetWidth),this.flyout_.position())},n.Toolbox.prototype.handleToolboxItemResize=function(){var t=this.workspace_,e=this.HtmlDiv.getBoundingClientRect();t.translate(this.toolboxPosition==n.TOOLBOX_AT_LEFT?t.scrollX+e.width:t.scrollX,this.toolboxPosition==n.TOOLBOX_AT_TOP?t.scrollY+e.height:t.scrollY),n.svgResize(t)},n.Toolbox.prototype.clearSelection=function(){this.setSelectedItem(null)},n.Toolbox.prototype.refreshTheme=function(){for(var t=0;t<this.contents_.length;t++){var e=this.contents_[t];e.refreshTheme&&e.refreshTheme()}},n.Toolbox.prototype.refreshSelection=function(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout_.show(this.selectedItem_.getContents())},n.Toolbox.prototype.setVisible=function(t){this.HtmlDiv.style.display=t?"block":"none"},n.Toolbox.prototype.setSelectedItem=function(t){var e=this.selectedItem_;!t&&!e||t&&!t.isSelectable()||(this.shouldDeselectItem_(e,t)&&null!=e&&this.deselectItem_(e),this.shouldSelectItem_(e,t)&&null!=t&&this.selectItem_(e,t),this.updateFlyout_(e,t),this.fireSelectEvent_(e,t))},n.Toolbox.prototype.shouldDeselectItem_=function(t,e){return null!=t&&(!t.isCollapsible()||t!=e)},n.Toolbox.prototype.shouldSelectItem_=function(t,e){return null!=e&&e!=t},n.Toolbox.prototype.deselectItem_=function(t){this.selectedItem_=null,this.previouslySelectedItem_=t,t.setSelected(!1),n.utils.aria.setState(this.contentsDiv_,n.utils.aria.State.ACTIVEDESCENDANT,"")},n.Toolbox.prototype.selectItem_=function(t,e){this.selectedItem_=e,this.previouslySelectedItem_=t,e.setSelected(!0),n.utils.aria.setState(this.contentsDiv_,n.utils.aria.State.ACTIVEDESCENDANT,e.getId())},n.Toolbox.prototype.selectItemByPosition=function(t){-1<t&&t<this.contents_.length&&(t=this.contents_[t]).isSelectable()&&this.setSelectedItem(t)},n.Toolbox.prototype.updateFlyout_=function(t,e){(t!=e||e.isCollapsible())&&e&&e.getContents().length?(this.flyout_.show(e.getContents()),this.flyout_.scrollToStart()):this.flyout_.hide()},n.Toolbox.prototype.fireSelectEvent_=function(t,e){var i=t&&t.getName(),o=e&&e.getName();t==e&&(o=null),t=new n.Events.ToolboxItemSelect(i,o,this.workspace_.id),n.Events.fire(t)},n.Toolbox.prototype.onBlocklyAction=function(t){if(!this.selectedItem_)return!1;switch(t.name){case n.navigation.actionNames.PREVIOUS:return this.selectPrevious_();case n.navigation.actionNames.OUT:return this.selectParent_();case n.navigation.actionNames.NEXT:return this.selectNext_();case n.navigation.actionNames.IN:return this.selectChild_();default:return!1}},n.Toolbox.prototype.selectParent_=function(){return!(!this.selectedItem_||(this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.setExpanded(!1),0):!this.selectedItem_.getParent()||!this.selectedItem_.getParent().isSelectable()||(this.setSelectedItem(this.selectedItem_.getParent()),0)))},n.Toolbox.prototype.selectChild_=function(){if(!this.selectedItem_||!this.selectedItem_.isCollapsible())return!1;var t=this.selectedItem_;return t.isExpanded()?this.selectNext_():t.setExpanded(!0),!0},n.Toolbox.prototype.selectNext_=function(){if(!this.selectedItem_)return!1;var t=this.contents_.indexOf(this.selectedItem_)+1;if(-1<t&&t<this.contents_.length){for(var e=this.contents_[t];e&&!e.isSelectable();)e=this.contents_[++t];if(e&&e.isSelectable())return this.setSelectedItem(e),!0}return!1},n.Toolbox.prototype.selectPrevious_=function(){if(!this.selectedItem_)return!1;var t=this.contents_.indexOf(this.selectedItem_)-1;if(-1<t&&t<this.contents_.length){for(var e=this.contents_[t];e&&!e.isSelectable();)e=this.contents_[--t];if(e&&e.isSelectable())return this.setSelectedItem(e),!0}return!1},n.Toolbox.prototype.dispose=function(){this.flyout_.dispose();for(var t=0;t<this.contents_.length;t++)this.contents_[t].dispose();for(t=0;t<this.boundEvents_.length;t++)n.unbindEvent_(this.boundEvents_[t]);this.boundEvents_=[],this.contents_=[],this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),n.utils.dom.removeNode(this.HtmlDiv)},n.Css.register([".blocklyToolboxDelete {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyToolboxGrab {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyToolboxDiv {","background-color: #ddd;","overflow-x: visible;","overflow-y: auto;","padding: 4px 0 4px 0;","position: absolute;","z-index: 70;","-webkit-tap-highlight-color: transparent;","}",".blocklyToolboxContents {","display: flex;","flex-wrap: wrap;","flex-direction: column;","}",".blocklyToolboxContents:focus {","outline: none;","}"]),n.registry.register(n.registry.Type.TOOLBOX,n.registry.DEFAULT,n.Toolbox),n.Events.TrashcanOpen=function(t,e){n.Events.TrashcanOpen.superClass_.constructor.call(this,e),this.isOpen=t},n.utils.object.inherits(n.Events.TrashcanOpen,n.Events.UiBase),n.Events.TrashcanOpen.prototype.type=n.Events.TRASHCAN_OPEN,n.Events.TrashcanOpen.prototype.toJson=function(){var t=n.Events.TrashcanOpen.superClass_.toJson.call(this);return t.isOpen=this.isOpen,t},n.Events.TrashcanOpen.prototype.fromJson=function(t){n.Events.TrashcanOpen.superClass_.fromJson.call(this,t),this.isOpen=t.isOpen},n.registry.register(n.registry.Type.EVENT,n.Events.TRASHCAN_OPEN,n.Events.TrashcanOpen),n.Trashcan=function(t){if(this.workspace_=t,this.contents_=[],this.flyout=null,!(0>=this.workspace_.options.maxTrashcanContents)){if(t=new n.Options({scrollbars:!0,parentWorkspace:this.workspace_,rtl:this.workspace_.RTL,oneBasedIndex:this.workspace_.options.oneBasedIndex,renderer:this.workspace_.options.renderer,rendererOverrides:this.workspace_.options.rendererOverrides}),this.workspace_.horizontalLayout){if(t.toolboxPosition=this.workspace_.toolboxPosition==n.utils.toolbox.Position.TOP?n.utils.toolbox.Position.BOTTOM:n.utils.toolbox.Position.TOP,!n.HorizontalFlyout)throw Error("Missing require for Blockly.HorizontalFlyout");this.flyout=new n.HorizontalFlyout(t)}else{if(t.toolboxPosition=this.workspace_.toolboxPosition==n.utils.toolbox.Position.RIGHT?n.utils.toolbox.Position.LEFT:n.utils.toolbox.Position.RIGHT,!n.VerticalFlyout)throw Error("Missing require for Blockly.VerticalFlyout");this.flyout=new n.VerticalFlyout(t)}this.workspace_.addChangeListener(this.onDelete_.bind(this))}},n.Trashcan.prototype.WIDTH_=47,n.Trashcan.prototype.BODY_HEIGHT_=44,n.Trashcan.prototype.LID_HEIGHT_=16,n.Trashcan.prototype.MARGIN_BOTTOM_=20,n.Trashcan.prototype.MARGIN_SIDE_=20,n.Trashcan.prototype.MARGIN_HOTSPOT_=10,n.Trashcan.prototype.SPRITE_LEFT_=0,n.Trashcan.prototype.SPRITE_TOP_=32,n.Trashcan.prototype.HAS_BLOCKS_LID_ANGLE_=.1,n.Trashcan.ANIMATION_LENGTH_=80,n.Trashcan.ANIMATION_FRAMES_=4,n.Trashcan.OPACITY_MIN_=.4,n.Trashcan.OPACITY_MAX_=.8,n.Trashcan.MAX_LID_ANGLE_=45,n.Trashcan.prototype.isLidOpen=!1,n.Trashcan.prototype.minOpenness_=0,n.Trashcan.prototype.svgGroup_=null,n.Trashcan.prototype.svgLid_=null,n.Trashcan.prototype.lidTask_=0,n.Trashcan.prototype.lidOpen_=0,n.Trashcan.prototype.left_=0,n.Trashcan.prototype.top_=0,n.Trashcan.prototype.createDom=function(){this.svgGroup_=n.utils.dom.createSvgElement(n.utils.Svg.G,{class:"blocklyTrash"},null);var t=String(Math.random()).substring(2),e=n.utils.dom.createSvgElement(n.utils.Svg.CLIPPATH,{id:"blocklyTrashBodyClipPath"+t},this.svgGroup_);n.utils.dom.createSvgElement(n.utils.Svg.RECT,{width:this.WIDTH_,height:this.BODY_HEIGHT_,y:this.LID_HEIGHT_},e);var i=n.utils.dom.createSvgElement(n.utils.Svg.IMAGE,{width:n.SPRITE.width,x:-this.SPRITE_LEFT_,height:n.SPRITE.height,y:-this.SPRITE_TOP_,"clip-path":"url(#blocklyTrashBodyClipPath"+t+")"},this.svgGroup_);return i.setAttributeNS(n.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+n.SPRITE.url),e=n.utils.dom.createSvgElement(n.utils.Svg.CLIPPATH,{id:"blocklyTrashLidClipPath"+t},this.svgGroup_),n.utils.dom.createSvgElement(n.utils.Svg.RECT,{width:this.WIDTH_,height:this.LID_HEIGHT_},e),this.svgLid_=n.utils.dom.createSvgElement(n.utils.Svg.IMAGE,{width:n.SPRITE.width,x:-this.SPRITE_LEFT_,height:n.SPRITE.height,y:-this.SPRITE_TOP_,"clip-path":"url(#blocklyTrashLidClipPath"+t+")"},this.svgGroup_),this.svgLid_.setAttributeNS(n.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+n.SPRITE.url),n.bindEvent_(this.svgGroup_,"mousedown",this,this.blockMouseDownWhenOpenable_),n.bindEvent_(this.svgGroup_,"mouseup",this,this.click),n.bindEvent_(i,"mouseover",this,this.mouseOver_),n.bindEvent_(i,"mouseout",this,this.mouseOut_),this.animateLid_(),this.svgGroup_},n.Trashcan.prototype.init=function(t){return 0<this.workspace_.options.maxTrashcanContents&&(n.utils.dom.insertAfter(this.flyout.createDom(n.utils.Svg.SVG),this.workspace_.getParentSvg()),this.flyout.init(this.workspace_)),this.verticalSpacing_=this.MARGIN_BOTTOM_+t,this.setLidOpen(!1),this.verticalSpacing_+this.BODY_HEIGHT_+this.LID_HEIGHT_},n.Trashcan.prototype.dispose=function(){this.svgGroup_&&(n.utils.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.workspace_=this.svgLid_=null,clearTimeout(this.lidTask_)},n.Trashcan.prototype.hasContents_=function(){return!!this.contents_.length},n.Trashcan.prototype.contentsIsOpen=function(){return this.flyout.isVisible()},n.Trashcan.prototype.openFlyout=function(){if(!this.contentsIsOpen()){for(var t,e=[],i=0;t=this.contents_[i];i++)e[i]=n.Xml.textToDom(t);this.flyout.show(e),this.fireUiEvent_(!0)}},n.Trashcan.prototype.closeFlyout=function(){this.contentsIsOpen()&&(this.flyout.hide(),this.fireUiEvent_(!1))},n.Trashcan.prototype.emptyContents=function(){this.hasContents_()&&(this.contents_.length=0,this.setMinOpenness_(0),this.closeFlyout())},n.Trashcan.prototype.position=function(){if(this.verticalSpacing_){var t=this.workspace_.getMetrics();t&&(this.left_=t.toolboxPosition==n.TOOLBOX_AT_LEFT||this.workspace_.horizontalLayout&&!this.workspace_.RTL?t.viewWidth+t.absoluteLeft-this.WIDTH_-this.MARGIN_SIDE_-n.Scrollbar.scrollbarThickness:this.MARGIN_SIDE_+n.Scrollbar.scrollbarThickness,this.top_=t.toolboxPosition==n.TOOLBOX_AT_BOTTOM?this.verticalSpacing_:t.viewHeight+t.absoluteTop-(this.BODY_HEIGHT_+this.LID_HEIGHT_)-this.verticalSpacing_,this.svgGroup_.setAttribute("transform","translate("+this.left_+","+this.top_+")"))}},n.Trashcan.prototype.getClientRect=function(){if(!this.svgGroup_)return null;var t=this.svgGroup_.getBoundingClientRect(),e=t.top+this.SPRITE_TOP_-this.MARGIN_HOTSPOT_;return t=t.left+this.SPRITE_LEFT_-this.MARGIN_HOTSPOT_,new n.utils.Rect(e,e+this.LID_HEIGHT_+this.BODY_HEIGHT_+2*this.MARGIN_HOTSPOT_,t,t+this.WIDTH_+2*this.MARGIN_HOTSPOT_)},n.Trashcan.prototype.setLidOpen=function(t){this.isLidOpen!=t&&(clearTimeout(this.lidTask_),this.isLidOpen=t,this.animateLid_())},n.Trashcan.prototype.animateLid_=function(){var t=n.Trashcan.ANIMATION_FRAMES_,e=1/(t+1);this.lidOpen_+=this.isLidOpen?e:-e,this.lidOpen_=Math.min(Math.max(this.lidOpen_,this.minOpenness_),1),this.setLidAngle_(this.lidOpen_*n.Trashcan.MAX_LID_ANGLE_),e=n.Trashcan.OPACITY_MIN_,this.svgGroup_.style.opacity=e+this.lidOpen_*(n.Trashcan.OPACITY_MAX_-e),this.lidOpen_>this.minOpenness_&&1>this.lidOpen_&&(this.lidTask_=setTimeout(this.animateLid_.bind(this),n.Trashcan.ANIMATION_LENGTH_/t))},n.Trashcan.prototype.setLidAngle_=function(t){var e=this.workspace_.toolboxPosition==n.TOOLBOX_AT_RIGHT||this.workspace_.horizontalLayout&&this.workspace_.RTL;this.svgLid_.setAttribute("transform","rotate("+(e?-t:t)+","+(e?4:this.WIDTH_-4)+","+(this.LID_HEIGHT_-2)+")")},n.Trashcan.prototype.setMinOpenness_=function(t){this.minOpenness_=t,this.isLidOpen||this.setLidAngle_(t*n.Trashcan.MAX_LID_ANGLE_)},n.Trashcan.prototype.closeLid=function(){this.setLidOpen(!1)},n.Trashcan.prototype.click=function(){this.hasContents_()&&this.openFlyout()},n.Trashcan.prototype.fireUiEvent_=function(t){t=new n.Events.TrashcanOpen(t,this.workspace_.id),n.Events.fire(t)},n.Trashcan.prototype.blockMouseDownWhenOpenable_=function(t){!this.contentsIsOpen()&&this.hasContents_()&&t.stopPropagation()},n.Trashcan.prototype.mouseOver_=function(){this.hasContents_()&&this.setLidOpen(!0)},n.Trashcan.prototype.mouseOut_=function(){this.setLidOpen(!1)},n.Trashcan.prototype.onDelete_=function(t){if(!(0>=this.workspace_.options.maxTrashcanContents)&&t.type==n.Events.BLOCK_DELETE&&t.oldXml.tagName&&"shadow"!=t.oldXml.tagName.toLowerCase()&&(t=this.cleanBlockXML_(t.oldXml),-1==this.contents_.indexOf(t))){for(this.contents_.unshift(t);this.contents_.length>this.workspace_.options.maxTrashcanContents;)this.contents_.pop();this.setMinOpenness_(this.HAS_BLOCKS_LID_ANGLE_)}},n.Trashcan.prototype.cleanBlockXML_=function(t){for(var e=t=t.cloneNode(!0);e;){e.removeAttribute&&(e.removeAttribute("x"),e.removeAttribute("y"),e.removeAttribute("id"),e.removeAttribute("disabled"),"comment"==e.nodeName&&(e.removeAttribute("h"),e.removeAttribute("w"),e.removeAttribute("pinned")));var i=e.firstChild||e.nextSibling;if(!i)for(i=e.parentNode;i;){if(i.nextSibling){i=i.nextSibling;break}i=i.parentNode}e=i}return n.Xml.domToText(t)},n.VariablesDynamic={},n.VariablesDynamic.onCreateVariableButtonClick_String=function(t){n.Variables.createVariableButtonHandler(t.getTargetWorkspace(),void 0,"String")},n.VariablesDynamic.onCreateVariableButtonClick_Number=function(t){n.Variables.createVariableButtonHandler(t.getTargetWorkspace(),void 0,"Number")},n.VariablesDynamic.onCreateVariableButtonClick_Colour=function(t){n.Variables.createVariableButtonHandler(t.getTargetWorkspace(),void 0,"Colour")},n.VariablesDynamic.flyoutCategory=function(t){var e=[],i=document.createElement("button");return i.setAttribute("text",n.Msg.NEW_STRING_VARIABLE),i.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),e.push(i),(i=document.createElement("button")).setAttribute("text",n.Msg.NEW_NUMBER_VARIABLE),i.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),e.push(i),(i=document.createElement("button")).setAttribute("text",n.Msg.NEW_COLOUR_VARIABLE),i.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),e.push(i),t.registerButtonCallback("CREATE_VARIABLE_STRING",n.VariablesDynamic.onCreateVariableButtonClick_String),t.registerButtonCallback("CREATE_VARIABLE_NUMBER",n.VariablesDynamic.onCreateVariableButtonClick_Number),t.registerButtonCallback("CREATE_VARIABLE_COLOUR",n.VariablesDynamic.onCreateVariableButtonClick_Colour),t=n.VariablesDynamic.flyoutCategoryBlocks(t),e.concat(t)},n.VariablesDynamic.flyoutCategoryBlocks=function(t){var e=[];if(0<(t=t.getAllVariables()).length){if(n.Blocks.variables_set_dynamic){var i=t[t.length-1],o=n.utils.xml.createElement("block");o.setAttribute("type","variables_set_dynamic"),o.setAttribute("gap",24),o.appendChild(n.Variables.generateVariableFieldDom(i)),e.push(o)}if(n.Blocks.variables_get_dynamic){t.sort(n.VariableModel.compareByName),i=0;for(var r;r=t[i];i++)(o=n.utils.xml.createElement("block")).setAttribute("type","variables_get_dynamic"),o.setAttribute("gap",8),o.appendChild(n.Variables.generateVariableFieldDom(r)),e.push(o)}}return e},n.ZoomControls=function(t){this.workspace_=t,this.zoomResetGroup_=this.zoomOutGroup_=this.zoomInGroup_=this.verticalSpacing_=this.onZoomOutWrapper_=this.onZoomInWrapper_=this.onZoomResetWrapper_=null},n.ZoomControls.prototype.WIDTH_=32,n.ZoomControls.prototype.HEIGHT_=110,n.ZoomControls.prototype.MARGIN_BOTTOM_=20,n.ZoomControls.prototype.MARGIN_SIDE_=20,n.ZoomControls.prototype.svgGroup_=null,n.ZoomControls.prototype.left_=0,n.ZoomControls.prototype.top_=0,n.ZoomControls.prototype.createDom=function(){this.svgGroup_=n.utils.dom.createSvgElement(n.utils.Svg.G,{},null);var t=String(Math.random()).substring(2);return this.createZoomOutSvg_(t),this.createZoomInSvg_(t),this.workspace_.isMovable()&&this.createZoomResetSvg_(t),this.svgGroup_},n.ZoomControls.prototype.init=function(t){return this.verticalSpacing_=this.MARGIN_BOTTOM_+t,this.verticalSpacing_+this.HEIGHT_},n.ZoomControls.prototype.dispose=function(){this.svgGroup_&&n.utils.dom.removeNode(this.svgGroup_),this.onZoomResetWrapper_&&n.unbindEvent_(this.onZoomResetWrapper_),this.onZoomInWrapper_&&n.unbindEvent_(this.onZoomInWrapper_),this.onZoomOutWrapper_&&n.unbindEvent_(this.onZoomOutWrapper_)},n.ZoomControls.prototype.position=function(){if(this.verticalSpacing_){var t=this.workspace_.getMetrics();t&&(this.left_=t.toolboxPosition==n.TOOLBOX_AT_LEFT||this.workspace_.horizontalLayout&&!this.workspace_.RTL?t.viewWidth+t.absoluteLeft-this.WIDTH_-this.MARGIN_SIDE_-n.Scrollbar.scrollbarThickness:this.MARGIN_SIDE_+n.Scrollbar.scrollbarThickness,t.toolboxPosition==n.TOOLBOX_AT_BOTTOM?(this.top_=this.verticalSpacing_,this.zoomInGroup_.setAttribute("transform","translate(0, 34)"),this.zoomResetGroup_&&this.zoomResetGroup_.setAttribute("transform","translate(0, 77)")):(this.top_=t.viewHeight+t.absoluteTop-this.HEIGHT_-this.verticalSpacing_,this.zoomInGroup_.setAttribute("transform","translate(0, 43)"),this.zoomOutGroup_.setAttribute("transform","translate(0, 77)")),this.svgGroup_.setAttribute("transform","translate("+this.left_+","+this.top_+")"))}},n.ZoomControls.prototype.createZoomOutSvg_=function(t){this.zoomOutGroup_=n.utils.dom.createSvgElement(n.utils.Svg.G,{class:"blocklyZoom"},this.svgGroup_);var e=n.utils.dom.createSvgElement(n.utils.Svg.CLIPPATH,{id:"blocklyZoomoutClipPath"+t},this.zoomOutGroup_);n.utils.dom.createSvgElement(n.utils.Svg.RECT,{width:32,height:32},e),n.utils.dom.createSvgElement(n.utils.Svg.IMAGE,{width:n.SPRITE.width,height:n.SPRITE.height,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+t+")"},this.zoomOutGroup_).setAttributeNS(n.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+n.SPRITE.url),this.onZoomOutWrapper_=n.bindEventWithChecks_(this.zoomOutGroup_,"mousedown",null,this.zoom_.bind(this,-1))},n.ZoomControls.prototype.createZoomInSvg_=function(t){this.zoomInGroup_=n.utils.dom.createSvgElement(n.utils.Svg.G,{class:"blocklyZoom"},this.svgGroup_);var e=n.utils.dom.createSvgElement(n.utils.Svg.CLIPPATH,{id:"blocklyZoominClipPath"+t},this.zoomInGroup_);n.utils.dom.createSvgElement(n.utils.Svg.RECT,{width:32,height:32},e),n.utils.dom.createSvgElement(n.utils.Svg.IMAGE,{width:n.SPRITE.width,height:n.SPRITE.height,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+t+")"},this.zoomInGroup_).setAttributeNS(n.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+n.SPRITE.url),this.onZoomInWrapper_=n.bindEventWithChecks_(this.zoomInGroup_,"mousedown",null,this.zoom_.bind(this,1))},n.ZoomControls.prototype.zoom_=function(t,e){this.workspace_.markFocused(),this.workspace_.zoomCenter(t),this.fireZoomEvent_(),n.Touch.clearTouchIdentifier(),e.stopPropagation(),e.preventDefault()},n.ZoomControls.prototype.createZoomResetSvg_=function(t){this.zoomResetGroup_=n.utils.dom.createSvgElement(n.utils.Svg.G,{class:"blocklyZoom"},this.svgGroup_);var e=n.utils.dom.createSvgElement(n.utils.Svg.CLIPPATH,{id:"blocklyZoomresetClipPath"+t},this.zoomResetGroup_);n.utils.dom.createSvgElement(n.utils.Svg.RECT,{width:32,height:32},e),n.utils.dom.createSvgElement(n.utils.Svg.IMAGE,{width:n.SPRITE.width,height:n.SPRITE.height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+t+")"},this.zoomResetGroup_).setAttributeNS(n.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+n.SPRITE.url),this.onZoomResetWrapper_=n.bindEventWithChecks_(this.zoomResetGroup_,"mousedown",null,this.resetZoom_.bind(this))},n.ZoomControls.prototype.resetZoom_=function(t){this.workspace_.markFocused(),this.workspace_.setScale(this.workspace_.options.zoomOptions.startScale),this.workspace_.beginCanvasTransition(),this.workspace_.scrollCenter(),setTimeout(this.workspace_.endCanvasTransition.bind(this.workspace_),500),this.fireZoomEvent_(),n.Touch.clearTouchIdentifier(),t.stopPropagation(),t.preventDefault()},n.ZoomControls.prototype.fireZoomEvent_=function(){var t=new n.Events.Click(null,this.workspace_.id,"zoom_controls");n.Events.fire(t)},n.Css.register([".blocklyZoom>image, .blocklyZoom>svg>image {","opacity: .4;","}",".blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {","opacity: .6;","}",".blocklyZoom>image:active, .blocklyZoom>svg>image:active {","opacity: .8;","}"]),n.Mutator=function(t){n.Mutator.superClass_.constructor.call(this,null),this.quarkNames_=t},n.utils.object.inherits(n.Mutator,n.Icon),n.Mutator.prototype.workspaceWidth_=0,n.Mutator.prototype.workspaceHeight_=0,n.Mutator.prototype.setBlock=function(t){this.block_=t},n.Mutator.prototype.getWorkspace=function(){return this.workspace_},n.Mutator.prototype.drawIcon_=function(t){n.utils.dom.createSvgElement(n.utils.Svg.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},t),n.utils.dom.createSvgElement(n.utils.Svg.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},t),n.utils.dom.createSvgElement(n.utils.Svg.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},t)},n.Mutator.prototype.iconClick_=function(t){this.block_.isEditable()&&n.Icon.prototype.iconClick_.call(this,t)},n.Mutator.prototype.createEditor_=function(){if(this.svgDialog_=n.utils.dom.createSvgElement(n.utils.Svg.SVG,{x:n.Bubble.BORDER_WIDTH,y:n.Bubble.BORDER_WIDTH},null),this.quarkNames_.length)for(var t,e=n.utils.xml.createElement("xml"),i=0;t=this.quarkNames_[i];i++){var o=n.utils.xml.createElement("block");o.setAttribute("type",t),e.appendChild(o)}else e=null;return(i=new n.Options({disable:!1,parentWorkspace:this.block_.workspace,media:this.block_.workspace.options.pathToMedia,rtl:this.block_.RTL,horizontalLayout:!1,renderer:this.block_.workspace.options.renderer,rendererOverrides:this.block_.workspace.options.rendererOverrides})).toolboxPosition=this.block_.RTL?n.utils.toolbox.Position.RIGHT:n.utils.toolbox.Position.LEFT,(t=!!e)&&(i.languageTree=n.utils.toolbox.convertToolboxDefToJson(e),i.getMetrics=this.getFlyoutMetrics_.bind(this)),this.workspace_=new n.WorkspaceSvg(i),this.workspace_.isMutator=!0,this.workspace_.addChangeListener(n.Events.disableOrphans),e=t?this.workspace_.addFlyout(n.utils.Svg.G):null,i=this.workspace_.createDom("blocklyMutatorBackground"),e&&i.insertBefore(e,this.workspace_.svgBlockCanvas_),this.svgDialog_.appendChild(i),this.svgDialog_},n.Mutator.prototype.updateEditable=function(){n.Mutator.superClass_.updateEditable.call(this),this.block_.isInFlyout||(this.block_.isEditable()?this.iconGroup_&&n.utils.dom.removeClass(this.iconGroup_,"blocklyIconGroupReadonly"):(this.setVisible(!1),this.iconGroup_&&n.utils.dom.addClass(this.iconGroup_,"blocklyIconGroupReadonly")))},n.Mutator.prototype.resizeBubble_=function(){var t=2*n.Bubble.BORDER_WIDTH,e=this.workspace_.getCanvas().getBBox(),i=e.width+e.x,o=e.height+3*t,r=this.workspace_.getFlyout();if(r){var s=r.getMetrics_();o=Math.max(o,s.contentHeight+20),i+=r.getWidth()}this.block_.RTL&&(i=-e.x),i+=3*t,(Math.abs(this.workspaceWidth_-i)>t||Math.abs(this.workspaceHeight_-o)>t)&&(this.workspaceWidth_=i,this.workspaceHeight_=o,this.bubble_.setBubbleSize(i+t,o+t),this.svgDialog_.setAttribute("width",this.workspaceWidth_),this.svgDialog_.setAttribute("height",this.workspaceHeight_)),this.block_.RTL&&(t="translate("+this.workspaceWidth_+",0)",this.workspace_.getCanvas().setAttribute("transform",t)),this.workspace_.resize()},n.Mutator.prototype.onBubbleMove_=function(){this.workspace_&&this.workspace_.recordDeleteAreas()},n.Mutator.prototype.setVisible=function(t){if(t!=this.isVisible())if(n.Events.fire(new n.Events.BubbleOpen(this.block_,t,"mutator")),t){this.bubble_=new n.Bubble(this.block_.workspace,this.createEditor_(),this.block_.pathObject.svgPath,this.iconXY_,null,null),this.bubble_.setSvgId(this.block_.id),this.bubble_.registerMoveEvent(this.onBubbleMove_.bind(this));var e=this.workspace_.options.languageTree;t=this.workspace_.getFlyout(),e&&(t.init(this.workspace_),t.show(e)),this.rootBlock_=this.block_.decompose(this.workspace_),e=this.rootBlock_.getDescendants(!1);for(var i,o=0;i=e[o];o++)i.render();if(this.rootBlock_.setMovable(!1),this.rootBlock_.setDeletable(!1),t?(e=2*t.CORNER_RADIUS,t=this.rootBlock_.RTL?t.getWidth()+e:e):t=e=16,this.block_.RTL&&(t=-t),this.rootBlock_.moveBy(t,e),this.block_.saveConnections){var r=this,s=this.block_;s.saveConnections(this.rootBlock_),this.sourceListener_=function(){s.saveConnections(r.rootBlock_)},this.block_.workspace.addChangeListener(this.sourceListener_)}this.resizeBubble_(),this.workspace_.addChangeListener(this.workspaceChanged_.bind(this)),this.applyColour()}else this.svgDialog_=null,this.workspace_.dispose(),this.rootBlock_=this.workspace_=null,this.bubble_.dispose(),this.bubble_=null,this.workspaceHeight_=this.workspaceWidth_=0,this.sourceListener_&&(this.block_.workspace.removeChangeListener(this.sourceListener_),this.sourceListener_=null)},n.Mutator.prototype.workspaceChanged_=function(t){if(!(t.isUiEvent||t.type==n.Events.CHANGE&&"disabled"==t.element)){if(!this.workspace_.isDragging()){t=this.workspace_.getTopBlocks(!1);for(var e,i=0;e=t[i];i++){var o=e.getRelativeToSurfaceXY();if(20>o.y&&e.moveBy(0,20-o.y),e.RTL){var r=-20,s=this.workspace_.getFlyout();s&&(r-=s.getWidth()),o.x>r&&e.moveBy(r-o.x,0)}else 20>o.x&&e.moveBy(20-o.x,0)}}if(this.rootBlock_.workspace==this.workspace_){if(n.Events.setGroup(!0),t=(t=(e=this.block_).mutationToDom())&&n.Xml.domToText(t),i=e.rendered,e.rendered=!1,e.compose(this.rootBlock_),e.rendered=i,e.initSvg(),n.getMainWorkspace().keyboardAccessibilityMode&&n.navigation.moveCursorOnBlockMutation(e),e.rendered&&e.render(),t!=(i=(i=e.mutationToDom())&&n.Xml.domToText(i))){n.Events.fire(new n.Events.BlockChange(e,"mutation",null,t,i));var a=n.Events.getGroup();setTimeout((function(){n.Events.setGroup(a),e.bumpNeighbours(),n.Events.setGroup(!1)}),n.BUMP_DELAY)}this.workspace_.isDragging()||this.resizeBubble_(),n.Events.setGroup(!1)}}},n.Mutator.prototype.getFlyoutMetrics_=function(){var t=this.workspace_.getFlyout();return t=t?t.getWidth():0,{contentHeight:0,contentWidth:0,contentTop:0,contentLeft:0,viewHeight:this.workspaceHeight_,viewWidth:this.workspaceWidth_-t,viewTop:0,viewLeft:0,absoluteTop:0,absoluteLeft:this.workspace_.RTL?0:t}},n.Mutator.prototype.dispose=function(){this.block_.mutator=null,n.Icon.prototype.dispose.call(this)},n.Mutator.prototype.updateBlockStyle=function(){var t=this.workspace_;if(t&&t.getAllBlocks(!1)){for(var e=t.getAllBlocks(!1),n=0;n<e.length;n++){var i=e[n];i.setStyle(i.getStyleName())}if(n=t.getFlyout())for(t=n.workspace_.getAllBlocks(!1),n=0;n<t.length;n++)(i=t[n]).setStyle(i.getStyleName())}},n.Mutator.reconnect=function(t,e,n){if(!t||!t.getSourceBlock().workspace)return!1;n=e.getInput(n).connection;var i=t.targetBlock();return!(i&&i!=e||n.targetConnection==t||(n.isConnected()&&n.disconnect(),n.connect(t),0))},n.Mutator.findParentWs=function(t){var e=null;if(t&&t.options){var n=t.options.parentWorkspace;t.isFlyout?n&&n.options&&(e=n.options.parentWorkspace):n&&(e=n)}return e},n.FieldTextInput=function(t,e,i){this.spellcheck_=!0,n.FieldTextInput.superClass_.constructor.call(this,t,e,i),this.onKeyInputWrapper_=this.onKeyDownWrapper_=this.htmlInput_=null,this.fullBlockClickTarget_=!1,this.workspace_=null},n.utils.object.inherits(n.FieldTextInput,n.Field),n.FieldTextInput.prototype.DEFAULT_VALUE="",n.FieldTextInput.fromJson=function(t){var e=n.utils.replaceMessageReferences(t.text);return new n.FieldTextInput(e,void 0,t)},n.FieldTextInput.prototype.SERIALIZABLE=!0,n.FieldTextInput.BORDERRADIUS=4,n.FieldTextInput.prototype.CURSOR="text",n.FieldTextInput.prototype.configure_=function(t){n.FieldTextInput.superClass_.configure_.call(this,t),"boolean"==typeof t.spellcheck&&(this.spellcheck_=t.spellcheck)},n.FieldTextInput.prototype.initView=function(){if(this.getConstants().FULL_BLOCK_FIELDS){for(var t,e=0,n=0,i=0;t=this.sourceBlock_.inputList[i];i++){for(var o=0;t.fieldRow[o];o++)e++;t.connection&&n++}this.fullBlockClickTarget_=1>=e&&this.sourceBlock_.outputConnection&&!n}else this.fullBlockClickTarget_=!1;this.fullBlockClickTarget_?this.clickTarget_=this.sourceBlock_.getSvgRoot():this.createBorderRect_(),this.createTextElement_()},n.FieldTextInput.prototype.doClassValidation_=function(t){return null==t?null:String(t)},n.FieldTextInput.prototype.doValueInvalid_=function(t){this.isBeingEdited_&&(this.isTextValid_=!1,t=this.value_,this.value_=this.htmlInput_.untypedDefaultValue_,this.sourceBlock_&&n.Events.isEnabled()&&n.Events.fire(new n.Events.BlockChange(this.sourceBlock_,"field",this.name||null,t,this.value_)))},n.FieldTextInput.prototype.doValueUpdate_=function(t){this.isTextValid_=!0,this.value_=t,this.isBeingEdited_||(this.isDirty_=!0)},n.FieldTextInput.prototype.applyColour=function(){this.sourceBlock_&&this.getConstants().FULL_BLOCK_FIELDS&&(this.borderRect_?this.borderRect_.setAttribute("stroke",this.sourceBlock_.style.colourTertiary):this.sourceBlock_.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR))},n.FieldTextInput.prototype.render_=function(){if(n.FieldTextInput.superClass_.render_.call(this),this.isBeingEdited_){this.resizeEditor_();var t=this.htmlInput_;this.isTextValid_?(n.utils.dom.removeClass(t,"blocklyInvalidInput"),n.utils.aria.setState(t,n.utils.aria.State.INVALID,!1)):(n.utils.dom.addClass(t,"blocklyInvalidInput"),n.utils.aria.setState(t,n.utils.aria.State.INVALID,!0))}},n.FieldTextInput.prototype.setSpellcheck=function(t){t!=this.spellcheck_&&(this.spellcheck_=t,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_))},n.FieldTextInput.prototype.showEditor_=function(t,e){this.workspace_=this.sourceBlock_.workspace,!(t=e||!1)&&(n.utils.userAgent.MOBILE||n.utils.userAgent.ANDROID||n.utils.userAgent.IPAD)?this.showPromptEditor_():this.showInlineEditor_(t)},n.FieldTextInput.prototype.showPromptEditor_=function(){n.prompt(n.Msg.CHANGE_VALUE_TITLE,this.getText(),function(t){this.setValue(this.getValueFromEditorText_(t))}.bind(this))},n.FieldTextInput.prototype.showInlineEditor_=function(t){n.WidgetDiv.show(this,this.sourceBlock_.RTL,this.widgetDispose_.bind(this)),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,t||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())},n.FieldTextInput.prototype.widgetCreate_=function(){var t=n.WidgetDiv.DIV;n.utils.dom.addClass(this.getClickTarget_(),"editing");var e=document.createElement("input");e.className="blocklyHtmlInput",e.setAttribute("spellcheck",this.spellcheck_);var i=this.workspace_.getScale(),o=this.getConstants().FIELD_TEXT_FONTSIZE*i+"pt";if(t.style.fontSize=o,e.style.fontSize=o,o=n.FieldTextInput.BORDERRADIUS*i+"px",this.fullBlockClickTarget_){o=((o=this.getScaledBBox()).bottom-o.top)/2+"px";var r=this.sourceBlock_.getParent()?this.sourceBlock_.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary;e.style.border=1*i+"px solid "+r,t.style.borderRadius=o,t.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(t.style.boxShadow="rgba(255, 255, 255, 0.3) 0px 0px 0px "+4*i+"px")}return e.style.borderRadius=o,t.appendChild(e),e.value=e.defaultValue=this.getEditorText_(this.value_),e.untypedDefaultValue_=this.value_,e.oldValue_=null,this.resizeEditor_(),this.bindInputEvents_(e),e},n.FieldTextInput.prototype.widgetDispose_=function(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_&&this.onFinishEditing_(this.value_),this.unbindInputEvents_();var t=n.WidgetDiv.DIV.style;t.width="auto",t.height="auto",t.fontSize="",t.transition="",t.boxShadow="",this.htmlInput_=null,n.utils.dom.removeClass(this.getClickTarget_(),"editing")},n.FieldTextInput.prototype.bindInputEvents_=function(t){this.onKeyDownWrapper_=n.bindEventWithChecks_(t,"keydown",this,this.onHtmlInputKeyDown_),this.onKeyInputWrapper_=n.bindEventWithChecks_(t,"input",this,this.onHtmlInputChange_)},n.FieldTextInput.prototype.unbindInputEvents_=function(){this.onKeyDownWrapper_&&(n.unbindEvent_(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.onKeyInputWrapper_&&(n.unbindEvent_(this.onKeyInputWrapper_),this.onKeyInputWrapper_=null)},n.FieldTextInput.prototype.onHtmlInputKeyDown_=function(t){t.keyCode==n.utils.KeyCodes.ENTER?(n.WidgetDiv.hide(),n.DropDownDiv.hideWithoutAnimation()):t.keyCode==n.utils.KeyCodes.ESC?(this.htmlInput_.value=this.htmlInput_.defaultValue,n.WidgetDiv.hide(),n.DropDownDiv.hideWithoutAnimation()):t.keyCode==n.utils.KeyCodes.TAB&&(n.WidgetDiv.hide(),n.DropDownDiv.hideWithoutAnimation(),this.sourceBlock_.tab(this,!t.shiftKey),t.preventDefault())},n.FieldTextInput.prototype.onHtmlInputChange_=function(t){(t=this.htmlInput_.value)!==this.htmlInput_.oldValue_&&(this.htmlInput_.oldValue_=t,n.Events.setGroup(!0),t=this.getValueFromEditorText_(t),this.setValue(t),this.forceRerender(),this.resizeEditor_(),n.Events.setGroup(!1))},n.FieldTextInput.prototype.setEditorValue_=function(t){this.isDirty_=!0,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(t)),this.setValue(t)},n.FieldTextInput.prototype.resizeEditor_=function(){var t=n.WidgetDiv.DIV,e=this.getScaledBBox();t.style.width=e.right-e.left+"px",t.style.height=e.bottom-e.top+"px",e=new n.utils.Coordinate(this.sourceBlock_.RTL?e.right-t.offsetWidth:e.left,e.top),t.style.left=e.x+"px",t.style.top=e.y+"px"},n.FieldTextInput.prototype.isTabNavigable=function(){return!0},n.FieldTextInput.prototype.getText_=function(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null},n.FieldTextInput.prototype.getEditorText_=function(t){return String(t)},n.FieldTextInput.prototype.getValueFromEditorText_=function(t){return t},n.fieldRegistry.register("field_input",n.FieldTextInput),n.FieldAngle=function(t,e,i){this.clockwise_=n.FieldAngle.CLOCKWISE,this.offset_=n.FieldAngle.OFFSET,this.wrap_=n.FieldAngle.WRAP,this.round_=n.FieldAngle.ROUND,n.FieldAngle.superClass_.constructor.call(this,t,e,i),this.moveSurfaceWrapper_=this.clickSurfaceWrapper_=this.clickWrapper_=this.line_=this.gauge_=null},n.utils.object.inherits(n.FieldAngle,n.FieldTextInput),n.FieldAngle.prototype.DEFAULT_VALUE=0,n.FieldAngle.fromJson=function(t){return new n.FieldAngle(t.angle,void 0,t)},n.FieldAngle.prototype.SERIALIZABLE=!0,n.FieldAngle.ROUND=15,n.FieldAngle.HALF=50,n.FieldAngle.CLOCKWISE=!1,n.FieldAngle.OFFSET=0,n.FieldAngle.WRAP=360,n.FieldAngle.RADIUS=n.FieldAngle.HALF-1,n.FieldAngle.prototype.configure_=function(t){switch(n.FieldAngle.superClass_.configure_.call(this,t),t.mode){case"compass":this.clockwise_=!0,this.offset_=90;break;case"protractor":this.clockwise_=!1,this.offset_=0}var e=t.clockwise;"boolean"==typeof e&&(this.clockwise_=e),null!=(e=t.offset)&&(e=Number(e),isNaN(e)||(this.offset_=e)),null!=(e=t.wrap)&&(e=Number(e),isNaN(e)||(this.wrap_=e)),null!=(t=t.round)&&(t=Number(t),isNaN(t)||(this.round_=t))},n.FieldAngle.prototype.initView=function(){n.FieldAngle.superClass_.initView.call(this),this.symbol_=n.utils.dom.createSvgElement(n.utils.Svg.TSPAN,{},null),this.symbol_.appendChild(document.createTextNode("Â°")),this.textElement_.appendChild(this.symbol_)},n.FieldAngle.prototype.render_=function(){n.FieldAngle.superClass_.render_.call(this),this.updateGraph_()},n.FieldAngle.prototype.showEditor_=function(t){n.FieldAngle.superClass_.showEditor_.call(this,t,n.utils.userAgent.MOBILE||n.utils.userAgent.ANDROID||n.utils.userAgent.IPAD),t=this.dropdownCreate_(),n.DropDownDiv.getContentDiv().appendChild(t),n.DropDownDiv.setColour(this.sourceBlock_.style.colourPrimary,this.sourceBlock_.style.colourTertiary),n.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.updateGraph_()},n.FieldAngle.prototype.dropdownCreate_=function(){var t=n.utils.dom.createSvgElement(n.utils.Svg.SVG,{xmlns:n.utils.dom.SVG_NS,"xmlns:html":n.utils.dom.HTML_NS,"xmlns:xlink":n.utils.dom.XLINK_NS,version:"1.1",height:2*n.FieldAngle.HALF+"px",width:2*n.FieldAngle.HALF+"px",style:"touch-action: none"},null),e=n.utils.dom.createSvgElement(n.utils.Svg.CIRCLE,{cx:n.FieldAngle.HALF,cy:n.FieldAngle.HALF,r:n.FieldAngle.RADIUS,class:"blocklyAngleCircle"},t);this.gauge_=n.utils.dom.createSvgElement(n.utils.Svg.PATH,{class:"blocklyAngleGauge"},t),this.line_=n.utils.dom.createSvgElement(n.utils.Svg.LINE,{x1:n.FieldAngle.HALF,y1:n.FieldAngle.HALF,class:"blocklyAngleLine"},t);for(var i=0;360>i;i+=15)n.utils.dom.createSvgElement(n.utils.Svg.LINE,{x1:n.FieldAngle.HALF+n.FieldAngle.RADIUS,y1:n.FieldAngle.HALF,x2:n.FieldAngle.HALF+n.FieldAngle.RADIUS-(0==i%45?10:5),y2:n.FieldAngle.HALF,class:"blocklyAngleMarks",transform:"rotate("+i+","+n.FieldAngle.HALF+","+n.FieldAngle.HALF+")"},t);return this.clickWrapper_=n.bindEventWithChecks_(t,"click",this,this.hide_),this.clickSurfaceWrapper_=n.bindEventWithChecks_(e,"click",this,this.onMouseMove_,!0,!0),this.moveSurfaceWrapper_=n.bindEventWithChecks_(e,"mousemove",this,this.onMouseMove_,!0,!0),t},n.FieldAngle.prototype.dropdownDispose_=function(){this.clickWrapper_&&(n.unbindEvent_(this.clickWrapper_),this.clickWrapper_=null),this.clickSurfaceWrapper_&&(n.unbindEvent_(this.clickSurfaceWrapper_),this.clickSurfaceWrapper_=null),this.moveSurfaceWrapper_&&(n.unbindEvent_(this.moveSurfaceWrapper_),this.moveSurfaceWrapper_=null),this.line_=this.gauge_=null},n.FieldAngle.prototype.hide_=function(){n.DropDownDiv.hideIfOwner(this),n.WidgetDiv.hide()},n.FieldAngle.prototype.onMouseMove_=function(t){var e=this.gauge_.ownerSVGElement.getBoundingClientRect(),i=t.clientX-e.left-n.FieldAngle.HALF;t=t.clientY-e.top-n.FieldAngle.HALF,e=Math.atan(-t/i),isNaN(e)||(e=n.utils.math.toDegrees(e),0>i?e+=180:0<t&&(e+=360),e=this.clockwise_?this.offset_+360-e:360-(this.offset_-e),this.displayMouseOrKeyboardValue_(e))},n.FieldAngle.prototype.displayMouseOrKeyboardValue_=function(t){this.round_&&(t=Math.round(t/this.round_)*this.round_),(t=this.wrapValue_(t))!=this.value_&&this.setEditorValue_(t)},n.FieldAngle.prototype.updateGraph_=function(){if(this.gauge_){var t=Number(this.getText())+this.offset_,e=n.utils.math.toRadians(t%360);t=["M ",n.FieldAngle.HALF,",",n.FieldAngle.HALF];var i=n.FieldAngle.HALF,o=n.FieldAngle.HALF;if(!isNaN(e)){var r=Number(this.clockwise_),s=n.utils.math.toRadians(this.offset_),a=Math.cos(s)*n.FieldAngle.RADIUS,l=Math.sin(s)*-n.FieldAngle.RADIUS;r&&(e=2*s-e),i+=Math.cos(e)*n.FieldAngle.RADIUS,o-=Math.sin(e)*n.FieldAngle.RADIUS,e=Math.abs(Math.floor((e-s)/Math.PI)%2),r&&(e=1-e),t.push(" l ",a,",",l," A ",n.FieldAngle.RADIUS,",",n.FieldAngle.RADIUS," 0 ",e," ",r," ",i,",",o," z")}this.gauge_.setAttribute("d",t.join("")),this.line_.setAttribute("x2",i),this.line_.setAttribute("y2",o)}},n.FieldAngle.prototype.onHtmlInputKeyDown_=function(t){var e;if(n.FieldAngle.superClass_.onHtmlInputKeyDown_.call(this,t),t.keyCode===n.utils.KeyCodes.LEFT?e=this.sourceBlock_.RTL?1:-1:t.keyCode===n.utils.KeyCodes.RIGHT?e=this.sourceBlock_.RTL?-1:1:t.keyCode===n.utils.KeyCodes.DOWN?e=-1:t.keyCode===n.utils.KeyCodes.UP&&(e=1),e){var i=this.getValue();this.displayMouseOrKeyboardValue_(i+e*this.round_),t.preventDefault(),t.stopPropagation()}},n.FieldAngle.prototype.doClassValidation_=function(t){return t=Number(t),isNaN(t)||!isFinite(t)?null:this.wrapValue_(t)},n.FieldAngle.prototype.wrapValue_=function(t){return 0>(t%=360)&&(t+=360),t>this.wrap_&&(t-=360),t},n.Css.register(".blocklyAngleCircle {,stroke: #444;,stroke-width: 1;,fill: #ddd;,fill-opacity: .8;,},.blocklyAngleMarks {,stroke: #444;,stroke-width: 1;,},.blocklyAngleGauge {,fill: #f88;,fill-opacity: .8;,pointer-events: none;,},.blocklyAngleLine {,stroke: #f00;,stroke-width: 2;,stroke-linecap: round;,pointer-events: none;,}".split(",")),n.fieldRegistry.register("field_angle",n.FieldAngle),n.FieldCheckbox=function(t,e,i){this.checkChar_=null,n.FieldCheckbox.superClass_.constructor.call(this,t,e,i)},n.utils.object.inherits(n.FieldCheckbox,n.Field),n.FieldCheckbox.prototype.DEFAULT_VALUE=!1,n.FieldCheckbox.fromJson=function(t){return new n.FieldCheckbox(t.checked,void 0,t)},n.FieldCheckbox.CHECK_CHAR="âœ“",n.FieldCheckbox.prototype.SERIALIZABLE=!0,n.FieldCheckbox.prototype.CURSOR="default",n.FieldCheckbox.prototype.configure_=function(t){n.FieldCheckbox.superClass_.configure_.call(this,t),t.checkCharacter&&(this.checkChar_=t.checkCharacter)},n.FieldCheckbox.prototype.initView=function(){n.FieldCheckbox.superClass_.initView.call(this),n.utils.dom.addClass(this.textElement_,"blocklyCheckbox"),this.textElement_.style.display=this.value_?"block":"none"},n.FieldCheckbox.prototype.render_=function(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)},n.FieldCheckbox.prototype.getDisplayText_=function(){return this.checkChar_||n.FieldCheckbox.CHECK_CHAR},n.FieldCheckbox.prototype.setCheckCharacter=function(t){this.checkChar_=t,this.forceRerender()},n.FieldCheckbox.prototype.showEditor_=function(){this.setValue(!this.value_)},n.FieldCheckbox.prototype.doClassValidation_=function(t){return!0===t||"TRUE"===t?"TRUE":!1===t||"FALSE"===t?"FALSE":null},n.FieldCheckbox.prototype.doValueUpdate_=function(t){this.value_=this.convertValueToBool_(t),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")},n.FieldCheckbox.prototype.getValue=function(){return this.value_?"TRUE":"FALSE"},n.FieldCheckbox.prototype.getValueBoolean=function(){return this.value_},n.FieldCheckbox.prototype.getText=function(){return String(this.convertValueToBool_(this.value_))},n.FieldCheckbox.prototype.convertValueToBool_=function(t){return"string"==typeof t?"TRUE"==t:!!t},n.fieldRegistry.register("field_checkbox",n.FieldCheckbox),n.FieldColour=function(t,e,i){n.FieldColour.superClass_.constructor.call(this,t,e,i),this.onKeyDownWrapper_=this.onMouseLeaveWrapper_=this.onMouseEnterWrapper_=this.onMouseMoveWrapper_=this.onClickWrapper_=this.highlightedIndex_=this.picker_=null},n.utils.object.inherits(n.FieldColour,n.Field),n.FieldColour.fromJson=function(t){return new n.FieldColour(t.colour,void 0,t)},n.FieldColour.prototype.SERIALIZABLE=!0,n.FieldColour.prototype.CURSOR="default",n.FieldColour.prototype.isDirty_=!1,n.FieldColour.prototype.colours_=null,n.FieldColour.prototype.titles_=null,n.FieldColour.prototype.columns_=0,n.FieldColour.prototype.configure_=function(t){n.FieldColour.superClass_.configure_.call(this,t),t.colourOptions&&(this.colours_=t.colourOptions,this.titles_=t.colourTitles),t.columns&&(this.columns_=t.columns)},n.FieldColour.prototype.initView=function(){this.size_=new n.utils.Size(this.getConstants().FIELD_COLOUR_DEFAULT_WIDTH,this.getConstants().FIELD_COLOUR_DEFAULT_HEIGHT),this.getConstants().FIELD_COLOUR_FULL_BLOCK?this.clickTarget_=this.sourceBlock_.getSvgRoot():(this.createBorderRect_(),this.borderRect_.style.fillOpacity="1")},n.FieldColour.prototype.applyColour=function(){this.getConstants().FIELD_COLOUR_FULL_BLOCK?(this.sourceBlock_.pathObject.svgPath.setAttribute("fill",this.getValue()),this.sourceBlock_.pathObject.svgPath.setAttribute("stroke","#fff")):this.borderRect_&&(this.borderRect_.style.fill=this.getValue())},n.FieldColour.prototype.doClassValidation_=function(t){return"string"!=typeof t?null:n.utils.colour.parse(t)},n.FieldColour.prototype.doValueUpdate_=function(t){this.value_=t,this.borderRect_?this.borderRect_.style.fill=t:this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.pathObject.svgPath.setAttribute("fill",t),this.sourceBlock_.pathObject.svgPath.setAttribute("stroke","#fff"))},n.FieldColour.prototype.getText=function(){var t=this.value_;return/^#(.)\1(.)\2(.)\3$/.test(t)&&(t="#"+t[1]+t[3]+t[5]),t},n.FieldColour.COLOURS="#ffffff #cccccc #c0c0c0 #999999 #666666 #333333 #000000 #ffcccc #ff6666 #ff0000 #cc0000 #990000 #660000 #330000 #ffcc99 #ff9966 #ff9900 #ff6600 #cc6600 #993300 #663300 #ffff99 #ffff66 #ffcc66 #ffcc33 #cc9933 #996633 #663333 #ffffcc #ffff33 #ffff00 #ffcc00 #999900 #666600 #333300 #99ff99 #66ff99 #33ff33 #33cc00 #009900 #006600 #003300 #99ffff #33ffff #66cccc #00cccc #339999 #336666 #003333 #ccffff #66ffff #33ccff #3366ff #3333ff #000099 #000066 #ccccff #9999ff #6666cc #6633ff #6600cc #333399 #330099 #ffccff #ff99ff #cc66cc #cc33cc #993399 #663366 #330033".split(" "),n.FieldColour.prototype.DEFAULT_VALUE=n.FieldColour.COLOURS[0],n.FieldColour.TITLES=[],n.FieldColour.COLUMNS=7,n.FieldColour.prototype.setColours=function(t,e){return this.colours_=t,e&&(this.titles_=e),this},n.FieldColour.prototype.setColumns=function(t){return this.columns_=t,this},n.FieldColour.prototype.showEditor_=function(){this.picker_=this.dropdownCreate_(),n.DropDownDiv.getContentDiv().appendChild(this.picker_),n.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.picker_.focus({preventScroll:!0})},n.FieldColour.prototype.onClick_=function(t){null!==(t=(t=t.target)&&t.label)&&(this.setValue(t),n.DropDownDiv.hideIfOwner(this))},n.FieldColour.prototype.onKeyDown_=function(t){var e=!1;t.keyCode===n.utils.KeyCodes.UP?(this.moveHighlightBy_(0,-1),e=!0):t.keyCode===n.utils.KeyCodes.DOWN?(this.moveHighlightBy_(0,1),e=!0):t.keyCode===n.utils.KeyCodes.LEFT?(this.moveHighlightBy_(-1,0),e=!0):t.keyCode===n.utils.KeyCodes.RIGHT?(this.moveHighlightBy_(1,0),e=!0):t.keyCode===n.utils.KeyCodes.ENTER&&((e=this.getHighlighted_())&&null!==(e=e&&e.label)&&this.setValue(e),n.DropDownDiv.hideWithoutAnimation(),e=!0),e&&t.stopPropagation()},n.FieldColour.prototype.onBlocklyAction=function(t){if(this.picker_)switch(t.name){case n.navigation.actionNames.PREVIOUS:return this.moveHighlightBy_(0,-1),!0;case n.navigation.actionNames.NEXT:return this.moveHighlightBy_(0,1),!0;case n.navigation.actionNames.OUT:return this.moveHighlightBy_(-1,0),!0;case n.navigation.actionNames.IN:return this.moveHighlightBy_(1,0),!0;default:return!1}return n.FieldColour.superClass_.onBlocklyAction.call(this,t)},n.FieldColour.prototype.moveHighlightBy_=function(t,e){var i=this.colours_||n.FieldColour.COLOURS,o=this.columns_||n.FieldColour.COLUMNS,r=this.highlightedIndex_%o,s=Math.floor(this.highlightedIndex_/o);r+=t,s+=e,0>t?0>r&&0<s?(r=o-1,s--):0>r&&(r=0):0<t?r>o-1&&s<Math.floor(i.length/o)-1?(r=0,s++):r>o-1&&r--:0>e?0>s&&(s=0):0<e&&s>Math.floor(i.length/o)-1&&(s=Math.floor(i.length/o)-1),this.setHighlightedCell_(this.picker_.childNodes[s].childNodes[r],s*o+r)},n.FieldColour.prototype.onMouseMove_=function(t){var e=(t=t.target)&&Number(t.getAttribute("data-index"));null!==e&&e!==this.highlightedIndex_&&this.setHighlightedCell_(t,e)},n.FieldColour.prototype.onMouseEnter_=function(){this.picker_.focus({preventScroll:!0})},n.FieldColour.prototype.onMouseLeave_=function(){this.picker_.blur();var t=this.getHighlighted_();t&&n.utils.dom.removeClass(t,"blocklyColourHighlighted")},n.FieldColour.prototype.getHighlighted_=function(){var t=this.columns_||n.FieldColour.COLUMNS,e=this.picker_.childNodes[Math.floor(this.highlightedIndex_/t)];return e?e.childNodes[this.highlightedIndex_%t]:null},n.FieldColour.prototype.setHighlightedCell_=function(t,e){var i=this.getHighlighted_();i&&n.utils.dom.removeClass(i,"blocklyColourHighlighted"),n.utils.dom.addClass(t,"blocklyColourHighlighted"),this.highlightedIndex_=e,n.utils.aria.setState(this.picker_,n.utils.aria.State.ACTIVEDESCENDANT,t.getAttribute("id"))},n.FieldColour.prototype.dropdownCreate_=function(){var t=this.columns_||n.FieldColour.COLUMNS,e=this.colours_||n.FieldColour.COLOURS,i=this.titles_||n.FieldColour.TITLES,o=this.getValue(),r=document.createElement("table");r.className="blocklyColourTable",r.tabIndex=0,r.dir="ltr",n.utils.aria.setRole(r,n.utils.aria.Role.GRID),n.utils.aria.setState(r,n.utils.aria.State.EXPANDED,!0),n.utils.aria.setState(r,n.utils.aria.State.ROWCOUNT,Math.floor(e.length/t)),n.utils.aria.setState(r,n.utils.aria.State.COLCOUNT,t);for(var s,a=0;a<e.length;a++){0==a%t&&(s=document.createElement("tr"),n.utils.aria.setRole(s,n.utils.aria.Role.ROW),r.appendChild(s));var l=document.createElement("td");s.appendChild(l),l.label=e[a],l.title=i[a]||e[a],l.id=n.utils.IdGenerator.getNextUniqueId(),l.setAttribute("data-index",a),n.utils.aria.setRole(l,n.utils.aria.Role.GRIDCELL),n.utils.aria.setState(l,n.utils.aria.State.LABEL,e[a]),n.utils.aria.setState(l,n.utils.aria.State.SELECTED,e[a]==o),l.style.backgroundColor=e[a],e[a]==o&&(l.className="blocklyColourSelected",this.highlightedIndex_=a)}return this.onClickWrapper_=n.bindEventWithChecks_(r,"click",this,this.onClick_,!0),this.onMouseMoveWrapper_=n.bindEventWithChecks_(r,"mousemove",this,this.onMouseMove_,!0),this.onMouseEnterWrapper_=n.bindEventWithChecks_(r,"mouseenter",this,this.onMouseEnter_,!0),this.onMouseLeaveWrapper_=n.bindEventWithChecks_(r,"mouseleave",this,this.onMouseLeave_,!0),this.onKeyDownWrapper_=n.bindEventWithChecks_(r,"keydown",this,this.onKeyDown_),r},n.FieldColour.prototype.dropdownDispose_=function(){this.onClickWrapper_&&(n.unbindEvent_(this.onClickWrapper_),this.onClickWrapper_=null),this.onMouseMoveWrapper_&&(n.unbindEvent_(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null),this.onMouseEnterWrapper_&&(n.unbindEvent_(this.onMouseEnterWrapper_),this.onMouseEnterWrapper_=null),this.onMouseLeaveWrapper_&&(n.unbindEvent_(this.onMouseLeaveWrapper_),this.onMouseLeaveWrapper_=null),this.onKeyDownWrapper_&&(n.unbindEvent_(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.highlightedIndex_=this.picker_=null},n.Css.register([".blocklyColourTable {","border-collapse: collapse;","display: block;","outline: none;","padding: 1px;","}",".blocklyColourTable>tr>td {","border: .5px solid #888;","box-sizing: border-box;","cursor: pointer;","display: inline-block;","height: 20px;","padding: 0;","width: 20px;","}",".blocklyColourTable>tr>td.blocklyColourHighlighted {","border-color: #eee;","box-shadow: 2px 2px 7px 2px rgba(0,0,0,.3);","position: relative;","}",".blocklyColourSelected, .blocklyColourSelected:hover {","border-color: #eee !important;","outline: 1px solid #333;","position: relative;","}"]),n.fieldRegistry.register("field_colour",n.FieldColour),n.FieldDropdown=function(t,e,i){"function"!=typeof t&&n.FieldDropdown.validateOptions_(t),this.menuGenerator_=t,this.suffixField=this.prefixField=this.generatedOptions_=null,this.trimOptions_(),this.selectedOption_=this.getOptions(!1)[0],n.FieldDropdown.superClass_.constructor.call(this,this.selectedOption_[1],e,i),this.svgArrow_=this.arrow_=this.imageElement_=this.menu_=this.selectedMenuItem_=null},n.utils.object.inherits(n.FieldDropdown,n.Field),n.FieldDropdown.fromJson=function(t){return new n.FieldDropdown(t.options,void 0,t)},n.FieldDropdown.prototype.SERIALIZABLE=!0,n.FieldDropdown.CHECKMARK_OVERHANG=25,n.FieldDropdown.MAX_MENU_HEIGHT_VH=.45,n.FieldDropdown.IMAGE_Y_OFFSET=5,n.FieldDropdown.IMAGE_Y_PADDING=2*n.FieldDropdown.IMAGE_Y_OFFSET,n.FieldDropdown.ARROW_CHAR=n.utils.userAgent.ANDROID?"â–¼":"â–¾",n.FieldDropdown.prototype.CURSOR="default",n.FieldDropdown.prototype.initView=function(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement_=n.utils.dom.createSvgElement(n.utils.Svg.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&n.utils.dom.addClass(this.borderRect_,"blocklyDropdownRect")},n.FieldDropdown.prototype.shouldAddBorderRect_=function(){return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!this.sourceBlock_.isShadow()},n.FieldDropdown.prototype.createTextArrow_=function(){this.arrow_=n.utils.dom.createSvgElement(n.utils.Svg.TSPAN,{},this.textElement_),this.arrow_.appendChild(document.createTextNode(this.sourceBlock_.RTL?n.FieldDropdown.ARROW_CHAR+" ":" "+n.FieldDropdown.ARROW_CHAR)),this.sourceBlock_.RTL?this.textElement_.insertBefore(this.arrow_,this.textContent_):this.textElement_.appendChild(this.arrow_)},n.FieldDropdown.prototype.createSVGArrow_=function(){this.svgArrow_=n.utils.dom.createSvgElement(n.utils.Svg.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow_.setAttributeNS(n.utils.dom.XLINK_NS,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)},n.FieldDropdown.prototype.showEditor_=function(t){if(this.menu_=this.dropdownCreate_(),this.menu_.openingCoords=t&&"number"==typeof t.clientX?new n.utils.Coordinate(t.clientX,t.clientY):null,this.menu_.render(n.DropDownDiv.getContentDiv()),t=this.menu_.getElement(),n.utils.dom.addClass(t,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV){t=this.sourceBlock_.isShadow()?this.sourceBlock_.getParent().getColour():this.sourceBlock_.getColour();var e=this.sourceBlock_.isShadow()?this.sourceBlock_.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary;n.DropDownDiv.setColour(t,e)}n.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.menu_.focus(),this.selectedMenuItem_&&this.menu_.setHighlighted(this.selectedMenuItem_),this.applyColour()},n.FieldDropdown.prototype.dropdownCreate_=function(){var t=new n.Menu;t.setRole(n.utils.aria.Role.LISTBOX);var e=this.getOptions(!1);this.selectedMenuItem_=null;for(var i=0;i<e.length;i++){var o=e[i][0],r=e[i][1];if("object"==typeof o){var s=new Image(o.width,o.height);s.src=o.src,s.alt=o.alt||"",o=s}(o=new n.MenuItem(o,r)).setRole(n.utils.aria.Role.OPTION),o.setRightToLeft(this.sourceBlock_.RTL),o.setCheckable(!0),t.addChild(o),o.setChecked(r==this.value_),r==this.value_&&(this.selectedMenuItem_=o),o.onAction(this.handleMenuActionEvent_,this)}return t},n.FieldDropdown.prototype.dropdownDispose_=function(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem_=this.menu_=null,this.applyColour()},n.FieldDropdown.prototype.handleMenuActionEvent_=function(t){n.DropDownDiv.hideIfOwner(this,!0),this.onItemSelected_(this.menu_,t)},n.FieldDropdown.prototype.onItemSelected_=function(t,e){this.setValue(e.getValue())},n.FieldDropdown.prototype.trimOptions_=function(){var t=this.menuGenerator_;if(Array.isArray(t)){for(var e=!1,i=0;i<t.length;i++){var o=t[i][0];"string"==typeof o?t[i][0]=n.utils.replaceMessageReferences(o):(null!=o.alt&&(t[i][0].alt=n.utils.replaceMessageReferences(o.alt)),e=!0)}if(!(e||2>t.length)){for(e=[],i=0;i<t.length;i++)e.push(t[i][0]);i=n.utils.string.shortestStringLength(e),o=n.utils.string.commonWordPrefix(e,i);var r=n.utils.string.commonWordSuffix(e,i);!o&&!r||i<=o+r||(o&&(this.prefixField=e[0].substring(0,o-1)),r&&(this.suffixField=e[0].substr(1-r)),this.menuGenerator_=n.FieldDropdown.applyTrim_(t,o,r))}}},n.FieldDropdown.applyTrim_=function(t,e,n){for(var i=[],o=0;o<t.length;o++){var r=t[o][0],s=t[o][1];r=r.substring(e,r.length-n),i[o]=[r,s]}return i},n.FieldDropdown.prototype.isOptionListDynamic=function(){return"function"==typeof this.menuGenerator_},n.FieldDropdown.prototype.getOptions=function(t){return this.isOptionListDynamic()?(this.generatedOptions_&&t||(this.generatedOptions_=this.menuGenerator_.call(this),n.FieldDropdown.validateOptions_(this.generatedOptions_)),this.generatedOptions_):this.menuGenerator_},n.FieldDropdown.prototype.doClassValidation_=function(t){for(var e,n=!1,i=this.getOptions(!0),o=0;e=i[o];o++)if(e[1]==t){n=!0;break}return n?t:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+t),null)},n.FieldDropdown.prototype.doValueUpdate_=function(t){n.FieldDropdown.superClass_.doValueUpdate_.call(this,t),t=this.getOptions(!0);for(var e,i=0;e=t[i];i++)e[1]==this.value_&&(this.selectedOption_=e)},n.FieldDropdown.prototype.applyColour=function(){this.borderRect_&&(this.borderRect_.setAttribute("stroke",this.sourceBlock_.style.colourTertiary),this.menu_?this.borderRect_.setAttribute("fill",this.sourceBlock_.style.colourTertiary):this.borderRect_.setAttribute("fill","transparent")),this.sourceBlock_&&this.arrow_&&(this.sourceBlock_.isShadow()?this.arrow_.style.fill=this.sourceBlock_.style.colourSecondary:this.arrow_.style.fill=this.sourceBlock_.style.colourPrimary)},n.FieldDropdown.prototype.render_=function(){this.textContent_.nodeValue="",this.imageElement_.style.display="none";var t=this.selectedOption_&&this.selectedOption_[0];t&&"object"==typeof t?this.renderSelectedImage_(t):this.renderSelectedText_(),this.positionBorderRect_()},n.FieldDropdown.prototype.renderSelectedImage_=function(t){this.imageElement_.style.display="",this.imageElement_.setAttributeNS(n.utils.dom.XLINK_NS,"xlink:href",t.src),this.imageElement_.setAttribute("height",t.height),this.imageElement_.setAttribute("width",t.width);var e=Number(t.height);t=Number(t.width);var i=!!this.borderRect_,o=Math.max(i?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,e+n.FieldDropdown.IMAGE_Y_PADDING);i=i?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;var r=this.svgArrow_?this.positionSVGArrow_(t+i,o/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):n.utils.dom.getFastTextWidth(this.arrow_,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);this.size_.width=t+r+2*i,this.size_.height=o;var s=0;this.sourceBlock_.RTL?this.imageElement_.setAttribute("x",i+r):(s=t+r,this.textElement_.setAttribute("text-anchor","end"),this.imageElement_.setAttribute("x",i)),this.imageElement_.setAttribute("y",o/2-e/2),this.positionTextElement_(s+i,t+r)},n.FieldDropdown.prototype.renderSelectedText_=function(){this.textContent_.nodeValue=this.getDisplayText_(),n.utils.dom.addClass(this.textElement_,"blocklyDropdownText"),this.textElement_.setAttribute("text-anchor","start");var t=!!this.borderRect_,e=Math.max(t?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT),i=n.utils.dom.getFastTextWidth(this.textElement_,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);t=t?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;var o=0;this.svgArrow_&&(o=this.positionSVGArrow_(i+t,e/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_.width=i+o+2*t,this.size_.height=e,this.positionTextElement_(t,i)},n.FieldDropdown.prototype.positionSVGArrow_=function(t,e){if(!this.svgArrow_)return 0;var n=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,i=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,o=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;return this.svgArrow_.setAttribute("transform","translate("+(this.sourceBlock_.RTL?n:t+i)+","+e+")"),o+i},n.FieldDropdown.prototype.getText_=function(){if(!this.selectedOption_)return null;var t=this.selectedOption_[0];return"object"==typeof t?t.alt:t},n.FieldDropdown.validateOptions_=function(t){if(!Array.isArray(t))throw TypeError("FieldDropdown options must be an array.");if(!t.length)throw TypeError("FieldDropdown options must not be an empty array.");for(var e=!1,n=0;n<t.length;++n){var i=t[n];Array.isArray(i)?"string"!=typeof i[1]?(e=!0,console.error("Invalid option["+n+"]: Each FieldDropdown option id must be a string. Found "+i[1]+" in: ",i)):i[0]&&"string"!=typeof i[0]&&"string"!=typeof i[0].src&&(e=!0,console.error("Invalid option["+n+"]: Each FieldDropdown option must have a string label or image description. Found"+i[0]+" in: ",i)):(e=!0,console.error("Invalid option["+n+"]: Each FieldDropdown option must be an array. Found: ",i))}if(e)throw TypeError("Found invalid FieldDropdown options.")},n.FieldDropdown.prototype.onBlocklyAction=function(t){if(this.menu_)switch(t.name){case n.navigation.actionNames.PREVIOUS:return this.menu_.highlightPrevious(),!0;case n.navigation.actionNames.NEXT:return this.menu_.highlightNext(),!0;default:return!1}return n.FieldDropdown.superClass_.onBlocklyAction.call(this,t)},n.fieldRegistry.register("field_dropdown",n.FieldDropdown),n.FieldLabelSerializable=function(t,e,i){n.FieldLabelSerializable.superClass_.constructor.call(this,t,e,i)},n.utils.object.inherits(n.FieldLabelSerializable,n.FieldLabel),n.FieldLabelSerializable.fromJson=function(t){var e=n.utils.replaceMessageReferences(t.text);return new n.FieldLabelSerializable(e,void 0,t)},n.FieldLabelSerializable.prototype.EDITABLE=!1,n.FieldLabelSerializable.prototype.SERIALIZABLE=!0,n.fieldRegistry.register("field_label_serializable",n.FieldLabelSerializable),n.FieldImage=function(t,e,i,o,r,s,a){if(!t)throw Error("Src value of an image field is required");if(t=n.utils.replaceMessageReferences(t),i=Number(n.utils.replaceMessageReferences(i)),e=Number(n.utils.replaceMessageReferences(e)),isNaN(i)||isNaN(e))throw Error("Height and width values of an image field must cast to numbers.");if(0>=i||0>=e)throw Error("Height and width values of an image field must be greater than 0.");this.flipRtl_=!1,this.altText_="",n.FieldImage.superClass_.constructor.call(this,t,null,a),a||(this.flipRtl_=!!s,this.altText_=n.utils.replaceMessageReferences(o)||""),this.size_=new n.utils.Size(e,i+n.FieldImage.Y_PADDING),this.imageHeight_=i,this.clickHandler_=null,"function"==typeof r&&(this.clickHandler_=r),this.imageElement_=null},n.utils.object.inherits(n.FieldImage,n.Field),n.FieldImage.prototype.DEFAULT_VALUE="",n.FieldImage.fromJson=function(t){return new n.FieldImage(t.src,t.width,t.height,void 0,void 0,void 0,t)},n.FieldImage.Y_PADDING=1,n.FieldImage.prototype.EDITABLE=!1,n.FieldImage.prototype.isDirty_=!1,n.FieldImage.prototype.configure_=function(t){n.FieldImage.superClass_.configure_.call(this,t),this.flipRtl_=!!t.flipRtl,this.altText_=n.utils.replaceMessageReferences(t.alt)||""},n.FieldImage.prototype.initView=function(){this.imageElement_=n.utils.dom.createSvgElement(n.utils.Svg.IMAGE,{height:this.imageHeight_+"px",width:this.size_.width+"px",alt:this.altText_},this.fieldGroup_),this.imageElement_.setAttributeNS(n.utils.dom.XLINK_NS,"xlink:href",this.value_),this.clickHandler_&&(this.imageElement_.style.cursor="pointer")},n.FieldImage.prototype.updateSize_=function(){},n.FieldImage.prototype.doClassValidation_=function(t){return"string"!=typeof t?null:t},n.FieldImage.prototype.doValueUpdate_=function(t){this.value_=t,this.imageElement_&&this.imageElement_.setAttributeNS(n.utils.dom.XLINK_NS,"xlink:href",String(this.value_))},n.FieldImage.prototype.getFlipRtl=function(){return this.flipRtl_},n.FieldImage.prototype.setAlt=function(t){t!=this.altText_&&(this.altText_=t||"",this.imageElement_&&this.imageElement_.setAttribute("alt",this.altText_))},n.FieldImage.prototype.showEditor_=function(){this.clickHandler_&&this.clickHandler_(this)},n.FieldImage.prototype.setOnClickHandler=function(t){this.clickHandler_=t},n.FieldImage.prototype.getText_=function(){return this.altText_},n.fieldRegistry.register("field_image",n.FieldImage),n.FieldMultilineInput=function(t,e,i){n.FieldMultilineInput.superClass_.constructor.call(this,t,e,i),this.textGroup_=null},n.utils.object.inherits(n.FieldMultilineInput,n.FieldTextInput),n.FieldMultilineInput.fromJson=function(t){var e=n.utils.replaceMessageReferences(t.text);return new n.FieldMultilineInput(e,void 0,t)},n.FieldMultilineInput.prototype.toXml=function(t){return t.textContent=this.getValue().replace(/\n/g,"&#10;"),t},n.FieldMultilineInput.prototype.fromXml=function(t){this.setValue(t.textContent.replace(/&#10;/g,"\n"))},n.FieldMultilineInput.prototype.initView=function(){this.createBorderRect_(),this.textGroup_=n.utils.dom.createSvgElement(n.utils.Svg.G,{class:"blocklyEditableText"},this.fieldGroup_)},n.FieldMultilineInput.prototype.getDisplayText_=function(){var t=this.getText();if(!t)return n.Field.NBSP;var e=t.split("\n");t="";for(var i=0;i<e.length;i++){var o=e[i];o.length>this.maxDisplayLength&&(o=o.substring(0,this.maxDisplayLength-4)+"..."),t+=o=o.replace(/\s/g,n.Field.NBSP),i!==e.length-1&&(t+="\n")}return this.sourceBlock_.RTL&&(t+="â€"),t},n.FieldMultilineInput.prototype.render_=function(){for(var t;t=this.textGroup_.firstChild;)this.textGroup_.removeChild(t);t=this.getDisplayText_().split("\n");for(var e=0,i=0;i<t.length;i++){var o=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING;n.utils.dom.createSvgElement(n.utils.Svg.TEXT,{class:"blocklyText blocklyMultilineText",x:this.getConstants().FIELD_BORDER_RECT_X_PADDING,y:e+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,dy:this.getConstants().FIELD_TEXT_BASELINE},this.textGroup_).appendChild(document.createTextNode(t[i])),e+=o}this.updateSize_(),this.isBeingEdited_&&(this.sourceBlock_.RTL?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),t=this.htmlInput_,this.isTextValid_?(n.utils.dom.removeClass(t,"blocklyInvalidInput"),n.utils.aria.setState(t,n.utils.aria.State.INVALID,!1)):(n.utils.dom.addClass(t,"blocklyInvalidInput"),n.utils.aria.setState(t,n.utils.aria.State.INVALID,!0)))},n.FieldMultilineInput.prototype.updateSize_=function(){for(var t=this.textGroup_.childNodes,e=0,i=0,o=0;o<t.length;o++){var r=n.utils.dom.getTextWidth(t[o]);r>e&&(e=r),i+=this.getConstants().FIELD_TEXT_HEIGHT+(0<o?this.getConstants().FIELD_BORDER_RECT_Y_PADDING:0)}this.borderRect_&&(i+=2*this.getConstants().FIELD_BORDER_RECT_Y_PADDING,e+=2*this.getConstants().FIELD_BORDER_RECT_X_PADDING,this.borderRect_.setAttribute("width",e),this.borderRect_.setAttribute("height",i)),this.size_.width=e,this.size_.height=i,this.positionBorderRect_()},n.FieldMultilineInput.prototype.widgetCreate_=function(){var t=n.WidgetDiv.DIV,e=this.workspace_.getScale(),i=document.createElement("textarea");i.className="blocklyHtmlInput blocklyHtmlTextAreaInput",i.setAttribute("spellcheck",this.spellcheck_);var o=this.getConstants().FIELD_TEXT_FONTSIZE*e+"pt";t.style.fontSize=o,i.style.fontSize=o,i.style.borderRadius=n.FieldTextInput.BORDERRADIUS*e+"px",o=this.getConstants().FIELD_BORDER_RECT_X_PADDING*e;var r=this.getConstants().FIELD_BORDER_RECT_Y_PADDING*e/2;return i.style.padding=r+"px "+o+"px "+r+"px "+o+"px",o=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,i.style.lineHeight=o*e+"px",t.appendChild(i),i.value=i.defaultValue=this.getEditorText_(this.value_),i.untypedDefaultValue_=this.value_,i.oldValue_=null,n.utils.userAgent.GECKO?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),this.bindInputEvents_(i),i},n.FieldMultilineInput.prototype.onHtmlInputKeyDown_=function(t){t.keyCode!==n.utils.KeyCodes.ENTER&&n.FieldMultilineInput.superClass_.onHtmlInputKeyDown_.call(this,t)},n.Css.register(".blocklyHtmlTextAreaInput {,font-family: monospace;,resize: none;,overflow: hidden;,height: 100%;,text-align: left;,}".split(",")),n.fieldRegistry.register("field_multilinetext",n.FieldMultilineInput),n.FieldNumber=function(t,e,i,o,r,s){this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces_=null,n.FieldNumber.superClass_.constructor.call(this,t,r,s),s||this.setConstraints(e,i,o)},n.utils.object.inherits(n.FieldNumber,n.FieldTextInput),n.FieldNumber.prototype.DEFAULT_VALUE=0,n.FieldNumber.fromJson=function(t){return new n.FieldNumber(t.value,void 0,void 0,void 0,void 0,t)},n.FieldNumber.prototype.SERIALIZABLE=!0,n.FieldNumber.prototype.configure_=function(t){n.FieldNumber.superClass_.configure_.call(this,t),this.setMinInternal_(t.min),this.setMaxInternal_(t.max),this.setPrecisionInternal_(t.precision)},n.FieldNumber.prototype.setConstraints=function(t,e,n){this.setMinInternal_(t),this.setMaxInternal_(e),this.setPrecisionInternal_(n),this.setValue(this.getValue())},n.FieldNumber.prototype.setMin=function(t){this.setMinInternal_(t),this.setValue(this.getValue())},n.FieldNumber.prototype.setMinInternal_=function(t){null==t?this.min_=-1/0:(t=Number(t),isNaN(t)||(this.min_=t))},n.FieldNumber.prototype.getMin=function(){return this.min_},n.FieldNumber.prototype.setMax=function(t){this.setMaxInternal_(t),this.setValue(this.getValue())},n.FieldNumber.prototype.setMaxInternal_=function(t){null==t?this.max_=1/0:(t=Number(t),isNaN(t)||(this.max_=t))},n.FieldNumber.prototype.getMax=function(){return this.max_},n.FieldNumber.prototype.setPrecision=function(t){this.setPrecisionInternal_(t),this.setValue(this.getValue())},n.FieldNumber.prototype.setPrecisionInternal_=function(t){null==t?this.precision_=0:(t=Number(t),isNaN(t)||(this.precision_=t));var e=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}),n=e.indexOf(".");this.decimalPlaces_=-1==n?t?0:null:e.length-n-1},n.FieldNumber.prototype.getPrecision=function(){return this.precision_},n.FieldNumber.prototype.doClassValidation_=function(t){return null===t?null:(t=(t=(t=(t=String(t)).replace(/O/gi,"0")).replace(/,/g,"")).replace(/infinity/i,"Infinity"),t=Number(t||0),isNaN(t)?null:(t=Math.min(Math.max(t,this.min_),this.max_),this.precision_&&isFinite(t)&&(t=Math.round(t/this.precision_)*this.precision_),null!=this.decimalPlaces_&&(t=Number(t.toFixed(this.decimalPlaces_))),t))},n.FieldNumber.prototype.widgetCreate_=function(){var t=n.FieldNumber.superClass_.widgetCreate_.call(this);return-1/0<this.min_&&n.utils.aria.setState(t,n.utils.aria.State.VALUEMIN,this.min_),1/0>this.max_&&n.utils.aria.setState(t,n.utils.aria.State.VALUEMAX,this.max_),t},n.fieldRegistry.register("field_number",n.FieldNumber),n.FieldVariable=function(t,e,i,o,r){this.menuGenerator_=n.FieldVariable.dropdownCreate,this.defaultVariableName="string"==typeof t?t:"",this.size_=new n.utils.Size(0,0),r&&this.configure_(r),e&&this.setValidator(e),r||this.setTypes_(i,o)},n.utils.object.inherits(n.FieldVariable,n.FieldDropdown),n.FieldVariable.fromJson=function(t){var e=n.utils.replaceMessageReferences(t.variable);return new n.FieldVariable(e,void 0,void 0,void 0,t)},n.FieldVariable.prototype.SERIALIZABLE=!0,n.FieldVariable.prototype.configure_=function(t){n.FieldVariable.superClass_.configure_.call(this,t),this.setTypes_(t.variableTypes,t.defaultType)},n.FieldVariable.prototype.initModel=function(){if(!this.variable_){var t=n.Variables.getOrCreateVariablePackage(this.sourceBlock_.workspace,null,this.defaultVariableName,this.defaultType_);this.doValueUpdate_(t.getId())}},n.FieldVariable.prototype.shouldAddBorderRect_=function(){return n.FieldVariable.superClass_.shouldAddBorderRect_.call(this)&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||"variables_get"!=this.sourceBlock_.type)},n.FieldVariable.prototype.fromXml=function(t){var e=t.getAttribute("id"),i=t.textContent,o=t.getAttribute("variabletype")||t.getAttribute("variableType")||"";if(e=n.Variables.getOrCreateVariablePackage(this.sourceBlock_.workspace,e,i,o),null!=o&&o!==e.type)throw Error("Serialized variable type with id '"+e.getId()+"' had type "+e.type+", and does not match variable field that references it: "+n.Xml.domToText(t)+".");this.setValue(e.getId())},n.FieldVariable.prototype.toXml=function(t){return this.initModel(),t.id=this.variable_.getId(),t.textContent=this.variable_.name,this.variable_.type&&t.setAttribute("variabletype",this.variable_.type),t},n.FieldVariable.prototype.setSourceBlock=function(t){if(t.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");n.FieldVariable.superClass_.setSourceBlock.call(this,t)},n.FieldVariable.prototype.getValue=function(){return this.variable_?this.variable_.getId():null},n.FieldVariable.prototype.getText=function(){return this.variable_?this.variable_.name:""},n.FieldVariable.prototype.getVariable=function(){return this.variable_},n.FieldVariable.prototype.getValidator=function(){return this.variable_?this.validator_:null},n.FieldVariable.prototype.doClassValidation_=function(t){if(null===t)return null;var e=n.Variables.getVariable(this.sourceBlock_.workspace,t);return e?(e=e.type,this.typeIsAllowed_(e)?t:(console.warn("Variable type doesn't match this field!  Type was "+e),null)):(console.warn("Variable id doesn't point to a real variable! ID was "+t),null)},n.FieldVariable.prototype.doValueUpdate_=function(t){this.variable_=n.Variables.getVariable(this.sourceBlock_.workspace,t),n.FieldVariable.superClass_.doValueUpdate_.call(this,t)},n.FieldVariable.prototype.typeIsAllowed_=function(t){var e=this.getVariableTypes_();if(!e)return!0;for(var n=0;n<e.length;n++)if(t==e[n])return!0;return!1},n.FieldVariable.prototype.getVariableTypes_=function(){var t=this.variableTypes;if(null===t&&this.sourceBlock_&&this.sourceBlock_.workspace)return this.sourceBlock_.workspace.getVariableTypes();if(0==(t=t||[""]).length)throw t=this.getText(),Error("'variableTypes' of field variable "+t+" was an empty list");return t},n.FieldVariable.prototype.setTypes_=function(t,e){if(e=e||"",null==t||null==t)t=null;else{if(!Array.isArray(t))throw Error("'variableTypes' was not an array in the definition of a FieldVariable");for(var n=!1,i=0;i<t.length;i++)t[i]==e&&(n=!0);if(!n)throw Error("Invalid default type '"+e+"' in the definition of a FieldVariable")}this.defaultType_=e,this.variableTypes=t},n.FieldVariable.prototype.refreshVariableName=function(){this.forceRerender()},n.FieldVariable.dropdownCreate=function(){if(!this.variable_)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");var t=this.getText(),e=[];if(this.sourceBlock_&&this.sourceBlock_.workspace)for(var i=this.getVariableTypes_(),o=0;o<i.length;o++){var r=this.sourceBlock_.workspace.getVariablesOfType(i[o]);e=e.concat(r)}for(e.sort(n.VariableModel.compareByName),i=[],o=0;o<e.length;o++)i[o]=[e[o].name,e[o].getId()];return i.push([n.Msg.RENAME_VARIABLE,n.RENAME_VARIABLE_ID]),n.Msg.DELETE_VARIABLE&&i.push([n.Msg.DELETE_VARIABLE.replace("%1",t),n.DELETE_VARIABLE_ID]),i},n.FieldVariable.prototype.onItemSelected_=function(t,e){if(t=e.getValue(),this.sourceBlock_&&this.sourceBlock_.workspace){if(t==n.RENAME_VARIABLE_ID)return void n.Variables.renameVariable(this.sourceBlock_.workspace,this.variable_);if(t==n.DELETE_VARIABLE_ID)return void this.sourceBlock_.workspace.deleteVariableById(this.variable_.getId())}this.setValue(t)},n.FieldVariable.prototype.referencesVariables=function(){return!0},n.fieldRegistry.register("field_variable",n.FieldVariable),n.utils.svgPaths={},n.utils.svgPaths.point=function(t,e){return" "+t+","+e+" "},n.utils.svgPaths.curve=function(t,e){return" "+t+e.join("")},n.utils.svgPaths.moveTo=function(t,e){return" M "+t+","+e+" "},n.utils.svgPaths.moveBy=function(t,e){return" m "+t+","+e+" "},n.utils.svgPaths.lineTo=function(t,e){return" l "+t+","+e+" "},n.utils.svgPaths.line=function(t){return" l"+t.join("")},n.utils.svgPaths.lineOnAxis=function(t,e){return" "+t+" "+e+" "},n.utils.svgPaths.arc=function(t,e,n,i){return t+" "+n+" "+n+" "+e+i},n.blockRendering.ConstantProvider=function(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.CORNER_RADIUS=8,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.ADD_START_HATS=!1,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=n.utils.svgPaths.moveBy(0,0),this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_TEXT_BASELINE_CENTER=!n.utils.userAgent.IE&&!n.utils.userAgent.EDGE,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!1,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!1,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2),this.embossFilterId="",this.embossFilter_=null,this.disabledPatternId="",this.disabledPattern_=null,this.debugFilterId="",this.cssNode_=this.debugFilter_=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=!1,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2}},n.blockRendering.ConstantProvider.prototype.init=function(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()},n.blockRendering.ConstantProvider.prototype.setTheme=function(t){this.blockStyles={};var e,n=t.blockStyles;for(e in n)this.blockStyles[e]=this.validatedBlockStyle_(n[e]);this.setDynamicProperties_(t)},n.blockRendering.ConstantProvider.prototype.setDynamicProperties_=function(t){this.setFontConstants_(t),this.setComponentConstants_(t),this.ADD_START_HATS=null!=t.startHats?t.startHats:this.ADD_START_HATS},n.blockRendering.ConstantProvider.prototype.setFontConstants_=function(t){this.FIELD_TEXT_FONTFAMILY=t.fontStyle&&null!=t.fontStyle.family?t.fontStyle.family:this.FIELD_TEXT_FONTFAMILY,this.FIELD_TEXT_FONTWEIGHT=t.fontStyle&&null!=t.fontStyle.weight?t.fontStyle.weight:this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTSIZE=t.fontStyle&&null!=t.fontStyle.size?t.fontStyle.size:this.FIELD_TEXT_FONTSIZE,t=n.utils.dom.measureFontMetrics("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=t.height,this.FIELD_TEXT_BASELINE=t.baseline},n.blockRendering.ConstantProvider.prototype.setComponentConstants_=function(t){this.CURSOR_COLOUR=t.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=t.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=t.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(t.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY},n.blockRendering.ConstantProvider.prototype.getBlockStyleForColour=function(t){var e="auto_"+t;return this.blockStyles[e]||(this.blockStyles[e]=this.createBlockStyle_(t)),{style:this.blockStyles[e],name:e}},n.blockRendering.ConstantProvider.prototype.getBlockStyle=function(t){return this.blockStyles[t||""]||(t&&0==t.indexOf("auto_")?this.getBlockStyleForColour(t.substring(5)).style:this.createBlockStyle_("#000000"))},n.blockRendering.ConstantProvider.prototype.createBlockStyle_=function(t){return this.validatedBlockStyle_({colourPrimary:t})},n.blockRendering.ConstantProvider.prototype.validatedBlockStyle_=function(t){var e={};return t&&n.utils.object.mixin(e,t),t=n.utils.parseBlockColour(e.colourPrimary||"#000"),e.colourPrimary=t.hex,e.colourSecondary=e.colourSecondary?n.utils.parseBlockColour(e.colourSecondary).hex:this.generateSecondaryColour_(e.colourPrimary),e.colourTertiary=e.colourTertiary?n.utils.parseBlockColour(e.colourTertiary).hex:this.generateTertiaryColour_(e.colourPrimary),e.hat=e.hat||"",e},n.blockRendering.ConstantProvider.prototype.generateSecondaryColour_=function(t){return n.utils.colour.blend("#fff",t,.6)||t},n.blockRendering.ConstantProvider.prototype.generateTertiaryColour_=function(t){return n.utils.colour.blend("#fff",t,.3)||t},n.blockRendering.ConstantProvider.prototype.dispose=function(){this.embossFilter_&&n.utils.dom.removeNode(this.embossFilter_),this.disabledPattern_&&n.utils.dom.removeNode(this.disabledPattern_),this.debugFilter_&&n.utils.dom.removeNode(this.debugFilter_),this.cssNode_=null},n.blockRendering.ConstantProvider.prototype.makeJaggedTeeth=function(){var t=this.JAGGED_TEETH_HEIGHT,e=this.JAGGED_TEETH_WIDTH;return{height:t,width:e,path:n.utils.svgPaths.line([n.utils.svgPaths.point(e,t/4),n.utils.svgPaths.point(2*-e,t/2),n.utils.svgPaths.point(e,t/4)])}},n.blockRendering.ConstantProvider.prototype.makeStartHat=function(){var t=this.START_HAT_HEIGHT,e=this.START_HAT_WIDTH;return{height:t,width:e,path:n.utils.svgPaths.curve("c",[n.utils.svgPaths.point(30,-t),n.utils.svgPaths.point(70,-t),n.utils.svgPaths.point(e,0)])}},n.blockRendering.ConstantProvider.prototype.makePuzzleTab=function(){function t(t){var o=-(t=t?-1:1),r=i/2,s=r+2.5,a=r+.5,l=n.utils.svgPaths.point(-e,t*r);return r=n.utils.svgPaths.point(e,t*r),n.utils.svgPaths.curve("c",[n.utils.svgPaths.point(0,t*s),n.utils.svgPaths.point(-e,o*a),l])+n.utils.svgPaths.curve("s",[n.utils.svgPaths.point(e,2.5*o),r])}var e=this.TAB_WIDTH,i=this.TAB_HEIGHT,o=t(!0),r=t(!1);return{type:this.SHAPES.PUZZLE,width:e,height:i,pathDown:r,pathUp:o}},n.blockRendering.ConstantProvider.prototype.makeNotch=function(){function t(t){return n.utils.svgPaths.line([n.utils.svgPaths.point(t*o,i),n.utils.svgPaths.point(3*t,0),n.utils.svgPaths.point(t*o,-i)])}var e=this.NOTCH_WIDTH,i=this.NOTCH_HEIGHT,o=(e-3)/2,r=t(1),s=t(-1);return{type:this.SHAPES.NOTCH,width:e,height:i,pathLeft:r,pathRight:s}},n.blockRendering.ConstantProvider.prototype.makeInsideCorners=function(){var t=this.CORNER_RADIUS;return{width:t,height:t,pathTop:n.utils.svgPaths.arc("a","0 0,0",t,n.utils.svgPaths.point(-t,t)),pathBottom:n.utils.svgPaths.arc("a","0 0,0",t,n.utils.svgPaths.point(t,t))}},n.blockRendering.ConstantProvider.prototype.makeOutsideCorners=function(){var t=this.CORNER_RADIUS,e=n.utils.svgPaths.moveBy(0,t)+n.utils.svgPaths.arc("a","0 0,1",t,n.utils.svgPaths.point(t,-t)),i=n.utils.svgPaths.arc("a","0 0,1",t,n.utils.svgPaths.point(t,t)),o=n.utils.svgPaths.arc("a","0 0,1",t,n.utils.svgPaths.point(-t,-t));return{topLeft:e,topRight:i,bottomRight:n.utils.svgPaths.arc("a","0 0,1",t,n.utils.svgPaths.point(-t,t)),bottomLeft:o,rightHeight:t}},n.blockRendering.ConstantProvider.prototype.shapeFor=function(t){switch(t.type){case n.INPUT_VALUE:case n.OUTPUT_VALUE:return this.PUZZLE_TAB;case n.PREVIOUS_STATEMENT:case n.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}},n.blockRendering.ConstantProvider.prototype.createDom=function(t,e,i){this.injectCSS_(e,i),t=n.utils.dom.createSvgElement(n.utils.Svg.DEFS,{},t),e=n.utils.dom.createSvgElement(n.utils.Svg.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},t),n.utils.dom.createSvgElement(n.utils.Svg.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},e),i=n.utils.dom.createSvgElement(n.utils.Svg.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},e),n.utils.dom.createSvgElement(n.utils.Svg.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},i),n.utils.dom.createSvgElement(n.utils.Svg.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},e),n.utils.dom.createSvgElement(n.utils.Svg.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},e),this.embossFilterId=e.id,this.embossFilter_=e,e=n.utils.dom.createSvgElement(n.utils.Svg.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},t),n.utils.dom.createSvgElement(n.utils.Svg.RECT,{width:10,height:10,fill:"#aaa"},e),n.utils.dom.createSvgElement(n.utils.Svg.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},e),this.disabledPatternId=e.id,this.disabledPattern_=e,n.blockRendering.Debug&&(t=n.utils.dom.createSvgElement(n.utils.Svg.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},t),e=n.utils.dom.createSvgElement(n.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},t),n.utils.dom.createSvgElement(n.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},e),n.utils.dom.createSvgElement(n.utils.Svg.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},t),n.utils.dom.createSvgElement(n.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),this.debugFilterId=t.id,this.debugFilter_=t)},n.blockRendering.ConstantProvider.prototype.injectCSS_=function(t,e){e=this.getCSS_(e),t="blockly-renderer-style-"+t,this.cssNode_=document.getElementById(t);var n=e.join("\n");this.cssNode_?this.cssNode_.firstChild.textContent=n:((e=document.createElement("style")).id=t,t=document.createTextNode(n),e.appendChild(t),document.head.insertBefore(e,document.head.firstChild),this.cssNode_=e)},n.blockRendering.ConstantProvider.prototype.getCSS_=function(t){return[t+" .blocklyText, ",t+" .blocklyFlyoutLabelText {","font: "+this.FIELD_TEXT_FONTWEIGHT+" "+this.FIELD_TEXT_FONTSIZE+"pt "+this.FIELD_TEXT_FONTFAMILY+";","}",t+" .blocklyText {","fill: #fff;","}",t+" .blocklyNonEditableText>rect,",t+" .blocklyEditableText>rect {","fill: "+this.FIELD_BORDER_RECT_COLOUR+";","fill-opacity: .6;","stroke: none;","}",t+" .blocklyNonEditableText>text,",t+" .blocklyEditableText>text {","fill: #000;","}",t+" .blocklyFlyoutLabelText {","fill: #000;","}",t+" .blocklyText.blocklyBubbleText {","fill: #000;","}",t+" .blocklyEditableText:not(.editing):hover>rect {","stroke: #fff;","stroke-width: 2;","}",t+" .blocklyHtmlInput {","font-family: "+this.FIELD_TEXT_FONTFAMILY+";","font-weight: "+this.FIELD_TEXT_FONTWEIGHT+";","}",t+" .blocklySelected>.blocklyPath {","stroke: #fc3;","stroke-width: 3px;","}",t+" .blocklyHighlightedConnectionPath {","stroke: #fc3;","}",t+" .blocklyReplaceable .blocklyPath {","fill-opacity: .5;","}",t+" .blocklyReplaceable .blocklyPathLight,",t+" .blocklyReplaceable .blocklyPathDark {","display: none;","}",t+" .blocklyInsertionMarker>.blocklyPath {","fill-opacity: "+this.INSERTION_MARKER_OPACITY+";","stroke: none;","}"]},n.Events.MarkerMove=function(t,e,i,o){var r=t?t.workspace.id:void 0;o&&o.getType()==n.ASTNode.types.WORKSPACE&&(r=o.getLocation().id),n.Events.MarkerMove.superClass_.constructor.call(this,r),this.blockId=t?t.id:null,this.oldNode=i,this.newNode=o,this.isCursor=e},n.utils.object.inherits(n.Events.MarkerMove,n.Events.UiBase),n.Events.MarkerMove.prototype.type=n.Events.MARKER_MOVE,n.Events.MarkerMove.prototype.toJson=function(){var t=n.Events.MarkerMove.superClass_.toJson.call(this);return t.isCursor=this.isCursor,t.blockId=this.blockId,t.oldNode=this.oldNode,t.newNode=this.newNode,t},n.Events.MarkerMove.prototype.fromJson=function(t){n.Events.MarkerMove.superClass_.fromJson.call(this,t),this.isCursor=t.isCursor,this.blockId=t.blockId,this.oldNode=t.oldNode,this.newNode=t.newNode},n.registry.register(n.registry.Type.EVENT,n.Events.MARKER_MOVE,n.Events.MarkerMove),n.blockRendering.MarkerSvg=function(t,e,n){this.workspace_=t,this.marker_=n,this.parent_=null,this.constants_=e,this.currentMarkerSvg=null,t=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR,this.colour_=n.colour||t},n.blockRendering.MarkerSvg.CURSOR_CLASS="blocklyCursor",n.blockRendering.MarkerSvg.MARKER_CLASS="blocklyMarker",n.blockRendering.MarkerSvg.HEIGHT_MULTIPLIER=.75,n.blockRendering.MarkerSvg.prototype.getSvgRoot=function(){return this.svgGroup_},n.blockRendering.MarkerSvg.prototype.getMarker=function(){return this.marker_},n.blockRendering.MarkerSvg.prototype.isCursor=function(){return"cursor"==this.marker_.type},n.blockRendering.MarkerSvg.prototype.createDom=function(){var t=this.isCursor()?n.blockRendering.MarkerSvg.CURSOR_CLASS:n.blockRendering.MarkerSvg.MARKER_CLASS;return this.svgGroup_=n.utils.dom.createSvgElement(n.utils.Svg.G,{class:t},null),this.createDomInternal_(),this.svgGroup_},n.blockRendering.MarkerSvg.prototype.setParent_=function(t){this.isCursor()?(this.parent_&&this.parent_.setCursorSvg(null),t.setCursorSvg(this.getSvgRoot())):(this.parent_&&this.parent_.setMarkerSvg(null),t.setMarkerSvg(this.getSvgRoot())),this.parent_=t},n.blockRendering.MarkerSvg.prototype.draw=function(t,e){if(e){this.constants_=this.workspace_.getRenderer().getConstants();var n=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR;this.colour_=this.marker_.colour||n,this.applyColour_(e),this.showAtLocation_(e),this.fireMarkerEvent_(t,e),void 0!==(t=this.currentMarkerSvg.childNodes[0])&&t.beginElement&&t.beginElement()}else this.hide()},n.blockRendering.MarkerSvg.prototype.showAtLocation_=function(t){var e=t.getLocation();t.getType()==n.ASTNode.types.BLOCK?this.showWithBlock_(t):t.getType()==n.ASTNode.types.OUTPUT?this.showWithOutput_(t):e.type==n.INPUT_VALUE?this.showWithInput_(t):e.type==n.NEXT_STATEMENT?this.showWithNext_(t):t.getType()==n.ASTNode.types.PREVIOUS?this.showWithPrevious_(t):t.getType()==n.ASTNode.types.FIELD?this.showWithField_(t):t.getType()==n.ASTNode.types.WORKSPACE?this.showWithCoordinates_(t):t.getType()==n.ASTNode.types.STACK&&this.showWithStack_(t)},n.blockRendering.MarkerSvg.prototype.showWithBlockPrevOutput_=function(t){var e=(t=t.getSourceBlock()).width,i=t.height,o=i*n.blockRendering.MarkerSvg.HEIGHT_MULTIPLIER,r=this.constants_.CURSOR_BLOCK_PADDING;if(t.previousConnection){var s=this.constants_.shapeFor(t.previousConnection);this.positionPrevious_(e,r,o,s)}else t.outputConnection?(s=this.constants_.shapeFor(t.outputConnection),this.positionOutput_(e,i,s)):this.positionBlock_(e,r,o);this.setParent_(t),this.showCurrent_()},n.blockRendering.MarkerSvg.prototype.showWithBlock_=function(t){this.showWithBlockPrevOutput_(t)},n.blockRendering.MarkerSvg.prototype.showWithPrevious_=function(t){this.showWithBlockPrevOutput_(t)},n.blockRendering.MarkerSvg.prototype.showWithOutput_=function(t){this.showWithBlockPrevOutput_(t)},n.blockRendering.MarkerSvg.prototype.showWithCoordinates_=function(t){var e=t.getWsCoordinate();t=e.x,e=e.y,this.workspace_.RTL&&(t-=this.constants_.CURSOR_WS_WIDTH),this.positionLine_(t,e,this.constants_.CURSOR_WS_WIDTH),this.setParent_(this.workspace_),this.showCurrent_()},n.blockRendering.MarkerSvg.prototype.showWithField_=function(t){var e=(t=t.getLocation()).getSize().width,n=t.getSize().height;this.positionRect_(0,0,e,n),this.setParent_(t),this.showCurrent_()},n.blockRendering.MarkerSvg.prototype.showWithInput_=function(t){var e=(t=t.getLocation()).getSourceBlock();this.positionInput_(t),this.setParent_(e),this.showCurrent_()},n.blockRendering.MarkerSvg.prototype.showWithNext_=function(t){var e=t.getLocation();t=e.getSourceBlock();var n=0;e=e.getOffsetInBlock().y;var i=t.getHeightWidth().width;this.workspace_.RTL&&(n=-i),this.positionLine_(n,e,i),this.setParent_(t),this.showCurrent_()},n.blockRendering.MarkerSvg.prototype.showWithStack_=function(t){var e=(t=t.getLocation()).getHeightWidth(),n=e.width+this.constants_.CURSOR_STACK_PADDING;e=e.height+this.constants_.CURSOR_STACK_PADDING;var i=-this.constants_.CURSOR_STACK_PADDING/2,o=-this.constants_.CURSOR_STACK_PADDING/2,r=i;this.workspace_.RTL&&(r=-(n+i)),this.positionRect_(r,o,n,e),this.setParent_(t),this.showCurrent_()},n.blockRendering.MarkerSvg.prototype.showCurrent_=function(){this.hide(),this.currentMarkerSvg.style.display=""},n.blockRendering.MarkerSvg.prototype.positionBlock_=function(t,e,i){t=n.utils.svgPaths.moveBy(-e,i)+n.utils.svgPaths.lineOnAxis("V",-e)+n.utils.svgPaths.lineOnAxis("H",t+2*e)+n.utils.svgPaths.lineOnAxis("V",i),this.markerBlock_.setAttribute("d",t),this.workspace_.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_},n.blockRendering.MarkerSvg.prototype.positionInput_=function(t){var e=t.getOffsetInBlock().x,i=t.getOffsetInBlock().y;t=n.utils.svgPaths.moveTo(0,0)+this.constants_.shapeFor(t).pathDown,this.markerInput_.setAttribute("d",t),this.markerInput_.setAttribute("transform","translate("+e+","+i+")"+(this.workspace_.RTL?" scale(-1 1)":"")),this.currentMarkerSvg=this.markerInput_},n.blockRendering.MarkerSvg.prototype.positionLine_=function(t,e,n){this.markerSvgLine_.setAttribute("x",t),this.markerSvgLine_.setAttribute("y",e),this.markerSvgLine_.setAttribute("width",n),this.currentMarkerSvg=this.markerSvgLine_},n.blockRendering.MarkerSvg.prototype.positionOutput_=function(t,e,i){t=n.utils.svgPaths.moveBy(t,0)+n.utils.svgPaths.lineOnAxis("h",-(t-i.width))+n.utils.svgPaths.lineOnAxis("v",this.constants_.TAB_OFFSET_FROM_TOP)+i.pathDown+n.utils.svgPaths.lineOnAxis("V",e)+n.utils.svgPaths.lineOnAxis("H",t),this.markerBlock_.setAttribute("d",t),this.workspace_.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_},n.blockRendering.MarkerSvg.prototype.positionPrevious_=function(t,e,i,o){t=n.utils.svgPaths.moveBy(-e,i)+n.utils.svgPaths.lineOnAxis("V",-e)+n.utils.svgPaths.lineOnAxis("H",this.constants_.NOTCH_OFFSET_LEFT)+o.pathLeft+n.utils.svgPaths.lineOnAxis("H",t+2*e)+n.utils.svgPaths.lineOnAxis("V",i),this.markerBlock_.setAttribute("d",t),this.workspace_.RTL&&this.flipRtl_(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_},n.blockRendering.MarkerSvg.prototype.positionRect_=function(t,e,n,i){this.markerSvgRect_.setAttribute("x",t),this.markerSvgRect_.setAttribute("y",e),this.markerSvgRect_.setAttribute("width",n),this.markerSvgRect_.setAttribute("height",i),this.currentMarkerSvg=this.markerSvgRect_},n.blockRendering.MarkerSvg.prototype.flipRtl_=function(t){t.setAttribute("transform","scale(-1 1)")},n.blockRendering.MarkerSvg.prototype.hide=function(){this.markerSvgLine_.style.display="none",this.markerSvgRect_.style.display="none",this.markerInput_.style.display="none",this.markerBlock_.style.display="none"},n.blockRendering.MarkerSvg.prototype.fireMarkerEvent_=function(t,e){var i=e.getSourceBlock();t=new n.Events.MarkerMove(i,this.isCursor(),t,e),n.Events.fire(t)},n.blockRendering.MarkerSvg.prototype.getBlinkProperties_=function(){return{attributeType:"XML",attributeName:"fill",dur:"1s",values:this.colour_+";transparent;transparent;",repeatCount:"indefinite"}},n.blockRendering.MarkerSvg.prototype.createDomInternal_=function(){if(this.markerSvg_=n.utils.dom.createSvgElement(n.utils.Svg.G,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.svgGroup_),this.markerSvgLine_=n.utils.dom.createSvgElement(n.utils.Svg.RECT,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT,style:"display: none"},this.markerSvg_),this.markerSvgRect_=n.utils.dom.createSvgElement(n.utils.Svg.RECT,{class:"blocklyVerticalMarker",rx:10,ry:10,style:"display: none"},this.markerSvg_),this.markerInput_=n.utils.dom.createSvgElement(n.utils.Svg.PATH,{transform:"",style:"display: none"},this.markerSvg_),this.markerBlock_=n.utils.dom.createSvgElement(n.utils.Svg.PATH,{transform:"",style:"display: none",fill:"none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.isCursor()){var t=this.getBlinkProperties_();n.utils.dom.createSvgElement(n.utils.Svg.ANIMATE,t,this.markerSvgLine_),n.utils.dom.createSvgElement(n.utils.Svg.ANIMATE,t,this.markerInput_),t.attributeName="stroke",n.utils.dom.createSvgElement(n.utils.Svg.ANIMATE,t,this.markerBlock_)}return this.markerSvg_},n.blockRendering.MarkerSvg.prototype.applyColour_=function(t){this.markerSvgLine_.setAttribute("fill",this.colour_),this.markerSvgRect_.setAttribute("stroke",this.colour_),this.markerInput_.setAttribute("fill",this.colour_),this.markerBlock_.setAttribute("stroke",this.colour_),this.isCursor()&&(t=this.colour_+";transparent;transparent;",this.markerSvgLine_.firstChild.setAttribute("values",t),this.markerInput_.firstChild.setAttribute("values",t),this.markerBlock_.firstChild.setAttribute("values",t))},n.blockRendering.MarkerSvg.prototype.dispose=function(){this.svgGroup_&&n.utils.dom.removeNode(this.svgGroup_)},n.blockRendering.Types={NONE:0,FIELD:1,HAT:2,ICON:4,SPACER:8,BETWEEN_ROW_SPACER:16,IN_ROW_SPACER:32,EXTERNAL_VALUE_INPUT:64,INPUT:128,INLINE_INPUT:256,STATEMENT_INPUT:512,CONNECTION:1024,PREVIOUS_CONNECTION:2048,NEXT_CONNECTION:4096,OUTPUT_CONNECTION:8192,CORNER:16384,LEFT_SQUARE_CORNER:32768,LEFT_ROUND_CORNER:65536,RIGHT_SQUARE_CORNER:131072,RIGHT_ROUND_CORNER:262144,JAGGED_EDGE:524288,ROW:1048576,TOP_ROW:2097152,BOTTOM_ROW:4194304,INPUT_ROW:8388608},n.blockRendering.Types.LEFT_CORNER=n.blockRendering.Types.LEFT_SQUARE_CORNER|n.blockRendering.Types.LEFT_ROUND_CORNER,n.blockRendering.Types.RIGHT_CORNER=n.blockRendering.Types.RIGHT_SQUARE_CORNER|n.blockRendering.Types.RIGHT_ROUND_CORNER,n.blockRendering.Types.nextTypeValue_=16777216,n.blockRendering.Types.getType=function(t){return Object.prototype.hasOwnProperty.call(n.blockRendering.Types,t)||(n.blockRendering.Types[t]=n.blockRendering.Types.nextTypeValue_,n.blockRendering.Types.nextTypeValue_<<=1),n.blockRendering.Types[t]},n.blockRendering.Types.isField=function(t){return t.type&n.blockRendering.Types.FIELD},n.blockRendering.Types.isHat=function(t){return t.type&n.blockRendering.Types.HAT},n.blockRendering.Types.isIcon=function(t){return t.type&n.blockRendering.Types.ICON},n.blockRendering.Types.isSpacer=function(t){return t.type&n.blockRendering.Types.SPACER},n.blockRendering.Types.isInRowSpacer=function(t){return t.type&n.blockRendering.Types.IN_ROW_SPACER},n.blockRendering.Types.isInput=function(t){return t.type&n.blockRendering.Types.INPUT},n.blockRendering.Types.isExternalInput=function(t){return t.type&n.blockRendering.Types.EXTERNAL_VALUE_INPUT},n.blockRendering.Types.isInlineInput=function(t){return t.type&n.blockRendering.Types.INLINE_INPUT},n.blockRendering.Types.isStatementInput=function(t){return t.type&n.blockRendering.Types.STATEMENT_INPUT},n.blockRendering.Types.isPreviousConnection=function(t){return t.type&n.blockRendering.Types.PREVIOUS_CONNECTION},n.blockRendering.Types.isNextConnection=function(t){return t.type&n.blockRendering.Types.NEXT_CONNECTION},n.blockRendering.Types.isPreviousOrNextConnection=function(t){return t.type&(n.blockRendering.Types.PREVIOUS_CONNECTION|n.blockRendering.Types.NEXT_CONNECTION)},n.blockRendering.Types.isLeftRoundedCorner=function(t){return t.type&n.blockRendering.Types.LEFT_ROUND_CORNER},n.blockRendering.Types.isRightRoundedCorner=function(t){return t.type&n.blockRendering.Types.RIGHT_ROUND_CORNER},n.blockRendering.Types.isLeftSquareCorner=function(t){return t.type&n.blockRendering.Types.LEFT_SQUARE_CORNER},n.blockRendering.Types.isRightSquareCorner=function(t){return t.type&n.blockRendering.Types.RIGHT_SQUARE_CORNER},n.blockRendering.Types.isCorner=function(t){return t.type&n.blockRendering.Types.CORNER},n.blockRendering.Types.isJaggedEdge=function(t){return t.type&n.blockRendering.Types.JAGGED_EDGE},n.blockRendering.Types.isRow=function(t){return t.type&n.blockRendering.Types.ROW},n.blockRendering.Types.isBetweenRowSpacer=function(t){return t.type&n.blockRendering.Types.BETWEEN_ROW_SPACER},n.blockRendering.Types.isTopRow=function(t){return t.type&n.blockRendering.Types.TOP_ROW},n.blockRendering.Types.isBottomRow=function(t){return t.type&n.blockRendering.Types.BOTTOM_ROW},n.blockRendering.Types.isTopOrBottomRow=function(t){return t.type&(n.blockRendering.Types.TOP_ROW|n.blockRendering.Types.BOTTOM_ROW)},n.blockRendering.Types.isInputRow=function(t){return t.type&n.blockRendering.Types.INPUT_ROW},n.blockRendering.Measurable=function(t){this.height=this.width=0,this.type=n.blockRendering.Types.NONE,this.centerline=this.xPos=0,this.constants_=t,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT},n.blockRendering.Connection=function(t,e){n.blockRendering.Connection.superClass_.constructor.call(this,t),this.connectionModel=e,this.shape=this.constants_.shapeFor(e),this.isDynamicShape=!!this.shape.isDynamic,this.type|=n.blockRendering.Types.CONNECTION},n.utils.object.inherits(n.blockRendering.Connection,n.blockRendering.Measurable),n.blockRendering.OutputConnection=function(t,e){n.blockRendering.OutputConnection.superClass_.constructor.call(this,t,e),this.type|=n.blockRendering.Types.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX=0},n.utils.object.inherits(n.blockRendering.OutputConnection,n.blockRendering.Connection),n.blockRendering.PreviousConnection=function(t,e){n.blockRendering.PreviousConnection.superClass_.constructor.call(this,t,e),this.type|=n.blockRendering.Types.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width},n.utils.object.inherits(n.blockRendering.PreviousConnection,n.blockRendering.Connection),n.blockRendering.NextConnection=function(t,e){n.blockRendering.NextConnection.superClass_.constructor.call(this,t,e),this.type|=n.blockRendering.Types.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width},n.utils.object.inherits(n.blockRendering.NextConnection,n.blockRendering.Connection),n.blockRendering.InputConnection=function(t,e){n.blockRendering.InputConnection.superClass_.constructor.call(this,t,e.connection),this.type|=n.blockRendering.Types.INPUT,this.input=e,this.align=e.align,(this.connectedBlock=e.connection&&e.connection.targetBlock()?e.connection.targetBlock():null)?(t=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=t.width,this.connectedBlockHeight=t.height):this.connectedBlockHeight=this.connectedBlockWidth=0,this.connectionOffsetY=this.connectionOffsetX=0},n.utils.object.inherits(n.blockRendering.InputConnection,n.blockRendering.Connection),n.blockRendering.InlineInput=function(t,e){n.blockRendering.InlineInput.superClass_.constructor.call(this,t,e),this.type|=n.blockRendering.Types.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY=this.isDynamicShape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX=this.isDynamicShape?this.shape.connectionOffsetX(this.connectionWidth):0},n.utils.object.inherits(n.blockRendering.InlineInput,n.blockRendering.InputConnection),n.blockRendering.StatementInput=function(t,e){n.blockRendering.StatementInput.superClass_.constructor.call(this,t,e),this.type|=n.blockRendering.Types.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width},n.utils.object.inherits(n.blockRendering.StatementInput,n.blockRendering.InputConnection),n.blockRendering.ExternalValueInput=function(t,e){n.blockRendering.ExternalValueInput.superClass_.constructor.call(this,t,e),this.type|=n.blockRendering.Types.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width},n.utils.object.inherits(n.blockRendering.ExternalValueInput,n.blockRendering.InputConnection),n.blockRendering.Icon=function(t,e){n.blockRendering.Icon.superClass_.constructor.call(this,t),this.icon=e,this.isVisible=e.isVisible(),this.type|=n.blockRendering.Types.ICON,t=e.getCorrectedSize(),this.height=t.height,this.width=t.width},n.utils.object.inherits(n.blockRendering.Icon,n.blockRendering.Measurable),n.blockRendering.JaggedEdge=function(t){n.blockRendering.JaggedEdge.superClass_.constructor.call(this,t),this.type|=n.blockRendering.Types.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width},n.utils.object.inherits(n.blockRendering.JaggedEdge,n.blockRendering.Measurable),n.blockRendering.Field=function(t,e,i){n.blockRendering.Field.superClass_.constructor.call(this,t),this.field=e,this.isEditable=e.EDITABLE,this.flipRtl=e.getFlipRtl(),this.type|=n.blockRendering.Types.FIELD,t=this.field.getSize(),this.height=t.height,this.width=t.width,this.parentInput=i},n.utils.object.inherits(n.blockRendering.Field,n.blockRendering.Measurable),n.blockRendering.Hat=function(t){n.blockRendering.Hat.superClass_.constructor.call(this,t),this.type|=n.blockRendering.Types.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height},n.utils.object.inherits(n.blockRendering.Hat,n.blockRendering.Measurable),n.blockRendering.SquareCorner=function(t,e){n.blockRendering.SquareCorner.superClass_.constructor.call(this,t),this.type=(e&&"left"!=e?n.blockRendering.Types.RIGHT_SQUARE_CORNER:n.blockRendering.Types.LEFT_SQUARE_CORNER)|n.blockRendering.Types.CORNER,this.width=this.height=this.constants_.NO_PADDING},n.utils.object.inherits(n.blockRendering.SquareCorner,n.blockRendering.Measurable),n.blockRendering.RoundCorner=function(t,e){n.blockRendering.RoundCorner.superClass_.constructor.call(this,t),this.type=(e&&"left"!=e?n.blockRendering.Types.RIGHT_ROUND_CORNER:n.blockRendering.Types.LEFT_ROUND_CORNER)|n.blockRendering.Types.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2},n.utils.object.inherits(n.blockRendering.RoundCorner,n.blockRendering.Measurable),n.blockRendering.InRowSpacer=function(t,e){n.blockRendering.InRowSpacer.superClass_.constructor.call(this,t),this.type=this.type|n.blockRendering.Types.SPACER|n.blockRendering.Types.IN_ROW_SPACER,this.width=e,this.height=this.constants_.SPACER_DEFAULT_HEIGHT},n.utils.object.inherits(n.blockRendering.InRowSpacer,n.blockRendering.Measurable),n.blockRendering.Row=function(t){this.type=n.blockRendering.Types.ROW,this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=this.hasStatement=this.hasExternalInput=!1,this.constants_=t,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT,this.align=null},n.blockRendering.Row.prototype.measure=function(){throw Error("Unexpected attempt to measure a base Row.")},n.blockRendering.Row.prototype.getLastInput=function(){for(var t,e=this.elements.length-1;t=this.elements[e];e--)if(n.blockRendering.Types.isInput(t))return t;return null},n.blockRendering.Row.prototype.startsWithElemSpacer=function(){return!0},n.blockRendering.Row.prototype.endsWithElemSpacer=function(){return!0},n.blockRendering.Row.prototype.getFirstSpacer=function(){for(var t,e=0;t=this.elements[e];e++)if(n.blockRendering.Types.isSpacer(t))return t;return null},n.blockRendering.Row.prototype.getLastSpacer=function(){for(var t,e=this.elements.length-1;t=this.elements[e];e--)if(n.blockRendering.Types.isSpacer(t))return t;return null},n.blockRendering.TopRow=function(t){n.blockRendering.TopRow.superClass_.constructor.call(this,t),this.type|=n.blockRendering.Types.TOP_ROW,this.ascenderHeight=this.capline=0,this.hasPreviousConnection=!1,this.connection=null},n.utils.object.inherits(n.blockRendering.TopRow,n.blockRendering.Row),n.blockRendering.TopRow.prototype.hasLeftSquareCorner=function(t){var e=(t.hat?"cap"===t.hat:this.constants_.ADD_START_HATS)&&!t.outputConnection&&!t.previousConnection,n=t.getPreviousBlock();return!!t.outputConnection||e||!!n&&n.getNextBlock()==t},n.blockRendering.TopRow.prototype.hasRightSquareCorner=function(t){return!0},n.blockRendering.TopRow.prototype.measure=function(){for(var t,e=0,i=0,o=0,r=0;t=this.elements[r];r++)i+=t.width,n.blockRendering.Types.isSpacer(t)||(n.blockRendering.Types.isHat(t)?o=Math.max(o,t.ascenderHeight):e=Math.max(e,t.height));this.width=Math.max(this.minWidth,i),this.height=Math.max(this.minHeight,e)+o,this.capline=this.ascenderHeight=o,this.widthWithConnectedBlocks=this.width},n.blockRendering.TopRow.prototype.startsWithElemSpacer=function(){return!1},n.blockRendering.TopRow.prototype.endsWithElemSpacer=function(){return!1},n.blockRendering.BottomRow=function(t){n.blockRendering.BottomRow.superClass_.constructor.call(this,t),this.type|=n.blockRendering.Types.BOTTOM_ROW,this.hasNextConnection=!1,this.connection=null,this.baseline=this.descenderHeight=0},n.utils.object.inherits(n.blockRendering.BottomRow,n.blockRendering.Row),n.blockRendering.BottomRow.prototype.hasLeftSquareCorner=function(t){return!!t.outputConnection||!!t.getNextBlock()},n.blockRendering.BottomRow.prototype.hasRightSquareCorner=function(t){return!0},n.blockRendering.BottomRow.prototype.measure=function(){for(var t,e=0,i=0,o=0,r=0;t=this.elements[r];r++)i+=t.width,n.blockRendering.Types.isSpacer(t)||(n.blockRendering.Types.isNextConnection(t)?o=Math.max(o,t.height):e=Math.max(e,t.height));this.width=Math.max(this.minWidth,i),this.height=Math.max(this.minHeight,e)+o,this.descenderHeight=o,this.widthWithConnectedBlocks=this.width},n.blockRendering.BottomRow.prototype.startsWithElemSpacer=function(){return!1},n.blockRendering.BottomRow.prototype.endsWithElemSpacer=function(){return!1},n.blockRendering.SpacerRow=function(t,e,i){n.blockRendering.SpacerRow.superClass_.constructor.call(this,t),this.type=this.type|n.blockRendering.Types.SPACER|n.blockRendering.Types.BETWEEN_ROW_SPACER,this.width=i,this.height=e,this.followsStatement=!1,this.widthWithConnectedBlocks=0,this.elements=[new n.blockRendering.InRowSpacer(this.constants_,i)]},n.utils.object.inherits(n.blockRendering.SpacerRow,n.blockRendering.Row),n.blockRendering.SpacerRow.prototype.measure=function(){},n.blockRendering.InputRow=function(t){n.blockRendering.InputRow.superClass_.constructor.call(this,t),this.type|=n.blockRendering.Types.INPUT_ROW,this.connectedBlockWidths=0},n.utils.object.inherits(n.blockRendering.InputRow,n.blockRendering.Row),n.blockRendering.InputRow.prototype.measure=function(){this.width=this.minWidth,this.height=this.minHeight;for(var t,e=0,i=0;t=this.elements[i];i++)this.width+=t.width,n.blockRendering.Types.isInput(t)&&(n.blockRendering.Types.isStatementInput(t)?e+=t.connectedBlockWidth:n.blockRendering.Types.isExternalInput(t)&&0!=t.connectedBlockWidth&&(e+=t.connectedBlockWidth-t.connectionWidth)),n.blockRendering.Types.isSpacer(t)||(this.height=Math.max(this.height,t.height));this.connectedBlockWidths=e,this.widthWithConnectedBlocks=this.width+e},n.blockRendering.InputRow.prototype.endsWithElemSpacer=function(){return!this.hasExternalInput&&!this.hasStatement},n.blockRendering.RenderInfo=function(t,e){this.block_=e,this.renderer_=t,this.constants_=this.renderer_.getConstants(),this.outputConnection=e.outputConnection?new n.blockRendering.OutputConnection(this.constants_,e.outputConnection):null,this.isInline=e.getInputsInline()&&!e.isCollapsed(),this.isCollapsed=e.isCollapsed(),this.isInsertionMarker=e.isInsertionMarker(),this.RTL=e.RTL,this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.hiddenIcons=[],this.topRow=new n.blockRendering.TopRow(this.constants_),this.bottomRow=new n.blockRendering.BottomRow(this.constants_),this.startY=this.startX=0},n.blockRendering.RenderInfo.prototype.getRenderer=function(){return this.renderer_},n.blockRendering.RenderInfo.prototype.measure=function(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()},n.blockRendering.RenderInfo.prototype.createRows_=function(){this.populateTopRow_(),this.rows.push(this.topRow);var t=new n.blockRendering.InputRow(this.constants_);this.inputRows.push(t);var e=this.block_.getIcons();if(e.length)for(var i,o=0;i=e[o];o++){var r=new n.blockRendering.Icon(this.constants_,i);this.isCollapsed&&i.collapseHidden?this.hiddenIcons.push(r):t.elements.push(r)}for(i=null,o=0;e=this.block_.inputList[o];o++)if(e.isVisible()){for(this.shouldStartNewRow_(e,i)&&(this.rows.push(t),t=new n.blockRendering.InputRow(this.constants_),this.inputRows.push(t)),i=0;r=e.fieldRow[i];i++)t.elements.push(new n.blockRendering.Field(this.constants_,r,e));this.addInput_(e,t),i=e}this.isCollapsed&&(t.hasJaggedEdge=!0,t.elements.push(new n.blockRendering.JaggedEdge(this.constants_))),(t.elements.length||t.hasDummyInput)&&this.rows.push(t),this.populateBottomRow_(),this.rows.push(this.bottomRow)},n.blockRendering.RenderInfo.prototype.populateTopRow_=function(){var t=!!this.block_.previousConnection,e=(this.block_.hat?"cap"===this.block_.hat:this.constants_.ADD_START_HATS)&&!this.outputConnection&&!t;this.topRow.hasLeftSquareCorner(this.block_)?this.topRow.elements.push(new n.blockRendering.SquareCorner(this.constants_)):this.topRow.elements.push(new n.blockRendering.RoundCorner(this.constants_)),e?(t=new n.blockRendering.Hat(this.constants_),this.topRow.elements.push(t),this.topRow.capline=t.ascenderHeight):t&&(this.topRow.hasPreviousConnection=!0,this.topRow.connection=new n.blockRendering.PreviousConnection(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.block_.inputList.length&&this.block_.inputList[0].type==n.NEXT_STATEMENT&&!this.block_.isCollapsed()?this.topRow.minHeight=this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.topRow.minHeight=this.constants_.TOP_ROW_MIN_HEIGHT,this.topRow.hasRightSquareCorner(this.block_)?this.topRow.elements.push(new n.blockRendering.SquareCorner(this.constants_,"right")):this.topRow.elements.push(new n.blockRendering.RoundCorner(this.constants_,"right"))},n.blockRendering.RenderInfo.prototype.populateBottomRow_=function(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1].type==n.NEXT_STATEMENT?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new n.blockRendering.SquareCorner(this.constants_)):this.bottomRow.elements.push(new n.blockRendering.RoundCorner(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new n.blockRendering.NextConnection(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new n.blockRendering.SquareCorner(this.constants_,"right")):this.bottomRow.elements.push(new n.blockRendering.RoundCorner(this.constants_,"right"))},n.blockRendering.RenderInfo.prototype.addInput_=function(t,e){this.isInline&&t.type==n.INPUT_VALUE?(e.elements.push(new n.blockRendering.InlineInput(this.constants_,t)),e.hasInlineInput=!0):t.type==n.NEXT_STATEMENT?(e.elements.push(new n.blockRendering.StatementInput(this.constants_,t)),e.hasStatement=!0):t.type==n.INPUT_VALUE?(e.elements.push(new n.blockRendering.ExternalValueInput(this.constants_,t)),e.hasExternalInput=!0):t.type==n.DUMMY_INPUT&&(e.minHeight=Math.max(e.minHeight,t.getSourceBlock()&&t.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),e.hasDummyInput=!0),null==e.align&&(e.align=t.align)},n.blockRendering.RenderInfo.prototype.shouldStartNewRow_=function(t,e){return!(!e||t.type!=n.NEXT_STATEMENT&&e.type!=n.NEXT_STATEMENT&&(t.type!=n.INPUT_VALUE&&t.type!=n.DUMMY_INPUT||this.isInline))},n.blockRendering.RenderInfo.prototype.addElemSpacing_=function(){for(var t,e=0;t=this.rows[e];e++){var i=t.elements;if(t.elements=[],t.startsWithElemSpacer()&&t.elements.push(new n.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(null,i[0]))),i.length){for(var o=0;o<i.length-1;o++){t.elements.push(i[o]);var r=this.getInRowSpacing_(i[o],i[o+1]);t.elements.push(new n.blockRendering.InRowSpacer(this.constants_,r))}t.elements.push(i[i.length-1]),t.endsWithElemSpacer()&&t.elements.push(new n.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(i[i.length-1],null)))}}},n.blockRendering.RenderInfo.prototype.getInRowSpacing_=function(t,e){if(!t&&e&&n.blockRendering.Types.isStatementInput(e))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(t&&n.blockRendering.Types.isInput(t)&&!e){if(n.blockRendering.Types.isExternalInput(t))return this.constants_.NO_PADDING;if(n.blockRendering.Types.isInlineInput(t))return this.constants_.LARGE_PADDING;if(n.blockRendering.Types.isStatementInput(t))return this.constants_.NO_PADDING}return t&&n.blockRendering.Types.isLeftSquareCorner(t)&&e&&(n.blockRendering.Types.isPreviousConnection(e)||n.blockRendering.Types.isNextConnection(e))?e.notchOffset:t&&n.blockRendering.Types.isLeftRoundedCorner(t)&&e&&(n.blockRendering.Types.isPreviousConnection(e)||n.blockRendering.Types.isNextConnection(e))?e.notchOffset-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING},n.blockRendering.RenderInfo.prototype.computeBounds_=function(){for(var t,e=0,n=0,i=0,o=0;t=this.rows[o];o++){if(t.measure(),n=Math.max(n,t.width),t.hasStatement){var r=t.getLastInput();e=Math.max(e,t.width-r.width)}i=Math.max(i,t.widthWithConnectedBlocks)}for(this.statementEdge=e,this.width=n,o=0;t=this.rows[o];o++)t.hasStatement&&(t.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(n,i),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)},n.blockRendering.RenderInfo.prototype.alignRowElements_=function(){for(var t,e=0;t=this.rows[e];e++)if(t.hasStatement)this.alignStatementRow_(t);else{var i=t.width;0<(i=this.getDesiredRowWidth_(t)-i)&&this.addAlignmentPadding_(t,i),n.blockRendering.Types.isTopOrBottomRow(t)&&(t.widthWithConnectedBlocks=t.width)}},n.blockRendering.RenderInfo.prototype.getDesiredRowWidth_=function(t){return this.width-this.startX},n.blockRendering.RenderInfo.prototype.addAlignmentPadding_=function(t,e){var i=t.getFirstSpacer(),o=t.getLastSpacer();(t.hasExternalInput||t.hasStatement)&&(t.widthWithConnectedBlocks+=e),t.align==n.ALIGN_LEFT?o.width+=e:t.align==n.ALIGN_CENTRE?(i.width+=e/2,o.width+=e/2):t.align==n.ALIGN_RIGHT?i.width+=e:o.width+=e,t.width+=e},n.blockRendering.RenderInfo.prototype.alignStatementRow_=function(t){var e=t.getLastInput(),n=t.width-e.width,i=this.statementEdge;0<(n=i-n)&&this.addAlignmentPadding_(t,n),n=t.width,i=this.getDesiredRowWidth_(t),e.width+=i-n,e.height=Math.max(e.height,t.height),t.width+=i-n,t.widthWithConnectedBlocks=Math.max(t.width,this.statementEdge+t.connectedBlockWidths)},n.blockRendering.RenderInfo.prototype.addRowSpacing_=function(){var t=this.rows;this.rows=[];for(var e=0;e<t.length;e++)this.rows.push(t[e]),e!=t.length-1&&this.rows.push(this.makeSpacerRow_(t[e],t[e+1]))},n.blockRendering.RenderInfo.prototype.makeSpacerRow_=function(t,e){var i=this.getSpacerRowHeight_(t,e),o=this.getSpacerRowWidth_(t,e);return i=new n.blockRendering.SpacerRow(this.constants_,i,o),t.hasStatement&&(i.followsStatement=!0),e.hasStatement&&(i.precedesStatement=!0),i},n.blockRendering.RenderInfo.prototype.getSpacerRowWidth_=function(t,e){return this.width-this.startX},n.blockRendering.RenderInfo.prototype.getSpacerRowHeight_=function(t,e){return this.constants_.MEDIUM_PADDING},n.blockRendering.RenderInfo.prototype.getElemCenterline_=function(t,e){return n.blockRendering.Types.isSpacer(e)?t.yPos+e.height/2:n.blockRendering.Types.isBottomRow(t)?(t=t.yPos+t.height-t.descenderHeight,n.blockRendering.Types.isNextConnection(e)?t+e.height/2:t-e.height/2):n.blockRendering.Types.isTopRow(t)?n.blockRendering.Types.isHat(e)?t.capline-e.height/2:t.capline+e.height/2:t.yPos+t.height/2},n.blockRendering.RenderInfo.prototype.recordElemPositions_=function(t){for(var e,i=t.xPos,o=0;e=t.elements[o];o++)n.blockRendering.Types.isSpacer(e)&&(e.height=t.height),e.xPos=i,e.centerline=this.getElemCenterline_(t,e),i+=e.width},n.blockRendering.RenderInfo.prototype.finalize_=function(){for(var t,e=0,n=0,i=0;t=this.rows[i];i++)t.yPos=n,t.xPos=this.startX,n+=t.height,e=Math.max(e,t.widthWithConnectedBlocks),this.recordElemPositions_(t);this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(e=Math.max(e,this.block_.nextConnection.targetBlock().getHeightWidth().width)),this.widthWithChildren=e+this.startX,this.height=n,this.startY=this.topRow.capline,this.bottomRow.baseline=n-this.bottomRow.descenderHeight},n.blockRendering.Drawer=function(t,e){this.block_=t,this.info_=e,this.topLeft_=t.getRelativeToSurfaceXY(),this.inlinePath_=this.outlinePath_="",this.constants_=e.getRenderer().getConstants()},n.blockRendering.Drawer.prototype.draw=function(){this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_(),this.block_.pathObject.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),n.blockRendering.useDebugger&&this.block_.renderingDebugger.drawDebug(this.block_,this.info_),this.recordSizeOnBlock_()},n.blockRendering.Drawer.prototype.recordSizeOnBlock_=function(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren},n.blockRendering.Drawer.prototype.hideHiddenIcons_=function(){for(var t,e=0;t=this.info_.hiddenIcons[e];e++)t.icon.iconGroup_.setAttribute("display","none")},n.blockRendering.Drawer.prototype.drawOutline_=function(){this.drawTop_();for(var t=1;t<this.info_.rows.length-1;t++){var e=this.info_.rows[t];e.hasJaggedEdge?this.drawJaggedEdge_(e):e.hasStatement?this.drawStatementInput_(e):e.hasExternalInput?this.drawValueInput_(e):this.drawRightSideRow_(e)}this.drawBottom_(),this.drawLeft_()},n.blockRendering.Drawer.prototype.drawTop_=function(){var t=this.info_.topRow,e=t.elements;this.positionPreviousConnection_(),this.outlinePath_+=n.utils.svgPaths.moveBy(t.xPos,this.info_.startY);for(var i,o=0;i=e[o];o++)n.blockRendering.Types.isLeftRoundedCorner(i)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:n.blockRendering.Types.isRightRoundedCorner(i)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:n.blockRendering.Types.isPreviousConnection(i)?this.outlinePath_+=i.shape.pathLeft:n.blockRendering.Types.isHat(i)?this.outlinePath_+=this.constants_.START_HAT.path:n.blockRendering.Types.isSpacer(i)&&(this.outlinePath_+=n.utils.svgPaths.lineOnAxis("h",i.width));this.outlinePath_+=n.utils.svgPaths.lineOnAxis("v",t.height)},n.blockRendering.Drawer.prototype.drawJaggedEdge_=function(t){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+n.utils.svgPaths.lineOnAxis("v",t.height-this.constants_.JAGGED_TEETH.height)},n.blockRendering.Drawer.prototype.drawValueInput_=function(t){var e=t.getLastInput();this.positionExternalValueConnection_(t);var i="function"==typeof e.shape.pathDown?e.shape.pathDown(e.height):e.shape.pathDown;this.outlinePath_+=n.utils.svgPaths.lineOnAxis("H",e.xPos+e.width)+i+n.utils.svgPaths.lineOnAxis("v",t.height-e.connectionHeight)},n.blockRendering.Drawer.prototype.drawStatementInput_=function(t){var e=t.getLastInput(),i=e.xPos+e.notchOffset+e.shape.width;e=e.shape.pathRight+n.utils.svgPaths.lineOnAxis("h",-(e.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var o=t.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=n.utils.svgPaths.lineOnAxis("H",i)+e+n.utils.svgPaths.lineOnAxis("v",o)+this.constants_.INSIDE_CORNERS.pathBottom+n.utils.svgPaths.lineOnAxis("H",t.xPos+t.width),this.positionStatementInputConnection_(t)},n.blockRendering.Drawer.prototype.drawRightSideRow_=function(t){this.outlinePath_+=n.utils.svgPaths.lineOnAxis("V",t.yPos+t.height)},n.blockRendering.Drawer.prototype.drawBottom_=function(){var t=this.info_.bottomRow,e=t.elements;this.positionNextConnection_();for(var i,o=0,r="",s=e.length-1;i=e[s];s--)n.blockRendering.Types.isNextConnection(i)?r+=i.shape.pathRight:n.blockRendering.Types.isLeftSquareCorner(i)?r+=n.utils.svgPaths.lineOnAxis("H",t.xPos):n.blockRendering.Types.isLeftRoundedCorner(i)?r+=this.constants_.OUTSIDE_CORNERS.bottomLeft:n.blockRendering.Types.isRightRoundedCorner(i)?(r+=this.constants_.OUTSIDE_CORNERS.bottomRight,o=this.constants_.OUTSIDE_CORNERS.rightHeight):n.blockRendering.Types.isSpacer(i)&&(r+=n.utils.svgPaths.lineOnAxis("h",-1*i.width));this.outlinePath_+=n.utils.svgPaths.lineOnAxis("V",t.baseline-o),this.outlinePath_+=r},n.blockRendering.Drawer.prototype.drawLeft_=function(){var t=this.info_.outputConnection;if(this.positionOutputConnection_(),t){var e=t.connectionOffsetY+t.height;t="function"==typeof t.shape.pathUp?t.shape.pathUp(t.height):t.shape.pathUp,this.outlinePath_+=n.utils.svgPaths.lineOnAxis("V",e)+t}this.outlinePath_+="z"},n.blockRendering.Drawer.prototype.drawInternals_=function(){for(var t,e=0;t=this.info_.rows[e];e++)for(var i,o=0;i=t.elements[o];o++)n.blockRendering.Types.isInlineInput(i)?this.drawInlineInput_(i):(n.blockRendering.Types.isIcon(i)||n.blockRendering.Types.isField(i))&&this.layoutField_(i)},n.blockRendering.Drawer.prototype.layoutField_=function(t){if(n.blockRendering.Types.isField(t))var e=t.field.getSvgRoot();else n.blockRendering.Types.isIcon(t)&&(e=t.icon.iconGroup_);var i=t.centerline-t.height/2,o=t.xPos,r="";this.info_.RTL&&(o=-(o+t.width),t.flipRtl&&(o+=t.width,r="scale(-1 1)")),n.blockRendering.Types.isIcon(t)?(e.setAttribute("display","block"),e.setAttribute("transform","translate("+o+","+i+")"),t.icon.computeIconLocation()):e.setAttribute("transform","translate("+o+","+i+")"+r),this.info_.isInsertionMarker&&e.setAttribute("display","none")},n.blockRendering.Drawer.prototype.drawInlineInput_=function(t){var e=t.width,i=t.height,o=t.connectionOffsetY,r=t.connectionHeight+o;this.inlinePath_+=n.utils.svgPaths.moveTo(t.xPos+t.connectionWidth,t.centerline-i/2)+n.utils.svgPaths.lineOnAxis("v",o)+t.shape.pathDown+n.utils.svgPaths.lineOnAxis("v",i-r)+n.utils.svgPaths.lineOnAxis("h",e-t.connectionWidth)+n.utils.svgPaths.lineOnAxis("v",-i)+"z",this.positionInlineInputConnection_(t)},n.blockRendering.Drawer.prototype.positionInlineInputConnection_=function(t){var e=t.centerline-t.height/2;if(t.connectionModel){var n=t.xPos+t.connectionWidth+t.connectionOffsetX;this.info_.RTL&&(n*=-1),t.connectionModel.setOffsetInBlock(n,e+t.connectionOffsetY)}},n.blockRendering.Drawer.prototype.positionStatementInputConnection_=function(t){var e=t.getLastInput();if(e.connectionModel){var n=t.xPos+t.statementEdge+e.notchOffset;this.info_.RTL&&(n*=-1),e.connectionModel.setOffsetInBlock(n,t.yPos)}},n.blockRendering.Drawer.prototype.positionExternalValueConnection_=function(t){var e=t.getLastInput();if(e.connectionModel){var n=t.xPos+t.width;this.info_.RTL&&(n*=-1),e.connectionModel.setOffsetInBlock(n,t.yPos)}},n.blockRendering.Drawer.prototype.positionPreviousConnection_=function(){var t=this.info_.topRow;if(t.connection){var e=t.xPos+t.notchOffset;t.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-e:e,0)}},n.blockRendering.Drawer.prototype.positionNextConnection_=function(){var t=this.info_.bottomRow;if(t.connection){var e=t.connection,n=e.xPos;e.connectionModel.setOffsetInBlock(this.info_.RTL?-n:n,t.baseline)}},n.blockRendering.Drawer.prototype.positionOutputConnection_=function(){if(this.info_.outputConnection){var t=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-t:t,this.info_.outputConnection.connectionOffsetY)}},n.blockRendering.PathObject=function(t,e,i){this.constants=i,this.svgRoot=t,this.svgPath=n.utils.dom.createSvgElement(n.utils.Svg.PATH,{class:"blocklyPath"},this.svgRoot),this.style=e,this.markerSvg=this.cursorSvg=null},n.blockRendering.PathObject.prototype.setPath=function(t){this.svgPath.setAttribute("d",t)},n.blockRendering.PathObject.prototype.flipRTL=function(){this.svgPath.setAttribute("transform","scale(-1 1)")},n.blockRendering.PathObject.prototype.setCursorSvg=function(t){t?(this.svgRoot.appendChild(t),this.cursorSvg=t):this.cursorSvg=null},n.blockRendering.PathObject.prototype.setMarkerSvg=function(t){t?(this.cursorSvg?this.svgRoot.insertBefore(t,this.cursorSvg):this.svgRoot.appendChild(t),this.markerSvg=t):this.markerSvg=null},n.blockRendering.PathObject.prototype.applyColour=function(t){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(t.isShadow()),this.updateDisabled_(!t.isEnabled()||t.getInheritedDisabled())},n.blockRendering.PathObject.prototype.setStyle=function(t){this.style=t},n.blockRendering.PathObject.prototype.setClass_=function(t,e){e?n.utils.dom.addClass(this.svgRoot,t):n.utils.dom.removeClass(this.svgRoot,t)},n.blockRendering.PathObject.prototype.updateHighlighted=function(t){t?this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"):this.svgPath.setAttribute("filter","none")},n.blockRendering.PathObject.prototype.updateShadow_=function(t){t&&(this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary))},n.blockRendering.PathObject.prototype.updateDisabled_=function(t){this.setClass_("blocklyDisabled",t),t&&this.svgPath.setAttribute("fill","url(#"+this.constants.disabledPatternId+")")},n.blockRendering.PathObject.prototype.updateSelected=function(t){this.setClass_("blocklySelected",t)},n.blockRendering.PathObject.prototype.updateDraggingDelete=function(t){this.setClass_("blocklyDraggingDelete",t)},n.blockRendering.PathObject.prototype.updateInsertionMarker=function(t){this.setClass_("blocklyInsertionMarker",t)},n.blockRendering.PathObject.prototype.updateMovable=function(t){this.setClass_("blocklyDraggable",t)},n.blockRendering.PathObject.prototype.updateReplacementFade=function(t){this.setClass_("blocklyReplaceable",t)},n.blockRendering.PathObject.prototype.updateShapeForInputHighlight=function(t,e){},n.blockRendering.Renderer=function(t){this.name=t,this.overrides=this.constants_=null},n.blockRendering.Renderer.prototype.getClassName=function(){return this.name+"-renderer"},n.blockRendering.Renderer.prototype.init=function(t,e){this.constants_=this.makeConstants_(),e&&(this.overrides=e,n.utils.object.mixin(this.constants_,e)),this.constants_.setTheme(t),this.constants_.init()},n.blockRendering.Renderer.prototype.createDom=function(t,e){this.constants_.createDom(t,this.name+"-"+e.name,"."+this.getClassName()+"."+e.getClassName())},n.blockRendering.Renderer.prototype.refreshDom=function(t,e){var i=this.getConstants();i.dispose(),this.constants_=this.makeConstants_(),this.overrides&&n.utils.object.mixin(this.constants_,this.overrides),this.constants_.randomIdentifier=i.randomIdentifier,this.constants_.setTheme(e),this.constants_.init(),this.createDom(t,e)},n.blockRendering.Renderer.prototype.dispose=function(){this.constants_&&this.constants_.dispose()},n.blockRendering.Renderer.prototype.makeConstants_=function(){return new n.blockRendering.ConstantProvider},n.blockRendering.Renderer.prototype.makeRenderInfo_=function(t){return new n.blockRendering.RenderInfo(this,t)},n.blockRendering.Renderer.prototype.makeDrawer_=function(t,e){return new n.blockRendering.Drawer(t,e)},n.blockRendering.Renderer.prototype.makeDebugger_=function(){if(!n.blockRendering.Debug)throw Error("Missing require for Blockly.blockRendering.Debug");return new n.blockRendering.Debug(this.getConstants())},n.blockRendering.Renderer.prototype.makeMarkerDrawer=function(t,e){return new n.blockRendering.MarkerSvg(t,this.getConstants(),e)},n.blockRendering.Renderer.prototype.makePathObject=function(t,e){return new n.blockRendering.PathObject(t,e,this.constants_)},n.blockRendering.Renderer.prototype.getConstants=function(){return this.constants_},n.blockRendering.Renderer.prototype.shouldHighlightConnection=function(t){return!0},n.blockRendering.Renderer.prototype.orphanCanConnectAtEnd=function(t,e,i){return i==n.OUTPUT_VALUE?(i=e.outputConnection,t=n.Connection.lastConnectionInRow(t,e)):(i=e.previousConnection,t=t.lastConnectionInStack()),!!t&&i.getConnectionChecker().canConnect(t,i,!1)},n.blockRendering.Renderer.prototype.getConnectionPreviewMethod=function(t,e,i){return e.type==n.OUTPUT_VALUE||e.type==n.PREVIOUS_STATEMENT?!t.isConnected()||this.orphanCanConnectAtEnd(i,t.targetBlock(),e.type)?n.InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER:n.InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE:n.InsertionMarkerManager.PREVIEW_TYPE.INSERTION_MARKER},n.blockRendering.Renderer.prototype.render=function(t){n.blockRendering.useDebugger&&!t.renderingDebugger&&(t.renderingDebugger=this.makeDebugger_());var e=this.makeRenderInfo_(t);e.measure(),this.makeDrawer_(t,e).draw()},n.geras={},n.geras.ConstantProvider=function(){n.geras.ConstantProvider.superClass_.constructor.call(this),this.FIELD_TEXT_BASELINE_CENTER=!1,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2},n.utils.object.inherits(n.geras.ConstantProvider,n.blockRendering.ConstantProvider),n.geras.ConstantProvider.prototype.getCSS_=function(t){return n.geras.ConstantProvider.superClass_.getCSS_.call(this,t).concat([t+" .blocklyInsertionMarker>.blocklyPathLight,",t+" .blocklyInsertionMarker>.blocklyPathDark {","fill-opacity: "+this.INSERTION_MARKER_OPACITY+";","stroke: none;","}"])},n.geras.Highlighter=function(t){this.info_=t,this.inlineSteps_=this.steps_="",this.RTL_=this.info_.RTL,t=t.getRenderer(),this.constants_=t.getConstants(),this.highlightConstants_=t.getHighlightConstants(),this.highlightOffset_=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH},n.geras.Highlighter.prototype.getPath=function(){return this.steps_+"\n"+this.inlineSteps_},n.geras.Highlighter.prototype.drawTopCorner=function(t){this.steps_+=n.utils.svgPaths.moveBy(t.xPos,this.info_.startY);for(var e,i=0;e=t.elements[i];i++)n.blockRendering.Types.isLeftSquareCorner(e)?this.steps_+=this.highlightConstants_.START_POINT:n.blockRendering.Types.isLeftRoundedCorner(e)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):n.blockRendering.Types.isPreviousConnection(e)?this.steps_+=this.notchPaths_.pathLeft:n.blockRendering.Types.isHat(e)?this.steps_+=this.startPaths_.path(this.RTL_):n.blockRendering.Types.isSpacer(e)&&0!=e.width&&(this.steps_+=n.utils.svgPaths.lineOnAxis("H",e.xPos+e.width-this.highlightOffset_));this.steps_+=n.utils.svgPaths.lineOnAxis("H",t.xPos+t.width-this.highlightOffset_)},n.geras.Highlighter.prototype.drawJaggedEdge_=function(t){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+n.utils.svgPaths.lineOnAxis("v",t.height-this.jaggedTeethPaths_.height-this.highlightOffset_))},n.geras.Highlighter.prototype.drawValueInput=function(t){var e=t.getLastInput();if(this.RTL_){var i=t.height-e.connectionHeight;this.steps_+=n.utils.svgPaths.moveTo(e.xPos+e.width-this.highlightOffset_,t.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+n.utils.svgPaths.lineOnAxis("v",i)}else this.steps_+=n.utils.svgPaths.moveTo(e.xPos+e.width,t.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)},n.geras.Highlighter.prototype.drawStatementInput=function(t){var e=t.getLastInput();if(this.RTL_){var i=t.height-2*this.insideCornerPaths_.height;this.steps_+=n.utils.svgPaths.moveTo(e.xPos,t.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+n.utils.svgPaths.lineOnAxis("v",i)+this.insideCornerPaths_.pathBottom(this.RTL_)+n.utils.svgPaths.lineTo(t.width-e.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=n.utils.svgPaths.moveTo(e.xPos,t.yPos+t.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+n.utils.svgPaths.lineTo(t.width-e.xPos-this.insideCornerPaths_.width,0)},n.geras.Highlighter.prototype.drawRightSideRow=function(t){var e=t.xPos+t.width-this.highlightOffset_;t.followsStatement&&(this.steps_+=n.utils.svgPaths.lineOnAxis("H",e)),this.RTL_&&(this.steps_+=n.utils.svgPaths.lineOnAxis("H",e),t.height>this.highlightOffset_&&(this.steps_+=n.utils.svgPaths.lineOnAxis("V",t.yPos+t.height-this.highlightOffset_)))},n.geras.Highlighter.prototype.drawBottomRow=function(t){if(this.RTL_)this.steps_+=n.utils.svgPaths.lineOnAxis("V",t.baseline-this.highlightOffset_);else{var e=this.info_.bottomRow.elements[0];n.blockRendering.Types.isLeftSquareCorner(e)?this.steps_+=n.utils.svgPaths.moveTo(t.xPos+this.highlightOffset_,t.baseline-this.highlightOffset_):n.blockRendering.Types.isLeftRoundedCorner(e)&&(this.steps_+=n.utils.svgPaths.moveTo(t.xPos,t.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}},n.geras.Highlighter.prototype.drawLeft=function(){var t=this.info_.outputConnection;t&&(t=t.connectionOffsetY+t.height,this.RTL_?this.steps_+=n.utils.svgPaths.moveTo(this.info_.startX,t):(this.steps_+=n.utils.svgPaths.moveTo(this.info_.startX+this.highlightOffset_,this.info_.bottomRow.baseline-this.highlightOffset_),this.steps_+=n.utils.svgPaths.lineOnAxis("V",t)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(t=this.info_.topRow,n.blockRendering.Types.isLeftRoundedCorner(t.elements[0])?this.steps_+=n.utils.svgPaths.lineOnAxis("V",this.outsideCornerPaths_.height):this.steps_+=n.utils.svgPaths.lineOnAxis("V",t.capline+this.highlightOffset_))},n.geras.Highlighter.prototype.drawInlineInput=function(t){var e=this.highlightOffset_,i=t.xPos+t.connectionWidth,o=t.centerline-t.height/2,r=t.width-t.connectionWidth,s=o+e;this.RTL_?(o=t.connectionOffsetY-e,t=t.height-(t.connectionOffsetY+t.connectionHeight)+e,this.inlineSteps_+=n.utils.svgPaths.moveTo(i-e,s)+n.utils.svgPaths.lineOnAxis("v",o)+this.puzzleTabPaths_.pathDown(this.RTL_)+n.utils.svgPaths.lineOnAxis("v",t)+n.utils.svgPaths.lineOnAxis("h",r)):this.inlineSteps_+=n.utils.svgPaths.moveTo(t.xPos+t.width+e,s)+n.utils.svgPaths.lineOnAxis("v",t.height)+n.utils.svgPaths.lineOnAxis("h",-r)+n.utils.svgPaths.moveTo(i,o+t.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)},n.geras.InlineInput=function(t,e){n.geras.InlineInput.superClass_.constructor.call(this,t,e),this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)},n.utils.object.inherits(n.geras.InlineInput,n.blockRendering.InlineInput),n.geras.StatementInput=function(t,e){n.geras.StatementInput.superClass_.constructor.call(this,t,e),this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)},n.utils.object.inherits(n.geras.StatementInput,n.blockRendering.StatementInput),n.geras.RenderInfo=function(t,e){n.geras.RenderInfo.superClass_.constructor.call(this,t,e)},n.utils.object.inherits(n.geras.RenderInfo,n.blockRendering.RenderInfo),n.geras.RenderInfo.prototype.getRenderer=function(){return this.renderer_},n.geras.RenderInfo.prototype.populateBottomRow_=function(){n.geras.RenderInfo.superClass_.populateBottomRow_.call(this),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1].type==n.NEXT_STATEMENT||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)},n.geras.RenderInfo.prototype.addInput_=function(t,e){this.isInline&&t.type==n.INPUT_VALUE?(e.elements.push(new n.geras.InlineInput(this.constants_,t)),e.hasInlineInput=!0):t.type==n.NEXT_STATEMENT?(e.elements.push(new n.geras.StatementInput(this.constants_,t)),e.hasStatement=!0):t.type==n.INPUT_VALUE?(e.elements.push(new n.blockRendering.ExternalValueInput(this.constants_,t)),e.hasExternalInput=!0):t.type==n.DUMMY_INPUT&&(e.minHeight=Math.max(e.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),e.hasDummyInput=!0),this.isInline||null!=e.align||(e.align=t.align)},n.geras.RenderInfo.prototype.addElemSpacing_=function(){for(var t,e=!1,i=0;t=this.rows[i];i++)t.hasExternalInput&&(e=!0);for(i=0;t=this.rows[i];i++){var o=t.elements;if(t.elements=[],t.startsWithElemSpacer()&&t.elements.push(new n.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(null,o[0]))),o.length){for(var r=0;r<o.length-1;r++){t.elements.push(o[r]);var s=this.getInRowSpacing_(o[r],o[r+1]);t.elements.push(new n.blockRendering.InRowSpacer(this.constants_,s))}t.elements.push(o[o.length-1]),t.endsWithElemSpacer()&&(s=this.getInRowSpacing_(o[o.length-1],null),e&&t.hasDummyInput&&(s+=this.constants_.TAB_WIDTH),t.elements.push(new n.blockRendering.InRowSpacer(this.constants_,s)))}}},n.geras.RenderInfo.prototype.getInRowSpacing_=function(t,e){if(!t)return e&&n.blockRendering.Types.isField(e)&&e.isEditable?this.constants_.MEDIUM_PADDING:e&&n.blockRendering.Types.isInlineInput(e)?this.constants_.MEDIUM_LARGE_PADDING:e&&n.blockRendering.Types.isStatementInput(e)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!n.blockRendering.Types.isInput(t)&&(!e||n.blockRendering.Types.isStatementInput(e)))return n.blockRendering.Types.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:n.blockRendering.Types.isIcon(t)?2*this.constants_.LARGE_PADDING+1:n.blockRendering.Types.isHat(t)?this.constants_.NO_PADDING:n.blockRendering.Types.isPreviousOrNextConnection(t)?this.constants_.LARGE_PADDING:n.blockRendering.Types.isLeftRoundedCorner(t)?this.constants_.MIN_BLOCK_WIDTH:n.blockRendering.Types.isJaggedEdge(t)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(n.blockRendering.Types.isInput(t)&&!e){if(n.blockRendering.Types.isExternalInput(t))return this.constants_.NO_PADDING;if(n.blockRendering.Types.isInlineInput(t))return this.constants_.LARGE_PADDING;if(n.blockRendering.Types.isStatementInput(t))return this.constants_.NO_PADDING}if(!n.blockRendering.Types.isInput(t)&&e&&n.blockRendering.Types.isInput(e)){if(n.blockRendering.Types.isField(t)&&t.isEditable){if(n.blockRendering.Types.isInlineInput(e)||n.blockRendering.Types.isExternalInput(e))return this.constants_.SMALL_PADDING}else{if(n.blockRendering.Types.isInlineInput(e)||n.blockRendering.Types.isExternalInput(e))return this.constants_.MEDIUM_LARGE_PADDING;if(n.blockRendering.Types.isStatementInput(e))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(n.blockRendering.Types.isIcon(t)&&e&&!n.blockRendering.Types.isInput(e))return this.constants_.LARGE_PADDING;if(n.blockRendering.Types.isInlineInput(t)&&e&&n.blockRendering.Types.isField(e))return e.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(n.blockRendering.Types.isLeftSquareCorner(t)&&e){if(n.blockRendering.Types.isHat(e))return this.constants_.NO_PADDING;if(n.blockRendering.Types.isPreviousConnection(e))return e.notchOffset;if(n.blockRendering.Types.isNextConnection(e))return t=(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2,e.notchOffset+t}if(n.blockRendering.Types.isLeftRoundedCorner(t)&&e){if(n.blockRendering.Types.isPreviousConnection(e))return e.notchOffset-this.constants_.CORNER_RADIUS;if(n.blockRendering.Types.isNextConnection(e))return t=(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2,e.notchOffset-this.constants_.CORNER_RADIUS+t}return n.blockRendering.Types.isField(t)&&e&&n.blockRendering.Types.isField(e)&&t.isEditable==e.isEditable||e&&n.blockRendering.Types.isJaggedEdge(e)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},n.geras.RenderInfo.prototype.getSpacerRowHeight_=function(t,e){return n.blockRendering.Types.isTopRow(t)&&n.blockRendering.Types.isBottomRow(e)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:n.blockRendering.Types.isTopRow(t)||n.blockRendering.Types.isBottomRow(e)?this.constants_.NO_PADDING:t.hasExternalInput&&e.hasExternalInput?this.constants_.LARGE_PADDING:!t.hasStatement&&e.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:t.hasStatement&&e.hasStatement||!t.hasStatement&&e.hasDummyInput||t.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},n.geras.RenderInfo.prototype.getElemCenterline_=function(t,e){if(n.blockRendering.Types.isSpacer(e))return t.yPos+e.height/2;if(n.blockRendering.Types.isBottomRow(t))return t=t.yPos+t.height-t.descenderHeight,n.blockRendering.Types.isNextConnection(e)?t+e.height/2:t-e.height/2;if(n.blockRendering.Types.isTopRow(t))return n.blockRendering.Types.isHat(e)?t.capline-e.height/2:t.capline+e.height/2;var i=t.yPos;return n.blockRendering.Types.isField(e)||n.blockRendering.Types.isIcon(e)?(i+=e.height/2,(t.hasInlineInput||t.hasStatement)&&e.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=t.height&&(i+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):i=n.blockRendering.Types.isInlineInput(e)?i+e.height/2:i+t.height/2,i},n.geras.RenderInfo.prototype.alignRowElements_=function(){if(this.isInline){for(var t,e=0,i=null,o=this.rows.length-1;t=this.rows[o];o--)t.nextRightEdge=e,n.blockRendering.Types.isInputRow(t)&&(t.hasStatement&&this.alignStatementRow_(t),i&&i.hasStatement&&t.width<i.width?t.nextRightEdge=i.width:e=t.width,i=t);for(o=e=0;t=this.rows[o];o++)t.hasStatement?e=this.getDesiredRowWidth_(t):n.blockRendering.Types.isSpacer(t)?t.width=Math.max(e,t.nextRightEdge):(0<(e=Math.max(e,t.nextRightEdge)-t.width)&&this.addAlignmentPadding_(t,e),e=t.width)}else n.geras.RenderInfo.superClass_.alignRowElements_.call(this)},n.geras.RenderInfo.prototype.getDesiredRowWidth_=function(t){return this.isInline&&t.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:n.geras.RenderInfo.superClass_.getDesiredRowWidth_.call(this,t)},n.geras.RenderInfo.prototype.finalize_=function(){for(var t,e=0,n=0,i=0;t=this.rows[i];i++){t.yPos=n,t.xPos=this.startX,n+=t.height,e=Math.max(e,t.widthWithConnectedBlocks);var o=n-this.topRow.ascenderHeight;t==this.bottomRow&&o<this.constants_.MIN_BLOCK_HEIGHT&&(o=this.constants_.MIN_BLOCK_HEIGHT-o,this.bottomRow.height+=o,n+=o),this.recordElemPositions_(t)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(e=Math.max(e,this.block_.nextConnection.targetBlock().getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=n-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=n+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline},n.geras.Drawer=function(t,e){n.geras.Drawer.superClass_.constructor.call(this,t,e),this.highlighter_=new n.geras.Highlighter(e)},n.utils.object.inherits(n.geras.Drawer,n.blockRendering.Drawer),n.geras.Drawer.prototype.draw=function(){this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_();var t=this.block_.pathObject;t.setPath(this.outlinePath_+"\n"+this.inlinePath_),t.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&t.flipRTL(),n.blockRendering.useDebugger&&this.block_.renderingDebugger.drawDebug(this.block_,this.info_),this.recordSizeOnBlock_()},n.geras.Drawer.prototype.drawTop_=function(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),n.geras.Drawer.superClass_.drawTop_.call(this)},n.geras.Drawer.prototype.drawJaggedEdge_=function(t){this.highlighter_.drawJaggedEdge_(t),n.geras.Drawer.superClass_.drawJaggedEdge_.call(this,t)},n.geras.Drawer.prototype.drawValueInput_=function(t){this.highlighter_.drawValueInput(t),n.geras.Drawer.superClass_.drawValueInput_.call(this,t)},n.geras.Drawer.prototype.drawStatementInput_=function(t){this.highlighter_.drawStatementInput(t),n.geras.Drawer.superClass_.drawStatementInput_.call(this,t)},n.geras.Drawer.prototype.drawRightSideRow_=function(t){this.highlighter_.drawRightSideRow(t),this.outlinePath_+=n.utils.svgPaths.lineOnAxis("H",t.xPos+t.width)+n.utils.svgPaths.lineOnAxis("V",t.yPos+t.height)},n.geras.Drawer.prototype.drawBottom_=function(){this.highlighter_.drawBottomRow(this.info_.bottomRow),n.geras.Drawer.superClass_.drawBottom_.call(this)},n.geras.Drawer.prototype.drawLeft_=function(){this.highlighter_.drawLeft(),n.geras.Drawer.superClass_.drawLeft_.call(this)},n.geras.Drawer.prototype.drawInlineInput_=function(t){this.highlighter_.drawInlineInput(t),n.geras.Drawer.superClass_.drawInlineInput_.call(this,t)},n.geras.Drawer.prototype.positionInlineInputConnection_=function(t){var e=t.centerline-t.height/2;if(t.connectionModel){var n=t.xPos+t.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(n*=-1),t.connectionModel.setOffsetInBlock(n,e+t.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}},n.geras.Drawer.prototype.positionStatementInputConnection_=function(t){var e=t.getLastInput();if(e.connectionModel){var n=t.xPos+t.statementEdge+e.notchOffset;n=this.info_.RTL?-1*n:n+this.constants_.DARK_PATH_OFFSET,e.connectionModel.setOffsetInBlock(n,t.yPos+this.constants_.DARK_PATH_OFFSET)}},n.geras.Drawer.prototype.positionExternalValueConnection_=function(t){var e=t.getLastInput();if(e.connectionModel){var n=t.xPos+t.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(n*=-1),e.connectionModel.setOffsetInBlock(n,t.yPos)}},n.geras.Drawer.prototype.positionNextConnection_=function(){var t=this.info_.bottomRow;if(t.connection){var e=t.connection,n=e.xPos;e.connectionModel.setOffsetInBlock((this.info_.RTL?-n:n)+this.constants_.DARK_PATH_OFFSET/2,t.baseline+this.constants_.DARK_PATH_OFFSET)}},n.geras.HighlightConstantProvider=function(t){this.constantProvider=t,this.OFFSET=.5,this.START_POINT=n.utils.svgPaths.moveBy(this.OFFSET,this.OFFSET)},n.geras.HighlightConstantProvider.prototype.init=function(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()},n.geras.HighlightConstantProvider.prototype.makeInsideCorner=function(){var t=this.constantProvider.CORNER_RADIUS,e=this.OFFSET,i=(1-Math.SQRT1_2)*(t+e)-e,o=n.utils.svgPaths.moveBy(i,i)+n.utils.svgPaths.arc("a","0 0,0",t,n.utils.svgPaths.point(-i-e,t-i)),r=n.utils.svgPaths.arc("a","0 0,0",t+e,n.utils.svgPaths.point(t+e,t+e)),s=n.utils.svgPaths.moveBy(i,-i)+n.utils.svgPaths.arc("a","0 0,0",t+e,n.utils.svgPaths.point(t-i,i+e));return{width:t+e,height:t,pathTop:function(t){return t?o:""},pathBottom:function(t){return t?r:s}}},n.geras.HighlightConstantProvider.prototype.makeOutsideCorner=function(){var t=this.constantProvider.CORNER_RADIUS,e=this.OFFSET,i=(1-Math.SQRT1_2)*(t-e)+e,o=n.utils.svgPaths.moveBy(i,i)+n.utils.svgPaths.arc("a","0 0,1",t-e,n.utils.svgPaths.point(t-i,-i+e)),r=n.utils.svgPaths.moveBy(e,t)+n.utils.svgPaths.arc("a","0 0,1",t-e,n.utils.svgPaths.point(t,-t+e)),s=-i,a=n.utils.svgPaths.moveBy(i,s)+n.utils.svgPaths.arc("a","0 0,1",t-e,n.utils.svgPaths.point(-i+e,-s-t));return{height:t,topLeft:function(t){return t?o:r},bottomLeft:function(){return a}}},n.geras.HighlightConstantProvider.prototype.makePuzzleTab=function(){var t=this.constantProvider.TAB_WIDTH,e=this.constantProvider.TAB_HEIGHT,i=n.utils.svgPaths.moveBy(-2,3.4-e)+n.utils.svgPaths.lineTo(-.45*t,-2.1),o=n.utils.svgPaths.lineOnAxis("v",2.5)+n.utils.svgPaths.moveBy(.97*-t,2.5)+n.utils.svgPaths.curve("q",[n.utils.svgPaths.point(.05*-t,10),n.utils.svgPaths.point(.3*t,9.5)])+n.utils.svgPaths.moveBy(.67*t,-1.9)+n.utils.svgPaths.lineOnAxis("v",2.5),r=n.utils.svgPaths.lineOnAxis("v",-1.5)+n.utils.svgPaths.moveBy(-.92*t,-.5)+n.utils.svgPaths.curve("q",[n.utils.svgPaths.point(-.19*t,-5.5),n.utils.svgPaths.point(0,-11)])+n.utils.svgPaths.moveBy(.92*t,1),s=n.utils.svgPaths.moveBy(-5,e-.7)+n.utils.svgPaths.lineTo(.46*t,-2.1);return{width:t,height:e,pathUp:function(t){return t?i:r},pathDown:function(t){return t?o:s}}},n.geras.HighlightConstantProvider.prototype.makeNotch=function(){return{pathLeft:n.utils.svgPaths.lineOnAxis("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}},n.geras.HighlightConstantProvider.prototype.makeJaggedTeeth=function(){return{pathLeft:n.utils.svgPaths.lineTo(5.1,2.6)+n.utils.svgPaths.moveBy(-10.2,6.8)+n.utils.svgPaths.lineTo(5.1,2.6),height:12,width:10.2}},n.geras.HighlightConstantProvider.prototype.makeStartHat=function(){var t=this.constantProvider.START_HAT.height,e=n.utils.svgPaths.moveBy(25,-8.7)+n.utils.svgPaths.curve("c",[n.utils.svgPaths.point(29.7,-6.2),n.utils.svgPaths.point(57.2,-.5),n.utils.svgPaths.point(75,8.7)]),i=n.utils.svgPaths.curve("c",[n.utils.svgPaths.point(17.8,-9.2),n.utils.svgPaths.point(45.3,-14.9),n.utils.svgPaths.point(75,-8.7)])+n.utils.svgPaths.moveTo(100.5,t+.5);return{path:function(t){return t?e:i}}},n.geras.PathObject=function(t,e,i){this.constants=i,this.svgRoot=t,this.svgPathDark=n.utils.dom.createSvgElement(n.utils.Svg.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"},this.svgRoot),this.svgPath=n.utils.dom.createSvgElement(n.utils.Svg.PATH,{class:"blocklyPath"},this.svgRoot),this.svgPathLight=n.utils.dom.createSvgElement(n.utils.Svg.PATH,{class:"blocklyPathLight"},this.svgRoot),this.colourDark="#000000",this.style=e},n.utils.object.inherits(n.geras.PathObject,n.blockRendering.PathObject),n.geras.PathObject.prototype.setPath=function(t){this.svgPath.setAttribute("d",t),this.svgPathDark.setAttribute("d",t)},n.geras.PathObject.prototype.setHighlightPath=function(t){this.svgPathLight.setAttribute("d",t)},n.geras.PathObject.prototype.flipRTL=function(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")},n.geras.PathObject.prototype.applyColour=function(t){this.svgPathLight.style.display="",this.svgPathDark.style.display="",this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),n.geras.PathObject.superClass_.applyColour.call(this,t),this.svgPath.setAttribute("stroke","none")},n.geras.PathObject.prototype.setStyle=function(t){this.style=t,this.colourDark=n.utils.colour.blend("#000",this.style.colourPrimary,.2)||this.colourDark},n.geras.PathObject.prototype.updateHighlighted=function(t){t?(this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"),this.svgPathLight.style.display="none"):(this.svgPath.setAttribute("filter","none"),this.svgPathLight.style.display="inline")},n.geras.PathObject.prototype.updateShadow_=function(t){t&&(this.svgPathLight.style.display="none",this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary))},n.geras.PathObject.prototype.updateDisabled_=function(t){n.geras.PathObject.superClass_.updateDisabled_.call(this,t),t&&this.svgPath.setAttribute("stroke","none")},n.geras.Renderer=function(t){n.geras.Renderer.superClass_.constructor.call(this,t),this.highlightConstants_=null},n.utils.object.inherits(n.geras.Renderer,n.blockRendering.Renderer),n.geras.Renderer.prototype.init=function(t,e){n.geras.Renderer.superClass_.init.call(this,t,e),this.highlightConstants_=this.makeHighlightConstants_(),this.highlightConstants_.init()},n.geras.Renderer.prototype.refreshDom=function(t,e){n.geras.Renderer.superClass_.refreshDom.call(this,t,e),this.getHighlightConstants().init()},n.geras.Renderer.prototype.makeConstants_=function(){return new n.geras.ConstantProvider},n.geras.Renderer.prototype.makeRenderInfo_=function(t){return new n.geras.RenderInfo(this,t)},n.geras.Renderer.prototype.makeDrawer_=function(t,e){return new n.geras.Drawer(t,e)},n.geras.Renderer.prototype.makePathObject=function(t,e){return new n.geras.PathObject(t,e,this.getConstants())},n.geras.Renderer.prototype.makeHighlightConstants_=function(){return new n.geras.HighlightConstantProvider(this.getConstants())},n.geras.Renderer.prototype.getHighlightConstants=function(){return this.highlightConstants_},n.blockRendering.register("geras",n.geras.Renderer),n.thrasos={},n.thrasos.RenderInfo=function(t,e){n.thrasos.RenderInfo.superClass_.constructor.call(this,t,e)},n.utils.object.inherits(n.thrasos.RenderInfo,n.blockRendering.RenderInfo),n.thrasos.RenderInfo.prototype.getRenderer=function(){return this.renderer_},n.thrasos.RenderInfo.prototype.addElemSpacing_=function(){for(var t,e=!1,i=0;t=this.rows[i];i++)t.hasExternalInput&&(e=!0);for(i=0;t=this.rows[i];i++){var o=t.elements;t.elements=[],t.startsWithElemSpacer()&&t.elements.push(new n.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(null,o[0])));for(var r=0;r<o.length-1;r++){t.elements.push(o[r]);var s=this.getInRowSpacing_(o[r],o[r+1]);t.elements.push(new n.blockRendering.InRowSpacer(this.constants_,s))}t.elements.push(o[o.length-1]),t.endsWithElemSpacer()&&(s=this.getInRowSpacing_(o[o.length-1],null),e&&t.hasDummyInput&&(s+=this.constants_.TAB_WIDTH),t.elements.push(new n.blockRendering.InRowSpacer(this.constants_,s)))}},n.thrasos.RenderInfo.prototype.getInRowSpacing_=function(t,e){if(!t)return e&&n.blockRendering.Types.isField(e)&&e.isEditable?this.constants_.MEDIUM_PADDING:e&&n.blockRendering.Types.isInlineInput(e)?this.constants_.MEDIUM_LARGE_PADDING:e&&n.blockRendering.Types.isStatementInput(e)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!n.blockRendering.Types.isInput(t)&&!e)return n.blockRendering.Types.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:n.blockRendering.Types.isIcon(t)?2*this.constants_.LARGE_PADDING+1:n.blockRendering.Types.isHat(t)?this.constants_.NO_PADDING:n.blockRendering.Types.isPreviousOrNextConnection(t)?this.constants_.LARGE_PADDING:n.blockRendering.Types.isLeftRoundedCorner(t)?this.constants_.MIN_BLOCK_WIDTH:n.blockRendering.Types.isJaggedEdge(t)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(n.blockRendering.Types.isInput(t)&&!e){if(n.blockRendering.Types.isExternalInput(t))return this.constants_.NO_PADDING;if(n.blockRendering.Types.isInlineInput(t))return this.constants_.LARGE_PADDING;if(n.blockRendering.Types.isStatementInput(t))return this.constants_.NO_PADDING}if(!n.blockRendering.Types.isInput(t)&&e&&n.blockRendering.Types.isInput(e)){if(n.blockRendering.Types.isField(t)&&t.isEditable){if(n.blockRendering.Types.isInlineInput(e)||n.blockRendering.Types.isExternalInput(e))return this.constants_.SMALL_PADDING}else{if(n.blockRendering.Types.isInlineInput(e)||n.blockRendering.Types.isExternalInput(e))return this.constants_.MEDIUM_LARGE_PADDING;if(n.blockRendering.Types.isStatementInput(e))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(n.blockRendering.Types.isIcon(t)&&e&&!n.blockRendering.Types.isInput(e))return this.constants_.LARGE_PADDING;if(n.blockRendering.Types.isInlineInput(t)&&e&&n.blockRendering.Types.isField(e))return e.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(n.blockRendering.Types.isLeftSquareCorner(t)&&e){if(n.blockRendering.Types.isHat(e))return this.constants_.NO_PADDING;if(n.blockRendering.Types.isPreviousConnection(e)||n.blockRendering.Types.isNextConnection(e))return e.notchOffset}return n.blockRendering.Types.isLeftRoundedCorner(t)&&e?e.notchOffset-this.constants_.CORNER_RADIUS:n.blockRendering.Types.isField(t)&&e&&n.blockRendering.Types.isField(e)&&t.isEditable==e.isEditable||e&&n.blockRendering.Types.isJaggedEdge(e)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},n.thrasos.RenderInfo.prototype.getSpacerRowHeight_=function(t,e){return n.blockRendering.Types.isTopRow(t)&&n.blockRendering.Types.isBottomRow(e)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:n.blockRendering.Types.isTopRow(t)||n.blockRendering.Types.isBottomRow(e)?this.constants_.NO_PADDING:t.hasExternalInput&&e.hasExternalInput?this.constants_.LARGE_PADDING:!t.hasStatement&&e.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:t.hasStatement&&e.hasStatement||t.hasDummyInput||e.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},n.thrasos.RenderInfo.prototype.getElemCenterline_=function(t,e){if(n.blockRendering.Types.isSpacer(e))return t.yPos+e.height/2;if(n.blockRendering.Types.isBottomRow(t))return t=t.yPos+t.height-t.descenderHeight,n.blockRendering.Types.isNextConnection(e)?t+e.height/2:t-e.height/2;if(n.blockRendering.Types.isTopRow(t))return n.blockRendering.Types.isHat(e)?t.capline-e.height/2:t.capline+e.height/2;var i=t.yPos;return n.blockRendering.Types.isField(e)&&t.hasStatement?i+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+e.height/2):i+t.height/2},n.thrasos.RenderInfo.prototype.finalize_=function(){for(var t,e=0,n=0,i=0;t=this.rows[i];i++){t.yPos=n,t.xPos=this.startX,n+=t.height,e=Math.max(e,t.widthWithConnectedBlocks);var o=n-this.topRow.ascenderHeight;t==this.bottomRow&&o<this.constants_.MIN_BLOCK_HEIGHT&&(o=this.constants_.MIN_BLOCK_HEIGHT-o,this.bottomRow.height+=o,n+=o),this.recordElemPositions_(t)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(e=Math.max(e,this.block_.nextConnection.targetBlock().getHeightWidth().width)),this.bottomRow.baseline=n-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX,this.height=n,this.startY=this.topRow.capline},n.thrasos.Renderer=function(t){n.thrasos.Renderer.superClass_.constructor.call(this,t)},n.utils.object.inherits(n.thrasos.Renderer,n.blockRendering.Renderer),n.thrasos.Renderer.prototype.makeRenderInfo_=function(t){return new n.thrasos.RenderInfo(this,t)},n.blockRendering.register("thrasos",n.thrasos.Renderer),n.zelos={},n.zelos.ConstantProvider=function(){n.zelos.ConstantProvider.superClass_.constructor.call(this),this.SMALL_PADDING=this.GRID_UNIT=4,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=1*this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TAB_OFFSET_FROM_TOP=0,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:1*this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=!0,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!0,this.FIELD_COLOUR_DEFAULT_WIDTH=2*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=4*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=1*this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter_=null,this.replacementGlowFilterId="",this.replacementGlowFilter_=null},n.utils.object.inherits(n.zelos.ConstantProvider,n.blockRendering.ConstantProvider),n.zelos.ConstantProvider.prototype.setFontConstants_=function(t){n.zelos.ConstantProvider.superClass_.setFontConstants_.call(this,t),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING},n.zelos.ConstantProvider.prototype.init=function(){n.zelos.ConstantProvider.superClass_.init.call(this),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth},n.zelos.ConstantProvider.prototype.setDynamicProperties_=function(t){n.zelos.ConstantProvider.superClass_.setDynamicProperties_.call(this,t),this.SELECTED_GLOW_COLOUR=t.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;var e=Number(t.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=e&&!isNaN(e)?e:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=t.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(t=Number(t.getComponentStyle("replacementGlowSize")))&&!isNaN(t)?t:this.REPLACEMENT_GLOW_SIZE},n.zelos.ConstantProvider.prototype.dispose=function(){n.zelos.ConstantProvider.superClass_.dispose.call(this),this.selectedGlowFilter_&&n.utils.dom.removeNode(this.selectedGlowFilter_),this.replacementGlowFilter_&&n.utils.dom.removeNode(this.replacementGlowFilter_)},n.zelos.ConstantProvider.prototype.makeStartHat=function(){var t=this.START_HAT_HEIGHT,e=this.START_HAT_WIDTH;return{height:t,width:e,path:n.utils.svgPaths.curve("c",[n.utils.svgPaths.point(25,-t),n.utils.svgPaths.point(71,-t),n.utils.svgPaths.point(e,0)])}},n.zelos.ConstantProvider.prototype.makeHexagonal=function(){function t(t,i,o){var r=t/2;return r=r>e?e:r,o=o?-1:1,t=(i?-1:1)*t/2,n.utils.svgPaths.lineTo(-o*r,t)+n.utils.svgPaths.lineTo(o*r,t)}var e=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width:function(t){return(t/=2)>e?e:t},height:function(t){return t},connectionOffsetY:function(t){return t/2},connectionOffsetX:function(t){return-t},pathDown:function(e){return t(e,!1,!1)},pathUp:function(e){return t(e,!0,!1)},pathRightDown:function(e){return t(e,!1,!0)},pathRightUp:function(e){return t(e,!1,!0)}}},n.zelos.ConstantProvider.prototype.makeRounded=function(){function t(t,e,o){var r=t>i?t-i:0;return t=(t>i?i:t)/2,n.utils.svgPaths.arc("a","0 0,1",t,n.utils.svgPaths.point((e?-1:1)*t,(e?-1:1)*t))+n.utils.svgPaths.lineOnAxis("v",(o?1:-1)*r)+n.utils.svgPaths.arc("a","0 0,1",t,n.utils.svgPaths.point((e?1:-1)*t,(e?-1:1)*t))}var e=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,i=2*e;return{type:this.SHAPES.ROUND,isDynamic:!0,width:function(t){return(t/=2)>e?e:t},height:function(t){return t},connectionOffsetY:function(t){return t/2},connectionOffsetX:function(t){return-t},pathDown:function(e){return t(e,!1,!1)},pathUp:function(e){return t(e,!0,!1)},pathRightDown:function(e){return t(e,!1,!0)},pathRightUp:function(e){return t(e,!1,!0)}}},n.zelos.ConstantProvider.prototype.makeSquared=function(){function t(t,i,o){return t-=2*e,n.utils.svgPaths.arc("a","0 0,1",e,n.utils.svgPaths.point((i?-1:1)*e,(i?-1:1)*e))+n.utils.svgPaths.lineOnAxis("v",(o?1:-1)*t)+n.utils.svgPaths.arc("a","0 0,1",e,n.utils.svgPaths.point((i?1:-1)*e,(i?-1:1)*e))}var e=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:!0,width:function(t){return e},height:function(t){return t},connectionOffsetY:function(t){return t/2},connectionOffsetX:function(t){return-t},pathDown:function(e){return t(e,!1,!1)},pathUp:function(e){return t(e,!0,!1)},pathRightDown:function(e){return t(e,!1,!0)},pathRightUp:function(e){return t(e,!1,!0)}}},n.zelos.ConstantProvider.prototype.shapeFor=function(t){var e=t.getCheck();switch(!e&&t.targetConnection&&(e=t.targetConnection.getCheck()),t.type){case n.INPUT_VALUE:case n.OUTPUT_VALUE:if(null!=(t=t.getSourceBlock().getOutputShape()))switch(t){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}return e&&-1!=e.indexOf("Boolean")?this.HEXAGONAL:(e&&-1!=e.indexOf("Number")||e&&e.indexOf("String"),this.ROUNDED);case n.PREVIOUS_STATEMENT:case n.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}},n.zelos.ConstantProvider.prototype.makeNotch=function(){function t(t){return n.utils.svgPaths.curve("c",[n.utils.svgPaths.point(t*r/2,0),n.utils.svgPaths.point(t*r*3/4,a/2),n.utils.svgPaths.point(t*r,a)])+n.utils.svgPaths.line([n.utils.svgPaths.point(t*r,s)])+n.utils.svgPaths.curve("c",[n.utils.svgPaths.point(t*r/4,a/2),n.utils.svgPaths.point(t*r/2,a),n.utils.svgPaths.point(t*r,a)])+n.utils.svgPaths.lineOnAxis("h",t*o)+n.utils.svgPaths.curve("c",[n.utils.svgPaths.point(t*r/2,0),n.utils.svgPaths.point(t*r*3/4,-a/2),n.utils.svgPaths.point(t*r,-a)])+n.utils.svgPaths.line([n.utils.svgPaths.point(t*r,-s)])+n.utils.svgPaths.curve("c",[n.utils.svgPaths.point(t*r/4,-a/2),n.utils.svgPaths.point(t*r/2,-a),n.utils.svgPaths.point(t*r,-a)])}var e=this.NOTCH_WIDTH,i=this.NOTCH_HEIGHT,o=e/3,r=o/3,s=i/2,a=s/2,l=t(1),c=t(-1);return{type:this.SHAPES.NOTCH,width:e,height:i,pathLeft:l,pathRight:c}},n.zelos.ConstantProvider.prototype.makeInsideCorners=function(){var t=this.CORNER_RADIUS,e=n.utils.svgPaths.arc("a","0 0,0",t,n.utils.svgPaths.point(-t,t)),i=n.utils.svgPaths.arc("a","0 0,1",t,n.utils.svgPaths.point(-t,t));return{width:t,height:t,pathTop:e,pathBottom:n.utils.svgPaths.arc("a","0 0,0",t,n.utils.svgPaths.point(t,t)),rightWidth:t,rightHeight:t,pathTopRight:i,pathBottomRight:n.utils.svgPaths.arc("a","0 0,1",t,n.utils.svgPaths.point(t,t))}},n.zelos.ConstantProvider.prototype.generateSecondaryColour_=function(t){return n.utils.colour.blend("#000",t,.15)||t},n.zelos.ConstantProvider.prototype.generateTertiaryColour_=function(t){return n.utils.colour.blend("#000",t,.25)||t},n.zelos.ConstantProvider.prototype.createDom=function(t,e,i){n.zelos.ConstantProvider.superClass_.createDom.call(this,t,e,i),t=n.utils.dom.createSvgElement(n.utils.Svg.DEFS,{},t),e=n.utils.dom.createSvgElement(n.utils.Svg.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},t),n.utils.dom.createSvgElement(n.utils.Svg.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},e),i=n.utils.dom.createSvgElement(n.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},e),n.utils.dom.createSvgElement(n.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},i),n.utils.dom.createSvgElement(n.utils.Svg.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},e),n.utils.dom.createSvgElement(n.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),this.selectedGlowFilterId=e.id,this.selectedGlowFilter_=e,t=n.utils.dom.createSvgElement(n.utils.Svg.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},t),n.utils.dom.createSvgElement(n.utils.Svg.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},t),e=n.utils.dom.createSvgElement(n.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},t),n.utils.dom.createSvgElement(n.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},e),n.utils.dom.createSvgElement(n.utils.Svg.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},t),n.utils.dom.createSvgElement(n.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),n.utils.dom.createSvgElement(n.utils.Svg.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},t),this.replacementGlowFilterId=t.id,this.replacementGlowFilter_=t},n.zelos.ConstantProvider.prototype.getCSS_=function(t){return[t+" .blocklyText,",t+" .blocklyFlyoutLabelText {","font: "+this.FIELD_TEXT_FONTWEIGHT+" "+this.FIELD_TEXT_FONTSIZE+"pt "+this.FIELD_TEXT_FONTFAMILY+";","}",t+" .blocklyText {","fill: #fff;","}",t+" .blocklyNonEditableText>rect:not(.blocklyDropdownRect),",t+" .blocklyEditableText>rect:not(.blocklyDropdownRect) {","fill: "+this.FIELD_BORDER_RECT_COLOUR+";","}",t+" .blocklyNonEditableText>text,",t+" .blocklyEditableText>text,",t+" .blocklyNonEditableText>g>text,",t+" .blocklyEditableText>g>text {","fill: #575E75;","}",t+" .blocklyFlyoutLabelText {","fill: #575E75;","}",t+" .blocklyText.blocklyBubbleText {","fill: #575E75;","}",t+" .blocklyDraggable:not(.blocklyDisabled)"," .blocklyEditableText:not(.editing):hover>rect,",t+" .blocklyDraggable:not(.blocklyDisabled)"," .blocklyEditableText:not(.editing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}",t+" .blocklyHtmlInput {","font-family: "+this.FIELD_TEXT_FONTFAMILY+";","font-weight: "+this.FIELD_TEXT_FONTWEIGHT+";","color: #575E75;","}",t+" .blocklyDropdownText {","fill: #fff !important;","}",t+".blocklyWidgetDiv .goog-menuitem,",t+".blocklyDropDownDiv .goog-menuitem {","font-family: "+this.FIELD_TEXT_FONTFAMILY+";","}",t+".blocklyDropDownDiv .goog-menuitem-content {","color: #fff;","}",t+" .blocklyHighlightedConnectionPath {","stroke: "+this.SELECTED_GLOW_COLOUR+";","}",t+" .blocklyDisabled > .blocklyOutlinePath {","fill: url(#blocklyDisabledPattern"+this.randomIdentifier+")","}",t+" .blocklyInsertionMarker>.blocklyPath {","fill-opacity: "+this.INSERTION_MARKER_OPACITY+";","stroke: none;","}"]},n.zelos.TopRow=function(t){n.zelos.TopRow.superClass_.constructor.call(this,t)},n.utils.object.inherits(n.zelos.TopRow,n.blockRendering.TopRow),n.zelos.TopRow.prototype.endsWithElemSpacer=function(){return!1},n.zelos.TopRow.prototype.hasLeftSquareCorner=function(t){var e=(t.hat?"cap"===t.hat:this.constants_.ADD_START_HATS)&&!t.outputConnection&&!t.previousConnection;return!!t.outputConnection||e},n.zelos.TopRow.prototype.hasRightSquareCorner=function(t){return!!t.outputConnection&&!t.statementInputCount&&!t.nextConnection},n.zelos.BottomRow=function(t){n.zelos.BottomRow.superClass_.constructor.call(this,t)},n.utils.object.inherits(n.zelos.BottomRow,n.blockRendering.BottomRow),n.zelos.BottomRow.prototype.endsWithElemSpacer=function(){return!1},n.zelos.BottomRow.prototype.hasLeftSquareCorner=function(t){return!!t.outputConnection},n.zelos.BottomRow.prototype.hasRightSquareCorner=function(t){return!!t.outputConnection&&!t.statementInputCount&&!t.nextConnection},n.zelos.RightConnectionShape=function(t){n.zelos.RightConnectionShape.superClass_.constructor.call(this,t),this.type|=n.blockRendering.Types.getType("RIGHT_CONNECTION"),this.width=this.height=0},n.utils.object.inherits(n.zelos.RightConnectionShape,n.blockRendering.Measurable),n.zelos.StatementInput=function(t,e){if(n.zelos.StatementInput.superClass_.constructor.call(this,t,e),this.connectedBlock){for(t=this.connectedBlock;t.getNextBlock();)t=t.getNextBlock();t.nextConnection||(this.height=this.connectedBlockHeight,this.connectedBottomNextConnection=!0)}},n.utils.object.inherits(n.zelos.StatementInput,n.blockRendering.StatementInput),n.zelos.RenderInfo=function(t,e){n.zelos.RenderInfo.superClass_.constructor.call(this,t,e),this.topRow=new n.zelos.TopRow(this.constants_),this.bottomRow=new n.zelos.BottomRow(this.constants_),this.isInline=!0,this.isMultiRow=!e.getInputsInline()||e.isCollapsed(),this.hasStatementInput=0<e.statementInputCount,this.rightSide=this.outputConnection?new n.zelos.RightConnectionShape(this.constants_):null},n.utils.object.inherits(n.zelos.RenderInfo,n.blockRendering.RenderInfo),n.zelos.RenderInfo.prototype.getRenderer=function(){return this.renderer_},n.zelos.RenderInfo.prototype.measure=function(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()},n.zelos.RenderInfo.prototype.shouldStartNewRow_=function(t,e){return!!e&&(t.type==n.NEXT_STATEMENT||e.type==n.NEXT_STATEMENT||(t.type==n.INPUT_VALUE||t.type==n.DUMMY_INPUT)&&(!this.isInline||this.isMultiRow))},n.zelos.RenderInfo.prototype.getDesiredRowWidth_=function(t){return t.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):n.zelos.RenderInfo.superClass_.getDesiredRowWidth_.call(this,t)},n.zelos.RenderInfo.prototype.getInRowSpacing_=function(t,e){return t&&e||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!t&&e&&n.blockRendering.Types.isStatementInput(e)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:t&&n.blockRendering.Types.isLeftRoundedCorner(t)&&e&&(n.blockRendering.Types.isPreviousConnection(e)||n.blockRendering.Types.isNextConnection(e))?e.notchOffset-this.constants_.CORNER_RADIUS:t&&n.blockRendering.Types.isLeftSquareCorner(t)&&e&&n.blockRendering.Types.isHat(e)?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING},n.zelos.RenderInfo.prototype.getSpacerRowHeight_=function(t,e){if(n.blockRendering.Types.isTopRow(t)&&n.blockRendering.Types.isBottomRow(e))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;var i=n.blockRendering.Types.isInputRow(t)&&t.hasStatement,o=n.blockRendering.Types.isInputRow(e)&&e.hasStatement;return o||i?(t=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),o&&i?Math.max(t,this.constants_.DUMMY_INPUT_MIN_HEIGHT):t):n.blockRendering.Types.isTopRow(t)?t.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):n.blockRendering.Types.isBottomRow(e)?this.outputConnection?!e.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING},n.zelos.RenderInfo.prototype.getSpacerRowWidth_=function(t,e){var i=this.width-this.startX;return n.blockRendering.Types.isInputRow(t)&&t.hasStatement||n.blockRendering.Types.isInputRow(e)&&e.hasStatement?Math.max(i,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):i},n.zelos.RenderInfo.prototype.getElemCenterline_=function(t,e){if(t.hasStatement&&!n.blockRendering.Types.isSpacer(e)&&!n.blockRendering.Types.isStatementInput(e))return t.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(n.blockRendering.Types.isInlineInput(e)){var i=e.connectedBlock;if(i&&i.outputConnection&&i.nextConnection)return t.yPos+i.height/2}return n.zelos.RenderInfo.superClass_.getElemCenterline_.call(this,t,e)},n.zelos.RenderInfo.prototype.addInput_=function(t,e){t.type==n.DUMMY_INPUT&&e.hasDummyInput&&e.align==n.ALIGN_LEFT&&t.align==n.ALIGN_RIGHT&&(e.rightAlignedDummyInput=t),n.zelos.RenderInfo.superClass_.addInput_.call(this,t,e)},n.zelos.RenderInfo.prototype.addAlignmentPadding_=function(t,e){if(t.rightAlignedDummyInput){for(var i,o,r=0;(o=t.elements[r])&&(n.blockRendering.Types.isSpacer(o)&&(i=o),!n.blockRendering.Types.isField(o)||o.parentInput!=t.rightAlignedDummyInput);r++);if(i)return i.width+=e,void(t.width+=e)}n.zelos.RenderInfo.superClass_.addAlignmentPadding_.call(this,t,e)},n.zelos.RenderInfo.prototype.adjustXPosition_=function(){for(var t=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH,e=t,i=2;i<this.rows.length-1;i+=2){var o=this.rows[i-1],r=this.rows[i],s=this.rows[i+1];if(o=2==i?!!this.topRow.hasPreviousConnection:!!o.followsStatement,s=i+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!s.precedesStatement,n.blockRendering.Types.isInputRow(r)&&r.hasStatement)r.measure(),e=r.width-r.getLastInput().width+t;else if(o&&(2==i||s)&&n.blockRendering.Types.isInputRow(r)&&!r.hasStatement){s=r.xPos,o=null;for(var a,l=0;a=r.elements[l];l++)n.blockRendering.Types.isSpacer(a)&&(o=a),!(o&&(n.blockRendering.Types.isField(a)||n.blockRendering.Types.isInput(a))&&s<e)||n.blockRendering.Types.isField(a)&&(a.field instanceof n.FieldLabel||a.field instanceof n.FieldImage)||(o.width+=e-s),s+=a.width}}},n.zelos.RenderInfo.prototype.finalizeOutputConnection_=function(){if(this.outputConnection&&this.outputConnection.isDynamicShape){for(var t,e=0,n=0;t=this.rows[n];n++)t.yPos=e,e+=t.height;this.height=e,n=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height,e=this.outputConnection.shape.height(n),n=this.outputConnection.shape.width(n),this.outputConnection.height=e,this.outputConnection.width=n,this.outputConnection.startX=n,this.outputConnection.connectionOffsetY=this.outputConnection.shape.connectionOffsetY(e),this.outputConnection.connectionOffsetX=this.outputConnection.shape.connectionOffsetX(n),t=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(t=n,this.rightSide.height=e,this.rightSide.width=t,this.rightSide.centerline=e/2,this.rightSide.xPos=this.width+t),this.startX=n,this.width+=n+t,this.widthWithChildren+=n+t}},n.zelos.RenderInfo.prototype.finalizeHorizontalAlignment_=function(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var t,e=0,i=0;t=this.rows[i];i++)if(n.blockRendering.Types.isInputRow(t)){e=t.elements[t.elements.length-2];var o=this.getNegativeSpacing_(t.elements[1]),r=this.getNegativeSpacing_(e);e=o+r;var s=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-e<s&&(o=(e=this.width-s)/2,r=e/2),t.elements.unshift(new n.blockRendering.InRowSpacer(this.constants_,-o)),t.elements.push(new n.blockRendering.InRowSpacer(this.constants_,-r))}if(e)for(this.width-=e,this.widthWithChildren-=e,this.rightSide.xPos-=e,i=0;t=this.rows[i];i++)n.blockRendering.Types.isTopOrBottomRow(t)&&(t.elements[1].width-=e,t.elements[1].widthWithConnectedBlocks-=e),t.width-=e,t.widthWithConnectedBlocks-=e}},n.zelos.RenderInfo.prototype.getNegativeSpacing_=function(t){if(!t)return 0;var e=this.outputConnection.width,i=this.outputConnection.shape.type,o=this.constants_;if(this.isMultiRow&&1<this.inputRows.length)switch(i){case o.SHAPES.ROUND:return i=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,e-(i=this.height/2>i?i:this.height/2)*(1-Math.sin(Math.acos((i-this.constants_.SMALL_PADDING)/i)));default:return 0}if(n.blockRendering.Types.isInlineInput(t)){var r=t.connectedBlock;return t=r?r.pathObject.outputShapeType:t.shape.type,r&&r.outputConnection&&(r.statementInputCount||r.nextConnection)||i==o.SHAPES.HEXAGONAL&&i!=t?0:e-this.constants_.SHAPE_IN_SHAPE_PADDING[i][t]}return n.blockRendering.Types.isField(t)?i==o.SHAPES.ROUND&&t.field instanceof n.FieldTextInput?e-2.75*o.GRID_UNIT:e-this.constants_.SHAPE_IN_SHAPE_PADDING[i][0]:n.blockRendering.Types.isIcon(t)?this.constants_.SMALL_PADDING:0},n.zelos.RenderInfo.prototype.finalizeVerticalAlignment_=function(){if(!this.outputConnection)for(var t=2;t<this.rows.length-1;t+=2){var e=this.rows[t-1],i=this.rows[t],o=this.rows[t+1],r=2==t,s=t+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!o.precedesStatement;if(r?this.topRow.hasPreviousConnection:e.followsStatement){var a=3==i.elements.length&&(i.elements[1].field instanceof n.FieldLabel||i.elements[1].field instanceof n.FieldImage);if(!r&&a)e.height-=this.constants_.SMALL_PADDING,o.height-=this.constants_.SMALL_PADDING,i.height-=this.constants_.MEDIUM_PADDING;else if(r||s){if(s){for(r=!1,s=0;a=i.elements[s];s++)if(n.blockRendering.Types.isInlineInput(a)&&a.connectedBlock&&!a.connectedBlock.isShadow()&&40<=a.connectedBlock.getHeightWidth().height){r=!0;break}r&&(e.height-=this.constants_.SMALL_PADDING,o.height-=this.constants_.SMALL_PADDING)}}else e.height+=this.constants_.SMALL_PADDING}}},n.zelos.RenderInfo.prototype.finalize_=function(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),n.zelos.RenderInfo.superClass_.finalize_.call(this),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)},n.zelos.Drawer=function(t,e){n.zelos.Drawer.superClass_.constructor.call(this,t,e)},n.utils.object.inherits(n.zelos.Drawer,n.blockRendering.Drawer),n.zelos.Drawer.prototype.draw=function(){var t=this.block_.pathObject;t.beginDrawing(),this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_(),t.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&t.flipRTL(),n.blockRendering.useDebugger&&this.block_.renderingDebugger.drawDebug(this.block_,this.info_),this.recordSizeOnBlock_(),this.info_.outputConnection&&(t.outputShapeType=this.info_.outputConnection.shape.type),t.endDrawing()},n.zelos.Drawer.prototype.drawOutline_=function(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):n.zelos.Drawer.superClass_.drawOutline_.call(this)},n.zelos.Drawer.prototype.drawLeft_=function(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():n.zelos.Drawer.superClass_.drawLeft_.call(this)},n.zelos.Drawer.prototype.drawRightSideRow_=function(t){if(!(0>=t.height))if(t.precedesStatement||t.followsStatement){var e=this.constants_.INSIDE_CORNERS.rightHeight;e=t.height-(t.precedesStatement?e:0),this.outlinePath_+=(t.followsStatement?this.constants_.INSIDE_CORNERS.pathBottomRight:"")+(0<e?n.utils.svgPaths.lineOnAxis("V",t.yPos+e):"")+(t.precedesStatement?this.constants_.INSIDE_CORNERS.pathTopRight:"")}else this.outlinePath_+=n.utils.svgPaths.lineOnAxis("V",t.yPos+t.height)},n.zelos.Drawer.prototype.drawRightDynamicConnection_=function(){this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)},n.zelos.Drawer.prototype.drawLeftDynamicConnection_=function(){this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"},n.zelos.Drawer.prototype.drawFlatTop_=function(){var t=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=n.utils.svgPaths.moveBy(t.xPos,this.info_.startY),this.outlinePath_+=n.utils.svgPaths.lineOnAxis("h",t.width)},n.zelos.Drawer.prototype.drawFlatBottom_=function(){var t=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=n.utils.svgPaths.lineOnAxis("V",t.baseline),this.outlinePath_+=n.utils.svgPaths.lineOnAxis("h",-t.width)},n.zelos.Drawer.prototype.drawInlineInput_=function(t){this.positionInlineInputConnection_(t);var e=t.input.name;if(!t.connectedBlock&&!this.info_.isInsertionMarker){var i=t.width-2*t.connectionWidth;t=n.utils.svgPaths.moveTo(t.xPos+t.connectionWidth,t.centerline-t.height/2)+n.utils.svgPaths.lineOnAxis("h",i)+t.shape.pathRightDown(t.height)+n.utils.svgPaths.lineOnAxis("h",-i)+t.shape.pathUp(t.height)+"z",this.block_.pathObject.setOutlinePath(e,t)}},n.zelos.Drawer.prototype.drawStatementInput_=function(t){var e=t.getLastInput(),i=e.xPos+e.notchOffset+e.shape.width,o=e.shape.pathRight+n.utils.svgPaths.lineOnAxis("h",-(e.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop,r=t.height-2*this.constants_.INSIDE_CORNERS.height;e=this.constants_.INSIDE_CORNERS.pathBottom+n.utils.svgPaths.lineOnAxis("h",e.notchOffset-this.constants_.INSIDE_CORNERS.width)+(e.connectedBottomNextConnection?"":e.shape.pathLeft),this.outlinePath_+=n.utils.svgPaths.lineOnAxis("H",i)+o+n.utils.svgPaths.lineOnAxis("v",r)+e+n.utils.svgPaths.lineOnAxis("H",t.xPos+t.width),this.positionStatementInputConnection_(t)},n.zelos.PathObject=function(t,e,i){n.zelos.PathObject.superClass_.constructor.call(this,t,e,i),this.constants=i,this.svgPathSelected_=null,this.outlines_={},this.outputShapeType=this.remainingOutlines_=null},n.utils.object.inherits(n.zelos.PathObject,n.blockRendering.PathObject),n.zelos.PathObject.prototype.setPath=function(t){n.zelos.PathObject.superClass_.setPath.call(this,t),this.svgPathSelected_&&this.svgPathSelected_.setAttribute("d",t)},n.zelos.PathObject.prototype.applyColour=function(t){n.zelos.PathObject.superClass_.applyColour.call(this,t),t.isShadow()&&t.getParent()&&this.svgPath.setAttribute("stroke",t.getParent().style.colourTertiary),t=0;for(var e,i=Object.keys(this.outlines_);e=i[t];t++)this.outlines_[e].setAttribute("fill",this.style.colourTertiary)},n.zelos.PathObject.prototype.flipRTL=function(){n.zelos.PathObject.superClass_.flipRTL.call(this);for(var t,e=0,i=Object.keys(this.outlines_);t=i[e];e++)this.outlines_[t].setAttribute("transform","scale(-1 1)")},n.zelos.PathObject.prototype.updateSelected=function(t){this.setClass_("blocklySelected",t),t?this.svgPathSelected_||(this.svgPathSelected_=this.svgPath.cloneNode(!0),this.svgPathSelected_.setAttribute("fill","none"),this.svgPathSelected_.setAttribute("filter","url(#"+this.constants.selectedGlowFilterId+")"),this.svgRoot.appendChild(this.svgPathSelected_)):this.svgPathSelected_&&(this.svgRoot.removeChild(this.svgPathSelected_),this.svgPathSelected_=null)},n.zelos.PathObject.prototype.updateReplacementFade=function(t){this.setClass_("blocklyReplaceable",t),t?this.svgPath.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):this.svgPath.removeAttribute("filter")},n.zelos.PathObject.prototype.updateShapeForInputHighlight=function(t,e){t=t.getParentInput().name,(t=this.getOutlinePath_(t))&&(e?t.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):t.removeAttribute("filter"))},n.zelos.PathObject.prototype.beginDrawing=function(){this.remainingOutlines_={};for(var t,e=0,n=Object.keys(this.outlines_);t=n[e];e++)this.remainingOutlines_[t]=1},n.zelos.PathObject.prototype.endDrawing=function(){if(this.remainingOutlines_)for(var t,e=0,n=Object.keys(this.remainingOutlines_);t=n[e];e++)this.removeOutlinePath_(t);this.remainingOutlines_=null},n.zelos.PathObject.prototype.setOutlinePath=function(t,e){(t=this.getOutlinePath_(t)).setAttribute("d",e),t.setAttribute("fill",this.style.colourTertiary)},n.zelos.PathObject.prototype.getOutlinePath_=function(t){return this.outlines_[t]||(this.outlines_[t]=n.utils.dom.createSvgElement(n.utils.Svg.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines_&&delete this.remainingOutlines_[t],this.outlines_[t]},n.zelos.PathObject.prototype.removeOutlinePath_=function(t){this.outlines_[t].parentNode.removeChild(this.outlines_[t]),delete this.outlines_[t]},n.zelos.MarkerSvg=function(t,e,i){n.zelos.MarkerSvg.superClass_.constructor.call(this,t,e,i)},n.utils.object.inherits(n.zelos.MarkerSvg,n.blockRendering.MarkerSvg),n.zelos.MarkerSvg.prototype.showWithInputOutput_=function(t){var e=t.getSourceBlock();t=t.getLocation().getOffsetInBlock(),this.positionCircle_(t.x,t.y),this.setParent_(e),this.showCurrent_()},n.zelos.MarkerSvg.prototype.showWithOutput_=function(t){this.showWithInputOutput_(t)},n.zelos.MarkerSvg.prototype.showWithInput_=function(t){this.showWithInputOutput_(t)},n.zelos.MarkerSvg.prototype.showWithBlock_=function(t){var e=(t=t.getLocation()).getHeightWidth();this.positionRect_(0,0,e.width,e.height),this.setParent_(t),this.showCurrent_()},n.zelos.MarkerSvg.prototype.positionCircle_=function(t,e){this.markerCircle_.setAttribute("cx",t),this.markerCircle_.setAttribute("cy",e),this.currentMarkerSvg=this.markerCircle_},n.zelos.MarkerSvg.prototype.hide=function(){n.zelos.MarkerSvg.superClass_.hide.call(this),this.markerCircle_.style.display="none"},n.zelos.MarkerSvg.prototype.createDomInternal_=function(){if(n.zelos.MarkerSvg.superClass_.createDomInternal_.call(this),this.markerCircle_=n.utils.dom.createSvgElement(n.utils.Svg.CIRCLE,{r:this.constants_.CURSOR_RADIUS,style:"display: none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.isCursor()){var t=this.getBlinkProperties_();n.utils.dom.createSvgElement(n.utils.Svg.ANIMATE,t,this.markerCircle_)}return this.markerSvg_},n.zelos.MarkerSvg.prototype.applyColour_=function(t){n.zelos.MarkerSvg.superClass_.applyColour_.call(this,t),this.markerCircle_.setAttribute("fill",this.colour_),this.markerCircle_.setAttribute("stroke",this.colour_),this.isCursor()&&this.markerCircle_.firstChild.setAttribute("values",this.colour_+";transparent;transparent;")},n.zelos.Renderer=function(t){n.zelos.Renderer.superClass_.constructor.call(this,t)},n.utils.object.inherits(n.zelos.Renderer,n.blockRendering.Renderer),n.zelos.Renderer.prototype.makeConstants_=function(){return new n.zelos.ConstantProvider},n.zelos.Renderer.prototype.makeRenderInfo_=function(t){return new n.zelos.RenderInfo(this,t)},n.zelos.Renderer.prototype.makeDrawer_=function(t,e){return new n.zelos.Drawer(t,e)},n.zelos.Renderer.prototype.makeMarkerDrawer=function(t,e){return new n.zelos.MarkerSvg(t,this.getConstants(),e)},n.zelos.Renderer.prototype.makePathObject=function(t,e){return new n.zelos.PathObject(t,e,this.getConstants())},n.zelos.Renderer.prototype.shouldHighlightConnection=function(t){return t.type!=n.INPUT_VALUE&&t.type!==n.OUTPUT_VALUE},n.zelos.Renderer.prototype.getConnectionPreviewMethod=function(t,e,i){return e.type==n.OUTPUT_VALUE?t.isConnected()?n.InsertionMarkerManager.PREVIEW_TYPE.REPLACEMENT_FADE:n.InsertionMarkerManager.PREVIEW_TYPE.INPUT_OUTLINE:n.zelos.Renderer.superClass_.getConnectionPreviewMethod(t,e,i)},n.blockRendering.register("zelos",n.zelos.Renderer),n.Themes.Dark=n.Theme.defineTheme("dark",{base:n.Themes.Classic,componentStyles:{workspaceBackgroundColour:"#1e1e1e",toolboxBackgroundColour:"blackBackground",toolboxForegroundColour:"#fff",flyoutBackgroundColour:"#252526",flyoutForegroundColour:"#ccc",flyoutOpacity:1,scrollbarColour:"#797979",insertionMarkerColour:"#fff",insertionMarkerOpacity:.3,scrollbarOpacity:.4,cursorColour:"#d0d0d0",blackBackground:"#333"}}),n.Themes.Deuteranopia={},n.Themes.Deuteranopia.defaultBlockStyles={colour_blocks:{colourPrimary:"#f2a72c",colourSecondary:"#f1c172",colourTertiary:"#da921c"},list_blocks:{colourPrimary:"#7d65ab",colourSecondary:"#a88be0",colourTertiary:"#66518e"},logic_blocks:{colourPrimary:"#9fd2f1",colourSecondary:"#c0e0f4",colourTertiary:"#74bae5"},loop_blocks:{colourPrimary:"#795a07",colourSecondary:"#ac8726",colourTertiary:"#c4a03f"},math_blocks:{colourPrimary:"#e6da39",colourSecondary:"#f3ec8e",colourTertiary:"#f2eeb7"},procedure_blocks:{colourPrimary:"#590721",colourSecondary:"#8c475d",colourTertiary:"#885464"},text_blocks:{colourPrimary:"#058863",colourSecondary:"#5ecfaf",colourTertiary:"#04684c"},variable_blocks:{colourPrimary:"#47025a",colourSecondary:"#820fa1",colourTertiary:"#8e579d"},variable_dynamic_blocks:{colourPrimary:"#47025a",colourSecondary:"#820fa1",colourTertiary:"#8e579d"}},n.Themes.Deuteranopia.categoryStyles={colour_category:{colour:"#f2a72c"},list_category:{colour:"#7d65ab"},logic_category:{colour:"#9fd2f1"},loop_category:{colour:"#795a07"},math_category:{colour:"#e6da39"},procedure_category:{colour:"#590721"},text_category:{colour:"#058863"},variable_category:{colour:"#47025a"},variable_dynamic_category:{colour:"#47025a"}},n.Themes.Deuteranopia=new n.Theme("deuteranopia",n.Themes.Deuteranopia.defaultBlockStyles,n.Themes.Deuteranopia.categoryStyles),n.Themes.HighContrast={},n.Themes.HighContrast.defaultBlockStyles={colour_blocks:{colourPrimary:"#a52714",colourSecondary:"#FB9B8C",colourTertiary:"#FBE1DD"},list_blocks:{colourPrimary:"#4a148c",colourSecondary:"#AD7BE9",colourTertiary:"#CDB6E9"},logic_blocks:{colourPrimary:"#01579b",colourSecondary:"#64C7FF",colourTertiary:"#C5EAFF"},loop_blocks:{colourPrimary:"#33691e",colourSecondary:"#9AFF78",colourTertiary:"#E1FFD7"},math_blocks:{colourPrimary:"#1a237e",colourSecondary:"#8A9EFF",colourTertiary:"#DCE2FF"},procedure_blocks:{colourPrimary:"#006064",colourSecondary:"#77E6EE",colourTertiary:"#CFECEE"},text_blocks:{colourPrimary:"#004d40",colourSecondary:"#5ae27c",colourTertiary:"#D2FFDD"},variable_blocks:{colourPrimary:"#880e4f",colourSecondary:"#FF73BE",colourTertiary:"#FFD4EB"},variable_dynamic_blocks:{colourPrimary:"#880e4f",colourSecondary:"#FF73BE",colourTertiary:"#FFD4EB"},hat_blocks:{colourPrimary:"#880e4f",colourSecondary:"#FF73BE",colourTertiary:"#FFD4EB",hat:"cap"}},n.Themes.HighContrast.categoryStyles={colour_category:{colour:"#a52714"},list_category:{colour:"#4a148c"},logic_category:{colour:"#01579b"},loop_category:{colour:"#33691e"},math_category:{colour:"#1a237e"},procedure_category:{colour:"#006064"},text_category:{colour:"#004d40"},variable_category:{colour:"#880e4f"},variable_dynamic_category:{colour:"#880e4f"}},n.Themes.HighContrast=new n.Theme("highcontrast",n.Themes.HighContrast.defaultBlockStyles,n.Themes.HighContrast.categoryStyles),n.Themes.HighContrast.setComponentStyle("selectedGlowColour","#000000"),n.Themes.HighContrast.setComponentStyle("selectedGlowSize",1),n.Themes.HighContrast.setComponentStyle("replacementGlowColour","#000000"),n.Themes.HighContrast.setFontStyle({family:null,weight:null,size:16}),n.Themes.Tritanopia={},n.Themes.Tritanopia.defaultBlockStyles={colour_blocks:{colourPrimary:"#05427f",colourSecondary:"#2974c0",colourTertiary:"#2d74bb"},list_blocks:{colourPrimary:"#b69ce8",colourSecondary:"#ccbaef",colourTertiary:"#9176c5"},logic_blocks:{colourPrimary:"#9fd2f1",colourSecondary:"#c0e0f4",colourTertiary:"#74bae5"},loop_blocks:{colourPrimary:"#aa1846",colourSecondary:"#d36185",colourTertiary:"#7c1636"},math_blocks:{colourPrimary:"#e6da39",colourSecondary:"#f3ec8e",colourTertiary:"#f2eeb7"},procedure_blocks:{colourPrimary:"#590721",colourSecondary:"#8c475d",colourTertiary:"#885464"},text_blocks:{colourPrimary:"#058863",colourSecondary:"#5ecfaf",colourTertiary:"#04684c"},variable_blocks:{colourPrimary:"#4b2d84",colourSecondary:"#816ea7",colourTertiary:"#83759e"},variable_dynamic_blocks:{colourPrimary:"#4b2d84",colourSecondary:"#816ea7",colourTertiary:"#83759e"}},n.Themes.Tritanopia.categoryStyles={colour_category:{colour:"#05427f"},list_category:{colour:"#b69ce8"},logic_category:{colour:"#9fd2f1"},loop_category:{colour:"#aa1846"},math_category:{colour:"#e6da39"},procedure_category:{colour:"#590721"},text_category:{colour:"#058863"},variable_category:{colour:"#4b2d84"},variable_dynamic_category:{colour:"#4b2d84"}},n.Themes.Tritanopia=new n.Theme("tritanopia",n.Themes.Tritanopia.defaultBlockStyles,n.Themes.Tritanopia.categoryStyles),n.requires={},n)})),wP=IP((function(t,e){t.exports=kP})),AP=SP(OP),DP=IP((function(t){!function(e){if(e.setLocale=function(t){e.Msg=e.Msg||{},Object.keys(t).forEach((function(n){e.Msg[n]=t[n]}))},"object"!=typeof e.utils.global.document){e.utils.global.DOMParser=AP.DOMParser,e.utils.global.XMLSerializer=AP.XMLSerializer;var n=e.utils.xml.textToDomDocument('<xml xmlns="https://developers.google.com/blockly/xml"></xml>');e.utils.xml.document=function(){return n}}t.exports=e}(wP)})),NP=IP((function(t,e){var n;t.exports=(n=DP,(n={Msg:{}}).Msg.ADD_COMMENT="Add Comment",n.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="Can't delete the variable '%1' because it's part of the definition of the function '%2'",n.Msg.CHANGE_VALUE_TITLE="Change value:",n.Msg.CLEAN_UP="Clean up Blocks",n.Msg.COLLAPSED_WARNINGS_WARNING="Collapsed blocks contain warnings.",n.Msg.COLLAPSE_ALL="Collapse Blocks",n.Msg.COLLAPSE_BLOCK="Collapse Block",n.Msg.COLOUR_BLEND_COLOUR1="colour 1",n.Msg.COLOUR_BLEND_COLOUR2="colour 2",n.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",n.Msg.COLOUR_BLEND_RATIO="ratio",n.Msg.COLOUR_BLEND_TITLE="blend",n.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",n.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",n.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",n.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",n.Msg.COLOUR_RANDOM_TITLE="random colour",n.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",n.Msg.COLOUR_RGB_BLUE="blue",n.Msg.COLOUR_RGB_GREEN="green",n.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",n.Msg.COLOUR_RGB_RED="red",n.Msg.COLOUR_RGB_TITLE="colour with",n.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",n.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",n.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",n.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",n.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",n.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",n.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",n.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",n.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",n.Msg.CONTROLS_FOREACH_TOOLTIP="For each item in a list, set the variable '%1' to the item, and then do some statements.",n.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",n.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",n.Msg.CONTROLS_FOR_TOOLTIP="Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",n.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",n.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",n.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",n.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",n.Msg.CONTROLS_IF_MSG_ELSE="else",n.Msg.CONTROLS_IF_MSG_ELSEIF="else if",n.Msg.CONTROLS_IF_MSG_IF="if",n.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",n.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",n.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",n.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",n.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",n.Msg.CONTROLS_REPEAT_INPUT_DO="do",n.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",n.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",n.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",n.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",n.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",n.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",n.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",n.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",n.Msg.DELETE_BLOCK="Delete Block",n.Msg.DELETE_VARIABLE="Delete the '%1' variable",n.Msg.DELETE_VARIABLE_CONFIRMATION="Delete %1 uses of the '%2' variable?",n.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",n.Msg.DISABLE_BLOCK="Disable Block",n.Msg.DUPLICATE_BLOCK="Duplicate",n.Msg.DUPLICATE_COMMENT="Duplicate Comment",n.Msg.ENABLE_BLOCK="Enable Block",n.Msg.EXPAND_ALL="Expand Blocks",n.Msg.EXPAND_BLOCK="Expand Block",n.Msg.EXTERNAL_INPUTS="External Inputs",n.Msg.HELP="Help",n.Msg.INLINE_INPUTS="Inline Inputs",n.Msg.IOS_CANCEL="Cancel",n.Msg.IOS_ERROR="Error",n.Msg.IOS_OK="OK",n.Msg.IOS_PROCEDURES_ADD_INPUT="+ Add Input",n.Msg.IOS_PROCEDURES_ALLOW_STATEMENTS="Allow statements",n.Msg.IOS_PROCEDURES_DUPLICATE_INPUTS_ERROR="This function has duplicate inputs.",n.Msg.IOS_PROCEDURES_INPUTS="INPUTS",n.Msg.IOS_VARIABLES_ADD_BUTTON="Add",n.Msg.IOS_VARIABLES_ADD_VARIABLE="+ Add Variable",n.Msg.IOS_VARIABLES_DELETE_BUTTON="Delete",n.Msg.IOS_VARIABLES_EMPTY_NAME_ERROR="You can't use an empty variable name.",n.Msg.IOS_VARIABLES_RENAME_BUTTON="Rename",n.Msg.IOS_VARIABLES_VARIABLE_NAME="Variable name",n.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",n.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",n.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",n.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",n.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",n.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",n.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",n.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",n.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",n.Msg.LISTS_GET_INDEX_FIRST="first",n.Msg.LISTS_GET_INDEX_FROM_END="# from end",n.Msg.LISTS_GET_INDEX_FROM_START="#",n.Msg.LISTS_GET_INDEX_GET="get",n.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",n.Msg.LISTS_GET_INDEX_LAST="last",n.Msg.LISTS_GET_INDEX_RANDOM="random",n.Msg.LISTS_GET_INDEX_REMOVE="remove",n.Msg.LISTS_GET_INDEX_TAIL="",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",n.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",n.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",n.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",n.Msg.LISTS_GET_SUBLIST_END_LAST="to last",n.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",n.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",n.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",n.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",n.Msg.LISTS_GET_SUBLIST_TAIL="",n.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",n.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",n.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",n.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",n.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",n.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",n.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",n.Msg.LISTS_INLIST="in list",n.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",n.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",n.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",n.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",n.Msg.LISTS_LENGTH_TITLE="length of %1",n.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",n.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",n.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",n.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",n.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",n.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",n.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",n.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",n.Msg.LISTS_SET_INDEX_INPUT_TO="as",n.Msg.LISTS_SET_INDEX_INSERT="insert at",n.Msg.LISTS_SET_INDEX_SET="set",n.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",n.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",n.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",n.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",n.Msg.LISTS_SORT_ORDER_DESCENDING="descending",n.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",n.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",n.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",n.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",n.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",n.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",n.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",n.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",n.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",n.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",n.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",n.Msg.LOGIC_BOOLEAN_FALSE="false",n.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",n.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",n.Msg.LOGIC_BOOLEAN_TRUE="true",n.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",n.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",n.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",n.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",n.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",n.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",n.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",n.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",n.Msg.LOGIC_NEGATE_TITLE="not %1",n.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",n.Msg.LOGIC_NULL="null",n.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",n.Msg.LOGIC_NULL_TOOLTIP="Returns null.",n.Msg.LOGIC_OPERATION_AND="and",n.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",n.Msg.LOGIC_OPERATION_OR="or",n.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",n.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",n.Msg.LOGIC_TERNARY_CONDITION="test",n.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",n.Msg.LOGIC_TERNARY_IF_FALSE="if false",n.Msg.LOGIC_TERNARY_IF_TRUE="if true",n.Msg.LOGIC_TERNARY_TOOLTIP="Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.",n.Msg.MATH_ADDITION_SYMBOL="+",n.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",n.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",n.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",n.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",n.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",n.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",n.Msg.MATH_ATAN2_HELPURL="https://en.wikipedia.org/wiki/Atan2",n.Msg.MATH_ATAN2_TITLE="atan2 of X:%1 Y:%2",n.Msg.MATH_ATAN2_TOOLTIP="Return the arctangent of point (X, Y) in degrees from -180 to 180.",n.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",n.Msg.MATH_CHANGE_TITLE="change %1 by %2",n.Msg.MATH_CHANGE_TOOLTIP="Add a number to variable '%1'.",n.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",n.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants: Ï€ (3.141â€¦), e (2.718â€¦), Ï† (1.618â€¦), sqrt(2) (1.414â€¦), sqrt(Â½) (0.707â€¦), or âˆž (infinity).",n.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",n.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",n.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",n.Msg.MATH_DIVISION_SYMBOL="Ã·",n.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",n.Msg.MATH_IS_EVEN="is even",n.Msg.MATH_IS_NEGATIVE="is negative",n.Msg.MATH_IS_ODD="is odd",n.Msg.MATH_IS_POSITIVE="is positive",n.Msg.MATH_IS_PRIME="is prime",n.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",n.Msg.MATH_IS_WHOLE="is whole",n.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",n.Msg.MATH_MODULO_TITLE="remainder of %1 Ã· %2",n.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",n.Msg.MATH_MULTIPLICATION_SYMBOL="Ã—",n.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",n.Msg.MATH_NUMBER_TOOLTIP="A number.",n.Msg.MATH_ONLIST_HELPURL="",n.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",n.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",n.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",n.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",n.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",n.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",n.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",n.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",n.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",n.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.",n.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",n.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",n.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",n.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",n.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",n.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",n.Msg.MATH_POWER_SYMBOL="^",n.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",n.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",n.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",n.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",n.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",n.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",n.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",n.Msg.MATH_ROUND_OPERATOR_ROUND="round",n.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",n.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",n.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",n.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",n.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",n.Msg.MATH_SINGLE_OP_ROOT="square root",n.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",n.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",n.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",n.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",n.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",n.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",n.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",n.Msg.MATH_SUBTRACTION_SYMBOL="-",n.Msg.MATH_TRIG_ACOS="acos",n.Msg.MATH_TRIG_ASIN="asin",n.Msg.MATH_TRIG_ATAN="atan",n.Msg.MATH_TRIG_COS="cos",n.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",n.Msg.MATH_TRIG_SIN="sin",n.Msg.MATH_TRIG_TAN="tan",n.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",n.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",n.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",n.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",n.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",n.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",n.Msg.NEW_COLOUR_VARIABLE="Create colour variable...",n.Msg.NEW_NUMBER_VARIABLE="Create number variable...",n.Msg.NEW_STRING_VARIABLE="Create string variable...",n.Msg.NEW_VARIABLE="Create variable...",n.Msg.NEW_VARIABLE_TITLE="New variable name:",n.Msg.NEW_VARIABLE_TYPE_TITLE="New variable type:",n.Msg.ORDINAL_NUMBER_SUFFIX="",n.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",n.Msg.PROCEDURES_BEFORE_PARAMS="with:",n.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",n.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Run the user-defined function '%1'.",n.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",n.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Run the user-defined function '%1' and use its output.",n.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",n.Msg.PROCEDURES_CREATE_DO="Create '%1'",n.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...",n.Msg.PROCEDURES_DEFNORETURN_DO="",n.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",n.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",n.Msg.PROCEDURES_DEFNORETURN_TITLE="to",n.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",n.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",n.Msg.PROCEDURES_DEFRETURN_RETURN="return",n.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",n.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",n.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",n.Msg.PROCEDURES_IFRETURN_HELPURL="http://c2.com/cgi/wiki?GuardClause",n.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",n.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition.",n.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",n.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",n.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",n.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",n.Msg.REDO="Redo",n.Msg.REMOVE_COMMENT="Remove Comment",n.Msg.RENAME_VARIABLE="Rename variable...",n.Msg.RENAME_VARIABLE_TITLE="Rename all '%1' variables to:",n.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",n.Msg.TEXT_APPEND_TITLE="to %1 append text %2",n.Msg.TEXT_APPEND_TOOLTIP="Append some text to variable '%1'.",n.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",n.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",n.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",n.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",n.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",n.Msg.TEXT_CHARAT_FIRST="get first letter",n.Msg.TEXT_CHARAT_FROM_END="get letter # from end",n.Msg.TEXT_CHARAT_FROM_START="get letter #",n.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",n.Msg.TEXT_CHARAT_LAST="get last letter",n.Msg.TEXT_CHARAT_RANDOM="get random letter",n.Msg.TEXT_CHARAT_TAIL="",n.Msg.TEXT_CHARAT_TITLE="in text %1 %2",n.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",n.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",n.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",n.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",n.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",n.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",n.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",n.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",n.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",n.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",n.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",n.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",n.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",n.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",n.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",n.Msg.TEXT_GET_SUBSTRING_TAIL="",n.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",n.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",n.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",n.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",n.Msg.TEXT_INDEXOF_TITLE="in text %1 %2 %3",n.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",n.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",n.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",n.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",n.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",n.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",n.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",n.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",n.Msg.TEXT_LENGTH_TITLE="length of %1",n.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",n.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",n.Msg.TEXT_PRINT_TITLE="print %1",n.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",n.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",n.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",n.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",n.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",n.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",n.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",n.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",n.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",n.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",n.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",n.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",n.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",n.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",n.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",n.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",n.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",n.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",n.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",n.Msg.TODAY="Today",n.Msg.UNDO="Undo",n.Msg.UNNAMED_KEY="unnamed",n.Msg.VARIABLES_DEFAULT_NAME="item",n.Msg.VARIABLES_GET_CREATE_SET="Create 'set %1'",n.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",n.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",n.Msg.VARIABLES_SET="set %1 to %2",n.Msg.VARIABLES_SET_CREATE_GET="Create 'get %1'",n.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",n.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",n.Msg.VARIABLE_ALREADY_EXISTS="A variable named '%1' already exists.",n.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="A variable named '%1' already exists for another type: '%2'.",n.Msg.WORKSPACE_ARIA_LABEL="Blockly Workspace",n.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="Say something...",n.Msg.CONTROLS_FOREACH_INPUT_DO=n.Msg.CONTROLS_REPEAT_INPUT_DO,n.Msg.CONTROLS_FOR_INPUT_DO=n.Msg.CONTROLS_REPEAT_INPUT_DO,n.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=n.Msg.CONTROLS_IF_MSG_ELSEIF,n.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=n.Msg.CONTROLS_IF_MSG_ELSE,n.Msg.CONTROLS_IF_IF_TITLE_IF=n.Msg.CONTROLS_IF_MSG_IF,n.Msg.CONTROLS_IF_MSG_THEN=n.Msg.CONTROLS_REPEAT_INPUT_DO,n.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=n.Msg.CONTROLS_REPEAT_INPUT_DO,n.Msg.LISTS_CREATE_WITH_ITEM_TITLE=n.Msg.VARIABLES_DEFAULT_NAME,n.Msg.LISTS_GET_INDEX_HELPURL=n.Msg.LISTS_INDEX_OF_HELPURL,n.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=n.Msg.LISTS_INLIST,n.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=n.Msg.LISTS_INLIST,n.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=n.Msg.LISTS_INLIST,n.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=n.Msg.LISTS_INLIST,n.Msg.MATH_CHANGE_TITLE_ITEM=n.Msg.VARIABLES_DEFAULT_NAME,n.Msg.PROCEDURES_DEFRETURN_COMMENT=n.Msg.PROCEDURES_DEFNORETURN_COMMENT,n.Msg.PROCEDURES_DEFRETURN_DO=n.Msg.PROCEDURES_DEFNORETURN_DO,n.Msg.PROCEDURES_DEFRETURN_PROCEDURE=n.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,n.Msg.PROCEDURES_DEFRETURN_TITLE=n.Msg.PROCEDURES_DEFNORETURN_TITLE,n.Msg.TEXT_APPEND_VARIABLE=n.Msg.VARIABLES_DEFAULT_NAME,n.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=n.Msg.VARIABLES_DEFAULT_NAME,n.Msg.MATH_HUE="230",n.Msg.LOOPS_HUE="120",n.Msg.LISTS_HUE="260",n.Msg.LOGIC_HUE="210",n.Msg.VARIABLES_HUE="330",n.Msg.TEXTS_HUE="160",n.Msg.PROCEDURES_HUE="290",n.Msg.COLOUR_HUE="20",n.Msg.VARIABLES_DYNAMIC_HUE="310",n.Msg)})),LP=IP((function(t,e){var n;t.exports=((n=kP).Blocks.colour={},n.Constants={},n.Constants.Colour={},n.Constants.Colour.HUE=20,n.defineBlocksWithJsonArray([{type:"colour_picker",message0:"%1",args0:[{type:"field_colour",name:"COLOUR",colour:"#ff0000"}],output:"Colour",helpUrl:"%{BKY_COLOUR_PICKER_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_PICKER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"colour_random",message0:"%{BKY_COLOUR_RANDOM_TITLE}",output:"Colour",helpUrl:"%{BKY_COLOUR_RANDOM_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RANDOM_TOOLTIP}"},{type:"colour_rgb",message0:"%{BKY_COLOUR_RGB_TITLE} %{BKY_COLOUR_RGB_RED} %1 %{BKY_COLOUR_RGB_GREEN} %2 %{BKY_COLOUR_RGB_BLUE} %3",args0:[{type:"input_value",name:"RED",check:"Number",align:"RIGHT"},{type:"input_value",name:"GREEN",check:"Number",align:"RIGHT"},{type:"input_value",name:"BLUE",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_RGB_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RGB_TOOLTIP}"},{type:"colour_blend",message0:"%{BKY_COLOUR_BLEND_TITLE} %{BKY_COLOUR_BLEND_COLOUR1} %1 %{BKY_COLOUR_BLEND_COLOUR2} %2 %{BKY_COLOUR_BLEND_RATIO} %3",args0:[{type:"input_value",name:"COLOUR1",check:"Colour",align:"RIGHT"},{type:"input_value",name:"COLOUR2",check:"Colour",align:"RIGHT"},{type:"input_value",name:"RATIO",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_BLEND_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_BLEND_TOOLTIP}"}]),n.Blocks.lists={},n.Constants.Lists={},n.Constants.Lists.HUE=260,n.defineBlocksWithJsonArray([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:!0,style:"list_blocks",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"list_blocks",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"list_blocks",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]),n.Blocks.lists_create_with={init:function(){this.setHelpUrl(n.Msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.itemCount_=3,this.updateShape_(),this.setOutput(!0,"Array"),this.setMutator(new n.Mutator(["lists_create_with_item"])),this.setTooltip(n.Msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){var t=n.utils.xml.createElement("mutation");return t.setAttribute("items",this.itemCount_),t},domToMutation:function(t){this.itemCount_=parseInt(t.getAttribute("items"),10),this.updateShape_()},decompose:function(t){var e=t.newBlock("lists_create_with_container");e.initSvg();for(var n=e.getInput("STACK").connection,i=0;i<this.itemCount_;i++){var o=t.newBlock("lists_create_with_item");o.initSvg(),n.connect(o.previousConnection),n=o.nextConnection}return e},compose:function(t){var e=t.getInputTargetBlock("STACK");for(t=[];e&&!e.isInsertionMarker();)t.push(e.valueConnection_),e=e.nextConnection&&e.nextConnection.targetBlock();for(e=0;e<this.itemCount_;e++){var i=this.getInput("ADD"+e).connection.targetConnection;i&&-1==t.indexOf(i)&&i.disconnect()}for(this.itemCount_=t.length,this.updateShape_(),e=0;e<this.itemCount_;e++)n.Mutator.reconnect(t[e],this,"ADD"+e)},saveConnections:function(t){t=t.getInputTargetBlock("STACK");for(var e=0;t;){var n=this.getInput("ADD"+e);t.valueConnection_=n&&n.connection.targetConnection,e++,t=t.nextConnection&&t.nextConnection.targetBlock()}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(n.Msg.LISTS_CREATE_EMPTY_TITLE);for(var t=0;t<this.itemCount_;t++)if(!this.getInput("ADD"+t)){var e=this.appendValueInput("ADD"+t).setAlign(n.ALIGN_RIGHT);0==t&&e.appendField(n.Msg.LISTS_CREATE_WITH_INPUT_WITH)}for(;this.getInput("ADD"+t);)this.removeInput("ADD"+t),t++}},n.Blocks.lists_create_with_container={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(n.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(n.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=!1}},n.Blocks.lists_create_with_item={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(n.Msg.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(n.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=!1}},n.Blocks.lists_indexOf={init:function(){var t=[[n.Msg.LISTS_INDEX_OF_FIRST,"FIRST"],[n.Msg.LISTS_INDEX_OF_LAST,"LAST"]];this.setHelpUrl(n.Msg.LISTS_INDEX_OF_HELPURL),this.setStyle("list_blocks"),this.setOutput(!0,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(n.Msg.LISTS_INDEX_OF_INPUT_IN_LIST),this.appendValueInput("FIND").appendField(new n.FieldDropdown(t),"END"),this.setInputsInline(!0);var e=this;this.setTooltip((function(){return n.Msg.LISTS_INDEX_OF_TOOLTIP.replace("%1",e.workspace.options.oneBasedIndex?"0":"-1")}))}},n.Blocks.lists_getIndex={init:function(){var t=[[n.Msg.LISTS_GET_INDEX_GET,"GET"],[n.Msg.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[n.Msg.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[n.Msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[n.Msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[n.Msg.LISTS_GET_INDEX_FIRST,"FIRST"],[n.Msg.LISTS_GET_INDEX_LAST,"LAST"],[n.Msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(n.Msg.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks"),t=new n.FieldDropdown(t,(function(t){t="REMOVE"==t,this.getSourceBlock().updateStatement_(t)})),this.appendValueInput("VALUE").setCheck("Array").appendField(n.Msg.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(t,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),n.Msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(n.Msg.LISTS_GET_INDEX_TAIL),this.setInputsInline(!0),this.setOutput(!0),this.updateAt_(!0);var e=this;this.setTooltip((function(){var t=e.getFieldValue("MODE"),i=e.getFieldValue("WHERE"),o="";switch(t+" "+i){case"GET FROM_START":case"GET FROM_END":o=n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":o=n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":o=n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":o=n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":o=n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":o=n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":o=n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":o=n.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":o=n.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":o=n.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":o=n.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":o=n.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return"FROM_START"!=i&&"FROM_END"!=i||(o+="  "+("FROM_START"==i?n.Msg.LISTS_INDEX_FROM_START_TOOLTIP:n.Msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",e.workspace.options.oneBasedIndex?"#1":"#0")),o}))},mutationToDom:function(){var t=n.utils.xml.createElement("mutation");t.setAttribute("statement",!this.outputConnection);var e=this.getInput("AT").type==n.INPUT_VALUE;return t.setAttribute("at",e),t},domToMutation:function(t){var e="true"==t.getAttribute("statement");this.updateStatement_(e),t="false"!=t.getAttribute("at"),this.updateAt_(t)},updateStatement_:function(t){t!=!this.outputConnection&&(this.unplug(!0,!0),t?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function(t){this.removeInput("AT"),this.removeInput("ORDINAL",!0),t?(this.appendValueInput("AT").setCheck("Number"),n.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(n.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");var e=new n.FieldDropdown(this.WHERE_OPTIONS,(function(e){var n="FROM_START"==e||"FROM_END"==e;if(n!=t){var i=this.getSourceBlock();return i.updateAt_(n),i.setFieldValue(e,"WHERE"),null}}));this.getInput("AT").appendField(e,"WHERE"),n.Msg.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}},n.Blocks.lists_setIndex={init:function(){var t=[[n.Msg.LISTS_SET_INDEX_SET,"SET"],[n.Msg.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[n.Msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[n.Msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[n.Msg.LISTS_GET_INDEX_FIRST,"FIRST"],[n.Msg.LISTS_GET_INDEX_LAST,"LAST"],[n.Msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(n.Msg.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(n.Msg.LISTS_SET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(new n.FieldDropdown(t),"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(n.Msg.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(n.Msg.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(!0);var e=this;this.setTooltip((function(){var t=e.getFieldValue("MODE"),i=e.getFieldValue("WHERE"),o="";switch(t+" "+i){case"SET FROM_START":case"SET FROM_END":o=n.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":o=n.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":o=n.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":o=n.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":o=n.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":o=n.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":o=n.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":o=n.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return"FROM_START"!=i&&"FROM_END"!=i||(o+="  "+n.Msg.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",e.workspace.options.oneBasedIndex?"#1":"#0")),o}))},mutationToDom:function(){var t=n.utils.xml.createElement("mutation"),e=this.getInput("AT").type==n.INPUT_VALUE;return t.setAttribute("at",e),t},domToMutation:function(t){t="false"!=t.getAttribute("at"),this.updateAt_(t)},updateAt_:function(t){this.removeInput("AT"),this.removeInput("ORDINAL",!0),t?(this.appendValueInput("AT").setCheck("Number"),n.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(n.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");var e=new n.FieldDropdown(this.WHERE_OPTIONS,(function(e){var n="FROM_START"==e||"FROM_END"==e;if(n!=t){var i=this.getSourceBlock();return i.updateAt_(n),i.setFieldValue(e,"WHERE"),null}}));this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO"),this.getInput("AT").appendField(e,"WHERE")}},n.Blocks.lists_getSublist={init:function(){this.WHERE_OPTIONS_1=[[n.Msg.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[n.Msg.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[n.Msg.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[n.Msg.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[n.Msg.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[n.Msg.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(n.Msg.LISTS_GET_SUBLIST_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(n.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),n.Msg.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(n.Msg.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(n.Msg.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){var t=n.utils.xml.createElement("mutation"),e=this.getInput("AT1").type==n.INPUT_VALUE;return t.setAttribute("at1",e),e=this.getInput("AT2").type==n.INPUT_VALUE,t.setAttribute("at2",e),t},domToMutation:function(t){var e="true"==t.getAttribute("at1");t="true"==t.getAttribute("at2"),this.updateAt_(1,e),this.updateAt_(2,t)},updateAt_:function(t,e){this.removeInput("AT"+t),this.removeInput("ORDINAL"+t,!0),e?(this.appendValueInput("AT"+t).setCheck("Number"),n.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+t).appendField(n.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+t);var i=new n.FieldDropdown(this["WHERE_OPTIONS_"+t],(function(n){var i="FROM_START"==n||"FROM_END"==n;if(i!=e){var o=this.getSourceBlock();return o.updateAt_(t,i),o.setFieldValue(n,"WHERE"+t),null}}));this.getInput("AT"+t).appendField(i,"WHERE"+t),1==t&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2")),n.Msg.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}},n.Blocks.lists_sort={init:function(){this.jsonInit({message0:n.Msg.LISTS_SORT_TITLE,args0:[{type:"field_dropdown",name:"TYPE",options:[[n.Msg.LISTS_SORT_TYPE_NUMERIC,"NUMERIC"],[n.Msg.LISTS_SORT_TYPE_TEXT,"TEXT"],[n.Msg.LISTS_SORT_TYPE_IGNORECASE,"IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[[n.Msg.LISTS_SORT_ORDER_ASCENDING,"1"],[n.Msg.LISTS_SORT_ORDER_DESCENDING,"-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",style:"list_blocks",tooltip:n.Msg.LISTS_SORT_TOOLTIP,helpUrl:n.Msg.LISTS_SORT_HELPURL})}},n.Blocks.lists_split={init:function(){var t=this,e=new n.FieldDropdown([[n.Msg.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[n.Msg.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]],(function(e){t.updateType_(e)}));this.setHelpUrl(n.Msg.LISTS_SPLIT_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("INPUT").setCheck("String").appendField(e,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(n.Msg.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setTooltip((function(){var e=t.getFieldValue("MODE");if("SPLIT"==e)return n.Msg.LISTS_SPLIT_TOOLTIP_SPLIT;if("JOIN"==e)return n.Msg.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+e)}))},updateType_:function(t){if(this.getFieldValue("MODE")!=t){var e=this.getInput("INPUT").connection;e.setShadowDom(null);var n=e.targetBlock();n&&(e.disconnect(),n.isShadow()?n.dispose():this.bumpNeighbours())}"SPLIT"==t?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){var t=n.utils.xml.createElement("mutation");return t.setAttribute("mode",this.getFieldValue("MODE")),t},domToMutation:function(t){this.updateType_(t.getAttribute("mode"))}},n.Blocks.logic={},n.Constants.Logic={},n.Constants.Logic.HUE=210,n.defineBlocksWithJsonArray([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,style:"logic_blocks",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,style:"logic_blocks",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["â‰ ","NEQ"],["â€<","LT"],["â€â‰¤","LTE"],["â€>","GT"],["â€â‰¥","GTE"]]},{type:"input_value",name:"B"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]}]),n.defineBlocksWithJsonArray([{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]),n.Constants.Logic.TOOLTIPS_BY_OP={EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"},n.Extensions.register("logic_op_tooltip",n.Extensions.buildTooltipForDropdown("OP",n.Constants.Logic.TOOLTIPS_BY_OP)),n.Constants.Logic.CONTROLS_IF_MUTATOR_MIXIN={elseifCount_:0,elseCount_:0,suppressPrefixSuffix:!0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;var t=n.utils.xml.createElement("mutation");return this.elseifCount_&&t.setAttribute("elseif",this.elseifCount_),this.elseCount_&&t.setAttribute("else",1),t},domToMutation:function(t){this.elseifCount_=parseInt(t.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(t.getAttribute("else"),10)||0,this.rebuildShape_()},decompose:function(t){var e=t.newBlock("controls_if_if");e.initSvg();for(var n=e.nextConnection,i=1;i<=this.elseifCount_;i++){var o=t.newBlock("controls_if_elseif");o.initSvg(),n.connect(o.previousConnection),n=o.nextConnection}return this.elseCount_&&((t=t.newBlock("controls_if_else")).initSvg(),n.connect(t.previousConnection)),e},compose:function(t){t=t.nextConnection.targetBlock(),this.elseCount_=this.elseifCount_=0;for(var e=[null],n=[null],i=null;t&&!t.isInsertionMarker();){switch(t.type){case"controls_if_elseif":this.elseifCount_++,e.push(t.valueConnection_),n.push(t.statementConnection_);break;case"controls_if_else":this.elseCount_++,i=t.statementConnection_;break;default:throw TypeError("Unknown block type: "+t.type)}t=t.nextConnection&&t.nextConnection.targetBlock()}this.updateShape_(),this.reconnectChildBlocks_(e,n,i)},saveConnections:function(t){t=t.nextConnection.targetBlock();for(var e=1;t;){switch(t.type){case"controls_if_elseif":var n=this.getInput("IF"+e),i=this.getInput("DO"+e);t.valueConnection_=n&&n.connection.targetConnection,t.statementConnection_=i&&i.connection.targetConnection,e++;break;case"controls_if_else":i=this.getInput("ELSE"),t.statementConnection_=i&&i.connection.targetConnection;break;default:throw TypeError("Unknown block type: "+t.type)}t=t.nextConnection&&t.nextConnection.targetBlock()}},rebuildShape_:function(){var t=[null],e=[null],n=null;this.getInput("ELSE")&&(n=this.getInput("ELSE").connection.targetConnection);for(var i=1;this.getInput("IF"+i);){var o=this.getInput("IF"+i),r=this.getInput("DO"+i);t.push(o.connection.targetConnection),e.push(r.connection.targetConnection),i++}this.updateShape_(),this.reconnectChildBlocks_(t,e,n)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var t=1;this.getInput("IF"+t);)this.removeInput("IF"+t),this.removeInput("DO"+t),t++;for(t=1;t<=this.elseifCount_;t++)this.appendValueInput("IF"+t).setCheck("Boolean").appendField(n.Msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+t).appendField(n.Msg.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(n.Msg.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(t,e,i){for(var o=1;o<=this.elseifCount_;o++)n.Mutator.reconnect(t[o],this,"IF"+o),n.Mutator.reconnect(e[o],this,"DO"+o);n.Mutator.reconnect(i,this,"ELSE")}},n.Extensions.registerMutator("controls_if_mutator",n.Constants.Logic.CONTROLS_IF_MUTATOR_MIXIN,null,["controls_if_elseif","controls_if_else"]),n.Constants.Logic.CONTROLS_IF_TOOLTIP_EXTENSION=function(){this.setTooltip(function(){return this.elseifCount_||this.elseCount_?!this.elseifCount_&&this.elseCount_?n.Msg.CONTROLS_IF_TOOLTIP_2:this.elseifCount_&&!this.elseCount_?n.Msg.CONTROLS_IF_TOOLTIP_3:this.elseifCount_&&this.elseCount_?n.Msg.CONTROLS_IF_TOOLTIP_4:"":n.Msg.CONTROLS_IF_TOOLTIP_1}.bind(this))},n.Extensions.register("controls_if_tooltip",n.Constants.Logic.CONTROLS_IF_TOOLTIP_EXTENSION),n.Constants.Logic.LOGIC_COMPARE_ONCHANGE_MIXIN={onchange:function(t){this.prevBlocks_||(this.prevBlocks_=[null,null]);var e=this.getInputTargetBlock("A"),i=this.getInputTargetBlock("B");e&&i&&!this.workspace.connectionChecker.doTypeChecks(e.outputConnection,i.outputConnection)&&(n.Events.setGroup(t.group),(t=this.prevBlocks_[0])!==e&&(e.unplug(),!t||t.isDisposed()||t.isShadow()||this.getInput("A").connection.connect(t.outputConnection)),(e=this.prevBlocks_[1])!==i&&(i.unplug(),!e||e.isDisposed()||e.isShadow()||this.getInput("B").connection.connect(e.outputConnection)),this.bumpNeighbours(),n.Events.setGroup(!1)),this.prevBlocks_[0]=this.getInputTargetBlock("A"),this.prevBlocks_[1]=this.getInputTargetBlock("B")}},n.Constants.Logic.LOGIC_COMPARE_EXTENSION=function(){this.mixin(n.Constants.Logic.LOGIC_COMPARE_ONCHANGE_MIXIN)},n.Extensions.register("logic_compare",n.Constants.Logic.LOGIC_COMPARE_EXTENSION),n.Constants.Logic.LOGIC_TERNARY_ONCHANGE_MIXIN={prevParentConnection_:null,onchange:function(t){var e=this.getInputTargetBlock("THEN"),i=this.getInputTargetBlock("ELSE"),o=this.outputConnection.targetConnection;if((e||i)&&o)for(var r=0;2>r;r++){var s=1==r?e:i;s&&!s.workspace.connectionChecker.doTypeChecks(s.outputConnection,o)&&(n.Events.setGroup(t.group),o===this.prevParentConnection_?(this.unplug(),o.getSourceBlock().bumpNeighbours()):(s.unplug(),s.bumpNeighbours()),n.Events.setGroup(!1))}this.prevParentConnection_=o}},n.Extensions.registerMixin("logic_ternary",n.Constants.Logic.LOGIC_TERNARY_ONCHANGE_MIXIN),n.Blocks.loops={},n.Constants.Loops={},n.Constants.Loops.HUE=120,n.defineBlocksWithJsonArray([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:!0,previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]),n.Constants.Loops.WHILE_UNTIL_TOOLTIPS={WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"},n.Extensions.register("controls_whileUntil_tooltip",n.Extensions.buildTooltipForDropdown("MODE",n.Constants.Loops.WHILE_UNTIL_TOOLTIPS)),n.Constants.Loops.BREAK_CONTINUE_TOOLTIPS={BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"},n.Extensions.register("controls_flow_tooltip",n.Extensions.buildTooltipForDropdown("FLOW",n.Constants.Loops.BREAK_CONTINUE_TOOLTIPS)),n.Constants.Loops.CUSTOM_CONTEXT_MENU_CREATE_VARIABLES_GET_MIXIN={customContextMenu:function(t){if(!this.isInFlyout){var e=this.getField("VAR").getVariable(),i=e.name;if(!this.isCollapsed()&&null!=i){var o={enabled:!0};o.text=n.Msg.VARIABLES_SET_CREATE_GET.replace("%1",i),e=n.Variables.generateVariableFieldDom(e),(i=n.utils.xml.createElement("block")).setAttribute("type","variables_get"),i.appendChild(e),o.callback=n.ContextMenu.callbackFactory(this,i),t.push(o)}}}},n.Extensions.registerMixin("contextMenu_newGetVariableBlock",n.Constants.Loops.CUSTOM_CONTEXT_MENU_CREATE_VARIABLES_GET_MIXIN),n.Extensions.register("controls_for_tooltip",n.Extensions.buildTooltipWithFieldText("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),n.Extensions.register("controls_forEach_tooltip",n.Extensions.buildTooltipWithFieldText("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR")),n.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN={LOOP_TYPES:["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"],suppressPrefixSuffix:!0,getSurroundLoop:function(t){do{if(-1!=n.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.LOOP_TYPES.indexOf(t.type))return t;t=t.getSurroundParent()}while(t);return null},onchange:function(t){if(this.workspace.isDragging&&!this.workspace.isDragging()&&t.type==n.Events.BLOCK_MOVE){var e=n.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.getSurroundLoop(this);if(this.setWarningText(e?null:n.Msg.CONTROLS_FLOW_STATEMENTS_WARNING),!this.isInFlyout){var i=n.Events.getGroup();n.Events.setGroup(t.group),this.setEnabled(e),n.Events.setGroup(i)}}}},n.Extensions.registerMixin("controls_flow_in_loop_check",n.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN),n.Blocks.math={},n.Constants.Math={},n.Constants.Math.HUE=230,n.defineBlocksWithJsonArray([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",style:"math_blocks",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["Ï€","PI"],["e","E"],["Ï†","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt(Â½)","SQRT1_2"],["âˆž","INFINITY"]]}],output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:!0,output:"Boolean",style:"math_blocks",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,style:"variable_blocks",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"},{type:"math_atan2",message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"}]),n.Constants.Math.TOOLTIPS_BY_OP={ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"},n.Extensions.register("math_op_tooltip",n.Extensions.buildTooltipForDropdown("OP",n.Constants.Math.TOOLTIPS_BY_OP)),n.Constants.Math.IS_DIVISIBLEBY_MUTATOR_MIXIN={mutationToDom:function(){var t=n.utils.xml.createElement("mutation"),e="DIVISIBLE_BY"==this.getFieldValue("PROPERTY");return t.setAttribute("divisor_input",e),t},domToMutation:function(t){t="true"==t.getAttribute("divisor_input"),this.updateShape_(t)},updateShape_:function(t){var e=this.getInput("DIVISOR");t?e||this.appendValueInput("DIVISOR").setCheck("Number"):e&&this.removeInput("DIVISOR")}},n.Constants.Math.IS_DIVISIBLE_MUTATOR_EXTENSION=function(){this.getField("PROPERTY").setValidator((function(t){t="DIVISIBLE_BY"==t,this.getSourceBlock().updateShape_(t)}))},n.Extensions.registerMutator("math_is_divisibleby_mutator",n.Constants.Math.IS_DIVISIBLEBY_MUTATOR_MIXIN,n.Constants.Math.IS_DIVISIBLE_MUTATOR_EXTENSION),n.Extensions.register("math_change_tooltip",n.Extensions.buildTooltipWithFieldText("%{BKY_MATH_CHANGE_TOOLTIP}","VAR")),n.Constants.Math.LIST_MODES_MUTATOR_MIXIN={updateType_:function(t){"MODE"==t?this.outputConnection.setCheck("Array"):this.outputConnection.setCheck("Number")},mutationToDom:function(){var t=n.utils.xml.createElement("mutation");return t.setAttribute("op",this.getFieldValue("OP")),t},domToMutation:function(t){this.updateType_(t.getAttribute("op"))}},n.Constants.Math.LIST_MODES_MUTATOR_EXTENSION=function(){this.getField("OP").setValidator(function(t){this.updateType_(t)}.bind(this))},n.Extensions.registerMutator("math_modes_of_list_mutator",n.Constants.Math.LIST_MODES_MUTATOR_MIXIN,n.Constants.Math.LIST_MODES_MUTATOR_EXTENSION),n.Blocks.procedures={},n.Blocks.procedures_defnoreturn={init:function(){var t=n.Procedures.findLegalName("",this);(t=new n.FieldTextInput(t,n.Procedures.rename)).setSpellcheck(!1),this.appendDummyInput().appendField(n.Msg.PROCEDURES_DEFNORETURN_TITLE).appendField(t,"NAME").appendField("","PARAMS"),this.setMutator(new n.Mutator(["procedures_mutatorarg"])),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&n.Msg.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(n.Msg.PROCEDURES_DEFNORETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(n.Msg.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl(n.Msg.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},setStatements_:function(t){this.hasStatements_!==t&&(t?(this.appendStatementInput("STACK").appendField(n.Msg.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements_=t)},updateParams_:function(){var t="";this.arguments_.length&&(t=n.Msg.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),n.Events.disable();try{this.setFieldValue(t,"PARAMS")}finally{n.Events.enable()}},mutationToDom:function(t){var e=n.utils.xml.createElement("mutation");t&&e.setAttribute("name",this.getFieldValue("NAME"));for(var i=0;i<this.argumentVarModels_.length;i++){var o=n.utils.xml.createElement("arg"),r=this.argumentVarModels_[i];o.setAttribute("name",r.name),o.setAttribute("varid",r.getId()),t&&this.paramIds_&&o.setAttribute("paramId",this.paramIds_[i]),e.appendChild(o)}return this.hasStatements_||e.setAttribute("statements","false"),e},domToMutation:function(t){this.arguments_=[],this.argumentVarModels_=[];for(var e,i=0;e=t.childNodes[i];i++)if("arg"==e.nodeName.toLowerCase()){var o=e.getAttribute("name");e=e.getAttribute("varid")||e.getAttribute("varId"),this.arguments_.push(o),null!=(e=n.Variables.getOrCreateVariablePackage(this.workspace,e,o,""))?this.argumentVarModels_.push(e):console.log("Failed to create a variable with name "+o+", ignoring.")}this.updateParams_(),n.Procedures.mutateCallers(this),this.setStatements_("false"!==t.getAttribute("statements"))},decompose:function(t){var e=n.utils.xml.createElement("block");e.setAttribute("type","procedures_mutatorcontainer");var i=n.utils.xml.createElement("statement");i.setAttribute("name","STACK"),e.appendChild(i);for(var o=0;o<this.arguments_.length;o++){var r=n.utils.xml.createElement("block");r.setAttribute("type","procedures_mutatorarg");var s=n.utils.xml.createElement("field");s.setAttribute("name","NAME");var a=n.utils.xml.createTextNode(this.arguments_[o]);s.appendChild(a),r.appendChild(s),s=n.utils.xml.createElement("next"),r.appendChild(s),i.appendChild(r),i=s}return t=n.Xml.domToBlock(e,t),"procedures_defreturn"==this.type?t.setFieldValue(this.hasStatements_,"STATEMENTS"):t.removeInput("STATEMENT_INPUT"),n.Procedures.mutateCallers(this),t},compose:function(t){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];for(var e=t.getInputTargetBlock("STACK");e&&!e.isInsertionMarker();){var i=e.getFieldValue("NAME");this.arguments_.push(i),i=this.workspace.getVariable(i,""),this.argumentVarModels_.push(i),this.paramIds_.push(e.id),e=e.nextConnection&&e.nextConnection.targetBlock()}this.updateParams_(),n.Procedures.mutateCallers(this),null!==(t=t.getFieldValue("STATEMENTS"))&&(t="TRUE"==t,this.hasStatements_!=t)&&(t?(this.setStatements_(!0),n.Mutator.reconnect(this.statementConnection_,this,"STACK"),this.statementConnection_=null):(t=this.getInput("STACK").connection,(this.statementConnection_=t.targetConnection)&&((t=t.targetBlock()).unplug(),t.bumpNeighbours()),this.setStatements_(!1)))},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!1]},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(t,e){var i=this.workspace.getVariableById(t);if(""==i.type){i=i.name,e=this.workspace.getVariableById(e);for(var o=!1,r=0;r<this.argumentVarModels_.length;r++)this.argumentVarModels_[r].getId()==t&&(this.arguments_[r]=e.name,this.argumentVarModels_[r]=e,o=!0);o&&(this.displayRenamedVar_(i,e.name),n.Procedures.mutateCallers(this))}},updateVarName:function(t){for(var e=t.name,i=!1,o=0;o<this.argumentVarModels_.length;o++)if(this.argumentVarModels_[o].getId()==t.getId()){var r=this.arguments_[o];this.arguments_[o]=e,i=!0}i&&(this.displayRenamedVar_(r,e),n.Procedures.mutateCallers(this))},displayRenamedVar_:function(t,e){if(this.updateParams_(),this.mutator&&this.mutator.isVisible())for(var i,o=this.mutator.workspace_.getAllBlocks(!1),r=0;i=o[r];r++)"procedures_mutatorarg"==i.type&&n.Names.equals(t,i.getFieldValue("NAME"))&&i.setFieldValue(e,"NAME")},customContextMenu:function(t){if(!this.isInFlyout){var e={enabled:!0},i=this.getFieldValue("NAME");e.text=n.Msg.PROCEDURES_CREATE_DO.replace("%1",i);var o=n.utils.xml.createElement("mutation");for(o.setAttribute("name",i),i=0;i<this.arguments_.length;i++){var r=n.utils.xml.createElement("arg");r.setAttribute("name",this.arguments_[i]),o.appendChild(r)}if((i=n.utils.xml.createElement("block")).setAttribute("type",this.callType_),i.appendChild(o),e.callback=n.ContextMenu.callbackFactory(this,i),t.push(e),!this.isCollapsed())for(i=0;i<this.argumentVarModels_.length;i++)e={enabled:!0},o=this.argumentVarModels_[i],e.text=n.Msg.VARIABLES_SET_CREATE_GET.replace("%1",o.name),o=n.Variables.generateVariableFieldDom(o),(r=n.utils.xml.createElement("block")).setAttribute("type","variables_get"),r.appendChild(o),e.callback=n.ContextMenu.callbackFactory(this,r),t.push(e)}},callType_:"procedures_callnoreturn"},n.Blocks.procedures_defreturn={init:function(){var t=n.Procedures.findLegalName("",this);(t=new n.FieldTextInput(t,n.Procedures.rename)).setSpellcheck(!1),this.appendDummyInput().appendField(n.Msg.PROCEDURES_DEFRETURN_TITLE).appendField(t,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign(n.ALIGN_RIGHT).appendField(n.Msg.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new n.Mutator(["procedures_mutatorarg"])),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&n.Msg.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(n.Msg.PROCEDURES_DEFRETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(n.Msg.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl(n.Msg.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},setStatements_:n.Blocks.procedures_defnoreturn.setStatements_,updateParams_:n.Blocks.procedures_defnoreturn.updateParams_,mutationToDom:n.Blocks.procedures_defnoreturn.mutationToDom,domToMutation:n.Blocks.procedures_defnoreturn.domToMutation,decompose:n.Blocks.procedures_defnoreturn.decompose,compose:n.Blocks.procedures_defnoreturn.compose,getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!0]},getVars:n.Blocks.procedures_defnoreturn.getVars,getVarModels:n.Blocks.procedures_defnoreturn.getVarModels,renameVarById:n.Blocks.procedures_defnoreturn.renameVarById,updateVarName:n.Blocks.procedures_defnoreturn.updateVarName,displayRenamedVar_:n.Blocks.procedures_defnoreturn.displayRenamedVar_,customContextMenu:n.Blocks.procedures_defnoreturn.customContextMenu,callType_:"procedures_callreturn"},n.Blocks.procedures_mutatorcontainer={init:function(){this.appendDummyInput().appendField(n.Msg.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField(n.Msg.PROCEDURES_ALLOW_STATEMENTS).appendField(new n.FieldCheckbox("TRUE"),"STATEMENTS"),this.setStyle("procedure_blocks"),this.setTooltip(n.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=!1}},n.Blocks.procedures_mutatorarg={init:function(){var t=new n.FieldTextInput(n.Procedures.DEFAULT_ARG,this.validator_);t.oldShowEditorFn_=t.showEditor_,t.showEditor_=function(){this.createdVariables_=[],this.oldShowEditorFn_()},this.appendDummyInput().appendField(n.Msg.PROCEDURES_MUTATORARG_TITLE).appendField(t,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(n.Msg.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=!1,t.onFinishEditing_=this.deleteIntermediateVars_,t.createdVariables_=[],t.onFinishEditing_("x")},validator_:function(t){var e=this.getSourceBlock(),i=n.Mutator.findParentWs(e.workspace);if(!(t=t.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,"")))return null;for(var o=(e.workspace.targetWorkspace||e.workspace).getAllBlocks(!1),r=t.toLowerCase(),s=0;s<o.length;s++)if(o[s].id!=this.getSourceBlock().id){var a=o[s].getFieldValue("NAME");if(a&&a.toLowerCase()==r)return null}return e.isInFlyout||((e=i.getVariable(t,""))&&e.name!=t&&i.renameVariableById(e.getId(),t),e||(e=i.createVariable(t,""))&&this.createdVariables_&&this.createdVariables_.push(e)),t},deleteIntermediateVars_:function(t){var e=n.Mutator.findParentWs(this.getSourceBlock().workspace);if(e)for(var i=0;i<this.createdVariables_.length;i++){var o=this.createdVariables_[i];o.name!=t&&e.deleteVariableById(o.getId())}}},n.Blocks.procedures_callnoreturn={init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(n.Msg.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(t,e){n.Names.equals(t,this.getProcedureCall())&&(this.setFieldValue(e,"NAME"),this.setTooltip((this.outputConnection?n.Msg.PROCEDURES_CALLRETURN_TOOLTIP:n.Msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",e)))},setProcedureParameters_:function(t,e){var i=n.Procedures.getDefinition(this.getProcedureCall(),this.workspace),o=i&&i.mutator&&i.mutator.isVisible();if(o||(this.quarkConnections_={},this.quarkIds_=null),e)if(t.join("\n")==this.arguments_.join("\n"))this.quarkIds_=e;else{if(e.length!=t.length)throw RangeError("paramNames and paramIds must be the same length.");this.setCollapsed(!1),this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]),i=this.rendered,this.rendered=!1;for(var r=0;r<this.arguments_.length;r++){var s=this.getInput("ARG"+r);s&&(s=s.connection.targetConnection,this.quarkConnections_[this.quarkIds_[r]]=s,o&&s&&-1==e.indexOf(this.quarkIds_[r])&&(s.disconnect(),s.getSourceBlock().bumpNeighbours()))}for(this.arguments_=[].concat(t),this.argumentVarModels_=[],r=0;r<this.arguments_.length;r++)t=n.Variables.getOrCreateVariablePackage(this.workspace,null,this.arguments_[r],""),this.argumentVarModels_.push(t);if(this.updateShape_(),this.quarkIds_=e)for(r=0;r<this.arguments_.length;r++)(e=this.quarkIds_[r])in this.quarkConnections_&&(s=this.quarkConnections_[e],n.Mutator.reconnect(s,this,"ARG"+r)||delete this.quarkConnections_[e]);(this.rendered=i)&&this.render()}},updateShape_:function(){for(var t=0;t<this.arguments_.length;t++){var e=this.getField("ARGNAME"+t);if(e){n.Events.disable();try{e.setValue(this.arguments_[t])}finally{n.Events.enable()}}else e=new n.FieldLabel(this.arguments_[t]),this.appendValueInput("ARG"+t).setAlign(n.ALIGN_RIGHT).appendField(e,"ARGNAME"+t).init()}for(;this.getInput("ARG"+t);)this.removeInput("ARG"+t),t++;(t=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||(t.appendField(n.Msg.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"),t.init()):this.getField("WITH")&&t.removeField("WITH"))},mutationToDom:function(){var t=n.utils.xml.createElement("mutation");t.setAttribute("name",this.getProcedureCall());for(var e=0;e<this.arguments_.length;e++){var i=n.utils.xml.createElement("arg");i.setAttribute("name",this.arguments_[e]),t.appendChild(i)}return t},domToMutation:function(t){var e=t.getAttribute("name");this.renameProcedure(this.getProcedureCall(),e),e=[];for(var n,i=[],o=0;n=t.childNodes[o];o++)"arg"==n.nodeName.toLowerCase()&&(e.push(n.getAttribute("name")),i.push(n.getAttribute("paramId")));this.setProcedureParameters_(e,i)},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},onchange:function(t){if(this.workspace&&!this.workspace.isFlyout&&t.recordUndo)if(t.type==n.Events.BLOCK_CREATE&&-1!=t.ids.indexOf(this.id)){var e=this.getProcedureCall();if(!(e=n.Procedures.getDefinition(e,this.workspace))||e.type==this.defType_&&JSON.stringify(e.getVars())==JSON.stringify(this.arguments_)||(e=null),!e){n.Events.setGroup(t.group),t=n.utils.xml.createElement("xml"),(e=n.utils.xml.createElement("block")).setAttribute("type",this.defType_);var i=this.getRelativeToSurfaceXY(),o=i.y+2*n.SNAP_RADIUS;e.setAttribute("x",i.x+n.SNAP_RADIUS*(this.RTL?-1:1)),e.setAttribute("y",o),i=this.mutationToDom(),e.appendChild(i),(i=n.utils.xml.createElement("field")).setAttribute("name","NAME"),(o=this.getProcedureCall())||(o=n.Procedures.findLegalName("",this),this.renameProcedure("",o)),i.appendChild(n.utils.xml.createTextNode(o)),e.appendChild(i),t.appendChild(e),n.Xml.domToWorkspace(t,this.workspace),n.Events.setGroup(!1)}}else t.type==n.Events.BLOCK_DELETE?(e=this.getProcedureCall(),(e=n.Procedures.getDefinition(e,this.workspace))||(n.Events.setGroup(t.group),this.dispose(!0),n.Events.setGroup(!1))):t.type==n.Events.CHANGE&&"disabled"==t.element&&(e=this.getProcedureCall(),(e=n.Procedures.getDefinition(e,this.workspace))&&e.id==t.blockId&&((e=n.Events.getGroup())&&console.log("Saw an existing group while responding to a definition change"),n.Events.setGroup(t.group),t.newValue?(this.previousEnabledState_=this.isEnabled(),this.setEnabled(!1)):this.setEnabled(this.previousEnabledState_),n.Events.setGroup(e)))},customContextMenu:function(t){if(this.workspace.isMovable()){var e={enabled:!0};e.text=n.Msg.PROCEDURES_HIGHLIGHT_DEF;var i=this.getProcedureCall(),o=this.workspace;e.callback=function(){var t=n.Procedures.getDefinition(i,o);t&&(o.centerOnBlock(t.id),t.select())},t.push(e)}},defType_:"procedures_defnoreturn"},n.Blocks.procedures_callreturn={init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(n.Msg.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},getProcedureCall:n.Blocks.procedures_callnoreturn.getProcedureCall,renameProcedure:n.Blocks.procedures_callnoreturn.renameProcedure,setProcedureParameters_:n.Blocks.procedures_callnoreturn.setProcedureParameters_,updateShape_:n.Blocks.procedures_callnoreturn.updateShape_,mutationToDom:n.Blocks.procedures_callnoreturn.mutationToDom,domToMutation:n.Blocks.procedures_callnoreturn.domToMutation,getVars:n.Blocks.procedures_callnoreturn.getVars,getVarModels:n.Blocks.procedures_callnoreturn.getVarModels,onchange:n.Blocks.procedures_callnoreturn.onchange,customContextMenu:n.Blocks.procedures_callnoreturn.customContextMenu,defType_:"procedures_defreturn"},n.Blocks.procedures_ifreturn={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(n.Msg.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField(n.Msg.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(n.Msg.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl(n.Msg.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=!0},mutationToDom:function(){var t=n.utils.xml.createElement("mutation");return t.setAttribute("value",Number(this.hasReturnValue_)),t},domToMutation:function(t){this.hasReturnValue_=1==t.getAttribute("value"),this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(n.Msg.PROCEDURES_DEFRETURN_RETURN))},onchange:function(t){if(this.workspace.isDragging&&!this.workspace.isDragging()){t=!1;var e=this;do{if(-1!=this.FUNCTION_TYPES.indexOf(e.type)){t=!0;break}e=e.getSurroundParent()}while(e);t?("procedures_defnoreturn"==e.type&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(n.Msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!1):"procedures_defreturn"!=e.type||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(n.Msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!0),this.setWarningText(null),this.isInFlyout||this.setEnabled(!0)):(this.setWarningText(n.Msg.PROCEDURES_IFRETURN_WARNING),this.isInFlyout||this.getInheritedDisabled()||this.setEnabled(!1))}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]},n.Blocks.texts={},n.Constants.Text={},n.Constants.Text.HUE=160,n.defineBlocksWithJsonArray([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_multiline",message0:"%1 %2",args0:[{type:"field_image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAARCAYAAADpPU2iAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAdhgAAHYYBXaITgQAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMS42/U4J6AAAAP1JREFUOE+Vks0KQUEYhjmRIja4ABtZ2dm5A3t3Ia6AUm7CylYuQRaUhZSlLZJiQbFAyRnPN33y01HOW08z8873zpwzM4F3GWOCruvGIE4/rLaV+Nq1hVGMBqzhqlxgCys4wJA65xnogMHsQ5lujnYHTejBBCK2mE4abjCgMGhNxHgDFWjDSG07kdfVa2pZMf4ZyMAdWmpZMfYOsLiDMYMjlMB+K613QISRhTnITnsYg5yUd0DETmEoMlkFOeIT/A58iyK5E18BuTBfgYXfwNJv4P9/oEBerLylOnRhygmGdPpTTBZAPkde61lbQe4moWUvYUZYLfUNftIY4zwA5X2Z9AYnQrEAAAAASUVORK5CYII=",width:12,height:17,alt:"Â¶"},{type:"field_multilinetext",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:!1},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:!1},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"text_blocks",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"text_blocks",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",style:"text_blocks",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:!0,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:!0,mutator:"text_charAt_mutator"}]),n.Blocks.text_getSubstring={init:function(){this.WHERE_OPTIONS_1=[[n.Msg.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[n.Msg.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[n.Msg.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[n.Msg.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[n.Msg.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[n.Msg.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(n.Msg.TEXT_GET_SUBSTRING_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("STRING").setCheck("String").appendField(n.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),n.Msg.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(n.Msg.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(!0),this.setOutput(!0,"String"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(n.Msg.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){var t=n.utils.xml.createElement("mutation"),e=this.getInput("AT1").type==n.INPUT_VALUE;return t.setAttribute("at1",e),e=this.getInput("AT2").type==n.INPUT_VALUE,t.setAttribute("at2",e),t},domToMutation:function(t){var e="true"==t.getAttribute("at1");t="true"==t.getAttribute("at2"),this.updateAt_(1,e),this.updateAt_(2,t)},updateAt_:function(t,e){this.removeInput("AT"+t),this.removeInput("ORDINAL"+t,!0),e?(this.appendValueInput("AT"+t).setCheck("Number"),n.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+t).appendField(n.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+t),2==t&&n.Msg.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(n.Msg.TEXT_GET_SUBSTRING_TAIL));var i=new n.FieldDropdown(this["WHERE_OPTIONS_"+t],(function(n){var i="FROM_START"==n||"FROM_END"==n;if(i!=e){var o=this.getSourceBlock();return o.updateAt_(t,i),o.setFieldValue(n,"WHERE"+t),null}}));this.getInput("AT"+t).appendField(i,"WHERE"+t),1==t&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2"))}},n.Blocks.text_changeCase={init:function(){var t=[[n.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[n.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[n.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(n.Msg.TEXT_CHANGECASE_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(new n.FieldDropdown(t),"CASE"),this.setOutput(!0,"String"),this.setTooltip(n.Msg.TEXT_CHANGECASE_TOOLTIP)}},n.Blocks.text_trim={init:function(){var t=[[n.Msg.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[n.Msg.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[n.Msg.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(n.Msg.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(new n.FieldDropdown(t),"MODE"),this.setOutput(!0,"String"),this.setTooltip(n.Msg.TEXT_TRIM_TOOLTIP)}},n.Blocks.text_print={init:function(){this.jsonInit({message0:n.Msg.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:n.Msg.TEXT_PRINT_TOOLTIP,helpUrl:n.Msg.TEXT_PRINT_HELPURL})}},n.Blocks.text_prompt_ext={init:function(){var t=[[n.Msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[n.Msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(n.Msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks");var e=this;t=new n.FieldDropdown(t,(function(t){e.updateType_(t)})),this.appendValueInput("TEXT").appendField(t,"TYPE"),this.setOutput(!0,"String"),this.setTooltip((function(){return"TEXT"==e.getFieldValue("TYPE")?n.Msg.TEXT_PROMPT_TOOLTIP_TEXT:n.Msg.TEXT_PROMPT_TOOLTIP_NUMBER}))},updateType_:function(t){this.outputConnection.setCheck("NUMBER"==t?"Number":"String")},mutationToDom:function(){var t=n.utils.xml.createElement("mutation");return t.setAttribute("type",this.getFieldValue("TYPE")),t},domToMutation:function(t){this.updateType_(t.getAttribute("type"))}},n.Blocks.text_prompt={init:function(){this.mixin(n.Constants.Text.QUOTE_IMAGE_MIXIN);var t=[[n.Msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[n.Msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]],e=this;this.setHelpUrl(n.Msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),t=new n.FieldDropdown(t,(function(t){e.updateType_(t)})),this.appendDummyInput().appendField(t,"TYPE").appendField(this.newQuote_(!0)).appendField(new n.FieldTextInput(""),"TEXT").appendField(this.newQuote_(!1)),this.setOutput(!0,"String"),this.setTooltip((function(){return"TEXT"==e.getFieldValue("TYPE")?n.Msg.TEXT_PROMPT_TOOLTIP_TEXT:n.Msg.TEXT_PROMPT_TOOLTIP_NUMBER}))},updateType_:n.Blocks.text_prompt_ext.updateType_,mutationToDom:n.Blocks.text_prompt_ext.mutationToDom,domToMutation:n.Blocks.text_prompt_ext.domToMutation},n.Blocks.text_count={init:function(){this.jsonInit({message0:n.Msg.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:!0,style:"text_blocks",tooltip:n.Msg.TEXT_COUNT_TOOLTIP,helpUrl:n.Msg.TEXT_COUNT_HELPURL})}},n.Blocks.text_replace={init:function(){this.jsonInit({message0:n.Msg.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:n.Msg.TEXT_REPLACE_TOOLTIP,helpUrl:n.Msg.TEXT_REPLACE_HELPURL})}},n.Blocks.text_reverse={init:function(){this.jsonInit({message0:n.Msg.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:n.Msg.TEXT_REVERSE_TOOLTIP,helpUrl:n.Msg.TEXT_REVERSE_HELPURL})}},n.Constants.Text.QUOTE_IMAGE_MIXIN={QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(t){for(var e,n=0;e=this.inputList[n];n++)for(var i,o=0;i=e.fieldRow[o];o++)if(t==i.name)return e.insertFieldAt(o,this.newQuote_(!0)),void e.insertFieldAt(o+2,this.newQuote_(!1));console.warn('field named "'+t+'" not found in '+this.toDevString())},newQuote_:function(t){return t=this.RTL?!t:t,new n.FieldImage(t?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,this.QUOTE_IMAGE_WIDTH,this.QUOTE_IMAGE_HEIGHT,t?"â€œ":"â€")}},n.Constants.Text.TEXT_QUOTES_EXTENSION=function(){this.mixin(n.Constants.Text.QUOTE_IMAGE_MIXIN),this.quoteField_("TEXT")},n.Constants.Text.TEXT_JOIN_MUTATOR_MIXIN={mutationToDom:function(){var t=n.utils.xml.createElement("mutation");return t.setAttribute("items",this.itemCount_),t},domToMutation:function(t){this.itemCount_=parseInt(t.getAttribute("items"),10),this.updateShape_()},decompose:function(t){var e=t.newBlock("text_create_join_container");e.initSvg();for(var n=e.getInput("STACK").connection,i=0;i<this.itemCount_;i++){var o=t.newBlock("text_create_join_item");o.initSvg(),n.connect(o.previousConnection),n=o.nextConnection}return e},compose:function(t){var e=t.getInputTargetBlock("STACK");for(t=[];e&&!e.isInsertionMarker();)t.push(e.valueConnection_),e=e.nextConnection&&e.nextConnection.targetBlock();for(e=0;e<this.itemCount_;e++){var i=this.getInput("ADD"+e).connection.targetConnection;i&&-1==t.indexOf(i)&&i.disconnect()}for(this.itemCount_=t.length,this.updateShape_(),e=0;e<this.itemCount_;e++)n.Mutator.reconnect(t[e],this,"ADD"+e)},saveConnections:function(t){t=t.getInputTargetBlock("STACK");for(var e=0;t;){var n=this.getInput("ADD"+e);t.valueConnection_=n&&n.connection.targetConnection,e++,t=t.nextConnection&&t.nextConnection.targetBlock()}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(!0)).appendField(this.newQuote_(!1));for(var t=0;t<this.itemCount_;t++)if(!this.getInput("ADD"+t)){var e=this.appendValueInput("ADD"+t).setAlign(n.ALIGN_RIGHT);0==t&&e.appendField(n.Msg.TEXT_JOIN_TITLE_CREATEWITH)}for(;this.getInput("ADD"+t);)this.removeInput("ADD"+t),t++}},n.Constants.Text.TEXT_JOIN_EXTENSION=function(){this.mixin(n.Constants.Text.QUOTE_IMAGE_MIXIN),this.itemCount_=2,this.updateShape_(),this.setMutator(new n.Mutator(["text_create_join_item"]))},n.Extensions.register("text_append_tooltip",n.Extensions.buildTooltipWithFieldText("%{BKY_TEXT_APPEND_TOOLTIP}","VAR")),n.Constants.Text.TEXT_INDEXOF_TOOLTIP_EXTENSION=function(){var t=this;this.setTooltip((function(){return n.Msg.TEXT_INDEXOF_TOOLTIP.replace("%1",t.workspace.options.oneBasedIndex?"0":"-1")}))},n.Constants.Text.TEXT_CHARAT_MUTATOR_MIXIN={mutationToDom:function(){var t=n.utils.xml.createElement("mutation");return t.setAttribute("at",!!this.isAt_),t},domToMutation:function(t){t="false"!=t.getAttribute("at"),this.updateAt_(t)},updateAt_:function(t){this.removeInput("AT",!0),this.removeInput("ORDINAL",!0),t&&(this.appendValueInput("AT").setCheck("Number"),n.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(n.Msg.ORDINAL_NUMBER_SUFFIX)),n.Msg.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(n.Msg.TEXT_CHARAT_TAIL)),this.isAt_=t}},n.Constants.Text.TEXT_CHARAT_EXTENSION=function(){this.getField("WHERE").setValidator((function(t){(t="FROM_START"==t||"FROM_END"==t)!=this.isAt_&&this.getSourceBlock().updateAt_(t)})),this.updateAt_(!0);var t=this;this.setTooltip((function(){var e=t.getFieldValue("WHERE"),i=n.Msg.TEXT_CHARAT_TOOLTIP;return("FROM_START"==e||"FROM_END"==e)&&(e="FROM_START"==e?n.Msg.LISTS_INDEX_FROM_START_TOOLTIP:n.Msg.LISTS_INDEX_FROM_END_TOOLTIP)&&(i+="  "+e.replace("%1",t.workspace.options.oneBasedIndex?"#1":"#0")),i}))},n.Extensions.register("text_indexOf_tooltip",n.Constants.Text.TEXT_INDEXOF_TOOLTIP_EXTENSION),n.Extensions.register("text_quotes",n.Constants.Text.TEXT_QUOTES_EXTENSION),n.Extensions.registerMutator("text_join_mutator",n.Constants.Text.TEXT_JOIN_MUTATOR_MIXIN,n.Constants.Text.TEXT_JOIN_EXTENSION),n.Extensions.registerMutator("text_charAt_mutator",n.Constants.Text.TEXT_CHARAT_MUTATOR_MIXIN,n.Constants.Text.TEXT_CHARAT_EXTENSION),n.Blocks.variables={},n.Constants.Variables={},n.Constants.Variables.HUE=330,n.defineBlocksWithJsonArray([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]),n.Constants.Variables.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN={customContextMenu:function(t){if(this.isInFlyout)"variables_get"!=this.type&&"variables_get_reporter"!=this.type||(e={text:n.Msg.RENAME_VARIABLE,enabled:!0,callback:n.Constants.Variables.RENAME_OPTION_CALLBACK_FACTORY(this)},r=this.getField("VAR").getText(),o={text:n.Msg.DELETE_VARIABLE.replace("%1",r),enabled:!0,callback:n.Constants.Variables.DELETE_OPTION_CALLBACK_FACTORY(this)},t.unshift(e),t.unshift(o));else{if("variables_get"==this.type)var e="variables_set",i=n.Msg.VARIABLES_GET_CREATE_SET;else e="variables_get",i=n.Msg.VARIABLES_SET_CREATE_GET;var o={enabled:0<this.workspace.remainingCapacity()},r=this.getField("VAR").getText();o.text=i.replace("%1",r),(i=n.utils.xml.createElement("field")).setAttribute("name","VAR"),i.appendChild(n.utils.xml.createTextNode(r)),(r=n.utils.xml.createElement("block")).setAttribute("type",e),r.appendChild(i),o.callback=n.ContextMenu.callbackFactory(this,r),t.push(o)}}},n.Constants.Variables.RENAME_OPTION_CALLBACK_FACTORY=function(t){return function(){var e=t.workspace,i=t.getField("VAR").getVariable();n.Variables.renameVariable(e,i)}},n.Constants.Variables.DELETE_OPTION_CALLBACK_FACTORY=function(t){return function(){var e=t.workspace,n=t.getField("VAR").getVariable();e.deleteVariableById(n.getId()),e.refreshToolboxSelection()}},n.Extensions.registerMixin("contextMenu_variableSetterGetter",n.Constants.Variables.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN),n.Constants.VariablesDynamic={},n.Constants.VariablesDynamic.HUE=310,n.defineBlocksWithJsonArray([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]),n.Constants.VariablesDynamic.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN={customContextMenu:function(t){if(this.isInFlyout)"variables_get_dynamic"!=this.type&&"variables_get_reporter_dynamic"!=this.type||(e={text:n.Msg.RENAME_VARIABLE,enabled:!0,callback:n.Constants.Variables.RENAME_OPTION_CALLBACK_FACTORY(this)},s=this.getField("VAR").getText(),r={text:n.Msg.DELETE_VARIABLE.replace("%1",s),enabled:!0,callback:n.Constants.Variables.DELETE_OPTION_CALLBACK_FACTORY(this)},t.unshift(e),t.unshift(r));else{var e=this.getFieldValue("VAR"),i=this.workspace.getVariableById(e).type;if("variables_get_dynamic"==this.type){e="variables_set_dynamic";var o=n.Msg.VARIABLES_GET_CREATE_SET}else e="variables_get_dynamic",o=n.Msg.VARIABLES_SET_CREATE_GET;var r={enabled:0<this.workspace.remainingCapacity()},s=this.getField("VAR").getText();r.text=o.replace("%1",s),(o=n.utils.xml.createElement("field")).setAttribute("name","VAR"),o.setAttribute("variabletype",i),o.appendChild(n.utils.xml.createTextNode(s)),(s=n.utils.xml.createElement("block")).setAttribute("type",e),s.appendChild(o),r.callback=n.ContextMenu.callbackFactory(this,s),t.push(r)}},onchange:function(t){t=this.getFieldValue("VAR"),t=n.Variables.getVariable(this.workspace,t),"variables_get_dynamic"==this.type?this.outputConnection.setCheck(t.type):this.getInput("VALUE").connection.setCheck(t.type)}},n.Constants.VariablesDynamic.RENAME_OPTION_CALLBACK_FACTORY=function(t){return function(){var e=t.workspace,i=t.getField("VAR").getVariable();n.Variables.renameVariable(e,i)}},n.Constants.VariablesDynamic.DELETE_OPTION_CALLBACK_FACTORY=function(t){return function(){var e=t.workspace,n=t.getField("VAR").getVariable();e.deleteVariableById(n.getId()),e.refreshToolboxSelection()}},n.Extensions.registerMixin("contextMenu_variableDynamicSetterGetter",n.Constants.VariablesDynamic.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN),n.Blocks)})),PP=IP((function(t,e){var n;t.exports=((n=LP).Blocks={},n.Blocks)})),MP=IP((function(t,e){var n;t.exports=((n=kP).JavaScript=new n.Generator("JavaScript"),n.JavaScript.addReservedWords("break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield,enum,implements,interface,let,package,private,protected,public,static,await,null,true,false,arguments,"+Object.getOwnPropertyNames(n.utils.global).join(",")),n.JavaScript.ORDER_ATOMIC=0,n.JavaScript.ORDER_NEW=1.1,n.JavaScript.ORDER_MEMBER=1.2,n.JavaScript.ORDER_FUNCTION_CALL=2,n.JavaScript.ORDER_INCREMENT=3,n.JavaScript.ORDER_DECREMENT=3,n.JavaScript.ORDER_BITWISE_NOT=4.1,n.JavaScript.ORDER_UNARY_PLUS=4.2,n.JavaScript.ORDER_UNARY_NEGATION=4.3,n.JavaScript.ORDER_LOGICAL_NOT=4.4,n.JavaScript.ORDER_TYPEOF=4.5,n.JavaScript.ORDER_VOID=4.6,n.JavaScript.ORDER_DELETE=4.7,n.JavaScript.ORDER_AWAIT=4.8,n.JavaScript.ORDER_EXPONENTIATION=5,n.JavaScript.ORDER_MULTIPLICATION=5.1,n.JavaScript.ORDER_DIVISION=5.2,n.JavaScript.ORDER_MODULUS=5.3,n.JavaScript.ORDER_SUBTRACTION=6.1,n.JavaScript.ORDER_ADDITION=6.2,n.JavaScript.ORDER_BITWISE_SHIFT=7,n.JavaScript.ORDER_RELATIONAL=8,n.JavaScript.ORDER_IN=8,n.JavaScript.ORDER_INSTANCEOF=8,n.JavaScript.ORDER_EQUALITY=9,n.JavaScript.ORDER_BITWISE_AND=10,n.JavaScript.ORDER_BITWISE_XOR=11,n.JavaScript.ORDER_BITWISE_OR=12,n.JavaScript.ORDER_LOGICAL_AND=13,n.JavaScript.ORDER_LOGICAL_OR=14,n.JavaScript.ORDER_CONDITIONAL=15,n.JavaScript.ORDER_ASSIGNMENT=16,n.JavaScript.ORDER_YIELD=17,n.JavaScript.ORDER_COMMA=18,n.JavaScript.ORDER_NONE=99,n.JavaScript.ORDER_OVERRIDES=[[n.JavaScript.ORDER_FUNCTION_CALL,n.JavaScript.ORDER_MEMBER],[n.JavaScript.ORDER_FUNCTION_CALL,n.JavaScript.ORDER_FUNCTION_CALL],[n.JavaScript.ORDER_MEMBER,n.JavaScript.ORDER_MEMBER],[n.JavaScript.ORDER_MEMBER,n.JavaScript.ORDER_FUNCTION_CALL],[n.JavaScript.ORDER_LOGICAL_NOT,n.JavaScript.ORDER_LOGICAL_NOT],[n.JavaScript.ORDER_MULTIPLICATION,n.JavaScript.ORDER_MULTIPLICATION],[n.JavaScript.ORDER_ADDITION,n.JavaScript.ORDER_ADDITION],[n.JavaScript.ORDER_LOGICAL_AND,n.JavaScript.ORDER_LOGICAL_AND],[n.JavaScript.ORDER_LOGICAL_OR,n.JavaScript.ORDER_LOGICAL_OR]],n.JavaScript.isInitialized=!1,n.JavaScript.init=function(t){n.JavaScript.definitions_=Object.create(null),n.JavaScript.functionNames_=Object.create(null),n.JavaScript.variableDB_?n.JavaScript.variableDB_.reset():n.JavaScript.variableDB_=new n.Names(n.JavaScript.RESERVED_WORDS_),n.JavaScript.variableDB_.setVariableMap(t.getVariableMap());for(var e=[],i=n.Variables.allDeveloperVariables(t),o=0;o<i.length;o++)e.push(n.JavaScript.variableDB_.getName(i[o],n.Names.DEVELOPER_VARIABLE_TYPE));for(t=n.Variables.allUsedVarModels(t),o=0;o<t.length;o++)e.push(n.JavaScript.variableDB_.getName(t[o].getId(),n.VARIABLE_CATEGORY_NAME));e.length&&(n.JavaScript.definitions_.variables="var "+e.join(", ")+";"),this.isInitialized=!0},n.JavaScript.finish=function(t){var e,i=[];for(e in n.JavaScript.definitions_)i.push(n.JavaScript.definitions_[e]);return delete n.JavaScript.definitions_,delete n.JavaScript.functionNames_,n.JavaScript.variableDB_.reset(),i.join("\n\n")+"\n\n\n"+t},n.JavaScript.scrubNakedValue=function(t){return t+";\n"},n.JavaScript.quote_=function(t){return"'"+(t=t.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'"))+"'"},n.JavaScript.multiline_quote_=function(t){return t.split(/\n/g).map(n.JavaScript.quote_).join(" + '\\n' +\n")},n.JavaScript.scrub_=function(t,e,i){var o="";if(!t.outputConnection||!t.outputConnection.targetConnection){var r=t.getCommentText();r&&(r=n.utils.string.wrap(r,n.JavaScript.COMMENT_WRAP-3),o+=n.JavaScript.prefixLines(r+"\n","// "));for(var s=0;s<t.inputList.length;s++)t.inputList[s].type==n.INPUT_VALUE&&(r=t.inputList[s].connection.targetBlock())&&(r=n.JavaScript.allNestedComments(r))&&(o+=n.JavaScript.prefixLines(r,"// "))}return t=t.nextConnection&&t.nextConnection.targetBlock(),o+e+(i=i?"":n.JavaScript.blockToCode(t))},n.JavaScript.getAdjusted=function(t,e,i,o,r){i=i||0,r=r||n.JavaScript.ORDER_NONE,t.workspace.options.oneBasedIndex&&i--;var s=t.workspace.options.oneBasedIndex?"1":"0";if(t=0<i?n.JavaScript.valueToCode(t,e,n.JavaScript.ORDER_ADDITION)||s:0>i?n.JavaScript.valueToCode(t,e,n.JavaScript.ORDER_SUBTRACTION)||s:o?n.JavaScript.valueToCode(t,e,n.JavaScript.ORDER_UNARY_NEGATION)||s:n.JavaScript.valueToCode(t,e,r)||s,n.isNumber(t))t=Number(t)+i,o&&(t=-t);else{if(0<i){t=t+" + "+i;var a=n.JavaScript.ORDER_ADDITION}else 0>i&&(t=t+" - "+-i,a=n.JavaScript.ORDER_SUBTRACTION);o&&(t=i?"-("+t+")":"-"+t,a=n.JavaScript.ORDER_UNARY_NEGATION),a=Math.floor(a),r=Math.floor(r),a&&r>=a&&(t="("+t+")")}return t},n.JavaScript.colour={},n.JavaScript.colour_picker=function(t){return[n.JavaScript.quote_(t.getFieldValue("COLOUR")),n.JavaScript.ORDER_ATOMIC]},n.JavaScript.colour_random=function(t){return[n.JavaScript.provideFunction_("colourRandom",["function "+n.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"() {","  var num = Math.floor(Math.random() * Math.pow(2, 24));","  return '#' + ('00000' + num.toString(16)).substr(-6);","}"])+"()",n.JavaScript.ORDER_FUNCTION_CALL]},n.JavaScript.colour_rgb=function(t){var e=n.JavaScript.valueToCode(t,"RED",n.JavaScript.ORDER_NONE)||0,i=n.JavaScript.valueToCode(t,"GREEN",n.JavaScript.ORDER_NONE)||0;return t=n.JavaScript.valueToCode(t,"BLUE",n.JavaScript.ORDER_NONE)||0,[n.JavaScript.provideFunction_("colourRgb",["function "+n.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(r, g, b) {","  r = Math.max(Math.min(Number(r), 100), 0) * 2.55;","  g = Math.max(Math.min(Number(g), 100), 0) * 2.55;","  b = Math.max(Math.min(Number(b), 100), 0) * 2.55;","  r = ('0' + (Math.round(r) || 0).toString(16)).slice(-2);","  g = ('0' + (Math.round(g) || 0).toString(16)).slice(-2);","  b = ('0' + (Math.round(b) || 0).toString(16)).slice(-2);","  return '#' + r + g + b;","}"])+"("+e+", "+i+", "+t+")",n.JavaScript.ORDER_FUNCTION_CALL]},n.JavaScript.colour_blend=function(t){var e=n.JavaScript.valueToCode(t,"COLOUR1",n.JavaScript.ORDER_NONE)||"'#000000'",i=n.JavaScript.valueToCode(t,"COLOUR2",n.JavaScript.ORDER_NONE)||"'#000000'";return t=n.JavaScript.valueToCode(t,"RATIO",n.JavaScript.ORDER_NONE)||.5,[n.JavaScript.provideFunction_("colourBlend",["function "+n.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(c1, c2, ratio) {","  ratio = Math.max(Math.min(Number(ratio), 1), 0);","  var r1 = parseInt(c1.substring(1, 3), 16);","  var g1 = parseInt(c1.substring(3, 5), 16);","  var b1 = parseInt(c1.substring(5, 7), 16);","  var r2 = parseInt(c2.substring(1, 3), 16);","  var g2 = parseInt(c2.substring(3, 5), 16);","  var b2 = parseInt(c2.substring(5, 7), 16);","  var r = Math.round(r1 * (1 - ratio) + r2 * ratio);","  var g = Math.round(g1 * (1 - ratio) + g2 * ratio);","  var b = Math.round(b1 * (1 - ratio) + b2 * ratio);","  r = ('0' + (r || 0).toString(16)).slice(-2);","  g = ('0' + (g || 0).toString(16)).slice(-2);","  b = ('0' + (b || 0).toString(16)).slice(-2);","  return '#' + r + g + b;","}"])+"("+e+", "+i+", "+t+")",n.JavaScript.ORDER_FUNCTION_CALL]},n.JavaScript.lists={},n.JavaScript.lists_create_empty=function(t){return["[]",n.JavaScript.ORDER_ATOMIC]},n.JavaScript.lists_create_with=function(t){for(var e=Array(t.itemCount_),i=0;i<t.itemCount_;i++)e[i]=n.JavaScript.valueToCode(t,"ADD"+i,n.JavaScript.ORDER_NONE)||"null";return["["+e.join(", ")+"]",n.JavaScript.ORDER_ATOMIC]},n.JavaScript.lists_repeat=function(t){return[n.JavaScript.provideFunction_("listsRepeat",["function "+n.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(value, n) {","  var array = [];","  for (var i = 0; i < n; i++) {","    array[i] = value;","  }","  return array;","}"])+"("+(n.JavaScript.valueToCode(t,"ITEM",n.JavaScript.ORDER_NONE)||"null")+", "+(t=n.JavaScript.valueToCode(t,"NUM",n.JavaScript.ORDER_NONE)||"0")+")",n.JavaScript.ORDER_FUNCTION_CALL]},n.JavaScript.lists_length=function(t){return[(n.JavaScript.valueToCode(t,"VALUE",n.JavaScript.ORDER_MEMBER)||"[]")+".length",n.JavaScript.ORDER_MEMBER]},n.JavaScript.lists_isEmpty=function(t){return["!"+(n.JavaScript.valueToCode(t,"VALUE",n.JavaScript.ORDER_MEMBER)||"[]")+".length",n.JavaScript.ORDER_LOGICAL_NOT]},n.JavaScript.lists_indexOf=function(t){var e="FIRST"==t.getFieldValue("END")?"indexOf":"lastIndexOf",i=n.JavaScript.valueToCode(t,"FIND",n.JavaScript.ORDER_NONE)||"''";return e=(n.JavaScript.valueToCode(t,"VALUE",n.JavaScript.ORDER_MEMBER)||"[]")+"."+e+"("+i+")",t.workspace.options.oneBasedIndex?[e+" + 1",n.JavaScript.ORDER_ADDITION]:[e,n.JavaScript.ORDER_FUNCTION_CALL]},n.JavaScript.lists_getIndex=function(t){var e=t.getFieldValue("MODE")||"GET",i=t.getFieldValue("WHERE")||"FROM_START",o=n.JavaScript.valueToCode(t,"VALUE","RANDOM"==i?n.JavaScript.ORDER_NONE:n.JavaScript.ORDER_MEMBER)||"[]";switch(i){case"FIRST":if("GET"==e)return[o+"[0]",n.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==e)return[o+".shift()",n.JavaScript.ORDER_MEMBER];if("REMOVE"==e)return o+".shift();\n";break;case"LAST":if("GET"==e)return[o+".slice(-1)[0]",n.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==e)return[o+".pop()",n.JavaScript.ORDER_MEMBER];if("REMOVE"==e)return o+".pop();\n";break;case"FROM_START":if(t=n.JavaScript.getAdjusted(t,"AT"),"GET"==e)return[o+"["+t+"]",n.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==e)return[o+".splice("+t+", 1)[0]",n.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==e)return o+".splice("+t+", 1);\n";break;case"FROM_END":if(t=n.JavaScript.getAdjusted(t,"AT",1,!0),"GET"==e)return[o+".slice("+t+")[0]",n.JavaScript.ORDER_FUNCTION_CALL];if("GET_REMOVE"==e)return[o+".splice("+t+", 1)[0]",n.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==e)return o+".splice("+t+", 1);";break;case"RANDOM":if(o=n.JavaScript.provideFunction_("listsGetRandomItem",["function "+n.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(list, remove) {","  var x = Math.floor(Math.random() * list.length);","  if (remove) {","    return list.splice(x, 1)[0];","  } else {","    return list[x];","  }","}"])+"("+o+", "+("GET"!=e)+")","GET"==e||"GET_REMOVE"==e)return[o,n.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==e)return o+";\n"}throw Error("Unhandled combination (lists_getIndex).")},n.JavaScript.lists_setIndex=function(t){function e(){if(i.match(/^\w+$/))return"";var t=n.JavaScript.variableDB_.getDistinctName("tmpList",n.VARIABLE_CATEGORY_NAME),e="var "+t+" = "+i+";\n";return i=t,e}var i=n.JavaScript.valueToCode(t,"LIST",n.JavaScript.ORDER_MEMBER)||"[]",o=t.getFieldValue("MODE")||"GET",r=t.getFieldValue("WHERE")||"FROM_START",s=n.JavaScript.valueToCode(t,"TO",n.JavaScript.ORDER_ASSIGNMENT)||"null";switch(r){case"FIRST":if("SET"==o)return i+"[0] = "+s+";\n";if("INSERT"==o)return i+".unshift("+s+");\n";break;case"LAST":if("SET"==o)return(t=e())+(i+"[")+i+".length - 1] = "+s+";\n";if("INSERT"==o)return i+".push("+s+");\n";break;case"FROM_START":if(r=n.JavaScript.getAdjusted(t,"AT"),"SET"==o)return i+"["+r+"] = "+s+";\n";if("INSERT"==o)return i+".splice("+r+", 0, "+s+");\n";break;case"FROM_END":if(r=n.JavaScript.getAdjusted(t,"AT",1,!1,n.JavaScript.ORDER_SUBTRACTION),t=e(),"SET"==o)return t+(i+"[")+i+".length - "+r+"] = "+s+";\n";if("INSERT"==o)return t+(i+".splice(")+i+".length - "+r+", 0, "+s+");\n";break;case"RANDOM":if(t=e(),t+="var "+(r=n.JavaScript.variableDB_.getDistinctName("tmpX",n.VARIABLE_CATEGORY_NAME))+" = Math.floor(Math.random() * "+i+".length);\n","SET"==o)return t+(i+"[")+r+"] = "+s+";\n";if("INSERT"==o)return t+(i+".splice(")+r+", 0, "+s+");\n"}throw Error("Unhandled combination (lists_setIndex).")},n.JavaScript.lists.getIndex_=function(t,e,n){return"FIRST"==e?"0":"FROM_END"==e?t+".length - 1 - "+n:"LAST"==e?t+".length - 1":n},n.JavaScript.lists_getSublist=function(t){var e=n.JavaScript.valueToCode(t,"LIST",n.JavaScript.ORDER_MEMBER)||"[]",i=t.getFieldValue("WHERE1"),o=t.getFieldValue("WHERE2");if("FIRST"==i&&"LAST"==o)e+=".slice(0)";else if(e.match(/^\w+$/)||"FROM_END"!=i&&"FROM_START"==o){switch(i){case"FROM_START":var r=n.JavaScript.getAdjusted(t,"AT1");break;case"FROM_END":r=e+".length - "+(r=n.JavaScript.getAdjusted(t,"AT1",1,!1,n.JavaScript.ORDER_SUBTRACTION));break;case"FIRST":r="0";break;default:throw Error("Unhandled option (lists_getSublist).")}switch(o){case"FROM_START":t=n.JavaScript.getAdjusted(t,"AT2",1);break;case"FROM_END":t=e+".length - "+(t=n.JavaScript.getAdjusted(t,"AT2",0,!1,n.JavaScript.ORDER_SUBTRACTION));break;case"LAST":t=e+".length";break;default:throw Error("Unhandled option (lists_getSublist).")}e=e+".slice("+r+", "+t+")"}else{r=n.JavaScript.getAdjusted(t,"AT1"),t=n.JavaScript.getAdjusted(t,"AT2");var s=n.JavaScript.lists.getIndex_,a={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};e=n.JavaScript.provideFunction_("subsequence"+a[i]+a[o],["function "+n.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(sequence"+("FROM_END"==i||"FROM_START"==i?", at1":"")+("FROM_END"==o||"FROM_START"==o?", at2":"")+") {","  var start = "+s("sequence",i,"at1")+";","  var end = "+s("sequence",o,"at2")+" + 1;","  return sequence.slice(start, end);","}"])+"("+e+("FROM_END"==i||"FROM_START"==i?", "+r:"")+("FROM_END"==o||"FROM_START"==o?", "+t:"")+")"}return[e,n.JavaScript.ORDER_FUNCTION_CALL]},n.JavaScript.lists_sort=function(t){var e=n.JavaScript.valueToCode(t,"LIST",n.JavaScript.ORDER_FUNCTION_CALL)||"[]",i="1"===t.getFieldValue("DIRECTION")?1:-1;return t=t.getFieldValue("TYPE"),[e+".slice().sort("+n.JavaScript.provideFunction_("listsGetSortCompare",["function "+n.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(type, direction) {","  var compareFuncs = {",'    "NUMERIC": function(a, b) {',"        return Number(a) - Number(b); },",'    "TEXT": function(a, b) {',"        return a.toString() > b.toString() ? 1 : -1; },",'    "IGNORE_CASE": function(a, b) {',"        return a.toString().toLowerCase() > b.toString().toLowerCase() ? 1 : -1; },","  };","  var compare = compareFuncs[type];","  return function(a, b) { return compare(a, b) * direction; }","}"])+'("'+t+'", '+i+"))",n.JavaScript.ORDER_FUNCTION_CALL]},n.JavaScript.lists_split=function(t){var e=n.JavaScript.valueToCode(t,"INPUT",n.JavaScript.ORDER_MEMBER),i=n.JavaScript.valueToCode(t,"DELIM",n.JavaScript.ORDER_NONE)||"''";if("SPLIT"==(t=t.getFieldValue("MODE")))e||(e="''"),t="split";else{if("JOIN"!=t)throw Error("Unknown mode: "+t);e||(e="[]"),t="join"}return[e+"."+t+"("+i+")",n.JavaScript.ORDER_FUNCTION_CALL]},n.JavaScript.lists_reverse=function(t){return[(n.JavaScript.valueToCode(t,"LIST",n.JavaScript.ORDER_FUNCTION_CALL)||"[]")+".slice().reverse()",n.JavaScript.ORDER_FUNCTION_CALL]},n.JavaScript.logic={},n.JavaScript.controls_if=function(t){var e=0,i="";n.JavaScript.STATEMENT_PREFIX&&(i+=n.JavaScript.injectId(n.JavaScript.STATEMENT_PREFIX,t));do{var o=n.JavaScript.valueToCode(t,"IF"+e,n.JavaScript.ORDER_NONE)||"false",r=n.JavaScript.statementToCode(t,"DO"+e);n.JavaScript.STATEMENT_SUFFIX&&(r=n.JavaScript.prefixLines(n.JavaScript.injectId(n.JavaScript.STATEMENT_SUFFIX,t),n.JavaScript.INDENT)+r),i+=(0<e?" else ":"")+"if ("+o+") {\n"+r+"}",++e}while(t.getInput("IF"+e));return(t.getInput("ELSE")||n.JavaScript.STATEMENT_SUFFIX)&&(r=n.JavaScript.statementToCode(t,"ELSE"),n.JavaScript.STATEMENT_SUFFIX&&(r=n.JavaScript.prefixLines(n.JavaScript.injectId(n.JavaScript.STATEMENT_SUFFIX,t),n.JavaScript.INDENT)+r),i+=" else {\n"+r+"}"),i+"\n"},n.JavaScript.controls_ifelse=n.JavaScript.controls_if,n.JavaScript.logic_compare=function(t){var e={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[t.getFieldValue("OP")],i="=="==e||"!="==e?n.JavaScript.ORDER_EQUALITY:n.JavaScript.ORDER_RELATIONAL;return[(n.JavaScript.valueToCode(t,"A",i)||"0")+" "+e+" "+(t=n.JavaScript.valueToCode(t,"B",i)||"0"),i]},n.JavaScript.logic_operation=function(t){var e="AND"==t.getFieldValue("OP")?"&&":"||",i="&&"==e?n.JavaScript.ORDER_LOGICAL_AND:n.JavaScript.ORDER_LOGICAL_OR,o=n.JavaScript.valueToCode(t,"A",i);if(t=n.JavaScript.valueToCode(t,"B",i),o||t){var r="&&"==e?"true":"false";o||(o=r),t||(t=r)}else t=o="false";return[o+" "+e+" "+t,i]},n.JavaScript.logic_negate=function(t){var e=n.JavaScript.ORDER_LOGICAL_NOT;return["!"+(n.JavaScript.valueToCode(t,"BOOL",e)||"true"),e]},n.JavaScript.logic_boolean=function(t){return["TRUE"==t.getFieldValue("BOOL")?"true":"false",n.JavaScript.ORDER_ATOMIC]},n.JavaScript.logic_null=function(t){return["null",n.JavaScript.ORDER_ATOMIC]},n.JavaScript.logic_ternary=function(t){return[(n.JavaScript.valueToCode(t,"IF",n.JavaScript.ORDER_CONDITIONAL)||"false")+" ? "+(n.JavaScript.valueToCode(t,"THEN",n.JavaScript.ORDER_CONDITIONAL)||"null")+" : "+(t=n.JavaScript.valueToCode(t,"ELSE",n.JavaScript.ORDER_CONDITIONAL)||"null"),n.JavaScript.ORDER_CONDITIONAL]},n.JavaScript.loops={},n.JavaScript.controls_repeat_ext=function(t){var e=t.getField("TIMES")?String(Number(t.getFieldValue("TIMES"))):n.JavaScript.valueToCode(t,"TIMES",n.JavaScript.ORDER_ASSIGNMENT)||"0",i=n.JavaScript.statementToCode(t,"DO");i=n.JavaScript.addLoopTrap(i,t),t="";var o=n.JavaScript.variableDB_.getDistinctName("count",n.VARIABLE_CATEGORY_NAME),r=e;return e.match(/^\w+$/)||n.isNumber(e)||(t+="var "+(r=n.JavaScript.variableDB_.getDistinctName("repeat_end",n.VARIABLE_CATEGORY_NAME))+" = "+e+";\n"),t+"for (var "+o+" = 0; "+o+" < "+r+"; "+o+"++) {\n"+i+"}\n"},n.JavaScript.controls_repeat=n.JavaScript.controls_repeat_ext,n.JavaScript.controls_whileUntil=function(t){var e="UNTIL"==t.getFieldValue("MODE"),i=n.JavaScript.valueToCode(t,"BOOL",e?n.JavaScript.ORDER_LOGICAL_NOT:n.JavaScript.ORDER_NONE)||"false",o=n.JavaScript.statementToCode(t,"DO");return e&&(i="!"+i),"while ("+i+") {\n"+(o=n.JavaScript.addLoopTrap(o,t))+"}\n"},n.JavaScript.controls_for=function(t){var e=n.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME),i=n.JavaScript.valueToCode(t,"FROM",n.JavaScript.ORDER_ASSIGNMENT)||"0",o=n.JavaScript.valueToCode(t,"TO",n.JavaScript.ORDER_ASSIGNMENT)||"0",r=n.JavaScript.valueToCode(t,"BY",n.JavaScript.ORDER_ASSIGNMENT)||"1",s=n.JavaScript.statementToCode(t,"DO");if(s=n.JavaScript.addLoopTrap(s,t),n.isNumber(i)&&n.isNumber(o)&&n.isNumber(r)){var a=Number(i)<=Number(o);t="for ("+e+" = "+i+"; "+e+(a?" <= ":" >= ")+o+"; "+e,t=(1==(e=Math.abs(Number(r)))?t+(a?"++":"--"):t+(a?" += ":" -= ")+e)+") {\n"+s+"}\n"}else t="",a=i,i.match(/^\w+$/)||n.isNumber(i)||(t+="var "+(a=n.JavaScript.variableDB_.getDistinctName(e+"_start",n.VARIABLE_CATEGORY_NAME))+" = "+i+";\n"),i=o,o.match(/^\w+$/)||n.isNumber(o)||(t+="var "+(i=n.JavaScript.variableDB_.getDistinctName(e+"_end",n.VARIABLE_CATEGORY_NAME))+" = "+o+";\n"),t+="var "+(o=n.JavaScript.variableDB_.getDistinctName(e+"_inc",n.VARIABLE_CATEGORY_NAME))+" = ",t=(t=n.isNumber(r)?t+(Math.abs(r)+";\n"):t+"Math.abs("+r+");\n")+"if ("+a+" > "+i+") {\n"+(n.JavaScript.INDENT+o)+" = -"+o+";\n",t+="}\n",t+="for ("+e+" = "+a+"; "+o+" >= 0 ? "+e+" <= "+i+" : "+e+" >= "+i+"; "+e+" += "+o+") {\n"+s+"}\n";return t},n.JavaScript.controls_forEach=function(t){var e=n.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME),i=n.JavaScript.valueToCode(t,"LIST",n.JavaScript.ORDER_ASSIGNMENT)||"[]",o=n.JavaScript.statementToCode(t,"DO");o=n.JavaScript.addLoopTrap(o,t),t="";var r=i;return i.match(/^\w+$/)||(t+="var "+(r=n.JavaScript.variableDB_.getDistinctName(e+"_list",n.VARIABLE_CATEGORY_NAME))+" = "+i+";\n"),t+"for (var "+(i=n.JavaScript.variableDB_.getDistinctName(e+"_index",n.VARIABLE_CATEGORY_NAME))+" in "+r+") {\n"+(o=n.JavaScript.INDENT+e+" = "+r+"["+i+"];\n"+o)+"}\n"},n.JavaScript.controls_flow_statements=function(t){var e="";if(n.JavaScript.STATEMENT_PREFIX&&(e+=n.JavaScript.injectId(n.JavaScript.STATEMENT_PREFIX,t)),n.JavaScript.STATEMENT_SUFFIX&&(e+=n.JavaScript.injectId(n.JavaScript.STATEMENT_SUFFIX,t)),n.JavaScript.STATEMENT_PREFIX){var i=n.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.getSurroundLoop(t);i&&!i.suppressPrefixSuffix&&(e+=n.JavaScript.injectId(n.JavaScript.STATEMENT_PREFIX,i))}switch(t.getFieldValue("FLOW")){case"BREAK":return e+"break;\n";case"CONTINUE":return e+"continue;\n"}throw Error("Unknown flow statement.")},n.JavaScript.math={},n.JavaScript.math_number=function(t){return[t=Number(t.getFieldValue("NUM")),0<=t?n.JavaScript.ORDER_ATOMIC:n.JavaScript.ORDER_UNARY_NEGATION]},n.JavaScript.math_arithmetic=function(t){var e={ADD:[" + ",n.JavaScript.ORDER_ADDITION],MINUS:[" - ",n.JavaScript.ORDER_SUBTRACTION],MULTIPLY:[" * ",n.JavaScript.ORDER_MULTIPLICATION],DIVIDE:[" / ",n.JavaScript.ORDER_DIVISION],POWER:[null,n.JavaScript.ORDER_NONE]}[t.getFieldValue("OP")],i=e[0];e=e[1];var o=n.JavaScript.valueToCode(t,"A",e)||"0";return t=n.JavaScript.valueToCode(t,"B",e)||"0",i?[o+i+t,e]:["Math.pow("+o+", "+t+")",n.JavaScript.ORDER_FUNCTION_CALL]},n.JavaScript.math_single=function(t){var e=t.getFieldValue("OP");if("NEG"==e)return"-"==(t=n.JavaScript.valueToCode(t,"NUM",n.JavaScript.ORDER_UNARY_NEGATION)||"0")[0]&&(t=" "+t),["-"+t,n.JavaScript.ORDER_UNARY_NEGATION];switch(t="SIN"==e||"COS"==e||"TAN"==e?n.JavaScript.valueToCode(t,"NUM",n.JavaScript.ORDER_DIVISION)||"0":n.JavaScript.valueToCode(t,"NUM",n.JavaScript.ORDER_NONE)||"0",e){case"ABS":var i="Math.abs("+t+")";break;case"ROOT":i="Math.sqrt("+t+")";break;case"LN":i="Math.log("+t+")";break;case"EXP":i="Math.exp("+t+")";break;case"POW10":i="Math.pow(10,"+t+")";break;case"ROUND":i="Math.round("+t+")";break;case"ROUNDUP":i="Math.ceil("+t+")";break;case"ROUNDDOWN":i="Math.floor("+t+")";break;case"SIN":i="Math.sin("+t+" / 180 * Math.PI)";break;case"COS":i="Math.cos("+t+" / 180 * Math.PI)";break;case"TAN":i="Math.tan("+t+" / 180 * Math.PI)"}if(i)return[i,n.JavaScript.ORDER_FUNCTION_CALL];switch(e){case"LOG10":i="Math.log("+t+") / Math.log(10)";break;case"ASIN":i="Math.asin("+t+") / Math.PI * 180";break;case"ACOS":i="Math.acos("+t+") / Math.PI * 180";break;case"ATAN":i="Math.atan("+t+") / Math.PI * 180";break;default:throw Error("Unknown math operator: "+e)}return[i,n.JavaScript.ORDER_DIVISION]},n.JavaScript.math_constant=function(t){return{PI:["Math.PI",n.JavaScript.ORDER_MEMBER],E:["Math.E",n.JavaScript.ORDER_MEMBER],GOLDEN_RATIO:["(1 + Math.sqrt(5)) / 2",n.JavaScript.ORDER_DIVISION],SQRT2:["Math.SQRT2",n.JavaScript.ORDER_MEMBER],SQRT1_2:["Math.SQRT1_2",n.JavaScript.ORDER_MEMBER],INFINITY:["Infinity",n.JavaScript.ORDER_ATOMIC]}[t.getFieldValue("CONSTANT")]},n.JavaScript.math_number_property=function(t){var e=n.JavaScript.valueToCode(t,"NUMBER_TO_CHECK",n.JavaScript.ORDER_MODULUS)||"0",i=t.getFieldValue("PROPERTY");if("PRIME"==i)return[n.JavaScript.provideFunction_("mathIsPrime",["function "+n.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(n) {","  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods","  if (n == 2 || n == 3) {","    return true;","  }","  // False if n is NaN, negative, is 1, or not whole.","  // And false if n is divisible by 2 or 3.","  if (isNaN(n) || n <= 1 || n % 1 != 0 || n % 2 == 0 || n % 3 == 0) {","    return false;","  }","  // Check all the numbers of form 6k +/- 1, up to sqrt(n).","  for (var x = 6; x <= Math.sqrt(n) + 1; x += 6) {","    if (n % (x - 1) == 0 || n % (x + 1) == 0) {","      return false;","    }","  }","  return true;","}"])+"("+e+")",n.JavaScript.ORDER_FUNCTION_CALL];switch(i){case"EVEN":var o=e+" % 2 == 0";break;case"ODD":o=e+" % 2 == 1";break;case"WHOLE":o=e+" % 1 == 0";break;case"POSITIVE":o=e+" > 0";break;case"NEGATIVE":o=e+" < 0";break;case"DIVISIBLE_BY":o=e+" % "+(t=n.JavaScript.valueToCode(t,"DIVISOR",n.JavaScript.ORDER_MODULUS)||"0")+" == 0"}return[o,n.JavaScript.ORDER_EQUALITY]},n.JavaScript.math_change=function(t){var e=n.JavaScript.valueToCode(t,"DELTA",n.JavaScript.ORDER_ADDITION)||"0";return(t=n.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME))+" = (typeof "+t+" == 'number' ? "+t+" : 0) + "+e+";\n"},n.JavaScript.math_round=n.JavaScript.math_single,n.JavaScript.math_trig=n.JavaScript.math_single,n.JavaScript.math_on_list=function(t){var e=t.getFieldValue("OP");switch(e){case"SUM":t=n.JavaScript.valueToCode(t,"LIST",n.JavaScript.ORDER_MEMBER)||"[]",t+=".reduce(function(x, y) {return x + y;})";break;case"MIN":t="Math.min.apply(null, "+(t=n.JavaScript.valueToCode(t,"LIST",n.JavaScript.ORDER_NONE)||"[]")+")";break;case"MAX":t="Math.max.apply(null, "+(t=n.JavaScript.valueToCode(t,"LIST",n.JavaScript.ORDER_NONE)||"[]")+")";break;case"AVERAGE":t=(e=n.JavaScript.provideFunction_("mathMean",["function "+n.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(myList) {","  return myList.reduce(function(x, y) {return x + y;}) / myList.length;","}"]))+"("+(t=n.JavaScript.valueToCode(t,"LIST",n.JavaScript.ORDER_NONE)||"[]")+")";break;case"MEDIAN":t=(e=n.JavaScript.provideFunction_("mathMedian",["function "+n.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(myList) {","  var localList = myList.filter(function (x) {return typeof x == 'number';});","  if (!localList.length) return null;","  localList.sort(function(a, b) {return b - a;});","  if (localList.length % 2 == 0) {","    return (localList[localList.length / 2 - 1] + localList[localList.length / 2]) / 2;","  } else {","    return localList[(localList.length - 1) / 2];","  }","}"]))+"("+(t=n.JavaScript.valueToCode(t,"LIST",n.JavaScript.ORDER_NONE)||"[]")+")";break;case"MODE":t=(e=n.JavaScript.provideFunction_("mathModes",["function "+n.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(values) {","  var modes = [];","  var counts = [];","  var maxCount = 0;","  for (var i = 0; i < values.length; i++) {","    var value = values[i];","    var found = false;","    var thisCount;","    for (var j = 0; j < counts.length; j++) {","      if (counts[j][0] === value) {","        thisCount = ++counts[j][1];","        found = true;","        break;","      }","    }","    if (!found) {","      counts.push([value, 1]);","      thisCount = 1;","    }","    maxCount = Math.max(thisCount, maxCount);","  }","  for (var j = 0; j < counts.length; j++) {","    if (counts[j][1] == maxCount) {","        modes.push(counts[j][0]);","    }","  }","  return modes;","}"]))+"("+(t=n.JavaScript.valueToCode(t,"LIST",n.JavaScript.ORDER_NONE)||"[]")+")";break;case"STD_DEV":t=(e=n.JavaScript.provideFunction_("mathStandardDeviation",["function "+n.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(numbers) {","  var n = numbers.length;","  if (!n) return null;","  var mean = numbers.reduce(function(x, y) {return x + y;}) / n;","  var variance = 0;","  for (var j = 0; j < n; j++) {","    variance += Math.pow(numbers[j] - mean, 2);","  }","  variance = variance / n;","  return Math.sqrt(variance);","}"]))+"("+(t=n.JavaScript.valueToCode(t,"LIST",n.JavaScript.ORDER_NONE)||"[]")+")";break;case"RANDOM":t=(e=n.JavaScript.provideFunction_("mathRandomList",["function "+n.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(list) {","  var x = Math.floor(Math.random() * list.length);","  return list[x];","}"]))+"("+(t=n.JavaScript.valueToCode(t,"LIST",n.JavaScript.ORDER_NONE)||"[]")+")";break;default:throw Error("Unknown operator: "+e)}return[t,n.JavaScript.ORDER_FUNCTION_CALL]},n.JavaScript.math_modulo=function(t){return[(n.JavaScript.valueToCode(t,"DIVIDEND",n.JavaScript.ORDER_MODULUS)||"0")+" % "+(t=n.JavaScript.valueToCode(t,"DIVISOR",n.JavaScript.ORDER_MODULUS)||"0"),n.JavaScript.ORDER_MODULUS]},n.JavaScript.math_constrain=function(t){return["Math.min(Math.max("+(n.JavaScript.valueToCode(t,"VALUE",n.JavaScript.ORDER_NONE)||"0")+", "+(n.JavaScript.valueToCode(t,"LOW",n.JavaScript.ORDER_NONE)||"0")+"), "+(t=n.JavaScript.valueToCode(t,"HIGH",n.JavaScript.ORDER_NONE)||"Infinity")+")",n.JavaScript.ORDER_FUNCTION_CALL]},n.JavaScript.math_random_int=function(t){var e=n.JavaScript.valueToCode(t,"FROM",n.JavaScript.ORDER_NONE)||"0";return t=n.JavaScript.valueToCode(t,"TO",n.JavaScript.ORDER_NONE)||"0",[n.JavaScript.provideFunction_("mathRandomInt",["function "+n.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(a, b) {","  if (a > b) {","    // Swap a and b to ensure a is smaller.","    var c = a;","    a = b;","    b = c;","  }","  return Math.floor(Math.random() * (b - a + 1) + a);","}"])+"("+e+", "+t+")",n.JavaScript.ORDER_FUNCTION_CALL]},n.JavaScript.math_random_float=function(t){return["Math.random()",n.JavaScript.ORDER_FUNCTION_CALL]},n.JavaScript.math_atan2=function(t){var e=n.JavaScript.valueToCode(t,"X",n.JavaScript.ORDER_NONE)||"0";return["Math.atan2("+(n.JavaScript.valueToCode(t,"Y",n.JavaScript.ORDER_NONE)||"0")+", "+e+") / Math.PI * 180",n.JavaScript.ORDER_DIVISION]},n.JavaScript.procedures={},n.JavaScript.procedures_defreturn=function(t){var e=n.JavaScript.variableDB_.getName(t.getFieldValue("NAME"),n.PROCEDURE_CATEGORY_NAME),i="";n.JavaScript.STATEMENT_PREFIX&&(i+=n.JavaScript.injectId(n.JavaScript.STATEMENT_PREFIX,t)),n.JavaScript.STATEMENT_SUFFIX&&(i+=n.JavaScript.injectId(n.JavaScript.STATEMENT_SUFFIX,t)),i&&(i=n.JavaScript.prefixLines(i,n.JavaScript.INDENT));var o="";n.JavaScript.INFINITE_LOOP_TRAP&&(o=n.JavaScript.prefixLines(n.JavaScript.injectId(n.JavaScript.INFINITE_LOOP_TRAP,t),n.JavaScript.INDENT));var r=n.JavaScript.statementToCode(t,"STACK"),s=n.JavaScript.valueToCode(t,"RETURN",n.JavaScript.ORDER_NONE)||"",a="";r&&s&&(a=i),s&&(s=n.JavaScript.INDENT+"return "+s+";\n");for(var l=[],c=t.getVars(),d=0;d<c.length;d++)l[d]=n.JavaScript.variableDB_.getName(c[d],n.VARIABLE_CATEGORY_NAME);return i="function "+e+"("+l.join(", ")+") {\n"+i+o+r+a+s+"}",i=n.JavaScript.scrub_(t,i),n.JavaScript.definitions_["%"+e]=i,null},n.JavaScript.procedures_defnoreturn=n.JavaScript.procedures_defreturn,n.JavaScript.procedures_callreturn=function(t){for(var e=n.JavaScript.variableDB_.getName(t.getFieldValue("NAME"),n.PROCEDURE_CATEGORY_NAME),i=[],o=t.getVars(),r=0;r<o.length;r++)i[r]=n.JavaScript.valueToCode(t,"ARG"+r,n.JavaScript.ORDER_NONE)||"null";return[e+"("+i.join(", ")+")",n.JavaScript.ORDER_FUNCTION_CALL]},n.JavaScript.procedures_callnoreturn=function(t){return n.JavaScript.procedures_callreturn(t)[0]+";\n"},n.JavaScript.procedures_ifreturn=function(t){var e="if ("+(n.JavaScript.valueToCode(t,"CONDITION",n.JavaScript.ORDER_NONE)||"false")+") {\n";return n.JavaScript.STATEMENT_SUFFIX&&(e+=n.JavaScript.prefixLines(n.JavaScript.injectId(n.JavaScript.STATEMENT_SUFFIX,t),n.JavaScript.INDENT)),t.hasReturnValue_?(t=n.JavaScript.valueToCode(t,"VALUE",n.JavaScript.ORDER_NONE)||"null",e+=n.JavaScript.INDENT+"return "+t+";\n"):e+=n.JavaScript.INDENT+"return;\n",e+"}\n"},n.JavaScript.texts={},n.JavaScript.text=function(t){return[n.JavaScript.quote_(t.getFieldValue("TEXT")),n.JavaScript.ORDER_ATOMIC]},n.JavaScript.text_multiline=function(t){var e=-1!=(t=n.JavaScript.multiline_quote_(t.getFieldValue("TEXT"))).indexOf("+")?n.JavaScript.ORDER_ADDITION:n.JavaScript.ORDER_ATOMIC;return[t,e]},n.JavaScript.text.forceString_=function(t){return n.JavaScript.text.forceString_.strRegExp.test(t)?[t,n.JavaScript.ORDER_ATOMIC]:["String("+t+")",n.JavaScript.ORDER_FUNCTION_CALL]},n.JavaScript.text.forceString_.strRegExp=/^\s*'([^']|\\')*'\s*$/,n.JavaScript.text_join=function(t){switch(t.itemCount_){case 0:return["''",n.JavaScript.ORDER_ATOMIC];case 1:return t=n.JavaScript.valueToCode(t,"ADD0",n.JavaScript.ORDER_NONE)||"''",n.JavaScript.text.forceString_(t);case 2:var e=n.JavaScript.valueToCode(t,"ADD0",n.JavaScript.ORDER_NONE)||"''";return t=n.JavaScript.valueToCode(t,"ADD1",n.JavaScript.ORDER_NONE)||"''",[t=n.JavaScript.text.forceString_(e)[0]+" + "+n.JavaScript.text.forceString_(t)[0],n.JavaScript.ORDER_ADDITION];default:e=Array(t.itemCount_);for(var i=0;i<t.itemCount_;i++)e[i]=n.JavaScript.valueToCode(t,"ADD"+i,n.JavaScript.ORDER_NONE)||"''";return[t="["+e.join(",")+"].join('')",n.JavaScript.ORDER_FUNCTION_CALL]}},n.JavaScript.text_append=function(t){var e=n.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME);return t=n.JavaScript.valueToCode(t,"TEXT",n.JavaScript.ORDER_NONE)||"''",e+" += "+n.JavaScript.text.forceString_(t)[0]+";\n"},n.JavaScript.text_length=function(t){return[(n.JavaScript.valueToCode(t,"VALUE",n.JavaScript.ORDER_MEMBER)||"''")+".length",n.JavaScript.ORDER_MEMBER]},n.JavaScript.text_isEmpty=function(t){return["!"+(n.JavaScript.valueToCode(t,"VALUE",n.JavaScript.ORDER_MEMBER)||"''")+".length",n.JavaScript.ORDER_LOGICAL_NOT]},n.JavaScript.text_indexOf=function(t){var e="FIRST"==t.getFieldValue("END")?"indexOf":"lastIndexOf",i=n.JavaScript.valueToCode(t,"FIND",n.JavaScript.ORDER_NONE)||"''";return e=(n.JavaScript.valueToCode(t,"VALUE",n.JavaScript.ORDER_MEMBER)||"''")+"."+e+"("+i+")",t.workspace.options.oneBasedIndex?[e+" + 1",n.JavaScript.ORDER_ADDITION]:[e,n.JavaScript.ORDER_FUNCTION_CALL]},n.JavaScript.text_charAt=function(t){var e=t.getFieldValue("WHERE")||"FROM_START",i=n.JavaScript.valueToCode(t,"VALUE","RANDOM"==e?n.JavaScript.ORDER_NONE:n.JavaScript.ORDER_MEMBER)||"''";switch(e){case"FIRST":return[i+".charAt(0)",n.JavaScript.ORDER_FUNCTION_CALL];case"LAST":return[i+".slice(-1)",n.JavaScript.ORDER_FUNCTION_CALL];case"FROM_START":return[i+".charAt("+(t=n.JavaScript.getAdjusted(t,"AT"))+")",n.JavaScript.ORDER_FUNCTION_CALL];case"FROM_END":return[i+".slice("+(t=n.JavaScript.getAdjusted(t,"AT",1,!0))+").charAt(0)",n.JavaScript.ORDER_FUNCTION_CALL];case"RANDOM":return[n.JavaScript.provideFunction_("textRandomLetter",["function "+n.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(text) {","  var x = Math.floor(Math.random() * text.length);","  return text[x];","}"])+"("+i+")",n.JavaScript.ORDER_FUNCTION_CALL]}throw Error("Unhandled option (text_charAt).")},n.JavaScript.text.getIndex_=function(t,e,n){return"FIRST"==e?"0":"FROM_END"==e?t+".length - 1 - "+n:"LAST"==e?t+".length - 1":n},n.JavaScript.text_getSubstring=function(t){var e=t.getFieldValue("WHERE1"),i=t.getFieldValue("WHERE2"),o="FROM_END"!=e&&"LAST"!=e&&"FROM_END"!=i&&"LAST"!=i,r=n.JavaScript.valueToCode(t,"STRING",o?n.JavaScript.ORDER_MEMBER:n.JavaScript.ORDER_NONE)||"''";if("FIRST"==e&&"LAST"==i)return[r,n.JavaScript.ORDER_NONE];if(r.match(/^'?\w+'?$/)||o){switch(e){case"FROM_START":o=n.JavaScript.getAdjusted(t,"AT1");break;case"FROM_END":o=r+".length - "+(o=n.JavaScript.getAdjusted(t,"AT1",1,!1,n.JavaScript.ORDER_SUBTRACTION));break;case"FIRST":o="0";break;default:throw Error("Unhandled option (text_getSubstring).")}switch(i){case"FROM_START":t=n.JavaScript.getAdjusted(t,"AT2",1);break;case"FROM_END":t=r+".length - "+(t=n.JavaScript.getAdjusted(t,"AT2",0,!1,n.JavaScript.ORDER_SUBTRACTION));break;case"LAST":t=r+".length";break;default:throw Error("Unhandled option (text_getSubstring).")}e=r+".slice("+o+", "+t+")"}else{o=n.JavaScript.getAdjusted(t,"AT1"),t=n.JavaScript.getAdjusted(t,"AT2");var s=n.JavaScript.text.getIndex_,a={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};e=n.JavaScript.provideFunction_("subsequence"+a[e]+a[i],["function "+n.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(sequence"+("FROM_END"==e||"FROM_START"==e?", at1":"")+("FROM_END"==i||"FROM_START"==i?", at2":"")+") {","  var start = "+s("sequence",e,"at1")+";","  var end = "+s("sequence",i,"at2")+" + 1;","  return sequence.slice(start, end);","}"])+"("+r+("FROM_END"==e||"FROM_START"==e?", "+o:"")+("FROM_END"==i||"FROM_START"==i?", "+t:"")+")"}return[e,n.JavaScript.ORDER_FUNCTION_CALL]},n.JavaScript.text_changeCase=function(t){var e={UPPERCASE:".toUpperCase()",LOWERCASE:".toLowerCase()",TITLECASE:null}[t.getFieldValue("CASE")];return t=n.JavaScript.valueToCode(t,"TEXT",e?n.JavaScript.ORDER_MEMBER:n.JavaScript.ORDER_NONE)||"''",[e?t+e:n.JavaScript.provideFunction_("textToTitleCase",["function "+n.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(str) {","  return str.replace(/\\S+/g,","      function(txt) {return txt[0].toUpperCase() + txt.substring(1).toLowerCase();});","}"])+"("+t+")",n.JavaScript.ORDER_FUNCTION_CALL]},n.JavaScript.text_trim=function(t){var e={LEFT:".replace(/^[\\s\\xa0]+/, '')",RIGHT:".replace(/[\\s\\xa0]+$/, '')",BOTH:".trim()"}[t.getFieldValue("MODE")];return[(n.JavaScript.valueToCode(t,"TEXT",n.JavaScript.ORDER_MEMBER)||"''")+e,n.JavaScript.ORDER_FUNCTION_CALL]},n.JavaScript.text_print=function(t){return"window.alert("+(n.JavaScript.valueToCode(t,"TEXT",n.JavaScript.ORDER_NONE)||"''")+");\n"},n.JavaScript.text_prompt_ext=function(t){var e="window.prompt("+(t.getField("TEXT")?n.JavaScript.quote_(t.getFieldValue("TEXT")):n.JavaScript.valueToCode(t,"TEXT",n.JavaScript.ORDER_NONE)||"''")+")";return"NUMBER"==t.getFieldValue("TYPE")&&(e="Number("+e+")"),[e,n.JavaScript.ORDER_FUNCTION_CALL]},n.JavaScript.text_prompt=n.JavaScript.text_prompt_ext,n.JavaScript.text_count=function(t){var e=n.JavaScript.valueToCode(t,"TEXT",n.JavaScript.ORDER_NONE)||"''";return t=n.JavaScript.valueToCode(t,"SUB",n.JavaScript.ORDER_NONE)||"''",[n.JavaScript.provideFunction_("textCount",["function "+n.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(haystack, needle) {","  if (needle.length === 0) {","    return haystack.length + 1;","  } else {","    return haystack.split(needle).length - 1;","  }","}"])+"("+e+", "+t+")",n.JavaScript.ORDER_FUNCTION_CALL]},n.JavaScript.text_replace=function(t){var e=n.JavaScript.valueToCode(t,"TEXT",n.JavaScript.ORDER_NONE)||"''",i=n.JavaScript.valueToCode(t,"FROM",n.JavaScript.ORDER_NONE)||"''";return t=n.JavaScript.valueToCode(t,"TO",n.JavaScript.ORDER_NONE)||"''",[n.JavaScript.provideFunction_("textReplace",["function "+n.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(haystack, needle, replacement) {",'  needle = needle.replace(/([-()\\[\\]{}+?*.$\\^|,:#<!\\\\])/g,"\\\\$1")','                 .replace(/\\x08/g,"\\\\x08");',"  return haystack.replace(new RegExp(needle, 'g'), replacement);","}"])+"("+e+", "+i+", "+t+")",n.JavaScript.ORDER_FUNCTION_CALL]},n.JavaScript.text_reverse=function(t){return[(n.JavaScript.valueToCode(t,"TEXT",n.JavaScript.ORDER_MEMBER)||"''")+".split('').reverse().join('')",n.JavaScript.ORDER_FUNCTION_CALL]},n.JavaScript.variables={},n.JavaScript.variables_get=function(t){return[n.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME),n.JavaScript.ORDER_ATOMIC]},n.JavaScript.variables_set=function(t){var e=n.JavaScript.valueToCode(t,"VALUE",n.JavaScript.ORDER_ASSIGNMENT)||"0";return n.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME)+" = "+e+";\n"},n.JavaScript.variablesDynamic={},n.JavaScript.variables_get_dynamic=n.JavaScript.variables_get,n.JavaScript.variables_set_dynamic=n.JavaScript.variables_set,n.JavaScript)})),BP=IP((function(t,e){var n;t.exports=(n=MP,DP.JavaScript=n,n)})),FP=IP((function(t,e){var n;t.exports=((n=kP).Python=new n.Generator("Python"),n.Python.addReservedWords("False,None,True,and,as,assert,break,class,continue,def,del,elif,else,except,exec,finally,for,from,global,if,import,in,is,lambda,nonlocal,not,or,pass,print,raise,return,try,while,with,yield,NotImplemented,Ellipsis,__debug__,quit,exit,copyright,license,credits,ArithmeticError,AssertionError,AttributeError,BaseException,BlockingIOError,BrokenPipeError,BufferError,BytesWarning,ChildProcessError,ConnectionAbortedError,ConnectionError,ConnectionRefusedError,ConnectionResetError,DeprecationWarning,EOFError,Ellipsis,EnvironmentError,Exception,FileExistsError,FileNotFoundError,FloatingPointError,FutureWarning,GeneratorExit,IOError,ImportError,ImportWarning,IndentationError,IndexError,InterruptedError,IsADirectoryError,KeyError,KeyboardInterrupt,LookupError,MemoryError,ModuleNotFoundError,NameError,NotADirectoryError,NotImplemented,NotImplementedError,OSError,OverflowError,PendingDeprecationWarning,PermissionError,ProcessLookupError,RecursionError,ReferenceError,ResourceWarning,RuntimeError,RuntimeWarning,StandardError,StopAsyncIteration,StopIteration,SyntaxError,SyntaxWarning,SystemError,SystemExit,TabError,TimeoutError,TypeError,UnboundLocalError,UnicodeDecodeError,UnicodeEncodeError,UnicodeError,UnicodeTranslateError,UnicodeWarning,UserWarning,ValueError,Warning,ZeroDivisionError,_,__build_class__,__debug__,__doc__,__import__,__loader__,__name__,__package__,__spec__,abs,all,any,apply,ascii,basestring,bin,bool,buffer,bytearray,bytes,callable,chr,classmethod,cmp,coerce,compile,complex,copyright,credits,delattr,dict,dir,divmod,enumerate,eval,exec,execfile,exit,file,filter,float,format,frozenset,getattr,globals,hasattr,hash,help,hex,id,input,int,intern,isinstance,issubclass,iter,len,license,list,locals,long,map,max,memoryview,min,next,object,oct,open,ord,pow,print,property,quit,range,raw_input,reduce,reload,repr,reversed,round,set,setattr,slice,sorted,staticmethod,str,sum,super,tuple,type,unichr,unicode,vars,xrange,zip"),n.Python.ORDER_ATOMIC=0,n.Python.ORDER_COLLECTION=1,n.Python.ORDER_STRING_CONVERSION=1,n.Python.ORDER_MEMBER=2.1,n.Python.ORDER_FUNCTION_CALL=2.2,n.Python.ORDER_EXPONENTIATION=3,n.Python.ORDER_UNARY_SIGN=4,n.Python.ORDER_BITWISE_NOT=4,n.Python.ORDER_MULTIPLICATIVE=5,n.Python.ORDER_ADDITIVE=6,n.Python.ORDER_BITWISE_SHIFT=7,n.Python.ORDER_BITWISE_AND=8,n.Python.ORDER_BITWISE_XOR=9,n.Python.ORDER_BITWISE_OR=10,n.Python.ORDER_RELATIONAL=11,n.Python.ORDER_LOGICAL_NOT=12,n.Python.ORDER_LOGICAL_AND=13,n.Python.ORDER_LOGICAL_OR=14,n.Python.ORDER_CONDITIONAL=15,n.Python.ORDER_LAMBDA=16,n.Python.ORDER_NONE=99,n.Python.ORDER_OVERRIDES=[[n.Python.ORDER_FUNCTION_CALL,n.Python.ORDER_MEMBER],[n.Python.ORDER_FUNCTION_CALL,n.Python.ORDER_FUNCTION_CALL],[n.Python.ORDER_MEMBER,n.Python.ORDER_MEMBER],[n.Python.ORDER_MEMBER,n.Python.ORDER_FUNCTION_CALL],[n.Python.ORDER_LOGICAL_NOT,n.Python.ORDER_LOGICAL_NOT],[n.Python.ORDER_LOGICAL_AND,n.Python.ORDER_LOGICAL_AND],[n.Python.ORDER_LOGICAL_OR,n.Python.ORDER_LOGICAL_OR]],n.Python.isInitialized=!1,n.Python.init=function(t){n.Python.PASS=this.INDENT+"pass\n",n.Python.definitions_=Object.create(null),n.Python.functionNames_=Object.create(null),n.Python.variableDB_?n.Python.variableDB_.reset():n.Python.variableDB_=new n.Names(n.Python.RESERVED_WORDS_),n.Python.variableDB_.setVariableMap(t.getVariableMap());for(var e=[],i=n.Variables.allDeveloperVariables(t),o=0;o<i.length;o++)e.push(n.Python.variableDB_.getName(i[o],n.Names.DEVELOPER_VARIABLE_TYPE)+" = None");for(t=n.Variables.allUsedVarModels(t),o=0;o<t.length;o++)e.push(n.Python.variableDB_.getName(t[o].getId(),n.VARIABLE_CATEGORY_NAME)+" = None");n.Python.definitions_.variables=e.join("\n"),this.isInitialized=!0},n.Python.finish=function(t){var e,i=[],o=[];for(e in n.Python.definitions_){var r=n.Python.definitions_[e];r.match(/^(from\s+\S+\s+)?import\s+\S+/)?i.push(r):o.push(r)}return delete n.Python.definitions_,delete n.Python.functionNames_,n.Python.variableDB_.reset(),(i.join("\n")+"\n\n"+o.join("\n\n")).replace(/\n\n+/g,"\n\n").replace(/\n*$/,"\n\n\n")+t},n.Python.scrubNakedValue=function(t){return t+"\n"},n.Python.quote_=function(t){var e="'";return-1!==(t=t.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n")).indexOf("'")&&(-1===t.indexOf('"')?e='"':t=t.replace(/'/g,"\\'")),e+t+e},n.Python.multiline_quote_=function(t){return t.split(/\n/g).map(n.Python.quote_).join(" + '\\n' + \n")},n.Python.scrub_=function(t,e,i){var o="";if(!t.outputConnection||!t.outputConnection.targetConnection){var r=t.getCommentText();r&&(r=n.utils.string.wrap(r,n.Python.COMMENT_WRAP-3),o+=n.Python.prefixLines(r+"\n","# "));for(var s=0;s<t.inputList.length;s++)t.inputList[s].type==n.INPUT_VALUE&&(r=t.inputList[s].connection.targetBlock())&&(r=n.Python.allNestedComments(r))&&(o+=n.Python.prefixLines(r,"# "))}return t=t.nextConnection&&t.nextConnection.targetBlock(),o+e+(i=i?"":n.Python.blockToCode(t))},n.Python.getAdjustedInt=function(t,e,i,o){i=i||0,t.workspace.options.oneBasedIndex&&i--;var r=t.workspace.options.oneBasedIndex?"1":"0";return t=n.Python.valueToCode(t,e,i?n.Python.ORDER_ADDITIVE:n.Python.ORDER_NONE)||r,n.isNumber(t)?(t=parseInt(t,10)+i,o&&(t=-t)):(t=0<i?"int("+t+" + "+i+")":0>i?"int("+t+" - "+-i+")":"int("+t+")",o&&(t="-"+t)),t},n.Python.colour={},n.Python.colour_picker=function(t){return[n.Python.quote_(t.getFieldValue("COLOUR")),n.Python.ORDER_ATOMIC]},n.Python.colour_random=function(t){return n.Python.definitions_.import_random="import random",["'#%06x' % random.randint(0, 2**24 - 1)",n.Python.ORDER_FUNCTION_CALL]},n.Python.colour_rgb=function(t){return[n.Python.provideFunction_("colour_rgb",["def "+n.Python.FUNCTION_NAME_PLACEHOLDER_+"(r, g, b):","  r = round(min(100, max(0, r)) * 2.55)","  g = round(min(100, max(0, g)) * 2.55)","  b = round(min(100, max(0, b)) * 2.55)","  return '#%02x%02x%02x' % (r, g, b)"])+"("+(n.Python.valueToCode(t,"RED",n.Python.ORDER_NONE)||0)+", "+(n.Python.valueToCode(t,"GREEN",n.Python.ORDER_NONE)||0)+", "+(t=n.Python.valueToCode(t,"BLUE",n.Python.ORDER_NONE)||0)+")",n.Python.ORDER_FUNCTION_CALL]},n.Python.colour_blend=function(t){return[n.Python.provideFunction_("colour_blend",["def "+n.Python.FUNCTION_NAME_PLACEHOLDER_+"(colour1, colour2, ratio):","  r1, r2 = int(colour1[1:3], 16), int(colour2[1:3], 16)","  g1, g2 = int(colour1[3:5], 16), int(colour2[3:5], 16)","  b1, b2 = int(colour1[5:7], 16), int(colour2[5:7], 16)","  ratio = min(1, max(0, ratio))","  r = round(r1 * (1 - ratio) + r2 * ratio)","  g = round(g1 * (1 - ratio) + g2 * ratio)","  b = round(b1 * (1 - ratio) + b2 * ratio)","  return '#%02x%02x%02x' % (r, g, b)"])+"("+(n.Python.valueToCode(t,"COLOUR1",n.Python.ORDER_NONE)||"'#000000'")+", "+(n.Python.valueToCode(t,"COLOUR2",n.Python.ORDER_NONE)||"'#000000'")+", "+(t=n.Python.valueToCode(t,"RATIO",n.Python.ORDER_NONE)||0)+")",n.Python.ORDER_FUNCTION_CALL]},n.Python.lists={},n.Python.lists_create_empty=function(t){return["[]",n.Python.ORDER_ATOMIC]},n.Python.lists_create_with=function(t){for(var e=Array(t.itemCount_),i=0;i<t.itemCount_;i++)e[i]=n.Python.valueToCode(t,"ADD"+i,n.Python.ORDER_NONE)||"None";return["["+e.join(", ")+"]",n.Python.ORDER_ATOMIC]},n.Python.lists_repeat=function(t){return["["+(n.Python.valueToCode(t,"ITEM",n.Python.ORDER_NONE)||"None")+"] * "+(t=n.Python.valueToCode(t,"NUM",n.Python.ORDER_MULTIPLICATIVE)||"0"),n.Python.ORDER_MULTIPLICATIVE]},n.Python.lists_length=function(t){return["len("+(n.Python.valueToCode(t,"VALUE",n.Python.ORDER_NONE)||"[]")+")",n.Python.ORDER_FUNCTION_CALL]},n.Python.lists_isEmpty=function(t){return["not len("+(n.Python.valueToCode(t,"VALUE",n.Python.ORDER_NONE)||"[]")+")",n.Python.ORDER_LOGICAL_NOT]},n.Python.lists_indexOf=function(t){var e=n.Python.valueToCode(t,"FIND",n.Python.ORDER_NONE)||"[]",i=n.Python.valueToCode(t,"VALUE",n.Python.ORDER_NONE)||"''";if(t.workspace.options.oneBasedIndex)var o=" 0",r=" + 1",s="";else o=" -1",r="",s=" - 1";return"FIRST"==t.getFieldValue("END")?[(t=n.Python.provideFunction_("first_index",["def "+n.Python.FUNCTION_NAME_PLACEHOLDER_+"(my_list, elem):","  try: index = my_list.index(elem)"+r,"  except: index ="+o,"  return index"]))+"("+i+", "+e+")",n.Python.ORDER_FUNCTION_CALL]:[(t=n.Python.provideFunction_("last_index",["def "+n.Python.FUNCTION_NAME_PLACEHOLDER_+"(my_list, elem):","  try: index = len(my_list) - my_list[::-1].index(elem)"+s,"  except: index ="+o,"  return index"]))+"("+i+", "+e+")",n.Python.ORDER_FUNCTION_CALL]},n.Python.lists_getIndex=function(t){var e=t.getFieldValue("MODE")||"GET",i=t.getFieldValue("WHERE")||"FROM_START",o=n.Python.valueToCode(t,"VALUE","RANDOM"==i?n.Python.ORDER_NONE:n.Python.ORDER_MEMBER)||"[]";switch(i){case"FIRST":if("GET"==e)return[o+"[0]",n.Python.ORDER_MEMBER];if("GET_REMOVE"==e)return[o+".pop(0)",n.Python.ORDER_FUNCTION_CALL];if("REMOVE"==e)return o+".pop(0)\n";break;case"LAST":if("GET"==e)return[o+"[-1]",n.Python.ORDER_MEMBER];if("GET_REMOVE"==e)return[o+".pop()",n.Python.ORDER_FUNCTION_CALL];if("REMOVE"==e)return o+".pop()\n";break;case"FROM_START":if(t=n.Python.getAdjustedInt(t,"AT"),"GET"==e)return[o+"["+t+"]",n.Python.ORDER_MEMBER];if("GET_REMOVE"==e)return[o+".pop("+t+")",n.Python.ORDER_FUNCTION_CALL];if("REMOVE"==e)return o+".pop("+t+")\n";break;case"FROM_END":if(t=n.Python.getAdjustedInt(t,"AT",1,!0),"GET"==e)return[o+"["+t+"]",n.Python.ORDER_MEMBER];if("GET_REMOVE"==e)return[o+".pop("+t+")",n.Python.ORDER_FUNCTION_CALL];if("REMOVE"==e)return o+".pop("+t+")\n";break;case"RANDOM":if(n.Python.definitions_.import_random="import random","GET"==e)return["random.choice("+o+")",n.Python.ORDER_FUNCTION_CALL];if(o=n.Python.provideFunction_("lists_remove_random_item",["def "+n.Python.FUNCTION_NAME_PLACEHOLDER_+"(myList):","  x = int(random.random() * len(myList))","  return myList.pop(x)"])+"("+o+")","GET_REMOVE"==e)return[o,n.Python.ORDER_FUNCTION_CALL];if("REMOVE"==e)return o+"\n"}throw Error("Unhandled combination (lists_getIndex).")},n.Python.lists_setIndex=function(t){var e=n.Python.valueToCode(t,"LIST",n.Python.ORDER_MEMBER)||"[]",i=t.getFieldValue("MODE")||"GET",o=t.getFieldValue("WHERE")||"FROM_START",r=n.Python.valueToCode(t,"TO",n.Python.ORDER_NONE)||"None";switch(o){case"FIRST":if("SET"==i)return e+"[0] = "+r+"\n";if("INSERT"==i)return e+".insert(0, "+r+")\n";break;case"LAST":if("SET"==i)return e+"[-1] = "+r+"\n";if("INSERT"==i)return e+".append("+r+")\n";break;case"FROM_START":if(t=n.Python.getAdjustedInt(t,"AT"),"SET"==i)return e+"["+t+"] = "+r+"\n";if("INSERT"==i)return e+".insert("+t+", "+r+")\n";break;case"FROM_END":if(t=n.Python.getAdjustedInt(t,"AT",1,!0),"SET"==i)return e+"["+t+"] = "+r+"\n";if("INSERT"==i)return e+".insert("+t+", "+r+")\n";break;case"RANDOM":if(n.Python.definitions_.import_random="import random",e.match(/^\w+$/)?t="":(o=(t=n.Python.variableDB_.getDistinctName("tmp_list",n.VARIABLE_CATEGORY_NAME))+" = "+e+"\n",e=t,t=o),t+=(o=n.Python.variableDB_.getDistinctName("tmp_x",n.VARIABLE_CATEGORY_NAME))+" = int(random.random() * len("+e+"))\n","SET"==i)return t+(e+"[")+o+"] = "+r+"\n";if("INSERT"==i)return t+(e+".insert(")+o+", "+r+")\n"}throw Error("Unhandled combination (lists_setIndex).")},n.Python.lists_getSublist=function(t){var e=n.Python.valueToCode(t,"LIST",n.Python.ORDER_MEMBER)||"[]",i=t.getFieldValue("WHERE1"),o=t.getFieldValue("WHERE2");switch(i){case"FROM_START":"0"==(i=n.Python.getAdjustedInt(t,"AT1"))&&(i="");break;case"FROM_END":i=n.Python.getAdjustedInt(t,"AT1",1,!0);break;case"FIRST":i="";break;default:throw Error("Unhandled option (lists_getSublist)")}switch(o){case"FROM_START":t=n.Python.getAdjustedInt(t,"AT2",1);break;case"FROM_END":t=n.Python.getAdjustedInt(t,"AT2",0,!0),n.isNumber(String(t))?"0"==t&&(t=""):(n.Python.definitions_.import_sys="import sys",t+=" or sys.maxsize");break;case"LAST":t="";break;default:throw Error("Unhandled option (lists_getSublist)")}return[e+"["+i+" : "+t+"]",n.Python.ORDER_MEMBER]},n.Python.lists_sort=function(t){var e=n.Python.valueToCode(t,"LIST",n.Python.ORDER_NONE)||"[]",i=t.getFieldValue("TYPE");return t="1"===t.getFieldValue("DIRECTION")?"False":"True",[n.Python.provideFunction_("lists_sort",["def "+n.Python.FUNCTION_NAME_PLACEHOLDER_+"(my_list, type, reverse):","  def try_float(s):","    try:","      return float(s)","    except:","      return 0","  key_funcs = {",'    "NUMERIC": try_float,','    "TEXT": str,','    "IGNORE_CASE": lambda s: str(s).lower()',"  }","  key_func = key_funcs[type]","  list_cpy = list(my_list)","  return sorted(list_cpy, key=key_func, reverse=reverse)"])+"("+e+', "'+i+'", '+t+")",n.Python.ORDER_FUNCTION_CALL]},n.Python.lists_split=function(t){var e=t.getFieldValue("MODE");if("SPLIT"==e)t=(e=n.Python.valueToCode(t,"INPUT",n.Python.ORDER_MEMBER)||"''")+".split("+(t=n.Python.valueToCode(t,"DELIM",n.Python.ORDER_NONE))+")";else{if("JOIN"!=e)throw Error("Unknown mode: "+e);e=n.Python.valueToCode(t,"INPUT",n.Python.ORDER_NONE)||"[]",t=(t=n.Python.valueToCode(t,"DELIM",n.Python.ORDER_MEMBER)||"''")+".join("+e+")"}return[t,n.Python.ORDER_FUNCTION_CALL]},n.Python.lists_reverse=function(t){return["list(reversed("+(n.Python.valueToCode(t,"LIST",n.Python.ORDER_NONE)||"[]")+"))",n.Python.ORDER_FUNCTION_CALL]},n.Python.logic={},n.Python.controls_if=function(t){var e=0,i="";n.Python.STATEMENT_PREFIX&&(i+=n.Python.injectId(n.Python.STATEMENT_PREFIX,t));do{var o=n.Python.valueToCode(t,"IF"+e,n.Python.ORDER_NONE)||"False",r=n.Python.statementToCode(t,"DO"+e)||n.Python.PASS;n.Python.STATEMENT_SUFFIX&&(r=n.Python.prefixLines(n.Python.injectId(n.Python.STATEMENT_SUFFIX,t),n.Python.INDENT)+r),i+=(0==e?"if ":"elif ")+o+":\n"+r,++e}while(t.getInput("IF"+e));return(t.getInput("ELSE")||n.Python.STATEMENT_SUFFIX)&&(r=n.Python.statementToCode(t,"ELSE")||n.Python.PASS,n.Python.STATEMENT_SUFFIX&&(r=n.Python.prefixLines(n.Python.injectId(n.Python.STATEMENT_SUFFIX,t),n.Python.INDENT)+r),i+="else:\n"+r),i},n.Python.controls_ifelse=n.Python.controls_if,n.Python.logic_compare=function(t){var e={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[t.getFieldValue("OP")],i=n.Python.ORDER_RELATIONAL;return[(n.Python.valueToCode(t,"A",i)||"0")+" "+e+" "+(t=n.Python.valueToCode(t,"B",i)||"0"),i]},n.Python.logic_operation=function(t){var e="AND"==t.getFieldValue("OP")?"and":"or",i="and"==e?n.Python.ORDER_LOGICAL_AND:n.Python.ORDER_LOGICAL_OR,o=n.Python.valueToCode(t,"A",i);if(t=n.Python.valueToCode(t,"B",i),o||t){var r="and"==e?"True":"False";o||(o=r),t||(t=r)}else t=o="False";return[o+" "+e+" "+t,i]},n.Python.logic_negate=function(t){return["not "+(n.Python.valueToCode(t,"BOOL",n.Python.ORDER_LOGICAL_NOT)||"True"),n.Python.ORDER_LOGICAL_NOT]},n.Python.logic_boolean=function(t){return["TRUE"==t.getFieldValue("BOOL")?"True":"False",n.Python.ORDER_ATOMIC]},n.Python.logic_null=function(t){return["None",n.Python.ORDER_ATOMIC]},n.Python.logic_ternary=function(t){var e=n.Python.valueToCode(t,"IF",n.Python.ORDER_CONDITIONAL)||"False";return[(n.Python.valueToCode(t,"THEN",n.Python.ORDER_CONDITIONAL)||"None")+" if "+e+" else "+(t=n.Python.valueToCode(t,"ELSE",n.Python.ORDER_CONDITIONAL)||"None"),n.Python.ORDER_CONDITIONAL]},n.Python.loops={},n.Python.controls_repeat_ext=function(t){var e=t.getField("TIMES")?String(parseInt(t.getFieldValue("TIMES"),10)):n.Python.valueToCode(t,"TIMES",n.Python.ORDER_NONE)||"0";e=n.isNumber(e)?parseInt(e,10):"int("+e+")";var i=n.Python.statementToCode(t,"DO");return i=n.Python.addLoopTrap(i,t)||n.Python.PASS,"for "+n.Python.variableDB_.getDistinctName("count",n.VARIABLE_CATEGORY_NAME)+" in range("+e+"):\n"+i},n.Python.controls_repeat=n.Python.controls_repeat_ext,n.Python.controls_whileUntil=function(t){var e="UNTIL"==t.getFieldValue("MODE"),i=n.Python.valueToCode(t,"BOOL",e?n.Python.ORDER_LOGICAL_NOT:n.Python.ORDER_NONE)||"False",o=n.Python.statementToCode(t,"DO");return e&&(i="not "+i),"while "+i+":\n"+(o=n.Python.addLoopTrap(o,t)||n.Python.PASS)},n.Python.controls_for=function(t){var e=n.Python.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME),i=n.Python.valueToCode(t,"FROM",n.Python.ORDER_NONE)||"0",o=n.Python.valueToCode(t,"TO",n.Python.ORDER_NONE)||"0",r=n.Python.valueToCode(t,"BY",n.Python.ORDER_NONE)||"1",s=n.Python.statementToCode(t,"DO");s=n.Python.addLoopTrap(s,t)||n.Python.PASS;var a="",l=function(){return n.Python.provideFunction_("upRange",["def "+n.Python.FUNCTION_NAME_PLACEHOLDER_+"(start, stop, step):","  while start <= stop:","    yield start","    start += abs(step)"])},c=function(){return n.Python.provideFunction_("downRange",["def "+n.Python.FUNCTION_NAME_PLACEHOLDER_+"(start, stop, step):","  while start >= stop:","    yield start","    start -= abs(step)"])};if(t=function(t,e,n){return"("+t+" <= "+e+") and "+l()+"("+t+", "+e+", "+n+") or "+c()+"("+t+", "+e+", "+n+")"},n.isNumber(i)&&n.isNumber(o)&&n.isNumber(r))i=Number(i),o=Number(o),r=Math.abs(Number(r)),0==i%1&&0==o%1&&0==r%1?(i<=o?(o++,t=0==i&&1==r?o:i+", "+o,1!=r&&(t+=", "+r)):t=i+", "+--o+", -"+r,t="range("+t+")"):(t=i<o?l():c(),t+="("+i+", "+o+", "+r+")");else{var d=function(t,i){return n.isNumber(t)?t=Number(t):t.match(/^\w+$/)?t="float("+t+")":(i=n.Python.variableDB_.getDistinctName(e+i,n.VARIABLE_CATEGORY_NAME),a+=i+" = float("+t+")\n",t=i),t};i=d(i,"_start"),o=d(o,"_end"),r=d(r,"_inc"),"number"==typeof i&&"number"==typeof o?(t=i<o?l():c(),t+="("+i+", "+o+", "+r+")"):t=t(i,o,r)}return a+="for "+e+" in "+t+":\n"+s},n.Python.controls_forEach=function(t){var e=n.Python.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME),i=n.Python.valueToCode(t,"LIST",n.Python.ORDER_RELATIONAL)||"[]",o=n.Python.statementToCode(t,"DO");return"for "+e+" in "+i+":\n"+(o=n.Python.addLoopTrap(o,t)||n.Python.PASS)},n.Python.controls_flow_statements=function(t){var e="";if(n.Python.STATEMENT_PREFIX&&(e+=n.Python.injectId(n.Python.STATEMENT_PREFIX,t)),n.Python.STATEMENT_SUFFIX&&(e+=n.Python.injectId(n.Python.STATEMENT_SUFFIX,t)),n.Python.STATEMENT_PREFIX){var i=n.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.getSurroundLoop(t);i&&!i.suppressPrefixSuffix&&(e+=n.Python.injectId(n.Python.STATEMENT_PREFIX,i))}switch(t.getFieldValue("FLOW")){case"BREAK":return e+"break\n";case"CONTINUE":return e+"continue\n"}throw Error("Unknown flow statement.")},n.Python.math={},n.Python.addReservedWords("math,random,Number"),n.Python.math_number=function(t){if(1/0==(t=Number(t.getFieldValue("NUM")))){t='float("inf")';var e=n.Python.ORDER_FUNCTION_CALL}else-1/0==t?(t='-float("inf")',e=n.Python.ORDER_UNARY_SIGN):e=0>t?n.Python.ORDER_UNARY_SIGN:n.Python.ORDER_ATOMIC;return[t,e]},n.Python.math_arithmetic=function(t){var e={ADD:[" + ",n.Python.ORDER_ADDITIVE],MINUS:[" - ",n.Python.ORDER_ADDITIVE],MULTIPLY:[" * ",n.Python.ORDER_MULTIPLICATIVE],DIVIDE:[" / ",n.Python.ORDER_MULTIPLICATIVE],POWER:[" ** ",n.Python.ORDER_EXPONENTIATION]}[t.getFieldValue("OP")],i=e[0];return e=e[1],[(n.Python.valueToCode(t,"A",e)||"0")+i+(t=n.Python.valueToCode(t,"B",e)||"0"),e]},n.Python.math_single=function(t){var e=t.getFieldValue("OP");if("NEG"==e){var i=n.Python.valueToCode(t,"NUM",n.Python.ORDER_UNARY_SIGN)||"0";return["-"+i,n.Python.ORDER_UNARY_SIGN]}switch(n.Python.definitions_.import_math="import math",t="SIN"==e||"COS"==e||"TAN"==e?n.Python.valueToCode(t,"NUM",n.Python.ORDER_MULTIPLICATIVE)||"0":n.Python.valueToCode(t,"NUM",n.Python.ORDER_NONE)||"0",e){case"ABS":i="math.fabs("+t+")";break;case"ROOT":i="math.sqrt("+t+")";break;case"LN":i="math.log("+t+")";break;case"LOG10":i="math.log10("+t+")";break;case"EXP":i="math.exp("+t+")";break;case"POW10":i="math.pow(10,"+t+")";break;case"ROUND":i="round("+t+")";break;case"ROUNDUP":i="math.ceil("+t+")";break;case"ROUNDDOWN":i="math.floor("+t+")";break;case"SIN":i="math.sin("+t+" / 180.0 * math.pi)";break;case"COS":i="math.cos("+t+" / 180.0 * math.pi)";break;case"TAN":i="math.tan("+t+" / 180.0 * math.pi)"}if(i)return[i,n.Python.ORDER_FUNCTION_CALL];switch(e){case"ASIN":i="math.asin("+t+") / math.pi * 180";break;case"ACOS":i="math.acos("+t+") / math.pi * 180";break;case"ATAN":i="math.atan("+t+") / math.pi * 180";break;default:throw Error("Unknown math operator: "+e)}return[i,n.Python.ORDER_MULTIPLICATIVE]},n.Python.math_constant=function(t){var e={PI:["math.pi",n.Python.ORDER_MEMBER],E:["math.e",n.Python.ORDER_MEMBER],GOLDEN_RATIO:["(1 + math.sqrt(5)) / 2",n.Python.ORDER_MULTIPLICATIVE],SQRT2:["math.sqrt(2)",n.Python.ORDER_MEMBER],SQRT1_2:["math.sqrt(1.0 / 2)",n.Python.ORDER_MEMBER],INFINITY:["float('inf')",n.Python.ORDER_ATOMIC]};return"INFINITY"!=(t=t.getFieldValue("CONSTANT"))&&(n.Python.definitions_.import_math="import math"),e[t]},n.Python.math_number_property=function(t){var e=n.Python.valueToCode(t,"NUMBER_TO_CHECK",n.Python.ORDER_MULTIPLICATIVE)||"0",i=t.getFieldValue("PROPERTY");if("PRIME"==i)return n.Python.definitions_.import_math="import math",n.Python.definitions_.from_numbers_import_Number="from numbers import Number",[n.Python.provideFunction_("math_isPrime",["def "+n.Python.FUNCTION_NAME_PLACEHOLDER_+"(n):","  # https://en.wikipedia.org/wiki/Primality_test#Naive_methods","  # If n is not a number but a string, try parsing it.","  if not isinstance(n, Number):","    try:","      n = float(n)","    except:","      return False","  if n == 2 or n == 3:","    return True","  # False if n is negative, is 1, or not whole, or if n is divisible by 2 or 3.","  if n <= 1 or n % 1 != 0 or n % 2 == 0 or n % 3 == 0:","    return False","  # Check all the numbers of form 6k +/- 1, up to sqrt(n).","  for x in range(6, int(math.sqrt(n)) + 2, 6):","    if n % (x - 1) == 0 or n % (x + 1) == 0:","      return False","  return True"])+"("+e+")",n.Python.ORDER_FUNCTION_CALL];switch(i){case"EVEN":var o=e+" % 2 == 0";break;case"ODD":o=e+" % 2 == 1";break;case"WHOLE":o=e+" % 1 == 0";break;case"POSITIVE":o=e+" > 0";break;case"NEGATIVE":o=e+" < 0";break;case"DIVISIBLE_BY":if(!(t=n.Python.valueToCode(t,"DIVISOR",n.Python.ORDER_MULTIPLICATIVE))||"0"==t)return["False",n.Python.ORDER_ATOMIC];o=e+" % "+t+" == 0"}return[o,n.Python.ORDER_RELATIONAL]},n.Python.math_change=function(t){n.Python.definitions_.from_numbers_import_Number="from numbers import Number";var e=n.Python.valueToCode(t,"DELTA",n.Python.ORDER_ADDITIVE)||"0";return(t=n.Python.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME))+" = ("+t+" if isinstance("+t+", Number) else 0) + "+e+"\n"},n.Python.math_round=n.Python.math_single,n.Python.math_trig=n.Python.math_single,n.Python.math_on_list=function(t){var e=t.getFieldValue("OP");switch(t=n.Python.valueToCode(t,"LIST",n.Python.ORDER_NONE)||"[]",e){case"SUM":e="sum("+t+")";break;case"MIN":e="min("+t+")";break;case"MAX":e="max("+t+")";break;case"AVERAGE":n.Python.definitions_.from_numbers_import_Number="from numbers import Number",e=(e=n.Python.provideFunction_("math_mean",["def "+n.Python.FUNCTION_NAME_PLACEHOLDER_+"(myList):","  localList = [e for e in myList if isinstance(e, Number)]","  if not localList: return","  return float(sum(localList)) / len(localList)"]))+"("+t+")";break;case"MEDIAN":n.Python.definitions_.from_numbers_import_Number="from numbers import Number",e=(e=n.Python.provideFunction_("math_median",["def "+n.Python.FUNCTION_NAME_PLACEHOLDER_+"(myList):","  localList = sorted([e for e in myList if isinstance(e, Number)])","  if not localList: return","  if len(localList) % 2 == 0:","    return (localList[len(localList) // 2 - 1] + localList[len(localList) // 2]) / 2.0","  else:","    return localList[(len(localList) - 1) // 2]"]))+"("+t+")";break;case"MODE":e=(e=n.Python.provideFunction_("math_modes",["def "+n.Python.FUNCTION_NAME_PLACEHOLDER_+"(some_list):","  modes = []","  # Using a lists of [item, count] to keep count rather than dict",'  # to avoid "unhashable" errors when the counted item is itself a list or dict.',"  counts = []","  maxCount = 1","  for item in some_list:","    found = False","    for count in counts:","      if count[0] == item:","        count[1] += 1","        maxCount = max(maxCount, count[1])","        found = True","    if not found:","      counts.append([item, 1])","  for counted_item, item_count in counts:","    if item_count == maxCount:","      modes.append(counted_item)","  return modes"]))+"("+t+")";break;case"STD_DEV":n.Python.definitions_.import_math="import math",e=(e=n.Python.provideFunction_("math_standard_deviation",["def "+n.Python.FUNCTION_NAME_PLACEHOLDER_+"(numbers):","  n = len(numbers)","  if n == 0: return","  mean = float(sum(numbers)) / n","  variance = sum((x - mean) ** 2 for x in numbers) / n","  return math.sqrt(variance)"]))+"("+t+")";break;case"RANDOM":n.Python.definitions_.import_random="import random",e="random.choice("+t+")";break;default:throw Error("Unknown operator: "+e)}return[e,n.Python.ORDER_FUNCTION_CALL]},n.Python.math_modulo=function(t){return[(n.Python.valueToCode(t,"DIVIDEND",n.Python.ORDER_MULTIPLICATIVE)||"0")+" % "+(t=n.Python.valueToCode(t,"DIVISOR",n.Python.ORDER_MULTIPLICATIVE)||"0"),n.Python.ORDER_MULTIPLICATIVE]},n.Python.math_constrain=function(t){return["min(max("+(n.Python.valueToCode(t,"VALUE",n.Python.ORDER_NONE)||"0")+", "+(n.Python.valueToCode(t,"LOW",n.Python.ORDER_NONE)||"0")+"), "+(t=n.Python.valueToCode(t,"HIGH",n.Python.ORDER_NONE)||"float('inf')")+")",n.Python.ORDER_FUNCTION_CALL]},n.Python.math_random_int=function(t){return n.Python.definitions_.import_random="import random",["random.randint("+(n.Python.valueToCode(t,"FROM",n.Python.ORDER_NONE)||"0")+", "+(t=n.Python.valueToCode(t,"TO",n.Python.ORDER_NONE)||"0")+")",n.Python.ORDER_FUNCTION_CALL]},n.Python.math_random_float=function(t){return n.Python.definitions_.import_random="import random",["random.random()",n.Python.ORDER_FUNCTION_CALL]},n.Python.math_atan2=function(t){n.Python.definitions_.import_math="import math";var e=n.Python.valueToCode(t,"X",n.Python.ORDER_NONE)||"0";return["math.atan2("+(n.Python.valueToCode(t,"Y",n.Python.ORDER_NONE)||"0")+", "+e+") / math.pi * 180",n.Python.ORDER_MULTIPLICATIVE]},n.Python.procedures={},n.Python.procedures_defreturn=function(t){for(var e,i=[],o=t.workspace,r=n.Variables.allUsedVarModels(o)||[],s=0;e=r[s];s++)e=e.name,-1==t.getVars().indexOf(e)&&i.push(n.Python.variableDB_.getName(e,n.VARIABLE_CATEGORY_NAME));for(r=n.Variables.allDeveloperVariables(o),s=0;s<r.length;s++)i.push(n.Python.variableDB_.getName(r[s],n.Names.DEVELOPER_VARIABLE_TYPE));i=i.length?n.Python.INDENT+"global "+i.join(", ")+"\n":"",o=n.Python.variableDB_.getName(t.getFieldValue("NAME"),n.PROCEDURE_CATEGORY_NAME),e="",n.Python.STATEMENT_PREFIX&&(e+=n.Python.injectId(n.Python.STATEMENT_PREFIX,t)),n.Python.STATEMENT_SUFFIX&&(e+=n.Python.injectId(n.Python.STATEMENT_SUFFIX,t)),e&&(e=n.Python.prefixLines(e,n.Python.INDENT));var a="";n.Python.INFINITE_LOOP_TRAP&&(a=n.Python.prefixLines(n.Python.injectId(n.Python.INFINITE_LOOP_TRAP,t),n.Python.INDENT));var l=n.Python.statementToCode(t,"STACK"),c=n.Python.valueToCode(t,"RETURN",n.Python.ORDER_NONE)||"",d="";l&&c&&(d=e),c?c=n.Python.INDENT+"return "+c+"\n":l||(l=n.Python.PASS);var u=[];for(r=t.getVars(),s=0;s<r.length;s++)u[s]=n.Python.variableDB_.getName(r[s],n.VARIABLE_CATEGORY_NAME);return i="def "+o+"("+u.join(", ")+"):\n"+i+e+a+l+d+c,i=n.Python.scrub_(t,i),n.Python.definitions_["%"+o]=i,null},n.Python.procedures_defnoreturn=n.Python.procedures_defreturn,n.Python.procedures_callreturn=function(t){for(var e=n.Python.variableDB_.getName(t.getFieldValue("NAME"),n.PROCEDURE_CATEGORY_NAME),i=[],o=t.getVars(),r=0;r<o.length;r++)i[r]=n.Python.valueToCode(t,"ARG"+r,n.Python.ORDER_NONE)||"None";return[e+"("+i.join(", ")+")",n.Python.ORDER_FUNCTION_CALL]},n.Python.procedures_callnoreturn=function(t){return n.Python.procedures_callreturn(t)[0]+"\n"},n.Python.procedures_ifreturn=function(t){var e="if "+(n.Python.valueToCode(t,"CONDITION",n.Python.ORDER_NONE)||"False")+":\n";return n.Python.STATEMENT_SUFFIX&&(e+=n.Python.prefixLines(n.Python.injectId(n.Python.STATEMENT_SUFFIX,t),n.Python.INDENT)),t.hasReturnValue_?(t=n.Python.valueToCode(t,"VALUE",n.Python.ORDER_NONE)||"None",e+=n.Python.INDENT+"return "+t+"\n"):e+=n.Python.INDENT+"return\n",e},n.Python.texts={},n.Python.text=function(t){return[n.Python.quote_(t.getFieldValue("TEXT")),n.Python.ORDER_ATOMIC]},n.Python.text_multiline=function(t){var e=-1!=(t=n.Python.multiline_quote_(t.getFieldValue("TEXT"))).indexOf("+")?n.Python.ORDER_ADDITIVE:n.Python.ORDER_ATOMIC;return[t,e]},n.Python.text.forceString_=function(t){return n.Python.text.forceString_.strRegExp.test(t)?[t,n.Python.ORDER_ATOMIC]:["str("+t+")",n.Python.ORDER_FUNCTION_CALL]},n.Python.text.forceString_.strRegExp=/^\s*'([^']|\\')*'\s*$/,n.Python.text_join=function(t){switch(t.itemCount_){case 0:return["''",n.Python.ORDER_ATOMIC];case 1:return t=n.Python.valueToCode(t,"ADD0",n.Python.ORDER_NONE)||"''",n.Python.text.forceString_(t);case 2:var e=n.Python.valueToCode(t,"ADD0",n.Python.ORDER_NONE)||"''";return t=n.Python.valueToCode(t,"ADD1",n.Python.ORDER_NONE)||"''",[t=n.Python.text.forceString_(e)[0]+" + "+n.Python.text.forceString_(t)[0],n.Python.ORDER_ADDITIVE];default:e=[];for(var i=0;i<t.itemCount_;i++)e[i]=n.Python.valueToCode(t,"ADD"+i,n.Python.ORDER_NONE)||"''";return[t="''.join([str("+(t=n.Python.variableDB_.getDistinctName("x",n.VARIABLE_CATEGORY_NAME))+") for "+t+" in ["+e.join(", ")+"]])",n.Python.ORDER_FUNCTION_CALL]}},n.Python.text_append=function(t){var e=n.Python.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME);return t=n.Python.valueToCode(t,"TEXT",n.Python.ORDER_NONE)||"''",e+" = str("+e+") + "+n.Python.text.forceString_(t)[0]+"\n"},n.Python.text_length=function(t){return["len("+(n.Python.valueToCode(t,"VALUE",n.Python.ORDER_NONE)||"''")+")",n.Python.ORDER_FUNCTION_CALL]},n.Python.text_isEmpty=function(t){return["not len("+(n.Python.valueToCode(t,"VALUE",n.Python.ORDER_NONE)||"''")+")",n.Python.ORDER_LOGICAL_NOT]},n.Python.text_indexOf=function(t){var e="FIRST"==t.getFieldValue("END")?"find":"rfind",i=n.Python.valueToCode(t,"FIND",n.Python.ORDER_NONE)||"''";return e=(n.Python.valueToCode(t,"VALUE",n.Python.ORDER_MEMBER)||"''")+"."+e+"("+i+")",t.workspace.options.oneBasedIndex?[e+" + 1",n.Python.ORDER_ADDITIVE]:[e,n.Python.ORDER_FUNCTION_CALL]},n.Python.text_charAt=function(t){var e=t.getFieldValue("WHERE")||"FROM_START",i=n.Python.valueToCode(t,"VALUE","RANDOM"==e?n.Python.ORDER_NONE:n.Python.ORDER_MEMBER)||"''";switch(e){case"FIRST":return[i+"[0]",n.Python.ORDER_MEMBER];case"LAST":return[i+"[-1]",n.Python.ORDER_MEMBER];case"FROM_START":return[i+"["+(t=n.Python.getAdjustedInt(t,"AT"))+"]",n.Python.ORDER_MEMBER];case"FROM_END":return[i+"["+(t=n.Python.getAdjustedInt(t,"AT",1,!0))+"]",n.Python.ORDER_MEMBER];case"RANDOM":return n.Python.definitions_.import_random="import random",[n.Python.provideFunction_("text_random_letter",["def "+n.Python.FUNCTION_NAME_PLACEHOLDER_+"(text):","  x = int(random.random() * len(text))","  return text[x];"])+"("+i+")",n.Python.ORDER_FUNCTION_CALL]}throw Error("Unhandled option (text_charAt).")},n.Python.text_getSubstring=function(t){var e=t.getFieldValue("WHERE1"),i=t.getFieldValue("WHERE2"),o=n.Python.valueToCode(t,"STRING",n.Python.ORDER_MEMBER)||"''";switch(e){case"FROM_START":"0"==(e=n.Python.getAdjustedInt(t,"AT1"))&&(e="");break;case"FROM_END":e=n.Python.getAdjustedInt(t,"AT1",1,!0);break;case"FIRST":e="";break;default:throw Error("Unhandled option (text_getSubstring)")}switch(i){case"FROM_START":t=n.Python.getAdjustedInt(t,"AT2",1);break;case"FROM_END":t=n.Python.getAdjustedInt(t,"AT2",0,!0),n.isNumber(String(t))?"0"==t&&(t=""):(n.Python.definitions_.import_sys="import sys",t+=" or sys.maxsize");break;case"LAST":t="";break;default:throw Error("Unhandled option (text_getSubstring)")}return[o+"["+e+" : "+t+"]",n.Python.ORDER_MEMBER]},n.Python.text_changeCase=function(t){var e={UPPERCASE:".upper()",LOWERCASE:".lower()",TITLECASE:".title()"}[t.getFieldValue("CASE")];return[(n.Python.valueToCode(t,"TEXT",n.Python.ORDER_MEMBER)||"''")+e,n.Python.ORDER_FUNCTION_CALL]},n.Python.text_trim=function(t){var e={LEFT:".lstrip()",RIGHT:".rstrip()",BOTH:".strip()"}[t.getFieldValue("MODE")];return[(n.Python.valueToCode(t,"TEXT",n.Python.ORDER_MEMBER)||"''")+e,n.Python.ORDER_FUNCTION_CALL]},n.Python.text_print=function(t){return"print("+(n.Python.valueToCode(t,"TEXT",n.Python.ORDER_NONE)||"''")+")\n"},n.Python.text_prompt_ext=function(t){var e=n.Python.provideFunction_("text_prompt",["def "+n.Python.FUNCTION_NAME_PLACEHOLDER_+"(msg):","  try:","    return raw_input(msg)","  except NameError:","    return input(msg)"]);return e=e+"("+(t.getField("TEXT")?n.Python.quote_(t.getFieldValue("TEXT")):n.Python.valueToCode(t,"TEXT",n.Python.ORDER_NONE)||"''")+")","NUMBER"==t.getFieldValue("TYPE")&&(e="float("+e+")"),[e,n.Python.ORDER_FUNCTION_CALL]},n.Python.text_prompt=n.Python.text_prompt_ext,n.Python.text_count=function(t){return[(n.Python.valueToCode(t,"TEXT",n.Python.ORDER_MEMBER)||"''")+".count("+(t=n.Python.valueToCode(t,"SUB",n.Python.ORDER_NONE)||"''")+")",n.Python.ORDER_FUNCTION_CALL]},n.Python.text_replace=function(t){return[(n.Python.valueToCode(t,"TEXT",n.Python.ORDER_MEMBER)||"''")+".replace("+(n.Python.valueToCode(t,"FROM",n.Python.ORDER_NONE)||"''")+", "+(t=n.Python.valueToCode(t,"TO",n.Python.ORDER_NONE)||"''")+")",n.Python.ORDER_MEMBER]},n.Python.text_reverse=function(t){return[(n.Python.valueToCode(t,"TEXT",n.Python.ORDER_MEMBER)||"''")+"[::-1]",n.Python.ORDER_MEMBER]},n.Python.variables={},n.Python.variables_get=function(t){return[n.Python.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME),n.Python.ORDER_ATOMIC]},n.Python.variables_set=function(t){var e=n.Python.valueToCode(t,"VALUE",n.Python.ORDER_NONE)||"0";return n.Python.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME)+" = "+e+"\n"},n.Python.variablesDynamic={},n.Python.variables_get_dynamic=n.Python.variables_get,n.Python.variables_set_dynamic=n.Python.variables_set,n.Python)})),HP=IP((function(t,e){var n;t.exports=(n=FP,DP.Python=n,n)})),UP=IP((function(t,e){var n;t.exports=((n=kP).PHP=new n.Generator("PHP"),n.PHP.addReservedWords("__halt_compiler,abstract,and,array,as,break,callable,case,catch,class,clone,const,continue,declare,default,die,do,echo,else,elseif,empty,enddeclare,endfor,endforeach,endif,endswitch,endwhile,eval,exit,extends,final,for,foreach,function,global,goto,if,implements,include,include_once,instanceof,insteadof,interface,isset,list,namespace,new,or,print,private,protected,public,require,require_once,return,static,switch,throw,trait,try,unset,use,var,while,xor,PHP_VERSION,PHP_MAJOR_VERSION,PHP_MINOR_VERSION,PHP_RELEASE_VERSION,PHP_VERSION_ID,PHP_EXTRA_VERSION,PHP_ZTS,PHP_DEBUG,PHP_MAXPATHLEN,PHP_OS,PHP_SAPI,PHP_EOL,PHP_INT_MAX,PHP_INT_SIZE,DEFAULT_INCLUDE_PATH,PEAR_INSTALL_DIR,PEAR_EXTENSION_DIR,PHP_EXTENSION_DIR,PHP_PREFIX,PHP_BINDIR,PHP_BINARY,PHP_MANDIR,PHP_LIBDIR,PHP_DATADIR,PHP_SYSCONFDIR,PHP_LOCALSTATEDIR,PHP_CONFIG_FILE_PATH,PHP_CONFIG_FILE_SCAN_DIR,PHP_SHLIB_SUFFIX,E_ERROR,E_WARNING,E_PARSE,E_NOTICE,E_CORE_ERROR,E_CORE_WARNING,E_COMPILE_ERROR,E_COMPILE_WARNING,E_USER_ERROR,E_USER_WARNING,E_USER_NOTICE,E_DEPRECATED,E_USER_DEPRECATED,E_ALL,E_STRICT,__COMPILER_HALT_OFFSET__,TRUE,FALSE,NULL,__CLASS__,__DIR__,__FILE__,__FUNCTION__,__LINE__,__METHOD__,__NAMESPACE__,__TRAIT__"),n.PHP.ORDER_ATOMIC=0,n.PHP.ORDER_CLONE=1,n.PHP.ORDER_NEW=1,n.PHP.ORDER_MEMBER=2.1,n.PHP.ORDER_FUNCTION_CALL=2.2,n.PHP.ORDER_POWER=3,n.PHP.ORDER_INCREMENT=4,n.PHP.ORDER_DECREMENT=4,n.PHP.ORDER_BITWISE_NOT=4,n.PHP.ORDER_CAST=4,n.PHP.ORDER_SUPPRESS_ERROR=4,n.PHP.ORDER_INSTANCEOF=5,n.PHP.ORDER_LOGICAL_NOT=6,n.PHP.ORDER_UNARY_PLUS=7.1,n.PHP.ORDER_UNARY_NEGATION=7.2,n.PHP.ORDER_MULTIPLICATION=8.1,n.PHP.ORDER_DIVISION=8.2,n.PHP.ORDER_MODULUS=8.3,n.PHP.ORDER_ADDITION=9.1,n.PHP.ORDER_SUBTRACTION=9.2,n.PHP.ORDER_STRING_CONCAT=9.3,n.PHP.ORDER_BITWISE_SHIFT=10,n.PHP.ORDER_RELATIONAL=11,n.PHP.ORDER_EQUALITY=12,n.PHP.ORDER_REFERENCE=13,n.PHP.ORDER_BITWISE_AND=13,n.PHP.ORDER_BITWISE_XOR=14,n.PHP.ORDER_BITWISE_OR=15,n.PHP.ORDER_LOGICAL_AND=16,n.PHP.ORDER_LOGICAL_OR=17,n.PHP.ORDER_IF_NULL=18,n.PHP.ORDER_CONDITIONAL=19,n.PHP.ORDER_ASSIGNMENT=20,n.PHP.ORDER_LOGICAL_AND_WEAK=21,n.PHP.ORDER_LOGICAL_XOR=22,n.PHP.ORDER_LOGICAL_OR_WEAK=23,n.PHP.ORDER_NONE=99,n.PHP.ORDER_OVERRIDES=[[n.PHP.ORDER_MEMBER,n.PHP.ORDER_FUNCTION_CALL],[n.PHP.ORDER_MEMBER,n.PHP.ORDER_MEMBER],[n.PHP.ORDER_LOGICAL_NOT,n.PHP.ORDER_LOGICAL_NOT],[n.PHP.ORDER_MULTIPLICATION,n.PHP.ORDER_MULTIPLICATION],[n.PHP.ORDER_ADDITION,n.PHP.ORDER_ADDITION],[n.PHP.ORDER_LOGICAL_AND,n.PHP.ORDER_LOGICAL_AND],[n.PHP.ORDER_LOGICAL_OR,n.PHP.ORDER_LOGICAL_OR]],n.PHP.isInitialized=!1,n.PHP.init=function(t){n.PHP.definitions_=Object.create(null),n.PHP.functionNames_=Object.create(null),n.PHP.variableDB_?n.PHP.variableDB_.reset():n.PHP.variableDB_=new n.Names(n.PHP.RESERVED_WORDS_,"$"),n.PHP.variableDB_.setVariableMap(t.getVariableMap());for(var e=[],i=n.Variables.allDeveloperVariables(t),o=0;o<i.length;o++)e.push(n.PHP.variableDB_.getName(i[o],n.Names.DEVELOPER_VARIABLE_TYPE)+";");for(t=n.Variables.allUsedVarModels(t),o=0;i=t[o];o++)e.push(n.PHP.variableDB_.getName(i.getId(),n.VARIABLE_CATEGORY_NAME)+";");n.PHP.definitions_.variables=e.join("\n"),this.isInitialized=!0},n.PHP.finish=function(t){var e,i=[];for(e in n.PHP.definitions_)i.push(n.PHP.definitions_[e]);return delete n.PHP.definitions_,delete n.PHP.functionNames_,n.PHP.variableDB_.reset(),i.join("\n\n")+"\n\n\n"+t},n.PHP.scrubNakedValue=function(t){return t+";\n"},n.PHP.quote_=function(t){return"'"+(t=t.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'"))+"'"},n.PHP.multiline_quote_=function(t){return t.split(/\n/g).map(n.PHP.quote_).join(' . "\\n" .\n')},n.PHP.scrub_=function(t,e,i){var o="";if(!t.outputConnection||!t.outputConnection.targetConnection){var r=t.getCommentText();r&&(r=n.utils.string.wrap(r,n.PHP.COMMENT_WRAP-3),o+=n.PHP.prefixLines(r,"// ")+"\n");for(var s=0;s<t.inputList.length;s++)t.inputList[s].type==n.INPUT_VALUE&&(r=t.inputList[s].connection.targetBlock())&&(r=n.PHP.allNestedComments(r))&&(o+=n.PHP.prefixLines(r,"// "))}return t=t.nextConnection&&t.nextConnection.targetBlock(),o+e+(i=i?"":n.PHP.blockToCode(t))},n.PHP.getAdjusted=function(t,e,i,o,r){i=i||0,r=r||n.PHP.ORDER_NONE,t.workspace.options.oneBasedIndex&&i--;var s=t.workspace.options.oneBasedIndex?"1":"0";if(t=0<i?n.PHP.valueToCode(t,e,n.PHP.ORDER_ADDITION)||s:0>i?n.PHP.valueToCode(t,e,n.PHP.ORDER_SUBTRACTION)||s:o?n.PHP.valueToCode(t,e,n.PHP.ORDER_UNARY_NEGATION)||s:n.PHP.valueToCode(t,e,r)||s,n.isNumber(t))t=Number(t)+i,o&&(t=-t);else{if(0<i){t=t+" + "+i;var a=n.PHP.ORDER_ADDITION}else 0>i&&(t=t+" - "+-i,a=n.PHP.ORDER_SUBTRACTION);o&&(t=i?"-("+t+")":"-"+t,a=n.PHP.ORDER_UNARY_NEGATION),a=Math.floor(a),r=Math.floor(r),a&&r>=a&&(t="("+t+")")}return t},n.PHP.colour={},n.PHP.colour_picker=function(t){return[n.PHP.quote_(t.getFieldValue("COLOUR")),n.PHP.ORDER_ATOMIC]},n.PHP.colour_random=function(t){return[n.PHP.provideFunction_("colour_random",["function "+n.PHP.FUNCTION_NAME_PLACEHOLDER_+"() {","  return '#' . str_pad(dechex(mt_rand(0, 0xFFFFFF)), 6, '0', STR_PAD_LEFT);","}"])+"()",n.PHP.ORDER_FUNCTION_CALL]},n.PHP.colour_rgb=function(t){var e=n.PHP.valueToCode(t,"RED",n.PHP.ORDER_NONE)||0,i=n.PHP.valueToCode(t,"GREEN",n.PHP.ORDER_NONE)||0;return t=n.PHP.valueToCode(t,"BLUE",n.PHP.ORDER_NONE)||0,[n.PHP.provideFunction_("colour_rgb",["function "+n.PHP.FUNCTION_NAME_PLACEHOLDER_+"($r, $g, $b) {","  $r = round(max(min($r, 100), 0) * 2.55);","  $g = round(max(min($g, 100), 0) * 2.55);","  $b = round(max(min($b, 100), 0) * 2.55);","  $hex = '#';","  $hex .= str_pad(dechex($r), 2, '0', STR_PAD_LEFT);","  $hex .= str_pad(dechex($g), 2, '0', STR_PAD_LEFT);","  $hex .= str_pad(dechex($b), 2, '0', STR_PAD_LEFT);","  return $hex;","}"])+"("+e+", "+i+", "+t+")",n.PHP.ORDER_FUNCTION_CALL]},n.PHP.colour_blend=function(t){var e=n.PHP.valueToCode(t,"COLOUR1",n.PHP.ORDER_NONE)||"'#000000'",i=n.PHP.valueToCode(t,"COLOUR2",n.PHP.ORDER_NONE)||"'#000000'";return t=n.PHP.valueToCode(t,"RATIO",n.PHP.ORDER_NONE)||.5,[n.PHP.provideFunction_("colour_blend",["function "+n.PHP.FUNCTION_NAME_PLACEHOLDER_+"($c1, $c2, $ratio) {","  $ratio = max(min($ratio, 1), 0);","  $r1 = hexdec(substr($c1, 1, 2));","  $g1 = hexdec(substr($c1, 3, 2));","  $b1 = hexdec(substr($c1, 5, 2));","  $r2 = hexdec(substr($c2, 1, 2));","  $g2 = hexdec(substr($c2, 3, 2));","  $b2 = hexdec(substr($c2, 5, 2));","  $r = round($r1 * (1 - $ratio) + $r2 * $ratio);","  $g = round($g1 * (1 - $ratio) + $g2 * $ratio);","  $b = round($b1 * (1 - $ratio) + $b2 * $ratio);","  $hex = '#';","  $hex .= str_pad(dechex($r), 2, '0', STR_PAD_LEFT);","  $hex .= str_pad(dechex($g), 2, '0', STR_PAD_LEFT);","  $hex .= str_pad(dechex($b), 2, '0', STR_PAD_LEFT);","  return $hex;","}"])+"("+e+", "+i+", "+t+")",n.PHP.ORDER_FUNCTION_CALL]},n.PHP.lists={},n.PHP.lists_create_empty=function(t){return["array()",n.PHP.ORDER_FUNCTION_CALL]},n.PHP.lists_create_with=function(t){for(var e=Array(t.itemCount_),i=0;i<t.itemCount_;i++)e[i]=n.PHP.valueToCode(t,"ADD"+i,n.PHP.ORDER_NONE)||"null";return[e="array("+e.join(", ")+")",n.PHP.ORDER_FUNCTION_CALL]},n.PHP.lists_repeat=function(t){return[n.PHP.provideFunction_("lists_repeat",["function "+n.PHP.FUNCTION_NAME_PLACEHOLDER_+"($value, $count) {","  $array = array();","  for ($index = 0; $index < $count; $index++) {","    $array[] = $value;","  }","  return $array;","}"])+"("+(n.PHP.valueToCode(t,"ITEM",n.PHP.ORDER_NONE)||"null")+", "+(t=n.PHP.valueToCode(t,"NUM",n.PHP.ORDER_NONE)||"0")+")",n.PHP.ORDER_FUNCTION_CALL]},n.PHP.lists_length=function(t){return[n.PHP.provideFunction_("length",["function "+n.PHP.FUNCTION_NAME_PLACEHOLDER_+"($value) {","  if (is_string($value)) {","    return strlen($value);","  } else {","    return count($value);","  }","}"])+"("+(t=n.PHP.valueToCode(t,"VALUE",n.PHP.ORDER_NONE)||"''")+")",n.PHP.ORDER_FUNCTION_CALL]},n.PHP.lists_isEmpty=function(t){return["empty("+(n.PHP.valueToCode(t,"VALUE",n.PHP.ORDER_FUNCTION_CALL)||"array()")+")",n.PHP.ORDER_FUNCTION_CALL]},n.PHP.lists_indexOf=function(t){var e=n.PHP.valueToCode(t,"FIND",n.PHP.ORDER_NONE)||"''",i=n.PHP.valueToCode(t,"VALUE",n.PHP.ORDER_MEMBER)||"[]";if(t.workspace.options.oneBasedIndex)var o=" 0",r=" + 1";else o=" -1",r="";return[("FIRST"==t.getFieldValue("END")?n.PHP.provideFunction_("indexOf",["function "+n.PHP.FUNCTION_NAME_PLACEHOLDER_+"($haystack, $needle) {","  for ($index = 0; $index < count($haystack); $index++) {","    if ($haystack[$index] == $needle) return $index"+r+";","  }","  return "+o+";","}"]):n.PHP.provideFunction_("lastIndexOf",["function "+n.PHP.FUNCTION_NAME_PLACEHOLDER_+"($haystack, $needle) {","  $last = "+o+";","  for ($index = 0; $index < count($haystack); $index++) {","    if ($haystack[$index] == $needle) $last = $index"+r+";","  }","  return $last;","}"]))+"("+i+", "+e+")",n.PHP.ORDER_FUNCTION_CALL]},n.PHP.lists_getIndex=function(t){var e=t.getFieldValue("MODE")||"GET";switch(t.getFieldValue("WHERE")||"FROM_START"){case"FIRST":if("GET"==e){var i=n.PHP.valueToCode(t,"VALUE",n.PHP.ORDER_MEMBER)||"array()";return[i+"[0]",n.PHP.ORDER_MEMBER]}if("GET_REMOVE"==e)return["array_shift("+(i=n.PHP.valueToCode(t,"VALUE",n.PHP.ORDER_NONE)||"array()")+")",n.PHP.ORDER_FUNCTION_CALL];if("REMOVE"==e)return"array_shift("+(i=n.PHP.valueToCode(t,"VALUE",n.PHP.ORDER_NONE)||"array()")+");\n";break;case"LAST":if("GET"==e)return["end("+(i=n.PHP.valueToCode(t,"VALUE",n.PHP.ORDER_NONE)||"array()")+")",n.PHP.ORDER_FUNCTION_CALL];if("GET_REMOVE"==e)return["array_pop("+(i=n.PHP.valueToCode(t,"VALUE",n.PHP.ORDER_NONE)||"array()")+")",n.PHP.ORDER_FUNCTION_CALL];if("REMOVE"==e)return"array_pop("+(i=n.PHP.valueToCode(t,"VALUE",n.PHP.ORDER_NONE)||"array()")+");\n";break;case"FROM_START":var o=n.PHP.getAdjusted(t,"AT");if("GET"==e)return[(i=n.PHP.valueToCode(t,"VALUE",n.PHP.ORDER_MEMBER)||"array()")+"["+o+"]",n.PHP.ORDER_MEMBER];if("GET_REMOVE"==e)return["array_splice("+(i=n.PHP.valueToCode(t,"VALUE",n.PHP.ORDER_NONE)||"array()")+", "+o+", 1)[0]",n.PHP.ORDER_FUNCTION_CALL];if("REMOVE"==e)return"array_splice("+(i=n.PHP.valueToCode(t,"VALUE",n.PHP.ORDER_NONE)||"array()")+", "+o+", 1);\n";break;case"FROM_END":if("GET"==e)return["array_slice("+(i=n.PHP.valueToCode(t,"VALUE",n.PHP.ORDER_NONE)||"array()")+", "+(o=n.PHP.getAdjusted(t,"AT",1,!0))+", 1)[0]",n.PHP.ORDER_FUNCTION_CALL];if("GET_REMOVE"==e||"REMOVE"==e){if(i="array_splice("+(i=n.PHP.valueToCode(t,"VALUE",n.PHP.ORDER_NONE)||"array()")+", count("+i+") - "+(o=n.PHP.getAdjusted(t,"AT",1,!1,n.PHP.ORDER_SUBTRACTION))+", 1)[0]","GET_REMOVE"==e)return[i,n.PHP.ORDER_FUNCTION_CALL];if("REMOVE"==e)return i+";\n"}break;case"RANDOM":if(i=n.PHP.valueToCode(t,"VALUE",n.PHP.ORDER_NONE)||"array()","GET"==e)return[(e=n.PHP.provideFunction_("lists_get_random_item",["function "+n.PHP.FUNCTION_NAME_PLACEHOLDER_+"($list) {","  return $list[rand(0,count($list)-1)];","}"]))+"("+i+")",n.PHP.ORDER_FUNCTION_CALL];if("GET_REMOVE"==e)return[(e=n.PHP.provideFunction_("lists_get_remove_random_item",["function "+n.PHP.FUNCTION_NAME_PLACEHOLDER_+"(&$list) {","  $x = rand(0,count($list)-1);","  unset($list[$x]);","  return array_values($list);","}"]))+"("+i+")",n.PHP.ORDER_FUNCTION_CALL];if("REMOVE"==e)return(e=n.PHP.provideFunction_("lists_remove_random_item",["function "+n.PHP.FUNCTION_NAME_PLACEHOLDER_+"(&$list) {","  unset($list[rand(0,count($list)-1)]);","}"]))+"("+i+");\n"}throw Error("Unhandled combination (lists_getIndex).")},n.PHP.lists_setIndex=function(t){var e=t.getFieldValue("MODE")||"GET",i=t.getFieldValue("WHERE")||"FROM_START",o=n.PHP.valueToCode(t,"TO",n.PHP.ORDER_ASSIGNMENT)||"null";switch(i){case"FIRST":if("SET"==e)return(i=n.PHP.valueToCode(t,"LIST",n.PHP.ORDER_MEMBER)||"array()")+"[0] = "+o+";\n";if("INSERT"==e)return"array_unshift("+(i=n.PHP.valueToCode(t,"LIST",n.PHP.ORDER_NONE)||"array()")+", "+o+");\n";break;case"LAST":if(i=n.PHP.valueToCode(t,"LIST",n.PHP.ORDER_NONE)||"array()","SET"==e)return(e=n.PHP.provideFunction_("lists_set_last_item",["function "+n.PHP.FUNCTION_NAME_PLACEHOLDER_+"(&$list, $value) {","  $list[count($list) - 1] = $value;","}"]))+"("+i+", "+o+");\n";if("INSERT"==e)return"array_push("+i+", "+o+");\n";break;case"FROM_START":var r=n.PHP.getAdjusted(t,"AT");if("SET"==e)return(i=n.PHP.valueToCode(t,"LIST",n.PHP.ORDER_MEMBER)||"array()")+"["+r+"] = "+o+";\n";if("INSERT"==e)return"array_splice("+(i=n.PHP.valueToCode(t,"LIST",n.PHP.ORDER_NONE)||"array()")+", "+r+", 0, "+o+");\n";break;case"FROM_END":if(i=n.PHP.valueToCode(t,"LIST",n.PHP.ORDER_NONE)||"array()",r=n.PHP.getAdjusted(t,"AT",1),"SET"==e)return(e=n.PHP.provideFunction_("lists_set_from_end",["function "+n.PHP.FUNCTION_NAME_PLACEHOLDER_+"(&$list, $at, $value) {","  $list[count($list) - $at] = $value;","}"]))+"("+i+", "+r+", "+o+");\n";if("INSERT"==e)return(e=n.PHP.provideFunction_("lists_insert_from_end",["function "+n.PHP.FUNCTION_NAME_PLACEHOLDER_+"(&$list, $at, $value) {","  return array_splice($list, count($list) - $at, 0, $value);","}"]))+"("+i+", "+r+", "+o+");\n";break;case"RANDOM":if((i=n.PHP.valueToCode(t,"LIST",n.PHP.ORDER_REFERENCE)||"array()").match(/^\$\w+$/)?t="":(r=(t=n.PHP.variableDB_.getDistinctName("tmp_list",n.VARIABLE_CATEGORY_NAME))+" = &"+i+";\n",i=t,t=r),t+=(r=n.PHP.variableDB_.getDistinctName("tmp_x",n.VARIABLE_CATEGORY_NAME))+" = rand(0, count("+i+")-1);\n","SET"==e)return t+(i+"[")+r+"] = "+o+";\n";if("INSERT"==e)return t+"array_splice("+i+", "+r+", 0, "+o+");\n"}throw Error("Unhandled combination (lists_setIndex).")},n.PHP.lists_getSublist=function(t){var e=n.PHP.valueToCode(t,"LIST",n.PHP.ORDER_NONE)||"array()",i=t.getFieldValue("WHERE1"),o=t.getFieldValue("WHERE2");if("FIRST"!=i||"LAST"!=o)if(e.match(/^\$\w+$/)||"FROM_END"!=i&&"FROM_START"==o){switch(i){case"FROM_START":var r=n.PHP.getAdjusted(t,"AT1");break;case"FROM_END":r="count("+e+") - "+(r=n.PHP.getAdjusted(t,"AT1",1,!1,n.PHP.ORDER_SUBTRACTION));break;case"FIRST":r="0";break;default:throw Error("Unhandled option (lists_getSublist).")}switch(o){case"FROM_START":i=(t=n.PHP.getAdjusted(t,"AT2",0,!1,n.PHP.ORDER_SUBTRACTION))+" - ",i=n.isNumber(String(r))||String(r).match(/^\(.+\)$/)?i+r:i+"("+r+")",i+=" + 1";break;case"FROM_END":i="count("+e+") - "+(t=n.PHP.getAdjusted(t,"AT2",0,!1,n.PHP.ORDER_SUBTRACTION))+" - ",i=n.isNumber(String(r))||String(r).match(/^\(.+\)$/)?i+r:i+"("+r+")";break;case"LAST":i="count("+e+") - ",i=n.isNumber(String(r))||String(r).match(/^\(.+\)$/)?i+r:i+"("+r+")";break;default:throw Error("Unhandled option (lists_getSublist).")}e="array_slice("+e+", "+r+", "+i+")"}else r=n.PHP.getAdjusted(t,"AT1"),t=n.PHP.getAdjusted(t,"AT2"),e=n.PHP.provideFunction_("lists_get_sublist",["function "+n.PHP.FUNCTION_NAME_PLACEHOLDER_+"($list, $where1, $at1, $where2, $at2) {","  if ($where1 == 'FROM_END') {","    $at1 = count($list) - 1 - $at1;","  } else if ($where1 == 'FIRST') {","    $at1 = 0;","  } else if ($where1 != 'FROM_START') {","    throw new Exception('Unhandled option (lists_get_sublist).');","  }","  $length = 0;","  if ($where2 == 'FROM_START') {","    $length = $at2 - $at1 + 1;","  } else if ($where2 == 'FROM_END') {","    $length = count($list) - $at1 - $at2;","  } else if ($where2 == 'LAST') {","    $length = count($list) - $at1;","  } else {","    throw new Exception('Unhandled option (lists_get_sublist).');","  }","  return array_slice($list, $at1, $length);","}"])+"("+e+", '"+i+"', "+r+", '"+o+"', "+t+")";return[e,n.PHP.ORDER_FUNCTION_CALL]},n.PHP.lists_sort=function(t){var e=n.PHP.valueToCode(t,"LIST",n.PHP.ORDER_NONE)||"array()",i="1"===t.getFieldValue("DIRECTION")?1:-1;return t=t.getFieldValue("TYPE"),[n.PHP.provideFunction_("lists_sort",["function "+n.PHP.FUNCTION_NAME_PLACEHOLDER_+"($list, $type, $direction) {","  $sortCmpFuncs = array(",'    "NUMERIC" => "strnatcasecmp",','    "TEXT" => "strcmp",','    "IGNORE_CASE" => "strcasecmp"',"  );","  $sortCmp = $sortCmpFuncs[$type];","  $list2 = $list;","  usort($list2, $sortCmp);","  if ($direction == -1) {","    $list2 = array_reverse($list2);","  }","  return $list2;","}"])+"("+e+', "'+t+'", '+i+")",n.PHP.ORDER_FUNCTION_CALL]},n.PHP.lists_split=function(t){var e=n.PHP.valueToCode(t,"INPUT",n.PHP.ORDER_NONE),i=n.PHP.valueToCode(t,"DELIM",n.PHP.ORDER_NONE)||"''";if("SPLIT"==(t=t.getFieldValue("MODE")))e||(e="''"),t="explode";else{if("JOIN"!=t)throw Error("Unknown mode: "+t);e||(e="array()"),t="implode"}return[t+"("+i+", "+e+")",n.PHP.ORDER_FUNCTION_CALL]},n.PHP.lists_reverse=function(t){return["array_reverse("+(n.PHP.valueToCode(t,"LIST",n.PHP.ORDER_NONE)||"[]")+")",n.PHP.ORDER_FUNCTION_CALL]},n.PHP.logic={},n.PHP.controls_if=function(t){var e=0,i="";n.PHP.STATEMENT_PREFIX&&(i+=n.PHP.injectId(n.PHP.STATEMENT_PREFIX,t));do{var o=n.PHP.valueToCode(t,"IF"+e,n.PHP.ORDER_NONE)||"false",r=n.PHP.statementToCode(t,"DO"+e);n.PHP.STATEMENT_SUFFIX&&(r=n.PHP.prefixLines(n.PHP.injectId(n.PHP.STATEMENT_SUFFIX,t),n.PHP.INDENT)+r),i+=(0<e?" else ":"")+"if ("+o+") {\n"+r+"}",++e}while(t.getInput("IF"+e));return(t.getInput("ELSE")||n.PHP.STATEMENT_SUFFIX)&&(r=n.PHP.statementToCode(t,"ELSE"),n.PHP.STATEMENT_SUFFIX&&(r=n.PHP.prefixLines(n.PHP.injectId(n.PHP.STATEMENT_SUFFIX,t),n.PHP.INDENT)+r),i+=" else {\n"+r+"}"),i+"\n"},n.PHP.controls_ifelse=n.PHP.controls_if,n.PHP.logic_compare=function(t){var e={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[t.getFieldValue("OP")],i="=="==e||"!="==e?n.PHP.ORDER_EQUALITY:n.PHP.ORDER_RELATIONAL;return[(n.PHP.valueToCode(t,"A",i)||"0")+" "+e+" "+(t=n.PHP.valueToCode(t,"B",i)||"0"),i]},n.PHP.logic_operation=function(t){var e="AND"==t.getFieldValue("OP")?"&&":"||",i="&&"==e?n.PHP.ORDER_LOGICAL_AND:n.PHP.ORDER_LOGICAL_OR,o=n.PHP.valueToCode(t,"A",i);if(t=n.PHP.valueToCode(t,"B",i),o||t){var r="&&"==e?"true":"false";o||(o=r),t||(t=r)}else t=o="false";return[o+" "+e+" "+t,i]},n.PHP.logic_negate=function(t){var e=n.PHP.ORDER_LOGICAL_NOT;return["!"+(n.PHP.valueToCode(t,"BOOL",e)||"true"),e]},n.PHP.logic_boolean=function(t){return["TRUE"==t.getFieldValue("BOOL")?"true":"false",n.PHP.ORDER_ATOMIC]},n.PHP.logic_null=function(t){return["null",n.PHP.ORDER_ATOMIC]},n.PHP.logic_ternary=function(t){return[(n.PHP.valueToCode(t,"IF",n.PHP.ORDER_CONDITIONAL)||"false")+" ? "+(n.PHP.valueToCode(t,"THEN",n.PHP.ORDER_CONDITIONAL)||"null")+" : "+(t=n.PHP.valueToCode(t,"ELSE",n.PHP.ORDER_CONDITIONAL)||"null"),n.PHP.ORDER_CONDITIONAL]},n.PHP.loops={},n.PHP.controls_repeat_ext=function(t){var e=t.getField("TIMES")?String(Number(t.getFieldValue("TIMES"))):n.PHP.valueToCode(t,"TIMES",n.PHP.ORDER_ASSIGNMENT)||"0",i=n.PHP.statementToCode(t,"DO");i=n.PHP.addLoopTrap(i,t),t="";var o=n.PHP.variableDB_.getDistinctName("count",n.VARIABLE_CATEGORY_NAME),r=e;return e.match(/^\w+$/)||n.isNumber(e)||(t+=(r=n.PHP.variableDB_.getDistinctName("repeat_end",n.VARIABLE_CATEGORY_NAME))+" = "+e+";\n"),t+"for ("+o+" = 0; "+o+" < "+r+"; "+o+"++) {\n"+i+"}\n"},n.PHP.controls_repeat=n.PHP.controls_repeat_ext,n.PHP.controls_whileUntil=function(t){var e="UNTIL"==t.getFieldValue("MODE"),i=n.PHP.valueToCode(t,"BOOL",e?n.PHP.ORDER_LOGICAL_NOT:n.PHP.ORDER_NONE)||"false",o=n.PHP.statementToCode(t,"DO");return e&&(i="!"+i),"while ("+i+") {\n"+(o=n.PHP.addLoopTrap(o,t))+"}\n"},n.PHP.controls_for=function(t){var e=n.PHP.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME),i=n.PHP.valueToCode(t,"FROM",n.PHP.ORDER_ASSIGNMENT)||"0",o=n.PHP.valueToCode(t,"TO",n.PHP.ORDER_ASSIGNMENT)||"0",r=n.PHP.valueToCode(t,"BY",n.PHP.ORDER_ASSIGNMENT)||"1",s=n.PHP.statementToCode(t,"DO");if(s=n.PHP.addLoopTrap(s,t),n.isNumber(i)&&n.isNumber(o)&&n.isNumber(r)){var a=Number(i)<=Number(o);t="for ("+e+" = "+i+"; "+e+(a?" <= ":" >= ")+o+"; "+e,t=(1==(e=Math.abs(Number(r)))?t+(a?"++":"--"):t+(a?" += ":" -= ")+e)+") {\n"+s+"}\n"}else t="",a=i,i.match(/^\w+$/)||n.isNumber(i)||(t+=(a=n.PHP.variableDB_.getDistinctName(e+"_start",n.VARIABLE_CATEGORY_NAME))+" = "+i+";\n"),i=o,o.match(/^\w+$/)||n.isNumber(o)||(t+=(i=n.PHP.variableDB_.getDistinctName(e+"_end",n.VARIABLE_CATEGORY_NAME))+" = "+o+";\n"),t+=(o=n.PHP.variableDB_.getDistinctName(e+"_inc",n.VARIABLE_CATEGORY_NAME))+" = ",t=(t=n.isNumber(r)?t+(Math.abs(r)+";\n"):t+"abs("+r+");\n")+"if ("+a+" > "+i+") {\n"+(n.PHP.INDENT+o)+" = -"+o+";\n",t+="}\n",t+="for ("+e+" = "+a+"; "+o+" >= 0 ? "+e+" <= "+i+" : "+e+" >= "+i+"; "+e+" += "+o+") {\n"+s+"}\n";return t},n.PHP.controls_forEach=function(t){var e=n.PHP.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME),i=n.PHP.valueToCode(t,"LIST",n.PHP.ORDER_ASSIGNMENT)||"[]",o=n.PHP.statementToCode(t,"DO");return"foreach ("+i+" as "+e+") {\n"+(o=n.PHP.addLoopTrap(o,t))+"}\n"},n.PHP.controls_flow_statements=function(t){var e="";if(n.PHP.STATEMENT_PREFIX&&(e+=n.PHP.injectId(n.PHP.STATEMENT_PREFIX,t)),n.PHP.STATEMENT_SUFFIX&&(e+=n.PHP.injectId(n.PHP.STATEMENT_SUFFIX,t)),n.PHP.STATEMENT_PREFIX){var i=n.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.getSurroundLoop(t);i&&!i.suppressPrefixSuffix&&(e+=n.PHP.injectId(n.PHP.STATEMENT_PREFIX,i))}switch(t.getFieldValue("FLOW")){case"BREAK":return e+"break;\n";case"CONTINUE":return e+"continue;\n"}throw Error("Unknown flow statement.")},n.PHP.math={},n.PHP.math_number=function(t){var e=0<=(t=Number(t.getFieldValue("NUM")))?n.PHP.ORDER_ATOMIC:n.PHP.ORDER_UNARY_NEGATION;return 1/0==t?t="INF":-1/0==t&&(t="-INF"),[t,e]},n.PHP.math_arithmetic=function(t){var e={ADD:[" + ",n.PHP.ORDER_ADDITION],MINUS:[" - ",n.PHP.ORDER_SUBTRACTION],MULTIPLY:[" * ",n.PHP.ORDER_MULTIPLICATION],DIVIDE:[" / ",n.PHP.ORDER_DIVISION],POWER:[" ** ",n.PHP.ORDER_POWER]}[t.getFieldValue("OP")],i=e[0];return e=e[1],[(n.PHP.valueToCode(t,"A",e)||"0")+i+(t=n.PHP.valueToCode(t,"B",e)||"0"),e]},n.PHP.math_single=function(t){var e=t.getFieldValue("OP");if("NEG"==e)return"-"==(t=n.PHP.valueToCode(t,"NUM",n.PHP.ORDER_UNARY_NEGATION)||"0")[0]&&(t=" "+t),["-"+t,n.PHP.ORDER_UNARY_NEGATION];switch(t="SIN"==e||"COS"==e||"TAN"==e?n.PHP.valueToCode(t,"NUM",n.PHP.ORDER_DIVISION)||"0":n.PHP.valueToCode(t,"NUM",n.PHP.ORDER_NONE)||"0",e){case"ABS":var i="abs("+t+")";break;case"ROOT":i="sqrt("+t+")";break;case"LN":i="log("+t+")";break;case"EXP":i="exp("+t+")";break;case"POW10":i="pow(10,"+t+")";break;case"ROUND":i="round("+t+")";break;case"ROUNDUP":i="ceil("+t+")";break;case"ROUNDDOWN":i="floor("+t+")";break;case"SIN":i="sin("+t+" / 180 * pi())";break;case"COS":i="cos("+t+" / 180 * pi())";break;case"TAN":i="tan("+t+" / 180 * pi())"}if(i)return[i,n.PHP.ORDER_FUNCTION_CALL];switch(e){case"LOG10":i="log("+t+") / log(10)";break;case"ASIN":i="asin("+t+") / pi() * 180";break;case"ACOS":i="acos("+t+") / pi() * 180";break;case"ATAN":i="atan("+t+") / pi() * 180";break;default:throw Error("Unknown math operator: "+e)}return[i,n.PHP.ORDER_DIVISION]},n.PHP.math_constant=function(t){return{PI:["M_PI",n.PHP.ORDER_ATOMIC],E:["M_E",n.PHP.ORDER_ATOMIC],GOLDEN_RATIO:["(1 + sqrt(5)) / 2",n.PHP.ORDER_DIVISION],SQRT2:["M_SQRT2",n.PHP.ORDER_ATOMIC],SQRT1_2:["M_SQRT1_2",n.PHP.ORDER_ATOMIC],INFINITY:["INF",n.PHP.ORDER_ATOMIC]}[t.getFieldValue("CONSTANT")]},n.PHP.math_number_property=function(t){var e=n.PHP.valueToCode(t,"NUMBER_TO_CHECK",n.PHP.ORDER_MODULUS)||"0",i=t.getFieldValue("PROPERTY");if("PRIME"==i)return[n.PHP.provideFunction_("math_isPrime",["function "+n.PHP.FUNCTION_NAME_PLACEHOLDER_+"($n) {","  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods","  if ($n == 2 || $n == 3) {","    return true;","  }","  // False if n is NaN, negative, is 1, or not whole.","  // And false if n is divisible by 2 or 3.","  if (!is_numeric($n) || $n <= 1 || $n % 1 != 0 || $n % 2 == 0 || $n % 3 == 0) {","    return false;","  }","  // Check all the numbers of form 6k +/- 1, up to sqrt(n).","  for ($x = 6; $x <= sqrt($n) + 1; $x += 6) {","    if ($n % ($x - 1) == 0 || $n % ($x + 1) == 0) {","      return false;","    }","  }","  return true;","}"])+"("+e+")",n.PHP.ORDER_FUNCTION_CALL];switch(i){case"EVEN":var o=e+" % 2 == 0";break;case"ODD":o=e+" % 2 == 1";break;case"WHOLE":o="is_int("+e+")";break;case"POSITIVE":o=e+" > 0";break;case"NEGATIVE":o=e+" < 0";break;case"DIVISIBLE_BY":o=e+" % "+(t=n.PHP.valueToCode(t,"DIVISOR",n.PHP.ORDER_MODULUS)||"0")+" == 0"}return[o,n.PHP.ORDER_EQUALITY]},n.PHP.math_change=function(t){var e=n.PHP.valueToCode(t,"DELTA",n.PHP.ORDER_ADDITION)||"0";return n.PHP.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME)+" += "+e+";\n"},n.PHP.math_round=n.PHP.math_single,n.PHP.math_trig=n.PHP.math_single,n.PHP.math_on_list=function(t){var e=t.getFieldValue("OP");switch(e){case"SUM":t="array_sum("+(t=n.PHP.valueToCode(t,"LIST",n.PHP.ORDER_FUNCTION_CALL)||"array()")+")";break;case"MIN":t="min("+(t=n.PHP.valueToCode(t,"LIST",n.PHP.ORDER_FUNCTION_CALL)||"array()")+")";break;case"MAX":t="max("+(t=n.PHP.valueToCode(t,"LIST",n.PHP.ORDER_FUNCTION_CALL)||"array()")+")";break;case"AVERAGE":t=(e=n.PHP.provideFunction_("math_mean",["function "+n.PHP.FUNCTION_NAME_PLACEHOLDER_+"($myList) {","  return array_sum($myList) / count($myList);","}"]))+"("+(t=n.PHP.valueToCode(t,"LIST",n.PHP.ORDER_NONE)||"array()")+")";break;case"MEDIAN":t=(e=n.PHP.provideFunction_("math_median",["function "+n.PHP.FUNCTION_NAME_PLACEHOLDER_+"($arr) {","  sort($arr,SORT_NUMERIC);","  return (count($arr) % 2) ? $arr[floor(count($arr)/2)] : ","      ($arr[floor(count($arr)/2)] + $arr[floor(count($arr)/2) - 1]) / 2;","}"]))+"("+(t=n.PHP.valueToCode(t,"LIST",n.PHP.ORDER_NONE)||"[]")+")";break;case"MODE":t=(e=n.PHP.provideFunction_("math_modes",["function "+n.PHP.FUNCTION_NAME_PLACEHOLDER_+"($values) {","  if (empty($values)) return array();","  $counts = array_count_values($values);","  arsort($counts); // Sort counts in descending order","  $modes = array_keys($counts, current($counts), true);","  return $modes;","}"]))+"("+(t=n.PHP.valueToCode(t,"LIST",n.PHP.ORDER_NONE)||"[]")+")";break;case"STD_DEV":t=(e=n.PHP.provideFunction_("math_standard_deviation",["function "+n.PHP.FUNCTION_NAME_PLACEHOLDER_+"($numbers) {","  $n = count($numbers);","  if (!$n) return null;","  $mean = array_sum($numbers) / count($numbers);","  foreach($numbers as $key => $num) $devs[$key] = pow($num - $mean, 2);","  return sqrt(array_sum($devs) / (count($devs) - 1));","}"]))+"("+(t=n.PHP.valueToCode(t,"LIST",n.PHP.ORDER_NONE)||"[]")+")";break;case"RANDOM":t=(e=n.PHP.provideFunction_("math_random_list",["function "+n.PHP.FUNCTION_NAME_PLACEHOLDER_+"($list) {","  $x = rand(0, count($list)-1);","  return $list[$x];","}"]))+"("+(t=n.PHP.valueToCode(t,"LIST",n.PHP.ORDER_NONE)||"[]")+")";break;default:throw Error("Unknown operator: "+e)}return[t,n.PHP.ORDER_FUNCTION_CALL]},n.PHP.math_modulo=function(t){return[(n.PHP.valueToCode(t,"DIVIDEND",n.PHP.ORDER_MODULUS)||"0")+" % "+(t=n.PHP.valueToCode(t,"DIVISOR",n.PHP.ORDER_MODULUS)||"0"),n.PHP.ORDER_MODULUS]},n.PHP.math_constrain=function(t){return["min(max("+(n.PHP.valueToCode(t,"VALUE",n.PHP.ORDER_NONE)||"0")+", "+(n.PHP.valueToCode(t,"LOW",n.PHP.ORDER_NONE)||"0")+"), "+(t=n.PHP.valueToCode(t,"HIGH",n.PHP.ORDER_NONE)||"Infinity")+")",n.PHP.ORDER_FUNCTION_CALL]},n.PHP.math_random_int=function(t){var e=n.PHP.valueToCode(t,"FROM",n.PHP.ORDER_NONE)||"0";return t=n.PHP.valueToCode(t,"TO",n.PHP.ORDER_NONE)||"0",[n.PHP.provideFunction_("math_random_int",["function "+n.PHP.FUNCTION_NAME_PLACEHOLDER_+"($a, $b) {","  if ($a > $b) {","    return rand($b, $a);","  }","  return rand($a, $b);","}"])+"("+e+", "+t+")",n.PHP.ORDER_FUNCTION_CALL]},n.PHP.math_random_float=function(t){return["(float)rand()/(float)getrandmax()",n.PHP.ORDER_FUNCTION_CALL]},n.PHP.math_atan2=function(t){var e=n.PHP.valueToCode(t,"X",n.PHP.ORDER_NONE)||"0";return["atan2("+(n.PHP.valueToCode(t,"Y",n.PHP.ORDER_NONE)||"0")+", "+e+") / pi() * 180",n.PHP.ORDER_DIVISION]},n.PHP.procedures={},n.PHP.procedures_defreturn=function(t){for(var e,i=[],o=t.workspace,r=n.Variables.allUsedVarModels(o)||[],s=0;e=r[s];s++)e=e.name,-1==t.getVars().indexOf(e)&&i.push(n.PHP.variableDB_.getName(e,n.VARIABLE_CATEGORY_NAME));for(r=n.Variables.allDeveloperVariables(o),s=0;s<r.length;s++)i.push(n.PHP.variableDB_.getName(r[s],n.Names.DEVELOPER_VARIABLE_TYPE));i=i.length?n.PHP.INDENT+"global "+i.join(", ")+";\n":"",o=n.PHP.variableDB_.getName(t.getFieldValue("NAME"),n.PROCEDURE_CATEGORY_NAME),e="",n.PHP.STATEMENT_PREFIX&&(e+=n.PHP.injectId(n.PHP.STATEMENT_PREFIX,t)),n.PHP.STATEMENT_SUFFIX&&(e+=n.PHP.injectId(n.PHP.STATEMENT_SUFFIX,t)),e&&(e=n.PHP.prefixLines(e,n.PHP.INDENT));var a="";n.PHP.INFINITE_LOOP_TRAP&&(a=n.PHP.prefixLines(n.PHP.injectId(n.PHP.INFINITE_LOOP_TRAP,t),n.PHP.INDENT));var l=n.PHP.statementToCode(t,"STACK"),c=n.PHP.valueToCode(t,"RETURN",n.PHP.ORDER_NONE)||"",d="";l&&c&&(d=e),c&&(c=n.PHP.INDENT+"return "+c+";\n");var u=[];for(r=t.getVars(),s=0;s<r.length;s++)u[s]=n.PHP.variableDB_.getName(r[s],n.VARIABLE_CATEGORY_NAME);return i="function "+o+"("+u.join(", ")+") {\n"+i+e+a+l+d+c+"}",i=n.PHP.scrub_(t,i),n.PHP.definitions_["%"+o]=i,null},n.PHP.procedures_defnoreturn=n.PHP.procedures_defreturn,n.PHP.procedures_callreturn=function(t){for(var e=n.PHP.variableDB_.getName(t.getFieldValue("NAME"),n.PROCEDURE_CATEGORY_NAME),i=[],o=t.getVars(),r=0;r<o.length;r++)i[r]=n.PHP.valueToCode(t,"ARG"+r,n.PHP.ORDER_NONE)||"null";return[e+"("+i.join(", ")+")",n.PHP.ORDER_FUNCTION_CALL]},n.PHP.procedures_callnoreturn=function(t){return n.PHP.procedures_callreturn(t)[0]+";\n"},n.PHP.procedures_ifreturn=function(t){var e="if ("+(n.PHP.valueToCode(t,"CONDITION",n.PHP.ORDER_NONE)||"false")+") {\n";return n.PHP.STATEMENT_SUFFIX&&(e+=n.PHP.prefixLines(n.PHP.injectId(n.PHP.STATEMENT_SUFFIX,t),n.PHP.INDENT)),t.hasReturnValue_?(t=n.PHP.valueToCode(t,"VALUE",n.PHP.ORDER_NONE)||"null",e+=n.PHP.INDENT+"return "+t+";\n"):e+=n.PHP.INDENT+"return;\n",e+"}\n"},n.PHP.texts={},n.PHP.text=function(t){return[n.PHP.quote_(t.getFieldValue("TEXT")),n.PHP.ORDER_ATOMIC]},n.PHP.text_multiline=function(t){var e=-1!=(t=n.PHP.multiline_quote_(t.getFieldValue("TEXT"))).indexOf(".")?n.PHP.ORDER_STRING_CONCAT:n.PHP.ORDER_ATOMIC;return[t,e]},n.PHP.text_join=function(t){if(0==t.itemCount_)return["''",n.PHP.ORDER_ATOMIC];if(1==t.itemCount_)return[n.PHP.valueToCode(t,"ADD0",n.PHP.ORDER_NONE)||"''",n.PHP.ORDER_NONE];if(2==t.itemCount_){var e=n.PHP.valueToCode(t,"ADD0",n.PHP.ORDER_STRING_CONCAT)||"''";return[e+" . "+(t=n.PHP.valueToCode(t,"ADD1",n.PHP.ORDER_STRING_CONCAT)||"''"),n.PHP.ORDER_STRING_CONCAT]}e=Array(t.itemCount_);for(var i=0;i<t.itemCount_;i++)e[i]=n.PHP.valueToCode(t,"ADD"+i,n.PHP.ORDER_NONE)||"''";return[t="implode('', array("+e.join(",")+"))",n.PHP.ORDER_FUNCTION_CALL]},n.PHP.text_append=function(t){return n.PHP.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME)+" .= "+(t=n.PHP.valueToCode(t,"TEXT",n.PHP.ORDER_ASSIGNMENT)||"''")+";\n"},n.PHP.text_length=function(t){return[n.PHP.provideFunction_("length",["function "+n.PHP.FUNCTION_NAME_PLACEHOLDER_+"($value) {","  if (is_string($value)) {","    return strlen($value);","  } else {","    return count($value);","  }","}"])+"("+(t=n.PHP.valueToCode(t,"VALUE",n.PHP.ORDER_NONE)||"''")+")",n.PHP.ORDER_FUNCTION_CALL]},n.PHP.text_isEmpty=function(t){return["empty("+(n.PHP.valueToCode(t,"VALUE",n.PHP.ORDER_NONE)||"''")+")",n.PHP.ORDER_FUNCTION_CALL]},n.PHP.text_indexOf=function(t){var e="FIRST"==t.getFieldValue("END")?"strpos":"strrpos",i=n.PHP.valueToCode(t,"FIND",n.PHP.ORDER_NONE)||"''",o=n.PHP.valueToCode(t,"VALUE",n.PHP.ORDER_NONE)||"''";if(t.workspace.options.oneBasedIndex)var r=" 0",s=" + 1";else r=" -1",s="";return[n.PHP.provideFunction_("FIRST"==t.getFieldValue("END")?"text_indexOf":"text_lastIndexOf",["function "+n.PHP.FUNCTION_NAME_PLACEHOLDER_+"($text, $search) {","  $pos = "+e+"($text, $search);","  return $pos === false ? "+r+" : $pos"+s+";","}"])+"("+o+", "+i+")",n.PHP.ORDER_FUNCTION_CALL]},n.PHP.text_charAt=function(t){var e=t.getFieldValue("WHERE")||"FROM_START",i=n.PHP.valueToCode(t,"VALUE",n.PHP.ORDER_NONE)||"''";switch(e){case"FIRST":return["substr("+i+", 0, 1)",n.PHP.ORDER_FUNCTION_CALL];case"LAST":return["substr("+i+", -1)",n.PHP.ORDER_FUNCTION_CALL];case"FROM_START":return["substr("+i+", "+(t=n.PHP.getAdjusted(t,"AT"))+", 1)",n.PHP.ORDER_FUNCTION_CALL];case"FROM_END":return["substr("+i+", "+(t=n.PHP.getAdjusted(t,"AT",1,!0))+", 1)",n.PHP.ORDER_FUNCTION_CALL];case"RANDOM":return[n.PHP.provideFunction_("text_random_letter",["function "+n.PHP.FUNCTION_NAME_PLACEHOLDER_+"($text) {","  return $text[rand(0, strlen($text) - 1)];","}"])+"("+i+")",n.PHP.ORDER_FUNCTION_CALL]}throw Error("Unhandled option (text_charAt).")},n.PHP.text_getSubstring=function(t){var e=t.getFieldValue("WHERE1"),i=t.getFieldValue("WHERE2"),o=n.PHP.valueToCode(t,"STRING",n.PHP.ORDER_NONE)||"''";if("FIRST"==e&&"LAST"==i)return[o,n.PHP.ORDER_NONE];var r=n.PHP.getAdjusted(t,"AT1");return t=n.PHP.getAdjusted(t,"AT2"),[n.PHP.provideFunction_("text_get_substring",["function "+n.PHP.FUNCTION_NAME_PLACEHOLDER_+"($text, $where1, $at1, $where2, $at2) {","  if ($where1 == 'FROM_END') {","    $at1 = strlen($text) - 1 - $at1;","  } else if ($where1 == 'FIRST') {","    $at1 = 0;","  } else if ($where1 != 'FROM_START') {","    throw new Exception('Unhandled option (text_get_substring).');","  }","  $length = 0;","  if ($where2 == 'FROM_START') {","    $length = $at2 - $at1 + 1;","  } else if ($where2 == 'FROM_END') {","    $length = strlen($text) - $at1 - $at2;","  } else if ($where2 == 'LAST') {","    $length = strlen($text) - $at1;","  } else {","    throw new Exception('Unhandled option (text_get_substring).');","  }","  return substr($text, $at1, $length);","}"])+"("+o+", '"+e+"', "+r+", '"+i+"', "+t+")",n.PHP.ORDER_FUNCTION_CALL]},n.PHP.text_changeCase=function(t){var e=n.PHP.valueToCode(t,"TEXT",n.PHP.ORDER_NONE)||"''";if("UPPERCASE"==t.getFieldValue("CASE"))var i="strtoupper("+e+")";else"LOWERCASE"==t.getFieldValue("CASE")?i="strtolower("+e+")":"TITLECASE"==t.getFieldValue("CASE")&&(i="ucwords(strtolower("+e+"))");return[i,n.PHP.ORDER_FUNCTION_CALL]},n.PHP.text_trim=function(t){return[{LEFT:"ltrim",RIGHT:"rtrim",BOTH:"trim"}[t.getFieldValue("MODE")]+"("+(t=n.PHP.valueToCode(t,"TEXT",n.PHP.ORDER_NONE)||"''")+")",n.PHP.ORDER_FUNCTION_CALL]},n.PHP.text_print=function(t){return"print("+(n.PHP.valueToCode(t,"TEXT",n.PHP.ORDER_NONE)||"''")+");\n"},n.PHP.text_prompt_ext=function(t){var e="readline("+(t.getField("TEXT")?n.PHP.quote_(t.getFieldValue("TEXT")):n.PHP.valueToCode(t,"TEXT",n.PHP.ORDER_NONE)||"''")+")";return"NUMBER"==t.getFieldValue("TYPE")&&(e="floatval("+e+")"),[e,n.PHP.ORDER_FUNCTION_CALL]},n.PHP.text_prompt=n.PHP.text_prompt_ext,n.PHP.text_count=function(t){var e=n.PHP.valueToCode(t,"TEXT",n.PHP.ORDER_NONE)||"''";return["strlen("+(t=n.PHP.valueToCode(t,"SUB",n.PHP.ORDER_NONE)||"''")+") === 0 ? strlen("+e+") + 1 : substr_count("+e+", "+t+")",n.PHP.ORDER_CONDITIONAL]},n.PHP.text_replace=function(t){var e=n.PHP.valueToCode(t,"TEXT",n.PHP.ORDER_NONE)||"''";return["str_replace("+(n.PHP.valueToCode(t,"FROM",n.PHP.ORDER_NONE)||"''")+", "+(t=n.PHP.valueToCode(t,"TO",n.PHP.ORDER_NONE)||"''")+", "+e+")",n.PHP.ORDER_FUNCTION_CALL]},n.PHP.text_reverse=function(t){return["strrev("+(n.PHP.valueToCode(t,"TEXT",n.PHP.ORDER_NONE)||"''")+")",n.PHP.ORDER_FUNCTION_CALL]},n.PHP.variables={},n.PHP.variables_get=function(t){return[n.PHP.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME),n.PHP.ORDER_ATOMIC]},n.PHP.variables_set=function(t){var e=n.PHP.valueToCode(t,"VALUE",n.PHP.ORDER_ASSIGNMENT)||"0";return n.PHP.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME)+" = "+e+";\n"},n.PHP.variablesDynamic={},n.PHP.variables_get_dynamic=n.PHP.variables_get,n.PHP.variables_set_dynamic=n.PHP.variables_set,n.PHP)})),VP=IP((function(t,e){var n;t.exports=(n=UP,DP.PHP=n,n)})),GP=IP((function(t,e){var n;t.exports=((n=kP).Lua=new n.Generator("Lua"),n.Lua.addReservedWords("_,__inext,assert,bit,colors,colours,coroutine,disk,dofile,error,fs,fetfenv,getmetatable,gps,help,io,ipairs,keys,loadfile,loadstring,math,native,next,os,paintutils,pairs,parallel,pcall,peripheral,print,printError,rawequal,rawget,rawset,read,rednet,redstone,rs,select,setfenv,setmetatable,sleep,string,table,term,textutils,tonumber,tostring,turtle,type,unpack,vector,write,xpcall,_VERSION,__indext,HTTP,and,break,do,else,elseif,end,false,for,function,if,in,local,nil,not,or,repeat,return,then,true,until,while,add,sub,mul,div,mod,pow,unm,concat,len,eq,lt,le,index,newindex,call,assert,collectgarbage,dofile,error,_G,getmetatable,inpairs,load,loadfile,next,pairs,pcall,print,rawequal,rawget,rawlen,rawset,select,setmetatable,tonumber,tostring,type,_VERSION,xpcall,require,package,string,table,math,bit32,io,file,os,debug"),n.Lua.ORDER_ATOMIC=0,n.Lua.ORDER_HIGH=1,n.Lua.ORDER_EXPONENTIATION=2,n.Lua.ORDER_UNARY=3,n.Lua.ORDER_MULTIPLICATIVE=4,n.Lua.ORDER_ADDITIVE=5,n.Lua.ORDER_CONCATENATION=6,n.Lua.ORDER_RELATIONAL=7,n.Lua.ORDER_AND=8,n.Lua.ORDER_OR=9,n.Lua.ORDER_NONE=99,n.Lua.isInitialized=!1,n.Lua.init=function(t){n.Lua.definitions_=Object.create(null),n.Lua.functionNames_=Object.create(null),n.Lua.variableDB_?n.Lua.variableDB_.reset():n.Lua.variableDB_=new n.Names(n.Lua.RESERVED_WORDS_),n.Lua.variableDB_.setVariableMap(t.getVariableMap()),this.isInitialized=!0},n.Lua.finish=function(t){var e,i=[];for(e in n.Lua.definitions_)i.push(n.Lua.definitions_[e]);return delete n.Lua.definitions_,delete n.Lua.functionNames_,n.Lua.variableDB_.reset(),i.join("\n\n")+"\n\n\n"+t},n.Lua.scrubNakedValue=function(t){return"local _ = "+t+"\n"},n.Lua.quote_=function(t){return"'"+(t=t.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'"))+"'"},n.Lua.multiline_quote_=function(t){return t.split(/\n/g).map(n.Lua.quote_).join(" .. '\\n' ..\n")},n.Lua.scrub_=function(t,e,i){var o="";if(!t.outputConnection||!t.outputConnection.targetConnection){var r=t.getCommentText();r&&(r=n.utils.string.wrap(r,n.Lua.COMMENT_WRAP-3),o+=n.Lua.prefixLines(r,"-- ")+"\n");for(var s=0;s<t.inputList.length;s++)t.inputList[s].type==n.INPUT_VALUE&&(r=t.inputList[s].connection.targetBlock())&&(r=n.Lua.allNestedComments(r))&&(o+=n.Lua.prefixLines(r,"-- "))}return t=t.nextConnection&&t.nextConnection.targetBlock(),o+e+(i=i?"":n.Lua.blockToCode(t))},n.Lua.colour={},n.Lua.colour_picker=function(t){return[n.Lua.quote_(t.getFieldValue("COLOUR")),n.Lua.ORDER_ATOMIC]},n.Lua.colour_random=function(t){return['string.format("#%06x", math.random(0, 2^24 - 1))',n.Lua.ORDER_HIGH]},n.Lua.colour_rgb=function(t){return[n.Lua.provideFunction_("colour_rgb",["function "+n.Lua.FUNCTION_NAME_PLACEHOLDER_+"(r, g, b)","  r = math.floor(math.min(100, math.max(0, r)) * 2.55 + .5)","  g = math.floor(math.min(100, math.max(0, g)) * 2.55 + .5)","  b = math.floor(math.min(100, math.max(0, b)) * 2.55 + .5)",'  return string.format("#%02x%02x%02x", r, g, b)',"end"])+"("+(n.Lua.valueToCode(t,"RED",n.Lua.ORDER_NONE)||0)+", "+(n.Lua.valueToCode(t,"GREEN",n.Lua.ORDER_NONE)||0)+", "+(t=n.Lua.valueToCode(t,"BLUE",n.Lua.ORDER_NONE)||0)+")",n.Lua.ORDER_HIGH]},n.Lua.colour_blend=function(t){return[n.Lua.provideFunction_("colour_blend",["function "+n.Lua.FUNCTION_NAME_PLACEHOLDER_+"(colour1, colour2, ratio)","  local r1 = tonumber(string.sub(colour1, 2, 3), 16)","  local r2 = tonumber(string.sub(colour2, 2, 3), 16)","  local g1 = tonumber(string.sub(colour1, 4, 5), 16)","  local g2 = tonumber(string.sub(colour2, 4, 5), 16)","  local b1 = tonumber(string.sub(colour1, 6, 7), 16)","  local b2 = tonumber(string.sub(colour2, 6, 7), 16)","  local ratio = math.min(1, math.max(0, ratio))","  local r = math.floor(r1 * (1 - ratio) + r2 * ratio + .5)","  local g = math.floor(g1 * (1 - ratio) + g2 * ratio + .5)","  local b = math.floor(b1 * (1 - ratio) + b2 * ratio + .5)",'  return string.format("#%02x%02x%02x", r, g, b)',"end"])+"("+(n.Lua.valueToCode(t,"COLOUR1",n.Lua.ORDER_NONE)||"'#000000'")+", "+(n.Lua.valueToCode(t,"COLOUR2",n.Lua.ORDER_NONE)||"'#000000'")+", "+(t=n.Lua.valueToCode(t,"RATIO",n.Lua.ORDER_NONE)||0)+")",n.Lua.ORDER_HIGH]},n.Lua.lists={},n.Lua.lists_create_empty=function(t){return["{}",n.Lua.ORDER_HIGH]},n.Lua.lists_create_with=function(t){for(var e=Array(t.itemCount_),i=0;i<t.itemCount_;i++)e[i]=n.Lua.valueToCode(t,"ADD"+i,n.Lua.ORDER_NONE)||"None";return["{"+e.join(", ")+"}",n.Lua.ORDER_HIGH]},n.Lua.lists_repeat=function(t){return[n.Lua.provideFunction_("create_list_repeated",["function "+n.Lua.FUNCTION_NAME_PLACEHOLDER_+"(item, count)","  local t = {}","  for i = 1, count do","    table.insert(t, item)","  end","  return t","end"])+"("+(n.Lua.valueToCode(t,"ITEM",n.Lua.ORDER_NONE)||"None")+", "+(t=n.Lua.valueToCode(t,"NUM",n.Lua.ORDER_NONE)||"0")+")",n.Lua.ORDER_HIGH]},n.Lua.lists_length=function(t){return["#"+(n.Lua.valueToCode(t,"VALUE",n.Lua.ORDER_UNARY)||"{}"),n.Lua.ORDER_UNARY]},n.Lua.lists_isEmpty=function(t){return["#"+(n.Lua.valueToCode(t,"VALUE",n.Lua.ORDER_UNARY)||"{}")+" == 0",n.Lua.ORDER_RELATIONAL]},n.Lua.lists_indexOf=function(t){var e=n.Lua.valueToCode(t,"FIND",n.Lua.ORDER_NONE)||"''",i=n.Lua.valueToCode(t,"VALUE",n.Lua.ORDER_NONE)||"{}";return[("FIRST"==t.getFieldValue("END")?n.Lua.provideFunction_("first_index",["function "+n.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t, elem)","  for k, v in ipairs(t) do","    if v == elem then","      return k","    end","  end","  return 0","end"]):n.Lua.provideFunction_("last_index",["function "+n.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t, elem)","  for i = #t, 1, -1 do","    if t[i] == elem then","      return i","    end","  end","  return 0","end"]))+"("+i+", "+e+")",n.Lua.ORDER_HIGH]},n.Lua.lists.getIndex_=function(t,e,n){return"FIRST"==e?"1":"FROM_END"==e?"#"+t+" + 1 - "+n:"LAST"==e?"#"+t:"RANDOM"==e?"math.random(#"+t+")":n},n.Lua.lists_getIndex=function(t){var e=t.getFieldValue("MODE")||"GET",i=t.getFieldValue("WHERE")||"FROM_START",o=n.Lua.valueToCode(t,"VALUE",n.Lua.ORDER_HIGH)||"({})",r=n.Lua.lists.getIndex_;if("LAST"!=i&&"FROM_END"!=i&&"RANDOM"!=i||o.match(/^\w+$/))return s="GET"==e&&"FROM_END"==i?n.Lua.ORDER_ADDITIVE:n.Lua.ORDER_NONE,t=r(o,i,t=n.Lua.valueToCode(t,"AT",s)||"1"),"GET"==e?[o+"["+t+"]",n.Lua.ORDER_HIGH]:(i="table.remove("+o+", "+t+")","GET_REMOVE"==e?[i,n.Lua.ORDER_HIGH]:i+"\n");if("REMOVE"==e){var s="FROM_END"==i?n.Lua.ORDER_ADDITIVE:n.Lua.ORDER_NONE;return t=n.Lua.valueToCode(t,"AT",s)||"1",(e=n.Lua.variableDB_.getDistinctName("tmp_list",n.VARIABLE_CATEGORY_NAME))+" = "+o+"\ntable.remove("+e+", "+(t=r(e,i,t))+")\n"}return t=n.Lua.valueToCode(t,"AT",n.Lua.ORDER_NONE)||"1",[("GET"==e?n.Lua.provideFunction_("list_get_"+i.toLowerCase(),["function "+n.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t"+("FROM_END"==i||"FROM_START"==i?", at)":")"),"  return t["+r("t",i,"at")+"]","end"]):n.Lua.provideFunction_("list_remove_"+i.toLowerCase(),["function "+n.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t"+("FROM_END"==i||"FROM_START"==i?", at)":")"),"  return table.remove(t, "+r("t",i,"at")+")","end"]))+"("+o+("FROM_END"==i||"FROM_START"==i?", "+t:"")+")",n.Lua.ORDER_HIGH]},n.Lua.lists_setIndex=function(t){var e=n.Lua.valueToCode(t,"LIST",n.Lua.ORDER_HIGH)||"{}",i=t.getFieldValue("MODE")||"SET",o=t.getFieldValue("WHERE")||"FROM_START",r=n.Lua.valueToCode(t,"AT",n.Lua.ORDER_ADDITIVE)||"1";t=n.Lua.valueToCode(t,"TO",n.Lua.ORDER_NONE)||"None";var s=n.Lua.lists.getIndex_,a="";if(("LAST"==o||"FROM_END"==o||"RANDOM"==o)&&!e.match(/^\w+$/)){var l=n.Lua.variableDB_.getDistinctName("tmp_list",n.VARIABLE_CATEGORY_NAME);a=l+" = "+e+"\n",e=l}return(a="SET"==i?a+(e+"[")+s(e,o,r)+"] = "+t:a+"table.insert("+e+", "+s(e,o,r)+("LAST"==o?" + 1":"")+", "+t+")")+"\n"},n.Lua.lists_getSublist=function(t){var e=n.Lua.valueToCode(t,"LIST",n.Lua.ORDER_NONE)||"{}",i=t.getFieldValue("WHERE1"),o=t.getFieldValue("WHERE2"),r=n.Lua.valueToCode(t,"AT1",n.Lua.ORDER_NONE)||"1";t=n.Lua.valueToCode(t,"AT2",n.Lua.ORDER_NONE)||"1";var s=n.Lua.lists.getIndex_;return[n.Lua.provideFunction_("list_sublist_"+i.toLowerCase()+"_"+o.toLowerCase(),["function "+n.Lua.FUNCTION_NAME_PLACEHOLDER_+"(source"+("FROM_END"==i||"FROM_START"==i?", at1":"")+("FROM_END"==o||"FROM_START"==o?", at2":"")+")","  local t = {}","  local start = "+s("source",i,"at1"),"  local finish = "+s("source",o,"at2"),"  for i = start, finish do","    table.insert(t, source[i])","  end","  return t","end"])+"("+e+("FROM_END"==i||"FROM_START"==i?", "+r:"")+("FROM_END"==o||"FROM_START"==o?", "+t:"")+")",n.Lua.ORDER_HIGH]},n.Lua.lists_sort=function(t){var e=n.Lua.valueToCode(t,"LIST",n.Lua.ORDER_NONE)||"{}",i="1"===t.getFieldValue("DIRECTION")?1:-1;return t=t.getFieldValue("TYPE"),[n.Lua.provideFunction_("list_sort",["function "+n.Lua.FUNCTION_NAME_PLACEHOLDER_+"(list, typev, direction)","  local t = {}","  for n,v in pairs(list) do table.insert(t, v) end","  local compareFuncs = {","    NUMERIC = function(a, b)","      return (tonumber(tostring(a)) or 0)","          < (tonumber(tostring(b)) or 0) end,","    TEXT = function(a, b)","      return tostring(a) < tostring(b) end,","    IGNORE_CASE = function(a, b)","      return string.lower(tostring(a)) < string.lower(tostring(b)) end","  }","  local compareTemp = compareFuncs[typev]","  local compare = compareTemp","  if direction == -1","  then compare = function(a, b) return compareTemp(b, a) end","  end","  table.sort(t, compare)","  return t","end"])+"("+e+',"'+t+'", '+i+")",n.Lua.ORDER_HIGH]},n.Lua.lists_split=function(t){var e=n.Lua.valueToCode(t,"INPUT",n.Lua.ORDER_NONE),i=n.Lua.valueToCode(t,"DELIM",n.Lua.ORDER_NONE)||"''";if("SPLIT"==(t=t.getFieldValue("MODE")))e||(e="''"),t=n.Lua.provideFunction_("list_string_split",["function "+n.Lua.FUNCTION_NAME_PLACEHOLDER_+"(input, delim)","  local t = {}","  local pos = 1","  while true do","    next_delim = string.find(input, delim, pos)","    if next_delim == nil then","      table.insert(t, string.sub(input, pos))","      break","    else","      table.insert(t, string.sub(input, pos, next_delim-1))","      pos = next_delim + #delim","    end","  end","  return t","end"]);else{if("JOIN"!=t)throw Error("Unknown mode: "+t);e||(e="{}"),t="table.concat"}return[t+"("+e+", "+i+")",n.Lua.ORDER_HIGH]},n.Lua.lists_reverse=function(t){return t=n.Lua.valueToCode(t,"LIST",n.Lua.ORDER_NONE)||"{}",[n.Lua.provideFunction_("list_reverse",["function "+n.Lua.FUNCTION_NAME_PLACEHOLDER_+"(input)","  local reversed = {}","  for i = #input, 1, -1 do","    table.insert(reversed, input[i])","  end","  return reversed","end"])+"("+t+")",n.Lua.ORDER_HIGH]},n.Lua.logic={},n.Lua.controls_if=function(t){var e=0,i="";n.Lua.STATEMENT_PREFIX&&(i+=n.Lua.injectId(n.Lua.STATEMENT_PREFIX,t));do{var o=n.Lua.valueToCode(t,"IF"+e,n.Lua.ORDER_NONE)||"false",r=n.Lua.statementToCode(t,"DO"+e);n.Lua.STATEMENT_SUFFIX&&(r=n.Lua.prefixLines(n.Lua.injectId(n.Lua.STATEMENT_SUFFIX,t),n.Lua.INDENT)+r),i+=(0<e?"else":"")+"if "+o+" then\n"+r,++e}while(t.getInput("IF"+e));return(t.getInput("ELSE")||n.Lua.STATEMENT_SUFFIX)&&(r=n.Lua.statementToCode(t,"ELSE"),n.Lua.STATEMENT_SUFFIX&&(r=n.Lua.prefixLines(n.Lua.injectId(n.Lua.STATEMENT_SUFFIX,t),n.Lua.INDENT)+r),i+="else\n"+r),i+"end\n"},n.Lua.controls_ifelse=n.Lua.controls_if,n.Lua.logic_compare=function(t){var e={EQ:"==",NEQ:"~=",LT:"<",LTE:"<=",GT:">",GTE:">="}[t.getFieldValue("OP")];return[(n.Lua.valueToCode(t,"A",n.Lua.ORDER_RELATIONAL)||"0")+" "+e+" "+(t=n.Lua.valueToCode(t,"B",n.Lua.ORDER_RELATIONAL)||"0"),n.Lua.ORDER_RELATIONAL]},n.Lua.logic_operation=function(t){var e="AND"==t.getFieldValue("OP")?"and":"or",i="and"==e?n.Lua.ORDER_AND:n.Lua.ORDER_OR,o=n.Lua.valueToCode(t,"A",i);if(t=n.Lua.valueToCode(t,"B",i),o||t){var r="and"==e?"true":"false";o||(o=r),t||(t=r)}else t=o="false";return[o+" "+e+" "+t,i]},n.Lua.logic_negate=function(t){return["not "+(n.Lua.valueToCode(t,"BOOL",n.Lua.ORDER_UNARY)||"true"),n.Lua.ORDER_UNARY]},n.Lua.logic_boolean=function(t){return["TRUE"==t.getFieldValue("BOOL")?"true":"false",n.Lua.ORDER_ATOMIC]},n.Lua.logic_null=function(t){return["nil",n.Lua.ORDER_ATOMIC]},n.Lua.logic_ternary=function(t){return[(n.Lua.valueToCode(t,"IF",n.Lua.ORDER_AND)||"false")+" and "+(n.Lua.valueToCode(t,"THEN",n.Lua.ORDER_AND)||"nil")+" or "+(t=n.Lua.valueToCode(t,"ELSE",n.Lua.ORDER_OR)||"nil"),n.Lua.ORDER_OR]},n.Lua.loops={},n.Lua.CONTINUE_STATEMENT="goto continue\n",n.Lua.addContinueLabel_=function(t){return-1!=t.indexOf(n.Lua.CONTINUE_STATEMENT)?t+n.Lua.INDENT+"::continue::\n":t},n.Lua.controls_repeat_ext=function(t){var e=t.getField("TIMES")?String(Number(t.getFieldValue("TIMES"))):n.Lua.valueToCode(t,"TIMES",n.Lua.ORDER_NONE)||"0";e=n.isNumber(e)?parseInt(e,10):"math.floor("+e+")";var i=n.Lua.statementToCode(t,"DO");return i=n.Lua.addLoopTrap(i,t),i=n.Lua.addContinueLabel_(i),"for "+n.Lua.variableDB_.getDistinctName("count",n.VARIABLE_CATEGORY_NAME)+" = 1, "+e+" do\n"+i+"end\n"},n.Lua.controls_repeat=n.Lua.controls_repeat_ext,n.Lua.controls_whileUntil=function(t){var e="UNTIL"==t.getFieldValue("MODE"),i=n.Lua.valueToCode(t,"BOOL",e?n.Lua.ORDER_UNARY:n.Lua.ORDER_NONE)||"false",o=n.Lua.statementToCode(t,"DO");return o=n.Lua.addLoopTrap(o,t),e&&(i="not "+i),"while "+i+" do\n"+(o=n.Lua.addContinueLabel_(o))+"end\n"},n.Lua.controls_for=function(t){var e=n.Lua.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME),i=n.Lua.valueToCode(t,"FROM",n.Lua.ORDER_NONE)||"0",o=n.Lua.valueToCode(t,"TO",n.Lua.ORDER_NONE)||"0",r=n.Lua.valueToCode(t,"BY",n.Lua.ORDER_NONE)||"1",s=n.Lua.statementToCode(t,"DO");if(s=n.Lua.addLoopTrap(s,t),s=n.Lua.addContinueLabel_(s),t="",n.isNumber(i)&&n.isNumber(o)&&n.isNumber(r))var a=(Number(i)<=Number(o)?"":"-")+Math.abs(Number(r));else t="",t+=(a=n.Lua.variableDB_.getDistinctName(e+"_inc",n.VARIABLE_CATEGORY_NAME))+" = ",t=(t=n.isNumber(r)?t+(Math.abs(r)+"\n"):t+"math.abs("+r+")\n")+"if ("+i+") > ("+o+") then\n"+(n.Lua.INDENT+a)+" = -"+a+"\n",t+="end\n";return t+"for "+e+" = "+i+", "+o+", "+a+" do\n"+s+"end\n"},n.Lua.controls_forEach=function(t){var e=n.Lua.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME),i=n.Lua.valueToCode(t,"LIST",n.Lua.ORDER_NONE)||"{}",o=n.Lua.statementToCode(t,"DO");return o=n.Lua.addLoopTrap(o,t),"for _, "+e+" in ipairs("+i+") do \n"+(o=n.Lua.addContinueLabel_(o))+"end\n"},n.Lua.controls_flow_statements=function(t){var e="";if(n.Lua.STATEMENT_PREFIX&&(e+=n.Lua.injectId(n.Lua.STATEMENT_PREFIX,t)),n.Lua.STATEMENT_SUFFIX&&(e+=n.Lua.injectId(n.Lua.STATEMENT_SUFFIX,t)),n.Lua.STATEMENT_PREFIX){var i=n.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.getSurroundLoop(t);i&&!i.suppressPrefixSuffix&&(e+=n.Lua.injectId(n.Lua.STATEMENT_PREFIX,i))}switch(t.getFieldValue("FLOW")){case"BREAK":return e+"break\n";case"CONTINUE":return e+n.Lua.CONTINUE_STATEMENT}throw Error("Unknown flow statement.")},n.Lua.math={},n.Lua.math_number=function(t){return[t=Number(t.getFieldValue("NUM")),0>t?n.Lua.ORDER_UNARY:n.Lua.ORDER_ATOMIC]},n.Lua.math_arithmetic=function(t){var e={ADD:[" + ",n.Lua.ORDER_ADDITIVE],MINUS:[" - ",n.Lua.ORDER_ADDITIVE],MULTIPLY:[" * ",n.Lua.ORDER_MULTIPLICATIVE],DIVIDE:[" / ",n.Lua.ORDER_MULTIPLICATIVE],POWER:[" ^ ",n.Lua.ORDER_EXPONENTIATION]}[t.getFieldValue("OP")],i=e[0];return e=e[1],[(n.Lua.valueToCode(t,"A",e)||"0")+i+(t=n.Lua.valueToCode(t,"B",e)||"0"),e]},n.Lua.math_single=function(t){var e=t.getFieldValue("OP");if("NEG"==e)return["-"+(t=n.Lua.valueToCode(t,"NUM",n.Lua.ORDER_UNARY)||"0"),n.Lua.ORDER_UNARY];if("POW10"==e)return["10 ^ "+(t=n.Lua.valueToCode(t,"NUM",n.Lua.ORDER_EXPONENTIATION)||"0"),n.Lua.ORDER_EXPONENTIATION];switch(t="ROUND"==e?n.Lua.valueToCode(t,"NUM",n.Lua.ORDER_ADDITIVE)||"0":n.Lua.valueToCode(t,"NUM",n.Lua.ORDER_NONE)||"0",e){case"ABS":e="math.abs("+t+")";break;case"ROOT":e="math.sqrt("+t+")";break;case"LN":e="math.log("+t+")";break;case"LOG10":e="math.log("+t+", 10)";break;case"EXP":e="math.exp("+t+")";break;case"ROUND":e="math.floor("+t+" + .5)";break;case"ROUNDUP":e="math.ceil("+t+")";break;case"ROUNDDOWN":e="math.floor("+t+")";break;case"SIN":e="math.sin(math.rad("+t+"))";break;case"COS":e="math.cos(math.rad("+t+"))";break;case"TAN":e="math.tan(math.rad("+t+"))";break;case"ASIN":e="math.deg(math.asin("+t+"))";break;case"ACOS":e="math.deg(math.acos("+t+"))";break;case"ATAN":e="math.deg(math.atan("+t+"))";break;default:throw Error("Unknown math operator: "+e)}return[e,n.Lua.ORDER_HIGH]},n.Lua.math_constant=function(t){return{PI:["math.pi",n.Lua.ORDER_HIGH],E:["math.exp(1)",n.Lua.ORDER_HIGH],GOLDEN_RATIO:["(1 + math.sqrt(5)) / 2",n.Lua.ORDER_MULTIPLICATIVE],SQRT2:["math.sqrt(2)",n.Lua.ORDER_HIGH],SQRT1_2:["math.sqrt(1 / 2)",n.Lua.ORDER_HIGH],INFINITY:["math.huge",n.Lua.ORDER_HIGH]}[t.getFieldValue("CONSTANT")]},n.Lua.math_number_property=function(t){var e=n.Lua.valueToCode(t,"NUMBER_TO_CHECK",n.Lua.ORDER_MULTIPLICATIVE)||"0",i=t.getFieldValue("PROPERTY");if("PRIME"==i)return[n.Lua.provideFunction_("math_isPrime",["function "+n.Lua.FUNCTION_NAME_PLACEHOLDER_+"(n)","  -- https://en.wikipedia.org/wiki/Primality_test#Naive_methods","  if n == 2 or n == 3 then","    return true","  end","  -- False if n is NaN, negative, is 1, or not whole.","  -- And false if n is divisible by 2 or 3.","  if not(n > 1) or n % 1 ~= 0 or n % 2 == 0 or n % 3 == 0 then","    return false","  end","  -- Check all the numbers of form 6k +/- 1, up to sqrt(n).","  for x = 6, math.sqrt(n) + 1.5, 6 do","    if n % (x - 1) == 0 or n % (x + 1) == 0 then","      return false","    end","  end","  return true","end"])+"("+e+")",n.Lua.ORDER_HIGH];switch(i){case"EVEN":var o=e+" % 2 == 0";break;case"ODD":o=e+" % 2 == 1";break;case"WHOLE":o=e+" % 1 == 0";break;case"POSITIVE":o=e+" > 0";break;case"NEGATIVE":o=e+" < 0";break;case"DIVISIBLE_BY":if(!(t=n.Lua.valueToCode(t,"DIVISOR",n.Lua.ORDER_MULTIPLICATIVE))||"0"==t)return["nil",n.Lua.ORDER_ATOMIC];o=e+" % "+t+" == 0"}return[o,n.Lua.ORDER_RELATIONAL]},n.Lua.math_change=function(t){var e=n.Lua.valueToCode(t,"DELTA",n.Lua.ORDER_ADDITIVE)||"0";return(t=n.Lua.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME))+" = "+t+" + "+e+"\n"},n.Lua.math_round=n.Lua.math_single,n.Lua.math_trig=n.Lua.math_single,n.Lua.math_on_list=function(t){function e(){return n.Lua.provideFunction_("math_sum",["function "+n.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t)","  local result = 0","  for _, v in ipairs(t) do","    result = result + v","  end","  return result","end"])}var i=t.getFieldValue("OP");switch(t=n.Lua.valueToCode(t,"LIST",n.Lua.ORDER_NONE)||"{}",i){case"SUM":i=e();break;case"MIN":i=n.Lua.provideFunction_("math_min",["function "+n.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t)","  if #t == 0 then","    return 0","  end","  local result = math.huge","  for _, v in ipairs(t) do","    if v < result then","      result = v","    end","  end","  return result","end"]);break;case"AVERAGE":i=n.Lua.provideFunction_("math_average",["function "+n.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t)","  if #t == 0 then","    return 0","  end","  return "+e()+"(t) / #t","end"]);break;case"MAX":i=n.Lua.provideFunction_("math_max",["function "+n.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t)","  if #t == 0 then","    return 0","  end","  local result = -math.huge","  for _, v in ipairs(t) do","    if v > result then","      result = v","    end","  end","  return result","end"]);break;case"MEDIAN":i=n.Lua.provideFunction_("math_median",["function "+n.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t)","  -- Source: http://lua-users.org/wiki/SimpleStats","  if #t == 0 then","    return 0","  end","  local temp={}","  for _, v in ipairs(t) do",'    if type(v) == "number" then',"      table.insert(temp, v)","    end","  end","  table.sort(temp)","  if #temp % 2 == 0 then","    return (temp[#temp/2] + temp[(#temp/2)+1]) / 2","  else","    return temp[math.ceil(#temp/2)]","  end","end"]);break;case"MODE":i=n.Lua.provideFunction_("math_modes",["function "+n.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t)","  -- Source: http://lua-users.org/wiki/SimpleStats","  local counts={}","  for _, v in ipairs(t) do","    if counts[v] == nil then","      counts[v] = 1","    else","      counts[v] = counts[v] + 1","    end","  end","  local biggestCount = 0","  for _, v  in pairs(counts) do","    if v > biggestCount then","      biggestCount = v","    end","  end","  local temp={}","  for k, v in pairs(counts) do","    if v == biggestCount then","      table.insert(temp, k)","    end","  end","  return temp","end"]);break;case"STD_DEV":i=n.Lua.provideFunction_("math_standard_deviation",["function "+n.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t)","  local m","  local vm","  local total = 0","  local count = 0","  local result","  m = #t == 0 and 0 or "+e()+"(t) / #t","  for _, v in ipairs(t) do","    if type(v) == 'number' then","      vm = v - m","      total = total + (vm * vm)","      count = count + 1","    end","  end","  result = math.sqrt(total / (count-1))","  return result","end"]);break;case"RANDOM":i=n.Lua.provideFunction_("math_random_list",["function "+n.Lua.FUNCTION_NAME_PLACEHOLDER_+"(t)","  if #t == 0 then","    return nil","  end","  return t[math.random(#t)]","end"]);break;default:throw Error("Unknown operator: "+i)}return[i+"("+t+")",n.Lua.ORDER_HIGH]},n.Lua.math_modulo=function(t){return[(n.Lua.valueToCode(t,"DIVIDEND",n.Lua.ORDER_MULTIPLICATIVE)||"0")+" % "+(t=n.Lua.valueToCode(t,"DIVISOR",n.Lua.ORDER_MULTIPLICATIVE)||"0"),n.Lua.ORDER_MULTIPLICATIVE]},n.Lua.math_constrain=function(t){return["math.min(math.max("+(n.Lua.valueToCode(t,"VALUE",n.Lua.ORDER_NONE)||"0")+", "+(n.Lua.valueToCode(t,"LOW",n.Lua.ORDER_NONE)||"-math.huge")+"), "+(t=n.Lua.valueToCode(t,"HIGH",n.Lua.ORDER_NONE)||"math.huge")+")",n.Lua.ORDER_HIGH]},n.Lua.math_random_int=function(t){return["math.random("+(n.Lua.valueToCode(t,"FROM",n.Lua.ORDER_NONE)||"0")+", "+(t=n.Lua.valueToCode(t,"TO",n.Lua.ORDER_NONE)||"0")+")",n.Lua.ORDER_HIGH]},n.Lua.math_random_float=function(t){return["math.random()",n.Lua.ORDER_HIGH]},n.Lua.math_atan2=function(t){var e=n.Lua.valueToCode(t,"X",n.Lua.ORDER_NONE)||"0";return["math.deg(math.atan2("+(n.Lua.valueToCode(t,"Y",n.Lua.ORDER_NONE)||"0")+", "+e+"))",n.Lua.ORDER_HIGH]},n.Lua.procedures={},n.Lua.procedures_defreturn=function(t){var e=n.Lua.variableDB_.getName(t.getFieldValue("NAME"),n.PROCEDURE_CATEGORY_NAME),i="";n.Lua.STATEMENT_PREFIX&&(i+=n.Lua.injectId(n.Lua.STATEMENT_PREFIX,t)),n.Lua.STATEMENT_SUFFIX&&(i+=n.Lua.injectId(n.Lua.STATEMENT_SUFFIX,t)),i&&(i=n.Lua.prefixLines(i,n.Lua.INDENT));var o="";n.Lua.INFINITE_LOOP_TRAP&&(o=n.Lua.prefixLines(n.Lua.injectId(n.Lua.INFINITE_LOOP_TRAP,t),n.Lua.INDENT));var r=n.Lua.statementToCode(t,"STACK"),s=n.Lua.valueToCode(t,"RETURN",n.Lua.ORDER_NONE)||"",a="";r&&s&&(a=i),s?s=n.Lua.INDENT+"return "+s+"\n":r||(r="");for(var l=[],c=t.getVars(),d=0;d<c.length;d++)l[d]=n.Lua.variableDB_.getName(c[d],n.VARIABLE_CATEGORY_NAME);return i="function "+e+"("+l.join(", ")+")\n"+i+o+r+a+s+"end\n",i=n.Lua.scrub_(t,i),n.Lua.definitions_["%"+e]=i,null},n.Lua.procedures_defnoreturn=n.Lua.procedures_defreturn,n.Lua.procedures_callreturn=function(t){for(var e=n.Lua.variableDB_.getName(t.getFieldValue("NAME"),n.PROCEDURE_CATEGORY_NAME),i=[],o=t.getVars(),r=0;r<o.length;r++)i[r]=n.Lua.valueToCode(t,"ARG"+r,n.Lua.ORDER_NONE)||"nil";return[e+"("+i.join(", ")+")",n.Lua.ORDER_HIGH]},n.Lua.procedures_callnoreturn=function(t){return n.Lua.procedures_callreturn(t)[0]+"\n"},n.Lua.procedures_ifreturn=function(t){var e="if "+(n.Lua.valueToCode(t,"CONDITION",n.Lua.ORDER_NONE)||"false")+" then\n";return n.Lua.STATEMENT_SUFFIX&&(e+=n.Lua.prefixLines(n.Lua.injectId(n.Lua.STATEMENT_SUFFIX,t),n.Lua.INDENT)),t.hasReturnValue_?(t=n.Lua.valueToCode(t,"VALUE",n.Lua.ORDER_NONE)||"nil",e+=n.Lua.INDENT+"return "+t+"\n"):e+=n.Lua.INDENT+"return\n",e+"end\n"},n.Lua.texts={},n.Lua.text=function(t){return[n.Lua.quote_(t.getFieldValue("TEXT")),n.Lua.ORDER_ATOMIC]},n.Lua.text_multiline=function(t){var e=-1!=(t=n.Lua.multiline_quote_(t.getFieldValue("TEXT"))).indexOf("..")?n.Lua.ORDER_CONCATENATION:n.Lua.ORDER_ATOMIC;return[t,e]},n.Lua.text_join=function(t){if(0==t.itemCount_)return["''",n.Lua.ORDER_ATOMIC];if(1==t.itemCount_)return["tostring("+(n.Lua.valueToCode(t,"ADD0",n.Lua.ORDER_NONE)||"''")+")",n.Lua.ORDER_HIGH];if(2==t.itemCount_){var e=n.Lua.valueToCode(t,"ADD0",n.Lua.ORDER_CONCATENATION)||"''";return[e+" .. "+(t=n.Lua.valueToCode(t,"ADD1",n.Lua.ORDER_CONCATENATION)||"''"),n.Lua.ORDER_CONCATENATION]}e=[];for(var i=0;i<t.itemCount_;i++)e[i]=n.Lua.valueToCode(t,"ADD"+i,n.Lua.ORDER_NONE)||"''";return[t="table.concat({"+e.join(", ")+"})",n.Lua.ORDER_HIGH]},n.Lua.text_append=function(t){var e=n.Lua.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME);return e+" = "+e+" .. "+(t=n.Lua.valueToCode(t,"TEXT",n.Lua.ORDER_CONCATENATION)||"''")+"\n"},n.Lua.text_length=function(t){return["#"+(n.Lua.valueToCode(t,"VALUE",n.Lua.ORDER_UNARY)||"''"),n.Lua.ORDER_UNARY]},n.Lua.text_isEmpty=function(t){return["#"+(n.Lua.valueToCode(t,"VALUE",n.Lua.ORDER_UNARY)||"''")+" == 0",n.Lua.ORDER_RELATIONAL]},n.Lua.text_indexOf=function(t){var e=n.Lua.valueToCode(t,"FIND",n.Lua.ORDER_NONE)||"''",i=n.Lua.valueToCode(t,"VALUE",n.Lua.ORDER_NONE)||"''";return[("FIRST"==t.getFieldValue("END")?n.Lua.provideFunction_("firstIndexOf",["function "+n.Lua.FUNCTION_NAME_PLACEHOLDER_+"(str, substr) ","  local i = string.find(str, substr, 1, true)","  if i == nil then","    return 0","  else","    return i","  end","end"]):n.Lua.provideFunction_("lastIndexOf",["function "+n.Lua.FUNCTION_NAME_PLACEHOLDER_+"(str, substr)","  local i = string.find(string.reverse(str), string.reverse(substr), 1, true)","  if i then","    return #str + 2 - i - #substr","  end","  return 0","end"]))+"("+i+", "+e+")",n.Lua.ORDER_HIGH]},n.Lua.text_charAt=function(t){var e=t.getFieldValue("WHERE")||"FROM_START",i=n.Lua.valueToCode(t,"AT","FROM_END"==e?n.Lua.ORDER_UNARY:n.Lua.ORDER_NONE)||"1";if(t=n.Lua.valueToCode(t,"VALUE",n.Lua.ORDER_NONE)||"''","RANDOM"==e)t=(e=n.Lua.provideFunction_("text_random_letter",["function "+n.Lua.FUNCTION_NAME_PLACEHOLDER_+"(str)","  local index = math.random(string.len(str))","  return string.sub(str, index, index)","end"]))+"("+t+")";else{if("FIRST"==e)i="1";else if("LAST"==e)i="-1";else if("FROM_START"!=e){if("FROM_END"!=e)throw Error("Unhandled option (text_charAt).");i="-"+i}t=i.match(/^-?\w*$/)?"string.sub("+t+", "+i+", "+i+")":(e=n.Lua.provideFunction_("text_char_at",["function "+n.Lua.FUNCTION_NAME_PLACEHOLDER_+"(str, index)","  return string.sub(str, index, index)","end"]))+"("+t+", "+i+")"}return[t,n.Lua.ORDER_HIGH]},n.Lua.text_getSubstring=function(t){var e=n.Lua.valueToCode(t,"STRING",n.Lua.ORDER_NONE)||"''",i=t.getFieldValue("WHERE1"),o=n.Lua.valueToCode(t,"AT1","FROM_END"==i?n.Lua.ORDER_UNARY:n.Lua.ORDER_NONE)||"1";if("FIRST"==i)i=1;else if("FROM_START"==i)i=o;else{if("FROM_END"!=i)throw Error("Unhandled option (text_getSubstring)");i="-"+o}if(o=t.getFieldValue("WHERE2"),t=n.Lua.valueToCode(t,"AT2","FROM_END"==o?n.Lua.ORDER_UNARY:n.Lua.ORDER_NONE)||"1","LAST"==o)t=-1;else if("FROM_START"!=o){if("FROM_END"!=o)throw Error("Unhandled option (text_getSubstring)");t="-"+t}return["string.sub("+e+", "+i+", "+t+")",n.Lua.ORDER_HIGH]},n.Lua.text_changeCase=function(t){var e=t.getFieldValue("CASE");if(t=n.Lua.valueToCode(t,"TEXT",n.Lua.ORDER_NONE)||"''","UPPERCASE"==e)var i="string.upper";else"LOWERCASE"==e?i="string.lower":"TITLECASE"==e&&(i=n.Lua.provideFunction_("text_titlecase",["function "+n.Lua.FUNCTION_NAME_PLACEHOLDER_+"(str)","  local buf = {}","  local inWord = false","  for i = 1, #str do","    local c = string.sub(str, i, i)","    if inWord then","      table.insert(buf, string.lower(c))",'      if string.find(c, "%s") then',"        inWord = false","      end","    else","      table.insert(buf, string.upper(c))","      inWord = true","    end","  end","  return table.concat(buf)","end"]));return[i+"("+t+")",n.Lua.ORDER_HIGH]},n.Lua.text_trim=function(t){var e={LEFT:"^%s*(,-)",RIGHT:"(.-)%s*$",BOTH:"^%s*(.-)%s*$"}[t.getFieldValue("MODE")];return["string.gsub("+(n.Lua.valueToCode(t,"TEXT",n.Lua.ORDER_NONE)||"''")+', "'+e+'", "%1")',n.Lua.ORDER_HIGH]},n.Lua.text_print=function(t){return"print("+(n.Lua.valueToCode(t,"TEXT",n.Lua.ORDER_NONE)||"''")+")\n"},n.Lua.text_prompt_ext=function(t){var e=t.getField("TEXT")?n.Lua.quote_(t.getFieldValue("TEXT")):n.Lua.valueToCode(t,"TEXT",n.Lua.ORDER_NONE)||"''";return e=n.Lua.provideFunction_("text_prompt",["function "+n.Lua.FUNCTION_NAME_PLACEHOLDER_+"(msg)","  io.write(msg)","  io.flush()","  return io.read()","end"])+"("+e+")","NUMBER"==t.getFieldValue("TYPE")&&(e="tonumber("+e+", 10)"),[e,n.Lua.ORDER_HIGH]},n.Lua.text_prompt=n.Lua.text_prompt_ext,n.Lua.text_count=function(t){var e=n.Lua.valueToCode(t,"TEXT",n.Lua.ORDER_NONE)||"''";return t=n.Lua.valueToCode(t,"SUB",n.Lua.ORDER_NONE)||"''",[n.Lua.provideFunction_("text_count",["function "+n.Lua.FUNCTION_NAME_PLACEHOLDER_+"(haystack, needle)","  if #needle == 0 then","    return #haystack + 1","  end","  local i = 1","  local count = 0","  while true do","    i = string.find(haystack, needle, i, true)","    if i == nil then","      break","    end","    count = count + 1","    i = i + #needle","  end","  return count","end"])+"("+e+", "+t+")",n.Lua.ORDER_HIGH]},n.Lua.text_replace=function(t){var e=n.Lua.valueToCode(t,"TEXT",n.Lua.ORDER_NONE)||"''",i=n.Lua.valueToCode(t,"FROM",n.Lua.ORDER_NONE)||"''";return t=n.Lua.valueToCode(t,"TO",n.Lua.ORDER_NONE)||"''",[n.Lua.provideFunction_("text_replace",["function "+n.Lua.FUNCTION_NAME_PLACEHOLDER_+"(haystack, needle, replacement)","  local buf = {}","  local i = 1","  while i <= #haystack do","    if string.sub(haystack, i, i + #needle - 1) == needle then","      for j = 1, #replacement do","        table.insert(buf, string.sub(replacement, j, j))","      end","      i = i + #needle","    else","      table.insert(buf, string.sub(haystack, i, i))","      i = i + 1","    end","  end","  return table.concat(buf)","end"])+"("+e+", "+i+", "+t+")",n.Lua.ORDER_HIGH]},n.Lua.text_reverse=function(t){return["string.reverse("+(n.Lua.valueToCode(t,"TEXT",n.Lua.ORDER_NONE)||"''")+")",n.Lua.ORDER_HIGH]},n.Lua.variables={},n.Lua.variables_get=function(t){return[n.Lua.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME),n.Lua.ORDER_ATOMIC]},n.Lua.variables_set=function(t){var e=n.Lua.valueToCode(t,"VALUE",n.Lua.ORDER_NONE)||"0";return n.Lua.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME)+" = "+e+"\n"},n.Lua.variablesDynamic={},n.Lua.variables_get_dynamic=n.Lua.variables_get,n.Lua.variables_set_dynamic=n.Lua.variables_set,n.Lua)})),WP=IP((function(t,e){var n;t.exports=(n=GP,DP.Lua=n,n)})),zP=IP((function(t,e){var n;t.exports=((n=kP).Dart=new n.Generator("Dart"),n.Dart.addReservedWords("assert,break,case,catch,class,const,continue,default,do,else,enum,extends,false,final,finally,for,if,in,is,new,null,rethrow,return,super,switch,this,throw,true,try,var,void,while,with,print,identityHashCode,identical,BidirectionalIterator,Comparable,double,Function,int,Invocation,Iterable,Iterator,List,Map,Match,num,Pattern,RegExp,Set,StackTrace,String,StringSink,Type,bool,DateTime,Deprecated,Duration,Expando,Null,Object,RuneIterator,Runes,Stopwatch,StringBuffer,Symbol,Uri,Comparator,AbstractClassInstantiationError,ArgumentError,AssertionError,CastError,ConcurrentModificationError,CyclicInitializationError,Error,Exception,FallThroughError,FormatException,IntegerDivisionByZeroException,NoSuchMethodError,NullThrownError,OutOfMemoryError,RangeError,StackOverflowError,StateError,TypeError,UnimplementedError,UnsupportedError"),n.Dart.ORDER_ATOMIC=0,n.Dart.ORDER_UNARY_POSTFIX=1,n.Dart.ORDER_UNARY_PREFIX=2,n.Dart.ORDER_MULTIPLICATIVE=3,n.Dart.ORDER_ADDITIVE=4,n.Dart.ORDER_SHIFT=5,n.Dart.ORDER_BITWISE_AND=6,n.Dart.ORDER_BITWISE_XOR=7,n.Dart.ORDER_BITWISE_OR=8,n.Dart.ORDER_RELATIONAL=9,n.Dart.ORDER_EQUALITY=10,n.Dart.ORDER_LOGICAL_AND=11,n.Dart.ORDER_LOGICAL_OR=12,n.Dart.ORDER_IF_NULL=13,n.Dart.ORDER_CONDITIONAL=14,n.Dart.ORDER_CASCADE=15,n.Dart.ORDER_ASSIGNMENT=16,n.Dart.ORDER_NONE=99,n.Dart.isInitialized=!1,n.Dart.init=function(t){n.Dart.definitions_=Object.create(null),n.Dart.functionNames_=Object.create(null),n.Dart.variableDB_?n.Dart.variableDB_.reset():n.Dart.variableDB_=new n.Names(n.Dart.RESERVED_WORDS_),n.Dart.variableDB_.setVariableMap(t.getVariableMap());for(var e=[],i=n.Variables.allDeveloperVariables(t),o=0;o<i.length;o++)e.push(n.Dart.variableDB_.getName(i[o],n.Names.DEVELOPER_VARIABLE_TYPE));for(t=n.Variables.allUsedVarModels(t),o=0;o<t.length;o++)e.push(n.Dart.variableDB_.getName(t[o].getId(),n.VARIABLE_CATEGORY_NAME));e.length&&(n.Dart.definitions_.variables="var "+e.join(", ")+";"),this.isInitialized=!0},n.Dart.finish=function(t){t&&(t=n.Dart.prefixLines(t,n.Dart.INDENT)),t="main() {\n"+t+"}";var e,i=[],o=[];for(e in n.Dart.definitions_){var r=n.Dart.definitions_[e];r.match(/^import\s/)?i.push(r):o.push(r)}return delete n.Dart.definitions_,delete n.Dart.functionNames_,n.Dart.variableDB_.reset(),(i.join("\n")+"\n\n"+o.join("\n\n")).replace(/\n\n+/g,"\n\n").replace(/\n*$/,"\n\n\n")+t},n.Dart.scrubNakedValue=function(t){return t+";\n"},n.Dart.quote_=function(t){return"'"+(t=t.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/\$/g,"\\$").replace(/'/g,"\\'"))+"'"},n.Dart.multiline_quote_=function(t){return t.split(/\n/g).map(n.Dart.quote_).join(" + '\\n' + \n")},n.Dart.scrub_=function(t,e,i){var o="";if(!t.outputConnection||!t.outputConnection.targetConnection){var r=t.getCommentText();r&&(r=n.utils.string.wrap(r,n.Dart.COMMENT_WRAP-3),o=t.getProcedureDef?o+n.Dart.prefixLines(r+"\n","/// "):o+n.Dart.prefixLines(r+"\n","// "));for(var s=0;s<t.inputList.length;s++)t.inputList[s].type==n.INPUT_VALUE&&(r=t.inputList[s].connection.targetBlock())&&(r=n.Dart.allNestedComments(r))&&(o+=n.Dart.prefixLines(r,"// "))}return t=t.nextConnection&&t.nextConnection.targetBlock(),o+e+(i=i?"":n.Dart.blockToCode(t))},n.Dart.getAdjusted=function(t,e,i,o,r){i=i||0,r=r||n.Dart.ORDER_NONE,t.workspace.options.oneBasedIndex&&i--;var s=t.workspace.options.oneBasedIndex?"1":"0";if(t=i?n.Dart.valueToCode(t,e,n.Dart.ORDER_ADDITIVE)||s:o?n.Dart.valueToCode(t,e,n.Dart.ORDER_UNARY_PREFIX)||s:n.Dart.valueToCode(t,e,r)||s,n.isNumber(t))t=parseInt(t,10)+i,o&&(t=-t);else{if(0<i){t=t+" + "+i;var a=n.Dart.ORDER_ADDITIVE}else 0>i&&(t=t+" - "+-i,a=n.Dart.ORDER_ADDITIVE);o&&(t=i?"-("+t+")":"-"+t,a=n.Dart.ORDER_UNARY_PREFIX),a=Math.floor(a),r=Math.floor(r),a&&r>=a&&(t="("+t+")")}return t},n.Dart.colour={},n.Dart.addReservedWords("Math"),n.Dart.colour_picker=function(t){return[n.Dart.quote_(t.getFieldValue("COLOUR")),n.Dart.ORDER_ATOMIC]},n.Dart.colour_random=function(t){return n.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",[n.Dart.provideFunction_("colour_random",["String "+n.Dart.FUNCTION_NAME_PLACEHOLDER_+"() {","  String hex = '0123456789abcdef';","  var rnd = new Math.Random();","  return '#${hex[rnd.nextInt(16)]}${hex[rnd.nextInt(16)]}'","      '${hex[rnd.nextInt(16)]}${hex[rnd.nextInt(16)]}'","      '${hex[rnd.nextInt(16)]}${hex[rnd.nextInt(16)]}';","}"])+"()",n.Dart.ORDER_UNARY_POSTFIX]},n.Dart.colour_rgb=function(t){var e=n.Dart.valueToCode(t,"RED",n.Dart.ORDER_NONE)||0,i=n.Dart.valueToCode(t,"GREEN",n.Dart.ORDER_NONE)||0;return t=n.Dart.valueToCode(t,"BLUE",n.Dart.ORDER_NONE)||0,n.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",[n.Dart.provideFunction_("colour_rgb",["String "+n.Dart.FUNCTION_NAME_PLACEHOLDER_+"(num r, num g, num b) {","  num rn = (Math.max(Math.min(r, 100), 0) * 2.55).round();","  String rs = rn.toInt().toRadixString(16);","  rs = '0$rs';","  rs = rs.substring(rs.length - 2);","  num gn = (Math.max(Math.min(g, 100), 0) * 2.55).round();","  String gs = gn.toInt().toRadixString(16);","  gs = '0$gs';","  gs = gs.substring(gs.length - 2);","  num bn = (Math.max(Math.min(b, 100), 0) * 2.55).round();","  String bs = bn.toInt().toRadixString(16);","  bs = '0$bs';","  bs = bs.substring(bs.length - 2);","  return '#$rs$gs$bs';","}"])+"("+e+", "+i+", "+t+")",n.Dart.ORDER_UNARY_POSTFIX]},n.Dart.colour_blend=function(t){var e=n.Dart.valueToCode(t,"COLOUR1",n.Dart.ORDER_NONE)||"'#000000'",i=n.Dart.valueToCode(t,"COLOUR2",n.Dart.ORDER_NONE)||"'#000000'";return t=n.Dart.valueToCode(t,"RATIO",n.Dart.ORDER_NONE)||.5,n.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",[n.Dart.provideFunction_("colour_blend",["String "+n.Dart.FUNCTION_NAME_PLACEHOLDER_+"(String c1, String c2, num ratio) {","  ratio = Math.max(Math.min(ratio, 1), 0);","  int r1 = int.parse('0x${c1.substring(1, 3)}');","  int g1 = int.parse('0x${c1.substring(3, 5)}');","  int b1 = int.parse('0x${c1.substring(5, 7)}');","  int r2 = int.parse('0x${c2.substring(1, 3)}');","  int g2 = int.parse('0x${c2.substring(3, 5)}');","  int b2 = int.parse('0x${c2.substring(5, 7)}');","  num rn = (r1 * (1 - ratio) + r2 * ratio).round();","  String rs = rn.toInt().toRadixString(16);","  num gn = (g1 * (1 - ratio) + g2 * ratio).round();","  String gs = gn.toInt().toRadixString(16);","  num bn = (b1 * (1 - ratio) + b2 * ratio).round();","  String bs = bn.toInt().toRadixString(16);","  rs = '0$rs';","  rs = rs.substring(rs.length - 2);","  gs = '0$gs';","  gs = gs.substring(gs.length - 2);","  bs = '0$bs';","  bs = bs.substring(bs.length - 2);","  return '#$rs$gs$bs';","}"])+"("+e+", "+i+", "+t+")",n.Dart.ORDER_UNARY_POSTFIX]},n.Dart.lists={},n.Dart.addReservedWords("Math"),n.Dart.lists_create_empty=function(t){return["[]",n.Dart.ORDER_ATOMIC]},n.Dart.lists_create_with=function(t){for(var e=Array(t.itemCount_),i=0;i<t.itemCount_;i++)e[i]=n.Dart.valueToCode(t,"ADD"+i,n.Dart.ORDER_NONE)||"null";return["["+e.join(", ")+"]",n.Dart.ORDER_ATOMIC]},n.Dart.lists_repeat=function(t){var e=n.Dart.valueToCode(t,"ITEM",n.Dart.ORDER_NONE)||"null";return["new List.filled("+(n.Dart.valueToCode(t,"NUM",n.Dart.ORDER_NONE)||"0")+", "+e+")",n.Dart.ORDER_UNARY_POSTFIX]},n.Dart.lists_length=function(t){return[(n.Dart.valueToCode(t,"VALUE",n.Dart.ORDER_UNARY_POSTFIX)||"[]")+".length",n.Dart.ORDER_UNARY_POSTFIX]},n.Dart.lists_isEmpty=function(t){return[(n.Dart.valueToCode(t,"VALUE",n.Dart.ORDER_UNARY_POSTFIX)||"[]")+".isEmpty",n.Dart.ORDER_UNARY_POSTFIX]},n.Dart.lists_indexOf=function(t){var e="FIRST"==t.getFieldValue("END")?"indexOf":"lastIndexOf",i=n.Dart.valueToCode(t,"FIND",n.Dart.ORDER_NONE)||"''";return e=(n.Dart.valueToCode(t,"VALUE",n.Dart.ORDER_UNARY_POSTFIX)||"[]")+"."+e+"("+i+")",t.workspace.options.oneBasedIndex?[e+" + 1",n.Dart.ORDER_ADDITIVE]:[e,n.Dart.ORDER_UNARY_POSTFIX]},n.Dart.lists_getIndex=function(t){function e(){var t=n.Dart.variableDB_.getDistinctName("tmp_list",n.VARIABLE_CATEGORY_NAME),e="List "+t+" = "+r+";\n";return r=t,e}var i=t.getFieldValue("MODE")||"GET",o=t.getFieldValue("WHERE")||"FROM_START",r=n.Dart.valueToCode(t,"VALUE","RANDOM"==o||"FROM_END"==o?n.Dart.ORDER_NONE:n.Dart.ORDER_UNARY_POSTFIX)||"[]";if(("RANDOM"!=o||"REMOVE"!=i)&&"FROM_END"!=o||r.match(/^\w+$/))switch(o){case"FIRST":if("GET"==i)return[r+".first",n.Dart.ORDER_UNARY_POSTFIX];if("GET_REMOVE"==i)return[r+".removeAt(0)",n.Dart.ORDER_UNARY_POSTFIX];if("REMOVE"==i)return r+".removeAt(0);\n";break;case"LAST":if("GET"==i)return[r+".last",n.Dart.ORDER_UNARY_POSTFIX];if("GET_REMOVE"==i)return[r+".removeLast()",n.Dart.ORDER_UNARY_POSTFIX];if("REMOVE"==i)return r+".removeLast();\n";break;case"FROM_START":if(o=n.Dart.getAdjusted(t,"AT"),"GET"==i)return[r+"["+o+"]",n.Dart.ORDER_UNARY_POSTFIX];if("GET_REMOVE"==i)return[r+".removeAt("+o+")",n.Dart.ORDER_UNARY_POSTFIX];if("REMOVE"==i)return r+".removeAt("+o+");\n";break;case"FROM_END":if(o=n.Dart.getAdjusted(t,"AT",1,!1,n.Dart.ORDER_ADDITIVE),"GET"==i)return[r+"["+r+".length - "+o+"]",n.Dart.ORDER_UNARY_POSTFIX];if("GET_REMOVE"==i||"REMOVE"==i){if(t=r+".removeAt("+r+".length - "+o+")","GET_REMOVE"==i)return[t,n.Dart.ORDER_UNARY_POSTFIX];if("REMOVE"==i)return t+";\n"}break;case"RANDOM":if(n.Dart.definitions_.import_dart_math="import 'dart:math' as Math;","REMOVE"==i)return"int "+(i=n.Dart.variableDB_.getDistinctName("tmp_x",n.VARIABLE_CATEGORY_NAME))+" = new Math.Random().nextInt("+r+".length);\n"+r+".removeAt("+i+");\n";if("GET"==i)return[(i=n.Dart.provideFunction_("lists_get_random_item",["dynamic "+n.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List my_list) {","  int x = new Math.Random().nextInt(my_list.length);","  return my_list[x];","}"]))+"("+r+")",n.Dart.ORDER_UNARY_POSTFIX];if("GET_REMOVE"==i)return[(i=n.Dart.provideFunction_("lists_remove_random_item",["dynamic "+n.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List my_list) {","  int x = new Math.Random().nextInt(my_list.length);","  return my_list.removeAt(x);","}"]))+"("+r+")",n.Dart.ORDER_UNARY_POSTFIX]}else{if("RANDOM"==o)return n.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",(t=e())+"int "+(i=n.Dart.variableDB_.getDistinctName("tmp_x",n.VARIABLE_CATEGORY_NAME))+" = new Math.Random().nextInt("+r+".length);\n"+r+".removeAt("+i+");\n";if("REMOVE"==i)return o=n.Dart.getAdjusted(t,"AT",1,!1,n.Dart.ORDER_ADDITIVE),(t=e())+(r+".removeAt(")+r+".length - "+o+");\n";if("GET"==i)return o=n.Dart.getAdjusted(t,"AT",1),[(i=n.Dart.provideFunction_("lists_get_from_end",["dynamic "+n.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List my_list, num x) {","  x = my_list.length - x;","  return my_list[x];","}"]))+"("+r+", "+o+")",n.Dart.ORDER_UNARY_POSTFIX];if("GET_REMOVE"==i)return o=n.Dart.getAdjusted(t,"AT",1),[(i=n.Dart.provideFunction_("lists_remove_from_end",["dynamic "+n.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List my_list, num x) {","  x = my_list.length - x;","  return my_list.removeAt(x);","}"]))+"("+r+", "+o+")",n.Dart.ORDER_UNARY_POSTFIX]}throw Error("Unhandled combination (lists_getIndex).")},n.Dart.lists_setIndex=function(t){function e(){if(r.match(/^\w+$/))return"";var t=n.Dart.variableDB_.getDistinctName("tmp_list",n.VARIABLE_CATEGORY_NAME),e="List "+t+" = "+r+";\n";return r=t,e}var i=t.getFieldValue("MODE")||"GET",o=t.getFieldValue("WHERE")||"FROM_START",r=n.Dart.valueToCode(t,"LIST",n.Dart.ORDER_UNARY_POSTFIX)||"[]",s=n.Dart.valueToCode(t,"TO",n.Dart.ORDER_ASSIGNMENT)||"null";switch(o){case"FIRST":if("SET"==i)return r+"[0] = "+s+";\n";if("INSERT"==i)return r+".insert(0, "+s+");\n";break;case"LAST":if("SET"==i)return(t=e())+(r+"[")+r+".length - 1] = "+s+";\n";if("INSERT"==i)return r+".add("+s+");\n";break;case"FROM_START":if(o=n.Dart.getAdjusted(t,"AT"),"SET"==i)return r+"["+o+"] = "+s+";\n";if("INSERT"==i)return r+".insert("+o+", "+s+");\n";break;case"FROM_END":if(o=n.Dart.getAdjusted(t,"AT",1,!1,n.Dart.ORDER_ADDITIVE),t=e(),"SET"==i)return t+(r+"[")+r+".length - "+o+"] = "+s+";\n";if("INSERT"==i)return t+(r+".insert(")+r+".length - "+o+", "+s+");\n";break;case"RANDOM":if(n.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",t=e(),t+="int "+(o=n.Dart.variableDB_.getDistinctName("tmp_x",n.VARIABLE_CATEGORY_NAME))+" = new Math.Random().nextInt("+r+".length);\n","SET"==i)return t+(r+"[")+o+"] = "+s+";\n";if("INSERT"==i)return t+(r+".insert(")+o+", "+s+");\n"}throw Error("Unhandled combination (lists_setIndex).")},n.Dart.lists_getSublist=function(t){var e=n.Dart.valueToCode(t,"LIST",n.Dart.ORDER_UNARY_POSTFIX)||"[]",i=t.getFieldValue("WHERE1"),o=t.getFieldValue("WHERE2");if(e.match(/^\w+$/)||"FROM_END"!=i&&"FROM_START"==o){switch(i){case"FROM_START":var r=n.Dart.getAdjusted(t,"AT1");break;case"FROM_END":r=e+".length - "+(r=n.Dart.getAdjusted(t,"AT1",1,!1,n.Dart.ORDER_ADDITIVE));break;case"FIRST":r="0";break;default:throw Error("Unhandled option (lists_getSublist).")}switch(o){case"FROM_START":var s=n.Dart.getAdjusted(t,"AT2",1);break;case"FROM_END":s=e+".length - "+(s=n.Dart.getAdjusted(t,"AT2",0,!1,n.Dart.ORDER_ADDITIVE));break;case"LAST":break;default:throw Error("Unhandled option (lists_getSublist).")}t="LAST"==o?e+".sublist("+r+")":e+".sublist("+r+", "+s+")"}else r=n.Dart.getAdjusted(t,"AT1"),s=n.Dart.getAdjusted(t,"AT2"),t=n.Dart.provideFunction_("lists_get_sublist",["List "+n.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List list, String where1, num at1, String where2, num at2) {","  int getAt(String where, num at) {","    if (where == 'FROM_END') {","      at = list.length - 1 - at;","    } else if (where == 'FIRST') {","      at = 0;","    } else if (where == 'LAST') {","      at = list.length - 1;","    } else if (where != 'FROM_START') {","      throw 'Unhandled option (lists_getSublist).';","    }","    return at;","  }","  at1 = getAt(where1, at1);","  at2 = getAt(where2, at2) + 1;","  return list.sublist(at1, at2);","}"])+"("+e+", '"+i+"', "+r+", '"+o+"', "+s+")";return[t,n.Dart.ORDER_UNARY_POSTFIX]},n.Dart.lists_sort=function(t){var e=n.Dart.valueToCode(t,"LIST",n.Dart.ORDER_NONE)||"[]",i="1"===t.getFieldValue("DIRECTION")?1:-1;return t=t.getFieldValue("TYPE"),[n.Dart.provideFunction_("lists_sort",["List "+n.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List list, String type, int direction) {","  var compareFuncs = {",'    "NUMERIC": (a, b) => (direction * a.compareTo(b)).toInt(),','    "TEXT": (a, b) => direction * a.toString().compareTo(b.toString()),','    "IGNORE_CASE": ',"       (a, b) => direction * ","      a.toString().toLowerCase().compareTo(b.toString().toLowerCase())","  };","  list = new List.from(list);","  var compare = compareFuncs[type];","  list.sort(compare);","  return list;","}"])+"("+e+', "'+t+'", '+i+")",n.Dart.ORDER_UNARY_POSTFIX]},n.Dart.lists_split=function(t){var e=n.Dart.valueToCode(t,"INPUT",n.Dart.ORDER_UNARY_POSTFIX),i=n.Dart.valueToCode(t,"DELIM",n.Dart.ORDER_NONE)||"''";if("SPLIT"==(t=t.getFieldValue("MODE")))e||(e="''"),t="split";else{if("JOIN"!=t)throw Error("Unknown mode: "+t);e||(e="[]"),t="join"}return[e+"."+t+"("+i+")",n.Dart.ORDER_UNARY_POSTFIX]},n.Dart.lists_reverse=function(t){return["new List.from("+(n.Dart.valueToCode(t,"LIST",n.Dart.ORDER_NONE)||"[]")+".reversed)",n.Dart.ORDER_UNARY_POSTFIX]},n.Dart.logic={},n.Dart.controls_if=function(t){var e=0,i="";n.Dart.STATEMENT_PREFIX&&(i+=n.Dart.injectId(n.Dart.STATEMENT_PREFIX,t));do{var o=n.Dart.valueToCode(t,"IF"+e,n.Dart.ORDER_NONE)||"false",r=n.Dart.statementToCode(t,"DO"+e);n.Dart.STATEMENT_SUFFIX&&(r=n.Dart.prefixLines(n.Dart.injectId(n.Dart.STATEMENT_SUFFIX,t),n.Dart.INDENT)+r),i+=(0<e?"else ":"")+"if ("+o+") {\n"+r+"}",++e}while(t.getInput("IF"+e));return(t.getInput("ELSE")||n.Dart.STATEMENT_SUFFIX)&&(r=n.Dart.statementToCode(t,"ELSE"),n.Dart.STATEMENT_SUFFIX&&(r=n.Dart.prefixLines(n.Dart.injectId(n.Dart.STATEMENT_SUFFIX,t),n.Dart.INDENT)+r),i+=" else {\n"+r+"}"),i+"\n"},n.Dart.controls_ifelse=n.Dart.controls_if,n.Dart.logic_compare=function(t){var e={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[t.getFieldValue("OP")],i="=="==e||"!="==e?n.Dart.ORDER_EQUALITY:n.Dart.ORDER_RELATIONAL;return[(n.Dart.valueToCode(t,"A",i)||"0")+" "+e+" "+(t=n.Dart.valueToCode(t,"B",i)||"0"),i]},n.Dart.logic_operation=function(t){var e="AND"==t.getFieldValue("OP")?"&&":"||",i="&&"==e?n.Dart.ORDER_LOGICAL_AND:n.Dart.ORDER_LOGICAL_OR,o=n.Dart.valueToCode(t,"A",i);if(t=n.Dart.valueToCode(t,"B",i),o||t){var r="&&"==e?"true":"false";o||(o=r),t||(t=r)}else t=o="false";return[o+" "+e+" "+t,i]},n.Dart.logic_negate=function(t){var e=n.Dart.ORDER_UNARY_PREFIX;return["!"+(n.Dart.valueToCode(t,"BOOL",e)||"true"),e]},n.Dart.logic_boolean=function(t){return["TRUE"==t.getFieldValue("BOOL")?"true":"false",n.Dart.ORDER_ATOMIC]},n.Dart.logic_null=function(t){return["null",n.Dart.ORDER_ATOMIC]},n.Dart.logic_ternary=function(t){return[(n.Dart.valueToCode(t,"IF",n.Dart.ORDER_CONDITIONAL)||"false")+" ? "+(n.Dart.valueToCode(t,"THEN",n.Dart.ORDER_CONDITIONAL)||"null")+" : "+(t=n.Dart.valueToCode(t,"ELSE",n.Dart.ORDER_CONDITIONAL)||"null"),n.Dart.ORDER_CONDITIONAL]},n.Dart.loops={},n.Dart.controls_repeat_ext=function(t){var e=t.getField("TIMES")?String(Number(t.getFieldValue("TIMES"))):n.Dart.valueToCode(t,"TIMES",n.Dart.ORDER_ASSIGNMENT)||"0",i=n.Dart.statementToCode(t,"DO");i=n.Dart.addLoopTrap(i,t),t="";var o=n.Dart.variableDB_.getDistinctName("count",n.VARIABLE_CATEGORY_NAME),r=e;return e.match(/^\w+$/)||n.isNumber(e)||(t+="var "+(r=n.Dart.variableDB_.getDistinctName("repeat_end",n.VARIABLE_CATEGORY_NAME))+" = "+e+";\n"),t+"for (int "+o+" = 0; "+o+" < "+r+"; "+o+"++) {\n"+i+"}\n"},n.Dart.controls_repeat=n.Dart.controls_repeat_ext,n.Dart.controls_whileUntil=function(t){var e="UNTIL"==t.getFieldValue("MODE"),i=n.Dart.valueToCode(t,"BOOL",e?n.Dart.ORDER_UNARY_PREFIX:n.Dart.ORDER_NONE)||"false",o=n.Dart.statementToCode(t,"DO");return e&&(i="!"+i),"while ("+i+") {\n"+(o=n.Dart.addLoopTrap(o,t))+"}\n"},n.Dart.controls_for=function(t){var e=n.Dart.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME),i=n.Dart.valueToCode(t,"FROM",n.Dart.ORDER_ASSIGNMENT)||"0",o=n.Dart.valueToCode(t,"TO",n.Dart.ORDER_ASSIGNMENT)||"0",r=n.Dart.valueToCode(t,"BY",n.Dart.ORDER_ASSIGNMENT)||"1",s=n.Dart.statementToCode(t,"DO");if(s=n.Dart.addLoopTrap(s,t),n.isNumber(i)&&n.isNumber(o)&&n.isNumber(r)){var a=Number(i)<=Number(o);t="for ("+e+" = "+i+"; "+e+(a?" <= ":" >= ")+o+"; "+e,t=(1==(e=Math.abs(Number(r)))?t+(a?"++":"--"):t+(a?" += ":" -= ")+e)+") {\n"+s+"}\n"}else t="",a=i,i.match(/^\w+$/)||n.isNumber(i)||(t+="var "+(a=n.Dart.variableDB_.getDistinctName(e+"_start",n.VARIABLE_CATEGORY_NAME))+" = "+i+";\n"),i=o,o.match(/^\w+$/)||n.isNumber(o)||(t+="var "+(i=n.Dart.variableDB_.getDistinctName(e+"_end",n.VARIABLE_CATEGORY_NAME))+" = "+o+";\n"),t+="num "+(o=n.Dart.variableDB_.getDistinctName(e+"_inc",n.VARIABLE_CATEGORY_NAME))+" = ",t=(t=n.isNumber(r)?t+(Math.abs(r)+";\n"):t+"("+r+").abs();\n")+"if ("+a+" > "+i+") {\n"+(n.Dart.INDENT+o)+" = -"+o+";\n",t+="}\n",t+="for ("+e+" = "+a+"; "+o+" >= 0 ? "+e+" <= "+i+" : "+e+" >= "+i+"; "+e+" += "+o+") {\n"+s+"}\n";return t},n.Dart.controls_forEach=function(t){var e=n.Dart.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME),i=n.Dart.valueToCode(t,"LIST",n.Dart.ORDER_ASSIGNMENT)||"[]",o=n.Dart.statementToCode(t,"DO");return"for (var "+e+" in "+i+") {\n"+(o=n.Dart.addLoopTrap(o,t))+"}\n"},n.Dart.controls_flow_statements=function(t){var e="";if(n.Dart.STATEMENT_PREFIX&&(e+=n.Dart.injectId(n.Dart.STATEMENT_PREFIX,t)),n.Dart.STATEMENT_SUFFIX&&(e+=n.Dart.injectId(n.Dart.STATEMENT_SUFFIX,t)),n.Dart.STATEMENT_PREFIX){var i=n.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.getSurroundLoop(t);i&&!i.suppressPrefixSuffix&&(e+=n.Dart.injectId(n.Dart.STATEMENT_PREFIX,i))}switch(t.getFieldValue("FLOW")){case"BREAK":return e+"break;\n";case"CONTINUE":return e+"continue;\n"}throw Error("Unknown flow statement.")},n.Dart.math={},n.Dart.addReservedWords("Math"),n.Dart.math_number=function(t){if(1/0==(t=Number(t.getFieldValue("NUM")))){t="double.infinity";var e=n.Dart.ORDER_UNARY_POSTFIX}else-1/0==t?(t="-double.infinity",e=n.Dart.ORDER_UNARY_PREFIX):e=0>t?n.Dart.ORDER_UNARY_PREFIX:n.Dart.ORDER_ATOMIC;return[t,e]},n.Dart.math_arithmetic=function(t){var e={ADD:[" + ",n.Dart.ORDER_ADDITIVE],MINUS:[" - ",n.Dart.ORDER_ADDITIVE],MULTIPLY:[" * ",n.Dart.ORDER_MULTIPLICATIVE],DIVIDE:[" / ",n.Dart.ORDER_MULTIPLICATIVE],POWER:[null,n.Dart.ORDER_NONE]}[t.getFieldValue("OP")],i=e[0];e=e[1];var o=n.Dart.valueToCode(t,"A",e)||"0";return t=n.Dart.valueToCode(t,"B",e)||"0",i?[o+i+t,e]:(n.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",["Math.pow("+o+", "+t+")",n.Dart.ORDER_UNARY_POSTFIX])},n.Dart.math_single=function(t){var e=t.getFieldValue("OP");if("NEG"==e)return"-"==(t=n.Dart.valueToCode(t,"NUM",n.Dart.ORDER_UNARY_PREFIX)||"0")[0]&&(t=" "+t),["-"+t,n.Dart.ORDER_UNARY_PREFIX];switch(n.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",t="ABS"==e||"ROUND"==e.substring(0,5)?n.Dart.valueToCode(t,"NUM",n.Dart.ORDER_UNARY_POSTFIX)||"0":"SIN"==e||"COS"==e||"TAN"==e?n.Dart.valueToCode(t,"NUM",n.Dart.ORDER_MULTIPLICATIVE)||"0":n.Dart.valueToCode(t,"NUM",n.Dart.ORDER_NONE)||"0",e){case"ABS":var i=t+".abs()";break;case"ROOT":i="Math.sqrt("+t+")";break;case"LN":i="Math.log("+t+")";break;case"EXP":i="Math.exp("+t+")";break;case"POW10":i="Math.pow(10,"+t+")";break;case"ROUND":i=t+".round()";break;case"ROUNDUP":i=t+".ceil()";break;case"ROUNDDOWN":i=t+".floor()";break;case"SIN":i="Math.sin("+t+" / 180 * Math.pi)";break;case"COS":i="Math.cos("+t+" / 180 * Math.pi)";break;case"TAN":i="Math.tan("+t+" / 180 * Math.pi)"}if(i)return[i,n.Dart.ORDER_UNARY_POSTFIX];switch(e){case"LOG10":i="Math.log("+t+") / Math.log(10)";break;case"ASIN":i="Math.asin("+t+") / Math.pi * 180";break;case"ACOS":i="Math.acos("+t+") / Math.pi * 180";break;case"ATAN":i="Math.atan("+t+") / Math.pi * 180";break;default:throw Error("Unknown math operator: "+e)}return[i,n.Dart.ORDER_MULTIPLICATIVE]},n.Dart.math_constant=function(t){var e={PI:["Math.pi",n.Dart.ORDER_UNARY_POSTFIX],E:["Math.e",n.Dart.ORDER_UNARY_POSTFIX],GOLDEN_RATIO:["(1 + Math.sqrt(5)) / 2",n.Dart.ORDER_MULTIPLICATIVE],SQRT2:["Math.sqrt2",n.Dart.ORDER_UNARY_POSTFIX],SQRT1_2:["Math.sqrt1_2",n.Dart.ORDER_UNARY_POSTFIX],INFINITY:["double.infinity",n.Dart.ORDER_ATOMIC]};return"INFINITY"!=(t=t.getFieldValue("CONSTANT"))&&(n.Dart.definitions_.import_dart_math="import 'dart:math' as Math;"),e[t]},n.Dart.math_number_property=function(t){var e=n.Dart.valueToCode(t,"NUMBER_TO_CHECK",n.Dart.ORDER_MULTIPLICATIVE);if(!e)return["false",n.Dart.ORDER_ATOMIC];var i=t.getFieldValue("PROPERTY");if("PRIME"==i)return n.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",[n.Dart.provideFunction_("math_isPrime",["bool "+n.Dart.FUNCTION_NAME_PLACEHOLDER_+"(n) {","  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods","  if (n == 2 || n == 3) {","    return true;","  }","  // False if n is null, negative, is 1, or not whole.","  // And false if n is divisible by 2 or 3.","  if (n == null || n <= 1 || n % 1 != 0 || n % 2 == 0 || n % 3 == 0) {","    return false;","  }","  // Check all the numbers of form 6k +/- 1, up to sqrt(n).","  for (var x = 6; x <= Math.sqrt(n) + 1; x += 6) {","    if (n % (x - 1) == 0 || n % (x + 1) == 0) {","      return false;","    }","  }","  return true;","}"])+"("+e+")",n.Dart.ORDER_UNARY_POSTFIX];switch(i){case"EVEN":var o=e+" % 2 == 0";break;case"ODD":o=e+" % 2 == 1";break;case"WHOLE":o=e+" % 1 == 0";break;case"POSITIVE":o=e+" > 0";break;case"NEGATIVE":o=e+" < 0";break;case"DIVISIBLE_BY":if(!(t=n.Dart.valueToCode(t,"DIVISOR",n.Dart.ORDER_MULTIPLICATIVE)))return["false",n.Dart.ORDER_ATOMIC];o=e+" % "+t+" == 0"}return[o,n.Dart.ORDER_EQUALITY]},n.Dart.math_change=function(t){var e=n.Dart.valueToCode(t,"DELTA",n.Dart.ORDER_ADDITIVE)||"0";return(t=n.Dart.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME))+" = ("+t+" is num ? "+t+" : 0) + "+e+";\n"},n.Dart.math_round=n.Dart.math_single,n.Dart.math_trig=n.Dart.math_single,n.Dart.math_on_list=function(t){var e=t.getFieldValue("OP");switch(t=n.Dart.valueToCode(t,"LIST",n.Dart.ORDER_NONE)||"[]",e){case"SUM":e=(e=n.Dart.provideFunction_("math_sum",["num "+n.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List<num> myList) {","  num sumVal = 0;","  myList.forEach((num entry) {sumVal += entry;});","  return sumVal;","}"]))+"("+t+")";break;case"MIN":n.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",e=(e=n.Dart.provideFunction_("math_min",["num "+n.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List<num> myList) {","  if (myList.isEmpty) return null;","  num minVal = myList[0];","  myList.forEach((num entry) {minVal = Math.min(minVal, entry);});","  return minVal;","}"]))+"("+t+")";break;case"MAX":n.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",e=(e=n.Dart.provideFunction_("math_max",["num "+n.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List<num> myList) {","  if (myList.isEmpty) return null;","  num maxVal = myList[0];","  myList.forEach((num entry) {maxVal = Math.max(maxVal, entry);});","  return maxVal;","}"]))+"("+t+")";break;case"AVERAGE":e=(e=n.Dart.provideFunction_("math_mean",["num "+n.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List myList) {","  // First filter list for numbers only.","  List localList = new List.from(myList);","  localList.removeWhere((a) => a is! num);","  if (localList.isEmpty) return null;","  num sumVal = 0;","  localList.forEach((var entry) {sumVal += entry;});","  return sumVal / localList.length;","}"]))+"("+t+")";break;case"MEDIAN":e=(e=n.Dart.provideFunction_("math_median",["num "+n.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List myList) {","  // First filter list for numbers only, then sort, then return middle value","  // or the average of two middle values if list has an even number of elements.","  List localList = new List.from(myList);","  localList.removeWhere((a) => a is! num);","  if (localList.isEmpty) return null;","  localList.sort((a, b) => (a - b));","  int index = localList.length ~/ 2;","  if (localList.length % 2 == 1) {","    return localList[index];","  } else {","    return (localList[index - 1] + localList[index]) / 2;","  }","}"]))+"("+t+")";break;case"MODE":n.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",e=(e=n.Dart.provideFunction_("math_modes",["List "+n.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List values) {","  List modes = [];","  List counts = [];","  int maxCount = 0;","  for (int i = 0; i < values.length; i++) {","    var value = values[i];","    bool found = false;","    int thisCount;","    for (int j = 0; j < counts.length; j++) {","      if (counts[j][0] == value) {","        thisCount = ++counts[j][1];","        found = true;","        break;","      }","    }","    if (!found) {","      counts.add([value, 1]);","      thisCount = 1;","    }","    maxCount = Math.max(thisCount, maxCount);","  }","  for (int j = 0; j < counts.length; j++) {","    if (counts[j][1] == maxCount) {","        modes.add(counts[j][0]);","    }","  }","  return modes;","}"]))+"("+t+")";break;case"STD_DEV":n.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",e=(e=n.Dart.provideFunction_("math_standard_deviation",["num "+n.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List myList) {","  // First filter list for numbers only.","  List numbers = new List.from(myList);","  numbers.removeWhere((a) => a is! num);","  if (numbers.isEmpty) return null;","  num n = numbers.length;","  num sum = 0;","  numbers.forEach((x) => sum += x);","  num mean = sum / n;","  num sumSquare = 0;","  numbers.forEach((x) => sumSquare += Math.pow(x - mean, 2));","  return Math.sqrt(sumSquare / n);","}"]))+"("+t+")";break;case"RANDOM":n.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",e=(e=n.Dart.provideFunction_("math_random_item",["dynamic "+n.Dart.FUNCTION_NAME_PLACEHOLDER_+"(List myList) {","  int x = new Math.Random().nextInt(myList.length);","  return myList[x];","}"]))+"("+t+")";break;default:throw Error("Unknown operator: "+e)}return[e,n.Dart.ORDER_UNARY_POSTFIX]},n.Dart.math_modulo=function(t){return[(n.Dart.valueToCode(t,"DIVIDEND",n.Dart.ORDER_MULTIPLICATIVE)||"0")+" % "+(t=n.Dart.valueToCode(t,"DIVISOR",n.Dart.ORDER_MULTIPLICATIVE)||"0"),n.Dart.ORDER_MULTIPLICATIVE]},n.Dart.math_constrain=function(t){return n.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",["Math.min(Math.max("+(n.Dart.valueToCode(t,"VALUE",n.Dart.ORDER_NONE)||"0")+", "+(n.Dart.valueToCode(t,"LOW",n.Dart.ORDER_NONE)||"0")+"), "+(t=n.Dart.valueToCode(t,"HIGH",n.Dart.ORDER_NONE)||"double.infinity")+")",n.Dart.ORDER_UNARY_POSTFIX]},n.Dart.math_random_int=function(t){n.Dart.definitions_.import_dart_math="import 'dart:math' as Math;";var e=n.Dart.valueToCode(t,"FROM",n.Dart.ORDER_NONE)||"0";return t=n.Dart.valueToCode(t,"TO",n.Dart.ORDER_NONE)||"0",[n.Dart.provideFunction_("math_random_int",["int "+n.Dart.FUNCTION_NAME_PLACEHOLDER_+"(num a, num b) {","  if (a > b) {","    // Swap a and b to ensure a is smaller.","    num c = a;","    a = b;","    b = c;","  }","  return new Math.Random().nextInt(b - a + 1) + a;","}"])+"("+e+", "+t+")",n.Dart.ORDER_UNARY_POSTFIX]},n.Dart.math_random_float=function(t){return n.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",["new Math.Random().nextDouble()",n.Dart.ORDER_UNARY_POSTFIX]},n.Dart.math_atan2=function(t){n.Dart.definitions_.import_dart_math="import 'dart:math' as Math;";var e=n.Dart.valueToCode(t,"X",n.Dart.ORDER_NONE)||"0";return["Math.atan2("+(n.Dart.valueToCode(t,"Y",n.Dart.ORDER_NONE)||"0")+", "+e+") / Math.pi * 180",n.Dart.ORDER_MULTIPLICATIVE]},n.Dart.procedures={},n.Dart.procedures_defreturn=function(t){var e=n.Dart.variableDB_.getName(t.getFieldValue("NAME"),n.PROCEDURE_CATEGORY_NAME),i="";n.Dart.STATEMENT_PREFIX&&(i+=n.Dart.injectId(n.Dart.STATEMENT_PREFIX,t)),n.Dart.STATEMENT_SUFFIX&&(i+=n.Dart.injectId(n.Dart.STATEMENT_SUFFIX,t)),i&&(i=n.Dart.prefixLines(i,n.Dart.INDENT));var o="";n.Dart.INFINITE_LOOP_TRAP&&(o=n.Dart.prefixLines(n.Dart.injectId(n.Dart.INFINITE_LOOP_TRAP,t),n.Dart.INDENT));var r=n.Dart.statementToCode(t,"STACK"),s=n.Dart.valueToCode(t,"RETURN",n.Dart.ORDER_NONE)||"",a="";r&&s&&(a=i),s&&(s=n.Dart.INDENT+"return "+s+";\n");for(var l=s?"dynamic":"void",c=[],d=t.getVars(),u=0;u<d.length;u++)c[u]=n.Dart.variableDB_.getName(d[u],n.VARIABLE_CATEGORY_NAME);return i=l+" "+e+"("+c.join(", ")+") {\n"+i+o+r+a+s+"}",i=n.Dart.scrub_(t,i),n.Dart.definitions_["%"+e]=i,null},n.Dart.procedures_defnoreturn=n.Dart.procedures_defreturn,n.Dart.procedures_callreturn=function(t){for(var e=n.Dart.variableDB_.getName(t.getFieldValue("NAME"),n.PROCEDURE_CATEGORY_NAME),i=[],o=t.getVars(),r=0;r<o.length;r++)i[r]=n.Dart.valueToCode(t,"ARG"+r,n.Dart.ORDER_NONE)||"null";return[e+"("+i.join(", ")+")",n.Dart.ORDER_UNARY_POSTFIX]},n.Dart.procedures_callnoreturn=function(t){return n.Dart.procedures_callreturn(t)[0]+";\n"},n.Dart.procedures_ifreturn=function(t){var e="if ("+(n.Dart.valueToCode(t,"CONDITION",n.Dart.ORDER_NONE)||"false")+") {\n";return n.Dart.STATEMENT_SUFFIX&&(e+=n.Dart.prefixLines(n.Dart.injectId(n.Dart.STATEMENT_SUFFIX,t),n.Dart.INDENT)),t.hasReturnValue_?(t=n.Dart.valueToCode(t,"VALUE",n.Dart.ORDER_NONE)||"null",e+=n.Dart.INDENT+"return "+t+";\n"):e+=n.Dart.INDENT+"return;\n",e+"}\n"},n.Dart.texts={},n.Dart.addReservedWords("Html,Math"),n.Dart.text=function(t){return[n.Dart.quote_(t.getFieldValue("TEXT")),n.Dart.ORDER_ATOMIC]},n.Dart.text_multiline=function(t){var e=-1!=(t=n.Dart.multiline_quote_(t.getFieldValue("TEXT"))).indexOf("+")?n.Dart.ORDER_ADDITIVE:n.Dart.ORDER_ATOMIC;return[t,e]},n.Dart.text_join=function(t){switch(t.itemCount_){case 0:return["''",n.Dart.ORDER_ATOMIC];case 1:return[(n.Dart.valueToCode(t,"ADD0",n.Dart.ORDER_UNARY_POSTFIX)||"''")+".toString()",n.Dart.ORDER_UNARY_POSTFIX];default:for(var e=Array(t.itemCount_),i=0;i<t.itemCount_;i++)e[i]=n.Dart.valueToCode(t,"ADD"+i,n.Dart.ORDER_NONE)||"''";return[t="["+e.join(",")+"].join()",n.Dart.ORDER_UNARY_POSTFIX]}},n.Dart.text_append=function(t){var e=n.Dart.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME);return e+" = ["+e+", "+(t=n.Dart.valueToCode(t,"TEXT",n.Dart.ORDER_NONE)||"''")+"].join();\n"},n.Dart.text_length=function(t){return[(n.Dart.valueToCode(t,"VALUE",n.Dart.ORDER_UNARY_POSTFIX)||"''")+".length",n.Dart.ORDER_UNARY_POSTFIX]},n.Dart.text_isEmpty=function(t){return[(n.Dart.valueToCode(t,"VALUE",n.Dart.ORDER_UNARY_POSTFIX)||"''")+".isEmpty",n.Dart.ORDER_UNARY_POSTFIX]},n.Dart.text_indexOf=function(t){var e="FIRST"==t.getFieldValue("END")?"indexOf":"lastIndexOf",i=n.Dart.valueToCode(t,"FIND",n.Dart.ORDER_NONE)||"''";return e=(n.Dart.valueToCode(t,"VALUE",n.Dart.ORDER_UNARY_POSTFIX)||"''")+"."+e+"("+i+")",t.workspace.options.oneBasedIndex?[e+" + 1",n.Dart.ORDER_ADDITIVE]:[e,n.Dart.ORDER_UNARY_POSTFIX]},n.Dart.text_charAt=function(t){var e=t.getFieldValue("WHERE")||"FROM_START",i=n.Dart.valueToCode(t,"VALUE","FIRST"==e||"FROM_START"==e?n.Dart.ORDER_UNARY_POSTFIX:n.Dart.ORDER_NONE)||"''";switch(e){case"FIRST":return[i+"[0]",n.Dart.ORDER_UNARY_POSTFIX];case"FROM_START":return[i+"["+(t=n.Dart.getAdjusted(t,"AT"))+"]",n.Dart.ORDER_UNARY_POSTFIX];case"LAST":case"FROM_END":return t=n.Dart.getAdjusted(t,"AT",1),[(e=n.Dart.provideFunction_("text_get_from_end",["String "+n.Dart.FUNCTION_NAME_PLACEHOLDER_+"(String text, num x) {","  return text[text.length - x];","}"]))+"("+i+", "+t+")",n.Dart.ORDER_UNARY_POSTFIX];case"RANDOM":return n.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",[(e=n.Dart.provideFunction_("text_random_letter",["String "+n.Dart.FUNCTION_NAME_PLACEHOLDER_+"(String text) {","  int x = new Math.Random().nextInt(text.length);","  return text[x];","}"]))+"("+i+")",n.Dart.ORDER_UNARY_POSTFIX]}throw Error("Unhandled option (text_charAt).")},n.Dart.text_getSubstring=function(t){var e=t.getFieldValue("WHERE1"),i=t.getFieldValue("WHERE2"),o="FROM_END"!=e&&"FROM_START"==i,r=n.Dart.valueToCode(t,"STRING",o?n.Dart.ORDER_UNARY_POSTFIX:n.Dart.ORDER_NONE)||"''";if("FIRST"==e&&"LAST"==i)return[r,n.Dart.ORDER_NONE];if(r.match(/^'?\w+'?$/)||o){switch(e){case"FROM_START":o=n.Dart.getAdjusted(t,"AT1");break;case"FROM_END":o=r+".length - "+(o=n.Dart.getAdjusted(t,"AT1",1,!1,n.Dart.ORDER_ADDITIVE));break;case"FIRST":o="0";break;default:throw Error("Unhandled option (text_getSubstring).")}switch(i){case"FROM_START":var s=n.Dart.getAdjusted(t,"AT2",1);break;case"FROM_END":s=r+".length - "+(s=n.Dart.getAdjusted(t,"AT2",0,!1,n.Dart.ORDER_ADDITIVE));break;case"LAST":break;default:throw Error("Unhandled option (text_getSubstring).")}t="LAST"==i?r+".substring("+o+")":r+".substring("+o+", "+s+")"}else o=n.Dart.getAdjusted(t,"AT1"),s=n.Dart.getAdjusted(t,"AT2"),t=n.Dart.provideFunction_("text_get_substring",["String "+n.Dart.FUNCTION_NAME_PLACEHOLDER_+"(String text, String where1, num at1, String where2, num at2) {","  int getAt(String where, num at) {","    if (where == 'FROM_END') {","      at = text.length - 1 - at;","    } else if (where == 'FIRST') {","      at = 0;","    } else if (where == 'LAST') {","      at = text.length - 1;","    } else if (where != 'FROM_START') {","      throw 'Unhandled option (text_getSubstring).';","    }","    return at;","  }","  at1 = getAt(where1, at1);","  at2 = getAt(where2, at2) + 1;","  return text.substring(at1, at2);","}"])+"("+r+", '"+e+"', "+o+", '"+i+"', "+s+")";return[t,n.Dart.ORDER_UNARY_POSTFIX]},n.Dart.text_changeCase=function(t){var e={UPPERCASE:".toUpperCase()",LOWERCASE:".toLowerCase()",TITLECASE:null}[t.getFieldValue("CASE")];return t=n.Dart.valueToCode(t,"TEXT",e?n.Dart.ORDER_UNARY_POSTFIX:n.Dart.ORDER_NONE)||"''",[e?t+e:n.Dart.provideFunction_("text_toTitleCase",["String "+n.Dart.FUNCTION_NAME_PLACEHOLDER_+"(String str) {","  RegExp exp = new RegExp(r'\\b');","  List<String> list = str.split(exp);","  final title = new StringBuffer();","  for (String part in list) {","    if (part.length > 0) {","      title.write(part[0].toUpperCase());","      if (part.length > 0) {","        title.write(part.substring(1).toLowerCase());","      }","    }","  }","  return title.toString();","}"])+"("+t+")",n.Dart.ORDER_UNARY_POSTFIX]},n.Dart.text_trim=function(t){var e={LEFT:".replaceFirst(new RegExp(r'^\\s+'), '')",RIGHT:".replaceFirst(new RegExp(r'\\s+$'), '')",BOTH:".trim()"}[t.getFieldValue("MODE")];return[(n.Dart.valueToCode(t,"TEXT",n.Dart.ORDER_UNARY_POSTFIX)||"''")+e,n.Dart.ORDER_UNARY_POSTFIX]},n.Dart.text_print=function(t){return"print("+(n.Dart.valueToCode(t,"TEXT",n.Dart.ORDER_NONE)||"''")+");\n"},n.Dart.text_prompt_ext=function(t){n.Dart.definitions_.import_dart_html="import 'dart:html' as Html;";var e="Html.window.prompt("+(t.getField("TEXT")?n.Dart.quote_(t.getFieldValue("TEXT")):n.Dart.valueToCode(t,"TEXT",n.Dart.ORDER_NONE)||"''")+", '')";return"NUMBER"==t.getFieldValue("TYPE")&&(n.Dart.definitions_.import_dart_math="import 'dart:math' as Math;",e="Math.parseDouble("+e+")"),[e,n.Dart.ORDER_UNARY_POSTFIX]},n.Dart.text_prompt=n.Dart.text_prompt_ext,n.Dart.text_count=function(t){var e=n.Dart.valueToCode(t,"TEXT",n.Dart.ORDER_NONE)||"''";return t=n.Dart.valueToCode(t,"SUB",n.Dart.ORDER_NONE)||"''",[n.Dart.provideFunction_("text_count",["int "+n.Dart.FUNCTION_NAME_PLACEHOLDER_+"(String haystack, String needle) {","  if (needle.length == 0) {","    return haystack.length + 1;","  }","  int index = 0;","  int count = 0;","  while (index != -1) {","    index = haystack.indexOf(needle, index);","    if (index != -1) {","      count++;","     index += needle.length;","    }","  }","  return count;","}"])+"("+e+", "+t+")",n.Dart.ORDER_UNARY_POSTFIX]},n.Dart.text_replace=function(t){return[(n.Dart.valueToCode(t,"TEXT",n.Dart.ORDER_UNARY_POSTFIX)||"''")+".replaceAll("+(n.Dart.valueToCode(t,"FROM",n.Dart.ORDER_NONE)||"''")+", "+(t=n.Dart.valueToCode(t,"TO",n.Dart.ORDER_NONE)||"''")+")",n.Dart.ORDER_UNARY_POSTFIX]},n.Dart.text_reverse=function(t){return["new String.fromCharCodes("+(n.Dart.valueToCode(t,"TEXT",n.Dart.ORDER_UNARY_POSTFIX)||"''")+".runes.toList().reversed)",n.Dart.ORDER_UNARY_PREFIX]},n.Dart.variables={},n.Dart.variables_get=function(t){return[n.Dart.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME),n.Dart.ORDER_ATOMIC]},n.Dart.variables_set=function(t){var e=n.Dart.valueToCode(t,"VALUE",n.Dart.ORDER_ASSIGNMENT)||"0";return n.Dart.variableDB_.getName(t.getFieldValue("VAR"),n.VARIABLE_CATEGORY_NAME)+" = "+e+";\n"},n.Dart.variablesDynamic={},n.Dart.variables_get_dynamic=n.Dart.variables_get,n.Dart.variables_set_dynamic=n.Dart.variables_set,n.Dart)})),XP=IP((function(t,e){var n;t.exports=(n=zP,DP.Dart=n,n)})),jP=IP((function(t){var e,n,i,o,r,s,a,l;n=NP,i=PP,o=BP,r=HP,s=VP,a=WP,l=XP,(e=DP).setLocale(n),e.Blocks=e.Blocks||{},Object.keys(i).forEach((function(t){e.Blocks[t]=i[t]})),e.JavaScript=o,e.Python=r,e.Lua=a,e.PHP=s,e.Dart=l,t.exports=e})),YP=IP((function(t,e){t.exports=jP}));const KP=st`
  .column {
    display: flex;
    flex-direction: column;
  }
  .row {
    display: flex;
    flex-direction: row;
  }
  .center-content {
    align-items: center;
    justify-content: center;
  }

  .vertical-divider {
    background-color: grey;
    width: 1px;
    height: 60%;
    opacity: 0.3;
    margin-bottom: 0;
  }
`,$P="AgentPubKey",JP="#ffad42",qP={type:"create_entry",message0:"create_entry %1",args0:[{type:"input_value",name:"ENTRY",check:"Entry"}],inputsInline:!0,nextStatement:null,previousStatement:null,colour:JP,tooltip:"Returns number of letters in the provided text.",helpUrl:"http://www.w3schools.com/jsref/jsref_length_string.asp"};function ZP(t){t.defineBlocksWithJsonArray([qP]),t.JavaScript.create_entry=function(e){const n=t.JavaScript.valueToCode(e,"ENTRY",t.JavaScript.ORDER_ADDITION);if(!n)throw new Error('"create_entry": entry is empty');return`(await hdk.create_entry(${n}));\n`}}const QP={type:"create_link",message0:"create_link base %1 target %2 tag %3",args0:[{type:"input_value",name:"BASE",check:["EntryHash",$P],align:"right"},{type:"input_value",name:"TARGET",check:["EntryHash",$P],align:"right"},{type:"input_value",name:"TAG",align:"right"}],nextStatement:null,previousStatement:null,colour:JP,tooltip:"Returns number of letters in the provided text.",helpUrl:"http://www.w3schools.com/jsref/jsref_length_string.asp"};const tM={type:"get",message0:"get %1",args0:[{type:"input_value",name:"HASH",check:["EntryHash","HeaderHash",$P]}],inputsInline:!0,output:"Element",colour:JP,tooltip:"Returns number of letters in the provided text.",helpUrl:"http://www.w3schools.com/jsref/jsref_length_string.asp"};const eM={type:"hash_entry",message0:"hash_entry %1",args0:[{type:"input_value",name:"ENTRY",check:"Entry"}],inputsInline:!0,output:"EntryHash",colour:JP,tooltip:"Returns number of letters in the provided text.",helpUrl:"http://www.w3schools.com/jsref/jsref_length_string.asp"};const nM={type:"agent_info.agent_latest_pubkey",message0:"agent_info.agent_latest_pubkey",args0:[],inputsInline:!0,output:$P,colour:JP,tooltip:"Returns number of letters in the provided text.",helpUrl:"http://www.w3schools.com/jsref/jsref_length_string.asp"};const iM={type:"get_details",message0:"get_details %1",args0:[{type:"input_value",name:"HASH",check:["EntryHash",$P]}],inputsInline:!0,output:"EntryDetails",colour:JP,tooltip:"Returns number of letters in the provided text.",helpUrl:"http://www.w3schools.com/jsref/jsref_length_string.asp"};const oM={type:"get_links",message0:"get_links base: %1 tag: %2",args0:[{type:"input_value",name:"BASE",check:["EntryHash",$P]},{type:"input_value",name:"TAG"}],inputsInline:!0,output:"Array",colour:JP,tooltip:"Returns number of letters in the provided text.",helpUrl:"http://www.w3schools.com/jsref/jsref_length_string.asp"};const rM={type:"entry_def",message0:"entry_def id %1 public %2",args0:[{type:"field_input",name:"ENTRY_DEF_ID",check:"String"},{type:"field_checkbox",name:"PUBLIC",checked:!0}],colour:JP,output:"EntryDef",tooltip:"Creates a new entry with the given entry_def_id and content",helpUrl:"http://www.w3schools.com/jsref/jsref_length_string.asp"};const sM={type:"update_entry",message0:"update_entry original header %1 new entry %2",args0:[{type:"input_value",name:"ORIGINAL_HEADER",check:"HeaderHash"},{type:"input_value",name:"ENTRY",check:"Entry"}],inputsInline:!0,nextStatement:null,previousStatement:null,colour:JP,tooltip:"Returns number of letters in the provided text.",helpUrl:"http://www.w3schools.com/jsref/jsref_length_string.asp"};function aM(t){ZP(t),function(t){t.defineBlocksWithJsonArray([QP]),t.JavaScript.create_link=function(e){const n=t.JavaScript.valueToCode(e,"BASE",t.JavaScript.ORDER_ADDITION),i=t.JavaScript.valueToCode(e,"TARGET",t.JavaScript.ORDER_ADDITION),o=t.JavaScript.valueToCode(e,"TAG",t.JavaScript.ORDER_ADDITION)||"null";if(!n)throw new Error('"create_link": base is empty');if(!i)throw new Error('"create_link": target is empty');return`(await hdk.create_link({base: ${n}, target: ${i}, tag: ${o}}));\n`}}(t),function(t){t.defineBlocksWithJsonArray([eM]),t.JavaScript.hash_entry=function(e){const n=t.JavaScript.valueToCode(e,"ENTRY",t.JavaScript.ORDER_ADDITION);if(!n)throw new Error('"hash_entry": entry is empty');return console.log(`(await hdk.hash_entry(${n}))`),[`(await hdk.hash_entry(${n}))`,t.JavaScript.ORDER_FUNCTION_CALL]}}(t),function(t){t.defineBlocksWithJsonArray([tM]),t.JavaScript.get=function(e){const n=t.JavaScript.valueToCode(e,"HASH",t.JavaScript.ORDER_ADDITION);if(!n)throw new Error('"get": hash is empty');return console.log(`(await hdk.get(${n}))`),[`(await hdk.get(${n}))`,t.JavaScript.ORDER_FUNCTION_CALL]}}(t),function(t){t.defineBlocksWithJsonArray([nM]),t.JavaScript["agent_info.agent_latest_pubkey"]=function(){return["(await hdk.agent_info()).agent_latest_pubkey",t.JavaScript.ORDER_FUNCTION_CALL]}}(t),function(t){t.defineBlocksWithJsonArray([iM]),t.JavaScript.get_details=function(e){const n=t.JavaScript.valueToCode(e,"HASH",t.JavaScript.ORDER_ADDITION);if(!n)throw new Error('"get_details": hash is empty');return[`(await hdk.get_details(${n}))`,t.JavaScript.ORDER_FUNCTION_CALL]}}(t),function(t){t.defineBlocksWithJsonArray([oM]),t.JavaScript.get_links=function(e){const n=t.JavaScript.valueToCode(e,"BASE",t.JavaScript.ORDER_ADDITION),i=t.JavaScript.valueToCode(e,"TAG",t.JavaScript.ORDER_ADDITION)||"null";if(!n)throw new Error('"get_links": base hash is empty');return[`(await hdk.get_links(${n}, ${i}))`,t.JavaScript.ORDER_FUNCTION_CALL]}}(t),function(t){t.Blocks.entry_defs={init(){this.setHelpUrl(t.Msg.LISTS_CREATE_WITH_HELPURL),this.setColour(JP),this.itemCount_=1,this.updateShape_(),this.setMutator(new t.Mutator(["lists_create_with_item"])),this.setTooltip("Entry definitions for this zome")},mutationToDom(){const t=document.createElement("mutation");return t.setAttribute("items",this.itemCount_),t},domToMutation(t){this.itemCount_=parseInt(t.getAttribute("items"),10),this.updateShape_()},decompose(t){const e=t.newBlock("lists_create_with_container");e.initSvg();let n=e.getInput("STACK").connection;for(let e=0;e<this.itemCount_;e++){const e=t.newBlock("lists_create_with_item");e.initSvg(),n.connect(e.previousConnection),n=e.nextConnection}return e},compose(e){let n=e.getInputTargetBlock("STACK");const i=[];for(;n;)i.push(n.valueConnection_),n=n.nextConnection&&n.nextConnection.targetBlock();for(var o=0;o<this.itemCount_;o++){const t=this.getInput(`ADD${o}`).connection.targetConnection;t&&-1==i.indexOf(t)&&t.disconnect()}for(this.itemCount_=i.length,this.updateShape_(),o=0;o<this.itemCount_;o++)t.Mutator.reconnect(i[o],this,`ADD${o}`)},saveConnections(t){let e=t.getInputTargetBlock("STACK"),n=0;for(;e;){const t=this.getInput(`ADD${n}`);e.valueConnection_=t&&t.connection.targetConnection,n++,e=e.nextConnection&&e.nextConnection.targetBlock()}},updateShape_(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(t.Msg.LISTS_CREATE_EMPTY_TITLE);for(var e=0;e<this.itemCount_;e++)if(!this.getInput(`ADD${e}`)){const t=this.appendValueInput(`ADD${e}`).setCheck("EntryDef");0==e&&t.appendField("entry_defs")}for(;this.getInput(`ADD${e}`);)this.removeInput(`ADD${e}`),e++}},t.defineBlocksWithJsonArray([rM]),t.JavaScript.entry_def=function(e){return[`{id: "${e.getFieldValue("ENTRY_DEF_ID")}", visibility: "${e.getFieldValue("PUBLIC")?"Public":"Private"}"}`,t.JavaScript.ORDER_FUNCTION_CALL]},t.JavaScript.entry_defs=function(e){const n=new Array(e.itemCount_);for(let i=0;i<e.itemCount_;i++)n[i]=t.JavaScript.valueToCode(e,`ADD${i}`,t.JavaScript.ORDER_NONE)||"null";return`export const entry_defs = [${n.join(", ")}]`}}(t),function(t){t.defineBlocksWithJsonArray([sM]),t.JavaScript.update_entry=function(e){const n=t.JavaScript.valueToCode(e,"ORIGINAL_HEADER",t.JavaScript.ORDER_ADDITION),i=t.JavaScript.valueToCode(e,"ENTRY",t.JavaScript.ORDER_ADDITION);if(!n)throw new Error('"update_entry": original header is empty');if(!i)throw new Error('"update_entry": entry is empty');return`(await hdk.create_entry(${n}, ${i}));\n`}}(t),ZP(t)}const lM={kind:"categoryToolbox",contents:[{kind:"category",name:"HDK",contents:[{kind:"category",name:"Entries",contents:[]},{kind:"category",name:"CRUD",contents:[{kind:"block",type:"get"},{kind:"block",type:"get_details"},{kind:"block",type:"create_entry"},{kind:"block",type:"update_entry"},{kind:"block",type:"delete_entry"},{kind:"block",type:"hash_entry"}]},{kind:"category",name:"Links",contents:[{kind:"block",type:"get_links"},{kind:"block",type:"create_link"}]},{kind:"category",name:"Information",contents:[{kind:"block",type:"agent_info.agent_latest_pubkey"}]},{kind:"category",name:"Callbacks",contents:[{kind:"block",type:"entry_defs"},{kind:"block",type:"entry_def"}]}]},{kind:"category",name:"Control",contents:[{kind:"block",type:"controls_if"},{kind:"block",type:"controls_whileUntil"},{kind:"block",type:"controls_for"},{kind:"block",type:"controls_forEach"}]},{kind:"category",name:"Logic",contents:[{kind:"block",type:"logic_compare"},{kind:"block",type:"logic_operation"},{kind:"block",type:"logic_boolean"},{kind:"block",type:"logic_ternary"},{kind:"block",type:"logic_null"},{kind:"block",type:"logic_negate"}]},{kind:"category",name:"Math",contents:[{kind:"block",type:"math_number"},{kind:"block",type:"math_number"},{kind:"block",type:"math_trig"},{kind:"block",type:"math_constant"},{kind:"block",type:"math_number_property"},{kind:"block",type:"math_round"},{kind:"block",type:"math_modulo"},{kind:"block",type:"math_constrain"},{kind:"block",type:"math_random_int"},{kind:"block",type:"math_random_float"}]},{kind:"category",name:"Text",contents:[{kind:"block",type:"text"},{kind:"block",type:"text_join"},{kind:"block",type:"text_append"},{kind:"block",type:"text_length"},{kind:"block",type:"text_isEmpty"},{kind:"block",type:"text_indexOf"},{kind:"block",type:"text_charAt"},{kind:"block",type:"text_getSubstring"},{kind:"block",type:"text_changeCase"},{kind:"block",type:"text_trim"}]},{kind:"category",name:"List",contents:[{kind:"block",type:"lists_create_with"},{kind:"block",type:"lists_repeat"},{kind:"block",type:"lists_length"},{kind:"block",type:"lists_isEmpty"},{kind:"block",type:"lists_getSublist"},{kind:"block",type:"lists_getIndex"},{kind:"block",type:"lists_setIndex"},{kind:"block",type:"lists_sort"}]},{kind:"category",name:"Variables",custom:"VARIABLE"},{kind:"category",name:"Functions",custom:"PROCEDURE"}]};function cM(t,...e){let n=t.raw[0];for(let i=0;i<e.length;i++)n+=e[i]+t.raw[i+1];return`data:text/javascript;base64,${btoa(unescape(encodeURIComponent(n)))}`}async function dM(t){const e=/function (\w*)\(([A-Za-z0-9_,\ ]*)\) \{/g,n=t.replace(e,"export const $1 = (hdk) => async ({ $2 }) => {"),i=t.split(e),o=await import(cM`${n}`);console.log(n);const r=o.entry_defs;if(!r)throw new Error("There are no entry_defs defined in this zome");if(r.some((t=>null===t)))throw new Error("There are null entry defs");const s={};for(const t of Object.keys(o).filter((t=>"entry_defs"!==t))){const e=i.findIndex((e=>e===t))+1;let n=[];""!==i[e]&&(n=i[e].split(", ").map((t=>({name:t,type:"any"})))),s[t]={arguments:n,call:o[t]}}return{zome_functions:s,entry_defs:r}}function uM(t,e){const n=`new ${e}`;if(!t.JavaScript[n]){const i={type:n,message0:`new ${e} %1`,args0:[{type:"input_value",name:"CONTENT",check:"String",align:"right"}],output:"Entry",inputsInline:!0,colour:JP,tooltip:"Creates a new entry with the given entry_def_id and content",helpUrl:"http://www.w3schools.com/jsref/jsref_length_string.asp"};t.defineBlocksWithJsonArray([i]),t.JavaScript[n]=function(n){return[`{content: ${t.JavaScript.valueToCode(n,"CONTENT",t.JavaScript.ORDER_ADDITION)}, entry_def_id: "${e}"}`,t.JavaScript.ORDER_FUNCTION_CALL]}}return{kind:"block",type:n}}class hM extends(Nm(lt)){constructor(){super(...arguments),this._checkTimeout=void 0}static get styles(){return[st`
        :host {
          display: flex;
          flex: 1;
        }
        .blocklyFlyoutButton > .blocklyText {
          fill: white;
        }
      `,KP]}updated(t){super.updated(t),(t.has("zome")||t.has("editing"))&&this.zome&&setTimeout((()=>this.setupBlockly()))}firstUpdated(){aM(YP)}setupBlockly(){if(this._workspace&&this._workspace.dispose(),this.zome&&this.zome.entry_defs.forEach((t=>uM(YP,t.id))),this._workspace=YP.inject(this.blocklyArea,{toolbox:this.editing?lM:null,shadowRoot:this.shadowRoot}),this.zome.blocklyCode){const t=YP.Xml.textToDom(this.zome.blocklyCode);YP.Xml.domToWorkspace(t,this._workspace)}this.editing&&this._workspace.addChangeListener((async()=>{this._checkTimeout&&clearTimeout(this._checkTimeout),this._checkTimeout=setTimeout((async()=>{if(this.editing)try{const t=await this.getZome(),e=this._workspace.toolbox_.getToolboxItems()[0].getChildToolboxItems()[0],n=t.entry_defs.map((t=>uM(YP,t.id)));e.updateFlyoutContents({kind:"category",name:"Entries",contents:n}),this.dispatchEvent(new CustomEvent("zome-edited",{detail:{valid:!0,zome:t}}))}catch(t){console.error(t),this.dispatchEvent(new CustomEvent("zome-edited",{detail:{valid:!1}}))}clearTimeout(this._checkTimeout)}),500)}))}async isValid(){try{return await this.getZome(),!0}catch(t){return!1}}async getZome(){return async function(t,e,n){const i=t.JavaScript.workspaceToCode(e),{zome_functions:o,entry_defs:r}=await dM(i),s=t.Xml.domToText(t.Xml.workspaceToDom(e));return console.log(s),{name:n,entry_defs:r,zome_functions:o,blocklyCode:s}}(YP,this._workspace,this.zome.name)}render(){return F`
      <div
        class="row"
        style=${qt({flex:"1","pointer-events":this.editing?"all":"none"})}
      >
        <div id="blockly-area" style="flex: 1;"></div>
      </div>
    `}}t([J({type:Object})],hM.prototype,"zome",void 0),t([J({type:Boolean})],hM.prototype,"editing",void 0),t([Z("#blockly-area")],hM.prototype,"blocklyArea",void 0);class pM extends Lm{constructor(){super(...arguments),this._selectedZomeIndex=0,this._editingZomes=void 0,this._invalid=!1,this._newZomeCount=0}getActiveDna(){for(const t of this.conductors)for(const e of t.getAllCells())if(e.dnaHash===this.activeDna)return e.getSimulatedDna()}get _editing(){return void 0!==this._editingZomes}get _editZomeEl(){var t;return null===(t=this.shadowRoot)||void 0===t?void 0:t.getElementById("edit-zome")}isDnaValid(){return this._editingZomes&&this._editingZomes.every((t=>t.valid))}async onZomeEdited(t){this.editDna();const e=t.detail.valid;this._editingZomes&&(this._editingZomes[this._selectedZomeIndex].valid=e,e&&(this._editingZomes[this._selectedZomeIndex].zome=t.detail.zome)),this.requestUpdate()}newEditingZome(){return this._newZomeCount++,{valid:!0,zome:{name:`sample${this._newZomeCount}`,entry_defs:[],zome_functions:{},blocklyCode:'<xml xmlns="https://developers.google.com/blockly/xml"><block type="entry_defs" id="a{AP^:MzvuAQf6=jI~[2" x="123" y="58"><mutation xmlns="http://www.w3.org/1999/xhtml" items="1"></mutation><value name="ADD0"><block type="entry_def" id="$SQ6P6OQ#1/hfOd4TA=@"><field name="ENTRY_DEF_ID">sample_entry</field><field name="PUBLIC">TRUE</field></block></value></block><block type="procedures_defnoreturn" id="D}syd|^_`$9k%uwyIdSn" x="164" y="126"><field name="NAME">sample function</field><comment pinned="false" h="80" w="160">Describe this function...</comment><statement name="STACK"><block type="create_entry" id="YbSju3KGV0}rR_PP}]b2"><value name="ENTRY"><block type="new sample_entry" id="tQuMSJo,+,v1tN,aAx9z"><field name="CONTENT">Hello world!</field></block></value></block></statement></block></xml>'}}}editDna(){if(!this._editing){const t=this.getActiveDna();this._editingZomes=t?t.zomes.map((t=>({valid:!0,zome:t}))):[this.newEditingZome()],this._editZomeEl.zome=this._editingZomes[this._selectedZomeIndex].zome,this._newZomeCount=0}}isCompileDisabled(){return!this._editing||!this.isDnaValid()}async showZome(t){var e;this._editing&&this._invalid?this.showMessage("Zome code is invalid"):(this._selectedZomeIndex=t,this._editingZomes?this._editZomeEl.zome=this._editingZomes[this._selectedZomeIndex].zome:this._editZomeEl.zome=null===(e=this.getActiveDna())||void 0===e?void 0:e.zomes[this._selectedZomeIndex])}addZome(){this._editingZomes&&(this._editingZomes=[...this._editingZomes,this.newEditingZome()])}getEditingDna(){if(this._editingZomes)return{properties:null,uuid:"",zomes:this._editingZomes.map((t=>t.zome))}}removeEditingZome(t){this._editingZomes&&(this._editingZomes.splice(t,1),t===this._selectedZomeIndex&&(this._selectedZomeIndex=0),this.requestUpdate())}async compileDna(){if(this._editingZomes){const t=this.conductors.map((async t=>{const e=await t.registerDna(this.getEditingDna());return t.installApp(e,null,null,"")})),e=await Promise.all(t);this.updatePlayground({activeDna:e[0].dnaHash,activeAgentPubKey:e[0].agentPubKey}),this._editingZomes=void 0,setTimeout((()=>{var t;this._editZomeEl.zome=null===(t=this.getActiveDna())||void 0===t?void 0:t.zomes[this._selectedZomeIndex]}))}}async cancelEdit(){this._editingZomes=void 0}renderContent(){const t=this.getEditingDna()||this.getActiveDna();return t?F`
      <div class="column" style="flex: 1;">
        <div
          class="row"
          style="align-items: center; margin: 0 16px; margin-left: 0;"
        >
          <mwc-tab-bar
            @MDCTabBar:activated=${t=>this.showZome(t.detail.index)}
          >
            ${t.zomes.map(((t,e)=>F`
                <mwc-tab label=${t.name}> </mwc-tab>

                ${this._editing?F`<mwc-icon-button
                        icon="delete"
                        style="opacity: 0.5; --mdc-icon-button-size: 36px; align-self: center; margin-right: 16px;"
                        @click=${()=>this.removeEditingZome(e)}
                      ></mwc-icon-button>
                      <span
                        class="vertical-divider"
                        style="align-self: center;"
                      ></span> `:F``}
              `))}
          </mwc-tab-bar>
          ${this._editing?F`
                <mwc-button
                  label="Add zome"
                  icon="add"
                  @click=${()=>this.addZome()}
                ></mwc-button>
              `:F``}
          <span style="flex: 1;"></span>
          ${this._editing?F`
                <mwc-button
                  label="CANCEL"
                  style="margin-right: 16px;"
                  @click=${()=>this.cancelEdit()}
                ></mwc-button>
                <mwc-button
                  label="COMPILE"
                  raised
                  .disabled=${this.isCompileDisabled()}
                  @click=${()=>this.compileDna()}
                ></mwc-button>
              `:F`
                <mwc-button
                  label="EDIT"
                  @click=${()=>this.editDna()}
                ></mwc-button>
              `}
        </div>

        <edit-zome
          id="edit-zome"
          .editing=${this._editing}
          style="flex: 1;"
          @zome-edited=${t=>this.onZomeEdited(t)}
        ></edit-zome>
      </div>
    `:F`<div class="row center-content" style="flex: 1;">
        <span>There is no active Dna</span>
      </div>`}render(){return F`
      <mwc-card style="width: auto; flex: 1">
        <div class="column" style="flex: 1;">
          <span style="font-size: 20px; margin: 16px;"
            >Dna
            Code${this.activeDna?F`<span style="opacity: 0.7"
                  >, for dna ${this.activeDna}
                </span>`:F``}</span
          >
          ${this.renderContent()}
        </div>
      </mwc-card>
    `}static get scopedElements(){return{"edit-zome":hM,"mwc-tab-bar":wc,"mwc-tab":tc,"mwc-button":bl,"mwc-icon-button":en,"mwc-card":ld}}}pM.styles=[st`
      :host {
        display: flex;
      }
    `,KP],t([J({type:Number})],pM.prototype,"_selectedZomeIndex",void 0),t([J({type:Array})],pM.prototype,"_editingZomes",void 0),t([J({type:Boolean})],pM.prototype,"_invalid",void 0);customElements.define("holochain-playground-container",Dm),customElements.define("dna-code",pM),customElements.define("dht-cells",SS),customElements.define("select-active-dna",class extends Lm{selectDNA(t){this.updatePlayground({activeAgentPubKey:null,activeHash:null,activeDna:t})}render(){const t=function(t){const e={};for(const n of t)for(const t of n.getAllCells())e[t.dnaHash]=!0;return Object.keys(e)}(this.conductors);return F(Sm||(Sm=km` <mwc-card class="block-card"> <div class="column" style="margin:16px"> <span class="block-title" style="margin-bottom:16px">Select Active Dna</span> <mwc-select outlined fullwidth @selected="${0}"> ${0} </mwc-select> </div> </mwc-card> `),(e=>this.selectDNA(t[e.detail.index])),t.map((t=>F(Im||(Im=km` <mwc-list-item ?selected="${0}" .value="${0}">${0}</mwc-list-item> `),this.activeDna===t,t,t))))}static get styles(){return[st(Om||(Om=km`:host{display:flex}`)),Pm]}static get scopedElements(){return{"mwc-list-item":Rd,"mwc-select":Bg,"mwc-card":ld}}}),customElements.define("call-zome-fns",Qm),customElements.define("entry-graph",ZS);const gM=document.getElementById("container");gM.simulatedDnaTemplate={properties:null,uuid:"",zomes:[{name:"demo_entries",entry_defs:[{id:"sample_entry",visibility:"Public"}],blocklyCode:'<xml xmlns="https://developers.google.com/blockly/xml"><variables><variable id="_?2#8+sn=^`fqd%E/Ffz">hash</variable><variable id="}+4NT8PIh-H~3?/]i:pq">contents</variable></variables><block type="entry_defs" id="Jjc~6G6Ezu-d^-@em_yh" x="115" y="28"><mutation xmlns="http://www.w3.org/1999/xhtml" items="1"></mutation><value name="ADD0"><block type="entry_def" id=":we9$r=tpV.ce6FC0$a@"><field name="ENTRY_DEF_ID">sample_entry</field><field name="PUBLIC">TRUE</field></block></value></block><block type="procedures_defreturn" id="M}4W;Z$EW[%Js=y4-XWx" x="208" y="111"><mutation><arg name="hash" varid="_?2#8+sn=^`fqd%E/Ffz"></arg></mutation><field name="NAME">get</field><comment pinned="false" h="80" w="160">Describe this function...</comment><value name="RETURN"><block type="get" id=";rtPS/KcSZp8;VN{1uKM"><value name="HASH"><block type="variables_get" id=")BCBF(.]MvZh6-XA]Y1*"><field name="VAR" id="_?2#8+sn=^`fqd%E/Ffz">hash</field></block></value></block></value></block><block type="procedures_defreturn" id="l-jj!v]JU[3gtFFrKl{)" x="118" y="256"><mutation><arg name="contents" varid="}+4NT8PIh-H~3?/]i:pq"></arg></mutation><field name="NAME">create_entry</field><comment pinned="false" h="80" w="160">Describe this function...</comment><statement name="STACK"><block type="create_entry" id=":Sgxw5iCag?!f,R$yHK5"><value name="ENTRY"><block type="new sample_entry" id="Vxav^_6z|in9trwJmorD"><value name="CONTENT"><block type="variables_get" id="a3-sS1)%cGR`5q4VuB:E"><field name="VAR" id="}+4NT8PIh-H~3?/]i:pq">contents</field></block></value></block></value></block></statement><value name="RETURN"><block type="hash_entry" id="@yEoC$H__6#Ql:m6%FBg"><value name="ENTRY"><block type="new sample_entry" id="IF[Lz57}#@!b3z/~-A6O"><value name="CONTENT"><block type="variables_get" id="wc1vbieNkjxWJ21[E;?z"><field name="VAR" id="}+4NT8PIh-H~3?/]i:pq">contents</field></block></value></block></value></block></value></block></xml>',zome_functions:{create_entry:{call:({hash_entry:t,create_entry:e})=>async({content:n})=>(await e({content:n,entry_def_id:"sample_entry"}),t({content:n})),arguments:[{name:"content",type:"any"}]},get:{call:({get:t})=>({hash:e})=>t(e),arguments:[{name:"hash",type:"any"}]}}}]},gM.numberOfSimulatedConductors=6,gM.addEventListener("ready",(t=>{const e=t.detail.conductors[0].getAllCells()[0];t.target.activeAgentPubKey=e.cellId[1]}));
